@&#MAIN-TITLE@&#An integrated neuromimetic architecture for direct motion interpretation in the log-polar domain

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A bio-inspired vision system for motion interpretation in cortical domain.


                        
                        
                           
                           A population of motion energy neurons for the computation of optic flow.


                        
                        
                           
                           Relationships between the log-polar and Cartesian affine description of optic flow.


                        
                        
                           
                           An architecture that exploits multi-core CPU and GPU for real-time processing.


                        
                        
                           
                           Benchmarking on synthetic and real-world sequences.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Bio-inspired vision systems

Space-variant mapping

Cortical representation

Optic flow

Population coding

Affine description

Time-to-contact

Surface orientation

@&#ABSTRACT@&#


               
               
                  A hierarchical vision system, inspired by the functional architecture of the cortical motion pathway, to provide motion interpretation and to guide real-time actions in the real-world, is proposed. Such a neuromimetic architecture exploits (i) log-polar mapping for data reduction, (ii) a population of motion energy neurons to compute the optic flow, and (iii) a population of adaptive templates in the cortical domain to gain the flow’s affine description. The time-to-contact and the surface orientations of points of interest in the real-world are computed by directly combining the linear description of the cortical flow. The approach is validated through quantitative tests in synthetic environments, and in real-world automotive and robotics situations.
               
            

@&#INTRODUCTION@&#

Motion interpretation aims to relate spatio-temporal variations of the image sequences to motion events in the 3D space for gaining useful information about the observed scene as required in different application domains, such as autonomous navigation, robot manipulation tasks, and 3D dynamic scene understanding.

Any artificial agent acting in a real-world scenario should perform the analysis and interpretation of visual motion in a fast and reliable way. This task is effectively solved by the primate visual system. In the visual cortex of mammals, indeed, the analysis of motion and of the 3D spatial relationships occur jointly in the dorsal cortical pathway [1], which is specialized for spatial localization and action planning. Such a pathway can be seen as an “action stream” in the visual cortex for guiding in real-time the actions that we direct at objects in the world. The dorsal pathway is organized in a hierarchical structure of layers that process the visual signal to extract simple image features that become more informative and complex in higher layers. In particular, the visual signal is acquired and spatially transformed by the retina, then it reaches the primary visual cortex (V1), whose neurons are sensitive to the elemental visual attributes, such as orientation, motion and disparity. This early visual processing is projected first to the V2 cortical area where cells are sensitive to relative disparity and to more sophisticated feature representation, then to the Middle Temporal (MT) extra-striate area that provides estimates of visual motion. Finally, MT neurons project to the Medial Superior Temporal (MST) area where an estimation of visual features related to 3D events in the real-world, such as heading, surface orientation and time-to-contact, takes place. The overall architecture is characterized by deep hierarchies that exhibit advantages from the computational point of view and for their generalizations properties, with respect to the standard Computer Vision approaches [2].

In this paper, to fully exploit such an effective hierarchical approach adopted by the mammals’ visual system, we propose a bio-inspired vision system that mimics the first stages of the dorsal cortical pathway. Indeed, the integrated neuromimetic architecture we propose is an instance of some of the principles described in [2]. Nevertheless, the proposed neuromimetic vision system does not aspire to model and to replicate with accuracy all the primate electrophysiological and human psychophysical data, i.e. our neural algorithm is not a neural model of the visual pathway, but it is a bio-inspired architecture that implements, at a functional level, some neural paradigms, only. In particular, our aim is (1) to capture in the simplest possible way the essential aspects of the neural computations that occur in the cortical motion pathway (namely V1-MT-MST) and lead to the estimations of visual motion features in real-world situations, and (2) to quantitatively assess the results of our neural architecture with respect to the performances of other state-of-the-art vision algorithms (either bio-inspired or not, available in the literature). In particular, we have considered the following processing stages.

The front-end stage of the proposed bio-inspired vision system performs a space-variant image acquisition. This accounts the fact that the distribution of the photoreceptors in the mammals’ retina is denser in the central region, the fovea, whereas it is sparser in the periphery. Accordingly, the projection of the photoreceptor array into the primary visual cortex can be well described by a log-polar mapping [3]. Such a mechanism simultaneously provides a wide field of view, a high spatial resolution in the region of interest, and a significant reduction of the amount of data to be processed.

The second stage is the computation of the optic flow through a distributed neural architecture that mimics the mechanisms underlying motion analysis in the areas V1 and MT [4]. In distributed representations, or population codes, the information is encoded by the activity pattern of a network of neurons that are selective to elemental vision attributes, e.g. oriented edges, direction of motion and texture [5].

The final stage of the proposed vision system performs motion interpretation through a first order analysis of the optic flow. Indeed, as it is reported in neuroscience [6] and psychophysics [7] studies, many cells in MT and MST cortical areas are sensitive to speed gradients, thus to the orientation of the surfaces. This supports the view that orientation of surfaces and time-to-contact (TTC) estimation are represented in the dorsal stream of the visual pathway, and suggests that the first-order representation is instrumental for the visual understanding of the 3D scene [8–10].

The main contributions of this paper are:
                        
                           –
                           A complete integrated neuromimetic architecture that models the pathway from the acquisition stage to motion interpretation. Through a cortical representation of the visual signal, which allows feature extraction and interpretation directly in the log-polar domain (see Section 3.1), the system gains real-time performances in real-world situations (see Section 4).

A distributed neural architecture based on a population of motion energy neurons for the computation of optic flow in the log-polar domain (see Section 3.3). The neural architecture described in this paper extends a preliminary work presented in [11]. The main differences are that now it entirely works in the cortical domain and it exploits a fast implementation that can run both on CPU and on Graphics Processing Unit (GPU) (see Section 4.1).

The relationships between log-polar and Cartesian affine descriptions of the optic flow that allow us to recover the 3D motion parameters, such as time-to-contact and surface orientation, expressed in real-world coordinates, directly from the cortical representation of the visual motion (see Section 3.5).

@&#RELATED WORKS@&#

In the literature several works develop vision systems for visual motion interpretation, based on neurophysiological and psychophysics evidence. A population coding of motion energy neurons with the aim of computing TTC is presented in [12], though the authors do not consider the log-polar mapping and they only tested their approach on simple real-world situations. A biologically motivated space-variant filtering method inspired by MT area for decreasing the noise in optic flow fields in order to estimate heading from optic flow is proposed in [13]. In [14] the space variant geometry of images is considered to implement a 1D array of elementary motion detectors.

A collision detection system, based on the Lobula Giant Movement Detector that does not model the primate visual system, is presented in [15], and a modified version of such a model has been implemented on FPGA and tested on simple scenarios in [16].

In [17] the authors present a model that aims to explain how different kinds of motion patterns can be represented and detected by a hierarchical feed-forward network consisting of multiple neural populations in the cortical areas V1, MT, MST, and 7a of primates, by incorporating selective attention processes. A biologically inspired vision architecture for driver assistance is described in [18]. Their approach gets inspiration from the underlying principles of the human vision system and does not model the hierarchical stages of the primate visual path. In [19], the authors present a model of the processing stages performed in the retina and V1 area, by taking into account the log-polar transform. Their approach can be at the basis of higher level processing steps, such as motion extraction and interpretation. A bio-inspired vision architecture that models the V1 and MT layers, used for action recognition and that do not address motion interpretation, is presented in [20]. Finally, a bio-inspired model for the computation of velocity gradients in video sequences, useful for visual navigation is proposed in [21].

In order to exploit the properties of the cortical representation, computer vision algorithms, previously developed for the Cartesian domain, have to be properly adapted before applying them on the space-variant images [22–25]. Specifically, in [26] the authors tackle the problem of 2D translation estimation in log-polar images, by taking into account how a simple linear translation is transformed by applying the log-polar mapping. A projection-based motion estimator in log-polar coordinates, which results in an efficient and effective active tracking algorithm is proposed in [27]. Moreover, a motion estimation algorithm suitable for log-polar images is proposed in [28]. It is worth noting that such specific modifications of the algorithms can be quite expensive from the computational point of view, and the algorithms need to be “re-designed” to be applied in the log-polar domain.

Several approaches in the literature address the problem of motion interpretation in log-polar domain. In [29], the authors compute TTC, by considering the derivative of the cortical optic flow. They also present some real-world experiments, though no quantitative evaluation is presented, nevertheless in their approach relationships between TTC in Cartesian domain and affine description in cortical one is not addressed. A first order motion estimation algorithm in log-polar domain is presented in [30]. They compute the affine description of the optic flow starting from the first order derivatives of the cortical images and derive the invariants with a least-squares method. A similar approach is adopted by [31]. Nevertheless, these approaches do not derive the relationships between motion parameters in the Cartesian domain and first order description in the log-polar domain, and they do not model the visual pathway in MST area.

A general approach to the computation of visual features directly in the cortical domain is presented in [32], where the authors show how it is possible to apply algorithms developed in the Cartesian domain directly on log-polar images without any modification, by a proper choice of the parameters of the log-polar transform.

A model for the extraction of image flow, inspired by the stages of the visual motion pathway of the primate brain, is proposed in [33]. Such a model is based on spatio-temporal filtering with Gabor functions [34] and on the computation of the motion energy [35]. The problem of detecting local image velocity is also addressed in [36], by a two stage model that first computes motion energies, then estimates velocity from these energies. The combination of the responses of the different cells, necessary to solve the aperture problem and to compute velocity, is the main difference between [33,36]. In [37] a computational model to compute local image velocity through a two layers architecture corresponding to V1 and MT cortical areas has been proposed.

More recently, an algorithm, based on a neural model, which computes low-level motion processing is described in [38]. Such an algorithm is able to extract image motion from real-world image sequences, but its computation speed depends on the presented input information. In [39], a neuromorphic robust optical flow estimation technique, based on reconfigurable hardware, is presented. Their approach takes inspiration from neurophysiological findings, though they do not mimic the hierarchical processing stages of the visual cortex. In [40], the authors propose a framework for modeling neural computational mechanisms of motion processing by using biologically inspired principles.

A recent review of optic flow estimation techniques, also not bio-inspired, and of evaluation methodology is presented in [41]. The databases and the metrics considered in our paper are compliant with this work.

Bio-inspired motion interpretation is based on the analysis performed by MST area of the primate visual system. A selectivity for specific optic flow patterns emerges in this area [42,9,10], and these studies validate the hypotheses of first-order analysis of optic flow performed in the brain [8]. In particular, the information about self-motion is derived by neurons in MST area [43]. However, some works, e.g. [44], reported an opposite experimental evidence that can lead to different hypotheses about the neural processing on which the motion interpretation is based. In this paper, we consider the approach based on the first-order analysis of optic flow.

In the Computer Vision literature, the first formulations of computational theories of the visual motion interpretation are described in [45,46]. In [47], the authors present a closed form solution for motion interpretation that only uses first-order coefficients for two or more distinct planes.

More recently, experimental neuroscience and psychophysics [6,7] experiments have shown how motion interpretation is performed in MT and MST areas. Starting and taking inspiration from these studies, some authors propose bio-inspired approaches for motion interpretation. In [48], the authors present a neural model that simulates MST cells’ responses, also by taking into account cortical magnification, but no real-world applications are presented. A biologically motivated population coding of motion energy neuron to estimate TTC is presented in [12], and a bio-inspired model for the computation of the velocity gradients in image sequences is described in [21]. A template model of heading estimation based on the properties of MST neurons is presented in [49]. In [50] a framework to recover the first order description of the optic flow is proposed and used to estimate the 3D orientations of the surfaces and the TTC in real world situations. In such a work, the authors only address the affine description of the optic flow and its interpretation, and do not consider the complete visual pathway, i.e. the log-polar transform and the optic flow computation.

The proposed bio-inspired vision system is described in Fig. 1
                        . Such a system models the processing stages of the dorsal pathway of the visual cortex [1,2]:
                           
                              –
                              Each Cartesian image of a sequence is transformed into its cortical representation through a log-polar mapping that implements the blind-spot model (BSM) (see Section 3.2). This mimics the retino-cortical transformation of the primate visual system [3,51].

The cortical optic flow is computed by using a three-layer population of cells. In the first layer a population of spatio-temporal oriented Gabor filters approximates the simple cells of area V1, which are tuned to different motion directions and contribute to build complex cells as motion energy units in the second layer. The responses of the complex cells are combined in the third layer that, as a whole, encodes the magnitude and direction of velocities, as it occurs along the extrastriate motion pathway, between area MT and MST [52–54] (see Section 3.3), and then the responses are decoded to estimate the cortical optic flow.

The sensitivity to motion patterns [42] that has been found in area MST is modeled through a population of adaptive templates, which represent the elementary flow components (EFCs) [9]. From the responses of such a population we compute the first order description [8] of the cortical optic flow (see Sections 3.4 and Appendix A).

MST area also contains a representation of self-motion, which is an important requirement in robotics [43,2]. The motion interpretation [6], i.e. the estimation of the 3D orientation of the surfaces and of the TTC (see Appendix B), is performed with respect to the Cartesian coordinates by using the first-order descriptors computed in the cortical domain. Though such estimation represents an “interaction” with the real-world, it can be directly computed from the cortical first order descriptors, as it happens in the visual cortex. To obtain such an “interaction”, the relationships among the cortical descriptors and the Cartesian ones in the area of interest must be devised (see Section 3.5).

Different models for transforming the Cartesian images into the log-polar domain have been proposed [55,56,51]. The blind-spot model is particularly interesting, for its properties of rotation and scale invariance, and for the simplicity of its implementation.

In the BSM, the transformation from the Cartesian domain 
                           
                              (
                              x
                              ,
                              y
                              )
                           
                         to the cortical domain of coordinates 
                           
                              (
                              ξ
                              ,
                              θ
                              )
                           
                        , is described by the following equations:
                           
                              (1)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ξ
                                                   =
                                                   
                                                      
                                                         log
                                                      
                                                      
                                                         a
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  ρ
                                                               
                                                               
                                                                  
                                                                     
                                                                        ρ
                                                                     
                                                                     
                                                                        0
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   θ
                                                   =
                                                   η
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where a parameterizes the non-linearity of the mapping, 
                           
                              
                                 
                                    ρ
                                 
                                 
                                    0
                                 
                              
                           
                         is the radius of the central blind spot, and 
                           
                              (
                              ρ
                              ,
                              η
                              )
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             
                                                
                                                   y
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       ,
                                       arctan
                                       (
                                       y
                                       /
                                       x
                                       )
                                    
                                 
                              
                           
                         are the polar coordinates derived from the Cartesian ones. All points with 
                           
                              ρ
                              <
                              
                                 
                                    ρ
                                 
                                 
                                    0
                                 
                              
                           
                         are ignored.

In order to deal with digital images, given a Cartesian image 
                           
                              I
                              (
                              x
                              ,
                              y
                              ,
                              
                                 
                                    t
                                 
                                 
                                    0
                                 
                              
                              )
                           
                        , i.e. a frame of a sequence at time 
                           
                              
                                 
                                    t
                                 
                                 
                                    0
                                 
                              
                           
                        , of 
                           
                              M
                              ×
                              N
                           
                         pixels, and defined 
                           
                              
                                 
                                    ρ
                                 
                                 
                                    max
                                 
                              
                              =
                              0.5
                              min
                              (
                              M
                              ,
                              N
                              )
                           
                        , we obtain an 
                           
                              R
                              ×
                              S
                           
                         (rings 
                           
                              ×
                           
                         sectors) discrete cortical image 
                           
                              
                                 
                                    I
                                 
                                 
                                    ∼
                                 
                              
                              (
                              
                                 
                                    ξ
                                 
                                 
                                    d
                                 
                              
                              ,
                              
                                 
                                    θ
                                 
                                 
                                    d
                                 
                              
                              ,
                              
                                 
                                    t
                                 
                                 
                                    0
                                 
                              
                              )
                           
                         of coordinates 
                           
                              (
                              
                                 
                                    ξ
                                 
                                 
                                    d
                                 
                              
                              ,
                              
                                 
                                    θ
                                 
                                 
                                    d
                                 
                              
                              )
                              =
                              (
                              ⌊
                              ξ
                              ⌋
                              ,
                              ⌊
                              q
                              η
                              ⌋
                              )
                           
                         where 
                           
                              ⌊
                              ·
                              ⌋
                           
                         denotes the integer part, 
                           
                              q
                              =
                              S
                              /
                              (
                              2
                              π
                              )
                           
                        , and 
                           
                              a
                              =
                              exp
                              (
                              ln
                              (
                              
                                 
                                    ρ
                                 
                                 
                                    max
                                 
                              
                              /
                              
                                 
                                    ρ
                                 
                                 
                                    0
                                 
                              
                              )
                              /
                              R
                              )
                           
                        . We can define the compression ratio (CR) of the cortical image with respect to the Cartesian one as:
                           
                              (2)
                              
                                 CR
                                 =
                                 
                                    
                                       M
                                       ×
                                       N
                                    
                                    
                                       R
                                       ×
                                       S
                                    
                                 
                              
                           
                        It is worth noting that the discrete log-polar mapping performs a lossy compression of the Cartesian image.

The aspect ratio of a log-polar pixel is defined as 
                           
                              γ
                              =
                              2
                              π
                              /
                              (
                              S
                              (
                              a
                              -
                              1
                              )
                              )
                              =
                              w
                              /
                              h
                           
                        , where w is the width, defined as 
                           
                              w
                              =
                              (
                              2
                              π
                              /
                              S
                              )
                              
                                 
                                    ρ
                                 
                                 
                                    0
                                 
                              
                              
                                 
                                    a
                                 
                                 
                                    
                                       
                                          ξ
                                       
                                       
                                          d
                                       
                                    
                                    -
                                    1
                                 
                              
                           
                        , and h is the height, defined as 
                           
                              h
                              =
                              
                                 
                                    ρ
                                 
                                 
                                    0
                                 
                              
                              
                                 
                                    a
                                 
                                 
                                    
                                       
                                          ξ
                                       
                                       
                                          d
                                       
                                    
                                    -
                                    1
                                 
                              
                              (
                              a
                              -
                              1
                              )
                           
                        , of the log-polar pixel. In particular, we demonstrated [32] that the aspect ratio 
                           
                              γ
                           
                         of the log-polar pixel has to be 1 in order to compute visual features, directly in the cortical domain.


                        Fig. 2
                        (top) shows the log-polar pixels (log-polar receptive fields) in the Cartesian domain and the cortical domain. The red circle, with radius 
                           
                              S
                              /
                              2
                              π
                           
                        , represents the locus where the size of log-polar pixels is equal to the size of Cartesian pixels. In particular, in the area inside the red circle a single Cartesian pixel contributes to many log-polar pixels (oversampling), whereas outside this region many Cartesian pixels contribute to a single log-polar pixel, thus avoiding the aliasing due to the undersampling. This is pointed out in the log-polar pixel bordered in violet. An example of transformation from the Cartesian domain to the cortical domain and back to the retinal one is shown in Fig. 2(bottom).

In this work, the value of a cortical pixel is obtained through a bilinear interpolation of the values of the four nearest neighboring Cartesian pixels to the center of the corresponding log-polar pixel, since this technique is the best trade-off between the quality of the transformation and the computational load [57].

In [32], we present a set of rules for designing a discrete log-polar mapping that allows a direct application in the log-polar domain of the algorithms, based on spatial multi-scale and multi-orientation filtering, originally developed for the Cartesian domain without “ad hoc” modifications. This means that the RFs of the considered cells are affected by a negligible distortion due to the log-polar transformation, thus we can obtain the advantages of log-polar mapping without the drawbacks related to the distortions of the filters in the cortical domain. In particular, we adopt specific constraints on the aspect ratio of the log-polar pixel (i.e. 
                           
                              γ
                              =
                              1
                           
                        ) and on the spatial support of the filter in order to obtain undistorted RFs. Thus, the optic flow is computed from a sequence of cortical images by using a distributed bio-inspired architecture that resorts to a population of tuned cells, originally designed in the Cartesian domain. In the following, we present how such a population is exploited to compute the cortical flow.

The feature values (i.e. the cortical flow) are encoded by a population of units, tuned to different velocities 
                              
                                 
                                    
                                       v
                                    
                                    
                                       i
                                    
                                    
                                       ϕ
                                    
                                 
                              
                            along their spatial orientation 
                              
                                 ϕ
                              
                            
                           [37]. Each unit has a receptive field that is described by a complex-valued spatio-temporal Gabor filter (see Fig. 3): the real and imaginary part of such a filter model, from a functional point of view, a quadrature pair of simple cells in area V1 [35]. It is worth noting that in the literature several other functions have been proposed to fit the spatio-temporal frequency tuning of the actual V1 cells, e.g. the Gaussian derivatives [37]. Though, from a functional point of view, we have chosen the Gabor filters as an approximation of the RFs, since they provide better results in terms of low-level visual feature estimation [58].

A set of Gabor filters [34], 
                              
                                 g
                                 (
                                 ξ
                                 ,
                                 θ
                                 ,
                                 t
                                 ;
                                 ϕ
                                 ,
                                 ω
                                 ,
                                 
                                    
                                       ω
                                    
                                    
                                       t
                                    
                                 
                                 )
                              
                           , which uniformly sample both the orientation space and the spatio-temporal domain, is chosen in order to obtain the population of units. A complex-valued Gabor filter is defined by:
                              
                                 (3)
                                 
                                    g
                                    (
                                    ξ
                                    ,
                                    θ
                                    ,
                                    t
                                    ;
                                    ϕ
                                    ,
                                    ω
                                    ,
                                    
                                       
                                          ω
                                       
                                       
                                          t
                                       
                                    
                                    )
                                    =
                                    β
                                    
                                       
                                          e
                                       
                                       
                                          
                                             
                                                -
                                                
                                                   
                                                      
                                                         
                                                            ξ
                                                         
                                                         
                                                            ϕ
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                   
                                                      2
                                                      
                                                         
                                                            σ
                                                         
                                                         
                                                            ξ
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                                -
                                                
                                                   
                                                      
                                                         
                                                            θ
                                                         
                                                         
                                                            ϕ
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                   
                                                      2
                                                      
                                                         
                                                            σ
                                                         
                                                         
                                                            θ
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                                -
                                                
                                                   
                                                      
                                                         
                                                            t
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                   
                                                      2
                                                      
                                                         
                                                            σ
                                                         
                                                         
                                                            t
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          e
                                       
                                       
                                          j
                                          (
                                          ω
                                          
                                             
                                                ξ
                                             
                                             
                                                ϕ
                                             
                                          
                                          +
                                          
                                             
                                                ω
                                             
                                             
                                                t
                                             
                                          
                                          t
                                          )
                                       
                                    
                                    1
                                    (
                                    t
                                    )
                                 
                              
                           where 
                              
                                 ϕ
                              
                            is the rotation angle with respect to the horizontal axis, 
                              
                                 β
                              
                            is the normalization term, 
                              
                                 ω
                              
                            is the spatial radial peak frequency, 
                              
                                 
                                    
                                       ω
                                    
                                    
                                       t
                                    
                                 
                              
                            is the temporal peak frequency, 
                              
                                 
                                    
                                       σ
                                    
                                    
                                       ξ
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       σ
                                    
                                    
                                       θ
                                    
                                 
                              
                            determine the spatial supports of the filter, 
                              
                                 
                                    
                                       σ
                                    
                                    
                                       t
                                    
                                 
                              
                            determines the filter support in time domain,
                              1
                              The choice of considering different spatial and temporal supports, i.e. different values of 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ξ
                                          
                                       
                                    
                                  and 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             θ
                                          
                                       
                                    
                                  with respect to 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             t
                                          
                                       
                                    
                                 , allows us to take into account recent opinions about the non-symmetrical spatio-temporal bandwidths of the filters in the frequency domain [59].
                           
                           
                              1
                            
                           
                              
                                 (
                                 
                                    
                                       ξ
                                    
                                    
                                       ϕ
                                    
                                 
                                 ,
                                 
                                    
                                       θ
                                    
                                    
                                       ϕ
                                    
                                 
                                 )
                              
                            are the rotated spatial coordinates and 
                              
                                 1
                                 (
                                 t
                                 )
                              
                            denotes the unit step function by ensuring that the filter is causal. In the spatial domain, the orientation space is uniformly sampled using N filters oriented from 0 to 
                              
                                 2
                                 π
                              
                            and having the same radial peak frequency (see Fig. 3
                           , bottom row). Each unit is tuned to the velocity with magnitude 
                              
                                 
                                    
                                       v
                                    
                                    
                                       ϕ
                                    
                                 
                              
                            and direction orthogonal to the preferred spatial orientation 
                              
                                 ϕ
                              
                            of the filter. The spatial frequency 
                              
                                 ω
                              
                            is kept constant while the temporal peak frequency is varied by the rule 
                              
                                 
                                    
                                       ω
                                    
                                    
                                       t
                                    
                                 
                                 =
                                 
                                    
                                       v
                                    
                                    
                                       ϕ
                                    
                                 
                                 ω
                              
                           . For each spatial orientation, a set of M tuning velocities are chosen, accordingly to the limit imposed by the temporal support of the filter and by the Nyquist theorem (see Fig. 3, top row). The described quadrature pair of spatio-temporal receptive fields 
                              
                                 g
                                 (
                                 ξ
                                 ,
                                 θ
                                 ,
                                 t
                                 ;
                                 ϕ
                                 ,
                                 ω
                                 ,
                                 
                                    
                                       ω
                                    
                                    
                                       t
                                    
                                 
                                 )
                              
                            are used to convolve the image sequence 
                              
                                 
                                    
                                       I
                                    
                                    
                                       ∼
                                    
                                 
                                 (
                                 ξ
                                 ,
                                 θ
                                 ,
                                 t
                                 )
                              
                           , thus obtaining a complex-valued response for each 
                              
                                 
                                    
                                       v
                                    
                                    
                                       ϕ
                                    
                                 
                              
                           :
                              
                                 (4)
                                 
                                    Q
                                    (
                                    ξ
                                    ,
                                    θ
                                    ,
                                    t
                                    ;
                                    ϕ
                                    ,
                                    ω
                                    ,
                                    
                                       
                                          v
                                       
                                       
                                          ϕ
                                       
                                    
                                    )
                                    =
                                    ∭
                                    g
                                    (
                                    ξ
                                    -
                                    
                                       
                                          ξ
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    θ
                                    -
                                    
                                       
                                          θ
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    t
                                    -
                                    
                                       
                                          t
                                       
                                       
                                          ′
                                       
                                    
                                    ;
                                    ϕ
                                    ,
                                    ω
                                    ,
                                    
                                       
                                          ω
                                       
                                       
                                          t
                                       
                                    
                                    )
                                    
                                       
                                          I
                                       
                                       
                                          ∼
                                       
                                    
                                    (
                                    
                                       
                                          ξ
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    
                                       
                                          θ
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    
                                       
                                          t
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                    d
                                    
                                       
                                          ξ
                                       
                                       
                                          ′
                                       
                                    
                                    d
                                    
                                       
                                          θ
                                       
                                       
                                          ′
                                       
                                    
                                    
                                       
                                          dt
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                           
                        

Following [35] it is possible to compute the motion energy, as the squared modulus of the complex response (see Fig. 3, inset on the right):
                              
                                 (5)
                                 
                                    E
                                    (
                                    ξ
                                    ,
                                    θ
                                    ,
                                    t
                                    ;
                                    ϕ
                                    ,
                                    ω
                                    ,
                                    
                                       
                                          v
                                       
                                       
                                          ϕ
                                       
                                    
                                    )
                                    =
                                    |
                                    Q
                                    (
                                    ξ
                                    ,
                                    θ
                                    ,
                                    t
                                    ;
                                    ϕ
                                    ,
                                    ω
                                    ,
                                    
                                       
                                          v
                                       
                                       
                                          ϕ
                                       
                                    
                                    )
                                    
                                       
                                          |
                                       
                                       
                                          2
                                       
                                    
                                    .
                                 
                              
                           
                        

The response of the motion energy unit has its maximum when the tuning velocity is equal to the velocity present in the stimulus.

In the previous Section, we have described how the population activity encodes the features values along each spatial orientation 
                              
                                 ϕ
                              
                           . In order to obtain reliable estimates of the cortical flow, such an activity should be properly decoded. In the literature several decoding strategies are described and discussed [60].

In general, a strong relationships exists among the decoding strategy, the number of the cells in the population and their distribution. A simple decoding method is the winner takes all strategy, though a large number of cells along each spatial orientation would be necessary, thus increasing both the computational cost and the memory occupancy of the approach. More complex decoding methods, such as the maximum likelihood estimator, have been proposed in the literature [60], nevertheless we decided to adopt a weighted sum (i.e. a center of mass) of the responses for each orientation [61]. Such an approach to decode the population activity is the best compromise between simplicity, low computational cost and reliability of the estimates, since it allows us to obtain precise feature estimation, while keeping the number of cells as low as possible. It is worth noting that a comparison of the different decoding methods is out of the scope of this paper.

The component velocity 
                           
                              
                                 
                                    
                                       v
                                    
                                    
                                       c
                                    
                                    
                                       ϕ
                                    
                                 
                              
                            is obtained by:
                              
                                 (6)
                                 
                                    
                                       
                                          v
                                       
                                       
                                          c
                                       
                                       
                                          ϕ
                                       
                                    
                                    (
                                    ξ
                                    ,
                                    θ
                                    ,
                                    t
                                    ;
                                    ϕ
                                    ,
                                    ω
                                    )
                                    =
                                    
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                =
                                                1
                                             
                                             
                                                M
                                             
                                          
                                          
                                             
                                                v
                                             
                                             
                                                i
                                             
                                             
                                                ϕ
                                             
                                          
                                          E
                                          (
                                          ξ
                                          ,
                                          θ
                                          ,
                                          t
                                          ;
                                          ϕ
                                          ,
                                          ω
                                          ,
                                          
                                             
                                                v
                                             
                                             
                                                ϕ
                                             
                                          
                                          )
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                =
                                                1
                                             
                                             
                                                M
                                             
                                          
                                          E
                                          (
                                          ξ
                                          ,
                                          θ
                                          ,
                                          t
                                          ;
                                          ϕ
                                          ,
                                          ω
                                          ,
                                          
                                             
                                                v
                                             
                                             
                                                ϕ
                                             
                                          
                                          )
                                       
                                    
                                 
                              
                           where 
                              
                                 
                                    
                                       v
                                    
                                    
                                       i
                                    
                                    
                                       ϕ
                                    
                                 
                              
                            are the M tuning velocities.

A single oriented filter cannot estimate the feature, but only the component orthogonal to the filter’s orientation, i.e. the velocity 
                              
                                 
                                    
                                       v
                                    
                                    
                                       c
                                    
                                    
                                       ϕ
                                    
                                 
                              
                           . The aperture problem is solved by combining for each spatial location the estimates of 
                              
                                 
                                    
                                       v
                                    
                                    
                                       c
                                    
                                    
                                       ϕ
                                    
                                 
                              
                            for each spatial orientation, in order to obtain a robust estimate of the full cortical velocity 
                              
                                 v
                              
                           , through the following minimization:
                              
                                 (7)
                                 
                                    v
                                    (
                                    ξ
                                    ,
                                    θ
                                    ,
                                    t
                                    ;
                                    ω
                                    )
                                    =
                                    
                                       
                                          
                                             arg
                                             
                                             min
                                          
                                          
                                             v
                                             (
                                             ξ
                                             ,
                                             θ
                                             ,
                                             t
                                             ;
                                             ω
                                             )
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             ϕ
                                             =
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   1
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   N
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          f
                                       
                                       
                                          ϕ
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      c
                                                   
                                                   
                                                      ϕ
                                                   
                                                
                                                (
                                                ξ
                                                ,
                                                θ
                                                ,
                                                t
                                                ;
                                                ϕ
                                                ,
                                                ω
                                                )
                                                -
                                                v
                                                (
                                                ξ
                                                ,
                                                θ
                                                ,
                                                t
                                                ;
                                                ω
                                                )
                                                ·
                                                
                                                   
                                                      
                                                         
                                                            cos
                                                            ϕ
                                                            ,
                                                            sin
                                                            ϕ
                                                         
                                                      
                                                   
                                                   
                                                      T
                                                   
                                                
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                           where 
                              
                                 
                                    
                                       f
                                    
                                    
                                       ϕ
                                    
                                 
                              
                            is a function that allows us to suppress the oriented channels that give estimates under a certain confidence measure (usually expressed as a minimum threshold on the energy response).

Since information in natural images is spread over a wide range of frequencies, it is necessary to use a technique that allows us to get information from the whole range of frequencies. In this paper, the multi-scale processing (i.e. considering units tuned to different spatial frequencies 
                              
                                 ω
                              
                           ) is implemented by exploiting the pyramidal decomposition [62] and a coarse-to-fine refinement, which is a computationally efficient way to take into account the presence of different spatial frequency channels in the visual cortex and their interactions. We start from the computation of the features (i.e. the cortical flow) at the coarsest level of the pyramid, then we expand such estimates and we use them to warp the sequence of the spatially convolved images, finally we compute the residual optic flow, and we iterate over all the pyramid levels. In this way, the distance between corresponding points among the different frames is iteratively reduced, and the residual values of the flow values lie in the filters’ range, thus yielding to more precise estimates. Moreover, as it has been shown in [52], MT neurons in the visual cortex follow a coarse-to-fine strategy, i.e. motion signals become more refined over time.

The vector fields computed in the cortical domain 
                              
                                 v
                                 (
                                 ξ
                                 ,
                                 θ
                                 ,
                                 t
                                 ;
                                 ω
                                 )
                              
                            (Eq. (7)) can be mapped to the retinal domain. This can be done, for instance, to show the motion pattern in the usual domain (
                              
                                 x
                                 ,
                                 y
                              
                           ). Such a transformation from the (
                              
                                 ξ
                                 ,
                                 θ
                              
                           ) domain to the (
                              
                                 x
                                 ,
                                 y
                              
                           ) domain can be expressed in terms of curvilinear coordinates transformation [63]:
                              
                                 (8)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            x
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            y
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∂
                                                            x
                                                         
                                                         
                                                            ∂
                                                            ξ
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            ∂
                                                            x
                                                         
                                                         
                                                            ∂
                                                            θ
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            ∂
                                                            y
                                                         
                                                         
                                                            ∂
                                                            ξ
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            ∂
                                                            y
                                                         
                                                         
                                                            ∂
                                                            θ
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            ξ
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            θ
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           
                        

Combining the inverse of Eqs. (1) and (8), we obtain:
                              
                                 (9)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            x
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            y
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          ρ
                                       
                                       
                                          0
                                       
                                    
                                    
                                       
                                          a
                                       
                                       
                                          ξ
                                       
                                    
                                    ln
                                    (
                                    a
                                    )
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      cos
                                                      θ
                                                   
                                                   
                                                      -
                                                      sin
                                                      θ
                                                   
                                                
                                                
                                                   
                                                      sin
                                                      θ
                                                   
                                                   
                                                      cos
                                                      θ
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            ξ
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            θ
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           
                        

The scalar coefficient of Eq. (9) represents the scale factor of the log-polar vector, and the matrix describes the rotation due to the mapping.


                           Fig. 4
                            shows how the optic flow patterns are transformed between the cortical and retinal domains. In particular, constant optic flows in the retinal domain correspond to non-linear flows in cortical domain, whereas expansion and rotation flow patterns map to constant flows along the 
                              
                                 ξ
                              
                            and the 
                              
                                 θ
                              
                            cortical axes, respectively. It is worth noting that, though an expansion is mapped into a constant cortical flow, small variations in the location of the focus of expansion will introduce non-linearities therein. Thus, in general, working in the cortical domain cannot be considered a simplification when dealing with real-world situations. However, it is worth noting that these complex cortical flows are not a problem by using the devised relationships of Section 3.5, since it is possible to recover the affine description of the Cartesian flow directly from the affine description of the cortical flow with small errors of approximation, thus we can easily handle complex optic flow patterns.

By following the processing scheme proposed in this paper, the sequences of images acquired by the camera are mapped into the cortical domain (see Eq. (1)), then the cortical optic flow is computed. Fig. 5
                            shows the transformation into the log-polar domain and the computed optic flow for the Yosemite sequence.

It is worth noting that the backward transformation from the cortical domain to the retinal one is shown for completeness and clarity, only. The further stages of the proposed model work on the cortical flow without requiring any backward transformation. However, we perform a quantitative evaluation of the retinal flow in order to allow an easy comparison with other approaches, which only provide estimates in the 
                              
                                 (
                                 x
                                 ,
                                 y
                                 )
                              
                            domain.

The reliability of the estimates has been evaluated through the average angular error (AAE) proposed in [64] with respect to the ground truth data of some standard benchmarking sequences [41]. We have considered a compression ratio of the cortical image 
                              
                                 CR
                                 =
                                 5.5
                              
                           , and we have computed the AAE both in the parafoveal area (a circle of radius equals to one third of the image radius 
                              
                                 
                                    
                                       ρ
                                    
                                    
                                       max
                                    
                                 
                              
                            around the center of the image) and in the whole image. Table 1
                            shows that the errors in the parafoveal area are comparable to the ones obtained by some state-of-the-art bio-inspired approaches.


                           Fig. 6
                            shows how the AAE increases with the eccentricity, as we can expect due to the substantial data reduction in the periphery. Nevertheless, starting from the optic flow computed with our approach, although it does not show a low average angular error in the periphery, we are able to tackle motion interpretation problems, as we will show in the following.

The optic flow 
                           
                              v
                              =
                              
                                 
                                    (
                                    
                                       
                                          v
                                       
                                       
                                          ξ
                                       
                                    
                                    ,
                                    
                                       
                                          v
                                       
                                       
                                          θ
                                       
                                    
                                    )
                                 
                                 
                                    T
                                 
                              
                           
                         can be described in terms of its linear decomposition through its first-order components. From this perspective, local spatial features around a given location of the flow field can be of two types: (1) the average flow velocity at that location, and (2) the structure of the local variation in a neighborhood of that locality. The former relates to the smoothness constraint or structural uniformity, whereas the latter relates to linearity constraint or structural gradients [8]. Velocity gradients provide important cues about the 3D layout of the visual scene in the Cartesian domain. In Section 3.5 we will derive the relationships to describe such scene properties directly in terms of first order components in the cortical domain. Formally, velocity gradients can be described as linear deformations by a first-order Taylor decomposition, around the cortical image point 
                           
                              
                                 
                                    (
                                    
                                       
                                          ξ
                                       
                                       
                                          0
                                       
                                    
                                    ,
                                    
                                       
                                          θ
                                       
                                       
                                          0
                                       
                                    
                                    )
                                 
                                 
                                    T
                                 
                              
                           
                        : 
                           
                              v
                              =
                              
                                 
                                    v
                                 
                                 
                                    ¯
                                 
                              
                              +
                              
                                 
                                    T
                                 
                                 
                                    ¯
                                 
                              
                              ·
                              
                                 
                                    [
                                    ξ
                                    ,
                                    θ
                                    ]
                                 
                                 
                                    T
                                 
                              
                           
                        , where 
                           
                              
                                 
                                    v
                                 
                                 
                                    ¯
                                 
                              
                              =
                              v
                              
                                 
                                    |
                                 
                                 
                                    (
                                    
                                       
                                          ξ
                                       
                                       
                                          0
                                       
                                    
                                    ,
                                    
                                       
                                          θ
                                       
                                       
                                          0
                                       
                                    
                                    )
                                 
                              
                              -
                              
                                 
                                    T
                                 
                                 
                                    ¯
                                 
                              
                              ·
                              
                                 
                                    [
                                    
                                       
                                          ξ
                                       
                                       
                                          0
                                       
                                    
                                    ,
                                    
                                       
                                          θ
                                       
                                       
                                          0
                                       
                                    
                                    ]
                                 
                                 
                                    T
                                 
                              
                           
                         and
                           
                              (10)
                              
                                 
                                    
                                       T
                                    
                                    
                                       ‾
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∂
                                                            
                                                               
                                                                  v
                                                               
                                                               
                                                                  ξ
                                                               
                                                            
                                                         
                                                         
                                                            ∂
                                                            ξ
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            ∂
                                                            
                                                               
                                                                  v
                                                               
                                                               
                                                                  ξ
                                                               
                                                            
                                                         
                                                         
                                                            ∂
                                                            θ
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            ∂
                                                            
                                                               
                                                                  v
                                                               
                                                               
                                                                  θ
                                                               
                                                            
                                                         
                                                         
                                                            ∂
                                                            ξ
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            ∂
                                                            
                                                               
                                                                  v
                                                               
                                                               
                                                                  θ
                                                               
                                                            
                                                         
                                                         
                                                            ∂
                                                            θ
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       (
                                       
                                          
                                             ξ
                                          
                                          
                                             0
                                          
                                       
                                       ,
                                       
                                          
                                             θ
                                          
                                          
                                             0
                                          
                                       
                                       )
                                    
                                 
                                 .
                              
                           
                        
                     

The symbol 
                           
                              ·
                              
                                 
                                    |
                                 
                                 
                                    ·
                                 
                              
                           
                         denotes the points around which we compute the Taylor expansion.

By breaking down the tensor in its dyadic components, the motion field can be locally described through vector fields basis, representing elementary flow components:
                           
                              (11)
                              
                                 v
                                 =
                                 
                                    
                                       α
                                    
                                    
                                       ξ
                                    
                                 
                                 
                                    
                                       
                                          
                                             v
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       ξ
                                    
                                 
                                 +
                                 
                                    
                                       α
                                    
                                    
                                       θ
                                    
                                 
                                 
                                    
                                       
                                          
                                             v
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       θ
                                    
                                 
                                 +
                                 
                                    
                                       d
                                    
                                    
                                       ξ
                                    
                                    
                                       ξ
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∂
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         ξ
                                                      
                                                   
                                                
                                                
                                                   ∂
                                                   ξ
                                                
                                             
                                          
                                       
                                    
                                    
                                       (
                                       
                                          
                                             ξ
                                          
                                          
                                             0
                                          
                                       
                                       ,
                                       
                                          
                                             θ
                                          
                                          
                                             0
                                          
                                       
                                       )
                                    
                                 
                                 +
                                 
                                    
                                       d
                                    
                                    
                                       θ
                                    
                                    
                                       ξ
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∂
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         ξ
                                                      
                                                   
                                                
                                                
                                                   ∂
                                                   θ
                                                
                                             
                                          
                                       
                                    
                                    
                                       (
                                       
                                          
                                             ξ
                                          
                                          
                                             0
                                          
                                       
                                       ,
                                       
                                          
                                             θ
                                          
                                          
                                             0
                                          
                                       
                                       )
                                    
                                 
                                 +
                                 
                                    
                                       d
                                    
                                    
                                       ξ
                                    
                                    
                                       θ
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∂
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         θ
                                                      
                                                   
                                                
                                                
                                                   ∂
                                                   ξ
                                                
                                             
                                          
                                       
                                    
                                    
                                       (
                                       
                                          
                                             ξ
                                          
                                          
                                             0
                                          
                                       
                                       ,
                                       
                                          
                                             θ
                                          
                                          
                                             0
                                          
                                       
                                       )
                                    
                                 
                                 +
                                 
                                    
                                       d
                                    
                                    
                                       θ
                                    
                                    
                                       θ
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∂
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         θ
                                                      
                                                   
                                                
                                                
                                                   ∂
                                                   θ
                                                
                                             
                                          
                                       
                                    
                                    
                                       (
                                       
                                          
                                             ξ
                                          
                                          
                                             0
                                          
                                       
                                       ,
                                       
                                          
                                             θ
                                          
                                          
                                             0
                                          
                                       
                                       )
                                    
                                 
                                 ,
                              
                           
                        where 
                           
                              
                                 
                                    α
                                 
                                 
                                    ξ
                                 
                              
                              :
                              (
                              ξ
                              ,
                              θ
                              )
                              
                              ↦
                              
                              (
                              1
                              ,
                              0
                              )
                              ,
                              
                                 
                                    α
                                 
                                 
                                    θ
                                 
                              
                              :
                              (
                              ξ
                              ,
                              θ
                              )
                              
                              ↦
                              
                              (
                              0
                              ,
                              1
                              )
                           
                         are pure translations and 
                           
                              
                                 
                                    d
                                 
                                 
                                    ξ
                                 
                                 
                                    ξ
                                 
                              
                              :
                              (
                              ξ
                              ,
                              θ
                              )
                              
                              ↦
                              
                              (
                              ξ
                              ,
                              0
                              )
                              ,
                              
                                 
                                    d
                                 
                                 
                                    θ
                                 
                                 
                                    ξ
                                 
                              
                              :
                              (
                              ξ
                              ,
                              θ
                              )
                              
                              ↦
                              
                              (
                              θ
                              ,
                              0
                              )
                           
                        , 
                           
                              
                                 
                                    d
                                 
                                 
                                    ξ
                                 
                                 
                                    θ
                                 
                              
                              :
                              (
                              ξ
                              ,
                              θ
                              )
                              
                              ↦
                              
                              (
                              0
                              ,
                              ξ
                              )
                              ,
                              
                                 
                                    d
                                 
                                 
                                    θ
                                 
                                 
                                    θ
                                 
                              
                              :
                              (
                              ξ
                              ,
                              θ
                              )
                              
                              ↦
                              
                              (
                              0
                              ,
                              θ
                              )
                           
                         represent cardinal deformations (see Fig. 7
                        ), basis of a linear deformation space.

It is worth noting that Eq. (11) describes, in fact, an affine model:
                           
                              (12)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         ξ
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         θ
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               c
                                                            
                                                            
                                                               ̃
                                                            
                                                         
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               c
                                                            
                                                            
                                                               ̃
                                                            
                                                         
                                                      
                                                      
                                                         4
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               c
                                                            
                                                            
                                                               ̃
                                                            
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               c
                                                            
                                                            
                                                               ̃
                                                            
                                                         
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               c
                                                            
                                                            
                                                               ̃
                                                            
                                                         
                                                      
                                                      
                                                         5
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               c
                                                            
                                                            
                                                               ̃
                                                            
                                                         
                                                      
                                                      
                                                         6
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 ·
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ξ
                                                
                                             
                                             
                                                
                                                   θ
                                                
                                             
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        where 
                           
                              
                                 
                                    
                                       
                                          c
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                           
                         are constants and 
                           
                              
                                 
                                    v
                                 
                                 
                                    ξ
                                 
                              
                           
                         and 
                           
                              
                                 
                                    v
                                 
                                 
                                    θ
                                 
                              
                           
                         are the components of the cortical optic flow. The parameter vector 
                           
                              [
                              
                                 
                                    
                                       
                                          c
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          c
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    
                                       
                                          c
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    6
                                 
                              
                              ]
                           
                         describes a specific configuration of the optic flow that locally provides a good approximation of 3D rigid body motions (see Appendix B for the relationships among the affine coefficients in the Cartesian domain and the motion parameters and Section 3.5 for the relationships between the cortical and Cartesian affine description). The six parameter affine model is reasonable to describe the motions of a smooth surface in small image regions.

In [50], we describe an approach for the recovery of EFCs, based on adaptive pattern matching operations in the Cartesian domain, with a population of templates inspired by the properties of neurons of the primate visual system (see Appendix A): in particular, we consider their selectivity for specific patterns of optic flow [42,9,10], as a validation of the hypotheses of first-order analysis of optic flow [8], but different approaches are possible, e.g. [49]. Thus, in this paper, we follow the same approach proposed in [50], without any specific modification in order to recover the affine description of the cortical optic flow.

In order to compute the orientation of the surfaces and the TTC of real-world objects (i.e. in Cartesian coordinates, see Appendix B) through the affine description of the cortical flow (see Eq. (12)), it is necessary to derive the relationships among the affine coefficients of the cortical flow and the ones of the corresponding retinal flow. It is worth noting that transforming backward the cortical affine coefficients does not produce the affine description of the backward transformed optic flow. Thus, a different approach must be devised.

By considering an affine local description of the Cartesian optic flow:
                           
                              (13)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         x
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         y
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         4
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         5
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         6
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 ·
                                 
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                             
                                             
                                                
                                                   y
                                                
                                             
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        the inverse of the curvilinear coordinates transformation (Eq. (9)):
                           
                              (14)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         ξ
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         θ
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       
                                          
                                             ρ
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             a
                                          
                                          
                                             ξ
                                          
                                       
                                       ln
                                       (
                                       a
                                       )
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   cos
                                                   θ
                                                
                                                
                                                   sin
                                                   θ
                                                
                                             
                                             
                                                
                                                   -
                                                   sin
                                                   θ
                                                
                                                
                                                   cos
                                                   θ
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         x
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         y
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        and the inverse of the log-polar transformation (Eq. (1)), we obtain the cortical representation of an affine Cartesian optic flow:
                           
                              (15)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         ξ
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         θ
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       ln
                                       (
                                       a
                                       )
                                    
                                 
                                 ·
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               a
                                                            
                                                            
                                                               -
                                                               ξ
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               ρ
                                                            
                                                            
                                                               0
                                                            
                                                         
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   cos
                                                   θ
                                                   +
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         4
                                                      
                                                   
                                                   sin
                                                   θ
                                                   )
                                                   +
                                                   (
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         5
                                                      
                                                   
                                                   )
                                                   
                                                      
                                                         sin
                                                         2
                                                         θ
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         cos
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   θ
                                                   +
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         6
                                                      
                                                   
                                                   
                                                      
                                                         sin
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   θ
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               a
                                                            
                                                            
                                                               -
                                                               ξ
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               ρ
                                                            
                                                            
                                                               0
                                                            
                                                         
                                                      
                                                   
                                                   (
                                                   -
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   sin
                                                   θ
                                                   +
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         4
                                                      
                                                   
                                                   cos
                                                   θ
                                                   )
                                                   +
                                                   (
                                                   -
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         6
                                                      
                                                   
                                                   )
                                                   
                                                      
                                                         sin
                                                         2
                                                         θ
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         5
                                                      
                                                   
                                                   
                                                      
                                                         cos
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   θ
                                                   -
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                   
                                                      
                                                         sin
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   θ
                                                
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                     

In order to correctly exploit the affine description of such a cortical flow, obtained through adaptive pattern matching operations, we must consider the first order description of 
                           
                              (
                              
                                 
                                    v
                                 
                                 
                                    ξ
                                 
                              
                              ,
                              
                                 
                                    v
                                 
                                 
                                    θ
                                 
                              
                              )
                           
                        . Thus, we compute the Taylor expansion of Eq. (15) at 
                           
                              (
                              
                                 
                                    ξ
                                 
                                 
                                    0
                                 
                              
                              ,
                              
                                 
                                    θ
                                 
                                 
                                    0
                                 
                              
                              )
                           
                        .

The constant terms 
                           
                              
                                 
                                    
                                       
                                          c
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    1
                                 
                              
                           
                         and 
                           
                              
                                 
                                    
                                       
                                          c
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    4
                                 
                              
                           
                         are the values of the cortical flow (Eq. (15)) computed in 
                           
                              (
                              
                                 
                                    ξ
                                 
                                 
                                    0
                                 
                              
                              ,
                              
                                 
                                    θ
                                 
                                 
                                    0
                                 
                              
                              )
                           
                        , and the partial derivatives are:
                           
                              (16)
                              
                                 
                                    
                                       
                                          
                                             c
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       v
                                    
                                    
                                       ξ
                                    
                                 
                                 (
                                 
                                    
                                       ξ
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 
                                    
                                       θ
                                    
                                    
                                       0
                                    
                                 
                                 )
                              
                           
                        
                        
                           
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                             =
                                             
                                                
                                                   ∂
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         ξ
                                                      
                                                   
                                                
                                                
                                                   ∂
                                                   ξ
                                                
                                             
                                             =
                                             -
                                             
                                                
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         -
                                                         ξ
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         ρ
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                
                                             
                                             (
                                             
                                                
                                                   c
                                                
                                                
                                                   1
                                                
                                             
                                             cos
                                             θ
                                             +
                                             
                                                
                                                   c
                                                
                                                
                                                   4
                                                
                                             
                                             sin
                                             θ
                                             )
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   3
                                                
                                             
                                             =
                                             
                                                
                                                   ∂
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         ξ
                                                      
                                                   
                                                
                                                
                                                   ∂
                                                   θ
                                                
                                             
                                             =
                                             -
                                             
                                                
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         -
                                                         ξ
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         ρ
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   ln
                                                   (
                                                   a
                                                   )
                                                
                                             
                                             (
                                             
                                                
                                                   c
                                                
                                                
                                                   1
                                                
                                             
                                             sin
                                             θ
                                             -
                                             
                                                
                                                   c
                                                
                                                
                                                   4
                                                
                                             
                                             cos
                                             θ
                                             )
                                             +
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                             
                                                
                                                   1
                                                
                                                
                                                   ln
                                                   (
                                                   a
                                                   )
                                                
                                             
                                             (
                                             (
                                             
                                                
                                                   c
                                                
                                                
                                                   6
                                                
                                             
                                             -
                                             
                                                
                                                   c
                                                
                                                
                                                   2
                                                
                                             
                                             )
                                             sin
                                             2
                                             θ
                                             +
                                             (
                                             
                                                
                                                   c
                                                
                                                
                                                   3
                                                
                                             
                                             +
                                             
                                                
                                                   c
                                                
                                                
                                                   5
                                                
                                             
                                             )
                                             cos
                                             2
                                             θ
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   4
                                                
                                             
                                             =
                                             
                                                
                                                   v
                                                
                                                
                                                   θ
                                                
                                             
                                             (
                                             
                                                
                                                   ξ
                                                
                                                
                                                   0
                                                
                                             
                                             ,
                                             
                                                
                                                   θ
                                                
                                                
                                                   0
                                                
                                             
                                             )
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   5
                                                
                                             
                                             =
                                             
                                                
                                                   ∂
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         θ
                                                      
                                                   
                                                
                                                
                                                   ∂
                                                   ξ
                                                
                                             
                                             =
                                             
                                                
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         -
                                                         ξ
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         ρ
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                
                                             
                                             (
                                             
                                                
                                                   c
                                                
                                                
                                                   1
                                                
                                             
                                             sin
                                             θ
                                             -
                                             
                                                
                                                   c
                                                
                                                
                                                   4
                                                
                                             
                                             cos
                                             θ
                                             )
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   6
                                                
                                             
                                             =
                                             
                                                
                                                   ∂
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         θ
                                                      
                                                   
                                                
                                                
                                                   ∂
                                                   θ
                                                
                                             
                                             =
                                             -
                                             
                                                
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         -
                                                         ξ
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         ρ
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   ln
                                                   (
                                                   a
                                                   )
                                                
                                             
                                             (
                                             
                                                
                                                   c
                                                
                                                
                                                   1
                                                
                                             
                                             cos
                                             θ
                                             +
                                             
                                                
                                                   c
                                                
                                                
                                                   4
                                                
                                             
                                             sin
                                             θ
                                             )
                                             +
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                             
                                                
                                                   1
                                                
                                                
                                                   ln
                                                   (
                                                   a
                                                   )
                                                
                                             
                                             (
                                             (
                                             
                                                
                                                   c
                                                
                                                
                                                   6
                                                
                                             
                                             -
                                             
                                                
                                                   c
                                                
                                                
                                                   2
                                                
                                             
                                             )
                                             cos
                                             2
                                             θ
                                             -
                                             (
                                             
                                                
                                                   c
                                                
                                                
                                                   3
                                                
                                             
                                             +
                                             
                                                
                                                   c
                                                
                                                
                                                   5
                                                
                                             
                                             )
                                             sin
                                             2
                                             θ
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

In this way, we obtain six relationships that locally relate the affine coefficients 
                           
                              [
                              
                                 
                                    
                                       
                                          c
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          c
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    
                                       
                                          c
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    6
                                 
                              
                              ]
                           
                        , computed on the cortical optic flow, to the affine coefficients of the corresponding Cartesian optic flow 
                           
                              [
                              
                                 
                                    c
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    c
                                 
                                 
                                    2
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    c
                                 
                                 
                                    6
                                 
                              
                              ]
                           
                        . We can solve the resulting equations system, thus obtaining:
                           
                              (17)
                              
                                 
                                    
                                       c
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       ρ
                                    
                                    
                                       0
                                    
                                 
                                 
                                    
                                       a
                                    
                                    
                                       ξ
                                    
                                 
                                 (
                                 -
                                 
                                    
                                       
                                          
                                             c
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                                 cos
                                 θ
                                 +
                                 
                                    
                                       
                                          
                                             c
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       5
                                    
                                 
                                 sin
                                 θ
                                 )
                              
                           
                        
                        
                           
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   2
                                                
                                             
                                             =
                                             
                                                
                                                   1
                                                
                                                
                                                   2
                                                
                                             
                                             (
                                             2
                                             
                                                
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   1
                                                
                                             
                                             ln
                                             (
                                             a
                                             )
                                             +
                                             
                                                
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                             (
                                             1
                                             +
                                             cos
                                             2
                                             θ
                                             )
                                             -
                                             
                                                
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   3
                                                
                                             
                                             ln
                                             (
                                             a
                                             )
                                             sin
                                             2
                                             θ
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                             -
                                             
                                                
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   5
                                                
                                             
                                             sin
                                             2
                                             θ
                                             +
                                             
                                                
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   6
                                                
                                             
                                             ln
                                             (
                                             a
                                             )
                                             (
                                             1
                                             -
                                             cos
                                             2
                                             θ
                                             )
                                             )
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   3
                                                
                                             
                                             =
                                             
                                                
                                                   1
                                                
                                                
                                                   2
                                                
                                             
                                             (
                                             
                                                
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                             sin
                                             2
                                             θ
                                             +
                                             
                                                
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   3
                                                
                                             
                                             ln
                                             (
                                             a
                                             )
                                             (
                                             1
                                             +
                                             cos
                                             2
                                             θ
                                             )
                                             -
                                             2
                                             
                                                
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   4
                                                
                                             
                                             ln
                                             (
                                             a
                                             )
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                             -
                                             
                                                
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   5
                                                
                                             
                                             (
                                             1
                                             -
                                             cos
                                             2
                                             θ
                                             )
                                             -
                                             
                                                
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   6
                                                
                                             
                                             ln
                                             (
                                             a
                                             )
                                             sin
                                             2
                                             θ
                                             )
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   4
                                                
                                             
                                             =
                                             
                                                
                                                   ρ
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   a
                                                
                                                
                                                   ξ
                                                
                                             
                                             (
                                             
                                                
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                             sin
                                             θ
                                             +
                                             
                                                
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   5
                                                
                                             
                                             cos
                                             θ
                                             )
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   5
                                                
                                             
                                             =
                                             
                                                
                                                   1
                                                
                                                
                                                   2
                                                
                                             
                                             (
                                             
                                                
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                             sin
                                             2
                                             θ
                                             -
                                             
                                                
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   3
                                                
                                             
                                             ln
                                             (
                                             a
                                             )
                                             (
                                             1
                                             -
                                             cos
                                             2
                                             θ
                                             )
                                             +
                                             2
                                             
                                                
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   4
                                                
                                             
                                             ln
                                             (
                                             a
                                             )
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                             +
                                             
                                                
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   5
                                                
                                             
                                             (
                                             1
                                             +
                                             cos
                                             2
                                             θ
                                             )
                                             -
                                             
                                                
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   6
                                                
                                             
                                             sin
                                             2
                                             θ
                                             )
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   6
                                                
                                             
                                             =
                                             
                                                
                                                   1
                                                
                                                
                                                   2
                                                
                                             
                                             (
                                             2
                                             
                                                
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   1
                                                
                                             
                                             ln
                                             (
                                             a
                                             )
                                             +
                                             
                                                
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                             (
                                             1
                                             -
                                             cos
                                             2
                                             θ
                                             )
                                             +
                                             
                                                
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   3
                                                
                                             
                                             ln
                                             (
                                             a
                                             )
                                             sin
                                             2
                                             θ
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                             +
                                             
                                                
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   5
                                                
                                             
                                             sin
                                             2
                                             θ
                                             +
                                             
                                                
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   6
                                                
                                             
                                             ln
                                             (
                                             a
                                             )
                                             (
                                             1
                                             +
                                             cos
                                             2
                                             θ
                                             )
                                             )
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

These relationships allow us to directly describe the orientation of the surfaces and the TTC of real-world objects as a function of the affine coefficients computed in the cortical domain. As an example, the TTC in its simplest formulation 
                           
                              
                                 
                                    t
                                 
                                 
                                    c
                                 
                              
                              =
                              2
                              /
                              div
                              v
                              =
                              2
                              /
                              (
                              
                                 
                                    c
                                 
                                 
                                    2
                                 
                              
                              +
                              
                                 
                                    c
                                 
                                 
                                    6
                                 
                              
                              )
                           
                         can be expressed as:
                           
                              (18)
                              
                                 
                                    
                                       t
                                    
                                    
                                       c
                                    
                                 
                                 =
                                 
                                    
                                       2
                                    
                                    
                                       
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   ̃
                                                
                                             
                                          
                                          
                                             1
                                          
                                       
                                       ln
                                       (
                                       a
                                       )
                                       +
                                       
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   ̃
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   ̃
                                                
                                             
                                          
                                          
                                             6
                                          
                                       
                                       ln
                                       (
                                       a
                                       )
                                    
                                 
                                 .
                              
                           
                        
                     


                        Quantitative evaluation. In general, a motion pattern that can be described through an affine model in the Cartesian domain corresponds to a non-linear cortical optic flow (see Fig. 4). The proposed approach is based on the recovery of the local affine description of such a cortical flow, thus producing an approximation error. To validate such an approach and the technique based on adaptive pattern matching operations, we used synthetic stimuli. In particular, for a given set of affine coefficients 
                           
                              
                                 
                                    
                                       
                                          
                                             c
                                          
                                          
                                             1
                                          
                                          
                                             ∗
                                          
                                       
                                       ,
                                       
                                          
                                             c
                                          
                                          
                                             2
                                          
                                          
                                             ∗
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             c
                                          
                                          
                                             6
                                          
                                          
                                             ∗
                                          
                                       
                                    
                                 
                              
                           
                         in the Cartesian domain we compute the cortical optic flow by using Eq. (14), in order not to introduce any further approximation except for the log-polar mapping. Then, we compute the cortical affine coefficients 
                           
                              [
                              
                                 
                                    
                                       
                                          c
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          c
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    
                                       
                                          c
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    6
                                 
                              
                              ]
                           
                         by using the adaptive pattern matching operations, and we combine them through Eq. (17) to obtain the corresponding Cartesian affine coefficients 
                           
                              [
                              
                                 
                                    c
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    c
                                 
                                 
                                    2
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    c
                                 
                                 
                                    6
                                 
                              
                              ]
                           
                        . Finally, the average error among the given Cartesian coefficients and the recovered ones is evaluated.


                        Fig. 8
                         shows the maps (for each cortical location) of cortical affine coefficients and the corresponding Cartesian ones computed through Eq. (17) for three different configurations of given Cartesian coefficients. In particular, we have considered: (i) an expansion (Fig. 8 top), which in the cortical domain is represented by a constant flow along the 
                           
                              ξ
                           
                         axis, thus by a constant 
                           
                              
                                 
                                    
                                       
                                          c
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    1
                                 
                              
                           
                         map. In this case, the linear approximation of the cortical flow introduces numerical errors only (always below 
                           
                              
                                 
                                    10
                                 
                                 
                                    -
                                    6
                                 
                              
                           
                        ). (ii) An expansion with a constant translation, i.e. the focus of expansion is not in the center of image (Fig. 8 middle), which is represented by a non-linear cortical flow with variation along both 
                           
                              ξ
                           
                         and 
                           
                              θ
                           
                         axes, thus by non-zero 
                           
                              [
                              
                                 
                                    
                                       
                                          c
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          c
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    
                                       
                                          c
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    6
                                 
                              
                              ]
                           
                         maps. Notwithstanding the non-linearity of the cortical flow (thus the maps of the cortical affine coefficients are not constant), the local affine description does not introduce significant errors (thus the maps of the corresponding computed Cartesian coefficients are constant). (iii) A deformation (Fig. 8 bottom), which is transformed into a non-linear cortical flow, thus the same consideration of the previous point are valid.

It is worth noting that the proposed approach locally approximates the optic flow through an affine model, thus the estimated coefficients can vary with respect to different spatial locations. In order to show that the adaptive pattern matching operation is able to locally estimate the affine coefficients, we have considered different combinations of Cartesian affine coefficients for different spatial location in the 
                           
                              (
                              x
                              ,
                              y
                              )
                           
                         domain. Fig. 9
                         shows that such coefficients are correctly estimated with our method. The 
                           
                              [
                              
                                 
                                    c
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    c
                                 
                                 
                                    2
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    c
                                 
                                 
                                    6
                                 
                              
                              ]
                           
                         maps have similar values (i.e. similar colors) of the given 
                           
                              
                                 
                                    
                                       
                                          
                                             c
                                          
                                          
                                             1
                                          
                                          
                                             ∗
                                          
                                       
                                       ,
                                       
                                          
                                             c
                                          
                                          
                                             2
                                          
                                          
                                             ∗
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             c
                                          
                                          
                                             6
                                          
                                          
                                             ∗
                                          
                                       
                                    
                                 
                              
                           
                         Cartesian ones, represented both in Cartesian and cortical coordinates. In particular, the given Cartesian affine coefficients 
                           
                              
                                 
                                    c
                                 
                                 
                                    i
                                 
                                 
                                    ∗
                                 
                              
                           
                        , i.e. the target coefficients with respect to compute the approximation error of the recovered coefficients 
                           
                              
                                 
                                    c
                                 
                                 
                                    i
                                 
                              
                           
                         (computed from the cortical coefficients 
                           
                              
                                 
                                    
                                       
                                          c
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                           
                        ), are represented in the bottom row of Fig. 9: each square plot represents the values of the given Cartesian coefficients in the 
                           
                              (
                              x
                              ,
                              y
                              )
                           
                         domain. The domain is divided in sixteen areas (composed of the four vertical and horizontal stripes), in each area there is a specific combination of 
                           
                              
                                 
                                    c
                                 
                                 
                                    i
                                 
                                 
                                    ∗
                                 
                              
                           
                         coefficients in order to consider several complex optic flow patterns, e.g the bottom-right area represents a complex optic flow, where there is also a combined translation-rotation motion, since the values of the coefficients 
                           
                              
                                 
                                    c
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    c
                                 
                                 
                                    4
                                 
                              
                           
                         and 
                           
                              
                                 
                                    c
                                 
                                 
                                    3
                                 
                              
                              ,
                              
                                 
                                    c
                                 
                                 
                                    5
                                 
                              
                           
                         are not zero (in particular, they are about 3.5 and 0.4, respectively, since the color is brown). The third row is the representation of the same given Cartesian affine coefficients 
                           
                              
                                 
                                    c
                                 
                                 
                                    i
                                 
                                 
                                    ∗
                                 
                              
                           
                         in the cortical domain. In the second row there are the recovered Cartesian coefficients 
                           
                              
                                 
                                    c
                                 
                                 
                                    i
                                 
                              
                           
                         represented in the cortical domain, thus it simple to compare them to the given coefficients of the second rows, they have similar values (i.e. similar colors). The first row shows the maps of the estimated cortical affine coefficients 
                           
                              
                                 
                                    
                                       
                                          c
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                           
                         (they show the non-linearities introduced by the log-polar mapping), from which we have computed the Cartesian coefficients 
                           
                              
                                 
                                    c
                                 
                                 
                                    i
                                 
                              
                           
                        . Thus, our approach allow us to handle complex optic flow patterns with small approximation errors: the average errors with respect to the known Cartesian coefficients (represented in cortical coordinates for an easier comparison with the estimated coefficients) are similar to the ones reported in Fig. 8.

@&#RESULTS@&#

@&#IMPLEMENTATION DETAILS@&#


                        Datasets The validation of the proposed vision system has been performed by considering three situations:
                           
                              –
                              A synthetic sequence
                                    2
                                    The sequences and the ground truth data are available at www.pspc.unige.it/Research/vr.html.
                                 
                                 
                                    2
                                  with ground truth TTC and orientation of surfaces created by using the virtual reality simulator described in [66,67].

An automotive sequence (“Trailer Follow”) with available independent moving objects (IMOs) ground truth
                                    3
                                    
                                       www.mi.auckland.ac.nz/.
                                 
                                 
                                    3
                                  
                                 [68], and LIDAR data.
                                    4
                                    The LIDAR data have been recorded in the context of the EU DRIVSCO project, courtesy of HELLA, Hueck KG, Lippstadt.
                                 
                                 
                                    4
                                 
                              

Two sequences
                                    5
                                    The sequences are available at www.pspc.unige.it/Research/Data/Kephera_seqs.zip.
                                 
                                 
                                    5
                                  acquired by a miniature mobile robot Kephera
                                    6
                                    
                                       www.k-team.com.
                                 
                                 
                                    6
                                  equipped with a standard webcam (Logitech C310 with 
                                    
                                       640
                                       ×
                                       480
                                    
                                  pixels resolution).

The aim of this work is to develop a system that run on a standard workstation, in particular we developed and tested the code on a Intel Core i7 with 4 cores at 2.8GHz, and on a NVIDIA GeForce GTX 680 graphics card. The graphics device has the Kepler architecture, 8 multiprocessors each with 192 cores.

The code has been developed in C++, by using the OpenCV library
                              7
                              
                                 opencv.org.
                           
                           
                              7
                            compiled with GPU support and Microsoft Windows threads. The vision system must process each image of the sequences with the same frame rate of the acquisition system. In this work, we design the software modules in order to get a processing time of 50ms that is the interval between two consecutive acquisitions. The processing flow is divided in two paths:
                              
                                 –
                                 the processing on the CPU with 4 available threads, one for the acquisition of the images and the log-polar transform, and three for the adaptive pattern matching operations and the motion interpretation. The log-polar mapping is performed in 1ms through our implementation of the blind spot model available in the OpenCV library.
                                       8
                                       
                                          code.opencv.org/projects/opencv/repository/revisions/master/entry/modules/contrib/src/logpolar_bsm.cpp.
                                    
                                    
                                       8
                                     The adaptive pattern matching to recover the affine flow description takes 5ms for each point of interest considered in the image.

the processing on the GPU for the computation of the cortical optic flow through the proposed distributed population of motion energy neurons. The implementation of the code follows some of the techniques devised in [69] to improve the execution time. For the considered cortical images the algorithm takes 50ms. It is worth noting that similar performances can be obtained with a CPU implementation optimized by using Intel IPP libraries,
                                       9
                                       
                                          software.intel.com/en-us/intel-ipp.
                                    
                                    
                                       9
                                     since the cortical images are too small to fully exploit the GPU parallel processing.

To obtain the results presented in this Section we set the following parameters:
                              
                                 –
                                 The log-polar transform parameters have been chosen in order to obtain a compression ratio 
                                       
                                          CR
                                          ≃
                                          10
                                       
                                     and an aspect ratio 
                                       
                                          γ
                                          =
                                          1
                                       
                                    , since the 
                                       
                                          R
                                          ,
                                          S
                                       
                                     and 
                                       
                                          
                                             
                                                ρ
                                             
                                             
                                                0
                                             
                                          
                                       
                                     parameters depend on the size of the Cartesian image, their values will be specified in the following.

The distributed population of neurons for cortical optic flow computation is defined by 
                                       
                                          N
                                          =
                                          16
                                       
                                     oriented Gabor filters, each tuned to 
                                       
                                          M
                                          =
                                          3
                                       
                                     different velocities. The filters have a spatio-temporal support of 
                                       
                                          (
                                          11
                                          ×
                                          11
                                          )
                                          ×
                                          7
                                       
                                     pixels 
                                       
                                          ×
                                       
                                     frames and are characterized by a bandwidth of 
                                       
                                          0.833
                                       
                                     octave and spatial radial peak frequency 
                                       
                                          ω
                                          =
                                          0.25
                                       
                                     cycles/pixel.

The adaptive pattern matching operations to recover the cortical affine description has been performed with a spatial support from 
                                       
                                          28
                                          ×
                                          28
                                       
                                     to 
                                       
                                          40
                                          ×
                                          40
                                       
                                     cortical pixels (depending on the size of the cortical image) for the locations related to the IMOs, and for the given points of interest in the robotic sequences.

The first quantitative evaluation of the proposed approach has been performed by using a synthetic sequence: a 3D scene is recorded by a virtual camera that moves straight ahead towards a frontoparallel obstacle with a velocity of 1m per frame, starting from an initial position (0,0,35) meters and with a horizontal field of view of 100 degrees. Fig. 10
                           (a–c) shows a frame of the sequence in the Cartesian domain, its transformation and the corresponding optic flow in the cortical one. In order to evaluate the performances of the developed vision system in distinguishing still or moving objects that could represent an obstacle for an autonomous agent, we compute the TTC (Eq. (B.5)) and the components of the surface normal 
                              
                                 (
                                 
                                    
                                       n
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       n
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       n
                                    
                                    
                                       3
                                    
                                 
                                 )
                              
                            (Eq. (B.4)), see Appendix B for details, on two manually selected points.

One point belongs to an object standing in front of the virtual camera (marked with a red circle in Fig. 10), thus the TTC with respect to it should decrease linearly and the surface normal vector should have a higher 
                              
                                 
                                    
                                       n
                                    
                                    
                                       3
                                    
                                 
                              
                            component. Fig. 10(b) shows the computed TTC (red line) with respect to the ground truth value (blue line), the average mean error is 0.13s. In general, an error in the interval 0–0.3s is acceptable for most autonomous vision systems as we have reported in [50]. The estimated components of the surface normal (where 
                              
                                 
                                    
                                       n
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       n
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       n
                                    
                                    
                                       3
                                    
                                 
                              
                            are represented by red circles, green crosses and blue stars, respectively) correctly represent a vertical standing object, since the 
                              
                                 
                                    
                                       n
                                    
                                    
                                       3
                                    
                                 
                              
                            trace is higher than the others.

The second selected point (marked with a green circle in Fig. 10) is taken on the street, thus the TTC should remain constant and the 
                              
                                 
                                    
                                       n
                                    
                                    
                                       2
                                    
                                 
                              
                            component of the surface normal vector should be predominant. Fig. 10(d) confirms such behavior.

An evaluation of the system in a real-world situation is performed by considering a benchmark sequence acquired by a camera mounted on a car [68]. Such a sequence also allows quantitative comparisons since both labeled IMOs and non-visual signal (e.g. LIDAR data and speedometer) are available. Fig. 11
                            shows the surface normal and the TTC estimation for the whole sequence. Moreover, TTC estimation and a comparison with the LIDAR data, where it is available, are highlighted for three interval where approaching vehicles (two cars and a motorbike) are present.

By considering the frames, where there are no obstacles on the street, the estimation of the normal vector to the surface around the considered points gives values near to 
                              
                                 (
                                 0
                                 ,
                                 1
                                 ,
                                 0
                                 )
                              
                            that corresponds to the ground plane. The estimation of the normal to the surfaces on the IMOs gives different values, thus corresponding to various vertical slanted surfaces that represent obstacles that should be avoided (see the red circles and blue stars in Fig. 11(a).

In the same points previously described, we compute the TTC. The obtained results show how the TTC decreases when the IMO is approaching (see Fig. 11(b), the intervals 430–467, 610–672 and 1435–1461), whereas it remains almost constant with respect to points belonging to the street (see Fig. 11(b)). When available, the estimation of the TTC has been compared to the data recorded by the LIDAR system of the car (see blue lines in Fig. 11(c–e)). The relative distance between the car and the objects in the scene is known at each time step, as well as the velocity measure coming from the speedometer. In this way, an estimation of TTC, coming from non-visual signals, is possible and can be used for benchmarking purposes. In the intervals 610–672 and 1435–1461 the average mean error of the TTC estimation with respect to the LIDAR data is 0.17s, and the standard deviation is 0.14s.

To the knowledge of the authors, though in the literature several works describe collision avoidance systems, working in real world situations, and report the performances of their approaches, there are no systematic reviews of methods for image based obstacle avoidance, in particular for the computation of the time-to-contact from image sequences. Moreover there is a lack of benchmarking sequences, that could be downloaded and used to compare with other authors. It is worth noting that the sequences used in this paper are available to the community and the computed visual features by using the proposed approach are completely reported here (http://www.pspc.unige.it/Research/Neuromimetic_vision_system.html). A recent work [70] presents a system that detects TTC based on stereo vision for autonomous pedestrian collision avoidance and reports the root mean square error of the computed TTC with respect to a ground truth value represented by a DGPS system. Unfortunately it is not possible to directly compare with our approach, since they do not provide sequences and ground truth data. Similarly, in [71], the authors present a vision-based safety system and report relative errors in the computation of the TTC in a real world situation, and a bio-inspired approach for the estimation of TTC from motion is described in [12]. The approach is tested on a simple real-world indoor environment, but no comparisons are possible with our approach, since the considered sequences are not available and the considered metric to compute errors is not reported.


                           Table 2
                            summarizes some available results on TTC estimation from image sequences presented in the literature and some measures obtained by commercial systems.

Finally we tested the system in a different real-world situation: a miniature mobile robot Kephera moves towards obstacles with different orientations and distances. Fig. 12
                            shows a snapshot of the scene in which the robot moves, and the inset on the right shows a schematic representation of two different configurations of the obstacles. In the first one (left) two frontoparallel obstacles stand in front of the robot at two different distances, and we use this sequence to test the ability of our system in discriminating different values of TTC in order to allow the robot to navigate among obstacles. The second sequence (right) is characterized by a slanted obstacle in front of the robot.


                           Fig. 13
                           (top) shows the TTC estimation with respect to the two obstacles positioned at different distances (marked with red and green circles). The developed vision system is able to discriminate the differences in the TTC for the two objects, thus the relative distances between the two objects can be correctly computed. The surface normal vector is reported for the red obstacle, only. The approach also works when the obstacle is slanted, as it is shown in Fig. 13(bottom). It is worth noting that the sequences recorded by the miniature robot are affected by noise and perturbed by oscillations (the cables that connect the robot to the PC affect its smooth movements). This causes noise peaks and errors in the results, though they do not affect the possibility of discriminating different obstacles in the robot path.

Here, we analyze how the compression ratio affects the estimation of the TTC, since a trade-off between the size of the cortical image (thus the execution time) and the accuracy of the results has to be reached. For the comparisons we have considered the frame interval 610–672 of the “Trailer Follow” sequence (see Fig. 11), and we have computed the mean average error of the computed TTC with respect to the LIDAR data by varying the size of the cortical image. We have considered a small interval for this comparison, since stable LIDAR data are available only in this range.


                           Table 3
                            shows that the average error is proportional to the compression ratio CR (i.e. it is inversely proportional to the size of the cortical image).

@&#CONCLUSIONS@&#

In this paper, we have proposed a vision system that mimics the first processing stages of the visual cortex for motion interpretation directly in the cortical domain. Such a neuromimetic architecture and its hybrid implementation that exploits both multi-core CPU and GPU allows us to reach real-time performances in real-world situations. Each frame is processed in about 50ms: on the multi-core CPU the log-polar mapping is performed in about 1ms and the adaptive pattern matching in about 5ms (i.e. it is possible to compute up to 9 points of interest), and on the GPU the optic flow is computed in about 50ms, thus the global execution time is kept below the 50ms.

In the proposed approach, the input Cartesian image sequences are first transformed into the log-polar domain, thus achieving data reduction, then the cortical optic flow is computed through a distributed population of motion energy neurons. This stage of processing yields results that are comparable to those of other state-of-the-art bio-inspired approaches that work in the Cartesian domain, if we limit our analysis to an area near the fovea. Results are worse by considering the whole image, and this is due to the consistent data reduction achieved by the log-polar transform. Though, we show that motion interpretation is still possible, with reliable results. At this point, by mimicking the processing of the MST cortical area, the vision system performs a first order analysis of the cortical optic flow through an adaptive pattern matching operation, to obtain the affine cortical description of the flow.

In order to exploit such a cortical description to visually guide the actions of an agent in the real 3D world, we have devised the relationships between the cortical affine description of the optic flow and the 3D Cartesian parameters of the motion interpretation (e.g. time-to-contact and orientation of the surfaces). A quantitative evaluation shows that an accurate description of affine Cartesian quantities can be obtained from the linear description of the corresponding cortical optic flow.

Finally, we have shown the effectiveness of the developed vision system in computing the time-to-contact and the normal vectors of the surfaces for some points of interest, by considering synthetic and real-world sequences. The quantitative evaluation shows that the system is able to compute reliable estimates of the TTC both in an automotive context, where two cars are approaching at high velocity, and in a robotic situation, where objects are located at small different distances from a slowly moving robot. A dataset of the used sequences and the related estimates of TTC and surface orientation are available for the Computer Vision community at the web page http://www.pspc.unige.it/Research/Neuromimetic_vision_system.html
                  

In [50], to recover the elementary flow components with an adaptive pattern matching operation, we adopt an approach based on Kalman filter (KF) [73]. In order to use the EFCs (see Section 3.4) as “models” for the KF, they should be recursively generated, this is achieved through a lattice network in the velocity space:
                        
                           (A.1)
                           
                              v
                              [
                              k
                              ]
                              =
                              Φ
                              [
                              k
                              ,
                              k
                              -
                              1
                              ]
                              v
                              [
                              k
                              -
                              1
                              ]
                              +
                              s
                              [
                              k
                              -
                              1
                              ]
                              +
                              
                                 
                                    n
                                 
                                 
                                    1
                                 
                              
                              [
                              k
                              -
                              1
                              ]
                              ,
                           
                        
                     which describes the temporal evolution, from the previous time step 
                        
                           k
                           -
                           1
                        
                      to the current time step k, of the relationships among motion features over a fixed small spatial region according to specific rules embedded in the transition matrix 
                        
                           Φ
                        
                     . The driving input 
                        
                           s
                           [
                           k
                           ]
                        
                      is evaluated at each time step, by computing the average of the optic flow velocity components at the patch’s borders, whereas 
                        
                           
                              
                                 n
                              
                              
                                 1
                              
                           
                           [
                           k
                           ]
                        
                      represents the noise.

The output of the KF will be the estimate of the affine description of the optic flow on the basis of the spatial contextual information described by the generative models (Eq. (A.1)) of the EFCs. In this way, we perform an adaptive pattern matching capable of tracking the coefficients of a linear description of the optic flow. Formally, given the process equation in Eq. (A.1) and the measurement equation:
                        
                           (A.2)
                           
                              v
                              [
                              k
                              ]
                              =
                              C
                              [
                              k
                              ]
                              v
                              [
                              k
                              ]
                              +
                              
                                 
                                    n
                                 
                                 
                                    2
                                 
                              
                              [
                              k
                              ]
                              ,
                           
                        
                     where 
                        
                           v
                           [
                           k
                           ]
                        
                      is a noisy measure, at current time k, of the optic flow 
                        
                           v
                           [
                           k
                           ]
                           ,
                           
                              
                                 n
                              
                              
                                 2
                              
                           
                           [
                           k
                           ]
                        
                      is the uncertainty of the measure, and 
                        
                           C
                        
                      is a modified unitary operator for discarding the image points where the optic flow is not available or not reliable, the output of the KF will be:
                        
                           (A.3)
                           
                              
                                 
                                    v
                                 
                                 
                                    ˆ
                                 
                              
                              [
                              k
                              |
                              
                                 
                                    V
                                 
                                 
                                    k
                                 
                              
                              ]
                              =
                              
                                 
                                    v
                                 
                                 
                                    ˆ
                                 
                              
                              [
                              k
                              |
                              
                                 
                                    V
                                 
                                 
                                    k
                                    -
                                    1
                                 
                              
                              ]
                              +
                              G
                              [
                              k
                              ]
                              ν
                              [
                              k
                              ]
                              ,
                           
                        
                     where 
                        
                           
                              
                                 v
                              
                              
                                 ˆ
                              
                           
                           [
                           k
                           |
                           
                              
                                 V
                              
                              
                                 k
                                 -
                                 1
                              
                           
                           ]
                        
                      is the a priori velocity state estimate, 
                        
                           
                              
                                 v
                              
                              
                                 ˆ
                              
                           
                           [
                           k
                           |
                           
                              
                                 V
                              
                              
                                 k
                              
                           
                           ]
                        
                      is the a posteriori state estimate, 
                        
                           
                              
                                 V
                              
                              
                                 k
                              
                           
                        
                      represent all the measurements until time steps k, 
                        
                           ν
                           [
                           k
                           ]
                           =
                           v
                           [
                           k
                           ]
                           -
                           
                              
                                 v
                              
                              
                                 ˆ
                              
                           
                           [
                           k
                           |
                           
                              
                                 V
                              
                              
                                 k
                                 -
                                 1
                              
                           
                           ]
                        
                      is the innovation and 
                        
                           G
                           [
                           k
                           ]
                        
                      is the Kalman gain.

In order to have a statistical measure of the discrepancy between predictions and observations, as an indication of the filter’s consistency, it is frequently used the Normalized Innovation Squared (NIS) [74]:
                        
                           (A.4)
                           
                              
                                 
                                    NIS
                                 
                                 
                                    k
                                 
                              
                              =
                              
                                 
                                    ν
                                 
                                 
                                    T
                                 
                              
                              [
                              k
                              ]
                              
                                 
                                    Σ
                                 
                                 
                                    -
                                    1
                                 
                              
                              [
                              k
                              ]
                              ν
                              [
                              k
                              ]
                              ,
                           
                        
                     defined on the basis of the innovation and on its covariance 
                        
                           Σ
                        
                     . Since the covariance of the innovation depends on the estimate of the measure noise 
                        
                           
                              
                                 n
                              
                              
                                 2
                              
                           
                        
                     , it is important to have a reliable estimate of the noise in the measure.

To measure the structural properties of the input optic flow, a multiple model KF [74] is used. The NIS value is used to compute, for each model, the likelihood of the measurements, on which to base the selection among the different models. Such models are obtained from Eq. (11), by incorporating the pure translations into the corresponding deformation components, thus obtaining generalized deformation components:
                        
                           (A.5)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             
                                                v
                                             
                                             
                                                x
                                             
                                             
                                                x
                                             
                                          
                                          =
                                          
                                             
                                                a
                                             
                                             
                                                1
                                             
                                          
                                          
                                             
                                                α
                                             
                                             
                                                x
                                             
                                          
                                          +
                                          
                                             
                                                a
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                d
                                             
                                             
                                                x
                                             
                                             
                                                x
                                             
                                          
                                          
                                             
                                                =
                                             
                                             
                                                def
                                             
                                          
                                          
                                             
                                                m
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                             
                                                v
                                             
                                             
                                                y
                                             
                                             
                                                x
                                             
                                          
                                          =
                                          
                                             
                                                a
                                             
                                             
                                                3
                                             
                                          
                                          
                                             
                                                α
                                             
                                             
                                                x
                                             
                                          
                                          +
                                          
                                             
                                                a
                                             
                                             
                                                4
                                             
                                          
                                          
                                             
                                                d
                                             
                                             
                                                y
                                             
                                             
                                                x
                                             
                                          
                                          
                                             
                                                =
                                             
                                             
                                                def
                                             
                                          
                                          
                                             
                                                m
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                             
                                                v
                                             
                                             
                                                x
                                             
                                             
                                                y
                                             
                                          
                                          =
                                          
                                             
                                                a
                                             
                                             
                                                5
                                             
                                          
                                          
                                             
                                                α
                                             
                                             
                                                y
                                             
                                          
                                          +
                                          
                                             
                                                a
                                             
                                             
                                                6
                                             
                                          
                                          
                                             
                                                d
                                             
                                             
                                                x
                                             
                                             
                                                y
                                             
                                          
                                          
                                             
                                                =
                                             
                                             
                                                def
                                             
                                          
                                          
                                             
                                                m
                                             
                                             
                                                3
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                             
                                                v
                                             
                                             
                                                y
                                             
                                             
                                                y
                                             
                                          
                                          =
                                          
                                             
                                                a
                                             
                                             
                                                7
                                             
                                          
                                          
                                             
                                                α
                                             
                                             
                                                y
                                             
                                          
                                          +
                                          
                                             
                                                a
                                             
                                             
                                                8
                                             
                                          
                                          
                                             
                                                d
                                             
                                             
                                                y
                                             
                                             
                                                y
                                             
                                          
                                          
                                             
                                                =
                                             
                                             
                                                def
                                             
                                          
                                          
                                             
                                                m
                                             
                                             
                                                4
                                             
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        
                     
                  

In the multiple model approach it is assumed that the system obeys one of a finite number of models 
                        
                           
                              
                                 m
                              
                              
                                 i
                              
                           
                        
                      with 
                        
                           i
                           =
                           1
                           ,
                           2
                           ,
                           …
                           ,
                           r
                        
                      (with 
                        
                           r
                           =
                           4
                        
                     , in our case). The likelihood of the measurement 
                        
                           v
                        
                      given a model 
                        
                           
                              
                                 m
                              
                              
                                 i
                              
                           
                        
                      at time step k is given by:
                        
                           (A.6)
                           
                              f
                              (
                              v
                              |
                              
                                 
                                    m
                                 
                                 
                                    i
                                 
                              
                              )
                              =
                              |
                              2
                              π
                              
                                 
                                    Σ
                                 
                                 
                                    
                                       
                                          m
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              
                                 
                                    |
                                 
                                 
                                    -
                                    
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              
                                 
                                    e
                                 
                                 
                                    -
                                    
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          ν
                                       
                                       
                                          
                                             
                                                m
                                             
                                             
                                                i
                                             
                                          
                                       
                                       
                                          T
                                       
                                    
                                    
                                       
                                          Σ
                                       
                                       
                                          
                                             
                                                m
                                             
                                             
                                                i
                                             
                                          
                                       
                                       
                                          -
                                          1
                                       
                                    
                                    
                                       
                                          ν
                                       
                                       
                                          
                                             
                                                m
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                              
                              ,
                           
                        
                     where 
                        
                           
                              
                                 m
                              
                              
                                 i
                              
                           
                        
                      is the considered model. The probability that the candidate model 
                        
                           
                              
                                 m
                              
                              
                                 i
                              
                           
                        
                      is the correct one is given by the following equation:
                        
                           (A.7)
                           
                              
                                 
                                    p
                                 
                                 
                                    
                                       
                                          m
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              [
                              k
                              ]
                              =
                              
                                 
                                    f
                                    (
                                    v
                                    |
                                    
                                       
                                          m
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          r
                                       
                                    
                                    f
                                    (
                                    v
                                    |
                                    
                                       
                                          m
                                       
                                       
                                          j
                                       
                                    
                                    )
                                 
                              
                              ,
                           
                        
                     with 
                        
                           
                              
                                 p
                              
                              
                                 
                                    
                                       m
                                    
                                    
                                       i
                                    
                                 
                              
                           
                           [
                           0
                           ]
                           =
                           1
                           /
                           r
                           ,
                           i
                           =
                           1
                           ,
                           2
                           ,
                           …
                           ,
                           r
                        
                      and 
                        
                           
                              
                                 ∑
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 r
                              
                           
                           
                              
                                 p
                              
                              
                                 
                                    
                                       m
                                    
                                    
                                       i
                                    
                                 
                              
                           
                           [
                           k
                           ]
                           =
                           1
                        
                      at each time step k.

The final model-conditioned estimate of the state 
                        
                           v
                        
                      is computed as a weighted combination of the a posteriori states of each candidate filter:
                        
                           (A.8)
                           
                              
                                 
                                    v
                                 
                                 
                                    ˆ
                                 
                              
                              [
                              k
                              ]
                              =
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       r
                                    
                                 
                              
                              
                                 
                                    p
                                 
                                 
                                    
                                       
                                          m
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              [
                              k
                              ]
                              
                                 
                                    
                                       
                                          v
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    
                                       
                                          m
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              [
                              k
                              ]
                              .
                           
                        
                     
                  

For the four models considered in the proposed approach (see Eq. (A.5)), we obtain:
                        
                           (A.9)
                           
                              
                                 
                                    v
                                 
                                 
                                    ˆ
                                 
                              
                              =
                              
                                 
                                    p
                                 
                                 
                                    
                                       
                                          m
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          v
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    x
                                 
                                 
                                    x
                                 
                              
                              +
                              
                                 
                                    p
                                 
                                 
                                    
                                       
                                          m
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          v
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    y
                                 
                                 
                                    x
                                 
                              
                              +
                              
                                 
                                    p
                                 
                                 
                                    
                                       
                                          m
                                       
                                       
                                          3
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          v
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    x
                                 
                                 
                                    y
                                 
                              
                              +
                              
                                 
                                    p
                                 
                                 
                                    
                                       
                                          m
                                       
                                       
                                          4
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          v
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    y
                                 
                                 
                                    y
                                 
                              
                              ,
                           
                        
                     where 
                        
                           
                              
                                 p
                              
                              
                                 
                                    
                                       m
                                    
                                    
                                       1
                                    
                                 
                              
                           
                           ,
                           
                              
                                 p
                              
                              
                                 
                                    
                                       m
                                    
                                    
                                       2
                                    
                                 
                              
                           
                           ,
                           
                              
                                 p
                              
                              
                                 
                                    
                                       m
                                    
                                    
                                       3
                                    
                                 
                              
                           
                        
                     , 
                        
                           
                              
                                 p
                              
                              
                                 
                                    
                                       m
                                    
                                    
                                       4
                                    
                                 
                              
                           
                        
                      are the probabilities related to each model and 
                        
                           
                              
                                 
                                    
                                       v
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 x
                              
                              
                                 x
                              
                           
                           ,
                           
                              
                                 
                                    
                                       v
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 y
                              
                              
                                 x
                              
                           
                           ,
                           
                              
                                 
                                    
                                       v
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 x
                              
                              
                                 y
                              
                           
                        
                     , 
                        
                           
                              
                                 
                                    
                                       v
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 y
                              
                              
                                 y
                              
                           
                        
                      are the state estimates for each KF. Combining Eqs. (A.5) and (A.9) we have:
                        
                           (A.10)
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            ˆ
                                                         
                                                      
                                                   
                                                   
                                                      x
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            ˆ
                                                         
                                                      
                                                   
                                                   
                                                      y
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      
                                                         
                                                            m
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            a
                                                         
                                                         
                                                            ˆ
                                                         
                                                      
                                                   
                                                   
                                                      1
                                                   
                                                
                                                +
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      
                                                         
                                                            m
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            a
                                                         
                                                         
                                                            ˆ
                                                         
                                                      
                                                   
                                                   
                                                      3
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      
                                                         
                                                            m
                                                         
                                                         
                                                            3
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            a
                                                         
                                                         
                                                            ˆ
                                                         
                                                      
                                                   
                                                   
                                                      5
                                                   
                                                
                                                +
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      
                                                         
                                                            m
                                                         
                                                         
                                                            4
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            a
                                                         
                                                         
                                                            ˆ
                                                         
                                                      
                                                   
                                                   
                                                      7
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              +
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      
                                                         
                                                            m
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            a
                                                         
                                                         
                                                            ˆ
                                                         
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      
                                                         
                                                            m
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            a
                                                         
                                                         
                                                            ˆ
                                                         
                                                      
                                                   
                                                   
                                                      4
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      
                                                         
                                                            m
                                                         
                                                         
                                                            3
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            a
                                                         
                                                         
                                                            ˆ
                                                         
                                                      
                                                   
                                                   
                                                      6
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      
                                                         
                                                            m
                                                         
                                                         
                                                            4
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            a
                                                         
                                                         
                                                            ˆ
                                                         
                                                      
                                                   
                                                   
                                                      8
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                x
                                             
                                          
                                          
                                             
                                                y
                                             
                                          
                                       
                                    
                                 
                              
                              ,
                           
                        
                     from which it is possible to derive the estimated coefficients of the affine model:
                        
                           (A.11)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                1
                                             
                                          
                                          =
                                          
                                             
                                                p
                                             
                                             
                                                
                                                   
                                                      m
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                1
                                             
                                          
                                          +
                                          
                                             
                                                p
                                             
                                             
                                                
                                                   
                                                      m
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                3
                                             
                                          
                                          ,
                                          
                                          
                                             
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                2
                                             
                                          
                                          =
                                          
                                             
                                                p
                                             
                                             
                                                
                                                   
                                                      m
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                2
                                             
                                          
                                          ,
                                          
                                          
                                             
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                3
                                             
                                          
                                          =
                                          
                                             
                                                p
                                             
                                             
                                                
                                                   
                                                      m
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                4
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                4
                                             
                                          
                                          =
                                          
                                             
                                                p
                                             
                                             
                                                
                                                   
                                                      m
                                                   
                                                   
                                                      3
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                5
                                             
                                          
                                          +
                                          
                                             
                                                p
                                             
                                             
                                                
                                                   
                                                      m
                                                   
                                                   
                                                      4
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                7
                                             
                                          
                                          ,
                                          
                                          
                                             
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                5
                                             
                                          
                                          =
                                          
                                             
                                                p
                                             
                                             
                                                
                                                   
                                                      m
                                                   
                                                   
                                                      3
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                6
                                             
                                          
                                          ,
                                          
                                          
                                             
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                6
                                             
                                          
                                          =
                                          
                                             
                                                p
                                             
                                             
                                                
                                                   
                                                      m
                                                   
                                                   
                                                      4
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                8
                                             
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        
                     
                  

In the text (see Section 3.5) the notation 
                        
                           
                              
                                 ·
                              
                              
                                 ̃
                              
                           
                        
                     , here used to indicate the KF estimates, is omitted for notational simplicity.

Here, we summarize the problem of motion interpretation [45,75–77] from optic flow. In [50] we have previously formulated the problem of motion interpretation without simplifying assumptions (e.g. on the motion of the observer), thus obtaining a complete description that allows us to cope with real-world complex situations.

The relative motion between an observer and the scene can be described at each instant t as a rigid-body motion, by means of the translational velocity 
                        
                           T
                           =
                           
                              
                                 (
                                 
                                    
                                       T
                                    
                                    
                                       X
                                    
                                 
                                 ,
                                 
                                    
                                       T
                                    
                                    
                                       Y
                                    
                                 
                                 ,
                                 
                                    
                                       T
                                    
                                    
                                       Z
                                    
                                 
                                 )
                              
                              
                                 T
                              
                           
                        
                      and of the angular velocity 
                        
                           Ω
                           =
                           
                              
                                 (
                                 
                                    
                                       Ω
                                    
                                    
                                       X
                                    
                                 
                                 ,
                                 
                                    
                                       Ω
                                    
                                    
                                       Y
                                    
                                 
                                 ,
                                 
                                    
                                       Ω
                                    
                                    
                                       Z
                                    
                                 
                                 )
                              
                              
                                 T
                              
                           
                        
                     . By considering a viewer-centered coordinate frame, i.e. fixed on the observer, each point 
                        
                           X
                           =
                           
                              
                                 (
                                 X
                                 ,
                                 Y
                                 ,
                                 Z
                                 )
                              
                              
                                 T
                              
                           
                        
                      in the 3D space has an apparent motion given by: 
                        
                           
                              
                                 X
                              
                              
                                 ̇
                              
                           
                           =
                           -
                           (
                           T
                           +
                           Ω
                           ∧
                           X
                           )
                        
                     . In a pinhole camera model, the perspective projection 
                        
                           x
                           =
                           
                              
                                 (
                                 x
                                 ,
                                 y
                                 )
                              
                              
                                 T
                              
                           
                        
                      of the point 
                        
                           X
                        
                      is defined as 
                        
                           x
                           =
                           fX
                           /
                           Z
                        
                      and 
                        
                           y
                           =
                           fY
                           /
                           Z
                        
                     . The image motion field 
                        
                           
                              
                                 x
                              
                              
                                 ̇
                              
                           
                           =
                           
                              
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       ̇
                                    
                                 
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       ̇
                                    
                                 
                                 )
                              
                              
                                 T
                              
                           
                           =
                           
                              
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       x
                                    
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       y
                                    
                                 
                                 )
                              
                              
                                 T
                              
                           
                        
                      is expressed as a function of image position and surface depth 
                        
                           Z
                           =
                           Z
                           (
                           x
                           ,
                           y
                           )
                        
                     , in the following way:
                        
                           (B.1)
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      x
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      y
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              =
                              f
                              
                                 
                                    
                                       
                                          
                                             
                                                -
                                                
                                                   
                                                      T
                                                   
                                                   
                                                      X
                                                   
                                                
                                                /
                                                Z
                                                -
                                                
                                                   
                                                      Ω
                                                   
                                                   
                                                      Y
                                                   
                                                
                                             
                                          
                                          
                                             
                                                -
                                                
                                                   
                                                      T
                                                   
                                                   
                                                      Y
                                                   
                                                
                                                /
                                                Z
                                                +
                                                
                                                   
                                                      Ω
                                                   
                                                   
                                                      X
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              +
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      T
                                                   
                                                   
                                                      Z
                                                   
                                                
                                                /
                                                Z
                                             
                                             
                                                
                                                   
                                                      Ω
                                                   
                                                   
                                                      Z
                                                   
                                                
                                             
                                          
                                          
                                             
                                                -
                                                
                                                   
                                                      Ω
                                                   
                                                   
                                                      Z
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      T
                                                   
                                                   
                                                      Z
                                                   
                                                
                                                /
                                                Z
                                             
                                          
                                       
                                    
                                 
                              
                              ·
                              
                                 
                                    
                                       
                                          
                                             
                                                x
                                             
                                          
                                          
                                             
                                                y
                                             
                                          
                                       
                                    
                                 
                              
                              +
                              
                                 
                                    1
                                 
                                 
                                    f
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                xy
                                                
                                                   
                                                      Ω
                                                   
                                                   
                                                      X
                                                   
                                                
                                                -
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   
                                                      Ω
                                                   
                                                   
                                                      Y
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   
                                                      Ω
                                                   
                                                   
                                                      X
                                                   
                                                
                                                -
                                                xy
                                                
                                                   
                                                      Ω
                                                   
                                                   
                                                      Y
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              .
                           
                        
                     
                  

The motion field is defined in terms of distinct depth values at each image point, and this makes estimation of 3D parameters ill-conditioned [75]. One way to overcome this problem is to pool measurements on the basis of assumptions about scene structure, e.g. by assuming a smooth surface structure in order to use locally linear depth variation. Let us assume that locally about a generic point 
                        
                           
                              
                                 X
                              
                              
                                 0
                              
                           
                           =
                           
                              
                                 (
                                 
                                    
                                       X
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 
                                    
                                       Y
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 
                                    
                                       Z
                                    
                                    
                                       0
                                    
                                 
                                 )
                              
                              
                                 T
                              
                           
                        
                     , the surface is approximately planar, with the orientation defined by the unit surface normal 
                        
                           N
                           =
                           
                              
                                 (
                                 
                                    
                                       n
                                    
                                    
                                       X
                                    
                                 
                                 ,
                                 
                                    
                                       n
                                    
                                    
                                       Y
                                    
                                 
                                 )
                              
                              
                                 T
                              
                           
                        
                     . Points on the surface around 
                        
                           
                              
                                 X
                              
                              
                                 0
                              
                           
                        
                      therefore have depth values given by 
                        
                           Z
                           =
                           D
                           +
                           
                              
                                 n
                              
                              
                                 X
                              
                           
                           X
                           +
                           
                              
                                 n
                              
                              
                                 Y
                              
                           
                           Y
                           ,
                        
                     ;, where D is the distance from the origin of the point at which the surface tangent cuts the optical axis Z. Using the perspective projection model, the inverse depth is:
                        
                           (B.2)
                           
                              
                                 
                                    1
                                 
                                 
                                    Z
                                 
                              
                              =
                              
                                 
                                    1
                                 
                                 
                                    D
                                 
                              
                              
                                 
                                    
                                       1
                                       -
                                       
                                          
                                             
                                                
                                                   n
                                                
                                                
                                                   X
                                                
                                             
                                             x
                                          
                                          
                                             f
                                          
                                       
                                       -
                                       
                                          
                                             
                                                
                                                   n
                                                
                                                
                                                   Y
                                                
                                             
                                             y
                                          
                                          
                                             f
                                          
                                       
                                    
                                 
                              
                              ,
                           
                        
                     Thus, it is possible to combine Eqs. (13), (B.1) and (B.2) in order to compute the motion-structure relationships under linear approximation.

The process of inferring the time-variant geometry of a scene from the corresponding visual motion is carried out locally. The reason for this is that it is impractical to represent arbitrary shapes and motions of surfaces in the scene by a global parameterization scheme. Restriction to local analysis facilitates working in a smaller parameter space. A patching together of this local 3D information is necessary to obtain a global description of the scene.

The orientation of a surface (with respect to the line of sight) is usually represented by two angles called slant, 
                           
                              σ
                           
                        , and tilt, 
                           
                              τ
                           
                        , as described in [78]. By defining 
                           
                              A
                              =
                              (
                              
                                 
                                    T
                                 
                                 
                                    X
                                 
                              
                              /
                              D
                              ,
                              
                                 
                                    T
                                 
                                 
                                    Y
                                 
                              
                              /
                              D
                              )
                           
                         as the viewer translation, 
                           
                              F
                              =
                              (
                              
                                 
                                    n
                                 
                                 
                                    X
                                 
                              
                              ,
                              
                                 
                                    n
                                 
                                 
                                    Y
                                 
                              
                              )
                              =
                              (
                              
                                 
                                    Z
                                 
                                 
                                    x
                                 
                              
                              ,
                              
                                 
                                    Z
                                 
                                 
                                    y
                                 
                              
                              )
                              /
                              D
                              =
                              ∇
                              Z
                              /
                              D
                           
                         as the surface orientation (represented by the depth gradient, scaled by depth), we can obtain direct relationships between the affine coefficients (see Eq. (13)) and behaviorally-relevant quantities for motion interpretation and scene understanding:
                           
                              (B.3)
                              
                                 
                                    
                                       
                                       
                                          
                                             div
                                             v
                                             =
                                             
                                                
                                                   c
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             
                                                
                                                   c
                                                
                                                
                                                   6
                                                
                                             
                                             =
                                             
                                                
                                                   2
                                                   
                                                      
                                                         T
                                                      
                                                      
                                                         Z
                                                      
                                                   
                                                
                                                
                                                   D
                                                
                                             
                                             +
                                             F
                                             ·
                                             A
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             curl
                                             v
                                             =
                                             
                                                
                                                   c
                                                
                                                
                                                   3
                                                
                                             
                                             -
                                             
                                                
                                                   c
                                                
                                                
                                                   5
                                                
                                             
                                             =
                                             -
                                             2
                                             
                                                
                                                   Ω
                                                
                                                
                                                   Z
                                                
                                             
                                             +
                                             |
                                             F
                                             ·
                                             A
                                             |
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             def
                                             v
                                             =
                                             
                                                
                                                   (
                                                   
                                                      
                                                         (
                                                         
                                                            
                                                               c
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                         -
                                                         
                                                            
                                                               c
                                                            
                                                            
                                                               6
                                                            
                                                         
                                                         )
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         (
                                                         
                                                            
                                                               c
                                                            
                                                            
                                                               3
                                                            
                                                         
                                                         +
                                                         
                                                            
                                                               c
                                                            
                                                            
                                                               5
                                                            
                                                         
                                                         )
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   )
                                                
                                                
                                                   1
                                                   /
                                                   2
                                                
                                             
                                             =
                                             |
                                             F
                                             |
                                             |
                                             A
                                             |
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        The orientation of the axis of expansion, 
                           
                              θ
                           
                        , bisects 
                           
                              A
                           
                         and 
                           
                              F
                           
                        : 
                           
                              θ
                              =
                              (
                              ∠
                              A
                              +
                              ∠
                              F
                              )
                              /
                              2
                           
                        . It is worth noting that the magnitude of the depth gradient is the tangent of the slant 
                           
                              σ
                           
                         of the surface (
                           
                              |
                              F
                              |
                              =
                              tan
                              σ
                           
                        ) and its direction corresponds to the tilt 
                           
                              τ
                           
                         of the surface tangent plane (
                           
                              ∠
                              F
                              =
                              τ
                           
                        ). From that it is possible to derive the normal to the surface 
                           
                              n
                              =
                              (
                              
                                 
                                    n
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    n
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                                 
                                    n
                                 
                                 
                                    3
                                 
                              
                              )
                           
                        , by using the following relationships:
                           
                              (B.4)
                              
                                 
                                    
                                       n
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 sin
                                 τ
                                 cos
                                 σ
                              
                           
                        
                        
                           
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   n
                                                
                                                
                                                   2
                                                
                                             
                                             =
                                             sin
                                             τ
                                             sin
                                             σ
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   n
                                                
                                                
                                                   3
                                                
                                             
                                             =
                                             cos
                                             τ
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The TTC is a parameter (
                           
                              
                                 
                                    t
                                 
                                 
                                    c
                                 
                              
                           
                        ) that describe how long it takes for a moving observer to reach an object in the environment [76], and it ca be defined as:
                           
                              (B.5)
                              
                                 
                                    
                                       t
                                    
                                    
                                       c
                                    
                                 
                                 =
                                 
                                    
                                       2
                                    
                                    
                                       η
                                       (
                                       x
                                       ,
                                       y
                                       )
                                       (
                                       div
                                       v
                                       -
                                       F
                                       ·
                                       A
                                       cos
                                       (
                                       τ
                                       -
                                       ∠
                                       A
                                       )
                                       )
                                    
                                 
                                 .
                              
                           
                        
                     

This formulation is valid in general and it also takes into account the relative motion among the observer and other objects in the scene.

@&#REFERENCES@&#

