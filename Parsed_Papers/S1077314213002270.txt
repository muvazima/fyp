@&#MAIN-TITLE@&#Matching mixtures of curves for human action recognition

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Gaussian mixture model framework for clustering motion curves.


                        
                        
                           
                           Matching training and probe motion curves using the longest common subsequence.


                        
                        
                           
                           Reduce the length of the time series using dimensionality reduction techniques.


                        
                        
                           
                           Categorize a probe video sequence using nearest neighbor classification scheme.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Human action recognition

Optical flow

Motion curves

Gaussian mixture modeling (GMM)

Clustering

Dimensionality reduction

Longest common subsequence

@&#ABSTRACT@&#


               
               
                  A learning-based framework for action representation and recognition relying on the description of an action by time series of optical flow motion features is presented. In the learning step, the motion curves representing each action are clustered using Gaussian mixture modeling (GMM). In the recognition step, the optical flow curves of a probe sequence are also clustered using a GMM, then each probe sequence is projected onto the training space and the probe curves are matched to the learned curves using a non-metric similarity function based on the longest common subsequence, which is robust to noise and provides an intuitive notion of similarity between curves. Alignment between the mean curves is performed using canonical time warping. Finally, the probe sequence is categorized to the learned action with the maximum similarity using a nearest neighbor classification scheme. We also present a variant of the method where the length of the time series is reduced by dimensionality reduction in both training and test phases, in order to smooth out the outliers, which are common in these type of sequences. Experimental results on KTH, UCF Sports and UCF YouTube action databases demonstrate the effectiveness of the proposed method.
               
            

@&#INTRODUCTION@&#

Action recognition is a preponderant and difficult task in computer vision. Many applications, including video surveillance systems, human–computer interaction, and robotics for human behavior characterization, require a multiple activity recognition system. The goal of human activity recognition is to examine activities from video sequences or still images. Motivated by this fact our human activity recognition system aims to correctly classify a video into its activity category.

In this paper, we address the problem of human action recognition by representing an action with a set of clustered motion curves. Motion curves are generated by optical flow features which are then clustered using a different Gaussian mixture [1] for each distinct action. The optical flow curves of a probe sequence are also clustered using a Gaussian mixture model (GMM) and they are matched to the learned curves using a similarity function [2] relying on the longest common subsequence (LCSS) between curves and the canonical time warping (CTW) [3]. Linear [1] and nonlinear [4] dimensionality reduction methods may also be employed in order to remove outliers from the motion curves and reduce their lengths. The motion curve of a new probe video is projected onto its own subspace by a projection matrix specified by that video, and then the action label of the closest projection is selected according to the learned feature vectors as the identity of the probe sequence. The LCSS is robust to noise and provides an intuitive notion of similarity between curves. Since different actors perform the same action in different manners and at different speeds, an advantage of the LCSS similarity is that it can handle with motion curves of varied lengths. On the other hand, CTW, which is based on the dynamic time warping [5], allows the spatio-temporal alignment between two human motion sequences. A preliminary version of this work was presented in [6]. One of the main contributions of this paper is that the training sequences do not need to have the same length. When a new probe sequence comes, it is matched against all the training sequences using the LCSS similarity measure. This measure provides a similarity between motion curves without enforcing one-to-one matching. An optimal matching is performed using dynamic programming, which detects similar pairs of curve segments [2].

However, training an action recognition system with only the knowledge of the motion of the current subject it is on its own a challenging task. The main problem is how we can ensure the continuity of the curves along time as an action occurs uniformly or non-uniformly within a video sequence. Unlike other approaches [7,8], which use snippets of motion trajectories, our approach uses the full length of motion curves by tracking the optical flow features. Another question concerns the optimal model that one should adopt for recognizing human actions with high accuracy. This is accomplished by a statistical measure based on the data likelihood. The different lengths of the video sequences and therefore the respective lengths of the motion curves is another problem that is addressed. The large variance between benchmark datasets shows how the algorithm may be generalized. All these problems are discussed here and proper solutions are proposed. To this end, we have conducted experiments on several datasets [9–11] that would help us to understand how human activity recognition works.

Concatenating of optical flow features along time allows us to collect time series that preserve their continuity along time. It is true that correspondence is missing. However, this is the main assumption in many works [12–14]. If data association were used the resulting feature curves would have short duration and would be incomplete, as the features disappear and reappear due to occlusion, illumination, viewpoint changes and noise. In that case, a combination of sparse approach of clustering curves with variant lengths and tracking approaches should be used [15,16]. This is not the central idea in this paper, as the nature of the feature curves drastically changes.

In the rest of the paper, the related work is presented in Section 2, while the extraction of motion curves, the clustering and the curve matching are presented in Section 3. In Section 4, we report results on the KTH [9], the UCF Sports [10] and the UCF YouTube [11] action classification datasets. Finally, conclusions are drawn in Section 5.

@&#RELATED WORK@&#

The problem of categorizing a human action remains a challenging task that has attracted much research effort in the recent years. The surveys in [17,18] provide a good overview of the numerous papers on action/activity recognition and analyze the semantics of human activity categorization. Several feature extraction methods for describing and recognizing human actions have been proposed [12,9,19,20,13]. A major family of methods relies on optical flow which has proven to be an important cue. Efros et al. [12] recognize human actions from low-resolution sports video sequences using the nearest neighbor classifier, where humans are represented by windows of height of 30 pixels. The approach of Fathi and Mori [13] is based on mid-level motion features, which are also constructed directly from optical flow features. Moreover, Wang and Mori [14] employed motion features as inputs to hidden conditional random fields and support vector machine (SVM) classifiers. Real time classification and prediction of future actions is proposed by Morris and Trivedi [21], where an activity vocabulary is learnt through a three step procedure. Other optical flow-based methods which gained popularity are presented in [22–24].

The classification of a video sequence using local features in a spatio-temporal environment has also been given much consideration. Schuldt et al. [9] represent local events in a video using space–time features, while an SVM classifier is used to recognize an action. Gorelick et al. [25] considered actions as 3D space time silhouettes of moving humans. They take advantage of the Poisson equation solution to efficiently describe an action by utilizing spectral clustering between sequences of features and applying nearest neighbor classification to characterize an action. Niebles et al. [20] addressed the problem of action recognition by creating a codebook of space–time interest points. A hierarchical approach was followed by Jhuang et al. [19], where an input video is analyzed into several feature descriptors depending on their complexity. The final classification is performed by a multi-class SVM classifier. Dollár et al. [26] proposed spatio-temporal features based on cuboid descriptors. An action descriptor of histograms of interest points, relying on [9] was presented in [27]. Random forests for action representation have also been attracting widespread interest for action recognition [28,29]. Furthermore, the key issue of how many frames are required to recognize an action is addressed by Schindler and Van Gool [30].

The problem of identifying multiple persons simultaneously and perform action recognition is presented in [31]. The authors considered that a person has first been localized by performing background subtraction techniques. Based on the Histograms of Oriented Gaussians [32] they detect a human, whereas classification of actions are made by training a SVM classifier. Action recognition using depth cameras are introduced in [33] and a new feature called “local occupancy pattern” is also proposed. A novel multi-view activity recognition method is presented in [34]. Descriptors from different views are connected together forming a new augmented feature that contains the transition between the different views. A new type of feature called the “Hankelet” is presented in [35]. This type of feature, which is formed by short tracklets, along with a BoW approach is able to recognize actions under different viewpoints, without requiring any camera calibration. Zhou and Wang [36] have also proposed a new representation of local spatio-temporal cuboids for action recognition. Low level features are encoded and classified via a kernelized SVM classifier, whereas a classification score denotes the confidence that a cuboid belongs to an atomic action. The new feature act as complementary material to the low-level feature.

Earlier approaches are based on describing actions by using dense trajectories. The work of Wang et al. [37] is focused on tracking dense sample point from video sequences using optical flow. Le et al. [38] discover the action label in an unsupervised manner by learning features directly from video data. A high-level representation of video sequences, called Action Bank, is presented by Sadanand and Corso [39]. Each video is represented as a set of action descriptors which are put in correspondence. The final classification is performed by a SVM classifier. Yan and Luo [27] have also proposed a new action descriptor based on spatial temporal interest points (STIP) [40]. In order to avoid overfitting they have also proposed a novel classification technique by combining the Adaboost and sparse representation algorithms. Wu et al. [41] employed, a visual feature using Gaussian mixture models efficiently represents the spatio-temporal context distributions between the interest point at several space and time scales. An action is represented by a set of features extracted by the interest points over the video sequence. Finally, a vocabulary based approach has been proposed by Kovashka and Grauman [42]. The main idea was to find the neighboring features around the detected interest points quantize them and form a vocabulary. Raptis et al. [8] proposed a mid-level approach extracting that spatio-temporal features construct clusters of trajectories, which can be considered as candidates of an action, and a graphical model is utilized to control these clusters.

Human action recognition using temporal templates has also been proposed by Bobick and Davis [43]. An action was represented by a motion template composed of a binary motion energy image (MEI) and a motion history image (MHI). Recognition was accomplished by matching pairs of MEI and MHI. A variation of the MEI idea was proposed by Ahmad and Lee [44], where the silhouette energy image (SEI) was proposed. The authors have also introduced several variability models to describe an action, and action classification was carried out using a variety of classifiers. Moreover, the proposed model is sensitive to illumination and background changes. In the sense of template matching techniques Rodriguez et al. [10] introduced the Maximum Average Correlation Height (MACH) filter which is a method for capturing intra-class variability by synthesizing a single action MACH filter for a given action class.

The main disadvantage of using a global representation such as optical flow, is the sensitivity to noise and partial occlusions. Space–time approaches can hardly recognize actions when more than one person are present in the scene. However, background subtraction can help to overcome this problem. Trajectory-based methods face the problem of human body detection and tracking as these are still open issues. Complex activities are more difficult to be recognized when space–time feature based approaches are employed. Furthermore, viewpoint invariance is another problem that these approaches must handle.

In the context described above, the present work has several contributions. First, human motion is represented by a small set of curves which are the mean curves of the mixture components along with their covariance matrices. The complexity of the model is considered low, as it is determined by the Bayesian Information Criterion (BIC), but any other model selection technique may be applied. Second, the computational cost is lower since the use of dimensionality reduction allows the algorithm to cope with curves of smaller lengths. Finally, the use of the longest common subsequence index allows input curves of different lengths to be compared reliably.

Our goal is to analyze and interpret different classes of actions to build a model for human activity categorization. Given a collection of figure-centric sequences, we represent motion templates using optical flow [45] at each frame. Assuming that a bounding box can be automatically obtained from the image data, we define a rectangle region of interest (ROI) around the human. A brief overview of our approach is depicted in Fig. 1
                     . In the training mode, we assume that the video sequences contain only one actor performing only one action per frame. However, in the recognition mode, we allow more than one action per video frame. The optical flow vectors as well as the motion descriptors [12] for each sequence are computed. These motion descriptors are collected together to construct motion curves, which are clustered using a mixture model to describe a unique action. Then, the motion curves are clustered and each action is modeled by a set of clustered motion curves. Action recognition is performed by matching the clusters of motion curves of the probe sequence and the clustered curves in each training sequence.

The proposed approach employs optical flow features [45]. These motion descriptors are commonly used in many recognition problems and they are shown to be quite reliable despite the existence of noisy features. Within a figure-centric scene, any human motion may be decomposed to the motion of different body parts (e.g., head and limbs). We can easily localize the motion by computing the optical flow vectors for the regions around the human torso.

Following the work of Efros et al. [12], we compute the motion descriptor for the ROI as a four-dimensional vector 
                           
                              
                                 
                                    F
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             F
                                          
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   i
                                                
                                             
                                          
                                          
                                             +
                                          
                                       
                                       ,
                                       
                                       
                                          
                                             F
                                          
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   i
                                                
                                             
                                          
                                          
                                             -
                                          
                                       
                                       ,
                                       
                                       
                                          
                                             F
                                          
                                          
                                             
                                                
                                                   y
                                                
                                                
                                                   i
                                                
                                             
                                          
                                          
                                             +
                                          
                                       
                                       ,
                                       
                                       
                                          
                                             F
                                          
                                          
                                             
                                                
                                                   y
                                                
                                                
                                                   i
                                                
                                             
                                          
                                          
                                             -
                                          
                                       
                                    
                                 
                              
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    4
                                 
                              
                           
                        , where 
                           
                              i
                              =
                              1
                              ,
                              …
                              ,
                              N
                           
                        , with N being the number of pixels in the ROI. Also, the matrix 
                           
                              F
                           
                         refers to the blurred, motion compensated optical flow. We compute the optical flow 
                           
                              F
                           
                        , which has two components, the horizontal 
                           
                              
                                 
                                    F
                                 
                                 
                                    x
                                 
                              
                           
                        , and the vertical 
                           
                              
                                 
                                    F
                                 
                                 
                                    y
                                 
                              
                           
                        , at each pixel. It is worth noting that the horizontal and vertical components of the optical flow 
                           
                              
                                 
                                    F
                                 
                                 
                                    x
                                 
                              
                           
                         and 
                           
                              
                                 
                                    F
                                 
                                 
                                    y
                                 
                              
                           
                         are half-wave rectified into four non-negative channels 
                           
                              
                                 
                                    F
                                 
                                 
                                    x
                                 
                                 
                                    +
                                 
                              
                              ,
                              
                                 
                                    F
                                 
                                 
                                    x
                                 
                                 
                                    -
                                 
                              
                              ,
                              
                                 
                                    F
                                 
                                 
                                    y
                                 
                                 
                                    +
                                 
                              
                              ,
                              
                                 
                                    F
                                 
                                 
                                    y
                                 
                                 
                                    -
                                 
                              
                           
                        , so that 
                           
                              
                                 
                                    F
                                 
                                 
                                    x
                                 
                              
                              =
                              
                                 
                                    F
                                 
                                 
                                    x
                                 
                                 
                                    +
                                 
                              
                              -
                              
                                 
                                    F
                                 
                                 
                                    x
                                 
                                 
                                    -
                                 
                              
                           
                         and 
                           
                              
                                 
                                    F
                                 
                                 
                                    y
                                 
                              
                              =
                              
                                 
                                    F
                                 
                                 
                                    y
                                 
                                 
                                    +
                                 
                              
                              -
                              
                                 
                                    F
                                 
                                 
                                    y
                                 
                                 
                                    -
                                 
                              
                           
                        . In the general case, optical flow is suffering from noisy measurements and analyzing data under these circumstances will lead to unstable results. To handle any motion artifacts due to camera movements, each half-wave motion compensated flow is blurred with a Gaussian kernel. In this way, the substantive motion information is preserved, while minor variations are discarded. Thus, any incorrectly computed flows are removed. Since all curves are considered normally distributed there is an intrinsic smoothing of the optical flow curves. Moreover, at a preprocessing step, we discard flows whose amplitude is over 
                           
                              20
                              %
                           
                         of the standard deviation of the mean amplitude of all curves for each video.

A human action is represented by a set of primitive motion curves which are constructed directly from the optical flow motion descriptors. The main idea is to extract the salient features, which describe a relative motion from each frame and associate them with the corresponding feature in the next frame.

Consider T to be the number of image frames and 
                           
                              C
                              =
                              {
                              
                                 
                                    c
                                 
                                 
                                    i
                                 
                              
                              (
                              t
                              )
                              }
                              ,
                              t
                              ∈
                              [
                              0
                              ,
                              T
                              ]
                           
                        , is a set of motion curves for the set of pixels 
                           
                              i
                              =
                              1
                              ,
                              …
                              ,
                              N
                           
                         of the ROI. Each motion curve is described as a set of points corresponding to the optical flow vector extracted in the ROI. Specifically, we describe the motion at each pixel by the optical flow vector 
                           
                              
                                 
                                    F
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             F
                                          
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   i
                                                
                                             
                                          
                                          
                                             +
                                          
                                       
                                       ,
                                       
                                          
                                             F
                                          
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   i
                                                
                                             
                                          
                                          
                                             -
                                          
                                       
                                       ,
                                       
                                          
                                             F
                                          
                                          
                                             
                                                
                                                   y
                                                
                                                
                                                   i
                                                
                                             
                                          
                                          
                                             +
                                          
                                       
                                       ,
                                       
                                          
                                             F
                                          
                                          
                                             
                                                
                                                   y
                                                
                                                
                                                   i
                                                
                                             
                                          
                                          
                                             -
                                          
                                       
                                    
                                 
                              
                           
                        . A set of motion curves for a specific action is depicted in Fig. 1. Given the set of motion descriptors for all frames, we construct the motion curves by following their optical flow components in consecutive frames. If there is no pixel displacement we consider a zero optical flow vector displacement for this pixel.

The set of motion curves describes completely the motion in the ROI. Once the motion curves are created, pixels and therefore curves that belong to the background are eliminated. We assume that the motion are normally distributed, thus, we keep flows whose values are inside 6 standard deviations of the amplitude distributions. In order to establish a correspondence between the motion curves and the actual motion, we perform clustering of the motion curves using a Gaussian mixture model. We estimate the characteristic motion which is represented by the mean trajectory of each cluster.

A motion curve is considered to be a 2D time signal:
                           
                              (1)
                              
                                 
                                    
                                       c
                                    
                                    
                                       ji
                                    
                                 
                                 (
                                 t
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             
                                                F
                                             
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      ji
                                                   
                                                
                                             
                                          
                                          (
                                          t
                                          )
                                          ,
                                          
                                             
                                                F
                                             
                                             
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      ji
                                                   
                                                
                                             
                                          
                                          (
                                          t
                                          )
                                       
                                    
                                 
                                 ,
                                 
                                 t
                                 ∈
                                 [
                                 0
                                 ,
                                 T
                                 ]
                                 ,
                              
                           
                        where the index 
                           
                              i
                              =
                              1
                              ,
                              …
                              ,
                              N
                           
                         represents the 
                           
                              i
                              th
                           
                         pixel, for the 
                           
                              j
                              th
                           
                         video sequence in the training set. To efficiently learn human action categories, each action is represented by a GMM by clustering the motion curves in every sequence of the training set. The 
                           
                              p
                              th
                           
                         action (
                           
                              p
                              =
                              1
                              ,
                              …
                              ,
                              A
                           
                        ), in the 
                           
                              j
                              th
                           
                         video sequence (
                           
                              j
                              =
                              1
                              ,
                              …
                              ,
                              
                                 
                                    S
                                 
                                 
                                    p
                                 
                              
                           
                        ), is modeled by a set of 
                           
                              
                                 
                                    K
                                 
                                 
                                    j
                                 
                                 
                                    p
                                 
                              
                           
                         mean curves learned by a GMM. The likelihood of the 
                           
                              i
                              th
                           
                         curve 
                           
                              
                                 
                                    c
                                 
                                 
                                    ji
                                 
                                 
                                    p
                                 
                              
                              (
                              t
                              )
                           
                         of the 
                           
                              p
                              th
                           
                         action in the 
                           
                              j
                              th
                           
                         video is given by:
                           
                              (2)
                              
                                 p
                                 (
                                 
                                    
                                       c
                                    
                                    
                                       ji
                                    
                                    
                                       p
                                    
                                 
                                 ;
                                 
                                    
                                       π
                                    
                                    
                                       j
                                    
                                    
                                       p
                                    
                                 
                                 ,
                                 
                                    
                                       μ
                                    
                                    
                                       j
                                    
                                    
                                       p
                                    
                                 
                                 ,
                                 
                                    
                                       Σ
                                    
                                    
                                       j
                                    
                                    
                                       p
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          
                                             
                                                K
                                             
                                             
                                                j
                                             
                                             
                                                p
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       π
                                    
                                    
                                       jk
                                    
                                    
                                       p
                                    
                                 
                                 N
                                 (
                                 
                                    
                                       c
                                    
                                    
                                       ji
                                    
                                    
                                       p
                                    
                                 
                                 (
                                 t
                                 )
                                 ;
                                 
                                    
                                       μ
                                    
                                    
                                       jk
                                    
                                    
                                       p
                                    
                                 
                                 ,
                                 
                                    
                                       Σ
                                    
                                    
                                       jk
                                    
                                    
                                       p
                                    
                                 
                                 )
                                 ,
                                 
                                 t
                                 ∈
                                 [
                                 0
                                 ,
                                 T
                                 ]
                                 ,
                              
                           
                        where 
                           
                              
                                 
                                    π
                                 
                                 
                                    j
                                 
                                 
                                    p
                                 
                              
                              =
                              
                                 
                                    {
                                    
                                       
                                          π
                                       
                                       
                                          jk
                                       
                                       
                                          p
                                       
                                    
                                    }
                                 
                                 
                                    k
                                    =
                                    1
                                 
                                 
                                    
                                       
                                          K
                                       
                                       
                                          j
                                       
                                       
                                          p
                                       
                                    
                                 
                              
                           
                         are the mixing coefficients, 
                           
                              
                                 
                                    μ
                                 
                                 
                                    j
                                 
                                 
                                    p
                                 
                              
                              =
                              
                                 
                                    {
                                    
                                       
                                          μ
                                       
                                       
                                          jk
                                       
                                       
                                          p
                                       
                                    
                                    }
                                 
                                 
                                    k
                                    =
                                    1
                                 
                                 
                                    
                                       
                                          K
                                       
                                       
                                          j
                                       
                                       
                                          p
                                       
                                    
                                 
                              
                           
                         is the set of the mean curves and 
                           
                              
                                 
                                    Σ
                                 
                                 
                                    j
                                 
                                 
                                    p
                                 
                              
                              =
                              
                                 
                                    {
                                    
                                       
                                          Σ
                                       
                                       
                                          jk
                                       
                                       
                                          p
                                       
                                    
                                    }
                                 
                                 
                                    k
                                    =
                                    1
                                 
                                 
                                    
                                       
                                          K
                                       
                                       
                                          j
                                       
                                       
                                          p
                                       
                                    
                                 
                              
                           
                         is the set of covariance matrices. The covariance matrix in Eq. (2) is a diagonal 
                           
                              
                                 
                                    Σ
                                 
                                 
                                    jk
                                 
                                 
                                    p
                                 
                              
                              =
                              diag
                              (
                              
                                 
                                    σ
                                 
                                 
                                    jk
                                    ,
                                    1
                                 
                                 
                                    2
                                    p
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    σ
                                 
                                 
                                    jk
                                    ,
                                    T
                                 
                                 
                                    2
                                    p
                                 
                              
                              )
                           
                        . Therefore, the log-likelihood of the 
                           
                              p
                              th
                           
                         action in the 
                           
                              j
                              th
                           
                         video can be written as:
                           
                              (3)
                              
                                 L
                                 (
                                 
                                    
                                       c
                                    
                                    
                                       j
                                    
                                    
                                       p
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       
                                          ∏
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          
                                             
                                                N
                                             
                                             
                                                j
                                             
                                             
                                                p
                                             
                                          
                                       
                                    
                                 
                                 ln
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          
                                             
                                                K
                                             
                                             
                                                j
                                             
                                             
                                                p
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       π
                                    
                                    
                                       jk
                                    
                                    
                                       p
                                    
                                 
                                 N
                                 (
                                 
                                    
                                       c
                                    
                                    
                                       ji
                                    
                                    
                                       p
                                    
                                 
                                 (
                                 t
                                 )
                                 ;
                                 
                                    
                                       μ
                                    
                                    
                                       jk
                                    
                                    
                                       p
                                    
                                 
                                 ,
                                 
                                    
                                       Σ
                                    
                                    
                                       jk
                                    
                                    
                                       p
                                    
                                 
                                 )
                                 ,
                                 
                                 t
                                 ∈
                                 [
                                 0
                                 ,
                                 T
                                 ]
                                 ,
                              
                           
                        where 
                           
                              
                                 
                                    N
                                 
                                 
                                    j
                                 
                                 
                                    p
                                 
                              
                           
                         is the number of motion curves in the training set describing the 
                           
                              p
                              th
                           
                         action in the 
                           
                              j
                              th
                           
                         video.

The GMM is trained using the Expectation–Maximization (EM) algorithm [1], which provides a solution to the problem of estimating the model’s parameters. The initialization of the EM algorithm is performed by the K-means algorithm. We have examined several configurations for the initialization of K-means and we decided to employ K-means with 50 different random initializations which were consistent and had no significant impact on the final classification. However, the number of mixture components should be determined. To select the number of the Gaussians 
                           
                              
                                 
                                    K
                                 
                                 
                                    j
                                 
                                 
                                    p
                                 
                              
                           
                        , for the 
                           
                              j
                              th
                           
                         training video sequence, representing the 
                           
                              p
                              th
                           
                         action, the Bayesian Information Criterion (BIC) [1] is used:
                           
                              (4)
                              
                                 BIC
                                 (
                                 
                                    
                                       c
                                    
                                    
                                       j
                                    
                                    
                                       p
                                    
                                 
                                 )
                                 =
                                 L
                                 (
                                 
                                    
                                       c
                                    
                                    
                                       j
                                    
                                    
                                       p
                                    
                                 
                                 (
                                 t
                                 )
                                 )
                                 -
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       MN
                                    
                                    
                                       j
                                    
                                    
                                       p
                                    
                                 
                                 ,
                                 
                                 t
                                 ∈
                                 [
                                 0
                                 ,
                                 T
                                 ]
                                 ,
                              
                           
                        where M is the number of parameters of the GMM to be inferred. Thus, when EM converges the cluster labels of the motion curves are obtained. This is schematically depicted in Fig. 1, where a set of motion curves, representing a certain action (e.g., p), in a video sequence (e.g., labeled by j) is clustered by a GMM into 
                           
                              
                                 
                                    K
                                 
                                 
                                    j
                                 
                                 
                                    p
                                 
                              
                              =
                              2
                           
                         curves for action representation. Note that, a given action is generally represented by a varying number of mean curves as the BIC criterion may result in a different number of components in different sequences.

Apart from the BIC criterion, there are other techniques for determining the appropriateness of a model such as the Akaike Information Criterion (AIC) [1].
                           
                              (5)
                              
                                 AIC
                                 (
                                 
                                    
                                       c
                                    
                                    
                                       j
                                    
                                    
                                       p
                                    
                                 
                                 )
                                 =
                                 L
                                 (
                                 
                                    
                                       c
                                    
                                    
                                       j
                                    
                                    
                                       p
                                    
                                 
                                 (
                                 t
                                 )
                                 )
                                 -
                                 M
                                 ,
                                 
                                 t
                                 ∈
                                 [
                                 0
                                 ,
                                 T
                                 ]
                                 ,
                              
                           
                        where M is the number of parameters of the GMM to be inferred. BIC is independent of the prior, it can measure the efficiency of the parameterized model in terms of predicting the data and it penalizes the complexity of the model, where complexity refers to the number of parameters in the model. It is also approximately equal to the minimum description length criterion [1] but with negative sign, it can be used to choose the number of clusters according to the intrinsic complexity present in a particular dataset and it is closely related to other penalized likelihood criteria such as the AIC. BIC tends to select highly parsimonious models, while AIC tends to include more parameters [46,47]. Complexity measures such as BIC and AIC have the virtue of being easy to evaluate, but can also give misleading results.

Once a new probe video is presented, where we must recognize the action depicted, the optical flow is computed, motion curves are created and clustered, and they are compared with the learned mean curves of the training set. Recall that human actions are not uniform sequences in time, since different individuals perform the same action in different manner and at different speeds. This means that motion curves have varied lengths. An optimal matching may be performed using dynamic programming which detects similar pairs of curve segments. The longest common subsequence (LCSS) [2] is robust to noise and provides a similarity measure between motion curves since not all points need to be matched.

Let 
                           
                              μ
                              (
                              t
                              )
                              ,
                              t
                              ∈
                              [
                              0
                              ,
                              T
                              ]
                           
                         and 
                           
                              ν
                              (
                              τ
                              )
                           
                        , 
                           
                              τ
                              ∈
                              [
                              0
                              ,
                              
                                 
                                    T
                                 
                                 
                                    ′
                                 
                              
                              ]
                           
                         be two curves of different lengths. Then, we define the affinity between the two curves as:
                           
                              (6)
                              
                                 α
                                 
                                    
                                       
                                          μ
                                          (
                                          t
                                          )
                                          ,
                                          ν
                                          (
                                          τ
                                          )
                                       
                                    
                                 
                                 =
                                 
                                    
                                       LCSS
                                       
                                          
                                             
                                                μ
                                                (
                                                t
                                                )
                                                ,
                                                ν
                                                (
                                                τ
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                          min
                                       
                                       (
                                       T
                                       ,
                                       
                                          
                                             T
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                    
                                 
                                 ,
                              
                           
                        where the 
                           
                              LCSS
                              
                                 
                                    
                                       μ
                                       (
                                       t
                                       )
                                       ,
                                       ν
                                       (
                                       τ
                                       )
                                    
                                 
                              
                           
                         (Eq. (7)) indicates the quality of the matching between the curves 
                           
                              μ
                              (
                              t
                              )
                           
                         and 
                           
                              ν
                              (
                              τ
                              )
                           
                         and measures the number of the matching points between two curves of different lengths.
                           
                              (7)
                              
                                 LCSS
                                 
                                    
                                       
                                          μ
                                          (
                                          t
                                          )
                                          ,
                                          ν
                                          (
                                          τ
                                          )
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   0
                                                   ,
                                                   
                                                   if
                                                   
                                                   T
                                                   =
                                                   0
                                                   
                                                   or
                                                   
                                                   
                                                      
                                                         T
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   =
                                                   0
                                                   ,
                                                
                                             
                                             
                                                
                                                   1
                                                   +
                                                   LCSS
                                                   
                                                      
                                                         
                                                            μ
                                                            
                                                               
                                                                  (
                                                                  t
                                                                  )
                                                               
                                                               
                                                                  
                                                                     
                                                                        T
                                                                     
                                                                     
                                                                        t
                                                                     
                                                                  
                                                                  -
                                                                  1
                                                               
                                                            
                                                            ,
                                                            ν
                                                            
                                                               
                                                                  (
                                                                  τ
                                                                  )
                                                               
                                                               
                                                                  
                                                                     
                                                                        T
                                                                     
                                                                     
                                                                        τ
                                                                     
                                                                     
                                                                        ′
                                                                     
                                                                  
                                                                  -
                                                                  1
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   ,
                                                   if
                                                   
                                                   |
                                                   μ
                                                   (
                                                   t
                                                   )
                                                   -
                                                   ν
                                                   (
                                                   τ
                                                   )
                                                   |
                                                   <
                                                   ε
                                                   
                                                   and
                                                   
                                                   |
                                                   T
                                                   -
                                                   
                                                      
                                                         T
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   |
                                                   <
                                                   δ
                                                
                                             
                                             
                                                
                                                   
                                                      max
                                                   
                                                   
                                                      
                                                         
                                                            LCSS
                                                            
                                                               
                                                                  
                                                                     μ
                                                                     
                                                                        
                                                                           (
                                                                           t
                                                                           )
                                                                        
                                                                        
                                                                           
                                                                              
                                                                                 T
                                                                              
                                                                              
                                                                                 t
                                                                              
                                                                           
                                                                           -
                                                                           1
                                                                        
                                                                     
                                                                     ,
                                                                     ν
                                                                     
                                                                        
                                                                           (
                                                                           τ
                                                                           )
                                                                        
                                                                        
                                                                           
                                                                              
                                                                                 T
                                                                              
                                                                              
                                                                                 τ
                                                                              
                                                                              
                                                                                 ′
                                                                              
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                            ,
                                                            
                                                            LCSS
                                                            
                                                               
                                                                  
                                                                     μ
                                                                     
                                                                        
                                                                           (
                                                                           t
                                                                           )
                                                                        
                                                                        
                                                                           
                                                                              
                                                                                 T
                                                                              
                                                                              
                                                                                 t
                                                                              
                                                                           
                                                                        
                                                                     
                                                                     ,
                                                                     ν
                                                                     
                                                                        
                                                                           (
                                                                           τ
                                                                           )
                                                                        
                                                                        
                                                                           
                                                                              
                                                                                 T
                                                                              
                                                                              
                                                                                 τ
                                                                              
                                                                              
                                                                                 ′
                                                                              
                                                                           
                                                                           -
                                                                           1
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   ,
                                                   
                                                   otherwise
                                                
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        Note that the LCSS is a modification of the edit distance [5] and its value is computed within a constant time window 
                           
                              δ
                           
                         and a constant amplitude 
                           
                              ε
                           
                        , that control the matching thresholds. The terms 
                           
                              μ
                              
                                 
                                    (
                                    t
                                    )
                                 
                                 
                                    
                                       
                                          T
                                       
                                       
                                          t
                                       
                                    
                                 
                              
                           
                         and 
                           
                              ν
                              
                                 
                                    (
                                    τ
                                    )
                                 
                                 
                                    
                                       
                                          T
                                       
                                       
                                          τ
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                           
                         denote the number of curve points up to time t and 
                           
                              τ
                           
                        , accordingly. The idea is to match segments of curves by performing time stretching so that segments that lie close to each other (their temporal coordinates are within 
                           
                              δ
                           
                        ) can be matched if their amplitudes differ at most by 
                           
                              ε
                           
                         (Fig. 2
                        ). A characteristic example of how two motion curves are matched is depicted in Fig. 2.

When a probe video sequence is presented, its motion curves 
                           
                              z
                              =
                              
                                 
                                    {
                                    z
                                    }
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    N
                                 
                              
                           
                         are clustered using GMMs of various numbers of components using the EM algorithm. The BIC criterion is employed to determine the optimal value of the number of Gaussians K, which represent the action in the probe sequence. Thus, we have a set of K mean curves 
                           
                              
                                 
                                    ν
                                 
                                 
                                    k
                                 
                              
                              ,
                              k
                              =
                              1
                              ,
                              …
                              ,
                              K
                           
                         modeling the probe action, whose likelihood is given by:
                           
                              (8)
                              
                                 L
                                 (
                                 z
                                 )
                                 =
                                 
                                    
                                       
                                          ∏
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          N
                                       
                                    
                                 
                                 ln
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          K
                                       
                                    
                                 
                                 
                                    
                                       π
                                    
                                    
                                       k
                                    
                                 
                                 N
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       i
                                    
                                 
                                 ;
                                 
                                    
                                       ν
                                    
                                    
                                       k
                                    
                                 
                                 ,
                                 
                                    
                                       Σ
                                    
                                    
                                       k
                                    
                                 
                                 )
                                 ,
                              
                           
                        where 
                           
                              
                                 
                                    Σ
                                 
                                 
                                    k
                                 
                              
                           
                         is the covariance matrix for the 
                           
                              k
                              th
                           
                         component.

Recognition of the action present in the probe video sequence is performed by assigning the probe action to the action of the labeled sequence which is most similar. As both the probe sequence and the 
                           
                              j
                              th
                           
                         labeled video sequence of the 
                           
                              p
                              th
                           
                         action in the training set are represented by a number of mean curves 
                           
                              ν
                              =
                              
                                 
                                    {
                                    
                                       
                                          ν
                                       
                                       
                                          i
                                       
                                    
                                    }
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    K
                                 
                              
                           
                         and 
                           
                              
                                 
                                    μ
                                 
                                 
                                    j
                                 
                                 
                                    p
                                 
                              
                              =
                              
                                 
                                    {
                                    
                                       
                                          μ
                                       
                                       
                                          jk
                                       
                                       
                                          p
                                       
                                    
                                    }
                                 
                                 
                                    k
                                    =
                                    1
                                 
                                 
                                    
                                       
                                          K
                                       
                                       
                                          j
                                       
                                       
                                          p
                                       
                                    
                                 
                              
                           
                         respectively, the overall distance between them is computed by:
                           
                              (9)
                              
                                 d
                                 (
                                 
                                    
                                       μ
                                    
                                    
                                       j
                                    
                                    
                                       p
                                    
                                 
                                 ,
                                 ν
                                 )
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          
                                             
                                                K
                                             
                                             
                                                j
                                             
                                             
                                                p
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          ℓ
                                          =
                                          1
                                       
                                       
                                          K
                                       
                                    
                                 
                                 
                                    
                                       π
                                    
                                    
                                       jk
                                    
                                    
                                       p
                                    
                                 
                                 
                                    
                                       π
                                    
                                    
                                       ℓ
                                    
                                 
                                 
                                    
                                       
                                          1
                                          -
                                          α
                                          
                                             
                                                
                                                   
                                                      
                                                         μ
                                                      
                                                      
                                                         jk
                                                      
                                                      
                                                         p
                                                      
                                                   
                                                   (
                                                   t
                                                   )
                                                   ,
                                                   
                                                      
                                                         ν
                                                      
                                                      
                                                         ℓ
                                                      
                                                   
                                                   (
                                                   τ
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        where 
                           
                              
                                 
                                    π
                                 
                                 
                                    jk
                                 
                                 
                                    p
                                 
                              
                           
                         and 
                           
                              
                                 
                                    π
                                 
                                 
                                    ℓ
                                 
                              
                           
                         are the GMM mixing proportions for the labeled and probe sequence, respectively, that is 
                           
                              
                                 
                                    ∑
                                 
                                 
                                    k
                                 
                              
                              
                                 
                                    π
                                 
                                 
                                    jk
                                 
                                 
                                    p
                                 
                              
                              =
                              1
                           
                         and 
                           
                              
                                 
                                    ∑
                                 
                                 
                                    ℓ
                                 
                              
                              
                                 
                                    π
                                 
                                 
                                    ℓ
                                 
                              
                              =
                              1
                           
                        . The probe sequence 
                           
                              ν
                           
                         is categorized with respect to its minimum distance from an already learned action:
                           
                              (10)
                              
                                 
                                    
                                       
                                          
                                             
                                                j
                                             
                                             
                                                ∗
                                             
                                          
                                          ,
                                          
                                             
                                                p
                                             
                                             
                                                ∗
                                             
                                          
                                       
                                    
                                 
                                 =
                                 arg
                                 
                                 
                                    
                                       min
                                    
                                    
                                       j
                                       ,
                                       p
                                    
                                 
                                 d
                                 (
                                 
                                    
                                       μ
                                    
                                    
                                       j
                                    
                                    
                                       p
                                    
                                 
                                 ,
                                 ν
                                 )
                                 .
                              
                           
                        
                     

The canonical time warping (CTW) [3] solves the problem of spatio-temporal alignment of human motion between two time series. Based on dynamic time warping, the algorithm in [5] finds the temporal alignment of two subjects maximizing the spatial correlation between them. Given two time series 
                           
                              
                                 
                                    C
                                 
                                 
                                    1
                                 
                              
                              =
                              [
                              
                                 
                                    c
                                 
                                 
                                    1
                                 
                              
                              (
                              0
                              )
                              ,
                              …
                              ,
                              
                                 
                                    c
                                 
                                 
                                    1
                                 
                              
                              (
                              T
                              )
                              ]
                           
                         and 
                           
                              
                                 
                                    C
                                 
                                 
                                    2
                                 
                              
                              =
                              [
                              
                                 
                                    c
                                 
                                 
                                    2
                                 
                              
                              (
                              0
                              )
                              ,
                              …
                              ,
                              
                                 
                                    c
                                 
                                 
                                    2
                                 
                              
                              (
                              
                                 
                                    T
                                 
                                 
                                    ′
                                 
                              
                              )
                              ]
                           
                         canonical time warping minimizes the following energy function:
                           
                              (11)
                              
                                 
                                    
                                       J
                                    
                                    
                                       ctw
                                    
                                 
                                 (
                                 
                                    
                                       W
                                    
                                    
                                       
                                          
                                             C
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 ,
                                 
                                    
                                       W
                                    
                                    
                                       
                                          
                                             C
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 ,
                                 
                                    
                                       V
                                    
                                    
                                       
                                          
                                             C
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 ,
                                 
                                    
                                       V
                                    
                                    
                                       
                                          
                                             C
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 )
                                 =
                                 ‖
                                 
                                    
                                       V
                                    
                                    
                                       
                                          
                                             C
                                          
                                          
                                             1
                                          
                                       
                                    
                                    
                                       T
                                    
                                 
                                 
                                    
                                       C
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       W
                                    
                                    
                                       
                                          
                                             C
                                          
                                          
                                             1
                                          
                                       
                                    
                                    
                                       T
                                    
                                 
                                 -
                                 
                                    
                                       V
                                    
                                    
                                       
                                          
                                             C
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       T
                                    
                                 
                                 
                                    
                                       C
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       W
                                    
                                    
                                       
                                          
                                             C
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       T
                                    
                                 
                                 
                                    
                                       ‖
                                    
                                    
                                       F
                                    
                                    
                                       2
                                    
                                 
                                 ,
                              
                           
                        where 
                           
                              
                                 
                                    W
                                 
                                 
                                    
                                       
                                          C
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                           
                         and 
                           
                              
                                 
                                    W
                                 
                                 
                                    C
                                    2
                                 
                              
                           
                         are binary selection matrices that need to be inferred to align 
                           
                              
                                 
                                    C
                                 
                                 
                                    1
                                 
                              
                           
                         and 
                           
                              
                                 
                                    C
                                 
                                 
                                    2
                                 
                              
                           
                        , and 
                           
                              
                                 
                                    V
                                 
                                 
                                    
                                       
                                          C
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                              ,
                              
                                 
                                    V
                                 
                                 
                                    
                                       
                                          C
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                           
                         parameterize the spatial warping by projecting sequences into the same coordinate system.

Dimensionality reduction methods [4] may be employed in order to reduce the dimension of the motion curves and to enforce them to be of equal length. In the experiments, Principal Complements Analysis (PCA) [48] was chosen as a simple linear method but any other non-linear technique [4] could also be applied. When PCA is employed the time ordering is suppressed and curves are then transformed into feature vectors. In that case, the Bhattacharyya distance [5] is (among others) an appropriate matching measure.

Let 
                           
                              
                                 
                                    v
                                 
                                 
                                    1
                                 
                              
                           
                         and 
                           
                              
                                 
                                    v
                                 
                                 
                                    2
                                 
                              
                           
                        , be two feature vectors following Gaussian distributions, with means 
                           
                              
                                 
                                    μ
                                 
                                 
                                    1
                                 
                              
                           
                         and 
                           
                              
                                 
                                    μ
                                 
                                 
                                    2
                                 
                              
                           
                         and covariance matrices 
                           
                              
                                 
                                    Σ
                                 
                                 
                                    1
                                 
                              
                           
                         and 
                           
                              
                                 
                                    Σ
                                 
                                 
                                    2
                                 
                              
                           
                        , respectively. The Bhattacharyya distance has the form:
                           
                              (12)
                              
                                 
                                    
                                       d
                                    
                                    
                                       B
                                    
                                 
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       1
                                       j
                                    
                                    
                                       p
                                    
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       8
                                    
                                 
                                 
                                    
                                       (
                                       
                                          
                                             μ
                                          
                                          
                                             1
                                          
                                       
                                       -
                                       
                                          
                                             μ
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    
                                       T
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         Σ
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         Σ
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                    
                                       -
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       μ
                                    
                                    
                                       1
                                    
                                 
                                 -
                                 
                                    
                                       μ
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 ln
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            Σ
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            Σ
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                             
                                                2
                                                
                                                   
                                                      |
                                                      
                                                         
                                                            Σ
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      |
                                                      |
                                                      
                                                         
                                                            Σ
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      |
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                     

To perform the match, one can project a probe video feature vector 
                           
                              
                                 
                                    v
                                 
                                 
                                    2
                                 
                              
                              =
                              
                                 
                                    {
                                    
                                       
                                          v
                                       
                                       
                                          2
                                          i
                                       
                                    
                                    }
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    K
                                 
                              
                           
                         onto its own subspace by a projection matrix specified to that video and assume the label that lies closer than all the training feature vectors 
                           
                              
                                 
                                    v
                                 
                                 
                                    1
                                    j
                                 
                                 
                                    p
                                 
                              
                              =
                              
                                 
                                    {
                                    
                                       
                                          v
                                       
                                       
                                          1
                                          jk
                                       
                                       
                                          p
                                       
                                    
                                    }
                                 
                                 
                                    k
                                    =
                                    1
                                 
                                 
                                    
                                       
                                          K
                                       
                                       
                                          j
                                       
                                       
                                          p
                                       
                                    
                                 
                              
                           
                        . For Gaussian mixture models, we define the Bhattacharyya distance as:
                           
                              (13)
                              
                                 
                                    
                                       d
                                    
                                    
                                       GMM
                                    
                                 
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       1
                                       j
                                    
                                    
                                       p
                                    
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          
                                             
                                                K
                                             
                                             
                                                j
                                             
                                             
                                                p
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          ℓ
                                          =
                                          1
                                       
                                       
                                          K
                                       
                                    
                                 
                                 
                                    
                                       π
                                    
                                    
                                       jk
                                    
                                    
                                       p
                                    
                                 
                                 
                                    
                                       π
                                    
                                    
                                       ℓ
                                    
                                 
                                 
                                    
                                       d
                                    
                                    
                                       B
                                    
                                 
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       1
                                       jk
                                    
                                    
                                       p
                                    
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       2
                                       ℓ
                                    
                                 
                                 )
                                 ,
                              
                           
                        where 
                           
                              
                                 
                                    π
                                 
                                 
                                    jk
                                 
                                 
                                    p
                                 
                              
                           
                         and 
                           
                              
                                 
                                    π
                                 
                                 
                                    ℓ
                                 
                              
                           
                         are the GMM mixing proportions for the labeled and probe sequence, respectively. This is common in GMM modeling [49]. The probe feature vector 
                           
                              
                                 
                                    v
                                 
                                 
                                    2
                                 
                              
                           
                         is categorized with respect to the minimum distance from an already learned action:
                           
                              (14)
                              
                                 
                                    
                                       
                                          
                                             
                                                j
                                             
                                             
                                                ∗
                                             
                                          
                                          ,
                                          
                                             
                                                p
                                             
                                             
                                                ∗
                                             
                                          
                                       
                                    
                                 
                                 =
                                 arg
                                 
                                 
                                    
                                       min
                                    
                                    
                                       j
                                       ,
                                       p
                                    
                                 
                                 
                                    
                                       d
                                    
                                    
                                       GMM
                                    
                                 
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       1
                                       j
                                    
                                    
                                       p
                                    
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 .
                              
                           
                        
                     

The overall approach for learning an action and categorizing a probe are summarized in Algorithms 1 and 2, respectively. The steps inside the parenthesis indicate the extra steps when PCA is employed.
                           Algorithm 1
                           Action learning 
                                 
                                    
                                       
                                       
                                          
                                             
                                                Input:
                                                Training video sequences
                                          
                                          
                                             
                                                Output:
                                                GMMs summarizing each action in each sequence
                                          
                                          
                                             
                                                
                                                   
                                                      •
                                                      
                                                         For each action
                                                            
                                                               -
                                                               
                                                                  For each video sequence representing the action
                                                            
                                                         
                                                         
                                                            
                                                               ∗
                                                               Compute the optical flow at each pixel and generate half-wave rectified features [12].
                                                            
                                                            
                                                               ∗
                                                               Construct the motion curves by concatenating the optical flow features.
                                                            
                                                            
                                                               ∗
                                                               (Perform dimensionality reduction of the motion curves.)
                                                            
                                                            
                                                               ∗
                                                               Cluster the motion curves by training GMMs with varying number of components and select the model maximizing the BIC criterion [1].
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

Action categorization 
                                 
                                    
                                       
                                       
                                          
                                             
                                                Input: 
                                                A probe video sequence to be categorized and the GMMs summarizing the actions in the training sequences
                                          
                                          
                                             
                                                Output: 
                                                Action label
                                          
                                          
                                             
                                                
                                                   
                                                      •
                                                      Compute the optical flow at each pixel of the probe sequence and generate half-wave rectified features [12].
                                                   
                                                   
                                                      •
                                                      Construct the motion curves by concatenating the optical flow features.
                                                   
                                                   
                                                      •
                                                      (Project the motion curves onto their own subspace by a projection matrix.)
                                                   
                                                   
                                                      •
                                                      Cluster the motion curves by training GMMs with varying number of components and select the model maximizing the BIC criterion [1].
                                                   
                                                   
                                                      •
                                                      Compute the distances between the GMM of the probe sequence and each GMM of the learnt actions.
                                                   
                                                   
                                                      •
                                                      Classify the probe sequence using a nearest neighbor classifier.
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

@&#EXPERIMENTAL RESULTS@&#

In what follows, we refer to our mixtures of curves action recognition method by the acronym TMAR. We evaluated the proposed method on action recognition by conducting a set of experiments over publicly available datasets. First, we applied the algorithm to the KTH dataset [9]. This dataset consists of 
                        
                           2.391
                        
                      sequences and contains six types of human actions such as walking, jogging, running, boxing, hand waving, and hand clapping. These actions are repeatedly performed by 25 different people in four different environments: outdoors (s1), outdoors with scale variation (s2), outdoors with different clothes (s3), and indoors (s4). The video sequences were acquired using a static camera and include a uniform background. The average length of the video sequences is four seconds, while they were downsampled to a spatial resolution of 
                        
                           160
                           ×
                           120
                        
                      pixels. Fig. 3
                      depicts sample snapshots from the KTH dataset.

We tested the action recognition performance of the proposed method by using a leave-one-out cross validation approach. Accordingly, the model from the videos of 24 subjects was learned while the algorithm was tested on the remaining subjects and averaged the recognition results. The confusion matrices over the KTH dataset for this leave-one-out approach are shown in Fig. 4
                     . A recognition rate of 
                        
                           96.7
                           %
                        
                      was achieved when only the BIC criterion was employed in conjunction with the LCSS metric, 
                        
                           93.8
                           %
                        
                      when the CTW alignment is employed, and 
                        
                           98.3
                           %
                        
                      using PCA. In addition, comparison of the proposed method with other state-of-the-art methods is reported in Table 1
                     . The results of [9,19,13,20,22,50,14,41,38,27,39] are obtained from the original papers. Note that, the TMAR approach provides the more accurate recognition rates. Notice that all motion curves are reduced to a length that explains the 
                        
                           90
                           %
                        
                      of the eigenvalue sum, which results in a reduced feature vector length of 50 instances with respect to the original 
                        
                           3.000
                        
                      time instances.

In order to examine the behavior and the consistency of the method to the BIC criterion, we have also applied the algorithm without using BIC but having a predetermined number of Gaussian components for both the training and the test steps. Therefore, we fixed the number of Gaussians 
                        
                           
                              
                                 K
                              
                              
                                 j
                              
                              
                                 p
                              
                           
                        
                      to values varying from one to the square root of the maximum number of the motion curves and executed the algorithm. The TMAR (LCSS) approach attains high action classification accuracy as the BIC criterion determines the optimal value of Gaussians 
                        
                           
                              
                                 K
                              
                              
                                 j
                              
                              
                                 p
                              
                           
                        
                      for this dataset. Fig. 5
                      depicts the accuracy rate for the TMAR (LCSS), TMAR (CTW) and TMAR (PCA) approaches with respect to the number of mixture components. As the number of curves representing each action is relatively small (30–60 curves per action), a large number of Gaussian components may lead to model overfitting. As the number of Gaussians is 
                        
                           
                              
                                 K
                              
                              
                                 j
                              
                              
                                 p
                              
                           
                           ⩾
                           3
                        
                      for the TMAR (LCSS), 
                        
                           
                              
                                 K
                              
                              
                                 j
                              
                              
                                 p
                              
                           
                           ⩾
                           5
                        
                      for the TMAR (CTW) and 
                        
                           
                              
                                 K
                              
                              
                                 j
                              
                              
                                 p
                              
                           
                           ⩾
                           4
                        
                      for the TMAR (PCA) the accuracy rate drastically falls. This fact indicates the dependency of the recognition accuracy over the number of Gaussian components as an action is represented by few motion curves.

In order to provide a statistical evidence of the recognition accuracy we present some statistical indices (Tables 2 and 3
                     
                     ). The p-value is the probability of obtaining a statistical test at least as extreme as the one that was actually observed, assuming that the null hypothesis is true. A small p-value (
                        
                           p
                           ⩽
                           0.05
                        
                     ) indicates strong evidence against the null hypothesis, so we reject the null hypothesis. A large p-value (
                        
                           p
                           >
                           0.05
                        
                     ) indicates weak evidence against the null hypothesis, so we fail to reject the null hypothesis. Specifically, the null hypothesis was set to 
                        
                           
                              
                                 H
                              
                              
                                 0
                              
                           
                        
                     : the recognition results of the state-of-the-art methods are better than the proposed and the alternative hypothesis is defined as 
                        
                           
                              
                                 H
                              
                              
                                 α
                              
                           
                        
                     : the proposed method outperforms the state-of-the-art methods. In Tables 2 and 3, statistical measurements for the KTH dataset are shown. TMAR (LCSS-BIC) and TMAR (PCA-BIC) reject the null hypothesis in the majority of the cases while, TMAR (CTW-BIC) rejects the null hypothesis in only two cases. Thus, the statistical significance meaning holds for TMAR (LCSS-BIC) and TMAR (PCA-BIC).

We have also applied our algorithm to the UCF Sports dataset [10]. This dataset consists of nine main actions such as diving, golf-swinging, kicking, lifting, horse riding, running, skating, swinging and walking. The dataset contains approximately 200 video sequences at a resolution of 
                        
                           720
                           ×
                           480
                        
                      pixels, which are captured in natural environment with a wide range of scenes and viewpoints. Fig. 6
                      depicts some sample frames from the UCF Sports dataset.

To test the proposed method on action recognition we also adopted the leave-one-out scheme. In Fig. 7
                      are depicted the confusion matrices for the TMAR (LCSS), TMAR (CTW) and the TMAR (PCA) approaches. TMAR (LCSS) achieves 
                        
                           94.6
                           %
                        
                      recognition accuracy with optimal number of components (BIC criterion) and 
                        
                           90.1
                           %
                        
                      when the CTW alignment is employed. We also achieve the highest recognition accuracy of 
                        
                           95.1
                           %
                        
                      when the proposed method uses PCA. In Fig. 8
                     , the dependency of the recognition accuracy with respect to the number of the Gaussian components is shown. Note that, for all three approaches as the number of components increases the recognition accuracy decreases, which may occur due to model overfitting. In the case where 
                        
                           
                              
                                 K
                              
                              
                                 j
                              
                              
                                 p
                              
                           
                           =
                           3
                        
                      all three approaches reach the highest peek of the graph. For 
                        
                           
                              
                                 K
                              
                              
                                 j
                              
                              
                                 p
                              
                           
                           ⩾
                           4
                        
                      the recognition accuracy begins to decrease. Table 4
                     , shows the comparison between our TMAR approach, the baseline method using the BIC criterion in conjunction with the LCSS metric and the CTW alignment, the proposed method with PCA and previous approaches on the UCF Sports dataset. The results of [10,42,14,41,38,27,39] are obtained from the original papers. As it can be observed, the TMAR (PCA) approach preforms better than all the other methods, while TMAR (LCSS) performs better for seven out of eight of the other methods. On the other hand, TMAR (CTW) has the less desirable performance as it outreaches four out of eight of the other methods on the same dataset.

Statistical evidence for the UCF Sports dataset is shown in Tables 5 and 6
                     
                     . TMAR (LCSS-BIC) and TMAR (PCA-BIC) appear to reject the null hypothesis for the majority of the cases, in contrary to the TMAR (CTW-BIC) which reject the null hypothesis only for the Rodriguez et al. [10] method. TMAR (LCSS-BIC) and TMAR (PCA-BIC) seem to be statistical significant while TMAR (CTW-BIC) is not.

Finally, we have put our algorithm to test with the UCF YouTube dataset [11]. The UCF YouTube human action data set contains 11 action categories such as basketball shooting, biking, diving, golf swinging, horse riding, soccer juggling, swinging, tennis swinging, trampoline jumping, volleyball spiking, and walking with a dog. This data set includes actions with large variation in camera motion, object appearance and pose and scale. It also contains viewpoint and illumination changes, and spotty background. The video sequences are grouped into 25 groups of at least four actions each for each category, whereas the videos in the same group may share common characteristics such as similar background or actor. Representative frames of this data set are shown in Fig. 9
                     .

In order to assess our method we have used the leave-one-out cross validation scheme. In Fig. 10
                      the confusion matrices for the TMAR (LCSS), TMAR (CTW) and TMAR (PCA) approaches are shown. We achieve a recognition rate of 
                        
                           91.7
                           %
                        
                      when the LCSS metric is employed and having estimated the Gaussian components using the BIC criterion. We also achieve 
                        
                           91.3
                           %
                        
                      when the CTW alignment is employed and 
                        
                           93.2
                           %
                        
                      when using PCA. In Table 7
                     , comparisons with other state-of-the-art methods for this dataset are reported. The results of [11,37,38,51] were copied from the original papers. As it can be seen, our algorithm achieves the highest recognition accuracy amongst all the others.

The performance of the proposed method with respect to the number of the Gaussian components is depicted in Fig. 11
                     . For TMAR (LCSS) the recognition accuracy begins to decrease for 
                        
                           
                              
                                 K
                              
                              
                                 j
                              
                              
                                 p
                              
                           
                           ⩾
                           1
                        
                      and exhibits the worst performance than the other two approaches. The TMAR (CTW) approach decreases for 
                        
                           
                              
                                 K
                              
                              
                                 j
                              
                              
                                 p
                              
                           
                           ⩾
                           2
                        
                      while TMAR (PCA) reaches its peak for 
                        
                           
                              
                                 K
                              
                              
                                 j
                              
                              
                                 p
                              
                           
                           =
                           4
                        
                      and then it begins to decrease. Note that, the best approach tends to be, attained by TMAR (PCA) which reaches a recognition accuracy of 
                        
                           91
                           %
                        
                     .


                     Tables 8 and 9
                     
                      present the same indices for the UCF YouTube dataset. All three proposed methods reject the null hypothesis for all the cases. In this case, the recognition results of the proposed methods for the UCF YouTube dataset appear to be statistically significant.

In the recognition step, in our implementation of the LCSS (7) the parameters 
                        
                           δ
                        
                      and 
                        
                           ∊
                        
                      were optimized using 10-fold cross validation for all three datasets. These parameters need to be determined for each data set separately since each data set perform different types of actions. However, after we have determined the parameters no further action needs to be taken. To classify a new unknown sequence, we have already learned the parameters from the learning step and thus we are able to recognize the new action. For all the datasets, Tables 10–12
                     
                     
                      show the optimal values per action as they have resulted after the cross validation process. Note that, the values in Table 10 for both 
                        
                           δ
                        
                      and 
                        
                           ε
                        
                      are consistently small. However, the handclapping and walking actions have larger values for 
                        
                           ε
                        
                      parameter than the other actions, which may be due to the large vertical movement of the subject between consecutive frames. On the other hand, the actions in the UCF Sport dataset holds large movements from one frame to the other for both horizontal and vertical axes, which is the main reason why the actions show large variances between the values of 
                        
                           δ
                        
                      and 
                        
                           ε
                        
                      (Table 11). Finally, the actions in the UCF YouTube dataset have a uniform distributed representation of the parameters 
                        
                           δ
                        
                      and 
                        
                           ε
                        
                     , since the parameter 
                        
                           δ
                        
                      is determined as the 
                        
                           10
                           %
                        
                      of the mean curves length for the most of the actions and the mean of the parameter 
                        
                           ε
                        
                      is varies in the 
                        
                           15
                           %
                        
                      of the standard deviation of the two curves to be compared.

The average percentage of matched curves for the TMAR (LCSS) and TMAR (CTW) approach in the case where the BIC criterion is employed to determine the number of Gaussian components for all three datasets is depicted in Fig. 12
                     . As it can be observed, the TMAR (LCSS) method appears to match a larger part of curves for the same dataset than the TMAR (CTW) approach, which is the reason why TMAR (LCSS) performs better than TMAR (CTW).

In Fig. 13
                     , the execution times using the BIC criterion are depicted in order to determine the number of the Gaussian components, for all three cases, when using the LCSS metric, the CTW alignment and PCA, for all three datasets. In the KTH dataset, TMAR (CTW) requires the highest execution time (needs nine seconds to recognize two out of six actions) and while TMAR (LCSS) takes less than six seconds for one action. Note that, the use of PCA speeds up the execution time for recognizing a single action in all datasets since feature vectors of smaller lengths are being used. However, in UCF Sport dataset TMAR (LCSS) and TMAR (CTW) both have the same upper bound of eight seconds to recognize an action. Finally, in UCF YouTube dataset, the average execution time to recognize an action ranges from two to nine seconds when TMAR (LCSS) approach is used. In the case where TMAR (PCA) is used the upper bound to recognize an action is five seconds in UCF Sports and UCF YouTube datasets, while in KTH is less than a second. This makes the algorithm capable to adapt to any real video sequence and recognize an action really fast.

@&#CONCLUSION@&#

In this paper, we presented an action recognition approach, where actions are represented by a set of motion curves generated by a probabilistic model. The performance of the extracted motion curves is interpreted by computing similarities between the motion curves, followed by a classification scheme. The large size of motion curves was reduced via PCA and after noise removal a reference database of feature vectors is obtained. Although a perfect recognition performance is accomplished with a fixed number of Gaussian mixtures, there are still some open issues in feature representation.

Our results classifying activities in three publicly available datasets show that the use of PCA has a significant impact on the performance of the recognition process, as its use leads to further improvement of the recognition accuracy, while it significantly speeds up the behavior of the proposed algorithm. The optimal model was determined by using the BIC criterion. Finally, our algorithm is free of any constraints in the curves lengths. Although the proposed method yielded encouraging results in standard action recognition datasets, it is requirement of a challenging task of performing motion detection, background subtraction, and action recognition in natural and cluttered environments.

Supplementary data associated with this article can be found, in the online version, at http://dx.doi.org/10.1016/j.cviu.2013.11.007.


                     
                        
                           
                        
                     
                  

@&#REFERENCES@&#

