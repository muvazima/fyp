@&#MAIN-TITLE@&#The unrooted set covering connected subgraph problem differentiating between HIV envelope sequences

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           An innovative application of operations research to analyse HIV gene sequences.


                        
                        
                           
                           Present a sophisticated integer program to identify connected subgraphs.


                        
                        
                           
                           Demonstrate the effective use of decomposition techniques to reduce runtimes.


                        
                        
                           
                           Construct connected subgraphs that identify key features of HIV gene sequences.


                        
                        
                           
                           Identify key areas of HIV gene sequences for possible vaccine development.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

OR in medicine

HIV Env sequence

Benders’ decomposition

Acceleration techniques

@&#ABSTRACT@&#


               
               
                  This paper presents a novel application of operations research techniques to the analysis of HIV Env gene sequences, aiming to identify key features that are possible vaccine targets. These targets are identified as being critical to the transmission of HIV by being present in early transmitted (founder) sequences and absent in later chronic sequences. Identifying the key features of Env involves two steps: first, calculating the covariance of amino acid combinations and positions to form a network of related and compensatory mutations; and second, developing an integer program to identify the smallest connected subgraph of the constructed covariance network that exhibits a set covering property. The integer program developed for this analysis, labelled the unrooted set covering connected subgraph problem (USCCSP), integrates a set covering problem and connectivity evaluation, the latter formulated as a network flow problem. The resulting integer program is very large and complex, requiring the use of Benders’ decomposition to develop an efficient solution approach. The results will demonstrate the necessity of applying acceleration techniques to the Benders’ decomposition solution approach and the effectiveness of these techniques and heuristic approaches for solving the USCCSP.
               
            

@&#INTRODUCTION@&#

Human immunodeficiency virus (HIV) currently infects approximately 40 million people worldwide and has resulted in over 20 million deaths. Although antiretroviral therapy has reduced mortality and morbidity from this disease in developed countries the large number of new infections each year demonstrates a need for more effective prevention programs. The most effective prevention will be provided by a vaccine, but to date no successful HIV vaccine has been developed. One of the difficulties of developing a vaccine is the high rate of mutation of HIV that results in shifting targets for the immune response. A feature of particular importance is the viral envelope gene Env that codes for the gp160 protein, which is cleaved into the gp120 and gp41 glycoproteins. gp120 buds from the virion surface and is responsible for binding to the CD4 receptor of immune cells, while gp41 is responsible for fusion with the target cell membrane and mediates the resulting infection of the cell.

The most exposed regions of gp120 are susceptible to antibody binding and clearance and hence can be highly variable. An effective vaccine must stimulate the expansion of antibodies to regions of gp120 that are necessary for viable virus and are also amenable to antibody contact. The evolving nature over the course of infection of Env and its glycoproteins gp120 and gp41 is evidence that antibodies against HIV envelope are generated and force the Env gene to mutate to avoid viral clearance. However, antibody development is too slow to inhibit infection of an individual or to eliminate infection once established. A vaccine needs to prime an antibody response to very early stages of HIV. The targets for such a vaccine are currently unclear, but may be elucidated by studying how Env changes from the early (founder) stage of infection to the chronic stage (Gnanakaran et al., 2011). Features in the Env gene that are present in founder viruses but absent in chronic viruses may indicate aspects that are under eventual immune pressure, and are candidates for vaccine targets.

Initial investigations to identify amino acid features of Env between the two virus groups, founder and chronic, followed the approach of Murray et al. (2013), which examined amino acid pairs in the hepatitis C virus (HCV) envelope that distinguished responders to antiviral therapy. The current investigation analyses 266 HIV Env protein sequences, 133 founder and 133 chronic, obtained from a previous study comparing glycosylation sites between founder and chronic individuals (Mota, Murray, Center, Purcell, & McCaw, 2012). Since a total of 266 Env sequences in the current investigation, and in other studies (Abrahams et al., 2009; Keele et al., 2008; Mota et al., 2012), is small in comparison to the 858 amino acids (AA) in HIV Env there can be many positions in the sequences that will express different AA for founders compared to chronics. Hence the underlying state space employed is not the individual AA, but rather covarying pairs of AA that achieve some minimal level of covariance. AA at a pair of positions are said to covary if the AA combinations observed at these positions are sufficiently different from random combinations. For example, considering the AA Phenylalanine (F), Lysine (K), Arginine (R) and Tyrosine (Y) if in 16 sequences at positions 223 and 432 there are 8 FK (F at 223 and K at 432) pairs and 8 YR pairs, then positions 223 and 432 covary since these observed pairs are sufficiently different to the random combinations of 4 FK, 4 FR, 4 YK and 4 YR pairs.

The approach developed by Murray et al. (2013) identifies the fewest AA pairs that express particular amino acid combinations present in one group but not the other. The integer programming formulation and the resulting analysis identifies a set of separating pairs that are usually not connected. While these pairs identify important positions in Env  the lack of connectivity reduces how useful the positions and the identified AA are in the development of a vaccine against HIV. The current analysis attempts to identify a set of covarying pairs that form a connected subgraph. This connected subgraph is desirable for several reasons. First, a number of compensatory mutations will be needed for Env to sufficiently change its structure to evade the immune response, identified by covarying positions. Second, an antibody stimulated by a vaccine will bind to between 5 and 8 AA of its antigen. Finally, a network of target AA may better describe underlying mechanisms by which HIV evades immune system clearance.

In this paper an integer programming model is developed that selects a set of covarying pairs with the following properties. First, the most important features of the sequence are identified. This is defined as the fewest number of pairs that express AA combinations that exist in some founder sequences but in no chronic sequences. Second, the selected covarying pairs and amino acid positions form a connected subnetwork of the original covariance network where feasible. The integer programming problem developed to achieve this is termed the unrooted set covering connected subgraph problem (USCCSP).

@&#LITERATURE REVIEW@&#

The connected subgraph problem describes a broad class of problems to which the USCCSP belongs. This problem class has applications to a variety of different research fields. Such areas of research include wildlife conservation (Conrad, Gomes, van Hoeve, Sabharwal, & Suter, 2012; Dilkina & Gomes, 2010), network design (Álvarez Miranda, Ljubić, & Mutzel, 2013), analysis of protein-protein interactions (Backes et al., 2012; Dittrich, Klau, Rosenwald, Dandekar, & Müller, 2008) and forest harvesting (Carvajal, Constantino, Goycoolea, Vielma, & Weintraub, 2013). This paper represents the first application of this problem class to the analysis of mutational relationships in gene sequences. The fundamental aspect observed in applications of this problem class is the distribution of key features, either essential habitat regions or important covarying AA pairs, across a large network. The wildlife conservation applications attempt to identify contiguous regions that improve the mobility of threatened species between reserves (Conrad et al., 2012; Dilkina & Gomes, 2010) or connect known habitats of a number of different species (Önal & Briers, 2005, 2006; Önal & Wang, 2008). Identifying a connected subnetwork that describes these important features is extremely important to minimise the cost of conservation or, in our case, identify closely related features to aid vaccine development.

As stated previously, the USCCSP is a specific variant of the connected subgraph problem. This variant is distinguished by having no root or terminal nodes specified, implying that the connected subgraph may be found in any region of the underlying network. To the best of the authors knowledge, such a problem formulation has not been explicitly considered in the literature.

A typical example of the connected subgraph problem with multiple fixed terminal nodes is presented by Conrad, Gomes, van Hoeve, Sabharwal, and Suter (2007). The specification of terminal nodes alters the problem formulation by providing a fixed set of vertices that must be included in the resulting subgraph. The solution approach employed by Conrad et al. (2007) involves two key stages, (i) identifying the nodes and edges to include in the subgraph and (ii) checking the graph for connectivity. The latter of these stages is formulated as a network flow problem with a single source and multiple terminal locations. This work is extended by Gomes, van Hoeve, and Sabharwal (2008), enhancing the solution approach with the introduction of a two-phase algorithm. The first phase of the algorithm presented in (Gomes et al., 2008) solves a minimum Steiner tree problem to identify a feasible, but sub-optimal, connected subgraph solution. Given a feasible solution, the second phase then solves a mixed integer program to improve the solution quality.

The conservation reserve network problem considered by Önal and Briers (2005, 2006) and Önal and Wang (2008) is similar to the problem presented in this paper. In particular, the selection of habitat regions is formulated as a set covering problem, without the specification of root or terminal nodes. However, the data used by Önal and Briers (2005, 2006) forces the inclusion of specific habitat sites. This requirement implicitly defines a set of terminal nodes for the resulting connected subgraph. A limitation of the work presented by Önal and Briers (2005, 2006) and Önal and Wang (2008) is the use of a network based upon two dimensional data that is partitioned into a regular square grid. Consequently, there is an upper bound of 8 on the degree of each node, which is significantly smaller than the node degree observed in the underlying graphs considered in this paper. A final limitation of these approaches (Önal & Briers, 2005, 2006; Önal & Wang, 2008) is the requirement that the resulting subgraph forms a spanning tree of the selected sites, preventing the possibility of cycles appearing in the optimal solution.

Connectivity in subgraphs has been evaluated using a variety of different modelling approaches. However, the permissible methods for connectivity evaluation are dependent on whether the subgraph is formed with the selection of nodes or edges. Forming subgraphs by selecting nodes is the most common approach employed, which permits the use of trees to construct connected subgraphs. The property that a tree is a completely connected graph is exploited by Önal and Briers (2005, 2006) and Önal and Wang (2008). In addition, the Steiner tree problem is a very useful and closely related problem, which is employed by Dilkina and Gomes (2010). Alternatively, Gomes et al. (2008), Conrad et al. (2012) and (Dilkina & Gomes, 2010) consider the single and multi-commodity flow problems as a method to impose connectivity constraints. Finally, the properties of node-cut sets are employed by Carvajal et al. (2013) to impose connectivity constraints between two non-adjacent nodes that are selected in the subgraph. The connectivity evaluation approaches presented by Gomes et al. (2008), Conrad et al. (2012), Dilkina and Gomes (2010) and Carvajal et al. (2013) are also permissible for problems forming subgraphs through the selection of edges.

The contributions of this paper are twofold, the analysis of HIV Env sequences and the development of the unrooted set covering connected subgraph problem. The contribution to this application area is the development of a sophisticated integer programming problem to analyse HIV Env in regards to vaccine development. Second, this paper extends the connected subgraph problem class by presenting a general formulation of the unrooted set covering variant. The solution approaches presented in this paper have not been previously considered, and the novel implementation of Benders’ decomposition is a contribution of this paper.

The exposition in this paper is presented with the following structure. Section 2 provides a description of the problem and presents key details related to the application. Section 3 describes the mathematical model for the general form of the USCCSP that is used to solve the problem presented in Section 2. An extension to the USCCSP that provides an alternative analysis of the HIV sequences is also given in Section 3. The application of Benders’ decomposition to solve the connected subgraph problem is described in Section 4, including a description of a trust region approach to accelerate the algorithm convergence. The computational results for the original problem formulation and extensions are presented in Section 5. The conclusions and possible future work are detailed in Section 6.
                  

The USCCSP attempts to identify a set covering of items by selecting edges of a graph, with those edges forming a connected subgraph. As input the problem receives an undirected graph 
                        
                           G
                           =
                           (
                           V
                           ,
                           E
                           )
                        
                      and a set of items Q. Subsets of Q are observed on each edge contained in E. The objective of this problem is to select a subset of edges 
                        
                           
                              E
                              ¯
                           
                           ⊆
                           E
                        
                     ; such that, each item in Q appears on at least one edge contained in 
                        
                           E
                           ¯
                        
                     . This is a set covering problem for the items in Q on graph G. In addition, the resulting subgraph 
                        
                           
                              G
                              ¯
                           
                           =
                           
                              (
                              V
                              
                                 (
                                 
                                    E
                                    ¯
                                 
                                 )
                              
                              ,
                              
                                 E
                                 ¯
                              
                              )
                           
                        
                      must be connected, otherwise a penalty is applied for each additional edge from 
                        
                           
                              E
                              ∖
                           
                           
                              E
                              ¯
                           
                        
                      that is required to form a connected network.

The problem considered in this paper shares characteristics with many classical network problems. First, a minimum spanning tree identifies a subset of edges 
                        
                           E
                           ¯
                        
                      that connects all vertices V. While similar to the USCCSP, the constraints requiring that all vertices are connected and those prohibiting cycles are overly restrictive. Second, the Steiner tree problem aims to find a subset of vertices 
                        
                           V
                           ¯
                        
                      and related edges 
                        
                           E
                           (
                           
                              V
                              ¯
                           
                           )
                        
                      that connect a set of required vertices T. This is closely related to the USCCSP; however, the resulting graph is a tree and the set T must be known a priori. Finally, the maximum weight connected subgraph problem is solved on a graph, with both positive and negative vertex weights, to find 
                        
                           
                              V
                              ¯
                           
                           ⊆
                           V
                        
                      and subsequently 
                        
                           E
                           (
                           
                              V
                              ¯
                           
                           )
                        
                      that form a connected subgraph with a minimum total vertex weight. Both the USCCSP and the maximum weight connected subgraph problem share the connected subgraph objective; however, the former deviates from the latter by solving a set covering problem. As such, the selection of edges to satisfy a set covering problem and connectivity requirements separates the USCCSP from classical connected network problems.

Within the biology context, the solution to the USCCSP identifies the smallest set of covarying AA pairs forming a connected network that express combinations exhibited by the founder viruses but not the chronic. The graph G used to solve this problem is constructed using the following steps. First, a covariance network is constructed from both the founder and chronic sequences using the method presented by Aurora, Donlin, Cannon, Tavis et al. (2009). The approach of (Aurora et al., 2009) is basically a variant of a chi-squared test to determine whether the AA combinations observed at a pair of positions across all sequences differ from what would be observed from random combinations. Covarying pairs are ones that achieve a specified cut-off value. The set Q consists only of the founder sequences, so the AA combinations on each covarying pair that are displayed by any chronic virus must be discarded. The resulting network (G) consists of Env positions (V) and covarying pairs (E) with AA combinations exhibited only by founder sequences (Q). This network is described as the founder sequence separating pairs network, hereafter the separating pairs network.

Methods identifying the smallest set of covarying AA pairs that separate groups of sequences are presented by Murray et al. (2015, 2013). These are formulated purely as set covering problems and hence these networks will not necessarily be connected. The USCCSP extends the minimal separating pairs problem (Murray et al., 2015, 2013) by introducing constraints that enforce the connectivity between the selected pairs.

Two important features of the USCCSP are the graph G and the set of sequences Q. The structure of G depends on the problem application. In regards to the HIV analysis application considered in this paper, two different constructions of G are possible. The different graph constructions lead to alternative problem formulations for the USCCSP. These alternative formulations will be presented in Sections 3.1 and 3.2.

The separating pairs network can be constructed in two different ways: a single edge between each pair of positions, which represents all AA combinations, or with an edge for each observed AA combination. An example of a pair of nodes in the two different graphs is displayed in Fig. 1. The first graph 
                        
                           G
                           =
                           (
                           V
                           ,
                           E
                           )
                        
                      is given by the separating pairs network where the vertices V are given by the set of AA positions observed on at least one separating pair and E is the set of separating pairs, which are denoted by (i, j), where i, j ∈ V. Fig. 1b is an example of the second graph construction. Specifically, for each separating pair (i, j) ∈ E, the set of all observed amino acid combinations (m, n), where AA m is observed at i and n at j, are contained in the set Aij
                     . Extending this definition, the set Bi
                      contains all AA that are observed at position i. The modified graph 
                        
                           G
                           =
                           (
                           V
                           ,
                           
                              E
                              ^
                           
                           )
                        
                      is given by 
                        
                           E
                           ^
                        
                      containing all separating pairs and related amino acid combinations, denoted by (im, jn
                     ) where (i, j) ∈ E and (m, n) ∈ Aij
                     .

The single edge between each pair of positions represents all AA combinations exhibited only by the founder sequences. To formulate the set covering problem, all founder sequences q are contained in the set Q and the binary parameters aijq
                         identify whether q is observed on the separating pair (i, j). The variables xij
                         are defined to equal 1 if separating pair (i, j) is selected, 0 otherwise, at a cost of cij
                        .

The connectivity evaluation is formulated as a network flow problem between each pair of nodes in the solution to the set covering problem. However, the AA positions selected in the set covering solution are unknown a priori. Consequently, a set of source-sink pairs is formed using all pairs of nodes in V. To properly model the connectivity requirements, the set S is defined to contain all source-sink pairs (s, t), s ∈ V, t ∈ Ts
                        , where 
                           
                              
                                 T
                                 s
                              
                              =
                              
                                 {
                                 t
                                 ∈
                                 V
                                 |
                                 t
                                 >
                                 s
                                 }
                              
                           
                        .

The network flow problem requires an additional set of variables for each source-sink pair contained in S. Flow variables are given by 
                           
                              y
                              
                                 i
                                 j
                              
                              
                                 s
                                 t
                              
                           
                         that equal 1 if a selected pair (i, j) is used in the path between source-sink pair (s, t), and 0 otherwise. To enforce connectivity of the set covering solution, a penalty is applied for each non-selected pair required for a unit of flow to pass from s to t. This penalty is applied with the introduction of variables 
                           
                              z
                              
                                 i
                                 j
                              
                              
                                 s
                                 t
                              
                           
                        . Through problem constraints, if 
                           
                              
                                 y
                                 
                                    i
                                    j
                                 
                                 
                                    s
                                    t
                                 
                              
                              =
                              1
                           
                         and 
                           
                              
                                 x
                                 
                                    i
                                    j
                                 
                              
                              =
                              0
                              ,
                           
                         the value of 
                           
                              z
                              
                                 i
                                 j
                              
                              
                                 s
                                 t
                              
                           
                         is 1, otherwise 
                           
                              
                                 z
                                 
                                    i
                                    j
                                 
                                 
                                    s
                                    t
                                 
                              
                              =
                              0
                           
                        . A multiplicative parameter M is applied to the 
                           
                              z
                              
                                 i
                                 j
                              
                              
                                 s
                                 t
                              
                           
                         variables in the objective function to alter the potency of the connectivity evaluation in the USCCSP. There is no guarantee that the original graph G is connected. Hence, it may not be possible for flow to pass between each pair of nodes in the set covering solution. The variables 
                           
                              ϵ
                              j
                              
                                 s
                                 t
                              
                           
                         and 
                           
                              
                                 ϵ
                                 ^
                              
                              j
                              
                                 s
                                 t
                              
                           
                         are introduced to penalise any violation of the flow balance between a pair of nodes, with a cost N in the objective function.
                     

While a network flow problem is formulated for each source-sink pair, it is only necessary to identify a path between nodes s and t if these nodes exist on at least one selected pair. The key features of the connectivity evaluation problem are explained with reference to a small graph presented in Fig. 2. In this example two edges are selected (highlighted in bold), resulting in a subgraph containing four nodes (filled circles). Given this solution to the USCCSP, a unit of flow must pass between each of the four selected nodes. In the model constraints, if 
                           
                              max
                              {
                              
                                 x
                                 
                                    s
                                    i
                                 
                              
                              +
                              
                                 x
                                 
                                    j
                                    t
                                 
                              
                              −
                              1
                              |
                              i
                              ,
                              j
                              ∈
                              V
                              }
                              =
                              1
                           
                         then flow must pass between source-sink pair (s, t). If an (s, t) pair does not satisfy this constraint, because at least one of s or t is not contained in the selected pairs, then the problem minimisation will lead to a zero flow between these nodes. As a result, the cost of passing a unit of flow between the two circled nodes in Fig. 2 is two and the total cost of passing a unit of flow between all selected nodes is eight, since t > s, ∀(s, t) ∈ S.

The mathematical model of the USCCSP is given by,

                           
                              (1)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             minimise
                                             
                                             
                                                ∑
                                                
                                                   (
                                                   i
                                                   ,
                                                   j
                                                   )
                                                   ∈
                                                   E
                                                
                                             
                                             
                                                c
                                                
                                                   i
                                                   j
                                                
                                             
                                             
                                                x
                                                
                                                   i
                                                   j
                                                
                                             
                                             +
                                             M
                                             
                                                ∑
                                                
                                                   (
                                                   s
                                                   ,
                                                   t
                                                   )
                                                   ∈
                                                   S
                                                
                                             
                                             
                                                ∑
                                                
                                                   (
                                                   i
                                                   ,
                                                   j
                                                   )
                                                   ∈
                                                   E
                                                
                                             
                                             
                                                z
                                                
                                                   i
                                                   j
                                                
                                                
                                                   s
                                                   t
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             
                                             +
                                             
                                             N
                                             
                                                ∑
                                                
                                                   (
                                                   s
                                                   ,
                                                   t
                                                   )
                                                   ∈
                                                   S
                                                
                                             
                                             
                                                ∑
                                                
                                                   j
                                                   ∈
                                                   V
                                                   ∖
                                                   {
                                                   s
                                                   ,
                                                   t
                                                   }
                                                
                                             
                                             
                                                (
                                                
                                                   ϵ
                                                   j
                                                   
                                                      s
                                                      t
                                                   
                                                
                                                +
                                                
                                                   
                                                      ϵ
                                                      ^
                                                   
                                                   j
                                                   
                                                      s
                                                      t
                                                   
                                                
                                                )
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (2)
                              
                                 
                                    
                                       
                                          
                                             subject
                                             
                                             to
                                             
                                             
                                                ∑
                                                
                                                   (
                                                   i
                                                   ,
                                                   j
                                                   )
                                                   ∈
                                                   E
                                                
                                             
                                             
                                                a
                                                
                                                   i
                                                   j
                                                   q
                                                
                                             
                                             
                                                x
                                                
                                                   i
                                                   j
                                                
                                             
                                             ≥
                                             1
                                             
                                             ∀
                                             q
                                             ∈
                                             Q
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (3)
                              
                                 
                                    
                                       
                                          
                                             
                                                y
                                                
                                                   i
                                                   j
                                                
                                                
                                                   s
                                                   t
                                                
                                             
                                             −
                                             
                                                x
                                                
                                                   i
                                                   j
                                                
                                             
                                             ≤
                                             
                                                z
                                                
                                                   i
                                                   j
                                                
                                                
                                                   s
                                                   t
                                                
                                             
                                             
                                             
                                             ∀
                                             s
                                             ∈
                                             V
                                             ,
                                             
                                             
                                             ∀
                                             t
                                             ∈
                                             
                                                T
                                                s
                                             
                                             ,
                                             
                                             
                                             ∀
                                             
                                                (
                                                i
                                                ,
                                                j
                                                )
                                             
                                             ∈
                                             E
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (4)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             
                                                ∑
                                                
                                                   
                                                      
                                                         
                                                            i
                                                            ∈
                                                            V
                                                            |
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            (
                                                            i
                                                            ,
                                                            j
                                                            )
                                                            ∈
                                                            E
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                y
                                                
                                                   i
                                                   j
                                                
                                                
                                                   s
                                                   t
                                                
                                             
                                             −
                                             
                                                ∑
                                                
                                                   
                                                      
                                                         
                                                            k
                                                            ∈
                                                            V
                                                            |
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            (
                                                            j
                                                            ,
                                                            k
                                                            )
                                                            ∈
                                                            E
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                y
                                                
                                                   j
                                                   k
                                                
                                                
                                                   s
                                                   t
                                                
                                             
                                             =
                                             
                                                ϵ
                                                j
                                                
                                                   s
                                                   t
                                                
                                             
                                             −
                                             
                                                
                                                   ϵ
                                                   ^
                                                
                                                j
                                                
                                                   s
                                                   t
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             ∀
                                             s
                                             ∈
                                             V
                                             ,
                                             
                                             
                                             ∀
                                             t
                                             ∈
                                             
                                                T
                                                s
                                             
                                             
                                                ,
                                                
                                                
                                                ∀
                                                j
                                                ∈
                                                V
                                                ∖
                                                
                                                   {
                                                   s
                                                   ,
                                                   t
                                                   }
                                                
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (5)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             
                                                ∑
                                                
                                                   
                                                      
                                                         
                                                            k
                                                            ∈
                                                            V
                                                            |
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            (
                                                            s
                                                            ,
                                                            k
                                                            )
                                                            ∈
                                                            E
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                y
                                                
                                                   s
                                                   k
                                                
                                                
                                                   s
                                                   t
                                                
                                             
                                             ≥
                                             
                                                x
                                                
                                                   s
                                                   i
                                                
                                             
                                             +
                                             
                                                x
                                                
                                                   j
                                                   t
                                                
                                             
                                             −
                                             1
                                             
                                             
                                             ∀
                                             s
                                             ∈
                                             V
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             ∀
                                             t
                                             ∈
                                             
                                                T
                                                s
                                             
                                             ,
                                             
                                             
                                             ∀
                                             
                                                (
                                                s
                                                ,
                                                i
                                                )
                                             
                                             ∈
                                             E
                                             ,
                                             
                                             
                                             ∀
                                             
                                                (
                                                j
                                                ,
                                                t
                                                )
                                             
                                             ∈
                                             E
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (6)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             
                                                ∑
                                                
                                                   
                                                      
                                                         
                                                            k
                                                            ∈
                                                            V
                                                            |
                                                            (
                                                            k
                                                            ,
                                                            t
                                                            )
                                                            ∈
                                                            E
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                y
                                                
                                                   k
                                                   t
                                                
                                                
                                                   s
                                                   t
                                                
                                             
                                             ≥
                                             
                                                x
                                                
                                                   s
                                                   i
                                                
                                             
                                             +
                                             
                                                x
                                                
                                                   j
                                                   t
                                                
                                             
                                             −
                                             1
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             ∀
                                             s
                                             ∈
                                             V
                                             ,
                                             
                                             
                                             ∀
                                             t
                                             ∈
                                             
                                                T
                                                s
                                             
                                             ,
                                             
                                             
                                             ∀
                                             
                                                (
                                                s
                                                ,
                                                i
                                                )
                                             
                                             ∈
                                             E
                                             ,
                                             
                                             
                                             ∀
                                             
                                                (
                                                j
                                                ,
                                                t
                                                )
                                             
                                             ∈
                                             E
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (7)
                              
                                 
                                    
                                       
                                          
                                             
                                                x
                                                
                                                   i
                                                   j
                                                
                                             
                                             ∈
                                             
                                                {
                                                0
                                                ,
                                                1
                                                }
                                             
                                             
                                             
                                             ∀
                                             
                                                (
                                                i
                                                ,
                                                j
                                                )
                                             
                                             ∈
                                             E
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (8)
                              
                                 
                                    
                                       
                                          
                                             
                                                y
                                                
                                                   i
                                                   j
                                                
                                                
                                                   s
                                                   t
                                                
                                             
                                             ∈
                                             
                                                {
                                                0
                                                ,
                                                1
                                                }
                                             
                                             
                                             
                                             ∀
                                             s
                                             ∈
                                             V
                                             ,
                                             
                                             
                                             ∀
                                             t
                                             ∈
                                             
                                                T
                                                s
                                             
                                             ,
                                             
                                             
                                             ∀
                                             
                                                (
                                                i
                                                ,
                                                j
                                                )
                                             
                                             ∈
                                             E
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (9)
                              
                                 
                                    
                                       
                                          
                                             
                                                z
                                                
                                                   i
                                                   j
                                                
                                                
                                                   s
                                                   t
                                                
                                             
                                             ∈
                                             
                                                {
                                                0
                                                ,
                                                1
                                                }
                                             
                                             
                                             
                                             ∀
                                             s
                                             ∈
                                             V
                                             ,
                                             
                                             
                                             ∀
                                             t
                                             ∈
                                             
                                                T
                                                s
                                             
                                             ,
                                             
                                             
                                             ∀
                                             
                                                (
                                                i
                                                ,
                                                j
                                                )
                                             
                                             ∈
                                             E
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (10)
                              
                                 
                                    
                                       
                                          
                                             
                                                ϵ
                                                j
                                                
                                                   s
                                                   t
                                                
                                             
                                             ,
                                             
                                                
                                                   ϵ
                                                   ^
                                                
                                                j
                                                
                                                   s
                                                   t
                                                
                                             
                                             ≥
                                             0
                                             
                                             
                                             ∀
                                             s
                                             ∈
                                             V
                                             ,
                                             
                                             
                                             ∀
                                             t
                                             ∈
                                             
                                                T
                                                s
                                             
                                             
                                                ,
                                                
                                                
                                                ∀
                                                j
                                                ∈
                                                V
                                                ∖
                                                
                                                   {
                                                   s
                                                   ,
                                                   t
                                                   }
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The solution of the USCCSP minimises the number of separating pairs required such that each founder sequence in Q is observed on at least one selected edge. Furthermore, this problem minimises the number of additional separating pairs that are required for flow to pass between each selected source-sink pair.

The set covering problem of the USCCSP is described by the first term in objective function (1) and constraints (2). Constraints (2) describe the requirement that each founder sequence q ∈ Q must be observed on at least one selected pair (
                           
                              
                                 x
                                 
                                    i
                                    j
                                 
                              
                              =
                              1
                           
                        ). The connectivity evaluation problem is given by constraints (3)–(6) and the variables 
                           
                              
                                 y
                                 
                                    i
                                    j
                                 
                                 
                                    s
                                    t
                                 
                              
                              ,
                              
                              
                                 z
                                 
                                    i
                                    j
                                 
                                 
                                    s
                                    t
                                 
                              
                              ,
                              
                              
                                 ϵ
                                 
                                    i
                                    j
                                 
                                 
                                    s
                                    t
                                 
                              
                           
                         and 
                           
                              
                                 ϵ
                                 ^
                              
                              
                                 i
                                 j
                              
                              
                                 s
                                 t
                              
                           
                        . Constraints (3) impose a penalty each unselected pair (
                           
                              
                                 x
                                 
                                    i
                                    j
                                 
                              
                              =
                              0
                           
                        ) that is required for a unit of flow to pass between s and t. The flow balance at each node in the connected path between each (s, t) is given by constraints (4). If the flow balance cannot be satisfied, then a penalty of N is applied. Constraints (5) and (6) are used to indicate whether a path with nonzero flow must be found between the source-sink pair (s, t), in which case the flow between s and t must be at least one.

The separating pairs problem investigated in Murray et al. (2015) is much simpler than the USCCSP since the connectivity enforcement constraints are omitted. It consisted of the objective function ∑(i, j) ∈ E
                        
                        cijxij
                         and constraints (2) and (7). The resulting problem is in the form of a classical set covering problem.

It is common to observe numerous AA combinations on each separating pair. This results in a covariance network that exhibits multiple edges per pair of nodes. Identifying particular AA combinations per pair of positions may present more meaningful results than the positions themselves.

Multiple edges between each pair of nodes requires an alternative formulation of the USCCSP, which will be labelled the USCCSP-AA. To model the selection of multiple edges between each pair of nodes, the variables 
                           
                              w
                              
                                 
                                    i
                                    m
                                 
                                 
                                    j
                                    n
                                 
                              
                           
                         are defined to equal one if AA combination (m, n) is selected on edge (i, j) and zero otherwise. In regards to the biology application, the selection of edges is restricted to at most one for each pair of nodes.

By focusing on the specific AA combinations at each pair of positions, it is possible that a mismatch of amino acids at intermediate nodes can occur in the connectivity evaluation. For example, if separating pairs (i, j) and (j, k) are selected with the observed AA combinations (F, R) and (K, Y) respectively, the resulting connected subgraph has an AA mismatch at j. To thoroughly analyse the connected positions of HIV sequences, two formulations of the USCCSP-AA will be presented—one permitting AA mismatches and the other excluding them.

The formulation of the USCCSP-AA permitting AA mismatches employs an identical connectivity evaluation problem as that presented for the USCCSP. Using the notation presented in the previous section the formulation of the USCCSP-AA is given by,

                           
                              (11)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             minimise
                                             
                                             
                                                ∑
                                                
                                                   (
                                                   i
                                                   ,
                                                   j
                                                   )
                                                   ∈
                                                   E
                                                
                                             
                                             
                                                c
                                                
                                                   i
                                                   j
                                                
                                             
                                             
                                                x
                                                
                                                   i
                                                   j
                                                
                                             
                                             +
                                             M
                                             
                                                ∑
                                                
                                                   (
                                                   s
                                                   ,
                                                   t
                                                   )
                                                   ∈
                                                   S
                                                
                                             
                                             
                                                ∑
                                                
                                                   (
                                                   i
                                                   ,
                                                   j
                                                   )
                                                   ∈
                                                   E
                                                
                                             
                                             
                                                z
                                                
                                                   i
                                                   j
                                                
                                                
                                                   s
                                                   t
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             
                                             +
                                             
                                             N
                                             
                                                ∑
                                                
                                                   (
                                                   s
                                                   ,
                                                   t
                                                   )
                                                   ∈
                                                   S
                                                
                                             
                                             
                                                ∑
                                                
                                                   j
                                                   ∈
                                                   V
                                                   ∖
                                                   {
                                                   s
                                                   ,
                                                   t
                                                   }
                                                
                                             
                                             
                                                (
                                                
                                                   ϵ
                                                   j
                                                   
                                                      s
                                                      t
                                                   
                                                
                                                +
                                                
                                                   
                                                      ϵ
                                                      ^
                                                   
                                                   j
                                                   
                                                      s
                                                      t
                                                   
                                                
                                                )
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (12)
                              
                                 
                                    
                                       
                                          
                                             
                                                subject
                                                
                                                to
                                             
                                             
                                             
                                             
                                                constraints
                                                
                                                (
                                                3
                                                )
                                                −
                                                (
                                                10
                                                )
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (13)
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   
                                                      (
                                                      
                                                         i
                                                         m
                                                      
                                                      ,
                                                      
                                                         j
                                                         n
                                                      
                                                      )
                                                   
                                                   ∈
                                                   
                                                      E
                                                      ^
                                                   
                                                
                                             
                                             
                                                a
                                                
                                                   
                                                      i
                                                      m
                                                   
                                                   
                                                      j
                                                      n
                                                   
                                                   q
                                                
                                             
                                             
                                                w
                                                
                                                   
                                                      i
                                                      m
                                                   
                                                   
                                                      j
                                                      n
                                                   
                                                
                                             
                                             ≥
                                             1
                                             
                                             ∀
                                             q
                                             ∈
                                             Q
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (14)
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   
                                                      (
                                                      m
                                                      ,
                                                      n
                                                      )
                                                   
                                                   ∈
                                                   
                                                      A
                                                      
                                                         i
                                                         j
                                                      
                                                   
                                                
                                             
                                             
                                                w
                                                
                                                   
                                                      i
                                                      m
                                                   
                                                   
                                                      j
                                                      n
                                                   
                                                
                                             
                                             =
                                             
                                                x
                                                
                                                   i
                                                   j
                                                
                                             
                                             
                                             ∀
                                             
                                                (
                                                i
                                                ,
                                                j
                                                )
                                             
                                             ∈
                                             E
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (15)
                              
                                 
                                    
                                       
                                          
                                             
                                                w
                                                
                                                   
                                                      i
                                                      m
                                                   
                                                   
                                                      j
                                                      n
                                                   
                                                
                                             
                                             ∈
                                             
                                                {
                                                0
                                                ,
                                                1
                                                }
                                             
                                             
                                             ∀
                                             
                                                (
                                                
                                                   i
                                                   m
                                                
                                                ,
                                                
                                                   j
                                                   n
                                                
                                                )
                                             
                                             ∈
                                             
                                                E
                                                ^
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        The most important difference between the USCCSP and USCCSP-AA is the addition of constraints (14). This set of constraints is required to ensure that at most one AA combination is selected per pair of positions.

The problem formulation excluding AA mismatches, labelled the USCCSP-AA’, requires a modification to the flow balance constraints in the connectivity evaluation problem. Specifically, in constraints (12) all occurrences of E are replaced with 
                           
                              E
                              ^
                           
                         and the variables 
                           
                              y
                              
                                 i
                                 j
                              
                              
                                 s
                                 t
                              
                           
                         and 
                           
                              z
                              
                                 i
                                 j
                              
                              
                                 s
                                 t
                              
                           
                         are replaced by 
                           
                              y
                              
                                 
                                    i
                                    m
                                 
                                 
                                    j
                                    n
                                 
                              
                              
                                 s
                                 t
                              
                           
                         and 
                           
                              z
                              
                                 
                                    i
                                    m
                                 
                                 
                                    j
                                    n
                                 
                              
                              
                                 s
                                 t
                              
                           
                        . Finally, to formulate the USCCSP-AA’ constraints (12) are replaced by,

                           
                              (16)
                              
                                 
                                    
                                       
                                          
                                             
                                                y
                                                
                                                   
                                                      i
                                                      m
                                                   
                                                   
                                                      j
                                                      n
                                                   
                                                
                                                
                                                   s
                                                   t
                                                
                                             
                                             −
                                             
                                                w
                                                
                                                   
                                                      i
                                                      m
                                                   
                                                   
                                                      j
                                                      n
                                                   
                                                
                                             
                                             ≤
                                             
                                                z
                                                
                                                   
                                                      i
                                                      m
                                                   
                                                   
                                                      j
                                                      n
                                                   
                                                
                                                
                                                   s
                                                   t
                                                
                                             
                                             
                                             ∀
                                             s
                                             ∈
                                             V
                                             ,
                                             
                                             ∀
                                             t
                                             ∈
                                             
                                                T
                                                s
                                             
                                             ,
                                             
                                             ∀
                                             
                                                (
                                                
                                                   i
                                                   m
                                                
                                                ,
                                                
                                                   j
                                                   n
                                                
                                                )
                                             
                                             ∈
                                             
                                                E
                                                ^
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (17)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             
                                                ∑
                                                
                                                   
                                                      
                                                         
                                                            i
                                                            ∈
                                                            V
                                                            |
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            (
                                                            i
                                                            ,
                                                            j
                                                            )
                                                            ∈
                                                            E
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                ∑
                                                
                                                   
                                                      
                                                         
                                                            l
                                                            ∈
                                                            
                                                               B
                                                               i
                                                            
                                                            
                                                               |
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               (
                                                               l
                                                               ,
                                                               m
                                                               )
                                                            
                                                            ∈
                                                            
                                                               A
                                                               
                                                                  i
                                                                  j
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                y
                                                
                                                   
                                                      i
                                                      l
                                                   
                                                   
                                                      j
                                                      m
                                                   
                                                
                                                
                                                   s
                                                   t
                                                
                                             
                                             −
                                             
                                                ∑
                                                
                                                   
                                                      
                                                         
                                                            k
                                                            ∈
                                                            V
                                                            |
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            (
                                                            j
                                                            ,
                                                            k
                                                            )
                                                            ∈
                                                            E
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                ∑
                                                
                                                   
                                                      
                                                         
                                                            n
                                                            ∈
                                                            
                                                               B
                                                               k
                                                            
                                                            
                                                               |
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               (
                                                               m
                                                               ,
                                                               n
                                                               )
                                                            
                                                            ∈
                                                            
                                                               A
                                                               
                                                                  j
                                                                  k
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                y
                                                
                                                   
                                                      j
                                                      m
                                                   
                                                   
                                                      k
                                                      n
                                                   
                                                
                                                
                                                   s
                                                   t
                                                
                                             
                                             =
                                             
                                                ϵ
                                                
                                                   j
                                                   m
                                                
                                                
                                                   s
                                                   t
                                                
                                             
                                             −
                                             
                                                
                                                   ϵ
                                                   ^
                                                
                                                
                                                   j
                                                   m
                                                
                                                
                                                   s
                                                   t
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             ∀
                                             s
                                             ∈
                                             V
                                             ,
                                             
                                             ∀
                                             t
                                             ∈
                                             
                                                T
                                                s
                                             
                                             
                                                ,
                                                
                                                ∀
                                                j
                                                ∈
                                                V
                                                ∖
                                                
                                                   {
                                                   s
                                                   ,
                                                   t
                                                   }
                                                
                                                ,
                                                
                                                ∀
                                                m
                                                ∈
                                             
                                             
                                                B
                                                j
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (18)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             
                                                ∑
                                                
                                                   
                                                      
                                                         
                                                            k
                                                            ∈
                                                            V
                                                            |
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            (
                                                            s
                                                            ,
                                                            k
                                                            )
                                                            ∈
                                                            E
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                ∑
                                                
                                                   
                                                      (
                                                      g
                                                      ,
                                                      h
                                                      )
                                                   
                                                   ∈
                                                   
                                                      A
                                                      
                                                         s
                                                         k
                                                      
                                                   
                                                
                                             
                                             
                                                y
                                                
                                                   
                                                      s
                                                      g
                                                   
                                                   
                                                      k
                                                      h
                                                   
                                                
                                                
                                                   s
                                                   t
                                                
                                             
                                             ≥
                                             
                                                w
                                                
                                                   
                                                      s
                                                      m
                                                   
                                                   
                                                      i
                                                      n
                                                   
                                                
                                             
                                             +
                                             
                                                w
                                                
                                                   
                                                      j
                                                      u
                                                   
                                                   
                                                      t
                                                      v
                                                   
                                                
                                             
                                             −
                                             1
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             ∀
                                             s
                                             ∈
                                             V
                                             ,
                                             
                                             ∀
                                             t
                                             ∈
                                             
                                                T
                                                s
                                             
                                             ,
                                             
                                             ∀
                                             
                                                (
                                                
                                                   s
                                                   m
                                                
                                                ,
                                                
                                                   i
                                                   n
                                                
                                                )
                                             
                                             ∈
                                             
                                                E
                                                ^
                                             
                                             ,
                                             
                                             ∀
                                             
                                                (
                                                
                                                   j
                                                   u
                                                
                                                ,
                                                
                                                   t
                                                   v
                                                
                                                )
                                             
                                             ∈
                                             
                                                E
                                                ^
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (19)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             
                                                ∑
                                                
                                                   
                                                      
                                                         
                                                            k
                                                            ∈
                                                            V
                                                            |
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            (
                                                            k
                                                            ,
                                                            t
                                                            )
                                                            ∈
                                                            E
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                ∑
                                                
                                                   
                                                      (
                                                      g
                                                      ,
                                                      h
                                                      )
                                                   
                                                   ∈
                                                   
                                                      A
                                                      
                                                         k
                                                         t
                                                      
                                                   
                                                
                                             
                                             
                                                y
                                                
                                                   
                                                      k
                                                      g
                                                   
                                                   
                                                      t
                                                      h
                                                   
                                                
                                                
                                                   s
                                                   t
                                                
                                             
                                             ≥
                                             
                                                w
                                                
                                                   
                                                      s
                                                      m
                                                   
                                                   
                                                      i
                                                      n
                                                   
                                                
                                             
                                             +
                                             
                                                w
                                                
                                                   
                                                      j
                                                      u
                                                   
                                                   
                                                      t
                                                      v
                                                   
                                                
                                             
                                             −
                                             1
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             ∀
                                             s
                                             ∈
                                             V
                                             ,
                                             
                                             
                                             ∀
                                             t
                                             ∈
                                             
                                                T
                                                s
                                             
                                             ,
                                             
                                             
                                             ∀
                                             
                                                (
                                                
                                                   s
                                                   m
                                                
                                                ,
                                                
                                                   i
                                                   n
                                                
                                                )
                                             
                                             ∈
                                             
                                                E
                                                ^
                                             
                                             ,
                                             
                                             
                                             ∀
                                             
                                                (
                                                
                                                   j
                                                   u
                                                
                                                ,
                                                
                                                   t
                                                   v
                                                
                                                )
                                             
                                             ∈
                                             
                                                E
                                                ^
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (20)
                              
                                 
                                    
                                       
                                          
                                             
                                                x
                                                
                                                   i
                                                   j
                                                
                                             
                                             ∈
                                             
                                                {
                                                0
                                                ,
                                                1
                                                }
                                             
                                             
                                             ∀
                                             
                                                (
                                                i
                                                ,
                                                j
                                                )
                                             
                                             ∈
                                             E
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (21)
                              
                                 
                                    
                                       
                                          
                                             
                                                y
                                                
                                                   
                                                      i
                                                      m
                                                   
                                                   
                                                      j
                                                      n
                                                   
                                                
                                                
                                                   s
                                                   t
                                                
                                             
                                             ∈
                                             
                                                {
                                                0
                                                ,
                                                1
                                                }
                                             
                                             
                                             ∀
                                             s
                                             ∈
                                             V
                                             ,
                                             
                                             
                                             ∀
                                             t
                                             ∈
                                             
                                                T
                                                s
                                             
                                             ,
                                             
                                             
                                             ∀
                                             
                                                (
                                                
                                                   i
                                                   m
                                                
                                                ,
                                                
                                                   j
                                                   n
                                                
                                                )
                                             
                                             ∈
                                             
                                                E
                                                ^
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (22)
                              
                                 
                                    
                                       
                                          
                                             
                                                z
                                                
                                                   
                                                      i
                                                      m
                                                   
                                                   
                                                      j
                                                      n
                                                   
                                                
                                                
                                                   s
                                                   t
                                                
                                             
                                             ∈
                                             
                                                {
                                                0
                                                ,
                                                1
                                                }
                                             
                                             
                                             ∀
                                             s
                                             ∈
                                             V
                                             ,
                                             
                                             
                                             ∀
                                             t
                                             ∈
                                             
                                                T
                                                s
                                             
                                             ,
                                             
                                             
                                             ∀
                                             
                                                (
                                                
                                                   i
                                                   m
                                                
                                                ,
                                                
                                                   j
                                                   n
                                                
                                                )
                                             
                                             ∈
                                             
                                                E
                                                ^
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (23)
                              
                                 
                                    
                                       
                                          
                                             
                                                ϵ
                                                
                                                   j
                                                   m
                                                
                                                
                                                   s
                                                   t
                                                
                                             
                                             ,
                                             
                                                
                                                   ϵ
                                                   ^
                                                
                                                
                                                   j
                                                   m
                                                
                                                
                                                   s
                                                   t
                                                
                                             
                                             ≥
                                             0
                                             
                                             ∀
                                             s
                                             ∈
                                             V
                                             ,
                                             
                                             
                                             ∀
                                             t
                                             ∈
                                             
                                                T
                                                s
                                             
                                             
                                                ,
                                                
                                                
                                                ∀
                                                j
                                                ∈
                                                V
                                                ∖
                                                
                                                   {
                                                   s
                                                   ,
                                                   t
                                                   }
                                                
                                                ,
                                                
                                                
                                                ∀
                                                m
                                                ∈
                                             
                                             
                                                B
                                                j
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        The connectivity evaluation constraints (16)–(19) are modified to model the additional edges per pair of positions in the covariance network. In addition, the flow balance constraints (17) are defined for each AA/position combination to ensure the same AA is observed on all edges incoming and outgoing from each node. Finally, the connectivity infeasibility variables, 
                           
                              
                                 ϵ
                                 
                                    j
                                    m
                                 
                                 
                                    s
                                    t
                                 
                              
                              ,
                              
                                 
                                    ϵ
                                    ^
                                 
                                 
                                    j
                                    m
                                 
                                 
                                    s
                                    t
                                 
                              
                              ,
                           
                         are defined with respect to the additional edges. Consequently, the objective function (11) must be replaced by

                           
                              (24)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             
                                                ∑
                                                
                                                   (
                                                   i
                                                   ,
                                                   j
                                                   )
                                                   ∈
                                                   E
                                                
                                             
                                             
                                                c
                                                
                                                   i
                                                   j
                                                
                                             
                                             
                                                x
                                                
                                                   i
                                                   j
                                                
                                             
                                             +
                                             M
                                             
                                                ∑
                                                
                                                   (
                                                   s
                                                   ,
                                                   t
                                                   )
                                                   ∈
                                                   S
                                                
                                             
                                             
                                                ∑
                                                
                                                   
                                                      (
                                                      
                                                         i
                                                         m
                                                      
                                                      ,
                                                      
                                                         j
                                                         n
                                                      
                                                      )
                                                   
                                                   ∈
                                                   
                                                      E
                                                      ^
                                                   
                                                
                                             
                                             
                                                z
                                                
                                                   
                                                      i
                                                      m
                                                   
                                                   
                                                      j
                                                      n
                                                   
                                                
                                                
                                                   s
                                                   t
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             +
                                             
                                             N
                                             
                                                ∑
                                                
                                                   (
                                                   s
                                                   ,
                                                   t
                                                   )
                                                   ∈
                                                   S
                                                
                                             
                                             
                                                ∑
                                                
                                                   j
                                                   ∈
                                                   V
                                                   ∖
                                                   {
                                                   s
                                                   ,
                                                   t
                                                   }
                                                
                                             
                                             
                                                ∑
                                                
                                                   m
                                                   ∈
                                                   
                                                      B
                                                      j
                                                   
                                                
                                             
                                             
                                                (
                                                
                                                   ϵ
                                                   
                                                      j
                                                      m
                                                   
                                                   
                                                      s
                                                      t
                                                   
                                                
                                                +
                                                
                                                   
                                                      ϵ
                                                      ^
                                                   
                                                   
                                                      j
                                                      m
                                                   
                                                   
                                                      s
                                                      t
                                                   
                                                
                                                )
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

A feature of the problems presented Section 3 is the integration of the set covering and connectivity evaluation problems. While these individual problems can be solved using classical techniques, the integration of the two negatively impacts the problem tractability. Fortunately, the formulations of the USCCSP and USCCSP-AA are particularly suited for the application of Benders’ decomposition. For conciseness and ease of exposition the application of Benders’ decomposition will be described with reference to the USCCSP.

Benders’ decomposition forms a master problem, labelled the BMP, and a series of subproblems to reduce the overall problem complexity. The decomposition of the USCCSP involves formulating a BMP as a set covering problem consisting of variables xij
                      and constraints (2). The subproblems are formulated to evaluate the connectivity of the set cover solution to the BMP, which is provided as a fixed input to the subproblems. In iteration n, the set of solution values for the variables in the BMP is given by 
                        
                           
                              
                                 
                                    x
                                    ¯
                                 
                              
                              n
                           
                           =
                           
                              {
                              
                                 
                                    x
                                    ¯
                                 
                                 
                                    i
                                    j
                                 
                                 n
                              
                              ,
                              
                                 (
                                 i
                                 ,
                                 j
                                 )
                              
                              ∈
                              E
                              }
                           
                        
                     . The solution given by 
                        
                           
                              
                                 x
                                 ¯
                              
                           
                           n
                        
                      describes a set of separating pairs (i, j) that is a set cover of the founder sequences contained in Q. This set of edges forms a subgraph of the original separating pairs network.

An individual subproblem is formed for each source node s ∈ V. This is motivated by the prevalence of computationally efficient algorithms that find the shortest path from a single source to all other nodes. Thus, the primal Benders’ subproblem for source node s, given selected pairs 
                        
                           
                              
                                 
                                    x
                                    ¯
                                 
                              
                              n
                           
                           ,
                        
                      (PBSP-s) is formulated as,

                        
                           (25)
                           
                              
                                 
                                    
                                       
                                          
                                             μ
                                             s
                                          
                                          
                                             (
                                             
                                                
                                                   
                                                      x
                                                      ¯
                                                   
                                                
                                                n
                                             
                                             )
                                          
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          minimise
                                          
                                          M
                                          
                                             ∑
                                             
                                                t
                                                ∈
                                                
                                                   T
                                                   s
                                                
                                             
                                          
                                          
                                             ∑
                                             
                                                (
                                                i
                                                ,
                                                j
                                                )
                                                ∈
                                                E
                                             
                                          
                                          
                                             z
                                             
                                                i
                                                j
                                             
                                             
                                                s
                                                t
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          +
                                          
                                          N
                                          
                                             ∑
                                             
                                                t
                                                ∈
                                                
                                                   T
                                                   s
                                                
                                             
                                          
                                          
                                             ∑
                                             
                                                j
                                                ∈
                                                V
                                                ∖
                                                {
                                                s
                                                ,
                                                t
                                                }
                                             
                                          
                                          
                                             (
                                             
                                                ϵ
                                                j
                                                
                                                   s
                                                   t
                                                
                                             
                                             +
                                             
                                                
                                                   ϵ
                                                   ^
                                                
                                                j
                                                
                                                   s
                                                   t
                                                
                                             
                                             )
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (26)
                           
                              
                                 
                                    
                                       
                                          subject
                                          
                                          to
                                          
                                          
                                             y
                                             
                                                i
                                                j
                                             
                                             
                                                s
                                                t
                                             
                                          
                                          −
                                          
                                             z
                                             
                                                i
                                                j
                                             
                                             
                                                s
                                                t
                                             
                                          
                                          ≤
                                          
                                             
                                                x
                                                ¯
                                             
                                             
                                                i
                                                j
                                             
                                             n
                                          
                                          
                                          
                                          
                                          ∀
                                          t
                                          ∈
                                          
                                             T
                                             s
                                          
                                          ,
                                          
                                          
                                          ∀
                                          
                                             (
                                             i
                                             ,
                                             j
                                             )
                                          
                                          ∈
                                          E
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (27)
                           
                              
                                 
                                    
                                       
                                          
                                             ∑
                                             
                                                
                                                   
                                                      
                                                         i
                                                         ∈
                                                         V
                                                         |
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         (
                                                         i
                                                         ,
                                                         j
                                                         )
                                                         ∈
                                                         E
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             y
                                             
                                                i
                                                j
                                             
                                             
                                                s
                                                t
                                             
                                          
                                          −
                                          
                                             ∑
                                             
                                                
                                                   
                                                      
                                                         k
                                                         ∈
                                                         V
                                                         |
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         (
                                                         j
                                                         ,
                                                         k
                                                         )
                                                         ∈
                                                         E
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             y
                                             
                                                j
                                                k
                                             
                                             
                                                s
                                                t
                                             
                                          
                                          =
                                          
                                             ϵ
                                             j
                                             
                                                s
                                                t
                                             
                                          
                                          −
                                          
                                             
                                                ϵ
                                                ^
                                             
                                             j
                                             
                                                s
                                                t
                                             
                                          
                                          
                                          
                                          ∀
                                          t
                                          ∈
                                          
                                             T
                                             s
                                          
                                          
                                             ,
                                             
                                             
                                             ∀
                                             j
                                             ∈
                                             V
                                             ∖
                                             
                                                {
                                                s
                                                ,
                                                t
                                                }
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (28)
                           
                              
                                 
                                    
                                       
                                          
                                             ∑
                                             
                                                
                                                   
                                                      
                                                         k
                                                         ∈
                                                         V
                                                         |
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         (
                                                         s
                                                         ,
                                                         k
                                                         )
                                                         ∈
                                                         E
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             y
                                             
                                                s
                                                k
                                             
                                             
                                                s
                                                t
                                             
                                          
                                          ≥
                                          
                                             
                                                x
                                                ¯
                                             
                                             
                                                s
                                                i
                                             
                                             n
                                          
                                          +
                                          
                                             
                                                x
                                                ¯
                                             
                                             
                                                j
                                                t
                                             
                                             n
                                          
                                          −
                                          1
                                          
                                          ∀
                                          t
                                          ∈
                                          
                                             T
                                             s
                                          
                                          ,
                                          
                                          
                                          ∀
                                          
                                             (
                                             s
                                             ,
                                             i
                                             )
                                          
                                          ∈
                                          E
                                          ,
                                          
                                          
                                          ∀
                                          
                                             (
                                             j
                                             ,
                                             t
                                             )
                                          
                                          ∈
                                          E
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (29)
                           
                              
                                 
                                    
                                       
                                          
                                             ∑
                                             
                                                
                                                   
                                                      
                                                         k
                                                         ∈
                                                         V
                                                         |
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         (
                                                         k
                                                         ,
                                                         t
                                                         )
                                                         ∈
                                                         E
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             y
                                             
                                                k
                                                t
                                             
                                             
                                                s
                                                t
                                             
                                          
                                          ≥
                                          
                                             
                                                x
                                                ¯
                                             
                                             
                                                s
                                                i
                                             
                                             n
                                          
                                          +
                                          
                                             
                                                x
                                                ¯
                                             
                                             
                                                j
                                                t
                                             
                                             n
                                          
                                          −
                                          1
                                          
                                          ∀
                                          t
                                          ∈
                                          
                                             T
                                             s
                                          
                                          ,
                                          
                                          
                                          ∀
                                          
                                             (
                                             s
                                             ,
                                             i
                                             )
                                          
                                          ∈
                                          E
                                          ,
                                          
                                          
                                          ∀
                                          
                                             (
                                             j
                                             ,
                                             t
                                             )
                                          
                                          ∈
                                          E
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (30)
                           
                              
                                 
                                    
                                       
                                          
                                             y
                                             
                                                i
                                                j
                                             
                                             
                                                s
                                                t
                                             
                                          
                                          ≥
                                          0
                                          ,
                                          
                                          
                                             z
                                             
                                                i
                                                j
                                             
                                             
                                                s
                                                t
                                             
                                          
                                          ≥
                                          0
                                          
                                          ∀
                                          t
                                          ∈
                                          
                                             T
                                             s
                                          
                                          ,
                                          
                                          ∀
                                          
                                             (
                                             i
                                             ,
                                             j
                                             )
                                          
                                          ∈
                                          E
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (31)
                           
                              
                                 
                                    
                                       
                                          
                                             ϵ
                                             j
                                             
                                                s
                                                t
                                             
                                          
                                          ,
                                          
                                             
                                                ϵ
                                                ^
                                             
                                             j
                                             
                                                s
                                                t
                                             
                                          
                                          ≥
                                          0
                                          
                                          ∀
                                          t
                                          ∈
                                          
                                             T
                                             s
                                          
                                          
                                             ,
                                             
                                             
                                             ∀
                                             j
                                             ∈
                                             V
                                             ∖
                                             
                                                {
                                                s
                                                ,
                                                t
                                                }
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     The connectivity evaluation problem given by the PBSP-s determines the fewest number of edges where 
                        
                           
                              x
                              
                                 i
                                 j
                              
                           
                           =
                           0
                        
                      that are required to form a path for a unit of flow to pass between s and all t ∈ Ts
                     . While the PBSP-s does not display the classical form of a network flow problem, it is possible to demonstrate the similarities between these two problems by performing a few simple modifications.

The modifications of the PBSP-s rely on defining a fixed amount of flow through the network and using this to set the cost for passing along each edge. Since the paths for each source-sink pair are independent, the PBSP-s is separable by t and an individual network flow problem can be formulated for each (s, t), t ∈ Ts
                     . Section 3 indicates that it is only necessary to identify a path between the source-sink pair (s, t) if there exists 
                        
                           i
                           ,
                           j
                           ∈
                           V
                           ,
                           
                              
                                 x
                                 ¯
                              
                              
                                 s
                                 i
                              
                              n
                           
                           +
                           
                              
                                 x
                                 ¯
                              
                              
                                 j
                                 t
                              
                              n
                           
                           −
                           1
                           >
                           0
                        
                     . This property can be used to determine the amount of flow to pass from s to t. In addition, this is enforced by constraints (28) and (29) and the total amount of flow is given by 
                        
                           
                              ψ
                              
                                 s
                                 t
                              
                           
                           =
                           
                              max
                              
                                 i
                                 ,
                                 j
                                 ∈
                                 V
                              
                           
                           
                              {
                              
                                 
                                    x
                                    ¯
                                 
                                 
                                    s
                                    i
                                 
                                 n
                              
                              +
                              
                                 
                                    x
                                    ¯
                                 
                                 
                                    j
                                    t
                                 
                                 n
                              
                              −
                              1
                              }
                           
                        
                     . Finally, constraints (26) set the cost of pushing ψst
                      amount of flow along edge (i, j).

From the previous observations, a classical network flow problem can be formed. Most importantly, it is possible to eliminate constraints (26) since the cost of pushing ψst
                      amount of flow along edge (i, j) is fixed by the variables 
                        
                           
                              
                                 x
                                 ¯
                              
                           
                           n
                        
                     . Using this fixed amount of flow the variable mapping 
                        
                           
                              z
                              
                                 i
                                 j
                              
                              
                                 s
                                 t
                              
                           
                           =
                           
                              y
                              
                                 i
                                 j
                              
                              
                                 s
                                 t
                              
                           
                           ×
                           max
                           
                              {
                              
                                 ψ
                                 
                                    s
                                    t
                                 
                              
                              −
                              
                                 
                                    x
                                    ¯
                                 
                                 
                                    i
                                    j
                                 
                                 n
                              
                              ,
                              0
                              }
                           
                        
                      can be applied to form the modified problem. Implementing these modifications results in the formulation of a classical network flow problem that can be efficiently solved using a variety of dedicated solution algorithms. Examples of appropriate network flow algorithms are described in Ahuja, Magnanti, and Orlin (1993).

Solving the PBSP-s using a dedicated network flow algorithm significantly improves the efficiency of the Benders’ decomposition solution process. Employing such an algorithm to solve the PBSP-s provides an optimal primal solution; however, no dual solution is readily available. Further, this optimal primal solution is for the modified problem, which needs to be mapped to the original formulation of the PBSP-s in order to generate cuts.

To aid the discussion in this section, the dual variable notation will be provided. The dual variables for the connection enforcement constraints (26) are described by 
                           
                              
                                 
                                    λ
                                 
                                 s
                              
                              =
                              
                                 {
                                 
                                    λ
                                    
                                       i
                                       j
                                    
                                    
                                       s
                                       t
                                    
                                 
                                 ,
                                 ∀
                                 t
                                 ∈
                                 
                                    T
                                    s
                                 
                                 ,
                                 ∀
                                 
                                    (
                                    i
                                    ,
                                    j
                                    )
                                 
                                 ∈
                                 E
                                 }
                              
                           
                        . The dual variables 
                           
                              
                                 
                                    α
                                 
                                 s
                              
                              =
                              
                                 {
                                 
                                    α
                                    j
                                    
                                       s
                                       t
                                    
                                 
                                 ,
                                 ∀
                                 t
                                 ∈
                                 
                                    T
                                    s
                                 
                                 ,
                                 ∀
                                 j
                                 ∈
                                 V
                                 }
                              
                           
                         are defined for the flow balance constraints (27). Finally, the dual variables for the source and sink node enforcement constraints (28) and (29) are given by 
                           
                              
                                 
                                    δ
                                 
                                 s
                              
                              =
                              
                                 {
                                 
                                    δ
                                    
                                       i
                                       j
                                    
                                    
                                       s
                                       t
                                    
                                 
                                 ,
                                 ∀
                                 t
                                 ∈
                                 
                                    T
                                    s
                                 
                                 ,
                                 ∀
                                 
                                    (
                                    s
                                    ,
                                    i
                                    )
                                 
                                 ∈
                                 E
                                 ,
                                 ∀
                                 
                                    (
                                    j
                                    ,
                                    t
                                    )
                                 
                                 ∈
                                 E
                                 }
                              
                           
                         and 
                           
                              
                                 
                                    γ
                                 
                                 s
                              
                              =
                              
                                 {
                                 
                                    γ
                                    
                                       i
                                       j
                                    
                                    
                                       s
                                       t
                                    
                                 
                                 ,
                                 ∀
                                 t
                                 ∈
                                 
                                    T
                                    s
                                 
                                 ,
                                 ∀
                                 
                                    (
                                    s
                                    ,
                                    i
                                    )
                                 
                                 ∈
                                 E
                                 ,
                                 ∀
                                 
                                    (
                                    j
                                    ,
                                    t
                                    )
                                 
                                 ∈
                                 E
                                 }
                              
                           
                         respectively.

An important observation of the PBSP-s is that the flow balance constraints (27) ensure the subproblem is feasible for all solutions 
                           
                              x
                              ¯
                           
                        . Hence, only optimality cuts are generated. A Benders’ optimality cut describes a feasible region extreme point from the dual of the PBSP-s. Since a dedicated solution algorithm is used to identify the optimal primal solution to the PBSP-s, an optimality cut is constructed by examining the reduced costs of the primal variables. There are six variable types in the PBSP-s, 
                           
                              
                                 y
                                 
                                    i
                                    j
                                 
                                 
                                    s
                                    t
                                 
                              
                              ,
                              
                                 y
                                 
                                    s
                                    k
                                 
                                 
                                    s
                                    t
                                 
                              
                              ,
                              
                                 y
                                 
                                    k
                                    t
                                 
                                 
                                    s
                                    t
                                 
                              
                              ,
                              
                                 z
                                 
                                    i
                                    j
                                 
                                 
                                    s
                                    t
                                 
                              
                              ,
                              
                                 ϵ
                                 j
                                 
                                    s
                                    t
                                 
                              
                           
                         and 
                           
                              
                                 
                                    ϵ
                                    ^
                                 
                                 j
                                 
                                    s
                                    t
                                 
                              
                              ,
                           
                         with their respective reduced cost functions given by,

                           
                              (32)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   c
                                                   ¯
                                                
                                                
                                                   i
                                                   j
                                                
                                                
                                                   s
                                                   t
                                                
                                             
                                             =
                                             
                                                α
                                                i
                                                
                                                   s
                                                   t
                                                
                                             
                                             −
                                             
                                                α
                                                j
                                                
                                                   s
                                                   t
                                                
                                             
                                             −
                                             
                                                λ
                                                
                                                   i
                                                   j
                                                
                                                
                                                   s
                                                   t
                                                
                                             
                                             
                                             ∀
                                             
                                                (
                                                i
                                                ,
                                                j
                                                )
                                             
                                             ∈
                                             E
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (33)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   c
                                                   ¯
                                                
                                                
                                                   s
                                                   k
                                                
                                                
                                                   s
                                                   t
                                                
                                             
                                             =
                                             
                                                α
                                                s
                                                
                                                   s
                                                   t
                                                
                                             
                                             −
                                             
                                                α
                                                k
                                                
                                                   s
                                                   t
                                                
                                             
                                             −
                                             
                                                ∑
                                                
                                                   (
                                                   s
                                                   ,
                                                   i
                                                   )
                                                   ∈
                                                   E
                                                
                                             
                                             
                                                ∑
                                                
                                                   (
                                                   j
                                                   ,
                                                   t
                                                   )
                                                   ∈
                                                   E
                                                
                                             
                                             
                                                δ
                                                
                                                   i
                                                   j
                                                
                                                
                                                   s
                                                   t
                                                
                                             
                                             −
                                             
                                                λ
                                                
                                                   s
                                                   k
                                                
                                                
                                                   s
                                                   t
                                                
                                             
                                             
                                             ∀
                                             
                                                (
                                                s
                                                ,
                                                k
                                                )
                                             
                                             ∈
                                             E
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (34)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   c
                                                   ¯
                                                
                                                
                                                   k
                                                   t
                                                
                                                
                                                   s
                                                   t
                                                
                                             
                                             =
                                             
                                                α
                                                k
                                                
                                                   s
                                                   t
                                                
                                             
                                             −
                                             
                                                α
                                                t
                                                
                                                   s
                                                   t
                                                
                                             
                                             −
                                             
                                                ∑
                                                
                                                   (
                                                   s
                                                   ,
                                                   i
                                                   )
                                                   ∈
                                                   E
                                                
                                             
                                             
                                                ∑
                                                
                                                   (
                                                   j
                                                   ,
                                                   t
                                                   )
                                                   ∈
                                                   E
                                                
                                             
                                             
                                                γ
                                                
                                                   i
                                                   j
                                                
                                                
                                                   s
                                                   t
                                                
                                             
                                             −
                                             
                                                λ
                                                
                                                   k
                                                   t
                                                
                                                
                                                   s
                                                   t
                                                
                                             
                                             
                                             ∀
                                             
                                                (
                                                k
                                                ,
                                                t
                                                )
                                             
                                             ∈
                                             E
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (35)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   d
                                                   ¯
                                                
                                                
                                                   i
                                                   j
                                                
                                                
                                                   s
                                                   t
                                                
                                             
                                             =
                                             M
                                             +
                                             
                                                λ
                                                
                                                   i
                                                   j
                                                
                                                
                                                   s
                                                   t
                                                
                                             
                                             
                                             ∀
                                             
                                                (
                                                i
                                                ,
                                                j
                                                )
                                             
                                             ∈
                                             E
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (36)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   e
                                                   ¯
                                                
                                                j
                                                
                                                   s
                                                   t
                                                
                                             
                                             =
                                             N
                                             +
                                             
                                                α
                                                j
                                                
                                                   s
                                                   t
                                                
                                             
                                             
                                                ,
                                                
                                                
                                                ∀
                                                j
                                                ∈
                                                V
                                                ∖
                                                
                                                   {
                                                   s
                                                   ,
                                                   t
                                                   }
                                                
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (37)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   f
                                                   ¯
                                                
                                                j
                                                
                                                   s
                                                   t
                                                
                                             
                                             =
                                             N
                                             −
                                             
                                                α
                                                j
                                                
                                                   s
                                                   t
                                                
                                             
                                             
                                                ,
                                                
                                                
                                                ∀
                                                j
                                                ∈
                                                V
                                                ∖
                                                
                                                   {
                                                   s
                                                   ,
                                                   t
                                                   }
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

For the case that graph G is connected, the solution to the PBSP-s describes a collection of edges (i, j) that form a connected path p for a flow of ψst
                         to pass from source node s to sink node t. Hence, the variables 
                           
                              
                                 y
                                 
                                    i
                                    j
                                 
                                 
                                    s
                                    t
                                 
                              
                              ,
                           
                         where (i, j) ∈ p, are basic, implying that their reduced costs are zero. In addition, the variables 
                           
                              z
                              
                                 i
                                 j
                              
                              
                                 s
                                 t
                              
                           
                         are set to one for each (i, j) ∈ p, if 
                           
                              
                                 
                                    x
                                    ¯
                                 
                                 
                                    i
                                    j
                                 
                              
                              =
                              0
                           
                         and 
                           
                              
                                 y
                                 
                                    i
                                    j
                                 
                                 
                                    s
                                    t
                                 
                              
                              =
                              1
                           
                         and zero otherwise, as given by the mapping described previously. Thus, the construction of a dual solution for the PBSP-s to generate Benders’ cuts is performed using the following process.

The algorithm to construct an optimal dual solution initially sets the values for all dual variables to zero. Since the variables 
                           
                              z
                              
                                 i
                                 j
                              
                              
                                 s
                                 t
                              
                           
                         are basic if 
                           
                              
                                 
                                    x
                                    ¯
                                 
                                 
                                    i
                                    j
                                 
                              
                              =
                              0
                           
                         and 
                           
                              
                                 y
                                 
                                    i
                                    j
                                 
                                 
                                    s
                                    t
                                 
                              
                              =
                              1
                              ,
                           
                         traversing through (i, j) ∈ p, the values of 
                           
                              λ
                              
                                 i
                                 j
                              
                              
                                 s
                                 t
                              
                           
                         are set by the reduced cost function (35). Then considering the source node and the connection (s, k) ∈ p, Eq. (33) states that it is valid to set 
                           
                              
                                 α
                                 k
                                 
                                    s
                                    t
                                 
                              
                              =
                              −
                              
                                 λ
                                 
                                    s
                                    k
                                 
                                 
                                    s
                                    t
                                 
                              
                           
                        . It follows that for every connection (i, j) ∈ p, j ≠ t the related dual variables can be equated using (32), hence 
                           
                              
                                 α
                                 j
                                 
                                    s
                                    t
                                 
                              
                              −
                              
                                 α
                                 i
                                 
                                    s
                                    t
                                 
                              
                              =
                              −
                              
                                 λ
                                 
                                    i
                                    j
                                 
                                 
                                    s
                                    t
                                 
                              
                           
                        . Finally, for the sink node and the connection (k, t) ∈ p, Eq. (34) states that the expression 
                           
                              
                                 ∑
                                 
                                    (
                                    s
                                    ,
                                    i
                                    )
                                    ∈
                                    E
                                 
                              
                              
                                 ∑
                                 
                                    (
                                    j
                                    ,
                                    t
                                    )
                                    ∈
                                    E
                                 
                              
                              
                                 γ
                                 
                                    i
                                    j
                                 
                                 
                                    s
                                    t
                                 
                              
                              −
                              
                                 α
                                 k
                                 
                                    s
                                    t
                                 
                              
                              =
                              −
                              
                                 λ
                                 
                                    k
                                    t
                                 
                                 
                                    s
                                    t
                                 
                              
                           
                         is valid. A solution that satisfies this set of equations is given by setting 
                           
                              
                                 α
                                 k
                                 
                                    s
                                    t
                                 
                              
                              ,
                           
                         for k ≠ t, equal to the sum of 
                           
                              λ
                              
                                 i
                                 j
                              
                              
                                 s
                                 t
                              
                           
                         for all connections (i, j) ∈ p from the source node to k. For 
                           
                              k
                              =
                              t
                              ,
                           
                        
                        
                           
                              
                                 ∑
                                 
                                    (
                                    s
                                    ,
                                    k
                                    )
                                    ∈
                                    E
                                 
                              
                              
                                 ∑
                                 
                                    (
                                    l
                                    ,
                                    t
                                    )
                                    ∈
                                    E
                                 
                              
                              
                                 γ
                                 
                                    k
                                    l
                                 
                                 
                                    s
                                    t
                                 
                              
                           
                         is set to the sum of 
                           
                              λ
                              
                                 i
                                 j
                              
                              
                                 s
                                 t
                              
                           
                         for all connections (i, j) ∈ p. It is permissible to select any l′ ∈ V such that 
                           
                              
                                 γ
                                 
                                    k
                                    
                                       l
                                       ′
                                    
                                 
                                 
                                    s
                                    t
                                 
                              
                              ∈
                              
                                 
                                    γ
                                    s
                                 
                              
                           
                         is positive, provided 
                           
                              
                                 
                                    x
                                    ¯
                                 
                                 
                                    
                                       l
                                       ′
                                    
                                    t
                                 
                              
                              =
                              1
                           
                        .

While an optimal objective value is given by setting the dual variables as described, this does not produce a valid Benders’ cut. The added cut eliminates solutions by transgressing into the feasible region of the original problem. Such cuts will be termed transgressing Benders’ cuts. Including the transgressing cut in the master problem penalises the disconnected source-sink pairs. This causes every possible solution including these source-sink pairs, except if the linking edges in the subproblem optimal path are selected, to be penalised. Hence, the values of 
                           
                              λ
                              
                                 i
                                 j
                              
                              
                                 s
                                 t
                              
                           
                         for all (i, j) where 
                           
                              
                                 
                                    x
                                    ¯
                                 
                                 
                                    i
                                    j
                                 
                              
                              =
                              0
                           
                         must be set to 
                           
                              −
                              M
                           
                         to produce a valid cut.

The above cut generation process does not hold for the case where graph G is not connected and s and t lie in two different connected components. In this situation no path exists between source s and sink t; as such, the only 
                           
                              y
                              
                                 i
                                 j
                              
                              
                                 s
                                 t
                              
                           
                         that may be set to one are those on an edge incident to the source or sink. Specifically, constraints (28) state that there exists exactly one j such that 
                           
                              
                                 y
                                 
                                    s
                                    j
                                 
                                 
                                    s
                                    t
                                 
                              
                              =
                              1
                              ,
                              
                                 (
                                 s
                                 ,
                                 j
                                 )
                              
                              ∈
                              E
                           
                         and similarly constraints (29) ensure exactly one k exists such that 
                           
                              
                                 y
                                 
                                    k
                                    t
                                 
                                 
                                    s
                                    t
                                 
                              
                              =
                              1
                              ,
                              
                                 (
                                 k
                                 ,
                                 t
                                 )
                              
                              ∈
                              E
                           
                        . As a result, 
                           
                              
                                 α
                                 j
                                 
                                    s
                                    t
                                 
                              
                              =
                              −
                              N
                           
                         and 
                           
                              
                                 α
                                 k
                                 
                                    s
                                    t
                                 
                              
                              =
                              N
                              ,
                           
                         as given by Eqs. (36) and (37) respectively. It follows from Eqs. (33) and (34) that 
                           
                              
                                 ∑
                                 
                                    (
                                    s
                                    ,
                                    i
                                    )
                                    ∈
                                    E
                                 
                              
                              
                                 ∑
                                 
                                    (
                                    j
                                    ,
                                    t
                                    )
                                    ∈
                                    E
                                 
                              
                              
                                 δ
                                 
                                    i
                                    j
                                 
                                 
                                    s
                                    t
                                 
                              
                              =
                              
                                 ∑
                                 
                                    (
                                    s
                                    ,
                                    i
                                    )
                                    ∈
                                    E
                                 
                              
                              
                                 ∑
                                 
                                    (
                                    j
                                    ,
                                    t
                                    )
                                    ∈
                                    E
                                 
                              
                              
                                 γ
                                 
                                    i
                                    j
                                 
                                 
                                    s
                                    t
                                 
                              
                              =
                              N
                           
                        . The resulting solution, with all other dual variables set to zero, is an optimal dual solution.

The addition of optimality cuts to the BMP also requires the introduction of the variables φ
                           s
                         for each subproblem s ∈ V. These variables are bounded from below by the added cuts and provide the current lower bound on the objective value of the PBSP-s. The optimality cuts added to the BMP are of the form,

                           
                              (38)
                              
                                 
                                    
                                       
                                          
                                             
                                                φ
                                                s
                                             
                                             ≥
                                             
                                                ∑
                                                
                                                   t
                                                   ∈
                                                   
                                                      T
                                                      s
                                                   
                                                
                                             
                                             
                                                ∑
                                                
                                                   (
                                                   s
                                                   ,
                                                   i
                                                   )
                                                   ∈
                                                   E
                                                
                                             
                                             
                                                ∑
                                                
                                                   (
                                                   j
                                                   ,
                                                   t
                                                   )
                                                   ∈
                                                   E
                                                
                                             
                                             
                                                (
                                                
                                                   δ
                                                   
                                                      i
                                                      j
                                                   
                                                   
                                                      s
                                                      t
                                                   
                                                
                                                +
                                                
                                                   γ
                                                   
                                                      i
                                                      j
                                                   
                                                   
                                                      s
                                                      t
                                                   
                                                
                                                )
                                             
                                             
                                                (
                                                
                                                   x
                                                   
                                                      s
                                                      i
                                                   
                                                
                                                +
                                                
                                                   x
                                                   
                                                      j
                                                      t
                                                   
                                                
                                                −
                                                1
                                                )
                                             
                                             +
                                             
                                                ∑
                                                
                                                   t
                                                   ∈
                                                   
                                                      T
                                                      s
                                                   
                                                
                                             
                                             
                                                ∑
                                                
                                                   (
                                                   i
                                                   ,
                                                   j
                                                   )
                                                   ∈
                                                   E
                                                
                                             
                                             
                                                λ
                                                
                                                   i
                                                   j
                                                
                                                
                                                   s
                                                   t
                                                
                                             
                                             
                                                x
                                                
                                                   i
                                                   j
                                                
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        Cuts are continually added to the BMP until the gap between the upper and lower bounds, given by the solutions to the BMP and PBSP-s, ∀s ∈ S, respectively, reduces to a desired optimality gap.

While a transgressing Benders’ cut is generated by the initial steps of the above algorithm, it is still possible to use this cut to generate upper bound solutions. A given disconnected solution is not eliminated, but penalised by this cut. Computational experience shows that searching in a neighbourhood of a previously found solution for alternative subgraphs can identify sub-optimal solutions, based on the added cuts, that are indeed connected. Applying transgressing cuts requires a method that forces the master problem to search for solutions in a neighbourhood of those found in previous iterations. One such method is to employ a trust region, which is described in Section 4.3. The approach using transgressing cuts and a trust region is a heuristic method that quickly identifies upper bound solutions. The produced solutions are of good quality for the HIV Env analysis application.

The BMP is formulated as a set covering problem with additional cuts to express the evaluation of the subgraph connectivity. The set Ωs
                         is introduced as an index set for the cuts added from the PBSP-s for source node s. Each cut generated from the solution to the PBSP-s is indexed by ω. The BMP is given by,

                           
                              (39)
                              
                                 
                                    
                                       
                                          
                                             minimise
                                             
                                             Φ
                                             =
                                             
                                                ∑
                                                
                                                   (
                                                   i
                                                   ,
                                                   j
                                                   )
                                                   ∈
                                                   E
                                                
                                             
                                             
                                                c
                                                
                                                   i
                                                   j
                                                
                                             
                                             
                                                x
                                                
                                                   i
                                                   j
                                                
                                             
                                             +
                                             
                                                ∑
                                                
                                                   s
                                                   ∈
                                                   V
                                                
                                             
                                             
                                                φ
                                                s
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (40)
                              
                                 
                                    
                                       
                                          
                                             subject
                                             
                                             to
                                             
                                             
                                                ∑
                                                
                                                   (
                                                   i
                                                   ,
                                                   j
                                                   )
                                                   ∈
                                                   E
                                                
                                             
                                             
                                                a
                                                
                                                   i
                                                   j
                                                   q
                                                
                                             
                                             
                                                x
                                                
                                                   i
                                                   j
                                                
                                             
                                             ≥
                                             1
                                             
                                             ∀
                                             q
                                             ∈
                                             Q
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (41)
                              
                                 
                                    
                                       
                                          
                                             φ
                                             s
                                          
                                       
                                       
                                          ≥
                                       
                                       
                                          
                                             
                                                ∑
                                                
                                                   t
                                                   ∈
                                                   
                                                      T
                                                      s
                                                   
                                                
                                             
                                             
                                                ∑
                                                
                                                   (
                                                   s
                                                   ,
                                                   i
                                                   )
                                                   ∈
                                                   E
                                                
                                             
                                             
                                                ∑
                                                
                                                   (
                                                   j
                                                   ,
                                                   t
                                                   )
                                                   ∈
                                                   E
                                                
                                             
                                             
                                                (
                                                
                                                   δ
                                                   
                                                      i
                                                      j
                                                   
                                                   
                                                      ω
                                                      s
                                                      t
                                                   
                                                
                                                +
                                                
                                                   γ
                                                   
                                                      i
                                                      j
                                                   
                                                   
                                                      ω
                                                      s
                                                      t
                                                   
                                                
                                                )
                                             
                                             
                                                (
                                                
                                                   x
                                                   
                                                      s
                                                      i
                                                   
                                                
                                                +
                                                
                                                   x
                                                   
                                                      j
                                                      t
                                                   
                                                
                                                −
                                                1
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             +
                                             
                                             
                                                ∑
                                                
                                                   t
                                                   ∈
                                                   
                                                      T
                                                      s
                                                   
                                                
                                             
                                             
                                                ∑
                                                
                                                   (
                                                   i
                                                   ,
                                                   j
                                                   )
                                                   ∈
                                                   E
                                                
                                             
                                             
                                                λ
                                                
                                                   i
                                                   j
                                                
                                                
                                                   ω
                                                   s
                                                   t
                                                
                                             
                                             
                                                x
                                                
                                                   i
                                                   j
                                                
                                             
                                             
                                             ∀
                                             s
                                             ∈
                                             V
                                             ,
                                             
                                             
                                             ∀
                                             ω
                                             ∈
                                             
                                                Ω
                                                s
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (42)
                              
                                 
                                    
                                       
                                          
                                             
                                                x
                                                
                                                   i
                                                   j
                                                
                                             
                                             ∈
                                             
                                                {
                                                0
                                                ,
                                                1
                                                }
                                             
                                             
                                             ∀
                                             
                                                (
                                                i
                                                ,
                                                j
                                                )
                                             
                                             ∈
                                             E
                                             
                                             
                                                φ
                                                s
                                             
                                             ∈
                                             R
                                             
                                             ∀
                                             s
                                             ∈
                                             S
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The objective value of the BMP in a given iteration provides a lower bound on the optimal solution to the USCCSP. In particular, the values of xij
                         describe the best selection of separating pairs with the smallest “distance” between each of the identified nodes given the current evaluation information from the PBSP-s, ∀s ∈ S. Since the Benders’ decomposition subproblems are always feasible, the solution to the BMP in each iteration is a feasible solution to the original problem.

The application of a trust region restricts the feasible region of the master problem to identify a solution close to that found in the previous iteration. Trust region approaches are employed for Benders’ decomposition to focus the added cuts and improve the convergence of the algorithm. Examples of this approach include the addition of a regularisation term in the objective as presented by Ruszczyński (1986) and the addition of a set of constraints as demonstrated by Linderoth and Wright (2003) and Santoso, Ahmed, Goetschalckx, and Shapiro (2005). While both approaches have been demonstrated to improve the convergence of the solution process, the latter maintains the mixed integer programming structure of the master problem and hence it is more appropriate for the USCCSP and USCCSP-AA.

The constraints added to form the trust region restrict the distance between solutions in consecutive iterations. Using the notation presented at the start of this section, the solution values for the Benders’ decomposition master problem in iteration n is given by 
                           
                              
                                 
                                    x
                                    ¯
                                 
                              
                              n
                           
                        . Given the set of solution values 
                           
                              
                                 
                                    x
                                    ¯
                                 
                              
                              n
                           
                         it is possible to define 
                           
                              
                                 X
                                 n
                              
                              =
                              
                                 {
                                 
                                    (
                                    i
                                    ,
                                    j
                                    )
                                 
                                 |
                                 
                                    
                                       x
                                       ¯
                                    
                                    
                                       i
                                       j
                                    
                                    n
                                 
                                 =
                                 1
                                 }
                              
                           
                         to contain the connections (i, j) related to the active variables. Thus, the implementation of a trust region for the USCCSP involves the addition of the following constraint to the BMP,

                           
                              (43)
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   
                                                      (
                                                      i
                                                      ,
                                                      j
                                                      )
                                                   
                                                   ∉
                                                   
                                                      X
                                                      
                                                         n
                                                         −
                                                         1
                                                      
                                                   
                                                
                                             
                                             
                                                x
                                                
                                                   i
                                                   j
                                                
                                             
                                             +
                                             
                                                ∑
                                                
                                                   
                                                      (
                                                      i
                                                      ,
                                                      j
                                                      )
                                                   
                                                   ∈
                                                   
                                                      X
                                                      
                                                         n
                                                         −
                                                         1
                                                      
                                                   
                                                
                                             
                                             
                                                (
                                                1
                                                −
                                                
                                                   x
                                                   
                                                      i
                                                      j
                                                   
                                                
                                                )
                                             
                                             ≤
                                             Δ
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

There are two different implementations of a trust region that can be employed using constraint (43). The first implementation models Δ as a constant and the second as a variable. Modelling Δ as a constant places a hard limit on the number of changes permitted in each iteration. This approach is implemented by Santoso et al. (2005) where it is stated that by using a fixed value of Δ the convergence of the algorithm is not guaranteed. Hence, it is necessary to increase the value of Δ throughout the solution process such that a non-redundant trust region is maintained. This approach is employed in applying a trust region to solve the USCCSP and USCCSP-AA.

A final consideration of the solution approach is the use of transgressing Benders’ cuts. The use of transgressing cuts results in a heuristic solution approach. The addition of transgressing cuts in conjunction with a trust region approach is useful in identifying upper bound solutions. To avoid the elimination of the optimal solution by the addition of transgressing cuts, all cuts are removed each time an upper bound solution is identified. Additionally, constraints are included in the master problem to exclude all previously found upper bound solutions. Unfortunately this approach does not guarantee the optimal solution will be found. However, the solution elimination constraints and an increasing trust region aids the exploration of other parts of the feasible region to identify alternative and improved upper bound solutions.

The computational experiments aim to demonstrate the ability of the USCCSP and USCCSP-AA to identify connected subgraph solutions. An analysis of the solution approach will be presented, discussing the performance improvements from applying Benders’ decomposition and a trust region approach. Finally, a review of the connected subgraph solutions and their implications for the analysis of HIV Env sequences will be discussed.

The USCCSP and USCCSP-AA is presented in Section 3 with cost and penalty parameters in the objective function. The purpose of the cost parameter cij
                      is to force the minimisation of the selected pairs. This is achieved by setting cij
                      to 1. The penalty parameters, M and N, are included to enforce connectivity between the selected edges. As such, it is necessary to set the parameters M and N to a value sufficiently greater than the expected number of edges selected in the optimal solution. For the presented experiments the parameters are set to 100 and 10,000 respectively. Computational experience indicates that varying the values for these parameters has little effect on the obtained solutions; however, M and N must remain sufficiently greater than cij
                     .

The USCCSP and USCCSP-AA are solved using CPLEX 12.4 interfaced through MATLAB 2014a using 12 cores with 15GigaByte RAM.

The USCCSP is solved to identify a minimum number of covarying pairs forming a completely connected subgraph that separate the founder and chronic HIV Env sequences. Since each pair of positions in the network used to solve the USCCSP is connected by a single edge, the resulting connected subgraph provides a broad analysis of the separating pairs. Two different virus subtypes (clades) are investigated in this paper; as such, two distinct separating pairs networks are constructed.

The data collected for the clade B subtype includes 156 sequences, 78 for both founder and chronic groups. As explained in Section 3, the separating problem of the USCCSP involves selecting covarying pairs that cover the complete set of founder sequences. As such, 78 sequences are contained in the set Q and the resulting separating pairs network consists of 259 nodes and 2495 edges. There are significantly more edges than nodes in the covariance network, resulting in a high degree at each node, which is shown in Fig. 3a. 
                        Fig. 3a demonstrates that a large number of nodes have a small degree, but the majority of nodes have a degree greater than 10. The mean degree for the nodes in the clade B separating pairs network is 19.27 and the median is 15.

For the HIV clade C subtype, the data consists of 55 founder and chronic sequences and hence 
                           
                              |
                              Q
                              |
                              =
                              55
                           
                        . The clade C separating pairs network consists of 257 nodes and 3021 edges. Fig. 3b presents similar node degree results for this separating pairs network, with the same median degree of 15, but a higher mean degree of 23.51.

The formulation of the USCCSP using the clade B separating pairs network consists of 167 million variables and 104 million constraints. The vast majority of the variables and constraints are related to the connectivity evaluation. The large number of variables and constraints is a motivation for employing decomposition techniques to improve the problem tractability.
                        


                           Table 1 presents the runtime results from solving the separating pairs set covering problem and the USCCSP using a standard Benders’ decomposition implementation with full cuts and employing a trust region using transgressing cuts for clade B. The solution to the set covering problem provides a lower bound on the USCCSP, which is reported as consisting of 6 separating pairs. The total runtime for this problem is 0.67 seconds. The requirement of identifying a connected subgraph including only the selected separating pairs significantly increases the solution runtime compared to the separating pairs problem of Murray et al. (2015). The standard implementation of Benders’ decomposition is unable to solve the USCCSP within 3600 seconds (1 hour). During the solution process, this implementation establishes a lower bound of 7 separating pairs in 1832.32 seconds, but this set of pairs is not connected. Comparatively, the trust region method establishes an upper bound of 7 separating pairs forming a connected subgraph in 54.36 seconds. Unfortunately, since the trust region approach is a heuristic it is not possible to prove the optimality of this solution. This demonstrates the ability of the trust region approach to identify upper bounds quickly and the difficulty in achieving a good lower bound.

While fewer clade C sequences were collected to construct the separating pairs network compared to clade B, the number of variables and constraints are greater with 198 million and 126 million respectively. This increase in problem size is the direct result of a larger number of edges in the separating pairs network and suggests that the many positions in the clade C virus subtype experience related mutations.

The runtime results for solving the set covering problem and the USCCSP for the clade C separating pairs network are also presented in Table 1. While the runtime results presented for clade C are much shorter than for clade B, the comparitive results are similar. In particular, there is a significant difference in the runtime to solve the set covering problem and the USCCSP. Further, the improvement in the solution runtime from employing the trust region method is also observed. The set covering problem, which involves solving the BMP without any added cuts, is solved to optimality in approximately 0.06 seconds and identifies 3 separating pairs. By contrast, the standard implementation of Benders’ decomposition to solve the USCCSP finds the optimal separating pairs connected subgraph solution of 4 pairs in 14.54 seconds. This increased runtime is to be expected, since the complexity of the USCCSP is negatively affected by the inclusion of the connectivity constraints.

While the standard implementation of Benders’ decomposition solves the USCCSP in very short runtimes, the results for the clade C separating pairs network still demonstrate the strength of the trust region method. By implementing the trust region for this problem, the first upper bound solution found contains 4 separating pair, which is found after approximately 5.53 seconds. This represents a significant reduction in the solution runtime for the USCCSP. However, the magnitude of this result should not be extrapolated to problems using different networks.
                           
                        


                           Fig. 4 presents the separating pairs and connected subgraph solutions for clades B and C. The solutions presented in this figure are the best found solutions from the experiments performed in Sections 5.1.1 and 5.1.2.

The separating pairs problem and the USCCSP identify graphs containing 6 and 8 edges respectively, which are displayed in Fig. 4a. This figure demonstrates the lack of connectivity between the pairs after solving the separating pairs problem of Murray et al. (2013). By comparison, the solutions to the USCCSP identifies a connected subgraph of the separating pairs network. Given the different problem definitions, it is unlikely that pairs will be common between the solutions to the separating pairs and connected subgraph problems, which is demonstrated in Fig. 4a. However, there are five nodes common between the two figures (336, 347, 413, 621, 677), highlighted in black. It is interesting to observe that these three nodes form a connected subgraph in the solution to the USCCSP.

Optimal solutions for the separating pairs problem and the USCCSP for clade C are presented in Fig. 4b. The separating pairs solution consists of three pairs, with two pairs connected through node 360. By contrast, the connected subgraph requires four pairs. Similar to the clade B solution, three nodes are common between the two graphs but there are no common separating pairs. Interestingly, it is possible to form an optimal connected subgraph from the separating pairs solution by including edge (336, 620). This suggests the existence of multiple optimal solutions to the separating pairs problem and the USCCSP. In a separating pairs network consisting of 3021 edges, it is likely there exists many subgraphs that solve the USCCSP to optimality.

The USCCSP-AA involves selecting a set of separating pairs with only a single AA combination per pair. This problem formulation involves a different network construction compared to that used for the USCCSP. In particular, each of the amino acid combinations observed on a pair of positions must be represented by an edge. This graph construction contains the same number of nodes as the original network, but there is a large increase in the number of edges. Specifically, the number of edges in the multiple amino acid clade B separating pairs network is 12,624 and for clade C there are a total of 15,663 edges. This is a significant increase in comparison to the original networks containing 2495 and 3021 edges in the clade B and clade C networks respectively. The increase in the number of edges results in a much larger integer program.

It is observed in the computational experiments that the trust region identifies upper bounds very quickly, but very little improvement in the lower bound is achieved. As such, it is only possible to employ Benders’ decomposition as an upper bounding heuristic. However, this heuristic approach still provides meaningful information in the pursuit of identifying a small set of important, connected features that separate founder and chronic sequences.

The USCCSP-AA is presented in Section 3.2 with two alternative formulations—permitting and excluding AA mismatches at positions in the subgraph solution. These two formulations are developed with alternative biological interpretations of the connected subgraph. However, the problem complexity is greatly increased by excluding AA mismatches. This is a consequence of identifying each AA combination per pair in the Benders’ decomposition subproblem. As such, the added cuts are not as effective, which negatively affects the algorithms rate of convergence.
                        


                           Fig. 5 presents the best found upper bounds for the two alternative formulations and the runtime to achieve this. A maximum runtime of 18,000 seconds (5 hours) is used for these experiments. The upper bounds solutions are found by using a trust region approach and applying transgressing cuts. Five different network constructions are used to evaluate the convergence of the algorithm. These are labelled by a value k that the network is constructed by retaining edges where at least k founder sequences are observed. Fig. 5 presents experiments where k ∈ {0, 2, 3, 4, 5}–the full separating pairs network is given by 
                              
                                 k
                                 =
                                 0
                              
                           . The results suggest an increased complexity when solving the USCCSP-AA by excluding AA mismatches. For both clades, the USCCSP-AA’ is unable to identify upper bound connected subgraph solutions for the two largest network constructions. Surprisingly, neither of the problem formulations dominate the runtime to achieve the best upper bound solutions. This is a feature of the trust region approach using transgressing cuts where the upper bound solutions are dependent on previously found solutions.

Small differences are observed in the connected subgraph solutions to the two USCCSP-AA formulations. As presented in Fig. 5, the total number of pairs in the upper bound solution is much greater when AA mismatches are excluded. However, there are many AA positions and pairs common between the solutions. Specifically, 44.92% and 41.43% of all positions and edges are observed in both solutions. Some pairs are more commonly observed than others, for example 750–836 is observed in the upper bound solutions for both formulations with networks constructed for clade B using a minimum of 3, 4 or 5 sequences. There are no pairs observed in all clade C solutions, which suggests a higher variability in the mutations. Given the similarities in the solutions between the two formulations the following results will focus primarily the USCCSP-AA with mismatches permitted.

The application of a trust region aids the identification of upper bound solutions. While this is useful from a practical, application perspective, there is no guarantee of optimality. A lower bound solution is given by solving the USCCSP-AA without the trust region and applying full Benders’ cuts, as described in Section 4.1.

The improvement in the upper (black) and lower (grey) bound for the USCCSP-AA is displayed in Fig. 6. In this figure, the labels “At least k seq” indicates the minimum number of sequences in the network construction. The maximum solution runtime for the USCCSP-AA is set to 18,000 seconds. Since no further bound improvements are observed after 1000 seconds for all experiments the time axes in Fig. 6 are truncated to improve the presentation.


                           Fig. 6 demonstrates that for all experiments the upper bound is improved very quickly. This illustrates the ability of the trust region approach to identify upper bound solutions in very short runtimes. It is expected that the number of pairs in the upper bound solutions will increase with the minimum number of observed sequences per edge. However, the networks constructed with a minimum of 2 or 3 sequences both achieve better upper bounds than that for the full network. This is also true for the clade C network with the best upper bound achieved with a minimum of 2 sequences per edge. This can be explained as a feature of the trust region approach, where identified upper bound solutions depend on the previously found solutions.
                           
                        

In comparison to the upper bound, very few improvements in the lower bound are achieved. In Fig. 6, the lower bound increases by at most 2 pairs across all experiments. Surprisingly, the last improvement in the lower bound is achieved after 233.37 and 107.48 seconds for clade B and C respectively. This suggests that the full Benders’ cut described in Section 4.1 is ineffective for this problem formulation. As such, the use of alternative Benders’ decomposition acceleration techniques, such as applying Pareto optimal cuts, may be useful for improving the algorithm convergence.

Comparing the upper and lower bound solutions, it is clear that a large optimality gap exists for the identified connected subgraphs. This gap appears to be much larger for the clade B networks, compared to that presented for clade C. As such, it is possible that smaller connected subgraph solutions exist for the given covariance networks. While the smaller solutions may exist, the identified upper bound solutions are useful for identifying important features of HIV Env.

The efficacy of Benders’ decomposition to identify optimal solutions is impacted by the structure of the USCCSP-AA. This is particularly evident in the results presented in Sections 5.2.1 and 5.2.2, where the optimal solution is not found even with different network constructions. Another network construction method that reduces the size of the graph is to vary the covariance cut-off value. The experiments conducted in the previous sections solve the USCCSP-AA on a network constructed using a cut-off value of 0.5. This value is employed by Aurora et al. (2009) in constructing covariance networks to analyse hepatitis C virus. A higher cut-off value reduces the number of edges in the resulting network, which is demonstrated in Table 2.
                        

The upper and lower bounds achieve for clade B and C using the different cut-off values is presented in Fig. 7. The upper bounds are given by the bars and the lower bound are presented by the lines at the top of each bar. It is observed that as the cut-off value increases, so does the size of the connected subgraph upper bound solution. This is explained by the elimination of edges reducing the connectivity of the covariance network. Hence, it is less likely to identify edges satisfying the set covering solution in the same region of the graph. Similar to results in Sections 5.2.1 and 5.2.2, there appears to be little correlation between the time required to identify the best upper bound solution and the size of the covariance network. For example, it is observed in Fig. 7b the shortest time to find the best upper bound is when a cut-off of 1.3 is used, while the longest is with a cut-off of 1.1. Finally, there appears to be a consistent absolute gap between the upper and lower bound solutions across all experiments in Fig. 7. This emphasises the need for improved cut generation to aid the convergence of the solution approach.

The difficulty in the convergence of the algorithm can be explained by the large number of set covering solutions. Using a cut-off value of 1.3, on average each sequence is observed on 13.87 and 34.35 edges of the clade B and C covariance networks respectively. The prevalence of sequences throughout the network suggests that there are an enormous number of set covering solutions. As such, many Benders’ cuts are required to cut off disconnected solutions and improve the lower bound. For comparison, using a cut-off value of 0.5 to construct the covariance networks, for clade B and C each sequence is observed on an average of 222.11 and 374.8 edges. Hence, the ability of the presented solution algorithm to identify good upper bound solution is valuable for large scale instances of the unrooted set covering connected subgraph problem.


                           Fig. 6 presents five experiments performed for each clade using different settings for the network reduction. Each of these experiments provide an upper bound solution as a connected subgraph of separating pairs.

Three of the clade B connected subgraph solutions for the experiments presented in Fig. 6a are shown in Fig. 8. The best found upper bound solution is given by the network constructed with a minimum of 2 sequences exhibited per edge, shown in Fig. 8b. The nodes of particular interest are 236, 347, 750 and 836, which are observed in all upper bounding networks generated for the clade B separating pairs network. In Fig. 8 these nodes are highlighted in black. Interestingly, the commonly observed pairs of 347, 750 and 836 are connected in all subgraphs presented in Fig. 8, while node 236 is disconnected. This suggests a particular importance of positions 347, 750 and 836 and the related separating pairs. Expanding the analysis of the commonly selected nodes, the nodes that appear in at least four of the generated networks are highlighted with dark grey. Three grey highlighted nodes of interest are 239, 535 and 640. A similar relationship between the black and grey nodes is observed in Fig. 8a and c. This is given by a direct connection between 347 and 640 in both. Also, there is a much stronger relationship observed in Fig. 8b where all black and grey nodes are exhibited. If node 232 is also considered, then the black and grey nodes form a smaller connected subgraph solution. All of the identified features of the separating pairs connected subgraphs potentially point to other important features of the clade B HIV sequence.

The separating pairs subgraph solutions identified for the clade C separating pairs network are presented in Fig. 9
                           . The degree of many of the nodes in the subgraphs is high, indicating the importance of particular AA positions. Surprisingly, there is no node selected in all of the subgraph solutions for the clade C separating pairs network. This has two alternative explanations, (i) a more diverse range of mutations occur in the clade C Env sequence compared to clade B, or (ii) there is no single position of high importance to the structure of the clade C virus. There are, however, five nodes – 161, 393, 624, 832 and 833 – that are selected in three of the four experiments. In Fig. 9 these nodes are highlighted with dark grey, with at least three observed in each of the subgraphs in Fig. 9. The connectivity between the grey nodes and the degree of these nodes identifies some interesting structures. First, positions 161 and 624 are directly connected in Fig. 9b and c, with both having a degree of five in the latter. Further, the grey nodes appear to define a core structure of the subgraphs, particularly in Fig. 9a. This structure is interesting given the many branches stemming from it. Further review of these positions may identify important structures related to the transmission of the clade C virus.

@&#CONCLUSIONS@&#

This paper presents a novel application of operations research to the analysis of HIV Env sequences. The analysis attempts to construct a connected subgraph of covarying amino acid positions to identify key features related to the transmission of the virus. Two different mathematical models are presented, the second providing a more detailed view of the HIV Env sequences and related separating pairs networks. A critical feature of this analysis is the connectivity requirement between the selected covarying pairs. This requirement is modelled using a network flow problem, which is at the expense of producing very large problem formulations. The complexity of the resulting problem formulation is addressed by employing Benders’ decomposition, along with enhancement techniques, to efficiently solve the USCCSP and reduce runtimes for the USCCSP-AA.

The results demonstrate the general performance of the Benders’ decomposition solution approach to solve the USCCSP and USCCSP-AA. The models presented in this paper may be applied to any application requiring the construction of a set covering connected subgraph, in particular those without any specified terminal or root nodes. As such, these results aim to demonstrate the general performance of the developed solution approach.

This paper discusses the implication of identifying connected subgraphs in comparison to the set covering problem of Murray et al. (2013) and the different results achieved using various enhancement techniques. It is demonstrated that the solution to the USCCSP and USCCSP-AA may identify important features for further research in the operations research and microbiology context.

There are two key areas for further research regarding the work presented in this paper. In the operations research context, identifying other application areas that require the construction of a set covering connected subgraph would aid the further development of the presented approaches. In addition, the results present the use of Benders’ decomposition as a heuristic approach to identify good upper bounds to the USCCSP-AA. This presents an area of further research to identify approaches that improve the solution process for the USCCSP-AA: Either through enhancements of the Benders’ decomposition approach or the development of alternative techniques. Finally, the separating pairs connected subgraph results attempt to identify key features of the HIV Env sequence as possible vaccine targets. Further analysis of these connected subgraphs may yield more important features to aid the development of a vaccine preventing the transmission of HIV.

@&#ACKNOWLEDGEMENTS@&#

The authors thank the referees for their helpful suggestions, which improved the presentation of this manuscript. We thank Damian Purcell and Talia Mota for collecting and supplying the HIV sequence data. This research includes computations using the Linux computational cluster Katana supported by the Faculty of Science, UNSW Australia.

@&#REFERENCES@&#

