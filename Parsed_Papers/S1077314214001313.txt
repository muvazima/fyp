@&#MAIN-TITLE@&#Hierarchical Bayesian models for unsupervised scene understanding

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Two novel hierarchical models for unsupervised scene understanding are presented.


                        
                        
                           
                           We investigate hierarchical structures for modelling context within our models.


                        
                        
                           
                           These models are compared against unsupervised, weakly and fully supervised models.


                        
                        
                           
                           Our new models are competitive with the supervised models for scene recognition.


                        
                        
                           
                           We also show the models operating on a large underwater dataset collected by a robot.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Scene understanding

Unsupervised learning

Clustering

Hierarchical Bayesian models

Topic models

Variational Bayes

@&#ABSTRACT@&#


               
               
                  For very large datasets with more than a few classes, producing ground-truth data can represent a substantial, and potentially expensive, human effort. This is particularly evident when the datasets have been collected for a particular purpose, e.g. scientific inquiry, or by autonomous agents in novel and inaccessible environments. In these situations there is scope for the use of unsupervised approaches that can model collections of images and automatically summarise their content. To this end, we present novel hierarchical Bayesian models for image clustering, image segment clustering, and unsupervised scene understanding. The purpose of this investigation is to highlight and compare hierarchical structures for modelling context within images based on visual data alone. We also compare the unsupervised models with state-of-the-art supervised and weakly supervised models for image understanding. We show that some of the unsupervised models are competitive with the supervised and weakly supervised models on standard datasets. Finally, we demonstrate these unsupervised models working on a large dataset containing more than one hundred thousand images of the sea floor collected by a robot.
               
            

@&#INTRODUCTION@&#

In many real-world applications involving the collection of visual data, obtaining ground truth from a human expert can be very costly or even infeasible. For example, remote autonomous agents operating in novel environments like extra-planetary rovers and autonomous underwater vehicles (AUVs) are very effective at collecting huge quantities of visual data. Sending all of this data back to human operators quickly is hard since communication is usually bandwidth limited. In these situations it may be desirable to have algorithms operating on these vehicles that can summarise the data in unsupervised but semantically meaningful ways.

Similarly, many scientific datasets may contain terabytes of visual data that require expert knowledge to label it in a manner which is suitable for scientific inference. Obtaining such knowledge for large datasets can be a large drain on research resources. Again, it would be desirable to have algorithms that can separate this data automatically and in semantically meaningful ways, so the attention of the domain experts can be focused on subsets of the visual data for further labelling. In Section 6 we present a large visual dataset collected by an AUV that exhibits exactly this problem.

Recently there has been much focus on the computer vision problem of scene understanding, whereby multiple sources of information and various contextual relationships are used to create holistic scene models. Typically the aim in scene understanding is to improve scene recognition tasks while taking advantage of scene labels or annotations [1–4], accompanying caption or body text [5], or even contextual relationships between image labels and low-level visual features [6,7]. Most of these approaches are weakly supervised, semi-supervised or supervised in nature, and not much attention has been given to fully unsupervised, visual-data only holistic scene understanding.

In this article we wish to explore how unsupervised, or visual-data only, techniques can be applied to the problem of scene understanding. To this end we experiment with well established unsupervised models for clustering, such as Bayesian mixture models [8] and latent Dirichlet allocation [9]. These models cluster coarse whole-image descriptors, or cluster individual parts of images (but not simultaneously). We also explore models that can cluster data on multiple levels simultaneously (e.g. image segments or parts, and images), which are similar to the models presented in [4,10]. These models discover the relationships between objects in images, and then define scene types as distributions of these objects. Also, by knowing the scene type, contextual information is used to aid in finding objects within scenes. Finally we present a new model that can cluster multiple sources of visual information, such as segment and image descriptors. This model takes advantage of holistic image descriptors, which may encode spatial layout, as well as modelling scene types as distributions of objects.

All of these models are compared on standard computer vision datasets as well as a large AUV dataset for scene and object discovery. Emphasis is placed on scene category discovery, since we compare these unsupervised methods to state-of-the-art weakly-, semi- and supervised techniques for scene understanding. We also compare these models for object discovery in two of the experiments.

In the next section we review the most relevant literature to place this work in context. We then present the hierarchical Bayesian models we use for unsupervised scene understanding in Section 3 and in Section 4 we present variational Bayes algorithms for learning these models. In Section 5 we describe the image and image-segment descriptors we use, since these play a large part in the performance of these purely visual-data driven models. Then in Section 6 we empirically compare all of the aforementioned models, and summarise our results in Section 7.

Visual context, such as the spatial structure of images, and position and co-occurrence of objects within scenes provide semantic information that aids object and scene recognition in our visual cortex [11,12]. Similarly, semantic information about images can be derived from the volumes of textual data that accompanies these images in the form of tags, captions and paragraph text on the Internet. Consequently, there has recently been a lot of research focusing on holistic image “understanding”, where these sources of information are fused in order to improve scene and object recognition tasks.

An early attempt at combining annotation information with scene modelling proposed in [1] extends latent Dirichlet allocation (LDA) [9] to use both visual and textual data for inferring image tags in untagged images. This is essentially a “weak” form of supervision, where the exact image classes are unknown, but some semantically relevant information is still used in training the model. Subsequent research, [2–4,13–15] (amongst others) present hierarchical Bayesian models that can simultaneously classify scenes and recognise objects. These models can be supervised at the scene level, object level, or both. They can also use “weak” labels, or annotations, at the image or object levels [2–4]. Typically the features used to represent each image in these models are the proportions of super-pixel clusters (objects) contained within the images. The super-pixels are usually described by a combination of bag-of-words (BoW) features, such as quantised SIFT descriptors and quantised attributes like colour, texture and shape.

Li et al. [3] present a hierarchical Bayesian model that has a principled way of dealing with “noisy” or irrelevant object tags. Essentially a trade off is made between the model’s certainty of the distribution of tags that correspond to a visual object class, and the distribution of tags that are irrelevant to the current object class. If an object class has a strong associated posterior distribution over the corresponding tags, a new tag that has low likelihood under this posterior is likely to be declared as irrelevant by an indicator variable. This model can also infer tags for images when they are missing. Quite a different approach to modelling textual and visual information is presented in [5]. They use a kernel canonical correlation analysis model (CCA) that attempts to learn the latent subspace that connects visual features with unaligned text (e.g. web pages with images). They then use this learned subspace for scene classification tasks.

Fei-Fei and Li [16] also present a model where the scene and object levels are classified in the same framework, but are linked through a higher “event” level, such as a particular sporting event. For example, the objects in an image may be a person, skis, etc., and the scene may be of a snowy mountain. Naturally, these are both related to a “skiing” event, which is simultaneously inferred. These higher level contextual relationships were shown to aid image classification. Similarly, it has been found in works such as [17,18] that knowledge of scene-type context can aid object recognition. In [17] the authors use a hidden Markov model (HMM) to classify a scene, and give certain objects a priori more probability of being detected conditioned on the scene type. For example, it is more likely you would find a coffee machine in a kitchen. Similarly, certain objects commonly co-occur, and so detection of one object (street) may be used to aid detection of another object (building), as demonstrated by [19]. They use tree-like models to infer the contextual and spatial relationships of, and between, labelled objects to aid inference in unlabelled test sets. It is worth noting at this juncture that while object discovery can be an important part of scene understanding, emphasis has usually been placed on scene recognition in the scene understanding literature. Object recognition and discovery performance is usually presented in a qualitative fashion. Conversely, scene recognition is not given much attention in the object recognition and discovery literature, which focuses on quantitative measures of recognition and object purity.

Many models for scene understanding explicitly model the spatial layout of scenes [14,15,19,20], or may make use of non-parametric processes or random fields to enforce segment-label contiguity [4,21–24]. In [14] the authors present a supervised model, the context-aware topic model (CA-TM), that is similar to hierarchical Bayesian models like [13], but it also learns the absolute (as opposed to relative) position of objects within a scene type. For example, it learns that sky objects are at the top, and buildings are at the sides, of street scenes, etc. Hence it takes advantage of both scene and spatial context for classification and object recognition. It can be both supervised at the scene and, optionally, at the object level. A model with a similar concept is presented in [20], however their emphasis is on object detection/discovery rather than scene recognition. The models presented in this article do not explicitly model scene spatial layout, however, the image descriptors used encode this information, see Section 5 for details.

Recently [6] combined Beta-process sparse-code dictionary learning, topic modelling and image classification in one generative framework. Essentially this framework models images from the pixel level to scene level. This is quite an impressive feat, and results in a very complex model. This model can also be used for unsupervised image clustering, but not necessarily object detection/segmentation. It can also use image annotations where available. While the classification results are impressive, each iteration of learning (Gibbs sampling) takes on the order of minutes, when it is usually milliseconds or seconds for other models. A similar concept is presented in [7], however they use a Bayesian co-clustering framework to incorporate semantic knowledge from image labels for visual dictionary learning. They can directly relate image features to semantic concepts, and show better performance than [6].

Scene understanding is a very active area of research, however much of the literature is concerned with weakly supervised, semi-supervised (a few strong labels) or supervised approaches to image understanding. Some of the aforementioned models can be used in a fully unsupervised, visual data only setting, though they may operate in a reduced capacity. For instance, the model in [13] loses its ability to perform scene recognition/discovery and reverts to just clustering segments when image labels are not present. Also [4,6] can be used as unsupervised models when no annotation data is available, however they were not rigorously tested in such situations. The only publication, to the authors’ knowledge, that presents a model exclusively designed for unsupervised scene understanding is [25]. This model is also reviewed and used for comparison in this work.

There has been more work on unsupervised object discovery, where scene recognition/discovery is not an important consideration. For instance [26,20] cluster segments from multiple image segmentations in order to find the “purest” instances of objects. Though [20] can also make use of object spatial layout, and labelled categories where available, which is a similar approach taken by [27]. A comprehensive review of clustering models such as K-means and spectral clustering, and topic models such as LDA and non-negative matrix factorisation (NMF) applied to object discovery is provided in [28]. They test these models on single and multiple object per image tasks, and with different BoW feature normalisations. Similarly, there has been much work on unsupervised scene discovery, where typically whole-scene descriptors are used without explicitly modelling image parts [29–31].

From the aforementioned literature it is apparent that performance for scene and object recognition can be greatly increased by taking advantage of joint scene and object contextual cues. However, it is also apparent that not much attention has been given to achieving holistic scene understanding in a completely unsupervised manner. The work presented in this article reviews and introduces various approaches for a more fully-fledged unsupervised scene understanding framework in the absence of any annotations or related textual information.

In this section we present and discuss the structure of a number of hierarchical Bayesian models of increasing complexity that we apply to unsupervised scene understanding tasks. We start with Bayesian Gaussian mixture models (BGMMs) [8,32] and latent Dirichlet allocation [9], but with Gaussian clusters or topics (G-LDA), for scene or segment clustering. We then present two novel models for simultaneous image and segment clustering. The first is the simultaneous clustering model (SCM), which is similar to the models presented in [4,10]. The second is the multiple-source clustering model (MCM) that can cluster both image and segment descriptors.

We will present BGMMs in the context of clustering images, but these models can equally be applied to clustering segments.

Firstly, a BGMM assumes all images in a dataset, 
                           
                              W
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                w
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    I
                                 
                              
                           
                         where 
                           
                              
                                 
                                    w
                                 
                                 
                                    i
                                 
                              
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    
                                       
                                          D
                                       
                                       
                                          im
                                       
                                    
                                 
                              
                           
                        , are drawn from a weighted sum of T Gaussian distributions;
                           
                              (1)
                              
                                 
                                    
                                       w
                                    
                                    
                                       i
                                    
                                 
                                 ∼
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          t
                                          =
                                          1
                                       
                                       
                                          T
                                       
                                    
                                 
                                 
                                    
                                       π
                                    
                                    
                                       t
                                    
                                 
                                 N
                                 
                                    
                                       
                                          
                                             
                                                w
                                             
                                             
                                                i
                                             
                                          
                                          |
                                          
                                             
                                                η
                                             
                                             
                                                t
                                             
                                          
                                          ,
                                          
                                             
                                                Ψ
                                             
                                             
                                                t
                                             
                                             
                                                -
                                                1
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        Here 
                           
                              π
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                π
                                             
                                             
                                                t
                                             
                                          
                                       
                                    
                                 
                                 
                                    t
                                    =
                                    1
                                 
                                 
                                    T
                                 
                              
                           
                         are the mixture weights, where 
                           
                              
                                 
                                    π
                                 
                                 
                                    t
                                 
                              
                              ∈
                              
                                 
                                    
                                       0
                                       ,
                                       1
                                    
                                 
                              
                           
                         and 
                           
                              
                                 
                                    ∑
                                 
                                 
                                    t
                                    =
                                    1
                                 
                                 
                                    T
                                 
                              
                              
                                 
                                    π
                                 
                                 
                                    t
                                 
                              
                              =
                              1
                           
                        . Also, 
                           
                              
                                 
                                    η
                                 
                                 
                                    t
                                 
                              
                           
                         and 
                           
                              
                                 
                                    Ψ
                                 
                                 
                                    t
                                 
                              
                           
                         are the means and inverse covariances (precisions) for each Gaussian cluster respectively.

An auxiliary indicator variable is also introduced, 
                           
                              Y
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                y
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    I
                                 
                              
                           
                         where 
                           
                              
                                 
                                    y
                                 
                                 
                                    i
                                 
                              
                              ∈
                              
                                 
                                    
                                       1
                                       ,
                                       …
                                       ,
                                       T
                                    
                                 
                              
                           
                        , which assigns each observation to a Gaussian component according to the following conditional relationship;
                           
                              (2)
                              
                                 
                                    
                                       w
                                    
                                    
                                       i
                                    
                                 
                                 |
                                 
                                    
                                       y
                                    
                                    
                                       i
                                    
                                 
                                 ∼
                                 
                                    
                                       
                                          ∏
                                       
                                       
                                          t
                                          =
                                          1
                                       
                                       
                                          T
                                       
                                    
                                 
                                 N
                                 
                                    
                                       
                                          
                                             
                                                
                                                   w
                                                
                                                
                                                   i
                                                
                                             
                                             |
                                             
                                                
                                                   η
                                                
                                                
                                                   t
                                                
                                             
                                             ,
                                             
                                                
                                                   Ψ
                                                
                                                
                                                   t
                                                
                                                
                                                   -
                                                   1
                                                
                                             
                                          
                                       
                                    
                                    
                                       1
                                       
                                          
                                             
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      i
                                                   
                                                
                                                =
                                                t
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        Here 
                           
                              1
                              
                                 
                                    
                                       ·
                                    
                                 
                              
                           
                         is an indicator function that evaluates to 1 if the expression in the brackets is true, or 0 otherwise. The 
                           
                              
                                 
                                    y
                                 
                                 
                                    i
                                 
                              
                           
                         are distributed according to a Categorical distribution,
                           
                              (3)
                              
                                 
                                    
                                       y
                                    
                                    
                                       i
                                    
                                 
                                 ∼
                                 
                                 Categ
                                 
                                    
                                       
                                          π
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∏
                                       
                                       
                                          t
                                          =
                                          1
                                       
                                       
                                          T
                                       
                                    
                                 
                                 
                                    
                                       π
                                    
                                    
                                       t
                                    
                                    
                                       1
                                       
                                          
                                             
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      i
                                                   
                                                
                                                =
                                                t
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        Because this is a Bayesian model, prior distributions are placed on all of the model parameters as well,
                           
                              (4)
                              
                                 π
                                 ∼
                                 Dir
                                 
                                    
                                       
                                          α
                                       
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              (5)
                              
                                 
                                    
                                       η
                                    
                                    
                                       t
                                    
                                 
                                 ∼
                                 N
                                 
                                    
                                       
                                          h
                                          ,
                                          
                                             
                                                
                                                   
                                                      δ
                                                      
                                                         
                                                            Ψ
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                -
                                                1
                                             
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              (6)
                              
                                 
                                    
                                       Ψ
                                    
                                    
                                       t
                                    
                                 
                                 ∼
                                 W
                                 
                                    
                                       
                                          Φ
                                          ,
                                          ξ
                                       
                                    
                                 
                                 ,
                              
                           
                        where 
                           
                              W
                              
                                 
                                    
                                       ·
                                    
                                 
                              
                           
                         is a Wishart distribution, and only a single scalar parameter is given to the Dirichlet distribution as shorthand for a symmetric Dirichlet prior.

The following describes the generative process of the Bayesian Gaussian Mixture model:
                           
                              1.
                              Draw T cluster parameters 
                                    
                                       
                                          
                                             η
                                          
                                          
                                             t
                                          
                                       
                                    
                                  and 
                                    
                                       
                                          
                                             Ψ
                                          
                                          
                                             t
                                          
                                       
                                    
                                  from (5) and (6) respectively.

Draw mixture weights 
                                    
                                       π
                                       ∼
                                       Dir
                                       
                                          
                                             
                                                α
                                             
                                          
                                       
                                    
                                 .

For each image, 
                                    
                                       i
                                       ∈
                                       
                                          
                                             
                                                1
                                                ,
                                                …
                                                ,
                                                I
                                             
                                          
                                       
                                    
                                 :
                                    
                                       (a)
                                       Choose an image cluster 
                                             
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ∼
                                                Categ
                                                
                                                   
                                                      
                                                         π
                                                      
                                                   
                                                
                                             
                                          .

Draw an observation from the chosen cluster 
                                             
                                                
                                                   
                                                      w
                                                   
                                                   
                                                      i
                                                   
                                                
                                                |
                                                
                                                   
                                                      
                                                         
                                                            
                                                               y
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         =
                                                         t
                                                      
                                                   
                                                
                                                ∼
                                                N
                                                
                                                   
                                                      
                                                         
                                                            
                                                               η
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               Ψ
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          .

The graphical model of this process is shown in Fig. 1
                        . The actual (posterior) hyper-parameters (
                           
                              
                                 
                                    
                                       
                                          α
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    t
                                 
                              
                           
                        , 
                           
                              
                                 
                                    
                                       
                                          h
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    t
                                 
                              
                           
                        , etc.), number of clusters (T), and indicator assignments (
                           
                              
                                 
                                    y
                                 
                                 
                                    i
                                 
                              
                           
                        ) are learned using variational Bayes [8], which is discussed in Section 4.

There exist generalisations of this BGMM where 
                           
                              T
                              →
                              ∞
                           
                         using a Dirichlet process instead of a symmetric Dirichlet over the mixture weights [33]. Such a model is the variational Dirichlet Process (VDP) presented in [32]. We will not describe such a model here, however we do use the VDP in the experiments in Section 6. We have found that the variational Bayes realisation of the VDP and BGMM yield very similar results.

The BGMM and VDP do not take advantage of any contextual or structural information when applied to clustering images or segments. They simply cluster images or segments as if they were all in one “bag”. We use the BGMM/VDP as baseline Bayesian unsupervised methods for comparison to other, more sophisticated methods.

Latent Dirichlet allocation (LDA) [9] was originally formulated for modelling text, and typically has a Multinomial or Categorical cluster (topic) distribution. Because the image and segment descriptors we have used in this article are best modelled with Gaussian clusters, we now present a version of smoothed LDA with Gaussian clusters (G-LDA).

Using again the application of clustering images, G-LDA assumes data originates in J distinct groups or photo albums, 
                           
                              W
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                W
                                             
                                             
                                                j
                                             
                                          
                                       
                                    
                                 
                                 
                                    j
                                    =
                                    1
                                 
                                 
                                    J
                                 
                              
                           
                         (these groups are known as “documents” in the text modelling literature). Each of these albums contains 
                           
                              
                                 
                                    I
                                 
                                 
                                    j
                                 
                              
                           
                         images, 
                           
                              
                                 
                                    W
                                 
                                 
                                    j
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                w
                                             
                                             
                                                ji
                                             
                                          
                                       
                                    
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    
                                       
                                          I
                                       
                                       
                                          j
                                       
                                    
                                 
                              
                           
                        . Also, the mixture weights are specific to each group, 
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                π
                                             
                                             
                                                j
                                             
                                          
                                       
                                    
                                 
                                 
                                    j
                                    =
                                    1
                                 
                                 
                                    J
                                 
                              
                           
                        , but the clusters are shared between all groups,
                           
                              (7)
                              
                                 
                                    
                                       w
                                    
                                    
                                       ji
                                    
                                 
                                 ∼
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          t
                                          =
                                          1
                                       
                                       
                                          T
                                       
                                    
                                 
                                 
                                    
                                       π
                                    
                                    
                                       jt
                                    
                                 
                                 N
                                 
                                    
                                       
                                          
                                             
                                                w
                                             
                                             
                                                ji
                                             
                                          
                                          |
                                          
                                             
                                                η
                                             
                                             
                                                t
                                             
                                          
                                          ,
                                          
                                             
                                                Ψ
                                             
                                             
                                                t
                                             
                                             
                                                -
                                                1
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        The differences between G-LDA and the BGMM are perhaps illustrated more clearly in Fig. 1, and by the following generative process:
                           
                              1.
                              Draw T cluster parameters 
                                    
                                       
                                          
                                             η
                                          
                                          
                                             t
                                          
                                       
                                    
                                  and 
                                    
                                       
                                          
                                             Ψ
                                          
                                          
                                             t
                                          
                                       
                                    
                                  from (5) and (6) respectively.

For each group or album, 
                                    
                                       j
                                       ∈
                                       
                                          
                                             
                                                1
                                                ,
                                                …
                                                ,
                                                J
                                             
                                          
                                       
                                    
                                 :
                                    
                                       (a)
                                       Draw mixture weights 
                                             
                                                
                                                   
                                                      π
                                                   
                                                   
                                                      j
                                                   
                                                
                                                ∼
                                                Dir
                                                
                                                   
                                                      
                                                         α
                                                      
                                                   
                                                
                                             
                                          .

For each image, 
                                             
                                                i
                                                ∈
                                                
                                                   
                                                      
                                                         1
                                                         ,
                                                         …
                                                         ,
                                                         
                                                            
                                                               I
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          :
                                             
                                                i.
                                                Choose an image cluster 
                                                      
                                                         
                                                            
                                                               y
                                                            
                                                            
                                                               ji
                                                            
                                                         
                                                         ∼
                                                         Categ
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        π
                                                                     
                                                                     
                                                                        j
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   .

Draw an observation from the chosen cluster 
                                                      
                                                         
                                                            
                                                               w
                                                            
                                                            
                                                               ji
                                                            
                                                         
                                                         |
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        y
                                                                     
                                                                     
                                                                        ji
                                                                     
                                                                  
                                                                  =
                                                                  t
                                                               
                                                            
                                                         
                                                         ∼
                                                         N
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        η
                                                                     
                                                                     
                                                                        t
                                                                     
                                                                  
                                                                  ,
                                                                  
                                                                     
                                                                        Ψ
                                                                     
                                                                     
                                                                        t
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   .

G-LDA is quite similar to the BGMM except that is has mixture weights specific to each group or album. So each album of images has a specific proportion of scene-types (image clusters). Alternatively, if we used this model to cluster image segments, then each image would be described as a particular proportion of objects (segment-clusters). Hence, G-LDA models album context for image clustering, and image context when applied to segment clustering.

Generalisations of LDA to 
                           
                              T
                              →
                              ∞
                           
                         also exist, such as the hierarchical Dirichlet process (HDP) [34]. These models typically aid in the selection of T because of the hierarchical nature of the prior used. However, we have found this not to be an issue with G-LDA because of the heavy complexity penalties introduced by the Gaussian cluster priors (see Section 4 and Appendix A). Hence, we have elected to stay with the more simple, conjugate LDA-based model for this article.

Most standard computer vision datasets are not divided into photo albums, and so in Section 6 we mostly use G-LDA for clustering segments. However, the AUV dataset is comprised of multiple surveys, which we do use as albums.

Now we present the novel simultaneous clustering model (SCM), which can simultaneously cluster image segments and images unlike the BGMM and G-LDA. Like G-LDA, the SCM models albums j, but does not explicitly model image descriptors (
                           
                              
                                 
                                    w
                                 
                                 
                                    ji
                                 
                              
                           
                        ). Instead it models images as distributions of objects, or segment-clusters. This is a “bag-of-segments” representation since the layout, or order, of the segments in the image is not modelled.

Each image is comprised of 
                           
                              
                                 
                                    N
                                 
                                 
                                    ji
                                 
                              
                           
                         non-overlapping segments, 
                           
                              
                                 
                                    X
                                 
                                 
                                    ji
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                x
                                             
                                             
                                                jin
                                             
                                          
                                       
                                    
                                 
                                 
                                    n
                                    =
                                    1
                                 
                                 
                                    
                                       
                                          N
                                       
                                       
                                          ji
                                       
                                    
                                 
                              
                           
                         where 
                           
                              
                                 
                                    x
                                 
                                 
                                    jin
                                 
                              
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    
                                       
                                          D
                                       
                                       
                                          seg
                                       
                                    
                                 
                              
                           
                        , which are drawn from a mixture of K Gaussians or “object” types. The segment cluster weights 
                           
                              
                                 
                                    β
                                 
                                 
                                    t
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             β
                                          
                                          
                                             t
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             β
                                          
                                          
                                             tK
                                          
                                       
                                    
                                 
                              
                           
                         are specific to each scene-type, t, as opposed to each image in the case of G-LDA;
                           
                              (8)
                              
                                 SCM
                                 :
                                 
                                 
                                 
                                    
                                       x
                                    
                                    
                                       jin
                                    
                                 
                                 |
                                 
                                    
                                       
                                          
                                             
                                                y
                                             
                                             
                                                ji
                                             
                                          
                                          =
                                          t
                                       
                                    
                                 
                                 ∼
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          K
                                       
                                    
                                 
                                 
                                    
                                       β
                                    
                                    
                                       tk
                                    
                                 
                                 N
                                 
                                    
                                       
                                          
                                             
                                                x
                                             
                                             
                                                jin
                                             
                                          
                                          |
                                          
                                             
                                                μ
                                             
                                             
                                                k
                                             
                                          
                                          ,
                                          
                                             
                                                Λ
                                             
                                             
                                                k
                                             
                                             
                                                -
                                                1
                                             
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              (9)
                              
                                 G
                                 -
                                 LDA
                                 :
                                 
                                 
                                 
                                    
                                       x
                                    
                                    
                                       jin
                                    
                                 
                                 ∼
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          K
                                       
                                    
                                 
                                 
                                    
                                       β
                                    
                                    
                                       ik
                                    
                                 
                                 N
                                 
                                    
                                       
                                          
                                             
                                                x
                                             
                                             
                                                jin
                                             
                                          
                                          |
                                          
                                             
                                                μ
                                             
                                             
                                                k
                                             
                                          
                                          ,
                                          
                                             
                                                Λ
                                             
                                             
                                                k
                                             
                                             
                                                -
                                                1
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        So where G-LDA models segments as a Gaussian mixture specific to each image, i, the SCM models segments as a Gaussian mixture specific to a scene type or cluster of images, t. Like in the BGMM, an indicator variable for each segment observation, 
                           
                              
                                 
                                    z
                                 
                                 
                                    jin
                                 
                              
                              ∈
                              
                                 
                                    
                                       1
                                       ,
                                       …
                                       ,
                                       K
                                    
                                 
                              
                           
                        , is used to assign the observation to a segment-cluster (object-type). This indicator variable also has a Categorical distribution, but is conditioned on the scene indicator,
                           
                              (10)
                              
                                 
                                    
                                       z
                                    
                                    
                                       jin
                                    
                                 
                                 |
                                 
                                    
                                       y
                                    
                                    
                                       ji
                                    
                                 
                                 ∼
                                 
                                    
                                       
                                          ∏
                                       
                                       
                                          t
                                          =
                                          1
                                       
                                       
                                          T
                                       
                                    
                                 
                                 Categ
                                 
                                    
                                       
                                          
                                             
                                                
                                                   z
                                                
                                                
                                                   jin
                                                
                                             
                                             |
                                             
                                                
                                                   β
                                                
                                                
                                                   t
                                                
                                             
                                          
                                       
                                    
                                    
                                       1
                                       
                                          
                                             
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      ji
                                                   
                                                
                                                =
                                                t
                                             
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        note how this is similar to (2). Consequently, each image is described as a set of object types, 
                           
                              
                                 
                                    Z
                                 
                                 
                                    ji
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                z
                                             
                                             
                                                jin
                                             
                                          
                                       
                                    
                                 
                                 
                                    n
                                    =
                                    1
                                 
                                 
                                    
                                       
                                          N
                                       
                                       
                                          ji
                                       
                                    
                                 
                              
                           
                        , which is inherently a Multinomial distribution. This means that each scene-type, t, will have its own unique distribution of objects, 
                           
                              
                                 
                                    β
                                 
                                 
                                    t
                                 
                              
                           
                        . The BGMM and G-LDA represent a scene-type as a Gaussian cluster, whereas the SCM represents a scene-type as a Multinomial cluster.

All the SCM parameters have prior distributions;
                           
                              (11)
                              
                                 
                                    
                                       π
                                    
                                    
                                       j
                                    
                                 
                                 ∼
                                 GDir
                                 
                                    
                                       
                                          a
                                          ,
                                          b
                                       
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              (12)
                              
                                 
                                    
                                       β
                                    
                                    
                                       t
                                    
                                 
                                 ∼
                                 Dir
                                 
                                    
                                       
                                          θ
                                       
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              (13)
                              
                                 
                                    
                                       μ
                                    
                                    
                                       k
                                    
                                 
                                 ∼
                                 N
                                 
                                    
                                       
                                          m
                                          ,
                                          
                                             
                                                
                                                   
                                                      γ
                                                      
                                                         
                                                            Λ
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                -
                                                1
                                             
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              (14)
                              
                                 
                                    
                                       Λ
                                    
                                    
                                       k
                                    
                                 
                                 ∼
                                 W
                                 
                                    
                                       
                                          Ω
                                          ,
                                          ρ
                                       
                                    
                                 
                                 .
                              
                           
                        We have chosen to use a generalised Dirichlet distribution, 
                           
                              GDir
                              
                                 
                                    
                                       ·
                                    
                                 
                              
                           
                        , [35,36] over the scene-type mixture weights. It can be represented as a truncated stick breaking process, which is also used to approximate a Dirichlet process [37],
                           
                              (15)
                              
                                 
                                    
                                       π
                                    
                                    
                                       jt
                                    
                                 
                                 =
                                 
                                    
                                       v
                                    
                                    
                                       jt
                                    
                                 
                                 
                                    
                                       
                                          ∏
                                       
                                       
                                          s
                                          =
                                          1
                                       
                                       
                                          t
                                          -
                                          1
                                       
                                    
                                 
                                 (
                                 1
                                 -
                                 
                                    
                                       v
                                    
                                    
                                       js
                                    
                                 
                                 )
                                 ,
                                 
                                 
                                    
                                       v
                                    
                                    
                                       jt
                                    
                                 
                                 ∼
                                 
                                    
                                       
                                          
                                             
                                                
                                                   Beta
                                                   
                                                      
                                                         
                                                            a
                                                            ,
                                                            b
                                                         
                                                      
                                                   
                                                
                                                
                                                   if
                                                   
                                                   t
                                                   <
                                                   T
                                                
                                             
                                             
                                                
                                                   1
                                                
                                                
                                                   if
                                                   
                                                   t
                                                   =
                                                   T
                                                   ,
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    v
                                 
                                 
                                    jt
                                 
                              
                              ∈
                              [
                              0
                              ,
                              1
                              ]
                           
                         are “stick-lengths” for each album. Here we have also elected to just choose a scalar value for the hyper-parameters a and b, like in the case of the symmetric Dirichlet. We use a generalised Dirichlet for the SCM because it is a heavier prior (has twice the number of parameters) than the symmetric Dirichlet. This helps variational Bayes select an appropriate number of scene types, T, when using a Multinomial scene-type representation. This is similar in concept to using a HDP, but without the complexity. This modelling choice is explored empirically in Section 6.

The entire generative model of the SCM is represented in Fig. 2
                        , and is;
                           
                              1.
                              Draw T image cluster parameters 
                                    
                                       
                                          
                                             β
                                          
                                          
                                             t
                                          
                                       
                                    
                                  from (12).

Draw K segment cluster parameters 
                                    
                                       
                                          
                                             μ
                                          
                                          
                                             k
                                          
                                       
                                    
                                  and 
                                    
                                       
                                          
                                             Λ
                                          
                                          
                                             k
                                          
                                       
                                    
                                  from (13) and (14) respectively.

For each group or album, 
                                    
                                       j
                                       ∈
                                       
                                          
                                             
                                                1
                                                ,
                                                …
                                                ,
                                                J
                                             
                                          
                                       
                                    
                                 :
                                    
                                       (a)
                                       Draw mixture weights 
                                             
                                                
                                                   
                                                      π
                                                   
                                                   
                                                      j
                                                   
                                                
                                                ∼
                                                GDir
                                                
                                                   
                                                      
                                                         a
                                                         ,
                                                         b
                                                      
                                                   
                                                
                                             
                                          .

For each image, 
                                             
                                                i
                                                ∈
                                                
                                                   
                                                      
                                                         1
                                                         ,
                                                         …
                                                         ,
                                                         
                                                            
                                                               I
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          :
                                             
                                                i.
                                                Choose an image cluster 
                                                      
                                                         
                                                            
                                                               y
                                                            
                                                            
                                                               ji
                                                            
                                                         
                                                         ∼
                                                         Categ
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        π
                                                                     
                                                                     
                                                                        j
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   .

For each image segment 
                                                      
                                                         n
                                                         ∈
                                                         
                                                            
                                                               
                                                                  1
                                                                  ,
                                                                  …
                                                                  ,
                                                                  
                                                                     
                                                                        N
                                                                     
                                                                     
                                                                        ji
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   :
                                                      
                                                         A.
                                                         Choose a segment cluster 
                                                               
                                                                  
                                                                     
                                                                        z
                                                                     
                                                                     
                                                                        jin
                                                                     
                                                                  
                                                                  |
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 y
                                                                              
                                                                              
                                                                                 ji
                                                                              
                                                                           
                                                                           =
                                                                           t
                                                                        
                                                                     
                                                                  
                                                                  ∼
                                                                  Categ
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 β
                                                                              
                                                                              
                                                                                 t
                                                                              
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            .

Draw an observation from the segment cluster 
                                                               
                                                                  
                                                                     
                                                                        x
                                                                     
                                                                     
                                                                        jin
                                                                     
                                                                  
                                                                  |
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 z
                                                                              
                                                                              
                                                                                 jin
                                                                              
                                                                           
                                                                           =
                                                                           k
                                                                        
                                                                     
                                                                  
                                                                  ∼
                                                                  N
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 μ
                                                                              
                                                                              
                                                                                 k
                                                                              
                                                                           
                                                                           ,
                                                                           
                                                                              
                                                                                 Λ
                                                                              
                                                                              
                                                                                 k
                                                                              
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            .

The SCM is similar in some ways to the model presented in [4], for instance it represents an image as a distribution of object types. However, the SCM retains the image-album context of G-LDA (when the latter is applied to clustering images). The SCM models segments as having scene-type context, i.e. a tree is more likely to appear in a forest scene than an indoor scene. This is unlike G-LDA (when applied to segments), which only models segments as having specific image context. Hence the SCM has better object co-occurrence modelling facility than G-LDA. Distributions of objects are captured at the scene-type level, 
                           
                              
                                 
                                    β
                                 
                                 
                                    t
                                 
                              
                           
                        , which involves many images, as opposed to just the single image level, 
                           
                              
                                 
                                    β
                                 
                                 
                                    i
                                 
                              
                           
                        .

The final model we present in this article is the multiple-source clustering model (MCM). This model has also been presented in [25]. It essentially combines the SCM segment representation with the image-level representation of G-LDA.

Like the SCM, the MCM models segments, 
                           
                              
                                 
                                    x
                                 
                                 
                                    jin
                                 
                              
                           
                        , as a scene-type specific mixture of Gaussians, 
                           
                              
                                 
                                    β
                                 
                                 
                                    t
                                 
                              
                           
                        . But unlike the SCM, the MCM also models image descriptors, 
                           
                              
                                 
                                    w
                                 
                                 
                                    ji
                                 
                              
                           
                        , as a group specific mixture of Gaussians, like image-level G-LDA. So now scene clusters, or types, are represented by both the proportions of objects (segment clusters) within them, 
                           
                              
                                 
                                    β
                                 
                                 
                                    t
                                 
                              
                           
                        , and a Gaussian component that describes the overall scene appearance, parameterised by 
                           
                              
                                 
                                    η
                                 
                                 
                                    t
                                 
                              
                           
                         and 
                           
                              
                                 
                                    Ψ
                                 
                                 
                                    t
                                 
                              
                           
                        .

The difference between the SCM and the MCM can be visualised by the graphical models in Fig. 2. We also illustrate how images are modelled under the SCM and MCM in Fig. 3
                        . The generative process of the MCM is;
                           
                              1.
                              Draw T image cluster parameters 
                                    
                                       
                                          
                                             β
                                          
                                          
                                             t
                                          
                                       
                                       ,
                                       
                                          
                                             η
                                          
                                          
                                             t
                                          
                                       
                                    
                                  and 
                                    
                                       
                                          
                                             Ψ
                                          
                                          
                                             t
                                          
                                       
                                    
                                  from (12), (5) and (6) respectively

Draw K segment cluster parameters 
                                    
                                       
                                          
                                             μ
                                          
                                          
                                             k
                                          
                                       
                                    
                                  and 
                                    
                                       
                                          
                                             Λ
                                          
                                          
                                             k
                                          
                                       
                                    
                                  from (13) and (14) respectively.

For each group or album, 
                                    
                                       j
                                       ∈
                                       
                                          
                                             
                                                1
                                                ,
                                                …
                                                ,
                                                J
                                             
                                          
                                       
                                    
                                 :
                                    
                                       (a)
                                       Draw mixture weights 
                                             
                                                
                                                   
                                                      π
                                                   
                                                   
                                                      j
                                                   
                                                
                                                ∼
                                                GDir
                                                
                                                   
                                                      
                                                         a
                                                         ,
                                                         b
                                                      
                                                   
                                                
                                             
                                          .

For each image, 
                                             
                                                i
                                                ∈
                                                
                                                   
                                                      
                                                         1
                                                         ,
                                                         …
                                                         ,
                                                         
                                                            
                                                               I
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          :
                                             
                                                i.
                                                Choose an image cluster 
                                                      
                                                         
                                                            
                                                               y
                                                            
                                                            
                                                               ji
                                                            
                                                         
                                                         ∼
                                                         Categ
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        π
                                                                     
                                                                     
                                                                        j
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   .

Draw an image observation from the chosen image cluster 
                                                      
                                                         
                                                            
                                                               w
                                                            
                                                            
                                                               ji
                                                            
                                                         
                                                         |
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        y
                                                                     
                                                                     
                                                                        ji
                                                                     
                                                                  
                                                                  =
                                                                  t
                                                               
                                                            
                                                         
                                                         ∼
                                                         N
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        η
                                                                     
                                                                     
                                                                        t
                                                                     
                                                                  
                                                                  ,
                                                                  
                                                                     
                                                                        Ψ
                                                                     
                                                                     
                                                                        t
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   .

For each image segment 
                                                      
                                                         n
                                                         ∈
                                                         
                                                            
                                                               
                                                                  1
                                                                  ,
                                                                  …
                                                                  ,
                                                                  
                                                                     
                                                                        N
                                                                     
                                                                     
                                                                        ji
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   .
                                                      
                                                         A.
                                                         Choose a segment cluster 
                                                               
                                                                  
                                                                     
                                                                        z
                                                                     
                                                                     
                                                                        jin
                                                                     
                                                                  
                                                                  |
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 y
                                                                              
                                                                              
                                                                                 ji
                                                                              
                                                                           
                                                                           =
                                                                           t
                                                                        
                                                                     
                                                                  
                                                                  ∼
                                                                  Categ
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 β
                                                                              
                                                                              
                                                                                 t
                                                                              
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            .

Draw a segment observation from the segment cluster 
                                                               
                                                                  
                                                                     
                                                                        x
                                                                     
                                                                     
                                                                        jin
                                                                     
                                                                  
                                                                  |
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 z
                                                                              
                                                                              
                                                                                 jin
                                                                              
                                                                           
                                                                           =
                                                                           k
                                                                        
                                                                     
                                                                  
                                                                  ∼
                                                                  N
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 μ
                                                                              
                                                                              
                                                                                 k
                                                                              
                                                                           
                                                                           ,
                                                                           
                                                                              
                                                                                 Λ
                                                                              
                                                                              
                                                                                 k
                                                                              
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            .

The type of context that the MCM models is similar to the SCM. The only real difference being that scene types have a joint Multinomial-Gaussian representation. This allows the MCM to more effectively model global scene attributes that may not be captured by just object co-occurrence. For instance, the image descriptors introduced in Section 5 capture the coarse spatial structure of an image.

In this section variational Bayes inference algorithms are derived for learning the posterior latent variables of the SCM and MCM, i.e., posterior hyper-parameters, labels, and number of clusters. We do not present the variational Bayes algorithms for the BGMM, VDP or G-LDA since these can be found in [8,32,38,39]. Also, many of the updates are similar between these models.

Typically, to learn the posterior latent variables of the types of Bayesian models presented in the previous section, the models’ log-marginal likelihood is maximised with respect to the set of model hyper-parameters, 
                        
                           Ξ
                        
                     . The log-marginal likelihood takes the general form:
                        
                           (16)
                           
                              log
                              p
                              
                                 
                                    
                                       X
                                       |
                                       Ξ
                                    
                                 
                              
                              =
                              log
                              ∫
                              p
                              
                                 
                                    
                                       X
                                       ,
                                       Z
                                       ,
                                       Θ
                                       |
                                       Ξ
                                    
                                 
                              
                              d
                              Z
                              
                              d
                              Θ
                              ,
                           
                        
                     where 
                        
                           X
                        
                      are observable, 
                        
                           Z
                        
                      are latent indicators, and 
                        
                           Θ
                        
                      are the set of model parameters. This integral is intractable in the case of all of the presented models, and so an approximation of this marginal log-likelihood is usually made. In the case of variational Bayes, this approximation is called free energy, 
                        
                           F
                        
                     . The approximation starts by representing the full joint distribution of the model with a set of factored distributions:
                        
                           (17)
                           
                              p
                              
                                 
                                    
                                       X
                                       ,
                                       Z
                                       ,
                                       Θ
                                       |
                                       Ξ
                                    
                                 
                              
                              ≈
                              q
                              
                                 
                                    
                                       Z
                                    
                                 
                              
                              q
                              
                                 
                                    
                                       Θ
                                    
                                 
                              
                              .
                           
                        
                     By optimising the free energy functional 
                        
                           F
                           
                              
                                 
                                    q
                                    
                                       
                                          
                                             Z
                                          
                                       
                                    
                                    ,
                                    q
                                    
                                       
                                          
                                             Θ
                                          
                                       
                                    
                                 
                              
                           
                        
                     , the Kullback–Leibler divergence, 
                        
                           KL
                           
                              
                                 
                                    p
                                    ‖
                                    q
                                 
                              
                           
                        
                     , is minimised between the approximation and the true joint in (17). This optimisation typically results in an expectation maximisation-like algorithm [40] that alternates between finding the expected distribution (or assignments) for the indicators, 
                        
                           q
                           
                              
                                 
                                    Z
                                 
                              
                           
                        
                     , and the optimum value of the variational posterior hyper-parameters, 
                        
                           
                              
                                 Ξ
                              
                              
                                 ̃
                              
                           
                        
                     , that govern 
                        
                           q
                           
                              
                                 
                                    Θ
                                 
                              
                           
                        
                     . The expectation and maximisation steps are alternated until 
                        
                           F
                        
                      converges. For more information on this general variational Bayes algorithm see [38,40]. Also, for the exact form of 
                        
                           F
                        
                      for the SCM and MCM see Appendix A.

Applying the variational Bayes learning algorithm to the SCM yields the following expectation step for the segment indicators, 
                           
                              Z
                           
                        ,
                           
                              (18)
                              
                                 q
                                 
                                    
                                       
                                          
                                             
                                                z
                                             
                                             
                                                jin
                                             
                                          
                                          =
                                          k
                                       
                                    
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       
                                          
                                             Z
                                          
                                          
                                             
                                                
                                                   z
                                                
                                                
                                                   jin
                                                
                                             
                                          
                                       
                                    
                                 
                                 exp
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   t
                                                   =
                                                   1
                                                
                                                
                                                   T
                                                
                                             
                                          
                                          q
                                          
                                             
                                                
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         ij
                                                      
                                                   
                                                   =
                                                   t
                                                
                                             
                                          
                                          
                                             
                                                E
                                             
                                             
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      β
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   log
                                                   
                                                      
                                                         β
                                                      
                                                      
                                                         tk
                                                      
                                                   
                                                
                                             
                                          
                                          +
                                          
                                             
                                                E
                                             
                                             
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      μ
                                                      ,
                                                      Λ
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   log
                                                   N
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  x
                                                               
                                                               
                                                                  jin
                                                               
                                                            
                                                            |
                                                            
                                                               
                                                                  μ
                                                               
                                                               
                                                                  k
                                                               
                                                            
                                                            ,
                                                            
                                                               
                                                                  Λ
                                                               
                                                               
                                                                  k
                                                               
                                                               
                                                                  -
                                                                  1
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        Here 
                           
                              
                                 
                                    Z
                                 
                                 
                                    
                                       
                                          z
                                       
                                       
                                          jin
                                       
                                    
                                 
                              
                           
                         is a normalisation constant which is straight-forwardly computed from the sum over k of the un-normalised components of (18). Also, 
                           
                              
                                 
                                    E
                                 
                                 
                                    q
                                 
                              
                              
                                 
                                    
                                       ·
                                    
                                 
                              
                           
                         denotes the expectation with respect to the variational distribution, 
                           
                              q
                              
                                 
                                    
                                       ·
                                    
                                 
                              
                           
                        . These expectations are given in Appendix B. In (18) the term with the sum over the weighted image label probabilities, 
                           
                              q
                              
                                 
                                    
                                       
                                          
                                             y
                                          
                                          
                                             jin
                                          
                                       
                                       =
                                       t
                                    
                                 
                              
                           
                        , assigns more or less likelihood of the current segment observation belonging to the segment cluster based on the probability of the image belonging to a scene-type, t. For example, if the image is of a forest type, then the current object is more likely to be a tree trunk than a building. This is how scene-type context is modelled for objects.

Similarly, the following expectation step is obtained for the image indicators, 
                           
                              Y
                           
                        ,
                           
                              (19)
                              
                                 q
                                 
                                    
                                       
                                          
                                             
                                                y
                                             
                                             
                                                ji
                                             
                                          
                                          =
                                          t
                                       
                                    
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       
                                          
                                             Z
                                          
                                          
                                             
                                                
                                                   y
                                                
                                                
                                                   ji
                                                
                                             
                                          
                                       
                                    
                                 
                                 exp
                                 
                                    
                                       
                                          
                                             
                                                E
                                             
                                             
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      π
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   log
                                                   
                                                      
                                                         π
                                                      
                                                      
                                                         jt
                                                      
                                                   
                                                
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   k
                                                   =
                                                   1
                                                
                                                
                                                   K
                                                
                                             
                                          
                                          
                                             
                                                E
                                             
                                             
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      β
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   log
                                                   
                                                      
                                                         β
                                                      
                                                      
                                                         tk
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   n
                                                   =
                                                   1
                                                
                                                
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         ji
                                                      
                                                   
                                                
                                             
                                          
                                          q
                                          
                                             
                                                
                                                   
                                                      
                                                         z
                                                      
                                                      
                                                         jin
                                                      
                                                   
                                                   =
                                                   k
                                                
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        Again, 
                           
                              
                                 
                                    Z
                                 
                                 
                                    
                                       
                                          y
                                       
                                       
                                          ji
                                       
                                    
                                 
                              
                           
                         is simply calculated by summing the un-normalised components over t, and the expectations are given in Appendix B. From (19) we can see that an image is assigned to a scene-type, t, by the number and co-occurrence of object types within it. This is indicated by the term containing sums over 
                           
                              q
                              
                                 
                                    
                                       
                                          
                                             z
                                          
                                          
                                             jin
                                          
                                       
                                       =
                                       k
                                    
                                 
                              
                           
                        , which is essentially a Multinomial log-likelihood.

Optimising 
                           
                              F
                           
                         for the parameters of the SCM leads to the following variational posterior updates for the mixture weights, 
                           
                              
                                 
                                    π
                                 
                                 
                                    j
                                 
                              
                           
                        , and image cluster parameters, 
                           
                              
                                 
                                    β
                                 
                                 
                                    t
                                 
                              
                           
                        ;
                           
                              (20)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   jt
                                                
                                             
                                             =
                                             a
                                             +
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   
                                                      
                                                         
                                                            I
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                   
                                                
                                             
                                             q
                                             
                                                
                                                   
                                                      
                                                         
                                                            y
                                                         
                                                         
                                                            ji
                                                         
                                                      
                                                      =
                                                      t
                                                   
                                                
                                             
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   jt
                                                
                                             
                                             =
                                             b
                                             +
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   
                                                      
                                                         
                                                            I
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      s
                                                      =
                                                      t
                                                      +
                                                      1
                                                   
                                                   
                                                      T
                                                   
                                                
                                             
                                             q
                                             
                                                
                                                   
                                                      
                                                         
                                                            y
                                                         
                                                         
                                                            ji
                                                         
                                                      
                                                      =
                                                      s
                                                   
                                                
                                             
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         θ
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   tk
                                                
                                             
                                             =
                                             θ
                                             +
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      j
                                                      =
                                                      1
                                                   
                                                   
                                                      J
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   
                                                      
                                                         
                                                            I
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                   
                                                
                                             
                                             q
                                             
                                                
                                                   
                                                      
                                                         
                                                            y
                                                         
                                                         
                                                            ji
                                                         
                                                      
                                                      =
                                                      t
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      n
                                                      =
                                                      1
                                                   
                                                   
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            ji
                                                         
                                                      
                                                   
                                                
                                             
                                             q
                                             
                                                
                                                   
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            jin
                                                         
                                                      
                                                      =
                                                      k
                                                   
                                                
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        These updates are essentially just the prior with added observation counts, or sufficient statistics. The sum for 
                           
                              
                                 
                                    
                                       
                                          b
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    jt
                                 
                              
                           
                         in (20) must be performed in descending cluster size order, as per [32]. The variational posterior Gaussian–Wishart hyper-parameters for the segment clusters are,
                           
                              (21)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         γ
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   k
                                                
                                             
                                             =
                                             γ
                                             +
                                             
                                                
                                                   N
                                                
                                                
                                                   k
                                                
                                             
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         m
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   k
                                                
                                             
                                             =
                                             
                                                
                                                   1
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               γ
                                                            
                                                            
                                                               ̃
                                                            
                                                         
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      γ
                                                      m
                                                      +
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  x
                                                               
                                                               
                                                                  ¯
                                                               
                                                            
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                   
                                                
                                             
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ρ
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   k
                                                
                                             
                                             =
                                             ρ
                                             +
                                             
                                                
                                                   N
                                                
                                                
                                                   k
                                                
                                             
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         Ω
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   k
                                                
                                                
                                                   -
                                                   1
                                                
                                             
                                             =
                                             
                                                
                                                   Ω
                                                
                                                
                                                   -
                                                   1
                                                
                                             
                                             +
                                             
                                                
                                                   N
                                                
                                                
                                                   k
                                                
                                             
                                             
                                                
                                                   R
                                                
                                                
                                                   k
                                                
                                             
                                             +
                                             
                                                
                                                   γ
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               γ
                                                            
                                                            
                                                               ̃
                                                            
                                                         
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  x
                                                               
                                                               
                                                                  ¯
                                                               
                                                            
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      -
                                                      m
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     x
                                                                  
                                                                  
                                                                     ¯
                                                                  
                                                               
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                         -
                                                         m
                                                      
                                                   
                                                
                                                
                                                   ⊤
                                                
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        where
                           
                              (22)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   N
                                                
                                                
                                                   k
                                                
                                             
                                             =
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      j
                                                      =
                                                      1
                                                   
                                                   
                                                      J
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   
                                                      
                                                         
                                                            I
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      n
                                                      =
                                                      1
                                                   
                                                   
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            ji
                                                         
                                                      
                                                   
                                                
                                             
                                             q
                                             
                                                
                                                   
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            jin
                                                         
                                                      
                                                      =
                                                      k
                                                   
                                                
                                             
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                
                                                
                                                   k
                                                
                                             
                                             =
                                             
                                                
                                                   1
                                                
                                                
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      j
                                                      =
                                                      1
                                                   
                                                   
                                                      J
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   
                                                      
                                                         
                                                            I
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      n
                                                      =
                                                      1
                                                   
                                                   
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            ji
                                                         
                                                      
                                                   
                                                
                                             
                                             q
                                             
                                                
                                                   
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            jin
                                                         
                                                      
                                                      =
                                                      k
                                                   
                                                
                                             
                                             
                                                
                                                   x
                                                
                                                
                                                   jin
                                                
                                             
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   R
                                                
                                                
                                                   k
                                                
                                             
                                             =
                                             
                                                
                                                   1
                                                
                                                
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      j
                                                      =
                                                      1
                                                   
                                                   
                                                      J
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   
                                                      
                                                         
                                                            I
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      n
                                                      =
                                                      1
                                                   
                                                   
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            ji
                                                         
                                                      
                                                   
                                                
                                             
                                             q
                                             
                                                
                                                   
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            jin
                                                         
                                                      
                                                      =
                                                      k
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            jin
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            
                                                               
                                                                  x
                                                               
                                                               
                                                                  ¯
                                                               
                                                            
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               x
                                                            
                                                            
                                                               jin
                                                            
                                                         
                                                         -
                                                         
                                                            
                                                               
                                                                  
                                                                     x
                                                                  
                                                                  
                                                                     ¯
                                                                  
                                                               
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   ⊤
                                                
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        The expectation steps (18) and (19) and the maximisation steps (21) are alternated until 
                           
                              F
                           
                         for the SCM converges. 
                           
                              F
                           
                         is given in Appendix A.

Since the MCM is similar to the SCM, apart from the image observation model, many of the variational updates are the same. The image indicator, 
                           
                              Y
                           
                        , updates have a different form because of the image observations,
                           
                              (23)
                              
                                 q
                                 
                                    
                                       
                                          
                                             
                                                y
                                             
                                             
                                                ji
                                             
                                          
                                          =
                                          t
                                       
                                    
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       
                                          
                                             Z
                                          
                                          
                                             
                                                
                                                   y
                                                
                                                
                                                   ji
                                                
                                             
                                          
                                       
                                    
                                 
                                 exp
                                 
                                    
                                       
                                          
                                             
                                                E
                                             
                                             
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      π
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   log
                                                   
                                                      
                                                         π
                                                      
                                                      
                                                         jt
                                                      
                                                   
                                                
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   k
                                                   =
                                                   1
                                                
                                                
                                                   K
                                                
                                             
                                          
                                          
                                             
                                                E
                                             
                                             
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      β
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   log
                                                   
                                                      
                                                         β
                                                      
                                                      
                                                         tk
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   n
                                                   =
                                                   1
                                                
                                                
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         ji
                                                      
                                                   
                                                
                                             
                                          
                                          q
                                          
                                             
                                                
                                                   
                                                      
                                                         z
                                                      
                                                      
                                                         jin
                                                      
                                                   
                                                   =
                                                   k
                                                
                                             
                                          
                                          +
                                          
                                             
                                                E
                                             
                                             
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      η
                                                      ,
                                                      Ψ
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   log
                                                   N
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  w
                                                               
                                                               
                                                                  ji
                                                               
                                                            
                                                            |
                                                            
                                                               
                                                                  η
                                                               
                                                               
                                                                  t
                                                               
                                                            
                                                            ,
                                                            
                                                               
                                                                  Ψ
                                                               
                                                               
                                                                  t
                                                               
                                                               
                                                                  -
                                                                  1
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        This equation has the same general form as (19), but with an added Gaussian log-likelihood term corresponding to the image descriptors, 
                           
                              
                                 
                                    w
                                 
                                 
                                    ji
                                 
                              
                           
                        .

The maximisation steps for the model parameters are also the same as the MCM apart from those for the Gaussian-Wishart prior over the image observation, 
                           
                              
                                 
                                    w
                                 
                                 
                                    ji
                                 
                              
                           
                        , clusters. However, these update equations are the same as those in (21), though the sums in (22) are only over j and i, and involve the image indicators, 
                           
                              
                                 
                                    y
                                 
                                 
                                    ji
                                 
                              
                           
                        .

If the number of clusters, T and K, is known a priori or set to some large value, the label and posterior hyper-parameter updates can simply be iterated until 
                           
                              F
                           
                         converges to a local maximum. Some of the clusters will not accrue any observations because of the variational Bayes complexity penalties that naturally arise in 
                           
                              F
                           
                        . We have found that better clustering results can be obtained if we guide the search for the segment clusters.

The segment-cluster search heuristic we use is a much faster, greedy version of the exhaustive heuristic presented in [32]. The SCM and MCM start with 
                           
                              K
                              =
                              1
                           
                         segment cluster, and iterate until convergence. Then the segment cluster is split in a direction perpendicular to its principal axis. The two resulting clusters are then refined by running variational Bayes over them for a limited number of iterations (we use a maximum of 15). 
                           
                              F
                           
                         is estimated with this newly proposed split, and if it has increased in value, the split is accepted and the whole model is again iterated until convergence. Otherwise, the algorithm terminates. The exhaustive heuristic proceeds by trialling every possible cluster split between each model convergence stage, and only accepts the split that maximises 
                           
                              F
                           
                        . When K becomes large, this search heuristic becomes the dominant computational cost of the whole inference algorithm.

In our greedy “split-tally” heuristic, we guess which cluster to split first by ranking all clusters’ approximate contribution to 
                           
                              F
                           
                         (details in Appendix C). Also, a tally is kept of how many times a cluster has previously failed a split trial. Clusters that have not yet failed splits are prioritised for splitting. The first cluster split to increase 
                           
                              F
                           
                         is accepted, and the tally for the original cluster is reset. All clusters must eventually fail to be split for the algorithm to terminate. We have found this split-tally heuristic greatly reduces run-time, without significantly impacting performance, mostly because of the tally. To our knowledge, this is the first time a tally has been used in such a heuristic. A similar heuristic was also trialled to search for T in the MCM, however we found that it was better to randomly initialise it to some large value, 
                           
                              
                                 
                                    T
                                 
                                 
                                    trunc
                                 
                              
                              >
                              T
                           
                        , since both heuristics would interact. Also, there is no intuitive way to split the purely Multinomial image clusters of the SCM, so it is also randomly initialised.

We also use this split-tally heuristic for searching for the number of clusters in the VDP and G-LDA, when applied to image or segment clustering, in Section 6.

Because all of the aforementioned models are Bayesian we need to choose priors in the form of initial hyper-parameter values. These priors are then updated as evidence is presented to the learning algorithm. By prioritising simplicity, we have chosen the following values for the prior hyper-parameters;
                           
                              (24)
                              
                                 
                                    
                                       
                                       
                                          
                                             α
                                             ,
                                             a
                                             ,
                                             b
                                             ,
                                             θ
                                             ,
                                             γ
                                             ,
                                             δ
                                             =
                                             1
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             ρ
                                             =
                                             
                                                
                                                   D
                                                
                                                
                                                   seg
                                                
                                             
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             ξ
                                             =
                                             
                                                
                                                   D
                                                
                                                
                                                   im
                                                
                                             
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             m
                                             =
                                             mean
                                             (
                                             X
                                             )
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             h
                                             =
                                             mean
                                             (
                                             W
                                             )
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             Ω
                                             =
                                             
                                                
                                                   (
                                                   ρ
                                                   
                                                      
                                                         C
                                                      
                                                      
                                                         w
                                                         ,
                                                         s
                                                      
                                                   
                                                   )
                                                
                                                
                                                   -
                                                   1
                                                
                                             
                                             
                                                
                                                   I
                                                
                                                
                                                   
                                                      
                                                         D
                                                      
                                                      
                                                         seg
                                                      
                                                   
                                                
                                             
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             Φ
                                             =
                                             
                                                
                                                   (
                                                   ξ
                                                   
                                                      
                                                         C
                                                      
                                                      
                                                         w
                                                         ,
                                                         i
                                                      
                                                   
                                                   
                                                      
                                                         λ
                                                      
                                                      
                                                         cov
                                                         (
                                                         W
                                                         )
                                                      
                                                      
                                                         max
                                                      
                                                   
                                                   )
                                                
                                                
                                                   -
                                                   1
                                                
                                             
                                             
                                                
                                                   I
                                                
                                                
                                                   
                                                      
                                                         D
                                                      
                                                      
                                                         im
                                                      
                                                   
                                                
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        The values for the first three equations in (24) have been chosen to be their minimum integer value in the support of their respective distributions. We have found that apart from 
                           
                              θ
                           
                        , changing these values only has a minor affect on the posterior clusters. For the SCM in Section 6 we do vary the value of 
                           
                              θ
                           
                        .

The prior parameter, 
                           
                              θ
                           
                        , essentially controls how many different objects (segment clusters) we expect to be in a particular scene-type a priori. For low values of 
                           
                              θ
                           
                        , we would expect only a few objects within each scene-type, i.e. we expect 
                           
                              
                                 
                                    z
                                 
                                 
                                    jin
                                 
                              
                           
                         to only take a few values of k for a particular scene-type, t. Therefore more image clusters may be required to represent all possible object-types, k, since only a few can exist in a scene-type. We would expect the opposite to occur for high values of 
                           
                              θ
                           
                        .

The Wishart matrix priors in the last two equations of (24) are just scaled identity matrices. This has the effect of making the algorithms expect isotropic Gaussian clusters in the data a priori. Also 
                           
                              
                                 
                                    λ
                                 
                                 
                                    cov
                                    (
                                    W
                                    )
                                 
                                 
                                    max
                                 
                              
                           
                         is the largest Eigenvalue of the covariance of the image descriptors. This value is not used for the segment descriptors since they are whitened, see Section 5. 
                           
                              
                                 
                                    C
                                 
                                 
                                    w
                                    ,
                                    i
                                 
                              
                           
                         and 
                           
                              
                                 
                                    C
                                 
                                 
                                    w
                                    ,
                                    s
                                 
                              
                           
                         (i for image, s for segment) are tunable parameters that encode the a priori “width” of the isotropic clusters. These tuning parameters were found to have the largest effect on the number of (Gaussian) clusters found by the algorithms. In Section 6 we will show clustering performance with varying 
                           
                              θ
                              ,
                              
                                 
                                    C
                                 
                                 
                                    w
                                    ,
                                    i
                                 
                              
                           
                         and 
                           
                              
                                 
                                    C
                                 
                                 
                                    w
                                    ,
                                    s
                                 
                              
                           
                        .

The aforementioned algorithms rely on highly discriminative visual descriptors since they are driven by visual-data alone. We have chosen unsupervised feature learning algorithms for this task as they are easily implemented and have excellent performance in a number of scene recognition tasks, e.g. [41].

We use a modified sparse coding spatial pyramid matching (ScSPM) [41] method to encode the image descriptors 
                           
                              
                                 
                                    w
                                 
                                 
                                    ji
                                 
                              
                           
                        . Fig. 4
                        (a) demonstrates how these image descriptors are created. For all experiments we use the original 1024-base Caltech-101 dictionary supplied by [41] to encode dense 
                           
                              16
                              ×
                              16
                           
                         pixel SIFT patches with a stride of 8 pixels. We have found little to no reduction in classification and clustering performance using this pre-learned dictionary as compared to learning dictionaries for each specific dataset. This is similar to the observation made in [42].

We use orthogonal matching pursuit (OMP) with 10 activations in place of the original sparse coding encoding method used in [41] for the larger AUV dataset. It is much less computationally demanding and does not affect scene clustering performance greatly. We use the original pyramid with a [1,2,4] pooling region configuration, which leads to a 21,504 dimensional (sparse) code for each image. This is far too large to use with a Gaussian cluster model, but we have found that these codes are highly compressible with (randomised) PCA. Typically we can compress them to 
                           
                              
                                 
                                    D
                                 
                                 
                                    im
                                 
                              
                              =
                              20
                           
                         while still achieving excellent image clustering performance.

Out of the many segment descriptors tried, it was found that pooling dense independent component analysis (ICA) [43] codes within segments gave the best results. The following procedure was used to create a descriptor for each segment within an image:
                           
                              1.
                              Extract square patches centred on every pixel in the image.

(Optional) remove the DC offset, and contrast normalise the patches.

Use a random subset of all of the patches in the dataset to train an ICA dictionary, 
                                    
                                       D
                                    
                                 , and its pseudo-inverse, 
                                    
                                       
                                          
                                             D
                                          
                                          
                                             +
                                          
                                       
                                    
                                 .

Use 
                                    
                                       
                                          
                                             D
                                          
                                          
                                             +
                                          
                                       
                                    
                                  to create a code (or filter response), 
                                    
                                       
                                          
                                             a
                                          
                                          
                                             l
                                          
                                       
                                    
                                 , for all of the patches. This is a fast matrix multiplication operation, so is feasible for patches centred on every pixel, 
                                    
                                       l
                                       ∈
                                       [
                                       1
                                       ,
                                       L
                                       ]
                                    
                                 , in an image. L is the total number of pixels in an image.

Over-segment the image, obtaining sets of pixels 
                                    
                                       
                                          
                                             S
                                          
                                          
                                             jin
                                          
                                       
                                    
                                 . The results presented here used a fast mean-shift segmentation method [44].

Obtain segment descriptors by mean pooling all of the ICA dictionary responses in a segment in the following manner:
                                    
                                       (25)
                                       
                                          
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      ̃
                                                   
                                                
                                             
                                             
                                                jin
                                             
                                          
                                          =
                                          
                                             
                                                1
                                             
                                             
                                                #
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      jin
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   l
                                                   ∈
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         jin
                                                      
                                                   
                                                
                                             
                                          
                                          log
                                          |
                                          
                                             
                                                a
                                             
                                             
                                                l
                                             
                                          
                                          |
                                          .
                                       
                                    
                                 
                              

These transformations greatly improved segment clustering performance. We conjecture that the absolute value makes the descriptors invariant to 90 degree phase shifts in 
                                    
                                       
                                          
                                             r
                                          
                                          
                                             l
                                          
                                       
                                    
                                 . The logarithm transforms the range back to 
                                    
                                       (
                                       -
                                       ∞
                                       ,
                                       ∞
                                       )
                                    
                                 .

Obtain the final segment descriptors, 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             jin
                                          
                                       
                                    
                                 , by PCA whitening all the 
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   ̃
                                                
                                             
                                          
                                          
                                             jin
                                          
                                       
                                    
                                 . We perform dimensionality reduction as part of this whitening stage, to 
                                    
                                       
                                          
                                             D
                                          
                                          
                                             seg
                                          
                                       
                                       =
                                       15
                                    
                                 , which preserves more than 90% of the spectral power.

This process is graphically demonstrated in Fig. 4(b).

A bag-of-words representation was not chosen for the segments as it would require a Multinomial cluster distribution as opposed to Gaussian. We found this representation to be less powerful for model selection in this unsupervised application (this is demonstrated in Section 6 at the image level). We have chosen to leave a comprehensive comparison between these ICA-based features and bag-of-words features for object detection as future work. However, we do compare the image ScSPM representation against a bag-of-words image representation for use in spectral clustering in Table 1
                        , where we can observe tangible benefits. Naturally, the performance of these algorithms is largely influenced by the representation chosen.

Both the image and segment descriptors take about 1s each per image to calculate. The ScSPM and ICA features are complementary; the ScSPM descriptors encode the spatial layout and structural information of an image (the “gist”), whereas the ICA features encode fine-grained colour and texture information.

@&#EXPERIMENTS@&#

In this section we compare the VDP, G-LDA, SCM and MCM in image and segment clustering tasks. We also compare to other unsupervised, weakly-supervised, semi-supervised and supervised algorithms in the literature for scene understanding/recognition. For this comparison we use three standard datasets (single album) and a large novel dataset consisting of twelve surveys (albums) from an autonomous underwater vehicle (AUV). We also explore whether a symmetric Dirichlet prior over group weights, 
                        
                           
                              
                                 π
                              
                              
                                 j
                              
                           
                        
                     , has an effect on clustering results for the SCM and MCM. Finally we explore whether modelling groups improves clustering performance on the AUV dataset.

Normalised mutual information (NMI) [45] is used to compare the clustering results to the ground truth image and segment labels. This is a fairly common measure in the clustering literature as it permits performance to be compared in situations where the number of ground truth classes and clusters are different. All results cited have been transformed into NMI scores from the confusion matrices given in their corresponding papers. This conversion is straight forward as long as the number of images used for testing within each class is known.

We also estimate the mean accuracy for the clustering results when benchmarking against supervised algorithms. This is done using the contingency table used to calculate NMI, which is just a table with the number of rows equalling the number of truth classes, and the number of columns equalling the number of clusters. Each cell in the table is a count of the number of observations assigned to the corresponding class and cluster labels. We turn this into a confusion matrix by merging each cluster-column to class-columns indicated by their row (class) which has the maximum count. Some classes will have zero counts, and multiple clusters may be merged into one class. We believe this is entirely unbiased, but may heavily penalise the clustering results in situations where no clusters map to a class. Also, trivial clustering solutions may be rewarded, i.e., when many clusters are found there is a greater chance they will be merged into the correct classes. It is worth noting that NMI does not suffer from these problems. We do not use training or test sets since no labels are used by the algorithm. Also there is no closed form solution for predicting labels on new data with the SCM and MCM.

For all datasets, the MCM has a truncation level 
                        
                           
                              
                                 T
                              
                              
                                 trunc
                              
                           
                           =
                           30
                        
                      and the SCM 
                        
                           
                              
                                 T
                              
                              
                                 trunc
                              
                           
                           =
                           100
                        
                     . The SCM and MCM are also run ten times for each dataset with a random initialisation of 
                        
                           Y
                        
                     . The VDP, G-LDA, SCM and MCM code is all written in multi-threaded C++, though we only use one thread for most experiments to be strictly fair in our comparisons. All experiments were performed on a 2009 Core 2 Duo 3GHz system with 6GB RAM.

The first dataset considered is Microsoft’s MSRC v2 dataset, which has both scene and object labels. We use the same 10 scene categories as [4,6], with a total of 320 images (
                           
                              320
                              ×
                              213
                           
                         pixels). These images contained 15 segmented object categories, the “void” object category was not included. We found that 
                           
                              5
                              ×
                              5
                           
                         pixel un-normalised patches worked best for the ICA descriptors (with a dictionary of 50 bases).

The results for image clustering/classification are given in Table 1, with the line separating the unsupervised from the supervised algorithms. The VDP+ScSPM refers to running the VDP with the image ScSPM based descriptors, and SC+ScSPM refers to self-tuning spectral clustering (SC) [46] using ScSPM features. For spectral clustering we use 10 random restarts, a 10 nearest neighbour sparse similarity matrix, and set the number of clusters to be the true number of classes. We also use self-tuning spectral clustering with 
                           
                              T
                              =
                              10
                           
                         for the 
                           
                              
                                 
                                    L
                                 
                                 
                                    2
                                 
                              
                           
                        -LEM-
                           
                              
                                 
                                    χ
                                 
                                 
                                    2
                                 
                              
                           
                         algorithm with BoW features [28], but with a dense similarity matrix and a chi-square kernel.

The MCM performs substantially better for image clustering than all of the other unsupervised methods for this dataset, but does lag behind the weakly supervised methods of [4,6]. However, the MCM still manages to achieve visually consistent image and segment clusters, see Fig. 5
                        .

Segment clustering performance was quantified on a per segment basis, as opposed to per-pixel, which would have been too costly to evaluate for all images in these experiments. Also, the labelled segments provided were fairly coarse (this is especially true of the next dataset), and so we are more concerned with consistently recognising the same objects, as opposed to extracting them precisely. In order to assign a segment a ground-truth label, the mode of the pixels in the segment had to be of the label type. To quantify the algorithms’ segment clustering performance, we ran them for an array of 
                           
                              
                                 
                                    C
                                 
                                 
                                    w
                                    ,
                                    s
                                 
                              
                           
                         values. The results are summarised in Fig. 6
                        . We can see that the MCM consistently outperforms the VDP and G-LDA, wheras the SCM initially starts on par with the MCM, but then converges to the same performance as G-LDA. For this dataset scene-type context can improve performance over image-context and no context for segment clustering. We can also see the quality of the scene-types (image clusters) found has an effect on the quality of the object-types found.

We have only used a single mean-shift parameterisation that leads to over-segmentation for these results. It would seem prudent to cluster segments from multiple segmentation parameterisations simultaneously, as in [20,26]. In this way, the probability of extracting the “true” object boundaries within a scene is increased. However, the MCM and SCM both assume that a scene-type is represented as a distribution of objects, so incorporating multiple segmentation results could bias scene discovery. We will leave multiple segmentation as the subject of future work, and for now rely on over-segmentation to achieve reasonable object boundary detection.

The next dataset we used was obtained from LabelMe [47]. It is comprised of 2688 images (
                           
                              256
                              ×
                              256
                           
                         pixels), with 8 scene classes. Here we found 
                           
                              7
                              ×
                              7
                           
                         un-normalised image patches worked best for the ICA descriptors (60 bases). The segment labels for this dataset were unconstrained in their categories, and so using the LabelMe Matlab toolbox, we combined all of the labels with 5 or more instances into 22 classes.
                           1
                           The manifest file is located: www.daniel-steinberg.info/publications.html.
                        
                        
                           1
                         The appearance of these object classes is far less constrained than the MSRC dataset.

Again we compare the unsupervised methods to state-of-the-art weakly, semi- and supervised methods in Table 2
                        . Interestingly, the VDP performs best out of all of the unsupervised methods, it even outperforms a supervised support vector machine (SVM) using unmodified ScSPM features. The VDP is followed by spectral clustering and the MCM, which are within one standard deviation. The SCM performs very poorly on this dataset. All unsupervised methods apart from the SCM are quite competitive with the supervised methods on this dataset.

In this experiment it appears that the segment clusters are confounding the SCM image clustering. This would also explain the disparity between the VDP and the MCM, though the MCM is more robust than the SCM.

From Fig. 7
                         we can see the MCM far outperforms the other unsupervised algorithms for segment clustering. The SCM marginally outperforms G-LDA, which both outperform the VDP. This demonstrates that object discovery can be improved by incorporating scene contextual information. Like in the MSRC dataset, we see that scene discovery performance can directly affect object discovery performance.

It is worth making some remarks on the visual effect on the clusters as we change the 
                           
                              
                                 
                                    C
                                 
                                 
                                    w
                                    ,
                                    i
                                 
                              
                           
                         and 
                           
                              
                                 
                                    C
                                 
                                 
                                    w
                                    ,
                                    s
                                 
                              
                           
                         parameters. Typically smaller settings of these parameters lead to more clusters (though after a point we may get fewer clusters once more). Usually larger clusters would be split fairly evenly into smaller clusters unless the images comprising a cluster were quite distinct. This is a consequence of the free energy objective, which tends to only make small clusters if the data-fitting terms overcome the complexity penalties.

The final standard dataset is the UIUC sports dataset used by [2–4,6,14]. This dataset depicts 8 types of sporting events and has 1579 images. To be consistent, we limit the maximum dimension of the images to be 320 pixels. Unfortunately no segment labels were available for this dataset. We use the same segment descriptor settings as the MSRC dataset. Results for scene recognition are presented in Table 3
                        . Note that the algorithm from [4] is also fully unsupervised for this dataset.

Image classification in this dataset is more difficult than the others presented so far, as evident in the lower NMI and classification scores. Despite this, somewhat surprisingly, the MCM is one of the best performing algorithms on this dataset, including the supervised algorithms. We have also compared the MCM and VDP for image clustering with varying 
                           
                              
                                 
                                    C
                                 
                                 
                                    w
                                    ,
                                    i
                                 
                              
                           
                         in Fig. 8
                        . There are no groups in this dataset, so G-LDA would be very similar to the VDP in performance. We have also plotted the performance of the SCM with 
                           
                              θ
                              =
                              50
                           
                         (average of 10 runs), which was found to give the best results. The MCM far outperforms the VDP, and is far more consistent in its performance across the range of 
                           
                              
                                 
                                    C
                                 
                                 
                                    w
                                    ,
                                    i
                                 
                              
                           
                         chosen. However, it does take longer to find image clusters than both the SCM and the VDP. An example of the image and segment clusters found by the MCM is shown in Fig. 9
                        .

The last dataset we use is a novel dataset containing images of various underwater habitats obtained by an AUV from 
                           
                              J
                              =
                              12
                           
                         deployments off of the east coast of Tasmania, Australia [48]. This dataset has 100,647 downward looking stereo pair images taken from an altitude of 2m. The monochrome image of the pair is used for the ScSPM descriptors, and the colour for the ICA segment descriptors. The images are reduced to 
                           
                              320
                              ×
                              235
                           
                         pixels (again to be consistent with the previous experiments). We used 
                           
                              5
                              ×
                              5
                           
                         pixels patches that had their DC components removed and were contrast normalised for both ICA dictionary learning (50 bases) and encoding. This helped with the illumination variations in this dataset.

This dataset has nine image classes: fine sand, coarse sand, screw shell rubble ⩾50%, screw shell rubble <50%, sand/reef interface, patch reef, low relief reef, high relief reef, Ecklonia (kelp). 6011 of these images are labelled. Many of these classes are quite visually similar so the labels have a small amount of noise. Exemplars of each class are shown in Fig. 10
                        . We do not use any segment labels for this dataset.

The entire 100,647 image dataset was clustered using the VDP, G-LDA, SCM and MCM. The 12 dives act as albums for G-LDA, the SCM and the MCM, and the SCM and MCM use 
                           
                              
                                 
                                    C
                                 
                                 
                                    w
                                    ,
                                    s
                                 
                              
                              =
                              350
                           
                        . The VDP cannot take advantage of the groups in this dataset. Fig. 11
                         summarises these results for varying 
                           
                              
                                 
                                    C
                                 
                                 
                                    w
                                    ,
                                    i
                                 
                              
                           
                         (the 6011 labelled images were used for validation). The VDP, G-LDA and MCM all begin with similar image clustering performance, however the VDP and G-LDA rapidly decrease in performance with increasing 
                           
                              
                                 
                                    C
                                 
                                 
                                    w
                                    ,
                                    i
                                 
                              
                           
                        , whereas the MCM maintains, and even increases its performance. Again we just show the average of 10 runs with 
                           
                              θ
                              =
                              1000
                           
                         for the SCM since it does not use 
                           
                              
                                 
                                    C
                                 
                                 
                                    w
                                    ,
                                    i
                                 
                              
                           
                        . An example of some clusters found by the MCM are shown in Fig. 12
                        . Interestingly, the MCM has sufficient evidence to model the image vignetting and distortion artefacts induced by the air-acrylic-water interface of the camera housing. This is particularly evident in the fourth image cluster from the top (red).

Since the VDP and G-LDA only use image observations, they are run on the Core 2 Duo machine using one core. The SCM and MCM also have two million segments to cluster in addition to the images, and so they are run on eight Xeon E5-4260 2.2GHz cores. It is interesting to note in Fig. 11 that although the VDP and G-LDA only use one core, G-LDA is consistently faster despite the two algorithms being very similar. We believe this is because modelling the different groups, or dives, in this dataset helps to expose separation between the clusters in the dataset. For instance, there are some dives that may exhibit only coarse sand while others may also exhibit screw shell rubble because of their location. So although these two classes may appear visually similar, the contextual information inherent in the dives’ locations helps to distinguish these classes [39]. G-LDA can take advantage of this structure, which helps to simplify inference.

Like G-LDA, the MCM and SCM can also model groups. To verify if these algorithms can take advantage of this group structure we have compared them using 
                           
                              J
                              =
                              12
                           
                         groups to only 
                           
                              J
                              =
                              1
                           
                         group by concatenating the data from the dives. The results are shown in Fig. 13
                        . The MCM with 
                           
                              J
                              =
                              1
                           
                         seems to perform worse than the 
                           
                              J
                              =
                              12
                           
                         version for image clustering for some values of 
                           
                              
                                 
                                    C
                                 
                                 
                                    w
                                    ,
                                    i
                                 
                              
                           
                        . Also the SCM without groups performs marginally worse. The largest difference though is the MCM runtime with no groups. This runtime difference can be partially attributed to the way the MCM code is parallelised. The VBE step for the 
                           
                              Y
                           
                         indicators (19) is parallelised over groups in the original MCM, and so the MCM without groups cannot take advantage of this. However, the VBE step for the segment indicators, 
                           
                              Z
                           
                        , has a larger computational cost (there are twenty times more segment observations than image observations), and is paralellised over images the same way in both MCM variants. So, it is unlikely the difference in the way the VBE-
                           
                              Y
                           
                         step is parallelised can entirely account for the threefold run time increase. Part of this is likely attributable to the same cluster separation effect experience by G-LDA. The MCM with 
                           
                              J
                              =
                              12
                           
                         incorporates G-LDA as part of its image model, where as when it has 
                           
                              J
                              =
                              1
                           
                         it is more similar to the VDP at the image level.

In Section 3 we used a generalised Dirichlet prior over the group mixture weights, 
                           
                              
                                 
                                    π
                                 
                                 
                                    j
                                 
                              
                           
                        , for the SCM and MCM. Here we wish to empirically validate this choice of prior. For this purpose, we formulate variants of these two models with symmetric Dirichlet priors, 
                           
                              
                                 
                                    π
                                 
                                 
                                    j
                                 
                              
                              ∼
                              Dir
                              
                                 
                                    
                                       a
                                    
                                 
                              
                           
                        , for comparison. These variants are run on all of the datasets mentioned previously, and the results are summarised in Fig. 14
                        .

As we can see from Fig. 14, the symmetric Dirichlet prior versions of the SCM and MCM have very comparable NMI scores to their generalised Dirichlet counterparts. The SCM variants do show slightly more variability in the UIUC and AUV datasets though. The MCM has almost the exact same results all-round, whereas the SCM with a symmetric Dirichlet prior finds more image clusters. In fact it appears to almost always find 
                           
                              T
                              =
                              
                                 
                                    T
                                 
                                 
                                    trunc
                                 
                              
                              =
                              100
                           
                         image clusters for all but the small MSRC dataset. Even then it shows potential instability when looking at the variance at 
                           
                              
                                 
                                    C
                                 
                                 
                                    w
                                    ,
                                    s
                                 
                              
                              =
                              1.8
                           
                        .

The generalised Dirichlet is a suitable choice of mixture weight prior for the SCM since it helps to control the number of image clusters found. This could be because it has twice the number of parameters as the Dirichlet prior, and so contributes more to the free energy model complexity penalty. This performance is also similar to the difference between LDA and HDPs when used for model selection in natural language processing [34]. The choice of prior does not seem to matter as much for the MCM, as the Gaussian image clusters contribute adequately to model complexity.

@&#CONCLUSION@&#

It has been long established that using discriminative visual features is essential for both unsupervised and supervised applications such as scene recognition, object detection, and scene understanding. In this work we have also shown that the choice of model structure has a large influence on results for scene understanding tasks in the absence of any semantic knowledge such as image tags, accompanying text, or image or object labels. We have also shown that with appropriate model structure and choice of visual features, unsupervised methods can be competitive with weakly, semi, and supervised methods for scene understanding. From the experiments in Section 6 we have also been able to conclude:
                        
                           •
                           Modelling albums or groups did not provide a large benefit to clustering performance. However algorithm run-time can be significantly reduced by additional parallelisation and using the structure of the groups to help expose the latent clusters.

Scene-type context for segment clustering (SCM and MCM) helped performance more than image context (G-LDA), which is in turn better than no context (VDP). The better the discovered scene-types, the better the segment-clusters.

The generalised Dirichlet prior on the group weights, 
                                 
                                    
                                       
                                          π
                                       
                                       
                                          j
                                       
                                    
                                 
                              , helps to control the number of Multinomial image clusters found in the SCM. However, it does not appear to affect models with Gaussian clusters, such as the MCM. This was also found to be the same for G-LDA.

The Multinomial “bag-of-segments” representation for images used by the SCM does not perform as well as the mixture of Gaussian ScSPM representation in most cases. Whereas the ScSPM representation does not work well on small datasets, and can be sensitive to the choice of prior, 
                                 
                                    
                                       
                                          C
                                       
                                       
                                          w
                                          ,
                                          i
                                       
                                    
                                 
                              . The MCM combines the strengths of both of these complementary approaches, usually resulting in better and more robust image and segment clustering performance.

One direction for future work would be to model spatial-layout within the graphical models themselves, like in [14], while simultaneously modelling the co-occurrence between objects. Perhaps in this way joint object spatial and co-occurrence structure could be learned in an unsupervised manner.

@&#ACKNOWLEDGEMENTS@&#

This work is funded by the Australian Research Council, the New South Wales State Government, and the Integrated Marine Observing System. The authors acknowledge the providers of the datasets and those who released their code that was used in the validation of this work.

In this appendix we give the full free energy objective functions for the SCM and MCM.


                        
                           
                              (A.1)
                              
                                 
                                    
                                       F
                                    
                                    
                                       SCM
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          t
                                          =
                                          1
                                       
                                       
                                          T
                                       
                                    
                                 
                                 
                                    
                                       E
                                    
                                    
                                       
                                          
                                             q
                                          
                                          
                                             β
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          log
                                          
                                             
                                                Dir
                                                
                                                   
                                                      
                                                         
                                                            
                                                               β
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                         |
                                                         θ
                                                      
                                                   
                                                
                                             
                                             
                                                q
                                                
                                                   
                                                      
                                                         
                                                            
                                                               β
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          K
                                       
                                    
                                 
                                 
                                    
                                       E
                                    
                                    
                                       
                                          
                                             q
                                          
                                          
                                             μ
                                             ,
                                             Λ
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          log
                                          
                                             
                                                N
                                                
                                                   
                                                      
                                                         
                                                            
                                                               μ
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                         |
                                                         m
                                                         ,
                                                         
                                                            
                                                               (
                                                               γ
                                                               
                                                                  
                                                                     Λ
                                                                  
                                                                  
                                                                     k
                                                                  
                                                               
                                                               )
                                                            
                                                            
                                                               -
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                
                                                W
                                                
                                                   
                                                      
                                                         
                                                            
                                                               Λ
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                         |
                                                         Ω
                                                         ,
                                                         ρ
                                                      
                                                   
                                                
                                             
                                             
                                                q
                                                
                                                   
                                                      
                                                         
                                                            
                                                               μ
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               Λ
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          J
                                       
                                    
                                 
                                 
                                    
                                       E
                                    
                                    
                                       
                                          
                                             q
                                          
                                          
                                             π
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          log
                                          
                                             
                                                GDir
                                                
                                                   
                                                      
                                                         
                                                            
                                                               π
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                         |
                                                         a
                                                         ,
                                                         b
                                                      
                                                   
                                                
                                             
                                             
                                                q
                                                
                                                   
                                                      
                                                         
                                                            
                                                               π
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          J
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          Ij
                                       
                                    
                                 
                                 
                                    
                                       E
                                    
                                    
                                       q
                                    
                                 
                                 
                                    
                                       
                                          log
                                          
                                             
                                                Categ
                                                
                                                   
                                                      
                                                         
                                                            
                                                               y
                                                            
                                                            
                                                               ji
                                                            
                                                         
                                                         |
                                                         
                                                            
                                                               π
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                q
                                                
                                                   
                                                      
                                                         
                                                            
                                                               y
                                                            
                                                            
                                                               ji
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          J
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          Ij
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          n
                                          =
                                          1
                                       
                                       
                                          
                                             
                                                N
                                             
                                             
                                                ji
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          t
                                          =
                                          1
                                       
                                       
                                          T
                                       
                                    
                                 
                                 
                                    
                                       E
                                    
                                    
                                       q
                                    
                                 
                                 
                                    
                                       
                                          log
                                          
                                             
                                                Categ
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  z
                                                               
                                                               
                                                                  jin
                                                               
                                                            
                                                            |
                                                            
                                                               
                                                                  β
                                                               
                                                               
                                                                  t
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      1
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     y
                                                                  
                                                                  
                                                                     ji
                                                                  
                                                               
                                                               =
                                                               t
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                q
                                                
                                                   
                                                      
                                                         
                                                            
                                                               z
                                                            
                                                            
                                                               jin
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          J
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          Ij
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          n
                                          =
                                          1
                                       
                                       
                                          
                                             
                                                N
                                             
                                             
                                                ji
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          K
                                       
                                    
                                 
                                 
                                    
                                       E
                                    
                                    
                                       q
                                    
                                 
                                 
                                    
                                       
                                          log
                                          
                                             
                                                N
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  x
                                                               
                                                               
                                                                  jin
                                                               
                                                            
                                                            |
                                                            
                                                               
                                                                  μ
                                                               
                                                               
                                                                  k
                                                               
                                                            
                                                            ,
                                                            
                                                               
                                                                  Λ
                                                               
                                                               
                                                                  k
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      1
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     z
                                                                  
                                                                  
                                                                     jin
                                                                  
                                                               
                                                               =
                                                               k
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                q
                                                
                                                   
                                                      
                                                         
                                                            
                                                               z
                                                            
                                                            
                                                               jin
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                     

The last three terms’ expectations are with respect to all of the latent variables and parameters. These last three terms act like a data-fitting objectives, and the first three terms act as model complexity penalties. It is also worth noting that 
                           
                              
                                 
                                    E
                                 
                                 
                                    
                                       
                                          q
                                       
                                       
                                          y
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       1
                                       
                                          
                                             
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      ji
                                                   
                                                
                                                =
                                                t
                                             
                                          
                                       
                                    
                                 
                              
                              =
                              q
                              
                                 
                                    
                                       
                                          
                                             y
                                          
                                          
                                             ji
                                             =
                                             t
                                          
                                       
                                    
                                 
                              
                           
                        , and similarly for 
                           
                              
                                 
                                    z
                                 
                                 
                                    jin
                                 
                              
                           
                        .


                        
                           
                              (A.2)
                              
                                 
                                    
                                       F
                                    
                                    
                                       MCM
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          t
                                          =
                                          1
                                       
                                       
                                          T
                                       
                                    
                                 
                                 
                                    
                                       E
                                    
                                    
                                       
                                          
                                             q
                                          
                                          
                                             β
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          log
                                          
                                             
                                                Dir
                                                
                                                   
                                                      
                                                         
                                                            
                                                               β
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                         |
                                                         θ
                                                      
                                                   
                                                
                                             
                                             
                                                q
                                                
                                                   
                                                      
                                                         
                                                            
                                                               β
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          t
                                          =
                                          1
                                       
                                       
                                          T
                                       
                                    
                                 
                                 
                                    
                                       E
                                    
                                    
                                       
                                          
                                             q
                                          
                                          
                                             η
                                             ,
                                             Ψ
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          log
                                          
                                             
                                                N
                                                
                                                   
                                                      
                                                         
                                                            
                                                               η
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                         |
                                                         h
                                                         ,
                                                         
                                                            
                                                               (
                                                               δ
                                                               
                                                                  
                                                                     Ψ
                                                                  
                                                                  
                                                                     t
                                                                  
                                                               
                                                               )
                                                            
                                                            
                                                               -
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                
                                                W
                                                
                                                   
                                                      
                                                         
                                                            
                                                               Ψ
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                         |
                                                         Φ
                                                         ,
                                                         ξ
                                                      
                                                   
                                                
                                             
                                             
                                                q
                                                
                                                   
                                                      
                                                         
                                                            
                                                               η
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               Ψ
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          K
                                       
                                    
                                 
                                 
                                    
                                       E
                                    
                                    
                                       
                                          
                                             q
                                          
                                          
                                             μ
                                             ,
                                             Λ
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          log
                                          
                                             
                                                N
                                                
                                                   
                                                      
                                                         
                                                            
                                                               μ
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                         |
                                                         m
                                                         ,
                                                         
                                                            
                                                               (
                                                               γ
                                                               
                                                                  
                                                                     Λ
                                                                  
                                                                  
                                                                     k
                                                                  
                                                               
                                                               )
                                                            
                                                            
                                                               -
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                
                                                W
                                                
                                                   
                                                      
                                                         
                                                            
                                                               Λ
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                         |
                                                         Ω
                                                         ,
                                                         ρ
                                                      
                                                   
                                                
                                             
                                             
                                                q
                                                
                                                   
                                                      
                                                         
                                                            
                                                               μ
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               Λ
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          J
                                       
                                    
                                 
                                 
                                    
                                       E
                                    
                                    
                                       
                                          
                                             q
                                          
                                          
                                             π
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          log
                                          
                                             
                                                GDir
                                                
                                                   
                                                      
                                                         
                                                            
                                                               π
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                         |
                                                         a
                                                         ,
                                                         b
                                                      
                                                   
                                                
                                             
                                             
                                                q
                                                
                                                   
                                                      
                                                         
                                                            
                                                               π
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          J
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          Ij
                                       
                                    
                                 
                                 
                                    
                                       E
                                    
                                    
                                       q
                                    
                                 
                                 
                                    
                                       
                                          log
                                          
                                             
                                                Categ
                                                
                                                   
                                                      
                                                         
                                                            
                                                               y
                                                            
                                                            
                                                               ji
                                                            
                                                         
                                                         |
                                                         
                                                            
                                                               π
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                q
                                                
                                                   
                                                      
                                                         
                                                            
                                                               y
                                                            
                                                            
                                                               ji
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          J
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          Ij
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          t
                                          =
                                          1
                                       
                                       
                                          T
                                       
                                    
                                 
                                 
                                    
                                       E
                                    
                                    
                                       q
                                    
                                 
                                 
                                    
                                       
                                          log
                                          
                                             
                                                N
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  w
                                                               
                                                               
                                                                  ji
                                                               
                                                            
                                                            |
                                                            
                                                               
                                                                  η
                                                               
                                                               
                                                                  t
                                                               
                                                            
                                                            ,
                                                            
                                                               
                                                                  Ψ
                                                               
                                                               
                                                                  t
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      1
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     y
                                                                  
                                                                  
                                                                     ji
                                                                  
                                                               
                                                               =
                                                               t
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                q
                                                
                                                   
                                                      
                                                         
                                                            
                                                               y
                                                            
                                                            
                                                               ji
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          J
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          Ij
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          n
                                          =
                                          1
                                       
                                       
                                          
                                             
                                                N
                                             
                                             
                                                ji
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          t
                                          =
                                          1
                                       
                                       
                                          T
                                       
                                    
                                 
                                 
                                    
                                       E
                                    
                                    
                                       q
                                    
                                 
                                 
                                    
                                       
                                          log
                                          
                                             
                                                Categ
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  z
                                                               
                                                               
                                                                  jin
                                                               
                                                            
                                                            |
                                                            
                                                               
                                                                  β
                                                               
                                                               
                                                                  t
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      1
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     y
                                                                  
                                                                  
                                                                     ji
                                                                  
                                                               
                                                               =
                                                               t
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                q
                                                
                                                   
                                                      
                                                         
                                                            
                                                               z
                                                            
                                                            
                                                               jin
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          J
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          Ij
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          n
                                          =
                                          1
                                       
                                       
                                          
                                             
                                                N
                                             
                                             
                                                ji
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          K
                                       
                                    
                                 
                                 
                                    
                                       E
                                    
                                    
                                       q
                                    
                                 
                                 
                                    
                                       
                                          log
                                          
                                             
                                                N
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  x
                                                               
                                                               
                                                                  jin
                                                               
                                                            
                                                            |
                                                            
                                                               
                                                                  μ
                                                               
                                                               
                                                                  k
                                                               
                                                            
                                                            ,
                                                            
                                                               
                                                                  Λ
                                                               
                                                               
                                                                  k
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      1
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     z
                                                                  
                                                                  
                                                                     jin
                                                                  
                                                               
                                                               =
                                                               k
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                q
                                                
                                                   
                                                      
                                                         
                                                            
                                                               z
                                                            
                                                            
                                                               jin
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                     

The last four terms’ expectations are with respect to all of the latent variables and parameters. Now the last four terms act like a data-fitting objectives and the first four terms act as model complexity penalties.

The Categorical distribution is most often used as the likelihood of the Dirichlet distribution in this paper,
                           
                              (B.1)
                              
                                 Categ
                                 
                                    
                                       
                                          
                                             
                                                z
                                             
                                             
                                                jin
                                             
                                          
                                          |
                                          
                                             
                                                β
                                             
                                             
                                                t
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∏
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          K
                                       
                                    
                                 
                                 
                                    
                                       β
                                    
                                    
                                       tk
                                    
                                    
                                       1
                                       
                                          
                                             
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      jin
                                                   
                                                
                                                =
                                                k
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        Here 
                           
                              1
                              
                                 
                                    
                                       ·
                                    
                                 
                              
                           
                         is an indicator function, and evaluates to 1 when the condition in the brackets is true, and 0 otherwise. The corresponding Dirichlet prior has the form,
                           
                              (B.2)
                              
                                 Dir
                                 
                                    
                                       
                                          
                                             
                                                β
                                             
                                             
                                                t
                                             
                                          
                                          |
                                          θ
                                       
                                    
                                 
                                 =
                                 
                                    
                                       Γ
                                       (
                                       K
                                       ·
                                       θ
                                       )
                                    
                                    
                                       Γ
                                       
                                          
                                             (
                                             θ
                                             )
                                          
                                          
                                             K
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∏
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          K
                                       
                                    
                                 
                                 
                                    
                                       β
                                    
                                    
                                       tk
                                    
                                    
                                       θ
                                       -
                                       1
                                    
                                 
                                 ,
                              
                           
                        here 
                           
                              Γ
                              (
                              ·
                              )
                           
                         is a Gamma function. This is a symmetric Dirichlet prior, another a commonly used parameterisation is 
                           
                              Dir
                              
                                 
                                    
                                       
                                          
                                             β
                                          
                                          
                                             t
                                          
                                       
                                       |
                                       θ
                                       /
                                       K
                                    
                                 
                              
                           
                        .

The log Categorical expectation under a generalised Dirichlet is,
                              
                                 (B.3)
                                 
                                    
                                       
                                          E
                                       
                                       
                                          
                                             
                                                q
                                             
                                             
                                                β
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             log
                                             p
                                             
                                                
                                                   
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            jin
                                                         
                                                      
                                                      =
                                                      k
                                                      |
                                                      
                                                         
                                                            β
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          E
                                       
                                       
                                          
                                             
                                                q
                                             
                                             
                                                β
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             log
                                             
                                                
                                                   β
                                                
                                                
                                                   tk
                                                
                                             
                                          
                                       
                                    
                                    =
                                    ψ
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         θ
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   tk
                                                
                                             
                                          
                                       
                                    
                                    -
                                    ψ
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      k
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         θ
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   tk
                                                
                                             
                                          
                                       
                                    
                                    ,
                                 
                              
                           where 
                              
                                 ψ
                                 (
                                 ·
                                 )
                              
                            is a Digamma function, and 
                              
                                 
                                    
                                       
                                          
                                             θ
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       tk
                                    
                                 
                              
                            is from (20).

The expectations of the model complexity penalty terms are,
                              
                                 (B.4)
                                 
                                    
                                       
                                          E
                                       
                                       
                                          
                                             
                                                q
                                             
                                             
                                                β
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             log
                                             
                                                
                                                   Dir
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  β
                                                               
                                                               
                                                                  t
                                                               
                                                            
                                                            |
                                                            θ
                                                         
                                                      
                                                   
                                                
                                                
                                                   q
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  β
                                                               
                                                               
                                                                  t
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    =
                                    log
                                    Γ
                                    (
                                    K
                                    ·
                                    θ
                                    )
                                    -
                                    log
                                    Γ
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      k
                                                      =
                                                      1
                                                   
                                                   
                                                      K
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         θ
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   tk
                                                
                                             
                                          
                                       
                                    
                                    +
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             k
                                             =
                                             1
                                          
                                          
                                             K
                                          
                                       
                                    
                                    log
                                    Γ
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         θ
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   tk
                                                
                                             
                                          
                                       
                                    
                                    -
                                    K
                                    log
                                    Γ
                                    (
                                    θ
                                    )
                                    -
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             k
                                             =
                                             1
                                          
                                          
                                             K
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         θ
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   tk
                                                
                                             
                                             -
                                             θ
                                          
                                       
                                    
                                    
                                       
                                          E
                                       
                                       
                                          
                                             
                                                q
                                             
                                             
                                                β
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             log
                                             
                                                
                                                   β
                                                
                                                
                                                   tk
                                                
                                             
                                          
                                       
                                    
                                    ,
                                 
                              
                           where 
                              
                                 
                                    
                                       E
                                    
                                    
                                       
                                          
                                             q
                                          
                                          
                                             β
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          log
                                          
                                             
                                                β
                                             
                                             
                                                tk
                                             
                                          
                                       
                                    
                                 
                              
                            is from Eq. (B.3).

The Categorical distribution is most often used as the likelihood of the Generalised Dirichlet distribution in this paper, see Eq. (B.1). The generalised Dirichlet prior on the mixture weights, 
                           
                              GDir
                              
                                 
                                    
                                       
                                          
                                             π
                                          
                                          
                                             j
                                          
                                       
                                       |
                                       a
                                       ,
                                       b
                                    
                                 
                              
                           
                         is parameterised in (15), and made use of the Beta distribution over stick-lengths,
                           
                              (B.5)
                              
                                 Beta
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       jt
                                    
                                 
                                 |
                                 a
                                 ,
                                 b
                                 )
                                 =
                                 
                                    
                                       Γ
                                       (
                                       a
                                       +
                                       b
                                       )
                                    
                                    
                                       Γ
                                       (
                                       a
                                       )
                                       Γ
                                       (
                                       b
                                       )
                                    
                                 
                                 
                                    
                                       v
                                    
                                    
                                       jt
                                    
                                    
                                       a
                                       -
                                       1
                                    
                                 
                                 
                                    
                                       
                                          
                                             1
                                             -
                                             
                                                
                                                   v
                                                
                                                
                                                   jt
                                                
                                             
                                          
                                       
                                    
                                    
                                       b
                                       -
                                       1
                                    
                                 
                                 .
                              
                           
                        
                     

The log Categorical expectation under a generalised Dirichlet is,
                              
                                 (B.6)
                                 
                                    
                                       
                                          E
                                       
                                       
                                          
                                             
                                                q
                                             
                                             
                                                π
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             log
                                             p
                                             
                                                
                                                   
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            jin
                                                         
                                                      
                                                      =
                                                      k
                                                      |
                                                      
                                                         
                                                            π
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          E
                                       
                                       
                                          
                                             
                                                q
                                             
                                             
                                                π
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             log
                                             
                                                
                                                   π
                                                
                                                
                                                   jt
                                                
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          E
                                       
                                       
                                          
                                             
                                                q
                                             
                                             
                                                v
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             log
                                             
                                                
                                                   v
                                                
                                                
                                                   jt
                                                
                                             
                                          
                                       
                                    
                                    +
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             s
                                             =
                                             1
                                          
                                          
                                             t
                                             -
                                             1
                                          
                                       
                                    
                                    
                                       
                                          E
                                       
                                       
                                          
                                             
                                                q
                                             
                                             
                                                v
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             log
                                             (
                                             1
                                             -
                                             
                                                
                                                   v
                                                
                                                
                                                   js
                                                
                                             
                                             )
                                          
                                       
                                    
                                    ,
                                 
                              
                           where
                              
                                 (B.7)
                                 
                                    
                                       
                                          E
                                       
                                       
                                          
                                             
                                                q
                                             
                                             
                                                v
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             log
                                             
                                                
                                                   v
                                                
                                                
                                                   jt
                                                
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ψ
                                                      
                                                         
                                                            (
                                                         
                                                         
                                                            ̃
                                                         
                                                      
                                                      
                                                         
                                                            a
                                                         
                                                         
                                                            jt
                                                         
                                                      
                                                      )
                                                      -
                                                      ψ
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           a
                                                                        
                                                                        
                                                                           ̃
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     jt
                                                                  
                                                               
                                                               +
                                                               
                                                                  
                                                                     
                                                                        
                                                                           b
                                                                        
                                                                        
                                                                           ̃
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     jt
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      if
                                                      
                                                      t
                                                      <
                                                      T
                                                   
                                                
                                                
                                                   
                                                      0
                                                   
                                                   
                                                      if
                                                      
                                                      t
                                                      =
                                                      T
                                                      ,
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 
                                    
                                       
                                          
                                             a
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       jt
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       
                                          
                                             b
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       jt
                                    
                                 
                              
                            are given in (20).
                              
                                 (B.8)
                                 
                                    
                                       
                                          E
                                       
                                       
                                          
                                             
                                                q
                                             
                                             
                                                v
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             log
                                             (
                                             1
                                             -
                                             
                                                
                                                   v
                                                
                                                
                                                   jt
                                                
                                             
                                             )
                                          
                                       
                                    
                                    =
                                    ψ
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   jt
                                                
                                             
                                          
                                       
                                    
                                    -
                                    ψ
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   jt
                                                
                                             
                                             +
                                             
                                                
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   jt
                                                
                                             
                                          
                                       
                                    
                                    
                                    if
                                    
                                    t
                                    <
                                    T
                                    .
                                 
                              
                           
                        

The expectations of the model complexity penalty terms can be factorised,
                              
                                 (B.9)
                                 
                                    
                                       
                                          E
                                       
                                       
                                          
                                             
                                                q
                                             
                                             
                                                π
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             log
                                             
                                                
                                                   GDir
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  π
                                                               
                                                               
                                                                  j
                                                               
                                                            
                                                            |
                                                            a
                                                            ,
                                                            b
                                                         
                                                      
                                                   
                                                
                                                
                                                   q
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  π
                                                               
                                                               
                                                                  j
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             t
                                             =
                                             1
                                          
                                          
                                             T
                                             -
                                             1
                                          
                                       
                                    
                                    
                                       
                                          E
                                       
                                       
                                          
                                             
                                                q
                                             
                                             
                                                π
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             log
                                             
                                                
                                                   p
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  π
                                                               
                                                               
                                                                  jt
                                                               
                                                            
                                                            |
                                                            a
                                                            ,
                                                            b
                                                         
                                                      
                                                   
                                                
                                                
                                                   q
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  π
                                                               
                                                               
                                                                  jt
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    ,
                                 
                              
                           where
                              
                                 (B.10)
                                 
                                    
                                       
                                          E
                                       
                                       
                                          
                                             
                                                q
                                             
                                             
                                                π
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             log
                                             
                                                
                                                   p
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  π
                                                               
                                                               
                                                                  jt
                                                               
                                                            
                                                            |
                                                            a
                                                            ,
                                                            b
                                                         
                                                      
                                                   
                                                
                                                
                                                   q
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  π
                                                               
                                                               
                                                                  jt
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    =
                                    -
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   jt
                                                
                                             
                                             -
                                             a
                                          
                                       
                                    
                                    
                                       
                                          E
                                       
                                       
                                          
                                             
                                                q
                                             
                                             
                                                v
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             log
                                             
                                                
                                                   v
                                                
                                                
                                                   jt
                                                
                                             
                                          
                                       
                                    
                                    -
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   jt
                                                
                                             
                                             -
                                             b
                                          
                                       
                                    
                                    
                                       
                                          E
                                       
                                       
                                          
                                             
                                                q
                                             
                                             
                                                v
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             log
                                             (
                                             1
                                             -
                                             
                                                
                                                   v
                                                
                                                
                                                   jt
                                                
                                             
                                             )
                                          
                                       
                                    
                                    +
                                    log
                                    Γ
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   jt
                                                
                                             
                                          
                                       
                                    
                                    -
                                    log
                                    Γ
                                    (
                                    a
                                    )
                                    +
                                    log
                                    Γ
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   jt
                                                
                                             
                                          
                                       
                                    
                                    -
                                    log
                                    Γ
                                    (
                                    b
                                    )
                                    -
                                    log
                                    Γ
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   jt
                                                
                                             
                                             +
                                             
                                                
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   jt
                                                
                                             
                                          
                                       
                                    
                                    +
                                    log
                                    Γ
                                    (
                                    a
                                    +
                                    b
                                    )
                                    .
                                 
                              
                           The free energy penalty term over the weights in Eq. (B.10) only sums to 
                              
                                 T
                                 -
                                 1
                              
                            (degrees of freedom).

Gaussian distributions are often used to describe segment clusters
                           2
                           These equations are almost the same for the image clusters, so they are omitted.
                        
                        
                           2
                         in this paper, which take the form,
                           
                              (B.11)
                              
                                 N
                                 
                                    
                                       
                                          
                                             
                                                x
                                             
                                             
                                                jin
                                             
                                          
                                          |
                                          
                                             
                                                μ
                                             
                                             
                                                k
                                             
                                          
                                          ,
                                          
                                             
                                                Λ
                                             
                                             
                                                k
                                             
                                             
                                                -
                                                1
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       ∣
                                       
                                          
                                             Λ
                                          
                                          
                                             k
                                          
                                       
                                       
                                          
                                             ∣
                                          
                                          
                                             1
                                             /
                                             2
                                          
                                       
                                    
                                    
                                       
                                          
                                             (
                                             2
                                             π
                                             )
                                          
                                          
                                             D
                                             /
                                             2
                                          
                                       
                                    
                                 
                                 ×
                                 exp
                                 
                                    
                                       
                                          -
                                          
                                             
                                                1
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            jin
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            μ
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                ⊤
                                             
                                          
                                          
                                             
                                                Λ
                                             
                                             
                                                k
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         jin
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         μ
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        A Gaussian–Wishart prior is placed over the parameters,
                           
                              (B.12)
                              
                                 N
                                 
                                    
                                       
                                          
                                             
                                                μ
                                             
                                             
                                                k
                                             
                                          
                                          |
                                          m
                                          ,
                                          
                                             
                                                
                                                   
                                                      γ
                                                      
                                                         
                                                            Λ
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                -
                                                1
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   γ
                                                   
                                                      
                                                         Λ
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             1
                                             /
                                             2
                                          
                                       
                                    
                                    
                                       
                                          
                                             (
                                             2
                                             π
                                             )
                                          
                                          
                                             D
                                             /
                                             2
                                          
                                       
                                    
                                 
                                 ×
                                 exp
                                 
                                    
                                       
                                          -
                                          
                                             
                                                γ
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            μ
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      -
                                                      m
                                                   
                                                
                                             
                                             
                                                ⊤
                                             
                                          
                                          
                                             
                                                Λ
                                             
                                             
                                                k
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         μ
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   -
                                                   m
                                                
                                             
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              (B.13)
                              
                                 W
                                 
                                    
                                       
                                          
                                             
                                                Λ
                                             
                                             
                                                k
                                             
                                          
                                          |
                                          Ω
                                          ,
                                          ρ
                                       
                                    
                                 
                                 =
                                 
                                    
                                       ∣
                                       
                                          
                                             Λ
                                          
                                          
                                             k
                                          
                                       
                                       
                                          
                                             ∣
                                          
                                          
                                             
                                                
                                                   ρ
                                                   -
                                                   D
                                                   -
                                                   1
                                                
                                             
                                             /
                                             2
                                          
                                       
                                    
                                    
                                       
                                          
                                             2
                                          
                                          
                                             ρ
                                             D
                                             /
                                             2
                                          
                                       
                                       ∣
                                       Ω
                                       
                                          
                                             ∣
                                          
                                          
                                             ρ
                                             /
                                             2
                                          
                                       
                                       
                                          
                                             Γ
                                          
                                          
                                             D
                                          
                                       
                                       
                                          
                                             ρ
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 ×
                                 exp
                                 
                                    
                                       
                                          -
                                          
                                             
                                                1
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         Ω
                                                      
                                                      
                                                         -
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         Λ
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        where 
                           
                              
                                 
                                    Γ
                                 
                                 
                                    D
                                 
                              
                              (
                              ·
                              )
                           
                         is a multivariate Gamma function,
                           
                              (B.14)
                              
                                 
                                    
                                       Γ
                                    
                                    
                                       D
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                ρ
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       π
                                    
                                    
                                       D
                                       
                                          
                                             
                                                D
                                                -
                                                1
                                             
                                          
                                       
                                       /
                                       4
                                    
                                 
                                 
                                    
                                       
                                          ∏
                                       
                                       
                                          d
                                          =
                                          1
                                       
                                       
                                          D
                                       
                                    
                                 
                                 Γ
                                 
                                    
                                       
                                          
                                             
                                                ρ
                                                +
                                                1
                                                -
                                                d
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        
                     

The log Gaussian expectation under a Gaussian–Wishart prior is,
                              
                                 (B.15)
                                 
                                    
                                       
                                          E
                                       
                                       
                                          
                                             
                                                q
                                             
                                             
                                                μ
                                                ,
                                                Λ
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             log
                                             N
                                             
                                                
                                                   
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            jin
                                                         
                                                      
                                                      |
                                                      
                                                         
                                                            μ
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            Λ
                                                         
                                                         
                                                            k
                                                         
                                                         
                                                            -
                                                            1
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          E
                                       
                                       
                                          
                                             
                                                q
                                             
                                             
                                                Λ
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             log
                                             
                                                
                                                   
                                                      
                                                         
                                                            Λ
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    -
                                    
                                       
                                          D
                                       
                                       
                                          2
                                          
                                             
                                                
                                                   
                                                      γ
                                                   
                                                   
                                                      ̃
                                                   
                                                
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                    -
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ρ
                                                   
                                                   
                                                      ̃
                                                   
                                                
                                             
                                             
                                                k
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      jin
                                                   
                                                
                                                -
                                                
                                                   
                                                      
                                                         
                                                            m
                                                         
                                                         
                                                            ̃
                                                         
                                                      
                                                   
                                                   
                                                      k
                                                   
                                                
                                             
                                          
                                       
                                       
                                          ⊤
                                       
                                    
                                    
                                       
                                          
                                             
                                                Ω
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          k
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   jin
                                                
                                             
                                             -
                                             
                                                
                                                   
                                                      
                                                         m
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   k
                                                
                                             
                                          
                                       
                                    
                                    ,
                                 
                              
                           where
                              
                                 (B.16)
                                 
                                    
                                       
                                          E
                                       
                                       
                                          
                                             
                                                q
                                             
                                             
                                                Λ
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             log
                                             
                                                
                                                   
                                                      
                                                         
                                                            Λ
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             d
                                             =
                                             1
                                          
                                          
                                             D
                                          
                                       
                                    
                                    ψ
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               ρ
                                                            
                                                            
                                                               ̃
                                                            
                                                         
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   +
                                                   1
                                                   -
                                                   d
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                    +
                                    D
                                    log
                                    2
                                    +
                                    log
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         Ω
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   k
                                                
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           all of the posterior parameters (
                              
                                 
                                    
                                       ·
                                    
                                    
                                       ̃
                                    
                                 
                              
                           ) are from (21).

The expectations of the model complexity penalty terms are,
                              
                                 (B.17)
                                 
                                    
                                       
                                          E
                                       
                                       
                                          
                                             
                                                q
                                             
                                             
                                                μ
                                                ,
                                                Λ
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             log
                                             
                                                
                                                   N
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  μ
                                                               
                                                               
                                                                  k
                                                               
                                                            
                                                            |
                                                            m
                                                            ,
                                                            
                                                               
                                                                  
                                                                     
                                                                        γ
                                                                        
                                                                           
                                                                              Λ
                                                                           
                                                                           
                                                                              k
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                               
                                                                  -
                                                                  1
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   W
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  Λ
                                                               
                                                               
                                                                  k
                                                               
                                                            
                                                            |
                                                            Ω
                                                            ,
                                                            ρ
                                                         
                                                      
                                                   
                                                
                                                
                                                   q
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  μ
                                                               
                                                               
                                                                  k
                                                               
                                                            
                                                            ,
                                                            
                                                               
                                                                  Λ
                                                               
                                                               
                                                                  k
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    =
                                    -
                                    
                                       
                                          D
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   γ
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               γ
                                                            
                                                            
                                                               ̃
                                                            
                                                         
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                
                                             
                                             -
                                             log
                                             
                                                
                                                   γ
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               γ
                                                            
                                                            
                                                               ̃
                                                            
                                                         
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                
                                             
                                             -
                                             
                                                
                                                   
                                                      
                                                         ρ
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   k
                                                
                                             
                                             -
                                             1
                                          
                                       
                                    
                                    -
                                    
                                       
                                          ρ
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          
                                             log
                                             
                                                
                                                   
                                                      Ω
                                                   
                                                
                                             
                                             -
                                             log
                                             |
                                             
                                                
                                                   
                                                      
                                                         Ω
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   k
                                                
                                             
                                             |
                                          
                                       
                                    
                                    -
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ρ
                                                   
                                                   
                                                      ̃
                                                   
                                                
                                             
                                             
                                                k
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   Ω
                                                
                                                
                                                   -
                                                   1
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         Ω
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   k
                                                
                                             
                                          
                                       
                                    
                                    -
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ρ
                                                   
                                                   
                                                      ̃
                                                   
                                                
                                             
                                             
                                                k
                                             
                                          
                                          γ
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            m
                                                         
                                                         
                                                            ̃
                                                         
                                                      
                                                   
                                                   
                                                      k
                                                   
                                                
                                                -
                                                m
                                             
                                          
                                       
                                       
                                          ⊤
                                       
                                    
                                    
                                       
                                          
                                             
                                                Ω
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          k
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         m
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   k
                                                
                                             
                                             -
                                             m
                                          
                                       
                                    
                                    -
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             d
                                             =
                                             1
                                          
                                          
                                             D
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                             ψ
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        ρ
                                                                     
                                                                     
                                                                        ̃
                                                                     
                                                                  
                                                               
                                                               
                                                                  k
                                                               
                                                            
                                                            +
                                                            1
                                                            -
                                                            d
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                             
                                             +
                                             log
                                             Γ
                                             
                                                
                                                   
                                                      
                                                         
                                                            ρ
                                                            +
                                                            1
                                                            -
                                                            d
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                             
                                             -
                                             log
                                             Γ
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        ρ
                                                                     
                                                                     
                                                                        ̃
                                                                     
                                                                  
                                                               
                                                               
                                                                  k
                                                               
                                                            
                                                            +
                                                            1
                                                            -
                                                            d
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           
                        

The greedy splitting heuristic is based on two criteria. The first is the approximate free energy contribution of the segment cluster parameters and segment observations to be split. The second is how many split attempts have been tried for the segment cluster and not been accepted previously. The cluster split attempts are ordered by (a) least number of previous split attempts for the clusters, then (b) clusters with more free energy contribution. The first attempt that reduces model free energy is accepted. The approximate contribution to free energy is formulated from the heuristic,
                        
                           (C.1)
                           
                              
                                 
                                    
                                       
                                          F
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    k
                                 
                              
                              =
                              
                                 
                                    E
                                 
                                 
                                    
                                       
                                          q
                                       
                                       
                                          μ
                                          ,
                                          Λ
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       log
                                       
                                          
                                             N
                                             
                                                
                                                   
                                                      
                                                         
                                                            μ
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      |
                                                      m
                                                      ,
                                                      
                                                         
                                                            
                                                               
                                                                  γ
                                                                  
                                                                     
                                                                        Λ
                                                                     
                                                                     
                                                                        k
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            -
                                                            1
                                                         
                                                      
                                                   
                                                
                                             
                                             W
                                             
                                                
                                                   
                                                      
                                                         
                                                            Λ
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      |
                                                      Ω
                                                      ,
                                                      ρ
                                                   
                                                
                                             
                                          
                                          
                                             q
                                             
                                                
                                                   
                                                      
                                                         
                                                            μ
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            Λ
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              +
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       J
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       
                                          
                                             I
                                          
                                          
                                             j
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       n
                                       =
                                       1
                                    
                                    
                                       
                                          
                                             N
                                          
                                          
                                             ji
                                          
                                       
                                    
                                 
                              
                              q
                              
                                 
                                    
                                       
                                          
                                             z
                                          
                                          
                                             jin
                                          
                                       
                                       =
                                       k
                                    
                                 
                              
                              
                                 
                                    L
                                 
                                 
                                    
                                       
                                          z
                                       
                                       
                                          jin
                                       
                                    
                                    =
                                    k
                                 
                              
                           
                        
                     where 
                        
                           
                              
                                 L
                              
                              
                                 
                                    
                                       z
                                    
                                    
                                       jin
                                    
                                 
                                 =
                                 k
                              
                           
                        
                      is the mixture likelihood of observation 
                        
                           
                              
                                 x
                              
                              
                                 jin
                              
                           
                        
                      under segment cluster k (including the effect of the mixture weights). This likelihood is weighted by the observation’s probabilistic membership to cluster k. For the SCM and MCM the exact form of this heuristic is,
                        
                           (C.2)
                           
                              
                                 
                                    
                                       
                                          F
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    k
                                 
                              
                              =
                              
                                 
                                    E
                                 
                                 
                                    
                                       
                                          q
                                       
                                       
                                          μ
                                          ,
                                          Λ
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       log
                                       
                                          
                                             N
                                             
                                                
                                                   
                                                      
                                                         
                                                            μ
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      |
                                                      m
                                                      ,
                                                      
                                                         
                                                            
                                                               
                                                                  γ
                                                                  
                                                                     
                                                                        Λ
                                                                     
                                                                     
                                                                        k
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            -
                                                            1
                                                         
                                                      
                                                   
                                                
                                             
                                             W
                                             
                                                
                                                   
                                                      
                                                         
                                                            Λ
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      |
                                                      Ω
                                                      ,
                                                      ρ
                                                   
                                                
                                             
                                          
                                          
                                             q
                                             
                                                
                                                   
                                                      
                                                         
                                                            μ
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            Λ
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              +
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       J
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       
                                          
                                             I
                                          
                                          
                                             j
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       n
                                       =
                                       1
                                    
                                    
                                       
                                          
                                             N
                                          
                                          
                                             ji
                                          
                                       
                                    
                                 
                              
                              q
                              
                                 
                                    
                                       
                                          
                                             z
                                          
                                          
                                             jin
                                          
                                       
                                       =
                                       k
                                    
                                 
                              
                              
                                 
                                    E
                                 
                                 
                                    
                                       
                                          q
                                       
                                       
                                          μ
                                          ,
                                          Λ
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       log
                                       N
                                       
                                          
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      jin
                                                   
                                                
                                                |
                                                
                                                   
                                                      μ
                                                   
                                                   
                                                      k
                                                   
                                                
                                                ,
                                                
                                                   
                                                      Λ
                                                   
                                                   
                                                      k
                                                   
                                                   
                                                      -
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              .
                           
                        
                     A cluster weight term was not included in Eq. (C.2) because a corresponding term of opposite sign existed in the last term in Eq. (A.2), and adding it would nullify its effect in the overall model free energy. Whereas the heuristic for G-LDA applied to segment clustering is,
                        
                           (C.3)
                           
                              
                                 
                                    
                                       
                                          F
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    k
                                 
                              
                              =
                              
                                 
                                    E
                                 
                                 
                                    
                                       
                                          q
                                       
                                       
                                          μ
                                          ,
                                          Λ
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       log
                                       
                                          
                                             N
                                             
                                                
                                                   
                                                      
                                                         
                                                            μ
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      |
                                                      m
                                                      ,
                                                      
                                                         
                                                            
                                                               
                                                                  γ
                                                                  
                                                                     
                                                                        Λ
                                                                     
                                                                     
                                                                        k
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            -
                                                            1
                                                         
                                                      
                                                   
                                                
                                             
                                             W
                                             
                                                
                                                   
                                                      
                                                         
                                                            Λ
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      |
                                                      Ω
                                                      ,
                                                      ρ
                                                   
                                                
                                             
                                          
                                          
                                             q
                                             
                                                
                                                   
                                                      
                                                         
                                                            μ
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            Λ
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              +
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       I
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       n
                                       =
                                       1
                                    
                                    
                                       
                                          
                                             N
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                              
                              q
                              
                                 
                                    
                                       
                                          
                                             z
                                          
                                          
                                             in
                                          
                                       
                                       =
                                       k
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             E
                                          
                                          
                                             
                                                
                                                   q
                                                
                                                
                                                   π
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                log
                                                
                                                   
                                                      π
                                                   
                                                   
                                                      ik
                                                   
                                                
                                             
                                          
                                       
                                       +
                                       
                                          
                                             E
                                          
                                          
                                             
                                                
                                                   q
                                                
                                                
                                                   μ
                                                   ,
                                                   Λ
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                log
                                                N
                                                
                                                   
                                                      
                                                         
                                                            
                                                               x
                                                            
                                                            
                                                               in
                                                            
                                                         
                                                         |
                                                         
                                                            
                                                               μ
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               Λ
                                                            
                                                            
                                                               k
                                                            
                                                            
                                                               -
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              ,
                           
                        
                     which includes a cluster weight term.

The observations belonging to a Gaussian (with 
                        
                           q
                           
                              
                                 
                                    
                                       
                                          z
                                       
                                       
                                          jin
                                       
                                    
                                    =
                                    k
                                 
                              
                           
                           >
                           0.5
                        
                     ) are split in a direction perpendicular to its principal Eigenvector. This split is refined by iterating the VBE and VBM steps on only these observations. The algorithm is summarised in Algorithm 1 for the MCM, the SCM is similar but does not include 
                        
                           W
                        
                     . The expected model free energy, 
                        
                           E
                           
                              
                                 
                                    
                                       
                                          F
                                       
                                       
                                          split
                                          ,
                                          k
                                       
                                    
                                 
                              
                           
                        
                      is acquired by running variational Bayes for one iteration, with the new split, using all of the segment observations. To our knowledge this is the first time a split tally has been used in a cluster splitting heuristic. It was found to significantly reduce the run time of the algorithm and improve results over just using approximate free energy to guide the greedy search. This greedy cluster splitting heuristic often less than halved the run time of the total algorithm compared to the exhaustive cluster splitting heuristic. This speed-up was even more pronounced for the larger datasets. It also managed to maintain good clustering results compared to the exhaustive heuristic.
                        Algorithm 1
                        The MCM greedy model selection heuristic 
                              
                                 
                              
                           
                        

@&#REFERENCES@&#

