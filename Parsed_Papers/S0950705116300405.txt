@&#MAIN-TITLE@&#An accurate infrared hand geometry and vein pattern based authentication system

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           An acquisition system is designed to simultaneously acquire palm dorsal vein and infrared (IR) hand geometry.


                        
                        
                           
                           A novel quality parameter is proposed for palm dorsal vein.


                        
                        
                           
                           A quality based variational approach is proposed for vein extraction that can handle hair, skin texture and variable width veins.


                        
                        
                           
                           Several IR hand features are extracted accurately even in absence of texture and consolidated.


                        
                        
                           
                           The proposed system exhibits better performance than state of the art systems and unimodal systems.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Multi-biometrics

Variational fusion

Vein eExtraction

Quality

@&#ABSTRACT@&#


               
               
                  In this paper, hand dorsal images acquired under infrared light are used to design an accurate personal authentication system. Each of the image is segmented into palm dorsal and fingers which are subsequently used to extract palm dorsal veins and infrared hand geometry features respectively. A new quality estimation algorithm is proposed to estimate the quality of palm dorsal which assigns low values to the pixels containing hair or skin texture. Palm dorsal is enhanced using filtering. For vein extraction, information provided by the enhanced image and the vein quality is consolidated using a variational approach. The proposed vein extraction can handle the issues of hair, skin texture and variable width veins so as to extract the genuine veins accurately. Several post processing techniques are introduced in this paper for accurate feature extraction of infrared hand geometry features. Matching scores are obtained by matching palm dorsal veins and infrared hand geometry features. These are eventually fused for authentication. For performance evaluation, a database of 1500 hand images acquired from 300 different hands is created. Experimental results demonstrate the superiority of the proposed system over existing systems.
               
            

@&#INTRODUCTION@&#

In today’s digital age, technologies are rapidly evolving both in terms of hardware and software due to which information security is a major concern. Traditional authentication systems based on possession (like keys) or knowledge (like password) are not much advantageous to provide the security because these systems can be easily transferred, forged, lost or forgot. However, biometric based authentication systems are proliferating, which handle these issues using behavioral and physiological characteristics of the user [11]. In this paper, infrared (IR) hand dorsal images are used for authentication, which consists of two biometric traits, viz., palm dorsal veins and IR hand geometry. Hand dorsal refers to the back side of hand and palm dorsal vein refers the pattern formed by the subcutaneous blood vessels present in the palm dorsal, i.e., the area behind the palm. The following factors provide the motivation for the fusion of palm-dorsal vein and IR hand geometry:

                        
                           1.
                           Palm dorsal vein pattern possesses all the necessary characteristics required in an authentication system, like, universality, permanence, acceptability and distinctiveness [7]. Moreover, its applicability in authentication is further enhanced due to the following factors: (i) it assures liveness [44]; (ii) it is difficult to spoof because it lies inside skin; and (iii) it can be easily and instantaneously acquired by low cost sensors in a user friendly manner. Due to these factors, palm dorsal veins are used in this paper.

Hand images can be easily acquired using a low cost camera and hand features can be easily and accurately extracted from the images. Moreover, it is easily accepted and possessed by most of the users [49]. Also, hand shape is shown to be distinctive in nature even though to a smaller extend than palm dorsal veins [48]. In addition, hand shape does not change much with the time [40]. However, detecting accurate hand boundary is a challenging task, but it can be easily handled by acquiring the images in IR light [28]. Thus, IR hand geometry is used in this paper.

Applicability of a multi-modal system depends upon performance improvement, acquisition cost (in terms of sensor cost and time) and user friendliness. Palm dorsal vein and IR hand geometry can be acquired using a low cost sensor, which makes the proposed system highly user-friendly and time inexpensive [2].

An accurate IR hand dorsal based authentication system is presented in this paper. It uses a low cost acquisition setup for acquiring IR hand dorsal images in an unconstrained and contact-less manner. Each acquired image is segmented into palm dorsal and fingers, which are used to extract palm dorsal vein and IR hand geometry features respectively. Matching scores obtained by matching the palm dorsal vein and the IR hand geometry features, are eventually consolidated for authentication. The main research contributions of the paper are:

                        
                           1.
                           Existing quality approaches assign a global quality score to the vein image. These aim to reject the poor quality images during matching for enhancing the performance. These can assign high values to the pixels containing hair. In this paper, a new quality approach is proposed for palm dorsal veins which assigns the quality at each pixel and use it for vein extraction. It is formed by consolidating an anisotropic measure local range and the existing quality measure gradient [47]. It assigns high values to vein pixels and low values to the remaining pixels, especially to the pixels containing hair.

Spurious veins can be generated or genuine veins can be missed in the existing systems due to non-uniform illumination, hair, skin texture and variable width veins. The major contribution of this paper is that of accurate vein extraction. Initially, multi-scale matched filtering is used to enhance variable width veins. Veins are extracted from the enhanced image using a variational approach and the vein quality.

Texture present at the interphalangeal joints of hand dorsal is not acquired in IR hand images. Several existing IR hand geometry features like finger profile [29] and triangles [25], require this texture information for accurate feature extraction. In the paper, stable features like finger length and finger width are used. Often these cannot be accurately determined, thus some post processing techniques are applied. Moreover, various well known IR hand geometry features are rigorously analyzed and the factors which limit their efficacy are discussed.

This paper is organized as follows. Some well-known palm dorsal vein and IR hand geometry systems have been described in the next section. Section 3 discusses some well-known algorithms that are used to design the proposed vein quality. The proposed system has been described in Section 4. Its efficacy has been analyzed in the next section. Conclusions are presented in the last section.

@&#RELATED WORK@&#

In this section, palm dorsal vein and IR hand geometry based systems are described.

Usually, a palm dorsal vein based authentication system consists of quality estimation, vein extraction and vein matching.

Quality plays a crucial role in a biometric based authentication. It is experimentally shown in [33] that the performance decreases as the quality of vein images are degraded. Some of the useful measures for vein recognition are: (1) gradient which measures the clarity in the orientation of the vein pattern structure [47]; (2) contrast which measures the brightness variation [19]; and (3) entropy which measures the dispersion in the image intensities [31]. These quality measures assign high values to good quality palm dorsal vein images however, it can also assign high values to the pixels containing hair or skin texture. These assign a global quality score to a vein image which is used to classify the image as good or poor quality images. The performance of a system is increased by rejecting the poor quality images during matching.

Palm dorsal image may contain low local contrast, non-uniform illumination and noise due to hair and skin texture. These problems should be minimized prior to vein extraction otherwise spurious veins can be generated or genuine veins can be missed. Line tracking algorithm [26] can be used for vein enhancement. It is based on the principle that vein pixels contain a local minima, as opposed to the background and thus, a vein pixel can be tracked from several other nearby vein pixels. Since thin veins can be tracked from a relatively fewer number of locations, it is possible that they are ignored. Moreover, several pixels containing noise due to hair and skin texture also contain local minima and thus, sometimes these are spuriously marked as vein pixels. Various filtering algorithms can also be used vein enhancement like Gabor filter [6], Steerable filter [46] and Matched filter [25]. For effective enhancement, the filter must correspond to the shape of vein in a local neighborhood. Unfortunately, palm dorsal images contain variable width veins and thus, a single filter cannot be accurately designed for enhancement. Motivated by this, a multi-scale matched filtering algorithm is proposed in [13] where several filters are designed corresponding to different shapes of vein pattern and the filter responses for these filters are consolidated to enhance variable width veins. Eventually, veins are extracted from the enhanced image using threshold based algorithm [16]. It is possible that pixels containing noise due to hair and skin texture can be spuriously marked as vein pixels in the filtering based algorithm.

Veins can be matched by local feature matching. Local features are the points which are invariant to geometrical transformations like vein bifurcations and endings [22]. Vein minutiae can be matched by line segment hausdorff distance (LHD) [41] and the modified hausdorff distance (MHD) [42] but these are extremely sensitive to geometrical transformations. Moreover, the usage of minutiae features for vein matching is limited, due to (1) lack of availability of genuine minutiae sometimes; (2) problems in determining the location of minutiae accurately; and (3) the hair and texture in the image inducing spurious minutiae points in some cases. Another approach to vein matching is based on global feature matching. One way to do so is to perform a pixel-to-pixel matching [12]. Another way for global matching involves matching of local binary patterns using chi-square statistic [43]. Phase information can also be used as global features [16]. The global matching can give erroneous results when (1) thin vein patterns are missed; (2) spurious veins are generated due to hair, non-uniform illumination and skin texture; and (3) localization of extracted vein is erroneous.

A hand shape based authentication system uses the information derived from a hand silhouette [49]. It requires hand silhouette based matching where two silhouettes are aligned prior to matching. Accurate hand silhouette alignment is not possible when fingers are opened or closed in different ways which is usually the case when images are acquired under unconstrained environment [1]. Hence, geometric features of hand silhouette are usually preferred for the matching. Some well-known geometric features are finger lengths, finger widths, finger profile and area of hand [49]. Systems relying on matching such features are referred as hand geometry based system. One of the main problems with any hand based system is that of segmenting the accurate hand silhouette when images are acquired in visible light and varying backgrounds. This problem is solved in [28] by acquiring hand image in IR light instead of visible light. Various IR hand geometry features can be used for matching like finger length, finger width and triangles [25]. The features can be matched using Principal Component Analysis (PCA) [29].

Previously, palm-dorsal vein and hand geometry are fused in [25,29]. In [25], matched filtering and global vein matching are used to obtain the vein matching score. In addition, various hand geometry features are matched using the Euclidean distance. Eventually, obtained matching scores of vein and hand geometry are fused using linear discriminant analysis. Similarly, in [29], palm-dorsal vein, side-finger geometry and hand geometry are fused. It follows the same procedure, except that Gabor filtering is used for vein extraction and score level fusion based on z-score normalization is used for fusion. It is important to note that setups used in these systems have pegs (i.e., constrained environment) which allow the use of various finger geometric features and simple vein matching for accurate matching. However, both these systems may not perform accurately for the images acquired under unconstrained environment.

In this paper, two well-known algorithms are used for estimating the vein quality, viz., gradient based vein quality estimation and local range of an image.

Gradient is an effective way to measure the directional component in an image by analyzing the orientation field [17]. It is observed that clarity in the structure of vein pixels indicates a strong directional component, while the background pixels consisting of similar intensity values lack directional component. To reduce the time computation, image I is segmented into non-overlapping blocks and gradients of these blocks are estimated using Sobel filter. Assume that the horizontal and vertical gradients of a block, Bq
                         is denoted by dx and 
                           
                              d
                              y
                              ,
                           
                         respectively. Covariance matrix C of Bq
                         is:

                           
                              (1)
                              
                                 
                                    C
                                    =
                                    
                                       1
                                       N
                                    
                                    
                                       ∑
                                       N
                                    
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   [
                                                   
                                                      
                                                         
                                                            
                                                               d
                                                               x
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               d
                                                               y
                                                            
                                                         
                                                      
                                                   
                                                   ]
                                                
                                             
                                             
                                                
                                                   [
                                                   
                                                      
                                                         
                                                            
                                                               d
                                                               x
                                                            
                                                         
                                                         
                                                            
                                                               d
                                                               y
                                                            
                                                         
                                                      
                                                   
                                                   ]
                                                
                                             
                                          
                                       
                                       }
                                    
                                    =
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   c
                                                   
                                                      x
                                                      x
                                                   
                                                
                                             
                                             
                                                
                                                   c
                                                   
                                                      x
                                                      y
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   c
                                                   
                                                      y
                                                      x
                                                   
                                                
                                             
                                             
                                                
                                                   c
                                                   
                                                      y
                                                      y
                                                   
                                                
                                             
                                          
                                       
                                       ]
                                    
                                 
                              
                           
                        where cxx, cyy, cxy, cyx
                         are the elements of covariance matrix, C. Eigenvalues λa
                         and λb
                         are obtained by solving the characteristic polynomial of C 
                        [15]. That is:

                           
                              (2)
                              
                                 
                                    
                                       λ
                                       a
                                    
                                    =
                                    
                                       
                                          
                                             c
                                             
                                                x
                                                x
                                             
                                          
                                          +
                                          
                                             c
                                             
                                                y
                                                y
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   
                                                      (
                                                      
                                                         c
                                                         
                                                            x
                                                            x
                                                         
                                                      
                                                      −
                                                      
                                                         c
                                                         
                                                            y
                                                            y
                                                         
                                                      
                                                      )
                                                   
                                                   2
                                                
                                                +
                                                4
                                                
                                                   c
                                                   
                                                      x
                                                      y
                                                   
                                                   2
                                                
                                             
                                          
                                       
                                       2
                                    
                                 
                              
                           
                        
                        
                           
                              (3)
                              
                                 
                                    
                                       λ
                                       b
                                    
                                    =
                                    
                                       
                                          
                                             c
                                             
                                                x
                                                x
                                             
                                          
                                          +
                                          
                                             c
                                             
                                                y
                                                y
                                             
                                          
                                          −
                                          
                                             
                                                
                                                   
                                                      (
                                                      
                                                         c
                                                         
                                                            x
                                                            x
                                                         
                                                      
                                                      −
                                                      
                                                         c
                                                         
                                                            y
                                                            y
                                                         
                                                      
                                                      )
                                                   
                                                   2
                                                
                                                +
                                                4
                                                
                                                   c
                                                   
                                                      x
                                                      y
                                                   
                                                   2
                                                
                                             
                                          
                                       
                                       2
                                    
                                 
                              
                           
                        Quality of block Bq
                         is given by

                           
                              (4)
                              
                                 
                                    
                                       Q
                                       B
                                    
                                    =
                                    
                                       
                                          (
                                          
                                             
                                                
                                                   λ
                                                   a
                                                
                                                −
                                                
                                                   λ
                                                   b
                                                
                                             
                                             
                                                
                                                   λ
                                                   a
                                                
                                                +
                                                
                                                   λ
                                                   b
                                                
                                             
                                          
                                          )
                                       
                                       2
                                    
                                    =
                                    
                                       
                                          
                                             
                                                (
                                                
                                                   c
                                                   
                                                      x
                                                      x
                                                   
                                                
                                                −
                                                
                                                   c
                                                   
                                                      y
                                                      y
                                                   
                                                
                                                )
                                             
                                             2
                                          
                                          +
                                          4
                                          
                                             c
                                             
                                                x
                                                y
                                             
                                             2
                                          
                                       
                                       
                                          
                                             (
                                             
                                                c
                                                
                                                   x
                                                   x
                                                
                                             
                                             +
                                             
                                                c
                                                
                                                   y
                                                   y
                                                
                                             
                                             )
                                          
                                          2
                                       
                                    
                                 
                              
                           
                        The blocks containing similar intensity values have similar values of λa
                         and λb
                         and thus, the quality of the block is small. On the other hand, block containing veins has high directional content and thus, the block has higher value of λa
                         than λb
                        , i.e, high value of quality. Unfortunately, the hair pixels also contain large directional components due to which high quality values are also assigned to them.

Local range [11] of an image is determined by analyzing the local neighborhoods of each pixel. For better understanding, consider an image containing a pixel p whose local range needs to be estimated. The local neighborhoods of p are defined as those pixels which are contained in a block centered at p and is of certain size. The local neighborhoods possessing the maximum and the minimum intensity values are determined and their intensity values are subtracted to obtain the local range of p. It is intuitive that the local range of a point is low if its local neighborhoods possess similar intensity values.

An IR hand dorsal based authentication system is proposed in this section. It fuses the palm dorsal veins and IR hand geometry for authentication. It consists of the following eight stages: (1) image acquisition, (2) preprocessing, (3) quality estimation, (4) vein extraction, (5) vein matching, (6) hand geometry feature extraction, (7) hand geometry matching, and (8) fusion. In the first stage, an acquisition setup is presented to acquire hand dorsal images. Each image is segmented into palm dorsal and fingers in the preprocessing stage. Pixel-wise quality of the palm dorsal is estimated in the next stage such that high values are assigned to vein pixels, while lower values are assigned to the pixels containing skin texture or hair. In the vein extraction stage, the palm dorsal image is enhanced and veins are extracted accurately from the enhanced image and the pixel-wise quality using a variational based algorithm. In the subsequent stage, vein matching score is generated using image registration based matching. Apart from palm dorsal veins, IR hand geometry is also used for authentication in the proposed system. Features are extracted from the segmented fingers in the hand geometry feature extraction stage. These are matched to generate IR hand geometry matching score in the next stage. In the last stage, the vein and IR hand geometry matching scores are fused. Flow-graph of the proposed system is shown in Fig. 1
                     .

The acquisition system designed for the acquiring hand dorsal images is shown in Fig. 2
                        (a). It consists of a wooden box, covered from all sides except one. Inside the box, a black colored plank is kept. The user hand can be placed on this plank, in an unconstrained manner. On top of the plank, a low cost camera is fixed. The camera is positioned such that it can acquire the whole plank. This enables the capturing of the full user hand. In order to minimize any effects of the visible light, an IR filter is also kept in front of the camera lens. The human hand is observed to emit an IR radiation of wavelength 3000–12,000 nm. These wavelengths cannot be acquired using the low cost camera and thus, an IR lamp is also placed along with the camera to illuminate the plank with radiations of wavelength 850 nm, which can be acquired by the camera. The complete arrangement can be termed as contact-less as the camera is not in direct contact with the hand [20]. To maintain consistency and uniformity in the acquisition process, the following aspects of the system are maintained as invariants: (1) the position of the plank, the IR lamp and the camera, with respect to each other; and (2) the properties of the camera in use like exposure time and focal length. A sample acquired from the system is shown in Fig. 2(b).

In this stage, an acquired IR hand image is segmented into palm dorsal area and fingers. In order to decrease the time, the acquired image, I is converted to gray-scale. I consists of regions that are not a part of the hand, i.e., background pixels which should be removed from the image. The foreground areas in I are identified by applying global thresholding [9]. These are clustered using eight-neighborhood connectivity [10]. Multiple components can be detected due to noise. The largest component is retained as the hand, while others are pruned. Let the image, thus obtained is denoted by IC
                        .

The existing domain knowledge about the hand geometry can be useful in extraction of the palm dorsal [36]. Canny edge detector is applied on IC
                         to obtain the hand boundary, Bh
                        . The process of detecting the hand type (left or right) involves finding two types of key-points in Bh
                        , namely fingertips and valley points. The contour tracing algorithm [35] is applied on Bh
                         to give these points as the local minimum and local maximum respectively. The intuition used to determine the hand type stems from the observation that the number of boundary pixels between the fingertips of the thumb and index finger, will be more as compared to that between the ring and little fingers.

To segment IC
                        , three more key-points are required to be detected. These are the endpoints of the thumb, the index finger and the little finger. The intuition used to find out these points is the observation that the distances of the two endpoints of a finger, to the fingertip are nearly equal. As an example, the fingertips, valley points and the extra key-points required for final cropping of the palm dorsal are shown in Fig. 3
                        (d) in red, blue and green points respectively. Fig. 3 show examples of the various described stages in the process.

Pixel-wise quality of palm dorsal is estimated in this section. An accurate quality estimation requires that high values are assigned to vein pixels, while lower values are assigned to the remaining pixels especially to the pixels containing hair. In this paper, gradient based quality estimation [47] is used to estimate the quality. Let QOC
                         denotes the gradient based quality of the palm dorsal area, 
                           
                              I
                              C
                              R
                           
                        . It assigns high values to vein pixels, but unfortunately it also assigns high values to the pixels containing hair, thus such pixels containing hair are determined and suppressed from the estimated quality. It is observed that the hairs present in the acquired images have low width and there is a high intensity difference between the black color hair pixel and the intensity of hand pixels. Due to low width hairs, it can be expected that few pixels represent hair while remaining ones belong to hand. This results in large difference between the maximum and the minimum intensity value of the local neighborhood of a hair pixel, i.e., hair pixels have high local range [11]. On the other hand, the local neighborhood of hand pixels contains similar intensity pixels thus, local range of hand pixels is low. Motivated by this, local range is applied at 
                           
                              I
                              C
                              R
                           
                         which assigns high values to hair pixels and low values otherwise. Let QLR
                         stores the local range of 
                           
                              I
                              C
                              R
                           
                        . Hair pixels are detected from QLR
                         using global threshold algorithm. Subsequently, morphological operations are applied to remove small holes and isolated blobs, if present. Assume that the resultant binary image is denoted GQ
                        . It contains 1 for pixels containing hair and 0 otherwise. Once the pixels containing hair are detected, these are removed from QOC
                         using

                           
                              (5)
                              
                                 
                                    Q
                                    =
                                    
                                       Q
                                       
                                          O
                                          C
                                       
                                    
                                    *
                                    
                                       (
                                       ∼
                                       
                                          G
                                          Q
                                       
                                       )
                                    
                                 
                              
                           
                        where Q is the estimated quality while ∼ and * denote NOT operator and pixel-wise multiplication respectively. All the steps required in the quality estimation of palm dorsal images are described in Algorithm 1
                        .

Multi-scale matched filtering [13] is applied on 
                           
                              I
                              C
                              R
                           
                         for palm dorsal vein enhancement because it can enhance the variable width veins. Let VE
                         denotes the resultant enhanced image. Unfortunately, noise due to hair and skin texture is also enhanced in VE
                         and thus, spurious veins can be generated if VE
                         is used for vein extraction. Thus, in this section, VE
                         is fused with the vein quality image (i.e., Q) using a variational approach for accurate vein extraction.

One way to look at VE
                         is this that there is an actual enhanced image which is corrupted by the noise due to hair and skin texture, that is:

                           
                              (6)
                              
                                 
                                    
                                       V
                                       E
                                    
                                    
                                       (
                                       x
                                       ,
                                       y
                                       )
                                    
                                    =
                                    V
                                    
                                       (
                                       x
                                       ,
                                       y
                                       )
                                    
                                    +
                                    E
                                    
                                       (
                                       x
                                       ,
                                       y
                                       )
                                    
                                 
                              
                           
                        where V and E represent the actual enhanced image and noise image respectively, while (x, y) denote pixel location. Genuine veins can be extracted from V if it satisfies the following requirements:

                           
                              1.
                              Both V and VE
                                  should have similar intensities of the genuine vein pixels, so that genuine vein structure is preserved in V.

However, V and VE
                                  should not have similar intensities at the spurious vein areas, i.e., the areas containing noise due to hair and skin texture. It is desirable that V should be interpolated using local neighborhood at the spurious vein areas.

It is observed that there are gradual changes in intensity values of veins and skin pixels, while abrupt changes in the intensities is mainly attributed to the noise pixels. Hence, V should be smooth in nature, i.e., it should satisfy the smoothness constraint.

The first two requirements can be met by defining an appropriate data fidelity constraint. Such a data fidelity constraint between V and VE
                         can be defined by minimizing the weighted sum of squared error where weights are given by Q. Thus, data fidelity constraint, F(V), is

                           
                              (7)
                              
                                 
                                    F
                                    
                                       (
                                       V
                                       )
                                    
                                    =
                                    
                                       ∫
                                       x
                                    
                                    
                                       ∫
                                       y
                                    
                                    Q
                                    
                                       
                                          (
                                          
                                             V
                                             E
                                          
                                          
                                             (
                                             x
                                             ,
                                             y
                                             )
                                          
                                          −
                                          V
                                          
                                             (
                                             x
                                             ,
                                             y
                                             )
                                          
                                          )
                                       
                                       2
                                    
                                    
                                       d
                                    
                                    x
                                    
                                    
                                       d
                                    
                                    y
                                 
                              
                           
                        where (x, y) denote pixel location. Likewise, smoothness constraint on V can be given by:

                           
                              (8)
                              
                                 
                                    G
                                    
                                       (
                                       V
                                       )
                                    
                                    =
                                    
                                       ∫
                                       x
                                    
                                    
                                       ∫
                                       y
                                    
                                    
                                       
                                          |
                                          ▽
                                          V
                                          
                                             (
                                             x
                                             ,
                                             y
                                             )
                                          
                                          |
                                       
                                       2
                                    
                                    
                                       d
                                    
                                    x
                                    
                                    
                                       d
                                    
                                    y
                                 
                              
                           
                        where

                           
                              (9)
                              
                                 
                                    ▽
                                    V
                                    
                                       (
                                       x
                                       ,
                                       y
                                       )
                                    
                                    =
                                    
                                       
                                          ∂
                                          V
                                          
                                             (
                                             x
                                             ,
                                             y
                                             )
                                          
                                       
                                       
                                          ∂
                                          x
                                       
                                    
                                    +
                                    
                                       
                                          ∂
                                          V
                                          
                                             (
                                             x
                                             ,
                                             y
                                             )
                                          
                                       
                                       
                                          ∂
                                          y
                                       
                                    
                                 
                              
                           
                        It can be seen that V can satisfy all the requirements that make it useful for genuine vein extraction if it simultaneously minimizing both F(V) and G(V). For a better understanding, consider the following cases. For genuine vein areas, Q contains large values and thus F(V) can be minimized only when V and VE
                         have similar intensity values in the areas, i.e., genuine veins are preserved. While in vein areas containing noise, Q has low values and thus F(V) is already small and it does not require that V and VE
                         possess similar intensity values in the areas containing noise. In the areas containing noise, interpolation using local neighborhood can be enforced using smoothness constraint, G(V). Moreover, minimization of G(V) imposes smoothness constraint on VE
                        .

Simultaneously minimization of F(V) and G(V) is not trivial because they have competitive nature. In other words, F(V) can be minimized when intensities of V and VE
                         are equal at each vein pixel, but it increases the value of G(V) due to breach of smoothness constraint for vein pixels. Likewise, G(V) can be minimum when V contains a constant value at each pixel, but clearly a constant value of V increases the value of F(V). In order to simultaneously minimize the constraints possessing competitive nature, these are combined using the following function:

                           
                              (10)
                              
                                 
                                    P
                                    
                                       (
                                       V
                                       ,
                                       α
                                       )
                                    
                                    =
                                    
                                       1
                                       2
                                    
                                    
                                       (
                                       
                                          
                                             1
                                             −
                                             
                                                α
                                                2
                                             
                                          
                                       
                                       F
                                       
                                          (
                                          V
                                          )
                                       
                                       +
                                       α
                                       G
                                       
                                          (
                                          V
                                          )
                                       
                                       )
                                    
                                 
                              
                           
                        In the combined function, P(V, α), a parameter α is introduced to control the contribution of F(V) and G(V). It can be observed that if G(V) has more contribution than F(V) in the combined function, then V is smooth due to which genuine veins can be missed. However, false veins can be generated due to noise if F(V) has more contribution than G(V). Thus, α plays a crucial role in the genuine vein extraction. Since the contribution of F(V) and G(V) depends on the image properties, α is chosen to be variable in this paper which needs to be determined according to the image. F(V) and G(V) are combined in Eq. (10) using weighted sum. There are various possibilities of selecting the weights, but the weights are assigned in the equation such that sum of squares of their weights is equal to 1 which guarantees fast convergence [8,21]. It can be seen from Eq. (10) that P(V, α) has concave-convex nature, i.e., it is a strictly convex and concave with respect to V and α respectively [37]. Apart from V, the equation also contain another variable α which should be determined. Parameter α is maximized in this paper so as to cast the optimization problem into a maximin problem which minimizes the worst case possible error [24]. Thus, V is obtained by the minimax solution of P(V, α) where P(V, α) is first minimized with respect to T and subsequently maximized with respect to α 
                        [14]. Mathematically, estimated V is given by:

                           
                              (11)
                              
                                 
                                    
                                       V
                                       ^
                                    
                                    =
                                    a
                                    r
                                    g
                                    
                                       max
                                       α
                                    
                                    
                                       min
                                       V
                                    
                                    P
                                    
                                       (
                                       V
                                       ,
                                       α
                                       )
                                    
                                 
                              
                           
                        It is claimed in [30] that outer and inner optimizations can be interchanged in case of minimax problem if the optimization function possesses concave-convex nature and the variables are compact. In our case, both the conditions are satisfied, i.e., P(V, α) exhibit concave-convex nature and all the variables, viz., V and α are compact sets. Thus,

                           
                              (12)
                              
                                 
                                    
                                       V
                                       ^
                                    
                                    =
                                    a
                                    r
                                    g
                                    
                                       min
                                       V
                                    
                                    
                                       max
                                       α
                                    
                                    P
                                    
                                       (
                                       V
                                       ,
                                       α
                                       )
                                    
                                 
                              
                           
                        Variational minimax optimization can be used to solve such a minimax optimization problem. The steps required in it are shown in Algorithm 2
                        . In the first iteration of the algorithm, the value of α which maximizes P(V, α) is determined by differentiating it with respect to α and equating the result to zero. Let 
                           
                              α
                              ¯
                           
                         denotes the estimated value of α which is given by

                           
                              (13)
                              
                                 
                                    
                                       
                                          ∂
                                          P
                                          
                                             (
                                             V
                                             ,
                                             α
                                             )
                                          
                                       
                                       
                                          ∂
                                          α
                                       
                                    
                                    =
                                    
                                       
                                          −
                                          α
                                       
                                       
                                          
                                             1
                                             −
                                             
                                                α
                                                2
                                             
                                          
                                       
                                    
                                    F
                                    
                                       (
                                       V
                                       )
                                    
                                    +
                                    G
                                    
                                       (
                                       V
                                       )
                                    
                                    =
                                    0
                                 
                              
                           
                        
                        
                           
                              (14)
                              
                                 
                                    
                                       α
                                       ¯
                                    
                                    =
                                    
                                       
                                          G
                                          
                                             (
                                             V
                                             )
                                          
                                       
                                       
                                          
                                             
                                                
                                                   (
                                                   F
                                                   
                                                      (
                                                      V
                                                      )
                                                   
                                                   )
                                                
                                                2
                                             
                                             +
                                             
                                                
                                                   (
                                                   G
                                                   
                                                      (
                                                      V
                                                      )
                                                   
                                                   )
                                                
                                                2
                                             
                                          
                                       
                                    
                                 
                              
                           
                        After the value of α is estimated, parameter V needs to be estimated using the function P(V, α) corresponding to 
                           
                              α
                              ¯
                           
                        . Hence, function 
                           
                              P
                              
                                 (
                                 V
                                 ,
                                 
                                    α
                                    ¯
                                 
                                 )
                              
                           
                         is minimized using gradient descent for the estimation. Mathematically,

                           
                              (15)
                              
                                 
                                    P
                                    
                                       (
                                       V
                                       ,
                                       
                                          α
                                          ¯
                                       
                                       )
                                    
                                    =
                                    
                                       ∫
                                       x
                                    
                                    
                                       ∫
                                       y
                                    
                                    Ψ
                                    
                                       (
                                       V
                                       ,
                                       
                                          V
                                          x
                                       
                                       ,
                                       
                                          V
                                          y
                                       
                                       )
                                    
                                    
                                       d
                                    
                                    x
                                    
                                    
                                       d
                                    
                                    y
                                 
                              
                           
                        where Ψ(V, Vx, Vy
                        ) is

                           
                              (16)
                              
                                 
                                    
                                       
                                          
                                             Ψ
                                             
                                                (
                                                V
                                                ,
                                                
                                                   V
                                                   x
                                                
                                                ,
                                                
                                                   V
                                                   y
                                                
                                                )
                                             
                                             =
                                          
                                       
                                       
                                          
                                             
                                                
                                                   1
                                                   −
                                                   
                                                      
                                                         α
                                                         ¯
                                                      
                                                      2
                                                   
                                                
                                             
                                             
                                                (
                                                Q
                                                
                                                   (
                                                   x
                                                   ,
                                                   y
                                                   )
                                                
                                                
                                                   
                                                      (
                                                      
                                                         V
                                                         E
                                                      
                                                      
                                                         (
                                                         x
                                                         ,
                                                         y
                                                         )
                                                      
                                                      −
                                                      V
                                                      
                                                         (
                                                         x
                                                         ,
                                                         y
                                                         )
                                                      
                                                      )
                                                   
                                                   2
                                                
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             +
                                             
                                                α
                                                ¯
                                             
                                             
                                                (
                                                
                                                   
                                                      |
                                                      
                                                         V
                                                         x
                                                      
                                                      
                                                         (
                                                         x
                                                         ,
                                                         y
                                                         )
                                                      
                                                      +
                                                      
                                                         V
                                                         y
                                                      
                                                      
                                                         (
                                                         x
                                                         ,
                                                         y
                                                         )
                                                      
                                                      |
                                                   
                                                   2
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (17)
                              
                                 
                                    
                                       V
                                       x
                                    
                                    
                                       (
                                       x
                                       ,
                                       y
                                       )
                                    
                                    =
                                    
                                       
                                          ∂
                                          V
                                          
                                             (
                                             x
                                             ,
                                             y
                                             )
                                          
                                       
                                       
                                          ∂
                                          x
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (18)
                              
                                 
                                    
                                       V
                                       y
                                    
                                    
                                       (
                                       x
                                       ,
                                       y
                                       )
                                    
                                    =
                                    
                                       
                                          ∂
                                          V
                                          
                                             (
                                             x
                                             ,
                                             y
                                             )
                                          
                                       
                                       
                                          ∂
                                          y
                                       
                                    
                                 
                              
                           
                        Assume that there exists a function, h, whose first and second derivatives are continuous and it is used to perturb V. After perturbation, function 
                           
                              P
                              
                                 (
                                 V
                                 ,
                                 
                                    α
                                    ¯
                                 
                                 )
                              
                           
                         is modified as function 
                           
                              P
                              
                                 (
                                 V
                                 +
                                 h
                                 ,
                                 
                                    α
                                    ¯
                                 
                                 )
                              
                              ,
                           
                         i.e., variations are introduced in 
                           
                              P
                              
                                 (
                                 V
                                 ,
                                 
                                    α
                                    ¯
                                 
                                 )
                              
                           
                         when V is perturbed. Let δ denotes the variations which can be obtained using Euler conditions, that is

                           
                              (19)
                              
                                 
                                    δ
                                    
                                       (
                                       P
                                       
                                          (
                                          V
                                          ,
                                          
                                             α
                                             ¯
                                          
                                          )
                                       
                                       )
                                    
                                    =
                                    
                                       ∫
                                       x
                                    
                                    
                                       ∫
                                       y
                                    
                                    
                                       (
                                       
                                          
                                             ∂
                                             Ψ
                                          
                                          
                                             ∂
                                             V
                                          
                                       
                                       +
                                       
                                          ∂
                                          
                                             ∂
                                             x
                                          
                                       
                                       
                                          (
                                          
                                             
                                                ∂
                                                Ψ
                                             
                                             
                                                ∂
                                                
                                                   V
                                                   x
                                                
                                             
                                          
                                          )
                                       
                                       +
                                       
                                          ∂
                                          
                                             ∂
                                             y
                                          
                                       
                                       
                                          (
                                          
                                             
                                                ∂
                                                Ψ
                                             
                                             
                                                ∂
                                                
                                                   V
                                                   y
                                                
                                             
                                          
                                          )
                                       
                                       )
                                    
                                    h
                                    
                                       (
                                       x
                                       ,
                                       y
                                       )
                                    
                                    
                                       d
                                    
                                    x
                                    
                                       d
                                    
                                    y
                                 
                              
                           
                        where

                           
                              (20)
                              
                                 
                                    
                                       
                                          ∂
                                          Ψ
                                       
                                       
                                          ∂
                                          V
                                       
                                    
                                    =
                                    −
                                    
                                       
                                          1
                                          −
                                          
                                             
                                                α
                                                ¯
                                             
                                             2
                                          
                                       
                                    
                                    
                                       (
                                       Q
                                       
                                          (
                                          x
                                          ,
                                          y
                                          )
                                       
                                       
                                          (
                                          
                                             V
                                             E
                                          
                                          
                                             (
                                             x
                                             ,
                                             y
                                             )
                                          
                                          −
                                          V
                                          
                                             (
                                             x
                                             ,
                                             y
                                             )
                                          
                                          )
                                       
                                       )
                                    
                                 
                              
                           
                        
                        
                           
                              (21)
                              
                                 
                                    
                                       ∂
                                       
                                          ∂
                                          x
                                       
                                    
                                    
                                       (
                                       
                                          
                                             ∂
                                             Ψ
                                          
                                          
                                             ∂
                                             
                                                V
                                                x
                                             
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       ∂
                                       
                                          ∂
                                          x
                                       
                                    
                                    
                                       (
                                       
                                          α
                                          ¯
                                       
                                       
                                          
                                             ∂
                                             V
                                          
                                          
                                             ∂
                                             x
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       α
                                       ¯
                                    
                                    
                                       
                                          
                                             ∂
                                             2
                                          
                                          V
                                       
                                       
                                          ∂
                                          
                                             x
                                             2
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (22)
                              
                                 
                                    
                                       ∂
                                       
                                          ∂
                                          y
                                       
                                    
                                    
                                       (
                                       
                                          
                                             ∂
                                             Ψ
                                          
                                          
                                             ∂
                                             
                                                V
                                                y
                                             
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       ∂
                                       
                                          ∂
                                          y
                                       
                                    
                                    
                                       (
                                       
                                          α
                                          ¯
                                       
                                       
                                          
                                             ∂
                                             V
                                          
                                          
                                             ∂
                                             y
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       α
                                       ¯
                                    
                                    
                                       
                                          
                                             ∂
                                             2
                                          
                                          V
                                       
                                       
                                          ∂
                                          
                                             y
                                             2
                                          
                                       
                                    
                                 
                              
                           
                        In the gradient descent technique, change introduced in V is:

                           
                              (23)
                              
                                 
                                    
                                       V
                                       Δ
                                    
                                    =
                                    −
                                    
                                       E
                                       
                                          v
                                          a
                                          r
                                       
                                    
                                 
                              
                           
                        where

                           
                              (24)
                              
                                 
                                    
                                       E
                                       
                                          v
                                          a
                                          r
                                       
                                    
                                    =
                                    
                                       (
                                       
                                          
                                             ∂
                                             Ψ
                                          
                                          
                                             ∂
                                             V
                                          
                                       
                                       +
                                       
                                          ∂
                                          
                                             ∂
                                             x
                                          
                                       
                                       
                                          (
                                          
                                             
                                                ∂
                                                Ψ
                                             
                                             
                                                ∂
                                                
                                                   V
                                                   x
                                                
                                             
                                          
                                          )
                                       
                                       +
                                       
                                          ∂
                                          
                                             ∂
                                             y
                                          
                                       
                                       
                                          (
                                          
                                             
                                                ∂
                                                Ψ
                                             
                                             
                                                ∂
                                                
                                                   V
                                                   y
                                                
                                             
                                          
                                          )
                                       
                                       )
                                    
                                 
                              
                           
                        In a more elaborate form,

                           
                              (25)
                              
                                 
                                    
                                       
                                          
                                             V
                                             Δ
                                          
                                       
                                       
                                          
                                             =
                                             
                                                
                                                   1
                                                   −
                                                   
                                                      
                                                         α
                                                         ¯
                                                      
                                                      2
                                                   
                                                
                                             
                                             
                                                (
                                                Q
                                                
                                                   (
                                                   x
                                                   ,
                                                   y
                                                   )
                                                
                                                
                                                   (
                                                   
                                                      V
                                                      E
                                                   
                                                   
                                                      (
                                                      x
                                                      ,
                                                      y
                                                      )
                                                   
                                                   −
                                                   V
                                                   
                                                      (
                                                      x
                                                      ,
                                                      y
                                                      )
                                                   
                                                   )
                                                
                                                )
                                             
                                             +
                                             
                                                α
                                                ¯
                                             
                                             
                                                (
                                                
                                                   
                                                      
                                                         ∂
                                                         2
                                                      
                                                      V
                                                   
                                                   
                                                      ∂
                                                      
                                                         x
                                                         2
                                                      
                                                   
                                                
                                                +
                                                
                                                   
                                                      
                                                         ∂
                                                         2
                                                      
                                                      V
                                                   
                                                   
                                                      ∂
                                                      
                                                         y
                                                         2
                                                      
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             =
                                             
                                                
                                                   1
                                                   −
                                                   
                                                      
                                                         α
                                                         ¯
                                                      
                                                      2
                                                   
                                                
                                             
                                             
                                                (
                                                Q
                                                
                                                   (
                                                   x
                                                   ,
                                                   y
                                                   )
                                                
                                                
                                                   (
                                                   
                                                      V
                                                      E
                                                   
                                                   
                                                      (
                                                      x
                                                      ,
                                                      y
                                                      )
                                                   
                                                   −
                                                   V
                                                   
                                                      (
                                                      x
                                                      ,
                                                      y
                                                      )
                                                   
                                                   )
                                                
                                                )
                                             
                                             +
                                             
                                                α
                                                ¯
                                             
                                             
                                                ▽
                                                2
                                             
                                             V
                                             
                                                (
                                                x
                                                ,
                                                y
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                        Thus, V is updated using

                           
                              (26)
                              
                                 
                                    V
                                    =
                                    V
                                    +
                                    τ
                                    
                                       V
                                       Δ
                                    
                                 
                              
                           
                        where τ denotes the step-size. Updated V is used to update F(V) and G(V). In the next iteration, updated F(V) and G(V) are used to estimate 
                           
                              α
                              ¯
                           
                         (Eq. (14)) and the estimated 
                           
                              α
                              ¯
                           
                         is used to subsequently update V, F(V) and G(V). Such an iterative update of 
                           
                              
                                 α
                                 ¯
                              
                              ,
                           
                         
                        V, 
                           
                              
                                 F
                                 ^
                              
                              
                                 (
                                 V
                                 )
                              
                           
                         and G(V) is carried out till stopping conditions are attained. If the algorithm is executed predetermined number of times or the change in 
                           
                              α
                              ¯
                           
                         is less than a predetermined threshold, then stopping conditions are attained. Genuine veins are extracted from V using global threshold algorithm. Morphological operations are subsequently applied to remove small holes and isolated blobs. Let VG
                         represents the resultant image.

Typically, a heat equation can be given by:

                           
                              (27)
                              
                                 
                                    
                                       
                                          ∂
                                          u
                                       
                                       
                                          ∂
                                          t
                                       
                                    
                                    =
                                    c
                                    
                                       (
                                       
                                          
                                             
                                                ∂
                                                2
                                             
                                             u
                                          
                                          
                                             ∂
                                             
                                                x
                                                2
                                             
                                          
                                       
                                       +
                                       
                                          
                                             
                                                ∂
                                                2
                                             
                                             u
                                          
                                          
                                             ∂
                                             
                                                y
                                                2
                                             
                                          
                                       
                                       )
                                    
                                 
                              
                           
                        where c is constant and u is a function of x, y and t. One can analyze that Eq. (25) resembles a heat equation [3] such that source term, St
                         is represented by

                           
                              (28)
                              
                                 
                                    
                                       S
                                       t
                                    
                                    =
                                    
                                       
                                          1
                                          −
                                          
                                             
                                                α
                                                ¯
                                             
                                             2
                                          
                                       
                                    
                                    
                                       (
                                       L
                                       
                                          (
                                          x
                                          ,
                                          y
                                          )
                                       
                                       
                                          (
                                          M
                                          
                                             (
                                             x
                                             ,
                                             y
                                             )
                                          
                                          −
                                          T
                                          
                                             (
                                             x
                                             ,
                                             y
                                             )
                                          
                                          )
                                       
                                       )
                                    
                                 
                              
                           
                        It is shown in [34] that numerical solutions of heat equation can be given by finite difference method. Difference method is useful when only discrete finite values are involved in the calculation like in our case, where image intensities are defined at discrete values. Thus, numerical solution of Eq. (25) can be obtained by replacing all continuous derivatives by difference formula. That is,

                           
                              (29)
                              
                                 
                                    
                                       
                                          (
                                          
                                             
                                                ∂
                                                V
                                                
                                                   (
                                                   x
                                                   ,
                                                   y
                                                   )
                                                
                                             
                                             
                                                ∂
                                                x
                                             
                                          
                                          )
                                       
                                       t
                                    
                                    =
                                    
                                       V
                                       
                                          i
                                          +
                                          1
                                          ,
                                          j
                                       
                                       t
                                    
                                    −
                                    
                                       V
                                       
                                          i
                                          ,
                                          j
                                       
                                       t
                                    
                                 
                              
                           
                        
                        
                           
                              (30)
                              
                                 
                                    
                                       
                                          (
                                          
                                             
                                                ∂
                                                V
                                                
                                                   (
                                                   x
                                                   ,
                                                   y
                                                   )
                                                
                                             
                                             
                                                ∂
                                                y
                                             
                                          
                                          )
                                       
                                       t
                                    
                                    =
                                    
                                       V
                                       
                                          i
                                          ,
                                          j
                                          +
                                          1
                                       
                                       t
                                    
                                    −
                                    
                                       V
                                       
                                          i
                                          ,
                                          j
                                       
                                       t
                                    
                                 
                              
                           
                        
                        
                           
                              (31)
                              
                                 
                                    
                                       
                                          (
                                          
                                             
                                                
                                                   ∂
                                                   2
                                                
                                                V
                                             
                                             
                                                ∂
                                                
                                                   x
                                                   2
                                                
                                             
                                          
                                          )
                                       
                                       t
                                    
                                    =
                                    
                                       V
                                       
                                          i
                                          +
                                          1
                                          ,
                                          j
                                       
                                       t
                                    
                                    −
                                    2
                                    
                                       V
                                       
                                          i
                                          ,
                                          j
                                       
                                       t
                                    
                                    +
                                    
                                       V
                                       
                                          i
                                          −
                                          1
                                          ,
                                          j
                                       
                                       t
                                    
                                 
                              
                           
                        
                        
                           
                              (32)
                              
                                 
                                    
                                       
                                          (
                                          
                                             
                                                
                                                   ∂
                                                   2
                                                
                                                V
                                             
                                             
                                                ∂
                                                
                                                   y
                                                   2
                                                
                                             
                                          
                                          )
                                       
                                       t
                                    
                                    =
                                    
                                       V
                                       
                                          i
                                          ,
                                          j
                                          +
                                          1
                                       
                                       t
                                    
                                    −
                                    2
                                    
                                       V
                                       
                                          i
                                          ,
                                          j
                                       
                                       t
                                    
                                    +
                                    
                                       V
                                       
                                          i
                                          ,
                                          j
                                          −
                                          1
                                       
                                       t
                                    
                                 
                              
                           
                        where t and (i, j) denote the iteration number and pixel location respectively. After replacing the continuous derivatives by difference formula, Eq. (25) is modified as

                           
                              (33)
                              
                                 
                                    
                                       
                                          
                                             
                                                V
                                                
                                                   i
                                                   ,
                                                   j
                                                
                                                
                                                   t
                                                   +
                                                   1
                                                
                                             
                                             =
                                          
                                       
                                       
                                          
                                             
                                                V
                                                
                                                   i
                                                   ,
                                                   j
                                                
                                                t
                                             
                                             +
                                             τ
                                             
                                                
                                                   1
                                                   −
                                                   
                                                      
                                                         α
                                                         ¯
                                                      
                                                      2
                                                   
                                                
                                             
                                             
                                                (
                                                
                                                   Q
                                                   
                                                      i
                                                      ,
                                                      j
                                                   
                                                
                                                
                                                   (
                                                   
                                                      V
                                                      
                                                         i
                                                         ,
                                                         j
                                                      
                                                      E
                                                   
                                                   −
                                                   
                                                      V
                                                      
                                                         i
                                                         ,
                                                         j
                                                      
                                                      t
                                                   
                                                   )
                                                
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             +
                                             τ
                                             
                                                α
                                                ¯
                                             
                                             
                                                (
                                                
                                                   V
                                                   
                                                      i
                                                      +
                                                      1
                                                      ,
                                                      j
                                                   
                                                   t
                                                
                                                +
                                                
                                                   V
                                                   
                                                      i
                                                      −
                                                      1
                                                      ,
                                                      j
                                                   
                                                   t
                                                
                                                +
                                                
                                                   V
                                                   
                                                      i
                                                      ,
                                                      j
                                                      +
                                                      1
                                                   
                                                   t
                                                
                                                +
                                                
                                                   V
                                                   
                                                      i
                                                      ,
                                                      j
                                                      −
                                                      1
                                                   
                                                   t
                                                
                                                −
                                                4
                                                
                                                   V
                                                   
                                                      i
                                                      ,
                                                      j
                                                   
                                                   t
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Translation and rotation can be introduced in the acquired images due to the unconstrained nature of acquisition setup. Moreover, the proposed extraction can generate spurious veins or can miss genuine veins because of the existence of non-uniform illumination and noise (like hair and skin texture) in the acquired images. Since local features cannot be accurately determined due to these issues, vein matching using local feature matching is avoided. In contrast, vein matching using global feature matching can somewhat manage these issues, thus global matching algorithm proposed in [13] is used for vein matching. In [13], vein images are registered using Fourier--Mellin transform and the overlapping area between the registered images is used to find the similarity score Fig. 4
                        .

Let U and V represent the vein images that requires matching. V is transformed with respect to U using Fourier--Mellin transform [12]. Assume that R denotes the resultant image that is obtained by transforming V. Let 
                           
                              s
                              1
                              
                                 u
                                 v
                              
                           
                         denotes the similarity score between U and V. It is given by

                           
                              (34)
                              
                                 
                                    
                                       s
                                       1
                                       
                                          u
                                          v
                                       
                                    
                                    =
                                    
                                       
                                          
                                             ∑
                                             
                                                x
                                                ,
                                                y
                                             
                                          
                                          R
                                          
                                             (
                                             x
                                             ,
                                             y
                                             )
                                          
                                          ×
                                          U
                                          
                                             (
                                             x
                                             ,
                                             y
                                             )
                                          
                                       
                                       
                                          max
                                          
                                             {
                                             
                                                ∑
                                                
                                                   x
                                                   ,
                                                   y
                                                
                                             
                                             R
                                             
                                                (
                                                x
                                                ,
                                                y
                                                )
                                             
                                             ,
                                             
                                                ∑
                                                
                                                   x
                                                   ,
                                                   y
                                                
                                             
                                             U
                                             
                                                (
                                                x
                                                ,
                                                y
                                                )
                                             
                                             }
                                          
                                       
                                    
                                 
                              
                           
                        where max is maximum operator, while (x, y) denote pixel location.

It is observed that various hand features like centroid contour distance [27], triangles [25] and finger profile [29] cannot be effectively extracted due to the lack of texture in the acquired images. But features like finger-length and finger-width can be computed using the stable key-points viz. fingertips and valley points of fingers Fig. 5
                        . Let us denote the fingertip of a finger by c, with the corresponding finger endpoints being denoted by d and b. The process for extracting the features for a finger, then, consists of the following:

                           
                              1.
                              
                                 Determining the finger-width: More often than not, the detected endpoints of a finger are not equidistant from the fingertip. This is true especially for the middle and ring fingers. Without loss of generality, assume that the distance between d and c is larger than the same between b and c. The farther point, i.e. d is adjusted in such a way that the two distances are equal. This is instrumental for accurate feature extraction. Assume that this new point, after adjusting d is d
                                 1. The distance from d
                                 1 to b is considered to be the finger width.


                                 Determining the finger-length: For obtaining the finger-length, consider a point m, lying on the line segment Ls
                                 , joining d
                                 1 and b. It is given by the equation

                                    
                                       (35)
                                       
                                          
                                             m
                                             =
                                             a
                                             r
                                             g
                                             
                                                min
                                                p
                                             
                                             d
                                             i
                                             s
                                             t
                                             
                                                (
                                                p
                                                ,
                                                c
                                                )
                                             
                                          
                                       
                                    
                                 In essence, m is a point p on Ls
                                 , which is at the minimum distance from the fingertip. The finger-length is the Euclidean distance between m and c.

The steps required feature extraction from a finger image are shown in Algorithm 3
                        . The same procedure is applied to extract features for all five fingers.

PCA [39] is applied to combine the features of all the five fingers. The problem with PCA is that it cannot handle translations and rotations. Since features involved in the matching are not affected by translations and rotations, PCA can be effectively used for the matching. The transformed feature vector, as obtained after usage of PCA, is stored as the template for matching, while the original vector is discarded.

In order to match two feature vectors U and V, they are first subjected to PCA to obtain two transformed feature vectors, as described above. The Euclidean distance between the two transformed feature vectors is termed as duv
                        . This score is a dissimilarity score, which can be transformed into a similarity score 
                           
                              s
                              2
                              
                                 u
                                 v
                              
                           
                         by

                           
                              (36)
                              
                                 
                                    
                                       s
                                       2
                                       
                                          u
                                          v
                                       
                                    
                                    =
                                    
                                       1
                                       
                                          d
                                          
                                             u
                                             v
                                          
                                       
                                    
                                 
                              
                           
                        The required steps for hand geometry matching are described in Algorithm 4
                        .

In this section, matching scores 
                           
                              s
                              1
                              
                                 u
                                 v
                              
                           
                         and 
                           
                              s
                              2
                              
                                 u
                                 v
                              
                           
                         obtained by matching palm dorsal veins and IR hand geometry are consolidated to obtain a single matching score. If the scores are obtained by matching different traits, score normalization is required prior to fusion of the scores [7]. Thus, 
                           
                              s
                              1
                              
                                 u
                                 v
                              
                           
                         and 
                           
                              s
                              2
                              
                                 u
                                 v
                              
                           
                         are transformed using min-max normalization. Let 
                           
                              s
                              1
                              n
                           
                         and 
                           
                              s
                              2
                              n
                           
                         represent the normalized matching score corresponding to 
                           
                              s
                              1
                              
                                 u
                                 v
                              
                           
                         and 
                           
                              s
                              2
                              
                                 u
                                 v
                              
                           
                         respectively. It is obvious that both the normalized matching scores should be high in case of genuine matching and at-least one of the normalized matching score should be low in case of impostor matching. Moreover, it is intuitive that the contribution of a trait should depend on its performance for better fusion [32]. Thus, weighted sum rule is used to fuse the normalized scores, that is:

                           
                              (37)
                              
                                 
                                    
                                       s
                                       F
                                    
                                    =
                                    
                                       w
                                       1
                                    
                                    ×
                                    
                                       s
                                       1
                                       
                                          u
                                          v
                                       
                                    
                                    +
                                    
                                       w
                                       2
                                    
                                    ×
                                    
                                       s
                                       2
                                       
                                          u
                                          v
                                       
                                    
                                 
                              
                           
                        where sF
                         denotes the fused score while w
                        1 and w
                        2 represent the weights of palm dorsal veins and IR hand geometry, respectively. These weights are assigned based on the performance of the involved traits on the training set. Tuning methodology of the weights is explained in Section 5.1.

@&#EXPERIMENTAL RESULTS@&#

In this section, the efficacy of the proposed system is compared with the well-known systems. For this, IITK-Pdv database is created using the proposed acquisition setup. Like [23], by unconstrained, it is meant that it does not contain any docking device or pegs and touch-less to avoid the direct contact between IR camera and user hand. It consists of 1500 images, acquired from both hands of 150 users. In order to introduce large temporal variations, it is acquired in two sessions such that the average time gap between the sessions is eight days. Each user gives three and two images of each hand in the first and second session respectively. Thus, total five images of right and left hand are acquired corresponding to each user. During experimentation, different hands are treated as different classes, thus total 300 classes are considered for performance evaluation. Two images of each class (i.e., different hands) collected in second session are used to form the gallery set, while the remaining images (i.e., the images collected in first session) are kept in probe set. Hence, total 538,200 (299 × 2 × 300 × 3) impostor matching and 1800 (1 × 2 × 300 × 3) genuine matching have been used for evaluation.

Authentication is categorized as either verification or identification. In case of verification, feature vector of the user is matched with that of the claimed identity to generate a matching score. If the matching score is greater than the threshold, then the user is genuine; otherwise an impostor. Hence, two types of errors are present in verification, viz.,false reject rate (FRR) which is the rate at which an impostor is misclassified as a genuine person and false accept rate (FAR) which indicates the rate at which a genuine person is misclassified as impostor. Behavior of FAR and FRR at different threshold can be observed by receiver operating characteristic (ROC) curve. Performance metric used for verification is equal error rate (EER) which is equal to the false reject rate at the threshold t
                     1 where FAR and FRR are equal, i.e., FAR(t
                     1) = FRR(t
                     1). While in case of identification, performance is measured using correct recognition rate (CRR) which is given by the accuracy of the top best match, that is:

                        
                           (38)
                           
                              
                                 CRR
                                 =
                                 
                                    
                                       Total
                                       
                                       number
                                       
                                       of
                                       
                                       correct
                                       
                                       top
                                       
                                       match
                                    
                                    
                                       Total
                                       
                                       number
                                       
                                       of
                                       
                                       query
                                       
                                       images
                                    
                                 
                                 ×
                                 100
                              
                           
                        
                     
                  

In the proposed system, several parameters are used to obtain accurate results. For parameter tuning, the probe set is divided into two equal parts, P
                        1 and P
                        2, such that each part contains one image per class. Parameter settings used in the proposed system are explained below:

                           
                              1.
                              
                                 Parameters used for quality estimation: In order to determine the quality of palm dorsal veins, two parameters are required which are the block-sizes used in gradient and local range. Let bg
                                  and br
                                  represent the block size of the gradient and local range respectively. bg
                                  should be greater than the width of vein so as to assign high gradient values for vein pixels. Simultaneously, it should not be high enough otherwise low gradient values are assigned to the vein pixels. Similarly, br
                                  should be greater than the width of hair otherwise low values are assigned to the areas containing hair. Moreover, if it is high enough lots of pixels which do not contain hair can also be regarded as hair pixels. To determine the width of vein and hair, 25 palm-dorsal images are randomly selected from P
                                 1 and clearly visible veins and hair are manually marked. The average width of veins and hair are found to be 14 and 2 pixels, respectively. Thus, bg
                                  and br
                                  are set equal to 15 and 3, respectively.


                                 Parameters used for vein extraction: It is proved in [5] that step-size should be less than or equal to 
                                    
                                       1
                                       4
                                    
                                  in gradient descent. Thus, in this paper, step-size τ is equal to 
                                    
                                       1
                                       4
                                    
                                 . In addition, some parameter tunings are required to properly define the stopping conditions of the variational update, which are, (1) the algorithm can be executed at-most n times; or (2) the algorithm cannot iterate further if change in 
                                    
                                       α
                                       ¯
                                    
                                  is less than a predetermined threshold, ϵ. Experimentally, it is found out that when vein are extracted from the images belonging to P
                                 1, the maximum number of iterations reached is 81. Thus, n is set to 100 so as to account for any error. Moreover, ϵ is the chosen to be the smallest possible value of 
                                    
                                       
                                          α
                                          ¯
                                       
                                       ,
                                    
                                  which is 
                                    
                                       2
                                       
                                          −
                                          52
                                       
                                    
                                  in our case.


                                 Parameters used for IR hand geometry: Only one parameter needs to be tuned in case of hand geometry which is the number of basis functions, e. Parameter e is required for hand geometry matching using PCA. PCA is applied on the hand geometry features of P
                                 1 and it is chosen to be the number of basis functions that can capture at-least 96% of the total energy [45], i.e., three in our case.


                                 Parameters used for fusion: The following parameters are used during the fusion: (1) functions F
                                 1 and F
                                 2 which are used to normalize the matching score of palm dorsal vein and IR hand geometry respectively; and (2) weights w
                                 1 and w
                                 2 corresponding to palm dorsal veins and IR hand geometry respectively, which are used in the weighted sum rule. These can be tuned using the distribution of vein matching scores which can be obtained by matching the palm dorsal vein images in P
                                 1 with the images in P
                                 2. Since w
                                 1 is assigned based on the performance of palm dorsal veins, CRR of the score distribution is evaluated and set as w
                                 1. In addition, maximum and minimum palm dorsal vein matching score are determined from the distribution and these are used to determine the function F
                                 1 by

                                    
                                       (39)
                                       
                                          
                                             
                                                F
                                                1
                                             
                                             
                                                (
                                                x
                                                )
                                             
                                             =
                                             
                                                {
                                                
                                                   
                                                      
                                                         
                                                            0
                                                            ,
                                                         
                                                      
                                                      
                                                         
                                                            if
                                                            
                                                            
                                                            
                                                            
                                                            x
                                                            <
                                                            m
                                                            i
                                                            n
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  x
                                                                  −
                                                                  m
                                                                  i
                                                                  n
                                                               
                                                               
                                                                  m
                                                                  a
                                                                  x
                                                                  −
                                                                  m
                                                                  i
                                                                  n
                                                               
                                                            
                                                            ,
                                                         
                                                      
                                                      
                                                         
                                                            if
                                                            
                                                            
                                                            
                                                            
                                                            m
                                                            i
                                                            n
                                                            ≤
                                                            x
                                                            ≤
                                                            m
                                                            a
                                                            x
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            1
                                                            ,
                                                         
                                                      
                                                      
                                                         otherwise
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 where max and min are the maximum and minimum palm dorsal vein matching score respectively. Similarly, the score distribution of IR hand geometry is evaluated and it is used to determine function F
                                 2 and weight w
                                 2.

In this section, the efficacy of the proposed palm dorsal vein system is compared with other well-known systems on IITK-Pdv database and the comparative results are presented in Table 1
                        . All the other systems either acquire only palm dorsal area or full hand in constrained environment. Thus to maintain the consistency in the results, the proposed processing is used in all the other systems to extract palm dorsal area from the IR hand images in IITK-Pdv database. Moreover, Systems [16,25,29] are multi-modal systems, i.e., using several modalities for authentication. Since this section aims to analyze palm dorsal vein matching, the results only consider palm dorsal vein matching from Systems [16,25,29]. Fig. 6
                         shows the ROC curves corresponding to the table. It can be inferred from the table that the proposed palm dorsal vein system performs better than other systems. Moreover, it can be observed that:

                           
                              1.
                              System [42] where minutiae features are matched using hausdorff distance, exhibits the lowest performance. It is mainly because: (1) minutiae features contain large deformations; (2) some images contain an insufficient number of minutiae required for accurate matching; (3) noise has generated spurious minutiae; and (4) hausdroff matching is highly sensitive to geometrical transformation and occlusion.

Systems rely on multi-scale matched filtering, i.e., System [13], System [16] and the proposed system exhibit better performance as compared to other systems because: (1) the most appropriate vein structure is used in these systems during matched filtering; (2) variable width veins are effectively enhanced in these systems due to multi-scale analysis; and (3) problems of occlusion, translation, rotation, and noise are also minimized using global vein matching.

Moreover, the proposed palm dorsal vein system has better performance than System [13] and System [16]. The reason behind this is that sometimes spurious veins are generated by System [13] and System [16] due to hair and skin texture on the palm dorsal but these issues are effectively handled by the proposed palm dorsal vein to extract the genuine veins.

The impact of the proposed quality estimation on the performance of palm dorsal matching is thoroughly analyzed and the results are shown in Table 2
                        . ROC curves corresponding to the table are shown in Fig. 7
                        . In the table, various systems are shown which are formed by replacing only the quality estimation while keeping the proposed vein enhancement, vein extraction and vein matching intact. Gradient [47], contrast [19] and entropy [31] are pixel-wise evaluated and used as quality measures in the results. It can be observed from the table that:

                           
                              1.
                              System 3
                                 
                                  has better performance than Systems 1 and 2 which indicate that gradient is a more useful quality parameter than entropy and contrast. Entropy of an image refers to its dispersion and unfortunately noise pixels have significant dispersion Thus System 1 relying on entropy based quality exhibit low performance [18]. Also, contrast based quality is not useful because contrast measures the root mean square error of an image which is highly sensitive to noise [19]. In addition, images in the database contain low local contrast which can further degrade the usefulness of contrast. On the other hand, gradient avoids such issues by measuring the strength of orientation.

The proposed quality measure is most suited for the authentication. Gradient based quality has lower performance because areas containing hair have strong orientation, i.e., high gradient values. But such areas should be assigned low quality values for accurate vein extraction. The proposed quality explicitly handles this issue by detecting hair pixels and assigning low values to them.

The efficacy of the proposed palm dorsal vein system has also been accessed by employing a publicly available palm dorsal vein database, GPDSvein database [6]. The database consists of 1020 palm dorsal images acquired from 102 users. Corresponding to each user, 10 samples of the right palm dorsal area are acquired. Its acquisition setup contains a rod along with two pegs which constrains the hand movements. The comparisons between the proposed palm dorsal vein system and other systems are shown using Table 3
                         and Fig. 8. In the comparisons, the gallery set is created by taking two images per user while the remaining images constitute the probe set. Hence, total 164,832 (101 × 2 × 102 × 8) impostor matching and 1632 (1 × 2 × 102 × 8) genuine matching have been used for evaluation. The database contains only palm dorsal images and thus, there is no need to detect the key-points and separate the fingers in the preprocessing. It can be inferred from the comparisons that the proposed palm dorsal vein system performs better than other well-known systems. During the performance analysis, minutia based matching is not useful for GPDSvein database [6] because it contains poor quality images due to which most of the time genuine veins are missed and spurious veins are generated. The claim has been experimentally verified in [16] by evaluating the performance of several minutiae matching systems. The EER and CRR of [42] on GPDSvein database are 43.62% and 54.19% respectively [16]. The claim is further strengthened in [6] which states that approximately 20% of GDPSvein database images possess poor quality.

This section discusses the performance of proposed hand geometry based system against some well-known systems on the IITK-Pdv database. The efficacy of other systems suffers because the hand features used in them [25,29,38] cannot be accurately determined, as the images are acquired in an unconstrained environment and that too with a lack of texture information. Also, the finger width used in [38] are the width of interphalangeal joints of the fingers which cannot be accurately determined. The results of the comparison with the proposed approach are presented in Table 4
                         and Fig. 9. It can be observed that the performance of other systems is lower than the proposed system.

A more rigorous analysis of the various hand geometry features is analyzed using Table 5
                         and Fig. 10. The features in focus are Hu invariant moments features of full hand, Hu features of palm dorsal, the finger-width and the finger-length. The Hu invariant features are extremely useful in the field of image pattern recognition, since they do not vary with image translation, rotation or scaling. However, they are sensitive to shape and elastic deformations. The matching of features is done using PCA. Some of the inferences that can be drawn from Table 5 are:

                           
                              1.
                              In comparison to the other features in the table, Hu features of full hand, has the worst performance. The main reason behind the same is the fact that the full shape of a hand changes drastically, based on opening or closing of the fingers. Due to this, most of the systems use fingers geometry and palm dorsal separately [4].

The boundaries of the extracted palm dorsal depends on the behavior of fingers. This leads to poor performance of the palm dorsal, when compared to finger-width and finger-length.

It is evident that the performance is enhanced when both finger-width as well as finger-length are used for recognition.

In this section, the applicability of the proposed multimodal system is analyzed using Table 6
                         and Fig. 11
                        . It is evident from the results that the proposed multimodal system has better performance than the existing systems [25,29], which can be attributed to the better use of palm dorsal and hand geometry traits for matching. Moreover, it can be inferred from Table 1, 4 and 6 that the performance of the proposed system has been substantially improved when both palm-dorsal and IR hand features are used for personal authentication.

@&#CONCLUSION@&#

An IR hand dorsal image based authentication system has been proposed in this paper for accurate personal authentication system. Hand dorsal images have been acquired, such that it consists of full hand. Each of the images has been segmented into palm dorsal and fingers using the domain knowledge of hand geometry. Palm dorsal and fingers have been subsequently used to extract palm dorsal veins and IR hand geometry features respectively. A novel quality estimation algorithm has been proposed for the quality estimation of palm dorsal which assigns high values to vein pixels and low values to the pixels containing hair or skin texture. The palm dorsal image has been enhanced using multi-scale matched filtering. Veins have been extracted accurately by consolidation the information provided by the enhanced image and the pixel-wise quality using a variational based algorithm. The acquired IR hand images do not acquire texture present at the interphalangeal joints of hand dorsal. Hence, several existing IR hand geometry features like finger profile [29] and triangles [25], cannot be accurately extracted and thus, avoided. Thus, several stable features like finger length and finger width have been used for IR hand features extraction along with post processing techniques. Extracted palm dorsal veins and IR hand geometry features have been used for matching and their matching scores are eventually fused for authentication using min-max based score normalization and weighted sum rule.

For performance evaluation, a database of 1500 hand images acquired from 300 different hands has been created. Experimental results have indicated that the performance of the system degrades when other palm dorsal quality estimation algorithms are used instead of the proposed one. Moreover, it has depicted that the proposed vein extraction has extracted the genuine veins accurately even if the acquired images contain non-uniform illumination, hair, skin texture and variable width veins. Further, it has demonstrated that the proposed IR hand geometry exhibit superior performance that the existing IR hand geometry systems due to the better feature selection and extraction. Also, it has shown that the proposed system exhibit better performance than the existing systems.

@&#ACKNOWLEDGMENT@&#

Authors like to acknowledge the support provided by the Department of Information Technology, Government of India to carry out this research work. Authors are also thankful to the anonymous reviewers for their valuable suggestions to improve the quality of the paper.

@&#REFERENCES@&#

