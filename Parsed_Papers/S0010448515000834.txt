@&#MAIN-TITLE@&#Quality guaranteed all-hex mesh generation by a constrained volume iterative fitting algorithm

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           An iterative algorithm is developed to fill a triangular mesh with an all-hex mesh.


                        
                        
                           
                           The Jacobian values of the all-hex mesh are guaranteed to be positive.


                        
                        
                           
                           The convergence of the iterative algorithm is proved.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Solid modeling

Hexahedral mesh generation

Volume subdivision fitting

Guaranteed quality

@&#ABSTRACT@&#


               
               
                  The hexahedral mesh (hex mesh) is usually preferred to the tetrahedral mesh (tet mesh) in finite element methods for numerical simulation. In finite element analysis, a valid hex mesh requires that the scaled Jacobian value at each mesh vertex is larger than 
                        0
                     . However, the hex mesh produced by lots of prevailing hex mesh generation methods cannot be guaranteed to be a valid hex mesh. In this paper, we develop a constrained volume iterative fitting (CVIF) algorithm to fill a given triangular mesh model with an all-hex volume mesh. Starting from an initial all-hex mesh model, which is generated by voxelizing the given triangular mesh model, CVIF algorithm fits the boundary mesh of the initial all-hex mesh to the given triangular mesh model by iteratively adjusting the boundary mesh vertices. In each iteration, the movements of the boundary mesh vertices are diffused to the inner all-hex mesh vertices. After the iteration stops, an all-hex volume mesh that fills the given triangular mesh model can be generated. In the CVIF algorithm, the movement of each all-hex mesh vertex is constrained to ensure that the scaled Jacobian value at each mesh vertex is larger than 
                        0
                     , etc. Therefore, the all-hex mesh generated by the CVIF algorithm is guaranteed to be a valid all-hex mesh.
               
            

@&#INTRODUCTION@&#

In finite element methods for numerical simulation, the hexahedral mesh (hex mesh) is usually preferred to the tetrahedral mesh (tet mesh) owing to the reduced error and smaller number of elements  [1,2]. However, generating a hex mesh with desirable qualities often requires significant geometric decomposition. Therefore, hex mesh generation can be extremely difficult to perform and automate. As a result, it requires considerable user interactions and may require days or even weeks in the case of complex shapes  [3].

Moreover, it is well known that a valid hex mesh in finite element analysis should satisfy the requirement that, the scaled Jacobian value at each mesh vertex is larger than 0  [4]. Unfortunately, there is little work which can generate an all-hex mesh with the quality guarantee stated above. On the other hand, though boundary representation models, especially triangular mesh models, are popular in current computer graphics and computer aided design applications, lots of existing all-hex mesh generation algorithms need a tet mesh model as an input  [5,6]. So they cannot handle triangular mesh models directly, and it is inconvenient.

In this paper, we develop a constrained volume iterative fitting algorithm (abbr. CVIF) which can fill a given triangular mesh model using an all-hex volume mesh, with guaranteed quality that the scaled Jacobian value at each mesh vertex is larger than 0. Given a triangular mesh model, we first construct an initial all-hex mesh model by voxelizing the given model, and extract the boundary quadrilateral mesh of the initial all-hex mesh model. Then, the initial all-hex mesh model is fitted to the given triangular mesh model by the CVIF algorithm. In each iteration of the CVIF algorithm, there are two steps: 
                        
                           (i)
                           The adjustment of the vertices of the boundary quadrilateral mesh, and

the diffusion of the movement of the boundary mesh vertices to the inner mesh vertices.

Specifically, the iterative adjustments of the boundary quadrilateral mesh vertices make up of the constrained surface iterative fitting algorithm (abbr. CSIF), and we show its convergence in this paper.

The structure of this paper is as follows. In Section  2, we briefly review related work. In Section  3, we develop the constrained volume iterative fitting algorithm. After presenting some results and discussions in Section  4, we conclude the paper in Section  5.

@&#RELATED WORK@&#

In this section, we will briefly review previous work related to our method, including hex mesh generation, subdivision fitting, and volume subdivision.


                     Hex mesh generation: There is a great deal of literature on the generation of volume meshes including tet  [7,8] and hex meshes. In this paper, we focus on hex mesh generation. According to Owen’s classification  [9], hex mesh generation methods can be categorized into three classes, i.e., direct, indirect, and structured methods. Usually, the quality of the generated hex volume mesh should be improved by postprocessing  [10,11].

Starting with a quadrilateral boundary surface mesh, direct methods generate a hexahedron for each quadrilateral according to a heuristically advancing-front approach. However, when the algorithmic heuristics are exhausted, no additional hexahedra can be placed. Consequently, this will leave void regions in the generated hex mesh  [12,13].


                     Indirect methods first generate a tet mesh, and then convert it to a hex mesh by tetrahedral decomposition or combination. The disadvantage of these methods is that the quality of resultant hex mesh can be very poor owing to the high valence nodes  [14,15].

A structured hex mesh is a mesh whose inner vertex valence is only six. A popular structured method for hex mesh generation is known as mapping   [16], by which a map from the given solid with six surfaces to a cuboid is constructed. A cuboid has a trivial hex mesh, and the hex mesh in the given solid can be generated by inverse mapping. Although the mapping method can generate a high-quality hex mesh, it can only deal with solids of relatively simple shape, i.e., those with six boundary surfaces.

To deal with complex solids, a submapping method has been developed  [17]. This submapping algorithm decomposes the given solid into separate mappable subregions while ensuring that the constraints within each subregion are consistent with the adjacent subregions.

The recently proposed hex mesh generation methods based on the PolyCube are also submapping methods that focus on the construction of the mapping  [5]. A PolyCube  [18] is a solid formed by combining a number of cubes with the same orientation; hence, it has a trivial hex mesh. By devising a mapping between the PolyCube and the input model, the sub-mapping method transfers the hex mesh in the PolyCube to the input model. Therefore, the quality of the hex mesh is heavily related to the shape of the PolyCube and the mapping.

In  [19], the method of fundamental solutions is employed to design a harmonic volumetric mapping. In  [20], the given model is first decomposed into the direct product of a surface and curve and then parameterized; subsequently, the mapping between the model and the PolyCube is constructed. Moreover, a volumetric deformation method is utilized to construct the correspondence between the given model and its PolyCube  [6]. However, computing the PolyCube as well as a low-distortion mapping between it and the given model for general shapes remains an open problem [20,21]. Recently, some work is devoted to calculate a desirable polycube. In Ref.  [22], the polycube is constructed using a variational method, by deforming an input triangle mesh through minimizing the 
                        
                           
                              l
                           
                           
                              1
                           
                        
                      norm of the mesh normals. In Ref.  [23], a constrained discrete optimization technique is developed to make the generated polycube balance parameterization distortion against singularity count.

It should be pointed out that, though the mapping and sub-mapping methods can produce high quality hex mesh, they need a tet mesh as input. Therefore, the mapping and sub-mapping methods cannot be employed directly to transform a triangular mesh model into an all-hex mesh.

On the other hand, some hex mesh generation methods employ the frame field to guide the construction of mapping from the input tet mesh to the resulted hex mesh  [24–26].

For more work on hex mesh generation, we refer the reader to excellent surveys  [1,9].


                     Subdivision surface fitting: The limit surface of approximating subdivision schemes, such as Catmull–Clark scheme  [27] will shrink, especially when the initial control mesh is sparse. Usually, this problem is solved by making the approximating subdivision surface fit the vertices of the initial mesh, by either global methods  [28], or local methods  [29].

Recently, some new methods, such as progressive interpolation (abbr. PI) and geometric interpolation (abbr. GI), have been proposed for subdivision surface fitting. They adjust the vertices of the control mesh iteratively, depending on either parametric distance in PI or geometric distance in GI, and the limit subdivision surface fits the initial mesh. The convergence of PI has been shown for the Loop  [30], Doo–Sabin  [31], and Catmull–Clark schemes  [32]. On the other hand, Ref.  [33] develops a geometric interpolation algorithm for the Loop subdivision scheme. Moreover, Ref.  [34] presents a geometric approximation algorithm for the Loop subdivision surface by distributing the difference vector for each data point to the related control vertices. Given that the geometric interpolation (approximation) algorithm must compute the closest point on the limit surface for each data point in each iteration, it incurs great computational costs.

Different from existing subdivision fitting algorithms which take the limit surface of subdivision as the approximating surface, in this paper, we develop a constrained surface iterative fitting algorithm which takes the mesh surface after finite time subdivisions as the approximating surface.


                     Volume subdivision: Similar to the two-dimensional (2D) subdivision scheme, the volume subdivision scheme can generate a sequence of increasingly dense volume meshes by recursive subdivision starting from a coarse volume mesh. The volume subdivision is mainly applied to model deformation, and its smoothness analysis is difficult to handle.

Thus far, only a few volume subdivision schemes have been developed. To our best knowledge, the first volume subdivision scheme was developed in  [35] for subdividing hex meshes. This scheme is an extension of the Catmull–Clark subdivision scheme. Furthermore, Bajaj et al. developed the MLCA subdivision rule and analyzed its smoothness  [36]. The MLCA subdivision rule can be applied in any dimension, including 2D quadrilateral surface mesh, and 3D hex volume mesh. In Ref.  [37], Pascucci introduced a subdivision scheme for 3D and higher dimensional meshes without the excessive vertex proliferation, which can be generalized to meshes of any dimension and with cells of virtually any type. Recently, inspired by the 
                        
                           
                              3
                           
                        
                      subdivision scheme, an adaptive subdivision scheme for unstructured tetrahedral meshes was presented in  [38], which generates only tetrahedra and supports adaptive refinement.

The CVIF algorithm takes a triangular mesh 
                        P
                      as input (see Fig. 9(a)), and outputs an all-hex mesh that fills the inside of 
                        P
                     . The outline of the algorithm is listed as follows.


                     
                        
                           
                        
                     
                  

It should be pointed out that the iterative adjustments of the boundary quadrilateral mesh vertices make up the constrained surface iterative fitting algorithm (abbr. CSIF).

The details of the CVIF algorithm will be explained in this section.

The first step of the CVIF algorithm 1 is to construct an initial all-hex mesh, and its boundary quadrilateral mesh 
                           V
                         will be fitted to the given triangular mesh 
                           P
                         (see Fig. 9(a)).

It should be noted that the finally generated all-hex mesh is heavily influenced by the initial all-hex mesh. Although there are several techniques to construct an initial all-hex mesh, such as the polycube mapping  [20,21], it is not an easy task to construct a desirable initial all-hex mesh in general. Since the topic of this paper focuses on the CVIF algorithm, the initial all-hex mesh model is just constructed by voxelizing the triangular mesh 
                           P
                         in this paper. The voxelization size is taken as the half of the average edge length of the mesh 
                           P
                        . Specifically, after ascertaining the feature voxels, which intersect with the triangular mesh 
                           P
                        , the scan conversion algorithm categorizes the voxels into three classes: outer voxels, inner voxels, and boundary voxels, which are feature voxels adjacent to outer voxels. Note that, a boundary voxel must be a feature voxel, but a feature voxel is not necessarily a boundary voxel (refer to Fig. 2). For clarity, the processing to the voxelization is illustrated by 2-dimensional rectangular mesh in Figs. 2 and 3.

Moreover, to make the approximation of the boundary mesh 
                           V
                         to the triangular mesh 
                           P
                         as close as possible, each feature voxel should satisfy the following two conditions: 
                           
                              (i)
                              Each feature voxel is a boundary voxel, and,

each feature voxel contains a continuous patch of the triangular mesh 
                                    P
                                 .

Furthermore, to shorten the distance between the boundary mesh 
                           V
                         and the given triangular mesh 
                           P
                        , some boundary voxels should be deleted (Fig. 3). Consider these boundary voxels whose three adjacent faces are all boundary faces. For each of these boundary voxels, denoting the vertex adjacent to the three boundary faces as 
                           v
                        , supposing 
                           
                              
                                 d
                              
                              
                                 1
                              
                           
                         is the distance between 
                           v
                         and the triangular mesh 
                           V
                        , and 
                           
                              
                                 d
                              
                              
                                 2
                              
                           
                         is the distance between the vertex opposite to 
                           v
                         and the triangular mesh 
                           V
                        , if 
                           
                              
                                 d
                              
                              
                                 2
                              
                           
                           <
                           
                              
                                 d
                              
                              
                                 1
                              
                           
                        , the boundary voxel should be deleted, labeling as outer voxel (see Fig. 3). After deleting some boundary voxels in this way, the boundary mesh 
                           V
                         can be made closer to the triangular mesh 
                           P
                         (see Figs. 3 and 1
                        (c)).
                        
                     


                        Fig. 1 demonstrates the procedure of the initial all-hex mesh construction. Fig. 9(a) is the input triangular mesh model 
                           V
                        , and Fig. 1(a) is the voxelization of the input triangular mesh model. The initial all-hex mesh is generated after adaptive subdivision (Fig. 1(b)) and further deleting some boundary voxels (Fig. 1(c)).

Finally, the boundary quadrilateral mesh of the initial all-hex mesh (Fig. 1(c)) is extracted as the initial boundary mesh 
                           V
                        , which will be fitted to the given triangular mesh 
                           P
                        .

As stated above, in the CVIF algorithm 1, the boundary quadrilateral mesh 
                           V
                         will be fitted to the given triangular mesh 
                           P
                        . The iterative fitting procedure of the boundary mesh 
                           V
                         constitutes the constrained surface iterative fitting algorithm (abbr. CSIF). Note that existing subdivision fitting algorithms take the limit surface of subdivision as the approximating surface. This does not meet the requirement of hex mesh generation, which relies on a mesh after finite time subdivision rather than the subdivision limit surface. Therefore, the CSIF algorithm developed in this section takes the mesh surface after finite time subdivisions as the approximating surface.

Taking the quadrilateral surface mesh 
                           V
                         to be the initial control mesh of a surface subdivision procedure, a mesh surface denoted as 
                           
                              
                                 V
                              
                              
                                 γ
                              
                           
                         will be generated after 
                           γ
                         time surface subdivisions. Moreover, supposing that the vertices of 
                           V
                         and 
                           P
                         are 
                           v
                         and 
                           p
                        , and called control points and data points, respectively, each iteration of the CSIF algorithm includes the following steps: 
                           
                              (i)
                              For each data point 
                                    p
                                 , compute the closest mesh vertex 
                                    
                                       
                                          v
                                       
                                       
                                          
                                             cl
                                          
                                          ,
                                          γ
                                       
                                    
                                  on mesh 
                                    
                                       
                                          V
                                       
                                       
                                          γ
                                       
                                    
                                 ;

calculate the difference vector 
                                    
                                       δ
                                    
                                    =
                                    p
                                    −
                                    
                                       
                                          v
                                       
                                       
                                          
                                             cl
                                          
                                          ,
                                          γ
                                       
                                    
                                  for each data point 
                                    p
                                 , and distribute it to the related control points on mesh 
                                    V
                                  that generate the vertex 
                                    
                                       
                                          v
                                       
                                       
                                          
                                             cl
                                          
                                          ,
                                          γ
                                       
                                    
                                 ;

for each control point 
                                    v
                                 , averaging the difference vectors distributed to it produces the difference vector 
                                    
                                       Δ
                                    
                                  for the control point;

adding the difference vector 
                                    
                                       Δ
                                    
                                  to the control point 
                                    v
                                  generates the new control point 
                                    
                                       
                                          v
                                       
                                       
                                          
                                             new
                                          
                                       
                                    
                                  of the new control mesh, 
                                    
                                       (1)
                                       
                                          
                                             
                                                v
                                             
                                             
                                                
                                                   new
                                                
                                             
                                          
                                          =
                                          v
                                          +
                                          
                                             Δ
                                          
                                          .
                                       
                                    
                                 
                              

The first step is to compute the closest vertex 
                           
                              
                                 v
                              
                              
                                 
                                    cl
                                 
                                 ,
                                 γ
                              
                           
                         on the mesh surface 
                           
                              
                                 V
                              
                              
                                 γ
                              
                           
                         for each vertex 
                           p
                        , which is performed using KD tree. To make the shape of subdivision fitting surface faithful to that of the given triangular mesh, the distance between two vertices should consider not only the location closeness, but also the normal similarity at the two vertices. Therefore, we map each vertex 
                           v
                         in three dimensional Euclidean space to six dimensional feature sensitive space 
                        
                           
                              (
                              v
                              ,
                              w
                              l
                              
                                 n
                              
                              )
                           
                           [39,40], where 
                           
                              n
                           
                         is the normalized normal vector at the vertex 
                           v
                        , 
                           l
                         is the diagonal length of the bounding box of the triangular mesh model, and 
                           w
                         is a weight, set as 
                           w
                           =
                           0.2
                         in our implementation. For any given data point 
                           p
                        , we map it to the six dimensional feature sensitive space, and then calculate the closest vertex in the six dimensional space.

It should be pointed out that in the first five iterations, we compute the closest vertex on the mesh surface 
                           
                              
                                 V
                              
                              
                                 γ
                              
                           
                         for each data point on mesh 
                           P
                        . Afterwards, the parameters of the closest points on the mesh surface 
                           
                              
                                 V
                              
                              
                                 γ
                              
                           
                         are fixed for reducing the computational load. Moreover, to avoid self-intersection, the Laplace smoothing operation is performed after each of the first five iterations.

The second step is to construct the difference vector for data point 
                        
                           p
                        , i.e., 
                           
                              (2)
                              
                                 
                                    δ
                                 
                                 =
                                 p
                                 −
                                 
                                    
                                       v
                                    
                                    
                                       
                                          cl
                                       
                                       ,
                                       γ
                                    
                                 
                                 .
                              
                           
                         This difference vector will be distributed to the related control points of the control mesh 
                           V
                         (Fig. 4
                        ). Recall that the mesh vertex on mesh 
                           
                              
                                 V
                              
                              
                                 γ
                              
                           
                         is a linear combination of the related control points 
                           
                              
                                 v
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 2
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 v
                              
                              
                                 n
                              
                           
                         of the control mesh 
                           V
                        , i.e., 
                           
                              (3)
                              
                                 
                                    
                                       v
                                    
                                    
                                       
                                          cl
                                       
                                       ,
                                       γ
                                    
                                 
                                 =
                                 
                                    
                                       c
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       v
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       c
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       v
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 ⋯
                                 +
                                 
                                    
                                       c
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       v
                                    
                                    
                                       n
                                    
                                 
                                 ,
                                 
                                 with
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       c
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 1
                                 ,
                              
                           
                         where the coefficients 
                           
                              
                                 c
                              
                              
                                 i
                              
                           
                           ,
                           i
                           =
                           1
                           ,
                           2
                           ,
                           …
                           ,
                           n
                         can be easily obtained by the corresponding stationary linear surface subdivision rule. Thus, the weighted difference vector 
                           
                              
                                 c
                              
                              
                                 i
                              
                           
                           
                              δ
                           
                         is distributed to the control point 
                           
                              
                                 v
                              
                              
                                 i
                              
                           
                           ,
                           i
                           =
                           1
                           ,
                           2
                           ,
                           …
                           ,
                           n
                         (Fig. 4).

As the third step, all of the difference vectors 
                           
                              {
                              
                                 
                                    c
                                 
                                 
                                    j
                                 
                              
                              
                                 
                                    
                                       δ
                                    
                                 
                                 
                                    j
                                 
                              
                              }
                           
                         distributed to a control point 
                           v
                         are collected and averaged in the following manner, 
                           
                              (4)
                              
                                 
                                    Δ
                                 
                                 =
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                          
                                       
                                       
                                          
                                             c
                                          
                                          
                                             j
                                          
                                       
                                       
                                          
                                             
                                                δ
                                             
                                          
                                          
                                             j
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                          
                                       
                                       
                                          
                                             c
                                          
                                          
                                             j
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                         to generate the difference vector 
                        
                           
                              Δ
                           
                         
                        for control point 
                        
                           v
                        .

Finally, adding 
                           
                              Δ
                           
                         to the control point 
                           v
                        , generates the new control point 
                           
                              
                                 v
                              
                              
                                 
                                    new
                                 
                              
                           
                         (Eq. (1)) of the new control mesh.

The four steps above are performed iteratively until 
                           
                              
                                 
                                    |
                                    
                                       
                                          
                                             
                                                e
                                             
                                             
                                                
                                                   (
                                                   k
                                                   +
                                                   1
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                e
                                             
                                             
                                                
                                                   (
                                                   k
                                                   )
                                                
                                             
                                          
                                       
                                    
                                    −
                                    1
                                    |
                                 
                                 <
                                 
                                    
                                       ε
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 
                                 with
                                 
                                 
                                    
                                       e
                                    
                                    
                                       
                                          (
                                          k
                                          )
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                
                                                   m
                                                
                                             
                                             
                                                
                                                   
                                                      ‖
                                                      
                                                         
                                                            
                                                               δ
                                                            
                                                         
                                                         
                                                            j
                                                         
                                                         
                                                            
                                                               (
                                                               k
                                                               )
                                                            
                                                         
                                                      
                                                      ‖
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             m
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 e
                              
                              
                                 
                                    (
                                    k
                                    )
                                 
                              
                           
                         is the root mean square (RMS) fitting error of the 
                           k
                        th iteration (refer to Section  3.4), and 
                           
                              
                                 ε
                              
                              
                                 0
                              
                           
                         is a threshold. In our implementation, we take 
                           
                              
                                 ε
                              
                              
                                 0
                              
                           
                           =
                           1
                           
                              
                                 0
                              
                              
                                 −
                                 3
                              
                           
                        .


                        Construction of constrained region for quality guarantee: As stated above, in each iteration of the CSIF algorithm, and the Laplace smoothing operation (5), the vertex of the boundary mesh 
                           v
                         is moved. The movement of the boundary mesh vertex should be constrained to ensure the quality of the all-hex mesh, i.e., the scaled Jacobian value at each mesh vertex is greater than 0.

As pointed out in Ref.  [4] (see Fig. 5
                        ), the scaled Jacobian value at vertex 
                           v
                         is the scaled volume of the tetrahedron v-ABC (Fig. 5(a)). Suppose the scaled Jacobian value at 
                           v
                         is positive in Fig. 5(a). When 
                           v
                         moves on the plane 
                           A
                           B
                           C
                         (see Fig. 5(b)), its scaled Jacobian value is zero. When 
                           v
                         moves to the other side of the plane 
                           A
                           B
                           C
                         (Fig. 5(c)), its scaled Jacobian value changes to a negative value. Therefore, if the movement of the vertex 
                           v
                         keeps at the same side of the plane 
                           A
                           B
                           C
                        , the sign of its Jacobian value will not change.

Take a regular inner vertex 
                           v
                         as an example. In an all-hex mesh, the regular inner mesh vertex 
                           v
                         is adjacent to six mesh vertices, and eight hexahedra. So the movement of the vertex 
                           v
                         affects the scaled Jacobian values at seven mesh vertices, i.e., the vertex 
                           v
                         itself, and its six adjacent vertices. To make the sign of the Jacobian value at 
                           v
                         unchanged, its movement should lie in the same sides of 8 planes, each of which is determined by the three vertices adjacent to 
                           v
                         in the same hexahedron (corresponding to the green lines in Fig. 6
                        ). Similarly, to make the sign of the Jacobian value at a vertex 
                           
                              
                                 v
                              
                              
                                 ′
                              
                           
                         adjacent to 
                           v
                         unchanged, the movement of 
                           v
                         should keep in the same sides of 4 planes, each of which is determined by 
                           
                              
                                 v
                              
                              
                                 ′
                              
                           
                         and its two adjacent vertices on the boundary faces of the mesh model constituted by the eight hexahedra adjacent to 
                           v
                        . Therefore, to make the signs of the Jacobian values at the six vertices adjacent to 
                           v
                         unchanged, the movement of 
                           v
                         should keep in the same sides of such 
                           4
                           ×
                           6
                           =
                           24
                         planes (corresponding to the red lines in Fig. 6). In conclusion, if the movement of the vertex 
                           v
                         keeps in the region enclosed by the so constructed 
                           24
                           +
                           8
                           =
                           32
                         planes, the signs of the Jacobian values at 
                           v
                         and its six adjacent vertices will remain unchanged. The so constructed region is named a constrained region for the vertex 
                           v
                        . (see Fig. 6).

Suppose 
                           v
                           =
                           
                              (
                              
                                 
                                    x
                                 
                                 
                                    v
                                 
                              
                              ,
                              
                                 
                                    y
                                 
                                 
                                    v
                                 
                              
                              ,
                              
                                 
                                    z
                                 
                                 
                                    v
                                 
                              
                              )
                           
                        , and the equations of the 32 planes aforementioned are, respectively, 
                           
                              
                                 
                                    
                                       P
                                    
                                    
                                       i
                                    
                                 
                                 
                                    (
                                    x
                                    ,
                                    y
                                    ,
                                    z
                                    )
                                 
                                 =
                                 
                                    
                                       a
                                    
                                    
                                       i
                                    
                                 
                                 x
                                 +
                                 
                                    
                                       b
                                    
                                    
                                       i
                                    
                                 
                                 y
                                 +
                                 
                                    
                                       c
                                    
                                    
                                       i
                                    
                                 
                                 z
                                 +
                                 
                                    
                                       d
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 0
                                 ,
                                 
                                 i
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 32
                                 .
                              
                           
                         Moreover, suppose that the Jacobian value at each mesh vertex of an all-hex mesh before a new iteration is positive, to perform a new iteration, the constrained region can be modeled as the following system of inequalities, 
                           
                              
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   P
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      v
                                                   
                                                
                                                ,
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      v
                                                   
                                                
                                                ,
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      v
                                                   
                                                
                                                )
                                             
                                             
                                                (
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      1
                                                   
                                                
                                                x
                                                +
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      1
                                                   
                                                
                                                y
                                                +
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      1
                                                   
                                                
                                                z
                                                +
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                             
                                             >
                                             0
                                             ,
                                          
                                       
                                       
                                          
                                             
                                                
                                                   P
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      v
                                                   
                                                
                                                ,
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      v
                                                   
                                                
                                                ,
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      v
                                                   
                                                
                                                )
                                             
                                             
                                                (
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      2
                                                   
                                                
                                                x
                                                +
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      2
                                                   
                                                
                                                y
                                                +
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      2
                                                   
                                                
                                                z
                                                +
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      2
                                                   
                                                
                                                )
                                             
                                             >
                                             0
                                             ,
                                          
                                       
                                       
                                          
                                             ⋯
                                          
                                       
                                       
                                          
                                             
                                                
                                                   P
                                                
                                                
                                                   32
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      v
                                                   
                                                
                                                ,
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      v
                                                   
                                                
                                                ,
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      v
                                                   
                                                
                                                )
                                             
                                             
                                                (
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      32
                                                   
                                                
                                                x
                                                +
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      32
                                                   
                                                
                                                y
                                                +
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      32
                                                   
                                                
                                                z
                                                +
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      32
                                                   
                                                
                                                )
                                             
                                             >
                                             0
                                             .
                                          
                                       
                                    
                                 
                              
                           
                         It should be pointed out that, the constrained region for an irregular mesh vertex can be constructed in the similar way.

In each iteration of the CSIF algorithm, the difference vector 
                           
                              Δ
                           
                         for control point is added to the boundary mesh vertex 
                           v
                        . If the new vertex 
                           
                              
                                 v
                              
                              
                                 
                                    new
                                 
                              
                           
                           =
                           v
                           +
                           
                              Δ
                           
                         exceeds the constrained region of 
                           v
                        , a weight 
                           ω
                           ,
                           
                           
                              (
                              0
                              ≤
                              ω
                              ≤
                              1
                              )
                           
                        , as large as possible, is multiplied in front of 
                           
                              Δ
                           
                        , to make that the new vertex 
                           
                              
                                 v
                              
                              
                                 
                                    new
                                 
                              
                           
                           =
                           v
                           +
                           ω
                           
                              Δ
                           
                         is guaranteed to stay in the constrained region of 
                           v
                        . In our implementation, we uniformly discretize 
                           
                              [
                              0
                              ,
                              1
                              ]
                           
                         into 
                           
                              
                                 ω
                              
                              
                                 i
                              
                           
                           ,
                           
                           i
                           =
                           0
                           ,
                           1
                           ,
                           …
                           ,
                           10
                        , and take the largest 
                           
                              
                                 ω
                              
                              
                                 i
                              
                           
                         which makes 
                           
                              
                                 v
                              
                              
                                 
                                    new
                                 
                              
                           
                           =
                           v
                           +
                           
                              
                                 ω
                              
                              
                                 i
                              
                           
                           
                              Δ
                           
                         be in the constrained region as the weight. In this way, the movement of the boundary mesh vertex is constrained, and the quality of the all-hex mesh is ensured.

Similarly, the movement of the mesh vertex in the Laplace smoothing operation (5) is also kept in its constrained region.

The convergence of the CSIF algorithm is shown in Section  3.4.

In the above section, we presented the CSIF algorithm for surface mesh fitting. After each iteration of the CSIF algorithm, the movement of the boundary mesh vertices should be diffused to the inner vertices of the all-hex mesh. In this section, to make the movement diffusion efficient, we develop a level Laplacian operation to diffuse the movement of the surface mesh vertices.

Firstly, the inner vertices are classified into levels according to their adjacency to the vertices of boundary mesh 
                           V
                        . Specifically, the inner vertices in one-ring adjacency to the boundary mesh vertices are the first-level vertices; the left inner vertices in one-ring adjacency to the first-level vertices are the second-level vertices; 
                           ⋯
                        ; and so on.

Next, fixing the positions of the boundary mesh vertices, the first-level vertices 
                           v
                         are moved to the new position 
                           
                              
                                 v
                              
                              
                                 
                                    new
                                 
                              
                           
                         by the following Laplacian operation, 
                           
                              (5)
                              
                                 
                                    
                                       v
                                    
                                    
                                       
                                          new
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                             =
                                             1
                                          
                                          
                                             d
                                             
                                                (
                                                v
                                                )
                                             
                                          
                                       
                                       
                                          
                                             v
                                          
                                          
                                             j
                                          
                                       
                                    
                                    
                                       d
                                       
                                          (
                                          v
                                          )
                                       
                                    
                                 
                                 ,
                              
                           
                         where, 
                           d
                           
                              (
                              v
                              )
                           
                         is the degree of the vertex 
                           v
                        , and 
                           
                              
                                 v
                              
                              
                                 j
                              
                           
                         are the vertices in the one-ring neighborhood of 
                           v
                        . In succession, the first-level vertices are fixed and the second-level vertices are moved by (5), …, and so on, until all levels of the inner vertices are adjusted. This procedure is performed iteratively until the ratio between the largest movement distance and the diagonal length of the bounding box of mesh 
                           P
                         is below a prescribed threshold 
                           T
                        . In our implementation, 
                           T
                         is taken as 10−7.

To ensure the all-hex mesh quality, the vertex movement in the movement diffusion should also satisfy the vertex movement constraint stated in Section  3.2. The CSIF fitting and the constrained movement diffusion therein constitute the CVIF algorithm. When this algorithm stops, we obtain a control all-hex mesh. An all-hex volume mesh filling the given triangular mesh 
                           P
                         can be generated by subdividing the control all-hex mesh 
                           γ
                         times with the corresponding volume subdivision rule.

In this section, we will show the convergence of the CSIF algorithm. Starting with the initial control mesh 
                           
                              
                                 V
                              
                              
                                 
                                    (
                                    0
                                    )
                                 
                              
                           
                           =
                           V
                        , the control mesh after the 
                           k
                        th iteration is denoted as 
                           
                              
                                 V
                              
                              
                                 
                                    (
                                    k
                                    )
                                 
                              
                           
                        , which has 
                           n
                         mesh vertices 
                           
                              
                                 v
                              
                              
                                 i
                              
                              
                                 
                                    (
                                    k
                                    )
                                 
                              
                           
                           ,
                           i
                           =
                           1
                           ,
                           2
                           ,
                           …
                           ,
                           n
                        , called control points. Subdividing the control mesh 
                           
                              
                                 V
                              
                              
                                 
                                    (
                                    k
                                    )
                                 
                              
                           
                           γ
                         times generates the mesh surface 
                           
                              
                                 V
                              
                              
                                 γ
                              
                              
                                 
                                    (
                                    k
                                    )
                                 
                              
                           
                        . Moreover, suppose the given mesh 
                           P
                         has 
                           m
                         vertices 
                           
                              
                                 p
                              
                              
                                 j
                              
                           
                           ,
                           
                           j
                           =
                           1
                           ,
                           2
                           ,
                           …
                           ,
                           m
                        , called data points, where 
                           m
                           >
                           n
                        . To show the convergence of the CSIF algorithm, we rewrite Eqs. (2)–(4) with indices in the following.

In the 
                           k
                        th iteration, the difference vector for the data point 
                           
                              
                                 p
                              
                              
                                 j
                              
                           
                         is, 
                           
                              (6)
                              
                                 
                                    
                                       
                                          δ
                                       
                                    
                                    
                                       j
                                    
                                    
                                       
                                          (
                                          k
                                          )
                                       
                                    
                                 
                                 =
                                 
                                    
                                       p
                                    
                                    
                                       j
                                    
                                 
                                 −
                                 
                                    
                                       v
                                    
                                    
                                       j
                                       ,
                                       γ
                                    
                                    
                                       
                                          (
                                          k
                                          )
                                       
                                    
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 v
                              
                              
                                 j
                                 ,
                                 γ
                              
                              
                                 
                                    (
                                    k
                                    )
                                 
                              
                           
                         is the point on the mesh surface 
                           
                              
                                 V
                              
                              
                                 γ
                              
                              
                                 
                                    (
                                    k
                                    )
                                 
                              
                           
                         with fixed parameter after the fifth iteration. It is a linear combination of related control points, i.e., 
                           
                              (7)
                              
                                 
                                    
                                       v
                                    
                                    
                                       j
                                       ,
                                       γ
                                    
                                    
                                       
                                          (
                                          k
                                          )
                                       
                                    
                                 
                                 =
                                 
                                    
                                       c
                                    
                                    
                                       j
                                       ,
                                       1
                                    
                                 
                                 
                                    
                                       v
                                    
                                    
                                       1
                                    
                                    
                                       
                                          (
                                          k
                                          )
                                       
                                    
                                 
                                 +
                                 
                                    
                                       c
                                    
                                    
                                       j
                                       ,
                                       2
                                    
                                 
                                 
                                    
                                       v
                                    
                                    
                                       2
                                    
                                    
                                       
                                          (
                                          k
                                          )
                                       
                                    
                                 
                                 +
                                 ⋯
                                 +
                                 
                                    
                                       c
                                    
                                    
                                       j
                                       ,
                                       n
                                    
                                 
                                 
                                    
                                       v
                                    
                                    
                                       n
                                    
                                    
                                       
                                          (
                                          k
                                          )
                                       
                                    
                                 
                                 ,
                                 
                                 with
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       c
                                    
                                    
                                       j
                                       ,
                                       i
                                    
                                 
                                 =
                                 1
                                 .
                              
                           
                         By first distributing the weighted difference vector 
                           
                              
                                 c
                              
                              
                                 j
                                 ,
                                 i
                              
                           
                           
                              
                                 
                                    δ
                                 
                              
                              
                                 j
                              
                              
                                 
                                    (
                                    k
                                    )
                                 
                              
                           
                         to the control point 
                           
                              
                                 v
                              
                              
                                 i
                              
                              
                                 
                                    (
                                    k
                                    )
                                 
                              
                           
                        , and then gathering the weighted difference vectors for each control point in the following manner, 
                           
                              (8)
                              
                                 
                                    
                                       
                                          Δ
                                       
                                    
                                    
                                       i
                                    
                                    
                                       
                                          (
                                          k
                                          )
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                             ∈
                                             
                                                
                                                   I
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                       
                                          
                                             c
                                          
                                          
                                             j
                                             ,
                                             i
                                          
                                       
                                       
                                          
                                             
                                                δ
                                             
                                          
                                          
                                             j
                                          
                                          
                                             
                                                (
                                                k
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                             ∈
                                             
                                                
                                                   I
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                       
                                          
                                             c
                                          
                                          
                                             j
                                             ,
                                             i
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       ∈
                                       
                                          
                                             I
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             c
                                          
                                          
                                             j
                                             ,
                                             i
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                             ∈
                                             
                                                
                                                   I
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                       
                                          
                                             c
                                          
                                          
                                             j
                                             ,
                                             i
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          δ
                                       
                                    
                                    
                                       j
                                    
                                    
                                       
                                          (
                                          k
                                          )
                                       
                                    
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 I
                              
                              
                                 i
                              
                           
                         is the index set of the data points which distribute their difference vectors to the control point 
                           
                              
                                 v
                              
                              
                                 i
                              
                              
                                 k
                              
                           
                        , we get the difference vector 
                           
                              
                                 
                                    Δ
                                 
                              
                              
                                 i
                              
                              
                                 
                                    (
                                    k
                                    )
                                 
                              
                           
                         for the control point 
                           
                              
                                 v
                              
                              
                                 i
                              
                              
                                 
                                    (
                                    k
                                    )
                                 
                              
                           
                        . Finally, adding 
                           
                              
                                 
                                    Δ
                                 
                              
                              
                                 i
                              
                              
                                 
                                    (
                                    k
                                    )
                                 
                              
                           
                         to the control point 
                           
                              
                                 v
                              
                              
                                 i
                              
                              
                                 
                                    (
                                    k
                                    )
                                 
                              
                           
                         generates the new control point, i.e.,  
                           
                              
                                 
                                    
                                       v
                                    
                                    
                                       i
                                    
                                    
                                       
                                          (
                                          k
                                          +
                                          1
                                          )
                                       
                                    
                                 
                                 =
                                 
                                    
                                       v
                                    
                                    
                                       i
                                    
                                    
                                       
                                          (
                                          k
                                          )
                                       
                                    
                                 
                                 +
                                 
                                    
                                       ω
                                    
                                    
                                       i
                                    
                                    
                                       
                                          (
                                          k
                                          )
                                       
                                    
                                 
                                 
                                    
                                       
                                          Δ
                                       
                                    
                                    
                                       i
                                    
                                    
                                       
                                          (
                                          k
                                          )
                                       
                                    
                                 
                                 ,
                                 
                                 i
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 n
                                 ,
                              
                           
                         where, 
                           
                              
                                 ω
                              
                              
                                 i
                              
                              
                                 
                                    (
                                    k
                                    )
                                 
                              
                           
                           ,
                           
                           
                              (
                              0
                              <
                              
                                 
                                    ω
                                 
                                 
                                    i
                                 
                                 
                                    
                                       (
                                       k
                                       )
                                    
                                 
                              
                              ≤
                              1
                              )
                           
                         is a weight to ensure that the new vertex 
                           
                              
                                 v
                              
                              
                                 i
                              
                              
                                 
                                    (
                                    k
                                    +
                                    1
                                    )
                                 
                              
                           
                         satisfies the vertex movement constraint.

Arranging the difference vectors for control points in a sequence, 
                           
                              
                                 
                                    
                                       Δ
                                    
                                    
                                       
                                          (
                                          k
                                          )
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          [
                                          
                                             
                                                
                                                   Δ
                                                
                                             
                                             
                                                1
                                             
                                             
                                                
                                                   (
                                                   k
                                                   )
                                                
                                             
                                          
                                          ,
                                          
                                             
                                                
                                                   Δ
                                                
                                             
                                             
                                                2
                                             
                                             
                                                
                                                   (
                                                   k
                                                   )
                                                
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                
                                                   Δ
                                                
                                             
                                             
                                                n
                                             
                                             
                                                
                                                   (
                                                   k
                                                   )
                                                
                                             
                                          
                                          ]
                                       
                                    
                                    
                                       T
                                    
                                 
                                 ,
                              
                           
                         the iterative format can be represented in matrix form, 
                           
                              (9)
                              
                                 
                                    
                                       Δ
                                    
                                    
                                       
                                          (
                                          k
                                          +
                                          1
                                          )
                                       
                                    
                                 
                                 =
                                 
                                    (
                                    I
                                    −
                                    
                                       
                                          Λ
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          A
                                       
                                       
                                          T
                                       
                                    
                                    A
                                    
                                       
                                          Λ
                                       
                                       
                                          2
                                       
                                       
                                          
                                             (
                                             k
                                             )
                                          
                                       
                                    
                                    )
                                 
                                 
                                    
                                       Δ
                                    
                                    
                                       
                                          (
                                          k
                                          )
                                       
                                    
                                 
                                 ,
                              
                           
                         where 
                           I
                         is an identity matrix, 
                           
                              
                                 Λ
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 Λ
                              
                              
                                 2
                              
                              
                                 
                                    (
                                    k
                                    )
                                 
                              
                           
                         are diagonal matrices, 
                           
                              
                                 
                                    
                                       
                                          Λ
                                       
                                       
                                          1
                                       
                                    
                                    =
                                    
                                       diag
                                    
                                    
                                       {
                                       
                                          
                                             1
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   j
                                                   ∈
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   c
                                                
                                                
                                                   j
                                                   ,
                                                   1
                                                
                                             
                                          
                                       
                                       ,
                                       
                                          
                                             1
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   j
                                                   ∈
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   c
                                                
                                                
                                                   j
                                                   ,
                                                   2
                                                
                                             
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             1
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   j
                                                   ∈
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   c
                                                
                                                
                                                   j
                                                   ,
                                                   n
                                                
                                             
                                          
                                       
                                       }
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          Λ
                                       
                                       
                                          2
                                       
                                       
                                          
                                             (
                                             k
                                             )
                                          
                                       
                                    
                                    =
                                    
                                       diag
                                    
                                    
                                       {
                                       
                                          
                                             ω
                                          
                                          
                                             1
                                          
                                          
                                             
                                                (
                                                k
                                                )
                                             
                                          
                                       
                                       ,
                                       
                                          
                                             ω
                                          
                                          
                                             2
                                          
                                          
                                             
                                                (
                                                k
                                                )
                                             
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             ω
                                          
                                          
                                             n
                                          
                                          
                                             
                                                (
                                                k
                                                )
                                             
                                          
                                       
                                       }
                                    
                                    ,
                                 
                              
                           
                         and, 
                           
                              
                                 A
                                 =
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   1
                                                   ,
                                                   1
                                                
                                             
                                          
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   1
                                                   ,
                                                   2
                                                
                                             
                                          
                                          
                                             ⋯
                                          
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   1
                                                   ,
                                                   n
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   2
                                                   ,
                                                   1
                                                
                                             
                                          
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   2
                                                   ,
                                                   2
                                                
                                             
                                          
                                          
                                             ⋯
                                          
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   2
                                                   ,
                                                   n
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             ⋯
                                          
                                          
                                             ⋯
                                          
                                          
                                       
                                       
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   m
                                                   ,
                                                   1
                                                
                                             
                                          
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   m
                                                   ,
                                                   2
                                                
                                             
                                          
                                          
                                             ⋯
                                          
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   m
                                                   ,
                                                   n
                                                
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 .
                              
                           
                         Note that Eq. (9) is a non-stationary iterative format.

First, we will show that if the weights 
                           
                              
                                 ω
                              
                              
                                 i
                              
                              
                                 
                                    (
                                    k
                                    )
                                 
                              
                           
                           ,
                           i
                           =
                           0
                           ,
                           1
                           ,
                           …
                           ,
                           n
                         do not change in the iterations, i.e., 
                           
                              
                                 ω
                              
                              
                                 i
                              
                              
                                 
                                    (
                                    k
                                    )
                                 
                              
                           
                           =
                           
                              
                                 ω
                              
                              
                                 i
                              
                           
                           ∈
                           
                              (
                              0
                              ,
                              1
                              ]
                           
                           ,
                           i
                           =
                           0
                           ,
                           1
                           ,
                           …
                           ,
                           n
                        , the iteration is convergent. In this case, 
                           
                              
                                 Λ
                              
                              
                                 2
                              
                              
                                 
                                    (
                                    k
                                    )
                                 
                              
                           
                           =
                           
                              
                                 Λ
                              
                              
                                 2
                              
                           
                           =
                           
                              diag
                           
                           
                              {
                              
                                 
                                    ω
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    ω
                                 
                                 
                                    2
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    ω
                                 
                                 
                                    n
                                 
                              
                              }
                           
                        , and Eq. (9) becomes a stationary iterative format. Actually, on one hand, if 
                           
                              
                                 A
                              
                              
                                 T
                              
                           
                           A
                         is nonsingular, it is positive definite, so all of its eigenvalues are positive. Because 
                           
                              
                                 Λ
                              
                              
                                 2
                              
                           
                         is also positive definite, all of the eigenvalues of 
                           
                              
                                 A
                              
                              
                                 T
                              
                           
                           A
                           
                              
                                 Λ
                              
                              
                                 2
                              
                           
                         are positive. Therefore, the eigenvalues of 
                           
                              
                                 Λ
                              
                              
                                 1
                              
                           
                           
                              
                                 A
                              
                              
                                 T
                              
                           
                           A
                           
                              
                                 Λ
                              
                              
                                 2
                              
                           
                         are also positive, i.e., 
                           λ
                           
                              (
                              
                                 
                                    Λ
                                 
                                 
                                    1
                                 
                              
                              
                                 
                                    A
                                 
                                 
                                    T
                                 
                              
                              A
                              
                                 
                                    Λ
                                 
                                 
                                    2
                                 
                              
                              )
                           
                           >
                           0
                        . On the other hand, since 
                           
                              ‖
                              
                                 
                                    Λ
                                 
                                 
                                    1
                                 
                              
                              
                                 
                                    A
                                 
                                 
                                    T
                                 
                              
                              A
                              
                                 
                                    Λ
                                 
                                 
                                    2
                                 
                              
                              ‖
                           
                           ≤
                           1
                        , all of its eigenvalues are less than or equal to 1, i.e., 
                           λ
                           
                              (
                              
                                 
                                    Λ
                                 
                                 
                                    1
                                 
                              
                              
                                 
                                    A
                                 
                                 
                                    T
                                 
                              
                              A
                              
                                 
                                    Λ
                                 
                                 
                                    2
                                 
                              
                              )
                           
                           ≤
                           1
                        . Therefore, the spectral radius of the matrix 
                           I
                           −
                           
                              
                                 Λ
                              
                              
                                 1
                              
                           
                           
                              
                                 A
                              
                              
                                 T
                              
                           
                           A
                           
                              
                                 Λ
                              
                              
                                 2
                              
                           
                         satisfies 
                           ρ
                           
                              (
                              I
                              −
                              
                                 
                                    Λ
                                 
                                 
                                    1
                                 
                              
                              
                                 
                                    A
                                 
                                 
                                    T
                                 
                              
                              A
                              
                                 
                                    Λ
                                 
                                 
                                    2
                                 
                              
                              )
                           
                           <
                           1
                        , and the corresponding iterative format is convergent.

Moreover, if the weights 
                           
                              
                                 ω
                              
                              
                                 i
                              
                              
                                 
                                    (
                                    k
                                    )
                                 
                              
                           
                           ,
                           
                           i
                           =
                           0
                           ,
                           1
                           ,
                           …
                           ,
                           n
                         change in each iteration, Eq. (9) becomes a non-stationary iterative format. In this case, we need a convergence condition, 
                           
                              (10)
                              
                                 
                                    
                                       
                                          ‖
                                          I
                                          −
                                          
                                             
                                                Λ
                                             
                                             
                                                1
                                             
                                          
                                          
                                             
                                                A
                                             
                                             
                                                T
                                             
                                          
                                          A
                                          
                                             
                                                Λ
                                             
                                             
                                                2
                                             
                                             
                                                
                                                   (
                                                   k
                                                   )
                                                
                                             
                                          
                                          ‖
                                       
                                    
                                    
                                       ∞
                                    
                                 
                                 ≤
                                 q
                                 <
                                 1
                                 .
                              
                           
                         Denote 
                           
                              
                                 
                                    ‖
                                    
                                       
                                          
                                             Δ
                                          
                                       
                                       
                                          i
                                       
                                       
                                          
                                             (
                                             k
                                             )
                                          
                                       
                                    
                                    ‖
                                 
                              
                              
                                 E
                              
                           
                         as the Euclidean norm of 
                           
                              
                                 
                                    Δ
                                 
                              
                              
                                 i
                              
                              
                                 
                                    (
                                    k
                                    )
                                 
                              
                           
                        , let, 
                           
                              
                                 
                                    
                                       Φ
                                    
                                    
                                       
                                          (
                                          k
                                          )
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          [
                                          
                                             
                                                ϕ
                                             
                                             
                                                i
                                                j
                                             
                                             
                                                
                                                   (
                                                   k
                                                   )
                                                
                                             
                                          
                                          ]
                                       
                                    
                                    
                                       n
                                       ×
                                       n
                                    
                                 
                                 =
                                 I
                                 −
                                 
                                    
                                       Λ
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       A
                                    
                                    
                                       T
                                    
                                 
                                 A
                                 
                                    
                                       Λ
                                    
                                    
                                       2
                                    
                                    
                                       
                                          (
                                          k
                                          )
                                       
                                    
                                 
                                 ,
                              
                           
                         and define 
                           
                              
                                 
                                    ‖
                                    
                                       
                                          Δ
                                       
                                       
                                          
                                             (
                                             k
                                             )
                                          
                                       
                                    
                                    ‖
                                 
                              
                              
                                 M
                              
                           
                           =
                           max
                           
                              {
                              
                                 
                                    
                                       ‖
                                       
                                          
                                             
                                                Δ
                                             
                                          
                                          
                                             i
                                          
                                          
                                             
                                                (
                                                k
                                                )
                                             
                                          
                                       
                                       ‖
                                    
                                 
                                 
                                    E
                                 
                              
                              ,
                              i
                              =
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              n
                              }
                           
                        . Because, 
                           
                              
                                 
                                    
                                       
                                          ‖
                                          
                                             
                                                Φ
                                             
                                             
                                                
                                                   (
                                                   k
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                Δ
                                             
                                             
                                                
                                                   (
                                                   k
                                                   )
                                                
                                             
                                          
                                          ‖
                                       
                                    
                                    
                                       M
                                    
                                 
                                 =
                                 
                                    
                                       max
                                    
                                    
                                       i
                                    
                                 
                                 
                                    {
                                    
                                       
                                          
                                             ‖
                                             
                                                
                                                   ∑
                                                
                                                
                                                   j
                                                
                                             
                                             
                                                
                                                   α
                                                
                                                
                                                   i
                                                   j
                                                
                                             
                                             
                                                
                                                   
                                                      Δ
                                                   
                                                
                                                
                                                   j
                                                
                                                
                                                   
                                                      (
                                                      k
                                                      )
                                                   
                                                
                                             
                                             ‖
                                          
                                       
                                       
                                          E
                                       
                                    
                                    }
                                 
                                 ≜
                                 
                                    
                                       
                                          ‖
                                          
                                             
                                                ∑
                                             
                                             
                                                j
                                             
                                          
                                          
                                             
                                                α
                                             
                                             
                                                m
                                                j
                                             
                                          
                                          
                                             
                                                
                                                   Δ
                                                
                                             
                                             
                                                j
                                             
                                             
                                                
                                                   (
                                                   k
                                                   )
                                                
                                             
                                          
                                          ‖
                                       
                                    
                                    
                                       E
                                    
                                 
                                 ≤
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                    
                                 
                                 
                                    |
                                    
                                       
                                          α
                                       
                                       
                                          m
                                          j
                                       
                                    
                                    |
                                 
                                 
                                    
                                       
                                          ‖
                                          
                                             
                                                
                                                   Δ
                                                
                                             
                                             
                                                j
                                             
                                             
                                                
                                                   (
                                                   k
                                                   )
                                                
                                             
                                          
                                          ‖
                                       
                                    
                                    
                                       E
                                    
                                 
                                 ≤
                                 
                                    (
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                       
                                    
                                    
                                       |
                                       
                                          
                                             α
                                          
                                          
                                             m
                                             j
                                          
                                       
                                       |
                                    
                                    )
                                 
                                 
                                    
                                       max
                                    
                                    
                                       j
                                    
                                 
                                 
                                    
                                       
                                          ‖
                                          
                                             
                                                
                                                   Δ
                                                
                                             
                                             
                                                j
                                             
                                             
                                                
                                                   (
                                                   k
                                                   )
                                                
                                             
                                          
                                          ‖
                                       
                                    
                                    
                                       E
                                    
                                 
                                 ≤
                                 
                                    
                                       
                                          ‖
                                          
                                             
                                                Φ
                                             
                                             
                                                
                                                   (
                                                   k
                                                   )
                                                
                                             
                                          
                                          ‖
                                       
                                    
                                    
                                       ∞
                                    
                                 
                                 
                                    
                                       
                                          ‖
                                          
                                             
                                                Δ
                                             
                                             
                                                
                                                   (
                                                   k
                                                   )
                                                
                                             
                                          
                                          ‖
                                       
                                    
                                    
                                       M
                                    
                                 
                                 ,
                              
                           
                         we have, 
                           
                              
                                 
                                    
                                       
                                          ‖
                                          
                                             
                                                Δ
                                             
                                             
                                                
                                                   (
                                                   k
                                                   +
                                                   1
                                                   )
                                                
                                             
                                          
                                          ‖
                                       
                                    
                                    
                                       M
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ‖
                                          
                                             
                                                Φ
                                             
                                             
                                                
                                                   (
                                                   k
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                Δ
                                             
                                             
                                                
                                                   (
                                                   k
                                                   )
                                                
                                             
                                          
                                          ‖
                                       
                                    
                                    
                                       M
                                    
                                 
                                 ≤
                                 
                                    
                                       
                                          ‖
                                          
                                             
                                                Φ
                                             
                                             
                                                
                                                   (
                                                   k
                                                   )
                                                
                                             
                                          
                                          ‖
                                       
                                    
                                    
                                       ∞
                                    
                                 
                                 
                                    
                                       
                                          ‖
                                          
                                             
                                                Δ
                                             
                                             
                                                
                                                   (
                                                   k
                                                   )
                                                
                                             
                                          
                                          ‖
                                       
                                    
                                    
                                       M
                                    
                                 
                                 ≤
                                 
                                    
                                       
                                          ‖
                                          
                                             
                                                Φ
                                             
                                             
                                                
                                                   (
                                                   k
                                                   )
                                                
                                             
                                          
                                          ‖
                                       
                                    
                                    
                                       ∞
                                    
                                 
                                 
                                    
                                       
                                          ‖
                                          
                                             
                                                Φ
                                             
                                             
                                                
                                                   (
                                                   k
                                                   −
                                                   1
                                                   )
                                                
                                             
                                          
                                          ‖
                                       
                                    
                                    
                                       ∞
                                    
                                 
                                 
                                    
                                       
                                          ‖
                                          
                                             
                                                Δ
                                             
                                             
                                                
                                                   (
                                                   k
                                                   −
                                                   1
                                                   )
                                                
                                             
                                          
                                          ‖
                                       
                                    
                                    
                                       M
                                    
                                 
                                 ≤
                                 ⋯
                                 ≤
                                 
                                    
                                       
                                          ‖
                                          
                                             
                                                Φ
                                             
                                             
                                                
                                                   (
                                                   k
                                                   )
                                                
                                             
                                          
                                          ‖
                                       
                                    
                                    
                                       ∞
                                    
                                 
                                 ⋯
                                 
                                    
                                       
                                          ‖
                                          
                                             
                                                Φ
                                             
                                             
                                                
                                                   (
                                                   1
                                                   )
                                                
                                             
                                          
                                          ‖
                                       
                                    
                                    
                                       ∞
                                    
                                 
                                 
                                    
                                       
                                          ‖
                                          
                                             
                                                Δ
                                             
                                             
                                                
                                                   (
                                                   1
                                                   )
                                                
                                             
                                          
                                          ‖
                                       
                                    
                                    
                                       M
                                    
                                 
                                 ≤
                                 
                                    
                                       q
                                    
                                    
                                       k
                                    
                                 
                                 
                                    
                                       
                                          ‖
                                          
                                             
                                                Δ
                                             
                                             
                                                
                                                   (
                                                   1
                                                   )
                                                
                                             
                                          
                                          ‖
                                       
                                    
                                    
                                       M
                                    
                                 
                                 .
                              
                           
                         Therefore, if the convergence condition (10) holds, 
                           
                              
                                 lim
                              
                              
                                 k
                                 →
                                 ∞
                              
                           
                           
                              
                                 
                                    ‖
                                    
                                       
                                          Δ
                                       
                                       
                                          
                                             (
                                             k
                                             )
                                          
                                       
                                    
                                    ‖
                                 
                              
                              
                                 M
                              
                           
                           =
                           0
                        , i.e., the iterative format (9) is convergent. 
                           Remark
                           Note that the iterative format (9) and its convergence analysis do not involve any concrete volume subdivision rule, so they are valid for any stationary linear hex volume subdivision rule, including the subdivision rule developed in Ref.  [35], and MLCA presented in Ref.  [36].

Till now, we have gotten an all-hex mesh each of whose vertices has a positive scaled Jacobian value. Moreover, postprocessing should be performed to make the all-hex mesh preserve the features, and improve its mesh quality.


                        Feature preservation: To make the all-hex mesh preserve the features in the given triangular mesh 
                           P
                        , we select some edges in the boundary mesh of the generated all-hex mesh, whose vertices will be fitted to the features in the triangular mesh 
                           P
                        . Then, extra CSIF iterations (without subdivision) are performed to the selected vertices, to make them fit the features in the given mesh 
                           P
                        . In this way, most features in the mesh 
                           P
                         can be preserved. However, because the generated all-hex mesh contains lots of singular vertices, and lacks structure in the resulting edge flow, it is difficult to preserve all of the features.


                        Fig. 7
                         demonstrates the result of the feature preservation strategy stated above. In this example, the sharp features in the all-hex mesh model fan disk generated by the CVIF algorithm are smoothed (Fig. 7(a)). After performing the aforementioned feature preservation strategy, the features are recovered (Fig. 7(b)). Fig. 7(c) is the diagram of the distribution of scaled Jacobian values of the all-hex mesh demonstrated in Fig. 7(b). We can see that all of the Jacobian values are greater than 0, and over 90% of them lie in the interval 
                           
                              [
                              0.8
                              ,
                              1.0
                              ]
                           
                        .


                        Mesh quality improvement: In the all-hex mesh generated by the CVIF algorithm, the poor hexahedra with too small positive scaled Jacobian values mainly concentrate in the boundary level. Therefore, to improve the mesh quality, a pillowing operation  [41] is carried out just on the boundary level hexahedra.

Finally, the quality of the all-hex mesh is further improved by the Mesquite software  [10].


                        Fig. 8
                         illustrates the result of the aforementioned mesh quality improvement technique. The cutaway view of the all-hex mesh before pillowing is presented in Fig. 8(a), where the quality of the boundary level hex mesh is very poor. After pillowing and mesh quality improvement by Mesquite software  [10], the mesh quality is greatly improved, as shown by the cutaway view in Fig. 8(b). Zooms of the cutaway views in Fig. 8(a) and (b) are demonstrated in Fig. 8(c) and (d), respectively. Fig. 9
                        (b) is the all-hex mesh model Fertility after mesh quality improvement, and Fig. 9(c) is the diagram of the distribution of scaled Jacobian values of the all-hex mesh model Fertility. Over 80% of them lie in the interval 
                           
                              [
                              0.8
                              ,
                              1
                              ]
                           
                        .

@&#RESULTS AND DISCUSSIONS@&#

The CVIF algorithm has been implemented with Visual C++, and run on a PC with Intel Core2 Quad CPU Q9400 2.66 GHz and 4G memory. We tested the CVIF algorithm by a lot of examples. Some of them were illustrated in Figs. 7–11
                     
                     . Moreover, we presented the diagram of the distribution of scaled Jacobian values along with each example. In these diagrams, the abscissa axis is the scaled Jacobian value intervals  [2,4], and the vertical axis represents the ratio of the number of hexes whose scaled Jacobian values lie in the corresponding interval and the total number of the hexes of the all-hex mesh model.

Moreover, the statistics on these examples were listed in Table 1
                     . In Table 1, the fitting precision is represented by the ratio between the last RMS error and the diagonal length of the bounding box of given mesh 
                        P
                     , and the runtime is in seconds. It can be seen from Table 1 that, the scaled Jacobian values of these examples are all greater than 0, and the average scaled Jacobian values of these examples are all over 0.8. Of four of these example, the average scaled Jacobian values even exceed 0.9. On the other hand, the runtime cost by these examples varies between several minutes to twenty minutes.

In Fig. 10, we illustrated four examples that are generated by the CVIF algorithm without subdivision. Figs. 10(a–d) are the four all-hex mesh models, Rocker Arm, Torus Knits, Santa, and Isis, respectively. Figs. 10(e–h) are their cutaway views. Figs. 10(i–l) are the diagrams of the distribution of their scaled Jacobian values. In the all-hex mesh models of Rocker Arm and Isis, over 80% scaled Jacobian values lie in the interval 
                        
                           [
                           0.8
                           ,
                           1
                           ]
                        
                     . In the all-hex mesh models of Santa and Torus Knits, over 70% and nearly 60% scaled Jacobian values are in the interval 
                        
                           [
                           0.8
                           ,
                           1
                           ]
                        
                     , respectively. It should be pointed out that, in Figs. 7 and 8, the all-hex mesh models Fan disk and Fertility are also generated by the CVIF algorithm without subdivision.

In Fig. 11, there are two examples that are generated by the CVIF algorithm with one MLCA  [36] subdivision. Figs. 11(a, b) are the two all-hex mesh models Ball Joint and Rabbit. Figs. 11(c, d) are their cutaway views. Figs. 11(e, f) are diagrams of the distribution of their scaled Jacobian values. In the two all-hex mesh models, 80% scaled Jacobian values or so lie in the interval 
                        
                           [
                           0.8
                           ,
                           1
                           ]
                        
                     . It can also be seen from Table 1 that, the average scaled Jacobian values of the all-hex mesh models Ball Joint   Fig. 11(a) and Rabbit   Fig. 11(b) are 0.8969 and 0.9155, respectively.

We can see from Table 1 that, except the model Fandisk in Fig. 7(b), there are only several (not more than 5) hexes whose scaled Jacobian values are less than 0.2. In the model Fandisk in Fig. 7(b), even the shape preserving operation deteriorates the hex mesh quality, there are just 45 hexes whose scaled Jacobian values are less than 0.2.

Because there are usually just several hexes whose scaled Jacobian values are less than 0.2, we can improve the mesh quality at these hexes by some interactions. The statistics of the hex mesh model after some interactions were listed in Table 2
                     . It can be seen that the minimum scaled Jacobian values have been improved greatly.


                     Comparison with prevailing hex mesh generation methods: The differences between our CVIF algorithm and other prevailing all-hex mesh generation methods, such as polycube based methods  [5,6], and frame field guided methods  [24–26], mainly lie in two aspects. Firstly, while the prevailing methods need to input a tet mesh, the input to the CVIF is just a triangular mesh, which are widely employed in computer graphics and CAD community. Secondly and more importantly, though these prevailing hex mesh generation methods can produce all-hex mesh with high quality, they lose strategy to ensure that the generated all-hex mesh is a valid mesh, i.e., they cannot ensure that the scaled Jacobian value of each hex is larger than 0. However, the CVIF algorithm developed in this paper can guarantee that all of the scaled Jacobian values of the generated all-hex mesh model are greater than 0. Last but not least, the quality of the hex mesh generated by our CVIF algorithm is comparable to that produced by the state-of-the-art hex mesh generation algorithms (refer to Tables 1 and 2 and Refs.  [22,23]).

Moreover, we compared our CVIF algorithm with the state-of-the-art octree-based all-hex mesh generation method, i.e., Hexotic  [42], which has been integrated to the software MeshGems as a component Hexa  [43] (v1.2-1). MeshGems-Hexa should be run through SALOME (v7.4.0)  [44]. In our implementation, the MeshGems-Hexa (through SALOME) was run on a MacBook Pro with 2.6 GHz Intel Core i5 CPU, 8 GB 1600 MHz DDR3 memory, Intel Iris graphic card, and 256G solid state disk, which is much more powerful than the platform where our CVIF algorithm was run. The statistics on MeshGems-Hexa were listed in Table 3
                     . It should be pointed out that, because MeshGems-Hexa exploits parallel computing, and the platform it was run is much more powerful than that our algorithm was run, the computing time of MeshGems-Hexa is shorter than our algorithm. However, comparing Table 3 with Tables 1 and 2, we can see that, even in the case that the fitting precisions of the CVIF algorithm are higher than those of MeshGems-Hexa, the averaged and minimum scaled Jacobian values of the all-hexes generated by CVIF algorithm (Table 2) are still better than those produced by MeshGems-Hexa (Table 3). Furthermore, the numbers of hexes with scaled Jacobian in 
                        
                           (
                           0
                           ,
                           0.2
                           )
                        
                      and 
                        
                           [
                           0.2
                           ,
                           0.4
                           )
                        
                      of the all-hex meshes generated by our CVIF algorithm (Table 2) are much smaller than those produced by MeshGems-Hexa (Table 3).

One limitation of the CVIF algorithm lies in the feature preservation. Because the sharp edges on the triangular mesh model are not considered in the voxelization procedure, not all of the sharp edges on the triangular mesh model have correspondences on the boundary mesh of the all-hex mesh model. This makes the feature preservation results unsatisfactory in some cases, and restricts the application domain of the developed method. As the future work, the feature preservation capability will be improved by both considering the sharp edges in the voxelization procedure, and performing pillowing operation in the post-processing procedure.

On the other hand, the speed of the CVIF algorithm is a bit slow. However, this algorithm is easy to parallelize. In the future, we will implement the algorithm by GPU to improve the running speed.

Another limitation of the CVIF algorithm is that the number of the singular vertices on the boundary mesh of the generated all-hex mesh model is a bit large. The singular vertices on the boundary mesh are introduced in the initial all-hex control mesh by voxelization. As a future work, the voxelization rule will be improved to reduce the number of the singular vertices.

As stated above, the initial all-hex mesh has great influence on the finally generated all-hex mesh. In Fig. 12
                        , we illustrate an all-hex mesh model filling the triangular mesh model Fig. 9(a), generated by the CVIF algorithm. But the initial all-hex mesh is constructed by the skeleton-based method developed in the technical report  [45]. It can be seen that the two all-hex mesh models, illustrated in Figs. 9(b) and 12(a) are different. Therefore, one of our future work is to develop a method to construct the desirable initial all-hex mesh.

On the other hand, we note that, in each iteration of the CVIF algorithm, if the weights are chosen appropriately (refer to Section  3.2), the scaled Jacobian values of the generated all-hex mesh can be made greater than a suitably assigned value. In the all-hex mesh model illustrated in Fig. 13
                        , the weights are so selected that the scaled Jacobian values are greater than 0.2. But, meanwhile, the fitting precision is made worse when the termination condition of the iteration is satisfied. In Fig. 13, while the minimum scaled Jacobian value is 0.2, the fitting precision is only 0.0017. As a future work, we will improve the CVIF algorithm so that it not only guarantees the scaled Jacobian values greater than a suitable value, e.g., 
                           0.1
                           ,
                           
                           0.2
                        , but also ensures the fitting precision at the same time.

@&#CONCLUSION@&#

In this paper, we presented the CVIF algorithm to filling a given triangular mesh model 
                        P
                      with an all-hex mesh. First, we constructed an initial all-hex mesh by voxelizing the given triangular mesh 
                        P
                     . By adaptive subdivision and boundary mesh extraction, the boundary quadrilateral mesh 
                        V
                      of the generated voxelization is faithful to the triangular mesh 
                        P
                     , thus getting a desirable initial all-hex mesh for the CVIF algorithm. Next, the boundary mesh 
                        V
                      is fitted to the triangular mesh 
                        P
                      iteratively. After each iteration of the boundary mesh 
                        V
                     , the movements of the mesh vertices of 
                        V
                      are diffused into the inner mesh vertices of the all-hex mesh. In the above iterations, the movements of the boundary and inner mesh vertices are constrained to ensure that the scaled Jacobian value at each mesh vertex is larger than 0. Therefore, the mesh quality of the generated all-hex mesh model is guaranteed.

@&#ACKNOWLEDGMENTS@&#

This paper is supported by National Natural Science Foundation of China (Nos. 61379072, 60970150).

@&#REFERENCES@&#

