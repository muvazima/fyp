@&#MAIN-TITLE@&#Digital modeling technology for full dental crown tooth preparation

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A new automatic digital modeling technology is proposed to design full dental crown tooth preparation.


                        
                        
                           
                           Margin line of the tooth preparation could be designed in advance.


                        
                        
                           
                           The implicit surface of a radial basis function was used to quickly and accurately construct the tooth preparation׳s occlusal surface.


                        
                        
                           
                           Our method can guarantee the design accuracy of the full crown tooth preparation (e.g. the shoulder width and the convergence).


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Digital modeling for tooth preparation

Margin line

Convergence angle

Parametric constraints

Implicit surface

@&#ABSTRACT@&#


               
               
                  A dental defect is one of the most common oral diseases, and it often requires a full crown restoration. In this clinical operation, the dentist must manually prepare the affected tooth for the full crown so that it has a convergence angle between 4° and 10°, no undercuts, and uniform and even shoulder widths and depths using a high speed diamond bur in the patient׳s mouth within one hour, which is a difficult task that requires visual–manual operation. The quality of the tooth preparation has an important effect on the success rate of the subsequent prosthodontic treatment. This study involved research into digital modeling technology for full dental crown tooth preparation. First, the margin line of the tooth preparation was designed using a semi-automatic interactive process. Second, the inserting direction was automatically computed. Then, the characteristic parameters and the constraints on the tooth preparation were defined for the model. Next, the shoulder and axial surface of the tooth preparation were formed using parametric modeling. Finally, the implicit surface of a radial basis function was used to construct the tooth preparation׳s occlusal surface. The experimental results verified that the method of digital modeling for full crown preparation proposed in this study can quickly and accurately implement personalized designs of various parameters, such as the shoulder width and the convergence angle; it provides a digital design tool for full crown preparation.
               
            

@&#INTRODUCTION@&#

A dental defect is one of the most common hard tooth tissue diseases in oral clinical practice [1]. Full dental crowns and other prosthodontic methods are often needed to reconstruct the anatomy of the affected tooth and the physiological function of chewing. Currently, this is the most widely used prosthodontic technology. The purpose of tooth preparation is to create a suitable three-dimensional restoration space for a full crown restoration made from a known material by applying the subtraction process to the affected tooth. The quality of the tooth preparation is significant for the functional esthetic effect of the reconstruction of the affected tooth and the long-term prognosis of the dental restoration.

The morphology of a full crown tooth preparation must satisfy mechanical, biological, and esthetic requirements. First, a shape that promotes retention is conducive to soundness and durability when the prosthesis is subjected to the mechanical effects of the occlusion system. The total occlusal convergence (TOC) of the tooth preparation is an important retention indicator. Wilson et al. [2] reported that a TOC between 6° and 12° maximizes the tensile retention. After further study, Petal et al. [3] proposed an ideal convergence standard of between 4° and 10°. Second, the morphological design of the tooth preparation should minimize the ablation of healthy hard tissue in the remaining tooth, and the crown׳s anatomy should be as similar as possible to reduce the excessive exposure and loss of dentin and to avoid wear to the marrow and tooth fracture. The study of Emara et al. [4] showed that the morphology of a tooth preparation should match that of the crown as much as possible so that the tooth tissue can be removed evenly. Edelhoff et al. [5] proposed a system for classifying comprehensive designs of full dental crown tooth preparations, and the measurement system used in this study provided an accurate method for quantifying the removal of tooth structure for a fixed prosthodontic preparation. Third, the different morphology of the prepared tooth margin affects the stress distribution when the prosthesis is in place. The study of Kohorst et al. [6] showed that the load capacity of the tooth preparation is the key factor in the long-term clinical reliability of a prosthesis. Sandu et al. [7] performed a finite element analysis of the following five margin morphologies: shoulderless, chamfer, shoulder, sloped shoulder, and beveled shoulder. The results showed that the shoulder and beveled shoulder morphologies had superior biomechanical properties. The above-mentioned studies primarily focused on the evaluation and optimization of clinical manual preparation methods.

Currently, the growing demand for high-quality dental restoration leads to more challenges for dentists using an on-site manual ablation technique to form the tooth preparation. These challenges are (1) High quality is required: the design of a prosthodontic preparation often requires the elimination of all undercuts on the axial surface so that it matches the convergence angle, opens the space for the prosthesis׳s restoration, and has a shape that promotes retention and resistance. (2) The operating space is small: the dentist must perform the operation in a small and semi-closed oral cavity with obstructions due to the soft tissue of the tongue, the lips, and the cheek muscles. (3) The operation is very difficult: the dentist is required to manually perform a large number of duplicated and laborious small-scale operations, and human visual bias may make the manual positioning difficult to control. Nuha et al. [8] analyzed the quality of 117 models prepared by senior dental students, and the results showed that the average convergence angle was 39.98° and the average buccal and lingual convergence angle was 44.1°, which deviated significantly from the ideal convergence angle of between 4° and 10° proposed by Petal et al. [3]. The above-mentioned problems result in difficulties in the operation for the dentists, which leads to the low accuracy and efficiency of the preparation and seriously affects the quality of the restoration with a fixed prostheses.

As a result of the rapid development of digital technology in recent years, intraoral scanning technology is being introduced into clinical practice. Silvia et al. [9] thoroughly analyzed the basic principles of an intraoral scanning system and its advantages and limitations. Oliver et al. [10] investigated the accuracy of digital modeling with the four main types of intraoral scanners currently used, and the experimental results showed that the accuracies of the intraoral scanners at the margin and at internal gaps were clinically acceptable. The technology developed for direct intraoral measurement provides accurate data for digital tooth preparation. The technique of tooth preparation has also developed from a traditional grinding process to laser ablation. Krüger et al. [11] pioneered the use of a femtosecond laser for micro-cutting dentin and enamel, and the experimental results showed that this cutting method can not only enhance the structural strength of the tooth surface but also suppress the microcracks generated during the cutting process. Kraft et al. [12] used an ultrashort pulse laser to remove tartar from a root surface. Bello-Silva et al. [13] conducted precise cutting experiments on dental hard tissue using an ultrashort pulse laser to establish a relationship between the laser׳s parameters and its efficiency at removing dental hard tissue. The cutting technology of short pulse lasers used on dental tissue has gradually become more precise, which provides an important technical foundation for precise tooth cutting when digital technology is used for dental preparation. The development of these technologies will allow automatic digital tooth preparation technology to soon become a reality [14].

Three-dimensional modeling technology for personalized tooth preparation is a key intermediate step in digitally preparing a full crown; the process proceeds from intraoral scanning to intraoral cutting. However, the literature on the use of digital modeling technology for tooth preparation is sparse. Yuan et al. [15] reported that based on the three-dimensional dental data they obtained, a number of industrial computer aided design (CAD) software packages were jointly used to complete one digital design for a full crown tooth preparation; implementing it with a low degree of automation was complex. Chu et al. [16] proposed a design method based on the human characteristics of a specific case. This method used a principal component analysis (PCA) of the object to describe the main semantic parameters of the body for the reconstruction. Because the reconstruction of the main components was simplified, the precision of the model designed decreased. Samuel et al. [17] proposed a personalized method of designing a model based on a parameter-driven curve that was able to design a model for personalized foot correction. Cheung et al. [18] combined finite element analysis and the Taguchi method in their analysis of the parametric design of a personalized foot orthosis to effectively reduce the pressure distribution on the foot. Wang [19] proposed a new feature-based design that first extracted semantic features to construct a characteristic skeleton curve, and then, a Gregory patch was used to fit the characteristic curve network to rapidly establish a personalized model controlled by the semantic features.

This study proposed an intuitive, easy-to-operate, and feature parameterization-based approach to modeling tooth preparation. A dental preparation design system was developed to help dentists quickly personalize the morphological features of the tooth preparation for a patient, which can reduce the complexity of the tooth preparation process, improve its quality and efficiency, and provide an important technical foundation for the rapid development of automatic technology for oral preparation.

All participants enrolled and the experimental procedures in this study are in accordance with the Declaration of Helsinki (revised in Edinburgh 2000). All subjects signed an informed consent form to participate in a protocol that was approved by the Ethics Committee of Peking University School and Hospital of Stomatology, P.R. China (No. PKUSSIRB-201522044).

The automatic modeling procedures for tooth preparation include the following: (1) The acquisition of three-dimensional data from the affected tooth׳s surface. The affected tooth was firstly filled with a dental materials that temporarily restored the occlusal surface׳s morphology. The recovery tooth was directly scanned using an intraoral three-dimensional scanner or a plaster model of the recovery tooth was scanned in vitro to obtain three-dimensional data. (2) The design of the margin line. Based on the principles behind preparation design, the feature line was rapidly extracted in the vicinity of the gingival margin to define the margin line of the subsequent tooth preparation. (3) The calculation of the inserting direction. In accordance with the position and morphology of the gingival line, the inserting direction of the tooth preparation was automatically extracted. (4) The modeling of the tooth preparation based on its morphology. In accordance with the design parameters desired for the tooth preparation (such as the shoulder width and the occlusal convergence angle), the morphology of the tooth preparation was modeled automatically (
                        Fig. 1).

The margin line is the outer boundary of a tooth preparation shoulder; it is often placed at or above the level of the gingival margin in posterior full crown restorations. Once three-dimensional data for the tooth crown have been obtained by scanning (as shown in 
                        Fig. 2(a)), the characteristics of the gingival margin can be analyzed, and the curvature of the mesh surface can be estimated using local quadratic surface fitting with a local quadratic surface, 
                           
                              g
                           
                           
                              (
                              
                                 
                                    u
                                 
                                 
                                    ,
                                 
                                 
                                    v
                                 
                              
                              )
                           
                        , such that
                           
                              (1)
                              
                                 
                                    g
                                 
                                 
                                    (
                                    
                                       
                                          u
                                       
                                       
                                          ,
                                       
                                       
                                          v
                                       
                                    
                                    )
                                 
                                 
                                    =
                                 
                                 
                                    
                                       au
                                    
                                    
                                       2
                                    
                                 
                                 
                                    +
                                 
                                 
                                    buv
                                 
                                 
                                    +
                                 
                                 
                                    c
                                 
                                 
                                    
                                       v
                                    
                                    
                                       2
                                    
                                 
                                 
                                    +
                                 
                                 
                                    eu
                                 
                                 
                                    +
                                 
                                 
                                    fv
                                 
                                 .
                              
                           
                        
                     

The blue area in the gingival margin in Fig. 2(b) represents the distribution of the mean curvature points within the threshold range. Using the set of feature points near the gingival margin and the heuristic algorithm developed by Dai et al. [20] to identify the feature line, the gingival margin line can be automatically extracted by selecting three feature points near the gingival margin. The resulting gingival line can be used as the margin line for the subsequent parts of the design process.

In the inserting direction, the prosthesis enters the tooth preparation with a minimal or nonexistent barrier along the axial surface. This direction is a standard reference point for the axial tilt in the design of a tooth preparation and plays an important role in improving the prosthesis׳s position. The inserting direction of a crown prosthesis is generally unique and parallel to the long axis of the tooth crown.
                           
                              1.
                              The inserting direction when there is no root

Data describing the three-dimensional surface of the reproduced plaster model were obtained using an optical scanner, and its crown 
                           
                              M
                           
                         was defined by extracting the margin line. 
                           
                              
                                 P
                              
                              
                                 c
                              
                           
                         is the centroid of the crown 
                           
                              M
                           
                        , the boundary point set of the crown 
                           
                              M
                           
                         is 
                           
                              {
                              
                                 
                                    
                                       S
                                    
                                    
                                       t
                                    
                                 
                                 
                                    ,
                                    
                                    t
                                    =
                                    0
                                    ,
                                    …
                                    ,
                                    n
                                 
                              
                              }
                           
                        , and the initial positioning direction is 
                           
                              
                                 Dir
                              
                              ⇀
                           
                        , as shown in 
                        Fig. 3(a).
                           
                              (2)
                              
                                 
                                    
                                       
                                          Dir
                                       
                                       
                                          ⇀
                                       
                                    
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          n
                                       
                                    
                                    
                                       
                                          ∑
                                       
                                       
                                          t
                                          =
                                          0
                                       
                                       
                                          n
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            C
                                                         
                                                      
                                                      
                                                         −
                                                      
                                                      
                                                         
                                                            S
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                   
                                                   )
                                                
                                                ⇀
                                             
                                             
                                                ×
                                             
                                             
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            C
                                                         
                                                      
                                                      
                                                         −
                                                      
                                                      
                                                         
                                                            S
                                                         
                                                         
                                                            
                                                               t
                                                            
                                                            
                                                               +
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                   )
                                                
                                                ⇀
                                             
                                          
                                          
                                             |
                                             
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            
                                                               P
                                                            
                                                            
                                                               C
                                                            
                                                         
                                                         
                                                            −
                                                         
                                                         
                                                            
                                                               S
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                   ⇀
                                                
                                                
                                                   ×
                                                
                                                
                                                   
                                                      
                                                         (
                                                         
                                                            
                                                               
                                                                  P
                                                               
                                                               
                                                                  C
                                                               
                                                            
                                                            
                                                               −
                                                            
                                                            
                                                               
                                                                  S
                                                               
                                                               
                                                                  
                                                                     t
                                                                  
                                                                  
                                                                     +
                                                                     1
                                                                  
                                                               
                                                            
                                                         
                                                         )
                                                      
                                                      ⇀
                                                   
                                                
                                                |
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The inserting direction can be fine-tuned using the interactive method shown in Fig. 3(b).
                           
                              (2)
                              The inserting direction when there is a root

A model that includes the root of the affected tooth provides a more accurate reference for assessing the stress on the affected tooth, which is the mechanical basis for the inserting direction of the prosthesis. However, due to the different morphologies of the roots of incisors, premolars, and molars, determining the inserting direction can be challenging. First, CT and optical scanning were simultaneously performed on the affected tooth, then, a three-dimensional reconstruction of the tooth model was created; it is shown in 
                        Fig. 4(a) and (b). Second, the model was registered using the multi-source data fusion method proposed by Xu et al. [21] and shown in Fig. 4(c) and (d). Then, the post-fusion tooth model was divided using the geodesic distance from the geodesic origin at the approximate center point of the tooth׳s occlusal surface. The geodesic distance was determined using the Dijkstra algorithm. The geodesic interval was divided into k equal parts after normalization. When k=7, the area of the model׳s surface was as shown in Fig. 4(e). The geometric center of each region was computed. Next, the inserting direction was fitted using the method of least squares. Users can fine-tune the inserting direction using the interaction based on the morphology of the root.

To model the tooth preparation, it is necessary to consider the constraints on the important feature parameters, including the shoulder width 
                              
                                 w
                              
                           ; the shoulder angle 
                              
                                 β
                              
                           ; the occlusal convergence angle 
                              
                                 2
                              
                              
                                 α
                              
                           ; and the occlusal preparation thickness 
                              
                                 d
                              
                           . Because tooth morphology is complex, the surface is primarily modeled using a triangular mesh. Mature industry modeling based on parametric designs using spline surface technology is not sufficient for modeling the mesh surface; therefore, automated feature-based modeling using the parameters for the semantic characteristics of the tooth preparation has certain difficulties. Currently, after preliminary manual preparation by a dentist, the measurements of the tooth preparation are mainly statistical measurements of the parameters of its sampling sections. Using the idea of cross-sectional measurement as a reference, this study proposed a method that converts complex three-dimensional model based on multiple parametric constraints into a surface model with discrete constraints based on integrating the parametric section, which improve the degree of automation and robustness of the modeling process. A cross-section, 
                              
                                 
                                    S
                                 
                                 
                                    i
                                 
                              
                           , in the inserting direction, 
                              
                                 
                                    Dir
                                 
                                 ⇀
                              
                           , is selected; 
                              {
                              
                                 
                                    
                                       R
                                    
                                    
                                       i
                                    
                                 
                                 
                                    }
                                 
                              
                            is defined as the set of boundary points of the extracted margin line described above, 
                              
                                 {
                              
                              
                                 
                                    Q
                                 
                                 
                                    i
                                 
                              
                              
                                 }
                              
                            is the set of boundary points of the shoulder margin line, 
                              
                                 {
                              
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                              
                                 }
                              
                            is the set of boundary points of the axial and occlusal surfaces, 
                              
                                 
                                    O
                                 
                                 
                                    i
                                 
                              
                            is the projection of 
                              
                                 
                                    R
                                 
                                 
                                    i
                                 
                              
                            onto the inserting direction, 
                              
                                 
                                    C
                                 
                                 
                                    0
                                    i
                                 
                              
                            is a section of the curve describing the morphology of tooth crown, and 
                              
                                 
                                    
                                       C
                                    
                                    
                                       i
                                    
                                 
                                 
                                    (
                                    t
                                    )
                                    =
                                    (
                                 
                                 
                                    
                                       P
                                    
                                    
                                       i
                                    
                                    
                                       
                                       x
                                    
                                 
                                 
                                    (
                                    
                                       t
                                    
                                    )
                                 
                                 
                                    ,
                                 
                                 
                                    
                                       P
                                    
                                    
                                       i
                                    
                                    
                                       
                                       y
                                    
                                 
                                 
                                    (
                                    
                                       t
                                    
                                    )
                                 
                                 
                                    )
                                 
                              
                            is the approximate offset curve. By solving Eqs. (2) and (3), 
                              
                                 {
                                 
                                    
                                       
                                          Q
                                       
                                       
                                          i
                                       
                                    
                                 
                                 }
                              
                            and 
                              
                                 {
                              
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                              
                                 }
                              
                            on each cross-section that has the feature parameters of the tooth preparation can be calculated as shown in 
                           Fig. 5(a).
                              
                                 (3)
                                 
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   
                                                      γ
                                                   
                                                   
                                                      =
                                                   
                                                   
                                                      β
                                                   
                                                   
                                                      −
                                                   
                                                   
                                                      α
                                                   
                                                   
                                                      −
                                                      90
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         cos
                                                      
                                                      
                                                         γ
                                                      
                                                   
                                                   
                                                      =
                                                   
                                                   
                                                      
                                                         
                                                            (
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 O
                                                                              
                                                                              
                                                                                 i
                                                                              
                                                                           
                                                                           
                                                                              −
                                                                           
                                                                           
                                                                              R
                                                                           
                                                                        
                                                                        
                                                                           i
                                                                        
                                                                     
                                                                  
                                                               
                                                               ⇀
                                                            
                                                            )
                                                         
                                                         
                                                            ⋅
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     V
                                                                  
                                                                  
                                                                     2
                                                                  
                                                               
                                                            
                                                            ⇀
                                                         
                                                      
                                                      
                                                         
                                                            |
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 O
                                                                              
                                                                              
                                                                                 i
                                                                              
                                                                           
                                                                           
                                                                              −
                                                                           
                                                                           
                                                                              R
                                                                           
                                                                        
                                                                        
                                                                           i
                                                                        
                                                                     
                                                                  
                                                                  ⇀
                                                               
                                                            
                                                            |
                                                         
                                                         ⋅
                                                         
                                                            |
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           V
                                                                        
                                                                        
                                                                           2
                                                                        
                                                                     
                                                                  
                                                                  ⇀
                                                               
                                                            
                                                            |
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               Q
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         
                                                            =
                                                         
                                                         
                                                            R
                                                         
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   
                                                      +
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            
                                                               w
                                                            
                                                            
                                                               
                                                                  cos
                                                               
                                                               
                                                                  γ
                                                               
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                   ⋅
                                                   
                                                      
                                                         
                                                            
                                                               V
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                      
                                                      ⇀
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (4)
                                 
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         C
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   
                                                      (
                                                      t
                                                   
                                                   
                                                      )
                                                      =
                                                   
                                                   
                                                      
                                                         C
                                                      
                                                      
                                                         
                                                            0
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                   
                                                      (
                                                      t
                                                   
                                                   
                                                      )
                                                      +
                                                   
                                                   
                                                      d
                                                   
                                                   ⋅
                                                   
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            (
                                                         
                                                         
                                                            t
                                                         
                                                         
                                                            )
                                                         
                                                      
                                                      ⇀
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      cos
                                                   
                                                   
                                                      α
                                                   
                                                   
                                                      =
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               (
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              Q
                                                                           
                                                                           
                                                                              i
                                                                           
                                                                        
                                                                        
                                                                           −
                                                                        
                                                                        
                                                                           P
                                                                        
                                                                     
                                                                     
                                                                        i
                                                                     
                                                                  
                                                               
                                                               )
                                                            
                                                            ⇀
                                                         
                                                         
                                                            ⋅
                                                         
                                                         
                                                            
                                                               Dir
                                                            
                                                            ⇀
                                                         
                                                      
                                                      
                                                         
                                                            |
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 Q
                                                                              
                                                                              
                                                                                 i
                                                                              
                                                                           
                                                                           
                                                                              −
                                                                           
                                                                           
                                                                              P
                                                                           
                                                                        
                                                                        
                                                                           i
                                                                        
                                                                     
                                                                  
                                                                  ⇀
                                                               
                                                            
                                                            |
                                                         
                                                         ⋅
                                                         
                                                            |
                                                            
                                                               
                                                                  
                                                                     Dir
                                                                  
                                                                  ⇀
                                                               
                                                            
                                                            |
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

The shoulder and the axial surface of the tooth preparation are key points for positioning and fixing the prosthesis and important parts of the parametric construction of the tooth preparation. For the shoulder and the axial surface, 
                              
                                 
                                    Q
                                 
                                 
                                    i
                                 
                              
                            and 
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                            in section 
                              
                                 
                                    S
                                 
                                 
                                    i
                                 
                              
                            can be calculated based on the constraints on the parameters, including the shoulder width, the shoulder angle, and the occlusal convergence angle, and the section set 
                              {
                              
                                 
                                    
                                       S
                                    
                                    
                                       i
                                    
                                 
                                 
                                    }
                                 
                              
                            with an axial angle of 
                              
                                 
                                    θ
                                 
                                 
                                    i
                                 
                              
                            can be generated using the set of boundary points, 
                              {
                              
                                 
                                    
                                       R
                                    
                                    
                                       i
                                    
                                 
                                 
                                    }
                                 
                              
                           . The set of points in the radial skeleton for the shoulder and the axial surface is 
                              
                                 
                                    
                                       
                                          {
                                       
                                       
                                          C
                                       
                                    
                                    
                                       i
                                    
                                 
                                 
                                    }
                                 
                              
                           , and 
                              
                                 
                                    
                                       C
                                    
                                    
                                       i
                                    
                                 
                                 
                                    =
                                    Polyline
                                    (
                                 
                                 
                                    
                                       R
                                    
                                    
                                       i
                                    
                                 
                                 
                                    ,
                                 
                                 
                                    
                                       Q
                                    
                                    
                                       i
                                    
                                 
                                 
                                    ,
                                 
                                 
                                    
                                       P
                                    
                                    
                                       i
                                    
                                 
                                 
                                    )
                                 
                              
                           , as shown in Fig. 5(b). The surface of the shoulder and the axial surface of the tooth preparation are
                              
                                 (5)
                                 
                                    
                                       
                                          
                                             Surf
                                          
                                          
                                             axis
                                          
                                       
                                       
                                          (
                                          
                                             
                                                
                                                   θ
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                ,
                                             
                                             
                                                
                                                   C
                                                
                                                
                                                   i
                                                
                                             
                                          
                                          )
                                       
                                       
                                          =
                                       
                                       
                                          ⋃
                                          
                                             
                                                i
                                             
                                             
                                                =
                                                0
                                             
                                          
                                          
                                             n
                                          
                                       
                                       
                                          
                                             Sweep
                                          
                                          
                                             (
                                             
                                                
                                                   
                                                      C
                                                   
                                                   
                                                      i
                                                   
                                                
                                                
                                                   ,
                                                
                                                
                                                   
                                                      C
                                                   
                                                   
                                                      
                                                         i
                                                      
                                                      
                                                         +
                                                         1
                                                      
                                                   
                                                
                                             
                                             )
                                          
                                       
                                       ,
                                    
                                 
                              
                           where 
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       
                                          θ
                                       
                                       
                                          i
                                       
                                    
                                    
                                       =
                                       360
                                    
                                 
                              
                           . The surface of the shoulder and the axial surface of the tooth preparation are formed by discrete sweeping and accumulating segments in the circumferential direction.

The tooth preparation׳s occlusal surface should not only be morphologically similar to the occlusal surface before the preparation but also have the characteristics of a surface with smooth fossae and cusps, which are conductive to eliminating concentrated stress and improving the stability during the positioning process. The initial occlusal surface of the tooth is defined as 
                              
                                 
                                    Surf
                                 
                                 
                                    top
                                 
                              
                           . To ensure uniformity in the design of the tooth preparation׳s occlusal surface, an offset distance, 
                              
                                 d
                              
                           , in the direction of the inner normal vector is necessary for designing the tooth preparation׳s occlusal surface, 
                              
                                 
                                    Surf
                                 
                                 
                                    top
                                 
                                 
                                    1
                                 
                              
                           . Because the occlusal surface includes numerous anatomical features, such as dental fossae and cusps, a great deal of self-intersection is inevitable when the surface mesh is generated directly based on the vertex in the direction of the inner normal vector, which will affect subsequent processing. In this study, a radial basis function (RBF) with implicit surfaces was used to construct the occlusal surface, 
                              
                                 
                                    Surf
                                 
                                 
                                    top
                                 
                                 
                                    1
                                 
                              
                           . First, the set of points in 
                              
                                 
                                    Surf
                                 
                                 
                                    top
                                 
                              
                            is defined as 
                              
                                 
                                    
                                       {V
                                    
                                    
                                       i
                                    
                                 
                                 
                                    }
                                 
                              
                           , and the feature points are interpolated using the RBF with an implicit surface,
                              
                                 (6)
                                 
                                    
                                       
                                          D
                                       
                                       
                                          =
                                       
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             n
                                          
                                       
                                       
                                          
                                             
                                                λ
                                             
                                             
                                                i
                                             
                                          
                                          
                                             ϕ
                                          
                                          
                                             (
                                             
                                                
                                                   
                                                      V
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                             )
                                          
                                          
                                             +
                                          
                                       
                                       
                                          C
                                       
                                       
                                          (
                                       
                                       
                                          
                                             V
                                          
                                          
                                             i
                                          
                                       
                                       
                                          )
                                       
                                       ,
                                    
                                 
                              
                           where 
                              
                                 D
                              
                            is a distance field function, 
                              
                                 
                                    λ
                                 
                                 
                                    i
                                 
                              
                            is the weight of the radial basis function, 
                              
                                 ϕ
                              
                              
                                 (
                                 x
                                 )
                              
                            is the radial basis function, and generally, 
                              
                                 
                                    
                                       ϕ
                                    
                                    
                                       (
                                       
                                          x
                                       
                                       )
                                    
                                    
                                       =
                                       x
                                    
                                 
                                 
                                    3
                                 
                              
                            in three-dimensional spatial interpolation. 
                              
                                 C
                              
                              
                                 (
                                 x
                                 )
                              
                            is a primary-order polynomial that ensures the affine invariance of the final surface interpolated onto the given discrete constraint points. For any point 
                              
                                 V
                                 =
                              
                              
                                 {
                              
                              
                                 
                                    V
                                 
                                 
                                    x
                                 
                              
                              
                                 ,
                              
                              
                                 
                                    V
                                 
                                 
                                    y
                                 
                              
                              
                                 ,
                              
                              
                                 
                                    V
                                 
                                 
                                    z
                                 
                              
                              
                                 }
                              
                           , 
                              
                                 C
                              
                              
                                 (
                                 x
                                 )
                              
                            is defined as
                              
                                 (7)
                                 
                                    
                                       C
                                    
                                    
                                       (
                                       
                                          V
                                       
                                       )
                                    
                                    
                                       =
                                    
                                    
                                       
                                          c
                                       
                                       
                                          0
                                       
                                    
                                    
                                       +
                                    
                                    
                                       
                                          c
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          V
                                       
                                       
                                          x
                                       
                                    
                                    
                                       +
                                    
                                    
                                       
                                          c
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          V
                                       
                                       
                                          y
                                       
                                    
                                    
                                       +
                                    
                                    
                                       
                                          c
                                       
                                       
                                          3
                                       
                                    
                                    
                                       
                                          V
                                       
                                       
                                          z
                                       
                                    
                                    .
                                 
                              
                           
                        

This linear system, which must be solved, contains 
                              
                                 n
                              
                              
                                 +
                                 4
                              
                            unknowns (
                              
                                 
                                    λ
                                 
                                 
                                    i
                                 
                              
                            and 
                              
                                 
                                    
                                       p
                                    
                                    
                                       0
                                    
                                 
                                 
                                    ,
                                 
                                 
                                    
                                       p
                                    
                                    
                                       1
                                    
                                 
                                 
                                    ,
                                 
                                 
                                    
                                       p
                                    
                                    
                                       2
                                    
                                 
                                 
                                    ,
                                 
                                 
                                    
                                       p
                                    
                                    
                                       3
                                    
                                 
                              
                           ), and four additional orthogonal conditions are needed for its solution [17],
                              
                                 (8)
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             n
                                          
                                       
                                       
                                          
                                             
                                                λ
                                             
                                             
                                                i
                                             
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   
                                                      n
                                                   
                                                
                                                λ
                                             
                                             
                                                i
                                             
                                          
                                       
                                       
                                          
                                             V
                                          
                                          
                                             i
                                          
                                          
                                             x
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                =
                                                1
                                             
                                             
                                                n
                                             
                                          
                                          
                                             
                                                λ
                                             
                                             
                                                i
                                             
                                          
                                       
                                       
                                          
                                             V
                                          
                                          
                                             i
                                          
                                          
                                             y
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   
                                                      n
                                                   
                                                
                                                λ
                                             
                                             
                                                i
                                             
                                          
                                       
                                       
                                          
                                             V
                                          
                                          
                                             i
                                          
                                          
                                             z
                                          
                                       
                                       
                                          =
                                          0
                                       
                                       .
                                    
                                 
                              
                           
                        

When Eqs. (7) and (8) are substituted into Eq. (6), the following matrix form results:
                              
                                 (9)
                                 
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   
                                                      A
                                                   
                                                
                                                
                                                   
                                                      P
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         P
                                                      
                                                      
                                                         T
                                                      
                                                   
                                                
                                                
                                                   
                                                      0
                                                   
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   
                                                      λ
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      C
                                                   
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    
                                       =
                                    
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   
                                                      D
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      0
                                                   
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    ,
                                 
                              
                           where 
                              
                                 
                                    
                                       A
                                    
                                    
                                       ij
                                    
                                 
                                 
                                    =
                                 
                                 
                                    ϕ
                                 
                                 
                                    (
                                 
                                 
                                    
                                       
                                          |
                                       
                                       
                                          V
                                       
                                    
                                    
                                       i
                                    
                                 
                                 
                                    −
                                 
                                 
                                    
                                       V
                                    
                                    
                                       j
                                    
                                 
                                 
                                    |
                                    )
                                 
                              
                            and 
                              
                                 P
                                 =
                              
                              
                                 [
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            V
                                                         
                                                         
                                                            1
                                                         
                                                         
                                                            x
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            V
                                                         
                                                         
                                                            2
                                                         
                                                         
                                                            x
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            V
                                                         
                                                         
                                                            1
                                                         
                                                         
                                                            y
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            V
                                                         
                                                         
                                                            1
                                                         
                                                         
                                                            z
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            V
                                                         
                                                         
                                                            2
                                                         
                                                         
                                                            y
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            V
                                                         
                                                         
                                                            2
                                                         
                                                         
                                                            z
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ⋮
                                                      
                                                   
                                                   
                                                      
                                                         ⋮
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            V
                                                         
                                                         
                                                            n
                                                         
                                                         
                                                            x
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         ⋮
                                                      
                                                   
                                                   
                                                      
                                                         ⋮
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            V
                                                         
                                                         
                                                            n
                                                         
                                                         
                                                            y
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            V
                                                         
                                                         
                                                            n
                                                         
                                                         
                                                            z
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 ]
                              
                           .


                           Eq. (9) can be solved for the coefficient 
                              
                                 
                                    λ
                                 
                                 
                                    i
                                 
                              
                            to construct the RBF׳s implicit surface. By combining the implicit surface with the inward offset distance, 
                              
                                 d
                              
                           , the occlusal surface, 
                              
                                 
                                    Surf
                                 
                                 
                                    top
                                 
                                 
                                    1
                                 
                              
                           , can be generated using the MC (marching cubes) algorithm.

The set of boundary points, 
                              
                                 {
                              
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                              
                                 }
                              
                           , satisfies the constraints on the convergence angle and, based on the above calculation, can be used to construct boundary, and the interior surface, 
                              
                                 
                                    
                                       Surf
                                    
                                    
                                       top
                                    
                                    
                                       2
                                    
                                 
                                 
                                    ∈
                                 
                                 
                                    
                                       Surf
                                    
                                    
                                       top
                                    
                                    
                                       1
                                    
                                 
                              
                           , of the occlusal surface area can be cut by the boundary. The number of boundary points in 
                              
                                 
                                    Surf
                                 
                                 
                                    top
                                 
                                 
                                    2
                                 
                              
                            after the division is generally not consistent with the number of axial surface׳s boundary points. Due to the concection requirement between the surface 
                              
                                 
                                    Surf
                                 
                                 
                                    top
                                 
                                 
                                    2
                                 
                              
                            and axial surface, the triangular facets within a distance 
                              
                                 l
                              
                            from the 
                              
                                 
                                    Surf
                                 
                                 
                                    top
                                 
                                 
                                    2
                                 
                              
                            border are deleted, and generally, 
                              
                                 l
                                 =
                                 0.5
                                 
                                    
                                    m
                                    m
                                 
                              
                           . Finally, the shoulder and the axial surface and the tooth preparation׳s occlusal surface are stitched to generate a complete surface for the tooth preparation.

@&#RESULTS@&#

A plaster model of molar and premolar were randomly selected as the experimental model. Denmark 3Shape D700 was used to scan the plaster dental models with an accuracy of ±0.02mm. An experimental computer with an Intel i5-3450 processor and 2GB of memory running Windows 7 was used for developing the modeling simulation algorithm on the VC2008 platform. OpenGL2.0 was used for the graphical display.

@&#EXPERIMENTAL RESULTS@&#

Let the shoulder width be 
                           
                              w
                           
                        , the preparation׳s amount of the occlusal surface be 
                           
                              d
                           
                        , and the convergence angle be 
                           
                              α
                           
                        . Then, by designing different parameters using the proposed algorithm, the morphology of the tooth preparation can be flexibly designed to meet different clinical modeling requirements. Real parametric models of the tooth preparation of a premolar and a molar are shown in 
                        
                        Figs. 6 and 7. When the shoulder width parameter is 0.00, the modeling of the tooth preparation with no shoulder can be completed.

Geomagic Studio 12 (3D Systems Company, USA) and Rapidform2010 (3D Systems Company, USA) were used to test the design parameters for the six digital dental models after the tooth preparations were modeled. 
                        Table 1 shows the measurements of the shoulder width of the tooth preparation after modeling (the model of the tooth preparation was measured twice in each case). Index is the i-th tooth preparation model. 
                        Table 2 shows the measurements of the occlusal convergence angle of the tooth preparation after modeling.

@&#DISCUSSION@&#

The margin line of a tooth preparation is usually naturally formed by the dentist during the preparation process. When the tooth has enough distance between its occlusal and gingiva direction, as a tooth with periodontal disease does, the margin can be controlled at approximately 1mm above the gingiva. If the esthetic requirement is particularly strict or the dental hard tissue in the neck of the tooth must be protected, as that of a tooth with an all-ceramic dental crown must be, the margin line is usually placed approximately 0.5–1mm below the gingiva, with a strict requirement during the preparation process. Dentists have to complete a long-term training process to develop the ability to judge the spatial relationship between the margin line and the gingiva and to perform the ablation step of tooth preparation. A complex case is always a technical challenge, even for experienced dentists. Using the method proposed in this study, a dentist can personalize the design of the gingival margin line to efficiently and accurately control the morphology and position of the generated margin line, which can help the dentist quickly design a reasonable margin line, as shown in Figs. 6(a) and 7(a).

Traditionally, tooth preparation is completed by a dentist using on-site manual grinding. The limited space of the patient׳s mouth and the human visual bias of the dentist can lead to difficulty with manual control during the preliminary operations. In addition, the elimination of all undercuts on the axial surface must satisfy the required degree of convergence, which is a source of additional difficulty. Nuha et al. [8] showed that the ideal degree of convergence resulting from operations performed by senior dental students deviated significantly from the reasonable desired value and that even for an experienced dentist, it is difficult to guarantee that every tooth preparation has a reasonable degree of convergence and no undercuts. The digital modeling method of tooth preparation proposed in this study allows automatic three-dimensional modeling of the premolars and molars with shoulder widths between 0.5 and 1.0mm, as shown in Figs. 6(b)–(d) and 7(b)–(d), respectively; when the shoulder width of the premolars and molars is set to 0.00, the morphology of a tooth preparation with no shoulder as is shown in Figs. 6(e) and 7(e); the models of tooth preparations with different amounts of occlusal surface preparation and precise degrees of convergence for premolars and molars is shown in Figs. 6(f)–(h) and 7(f)–(h). The digital modeling method of tooth preparation allows the digital model of a tooth preparation without an undercut to be pre-designed to satisfy the requirements for exact adaptation to the affected teeth of different patients. Table 1 shows that the standard deviation of the shoulder width of the tooth preparation after modeling was less than 0.005mm, and Table 2 shows that the standard deviation of the degree of convergence in the tooth preparation was less than 0.4, which indicates a much higher quality than that of manual preparation. Compared with Yuan et al. [15]׳ method, our method has a better degree of automation. With the subsequent support of automated technology for tooth preparation (such as digital laser ablation), rapid, automated, and accurate tooth preparation can be performed for the patients, which makes the quality of the tooth preparation more controllable and is conducive to further steady improvement in the overall level of prosthesis preparation.

The design of a tooth preparation must satisfy a variety of principles in terms of esthetics, mechanics, the preparation process, its service life, and other considerations. Due to the restrictions on bur shapes and the ablation process, an investigation into the optimization of the shape and the shoulder edge of a personalized tooth preparation is limited for a given tooth preparation morphology. With the application and development of the personalized preparation modeling technology proposed in this study, personalized digital tooth preparations with a variety of morphologies that have no undercuts and uniform convergence angles can be rapidly designed. With the auxiliary tool of finite element analysis, the biomechanical morphology of a more reasonable personalized tooth preparation that satisfies the occlusal relationship can be further optimized for a patient [22]; such a tooth preparation can help minimize the ablation of healthy tooth tissue necessary to satisfy the requirements of mechanics and the process of producing the tooth preparation. This method also provides tools for further explorations of the theory behind personalized and accurate design of tooth preparations.

@&#CONCLUSION@&#


                     
                        
                           (1)
                           Traditional manual dental preparation is a complex clinical operation that is inefficient and difficult to precisely control, which leads to some difficulties in the dentists׳ training and in clinical diagnosis and treatment. With the assistance of digital intraoral scanning devices, the method of digitally modeling tooth preparations proposed in this study can be used to rapidly and accurately complete a high-quality digital design of a tooth preparation. With the subsequent support of an automated tooth preparation apparatus, complete digital intraoral preparation of the affected tooth can be performed, which will complement the automated technology for digital dental repair and help solve the problem of repair failure resulting from differences in dentists׳ abilities to prepare teeth.

The existing tooth preparation process depended on the bur for a long time; therefore, the morphological designs of tooth preparations are limited, which results in a slow development of the theory behind designing the morphology of a tooth preparation. The proposed parametric modeling-based approach to tooth preparation enables the quick design of tooth preparation models with various restoration parameters. Once it has been integrated with the tool of finite element analysis, an optimal model can be designed on the basis of the optimal stress distribution to minimize the ablation of healthy tissue in the affected tooth of the patient. The vigorous development of this technology in the future will further promote the development of personalization and precision in all-digital dental restoration technology.

The authors declare no conflict of interest.

@&#ACKNOWLEDGMENT@&#

This study was supported by the National Natural Science Foundation of China. (51205192, 81271181) and China Scholarship Council (No. 201506835025). The authors would also like to thank the anonymous reviewers whose comments and suggestions helped improve the original manuscript.

@&#REFERENCES@&#

