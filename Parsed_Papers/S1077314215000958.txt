@&#MAIN-TITLE@&#Higher order maximum persistency and comparison theorems

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A method to find a part of an optimal solution in discrete optimization problems.


                        
                        
                           
                           Applicable to multilabel and higher order graphical models.


                        
                        
                           
                           Based on a simple sufficient condition associated with a given polyhedral relaxation.


                        
                        
                           
                           Generalizes many existing methods originating from different areas of research.


                        
                        
                           
                           Provably determines same or larger part of an optimal solution in a number of cases.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Persistency

Partial optimality

LP relaxation

Discrete optimization

WCSP

Graphical models

@&#ABSTRACT@&#


               
               
                  We address combinatorial problems that can be formulated as minimization of a partially separable function of discrete variables (energy minimization in graphical models, weighted constraint satisfaction, pseudo-Boolean optimization, 0–1 polynomial programming). For polyhedral relaxations of such problems it is generally not true that variables integer in the relaxed solution will retain the same values in the optimal discrete solution. Those which do are called persistent. Such persistent variables define a part of a globally optimal solution. Once identified, they can be excluded from the problem, reducing its size.
                  To any polyhedral relaxation we associate a sufficient condition proving persistency of a subset of variables. We set up a specially constructed linear program which determines the set of persistent variables maximal with respect to the relaxation. The condition improves as the relaxation is tightened and possesses all its invariances. The proposed framework explains a variety of existing methods originating from different areas of research and based on different principles. A theoretical comparison is established that relates these methods to the standard linear relaxation and proves that the proposed technique identifies same or larger set of persistent variables.
               
            

@&#INTRODUCTION@&#

Optimization models in the general form of minimizing a partially separable function of discrete variables, known as energy minimization, weighted/valued constraint satisfaction or max-sum labeling, proved useful in many areas. The function has the form 
                        
                           
                              E
                              f
                           
                           
                              (
                              x
                              )
                           
                           =
                           
                              ∑
                              
                                 c
                                 ∈
                                 E
                              
                           
                           
                              f
                              c
                           
                           
                              (
                              
                                 x
                                 c
                              
                              )
                           
                        
                     . In computer vision and machine learning such models are largely motivated by maximum a posteriori inference in graphical models [71] used to model a variety of structured statistical recognition problems. In case variables take only two values 0 or 1, the problem is known as pseudo-Boolean optimization or 0–1 polynomial programming. Problems where terms (summands) involve at most two 0–1 variables at a time are called quadratic. We consider the general case, where terms may couple more than two variables at a time (higher order) and variables can take more than two values (multilabel).

One major trend for performing inference in graphical models is represented by graph cut methods. The basic capability is essentially to solve a binary pairwise submodular problem, e.g., image segmentation [18], by reduction to a minimum cut/maximum flow problem. For the latter, many efficient algorithms exist and their running time is experimentally near linear for typical vision problems [9]. This basic method was extended to submodular multilabel problems [21,51], to general multilabel problems by solving for an optimized crossover between two candidate solutions at a time [10], to higher-order 0–1 models reducible to a graph cut [16,34] and to combinations of higher order and multilabel [13,41].

Another technique that can be considered nowadays as a basic graph cut method is the roof dual relaxation [6] known in computer vision as quadratic pseudo-Boolean optimization (QPBO) [32]. It allows to find a partial optimal solution to a non-submodular binary problem and reduces to finding a minimum cut in a specially constructed network [7]. It can be interpreted [28] as solving a submodular relaxation of the initial problem. This basic method is again extended to multilabel problems by solving crossover problems [42] and to general higher order 0–1 problems by reduction (quadratization) techniques expressing the function as a quadratic function with auxiliary variables [5,15,22].

Another direction of extending graph cuts to higher order models relies on minimization of more general submodular functions. Several efficient max-flow based algorithms have been proposed [4,29] for minimization of a sum of submodular functions (SoS). A natural extension of QPBO is represented by submodular and bisubmodular relaxations [24,28].

Arguably, linear programming (LP) is a much more costly tool than computing a minimum cut. Yet, it provides theoretical insight to many methods [36,37] and there has been solvers developed that can address (sometimes approximately) large scale problems. Dual decomposition methods [35,53] or dual block-descent methods, in particular TRW-S [26], are competitive with graph cut based methods in terms of speed and quality. There are extensions of these specialized LP methods to higher order models [31,33]. Smoothing [49] and proximal [47] methods are scalable and offer a theoretically guaranteed convergence speed. Cutting plane approaches [60,73] are used to tighten the relaxation adaptively to the problem.

One drawback of relaxation based methods is that the final discrete solution is obtained by so-called rounding schemes and often appears inferior to solutions by graph cut methods as they stay feasible to the discrete space. Even in the case when many of the relaxed variables take integer values in the optimal relaxed solution, a fundamental problem remains that they may not take the same integer values in the optimal discrete solution. Therefore, unless the relaxation is tight, a local rounding technique cannot provide any guarantees for general models. The situation is dramatically different when we consider quadratic pseudo-Boolean functions. There, all variables that are integer in the relaxation correspond to at least one globally optimal discrete solution [20,44]. This property of the relaxation is called persistency. For general 0–1 polynomial problems persistency was studied by [2,43]. In their terminology persistency is associated with relaxations and is a property of the relaxed solution as a whole. In this work we call any partial assignment of a subset of discrete variables persistent if it can be provably extended to a globally optimal solution based on the properties of the relaxation or any other sufficient condition. Success of relaxation based exact methods such as [50] on computer vision and machine learning problems suggests that often a large part of the relaxed solution is integral. In this case we are interested in determining the largest subset of such variables that is persistent.

@&#RELATED WORK@&#

The present work was to a large extent inspired by simple local sufficient conditions proposed in bioinformatics under the name dead end elimination (DEE) [14,17]. In computer vision, several methods were proposed that identify a persistent assignment directly in the multi-label setting. These are methods by Kovtun [39,40] and Swoboda et al. [63,64]. Method [64] is applicable with a general polyhedral relaxation and it maximizes the subset of persistent variables for their sufficient condition (discussed in Section 4.5).

In the case of 0–1 variables there are several different techniques. Adams et al. [2] proposed a sufficient condition on dual multipliers to prove persistency of the integral part of the relaxation. Quadratization techniques by Boros and Gruber [5], Fix et al. [15], Ishikawa [22] introduce auxiliary variables in order to reduce the function to a quadratic form and infer persistency from the QPBO method. Lu and Williams [43] generalized the roof duality approach to higher order by using a higher order linear relaxation. Kolmogorov [28] generalized both QPBO and the construction by Lu and Williams [43] by proposing discrete submodular and bisubmodular relaxations. He argues that the key property of QPBO that needs to be generalized is the existence of a totally half integral optimal solution to the relaxation, i.e., with values in 
                                 
                                    {
                                    0
                                    ,
                                    
                                       1
                                       2
                                    
                                    ,
                                    1
                                    }
                                 
                              . He characterized all totally half-integral relaxations as bisubmodular relaxations. Finding a good (bi)submodular relaxation appears to be a challenging problem. To our knowledge it was only resolved for the special case of mincut-reducible relaxations [24,62], and even in this case it requires solving a series of linear programs. Even though the relaxed problem itself can be efficiently optimized (in particular when it is a sum of submodular functions), having a sound persistency result at a comparable computation cost is an open problem. No theoretical comparison seems to be possible between (bi)submodular relaxations and quadratization techniques [28].

Kohli et al. [25] reduce multilabel pairwise problems to 0–1 quadratic and Windheuser et al. [75] reduce multilabel higher order problems to submodular relaxations of [28].

In this work we settle the persistency capabilities achievable with a general polyhedral relaxation. The previously known results are in a certain sense unique, relying on a specific sufficient condition or on a specific type of the relaxation. We show that persistency guarantees are not that rare. To any polyhedral relaxation we associate clear sufficient conditions for persistency. We propose a polynomial time method to determine the largest strongly persistent subset of variables according to the sufficient condition. The method sets up a linear program connected to the given relaxation polytope and maximizes the number of strongly persistent variables. In comparison to QPBO-based or submodularity-based techniques, we employ a more costly optimization tool, but gain the following advantages:

                                 
                                    •
                                    the new sufficient condition generalizes a wide variety of existing methods that span across different fields of research and apply different techniques;

it is possible to pose formally and solve (under certain restrictions) the problem of determining the largest subset of persistent variables;

the maximum w.r.t. to the proposed general sufficient condition is guaranteed to be at least as good as any of the individual methods or their combinations;

the method is invariant to the permutation of labels and reparametrization of the problem as long as the relaxation is invariant;

persistent assignments form a hierarchy when tightening the relaxation.

The author’s previous work [54,55] considered only pairwise models and the standard LP relaxation. This paper generalizes to higher order and arbitrary polyhedral relaxations, gives more complete proofs of some properties and establishes comparisons with a novel multilabel method [64] and higher-order 0–1 methods [2,15,22,28].

In Section 2 we propose a general approach to persistency with a general polyhedral relaxation. This includes the proposed linear program formulation of maximum persistency and general properties of the problem. In Section 3 we consider standard LP relaxations and specialize the construction for this case, many properties are simplified. In Section 4 we propose a theoretical comparison between the proposed framework and other approaches. In Section 5 we validate our theoretical findings experimentally and compare performance on small random problems. In Section 6 there is a conclusion and discussion and Appendix A contains proofs.

When generalizing to higher order models many statements and proofs simplify if we use a properly defined notion of the empty sum, the empty product and the empty Cartesian product. They are respectively: 
                           
                              
                                 ∑
                                 
                                    i
                                    ∈
                                    ∅
                                 
                              
                              
                                 x
                                 i
                              
                              =
                              0
                              ,
                           
                        
                        
                           
                              
                                 ∏
                                 
                                    i
                                    ∈
                                    ∅
                                 
                              
                              
                                 x
                                 i
                              
                              =
                              1
                           
                         and 
                           
                              
                                 ∏
                                 
                                    i
                                    ∈
                                    ∅
                                 
                              
                              
                                 X
                                 i
                              
                              =
                              
                                 {
                                 ∅
                                 }
                              
                           
                        . The inclusion ⊂ is non-strict and ⊊ is strict. LHS refers to the left hand side of an equation. 
                           〚
                         · 
                           〛
                         denotes the Iverson bracket. 
                           argmin
                         is the set of minimizers. Sets 
                           
                              R
                              ,
                           
                        
                        
                           
                              R
                              +
                           
                         denote real and non-negative real numbers and 
                           
                              B
                              =
                              {
                              0
                              ,
                              1
                              }
                           
                         is the Boolean domain. A composition of functions is denoted as 
                           
                              (
                              f
                              ∘
                              g
                              )
                              (
                              x
                              )
                              =
                              f
                              (
                              g
                              (
                              x
                              )
                              )
                           
                        . Finally, a polytope is assumed to be convex but may be unbounded and a polyhedron means the same as a polytope.

A hypergraph 
                           
                              (
                              V
                              ,
                              E
                              )
                           
                         is given by the set of nodes 
                           V
                         and the set of hyperedges 
                           
                              E
                              ⊂
                              
                                 2
                                 V
                              
                           
                        . We assume that 
                           V
                         is totally ordered and each hyperedge 
                           
                              c
                              ∈
                              E
                           
                         is identified with the tuple of elements of 
                           c
                         ordered w.r.t. the total order of 
                           V
                        . We will further assume that 
                           
                              ∅
                              ∈
                              E
                           
                         and 
                           
                              (
                              ∀
                              s
                              ∈
                              V
                              )
                              
                              {
                              s
                              }
                              ∈
                              E
                           
                        . Let 
                           
                              X
                              s
                           
                         be a finite set of labels associated to a node 
                           
                              s
                              ∈
                              V
                           
                        . For a subset of nodes 
                           
                              c
                              ⊂
                              V
                           
                         the set 
                           
                              X
                              c
                           
                         denotes the Cartesian product 
                           
                              
                                 ∏
                                 
                                    s
                                    ∈
                                    c
                                 
                              
                              
                                 X
                                 s
                              
                           
                         in the order defined on 
                           V
                         and 
                           
                              X
                              =
                              
                                 X
                                 V
                              
                           
                        . The assignment of labels to all nodes 
                           
                              x
                              :
                              V
                              →
                              X
                           
                         is called a labeling. Let 
                           
                              x
                              c
                           
                         denote the restriction of x to 
                           
                              c
                              ⊂
                              V
                           
                         (thus xs
                         is just a single coordinate) and 
                           
                              
                                 x
                                 ∅
                              
                              =
                              ∅
                           
                        . Let us define the following functions (terms):

                           
                              (general hyperedge term)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                (
                                                ∀
                                                c
                                                ∈
                                                E
                                                )
                                             
                                             
                                             
                                             
                                                f
                                                c
                                             
                                             :
                                             
                                                X
                                                c
                                             
                                             →
                                             R
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        The special cases read

                           
                              
                                 
                                    
                                       
                                          
                                             f
                                             ∅
                                          
                                       
                                       
                                          
                                             :
                                             {
                                             ∅
                                             }
                                             →
                                             R
                                          
                                       
                                       
                                          
                                             (constant
                                             
                                             term)
                                             ,
                                          
                                       
                                    
                                    
                                       
                                          
                                             f
                                             s
                                          
                                       
                                       
                                          
                                             :
                                             
                                                X
                                                s
                                             
                                             →
                                             R
                                          
                                       
                                       
                                          
                                             (unary/0
                                             
                                             order
                                             
                                             term)
                                             ,
                                          
                                       
                                    
                                    
                                       
                                          
                                             f
                                             
                                                {
                                                s
                                                ,
                                                t
                                                }
                                             
                                          
                                       
                                       
                                          
                                             :
                                             
                                                X
                                                
                                                   {
                                                   s
                                                   ,
                                                   
                                                   t
                                                   }
                                                
                                             
                                             →
                                             R
                                          
                                       
                                       
                                          
                                             (pairwise/1st
                                             
                                             order
                                             
                                             term)
                                             
                                                
                                                   ,
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

and so on. The constant term f
                        ∅ is nothing but a single number. The energy function
                        
                           
                              
                                 E
                                 f
                              
                              :
                              X
                              →
                              R
                           
                         is defined by

                           
                              (2)
                              
                                 
                                    
                                       E
                                       f
                                    
                                    
                                       (
                                       x
                                       )
                                    
                                    =
                                    
                                       ∑
                                       
                                          c
                                          ∈
                                          E
                                       
                                    
                                    
                                       f
                                       c
                                    
                                    
                                       (
                                       
                                          x
                                          c
                                       
                                       )
                                    
                                    .
                                 
                              
                           
                        It is a partially separable function of discrete variables x. In this paper we will use a graphical notation of the energy explained in Fig. 1
                        .

The general energy minimization problem is NP-hard to approximate.
                           1
                        
                        
                           1
                           For example, inapproximability of the traveling salesman problem [45].
                         On the other hand, there are tractable subclasses. Works by Thapper and Živný [66], 67] and Kolmogorov [30] characterized all languages of energy functions with terms from a fixed finite set and unrestricted structure. They showed that there are no tractable languages other than those that can be solved by the basic LP relaxation (defined in Section 3), which proves that the relaxation is a universal and powerful technique.

In this section we embed the energy minimization problem into the Euclidean space. A labeling x is represented as a 0–1 vector in order to linearize the energy and write it as scalar product of this vector with the cost vector f consisting of all components 
                           
                              
                                 f
                                 c
                              
                              
                                 (
                                 
                                    x
                                    c
                                    ′
                                 
                                 )
                              
                           
                         for 
                           
                              c
                              ∈
                              E
                              ,
                           
                        
                        
                           
                              
                                 x
                                 c
                                 ′
                              
                              ∈
                              
                                 X
                                 c
                              
                           
                        . According to these components let us define the following set of indices
                        
                           
                              I
                              =
                              {
                              
                                 (
                                 c
                                 ,
                                 
                                    x
                                    c
                                    ′
                                 
                                 )
                              
                              
                              |
                              
                              c
                              ∈
                              E
                              ,
                              
                              
                                 x
                                 c
                                 ′
                              
                              ∈
                              
                                 X
                                 c
                              
                              }
                           
                        . The embedding
                        
                           
                              δ
                              :
                              X
                              →
                              
                                 R
                                 I
                              
                              :
                              x
                              →
                              δ
                              
                                 (
                                 x
                                 )
                              
                           
                         is defined by its components

                           
                              (3)
                              
                                 
                                    
                                       (
                                       ∀
                                       c
                                       ∈
                                       E
                                       ,
                                       
                                       
                                          x
                                          c
                                          ′
                                       
                                       ∈
                                       
                                          X
                                          c
                                       
                                       )
                                    
                                    
                                    
                                    δ
                                    
                                       
                                          (
                                          x
                                          )
                                       
                                       c
                                    
                                    
                                       (
                                       
                                          x
                                          c
                                          ′
                                       
                                       )
                                    
                                    =
                                    〚
                                    
                                       x
                                       c
                                    
                                    =
                                    
                                       x
                                       c
                                       ′
                                    
                                    〛
                                    .
                                 
                              
                           
                        The special cases read

                           
                              (4a)
                              
                                 
                                    
                                       
                                       
                                          
                                             δ
                                             
                                                
                                                   (
                                                   x
                                                   )
                                                
                                                ∅
                                             
                                             =
                                             1
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (4b)
                              
                                 
                                    
                                       
                                       
                                          
                                             δ
                                             
                                                
                                                   (
                                                   x
                                                   )
                                                
                                                s
                                             
                                             
                                                (
                                                
                                                   x
                                                   s
                                                   ′
                                                
                                                )
                                             
                                             =
                                             〚
                                             
                                                x
                                                s
                                             
                                             =
                                             
                                                x
                                                s
                                                ′
                                             
                                             〛
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (4c)
                              
                                 
                                    
                                       
                                       
                                          
                                             δ
                                             
                                                
                                                   (
                                                   x
                                                   )
                                                
                                                
                                                   {
                                                   s
                                                   ,
                                                   t
                                                   }
                                                
                                             
                                             
                                                (
                                                
                                                   x
                                                   
                                                      {
                                                      s
                                                      ,
                                                      t
                                                      }
                                                   
                                                   ′
                                                
                                                )
                                             
                                             =
                                             〚
                                             
                                                x
                                                s
                                             
                                             =
                                             
                                                x
                                                s
                                                ′
                                             
                                             〛
                                             〚
                                             
                                                x
                                                t
                                             
                                             =
                                             
                                                x
                                                t
                                                ′
                                             
                                             〛
                                          
                                       
                                    
                                 
                              
                           
                        
                     

and so on. Let ⟨ ·, ·⟩ denote the scalar product in 
                           
                              R
                              I
                           
                        . We can write the energy using the embedding δ as a linear function:

                           
                              (5)
                              
                                 
                                    
                                       E
                                       f
                                    
                                    
                                       (
                                       x
                                       )
                                    
                                    =
                                    
                                       ∑
                                       
                                          c
                                          ∈
                                          E
                                       
                                    
                                    
                                       ∑
                                       
                                          
                                             x
                                             c
                                             ′
                                          
                                          ∈
                                          
                                             X
                                             c
                                          
                                       
                                    
                                    
                                       f
                                       c
                                    
                                    
                                       (
                                       
                                          x
                                          c
                                          ′
                                       
                                       )
                                    
                                    δ
                                    
                                       
                                          (
                                          x
                                          )
                                       
                                       c
                                    
                                    
                                       (
                                       
                                          x
                                          c
                                          ′
                                       
                                       )
                                    
                                    =
                                    
                                       〈
                                       f
                                       ,
                                       δ
                                       
                                          (
                                          x
                                          )
                                       
                                       〉
                                    
                                    .
                                 
                              
                           
                        The embedding δ is illustrated in Fig. 2
                        . The energy minimization can be expressed as:

                           
                              (6)
                              
                                 
                                    
                                       
                                          
                                             
                                                min
                                                
                                                   x
                                                   ∈
                                                   X
                                                
                                             
                                             
                                                〈
                                                f
                                                ,
                                                δ
                                                
                                                   (
                                                   x
                                                   )
                                                
                                                〉
                                             
                                          
                                       
                                       
                                          
                                             =
                                             
                                                min
                                                
                                                   μ
                                                   ∈
                                                   δ
                                                   (
                                                   X
                                                   )
                                                
                                             
                                             
                                                〈
                                                f
                                                ,
                                                μ
                                                〉
                                             
                                             =
                                             
                                                min
                                                
                                                   μ
                                                   ∈
                                                   M
                                                
                                             
                                             
                                                〈
                                                f
                                                ,
                                                μ
                                                〉
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              δ
                              (
                              X
                              )
                           
                         is the image of the set of labelings, i.e., the set of corresponding points in 
                           
                              R
                              I
                           
                         and 
                           
                              M
                              =
                              conv
                              δ
                              (
                              X
                              )
                           
                         is their convex hull, called marginal polytope [71]. The second equality follows from the fact that a convex combination of solutions is also a solution. Polytope 
                           M
                         has in general exponentially many facets. A relaxation of the problem is obtained by replacing 
                           M
                         with an outer approximation 
                           
                              Λ
                              ⊃
                              M
                           
                        :

                           
                              (7)
                              
                                 
                                    
                                       
                                          
                                             
                                                min
                                                
                                                   μ
                                                   ∈
                                                   Λ
                                                
                                             
                                             
                                                〈
                                                f
                                                ,
                                                μ
                                                〉
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        A vector 
                           
                              μ
                              ∈
                              Λ
                              ⊂
                              
                                 R
                                 I
                              
                           
                         will be called a relaxed labeling. We will consider polyhedral relaxations of the following general form:

                           
                              (8)
                              
                                 
                                    
                                       
                                          
                                             Λ
                                             =
                                             {
                                             μ
                                             ∈
                                             
                                                R
                                                I
                                             
                                             
                                             |
                                             
                                             A
                                             μ
                                             ≥
                                             0
                                             ;
                                             
                                             
                                                μ
                                                ∅
                                             
                                             =
                                             1
                                             ;
                                             
                                             μ
                                             ≥
                                             0
                                             }
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        where we assume that 
                           
                              A
                              ∈
                              
                                 R
                                 
                                    m
                                    ×
                                    |
                                    I
                                    |
                                 
                              
                           
                         is such that Λ is bounded and 
                           
                              M
                              ⊂
                              Λ
                           
                        . Since 
                           M
                         is non-empty, it follows that Λ is non-empty. By these assumptions, relaxation (8) is a feasible and bounded linear program. Note that general inhomogenous equality and inequality constraints can be represented in this form by utilizing the component μ
                        ∅. The dual problem to (7) and the conical hull of Λ are expressed conveniently as follows. Recall that for a convex set 
                           
                              Λ
                              ⊂
                              
                                 R
                                 I
                              
                           
                         its conical hull is the set:

                           
                              (9)
                              
                                 
                                    coni
                                    (
                                    Λ
                                    )
                                    =
                                    {
                                    α
                                    μ
                                    
                                    |
                                    
                                    μ
                                    ∈
                                    Λ
                                    ,
                                    α
                                    ≥
                                    0
                                    }
                                    .
                                 
                              
                           
                        
                        
                           Lemma 1.1
                           
                              The conical hull of a relaxation polytope Λ (in the form (
                              
                                 8
                              
                              ), non-empty and bounded) is obtained by dropping the constraint
                              
                                 
                                    
                                       μ
                                       ∅
                                    
                                    =
                                    1
                                 
                              
                              :
                              
                                 
                                    (10)
                                    
                                       
                                          coni
                                          
                                             (
                                             Λ
                                             )
                                          
                                          =
                                          
                                             {
                                             μ
                                             ∈
                                             
                                                R
                                                I
                                             
                                             
                                             |
                                             
                                             A
                                             μ
                                             ≥
                                             0
                                             ;
                                             μ
                                             ≥
                                             0
                                             }
                                          
                                          .
                                       
                                    
                                 
                              
                           

The linear program (7) and its dual are expressed as

                           
                              (LP)
                              
                                 
                                    
                                       
                                       
                                          
                                             min
                                             〈
                                             f
                                             ,
                                             μ
                                             〉
                                          
                                       
                                       
                                          
                                             =
                                          
                                       
                                       
                                          
                                             max
                                             ψ
                                             
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      A
                                                      μ
                                                   
                                                
                                                
                                                   
                                                      ≥
                                                      0
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      μ
                                                      ∅
                                                   
                                                
                                                
                                                   
                                                      =
                                                      1
                                                   
                                                
                                             
                                             
                                                
                                                   μ
                                                
                                                
                                                   
                                                      ≥
                                                      0
                                                   
                                                
                                             
                                          
                                       
                                       
                                       
                                          
                                             
                                                
                                                   φ
                                                
                                                
                                                   
                                                      ∈
                                                      
                                                         R
                                                         +
                                                         m
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   ψ
                                                
                                                
                                                   
                                                      ∈
                                                      R
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      f
                                                      −
                                                      
                                                         A
                                                         T
                                                      
                                                      φ
                                                      −
                                                      
                                                         e
                                                         ∅
                                                      
                                                      ψ
                                                   
                                                
                                                
                                                   
                                                      ≥
                                                      0
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where vector 
                           
                              
                                 e
                                 ∅
                              
                              ∈
                              
                                 R
                                 I
                              
                           
                         is the basis vector for the component ∅ and the equality between the primal and the dual formulations holds because the primal problem is feasible and bounded. Let us introduce the notation 
                           
                              
                                 f
                                 φ
                              
                              :
                              =
                              f
                              −
                              
                                 A
                                 T
                              
                              φ
                           
                        . Later on, when we consider equality constraints of the form 
                           
                              A
                              μ
                              =
                              0
                              ,
                           
                         the vector f
                        φ will obtain the meaning of an equivalent problem and for now it is just an abbreviation.

A partial assignment
                     
                        
                           
                              y
                              A
                           
                           ∈
                           
                              X
                              A
                           
                           ,
                        
                      where 
                        
                           A
                           ⊂
                           V
                           ,
                        
                      is called weakly persistent if there exists an optimal solution x such that 
                        
                           
                              x
                              A
                           
                           =
                           
                              y
                              A
                           
                        
                     . In other words, 
                        
                           y
                           A
                        
                      can be extended to a global solution. Partial assignment 
                        
                           y
                           A
                        
                      is called strongly persistent if 
                        
                           
                              x
                              A
                           
                           =
                           
                              y
                              A
                           
                        
                      holds for all optimal solutions x.

It may seem that there are no practical reasons to distinguish strongly and weakly persistent partial assignments as long as they allow to simplify the problem. However, it will become clear later that they have different theoretical properties leading to polynomially solvable versus NP-hard maximum persistency problems. It turns out that strong persistency is more tractable, whereas proofs are generally easier to obtain in the weak form and most results in the literature deliver weak persistency.

In the case of quadratic pseudo-Boolean functions the roof dual relaxation [6] is persistent: for any relaxed solution its integral part defines a partial assignment 
                        
                           y
                           A
                        
                      which is optimal to the discrete problem. Moreover, for any labeling x, not necessarily optimal, replacing part of x on 
                        A
                      with 
                        
                           
                              y
                              A
                           
                           ,
                        
                      the overwrite operation, denoted in [6] by 
                        
                           x
                           [
                           A
                           ←
                           y
                           ]
                           ,
                        
                      has the following autarky property:

                        
                           (11)
                           
                              
                                 
                                    
                                       
                                          
                                             (
                                             ∀
                                             x
                                             ∈
                                             X
                                             )
                                          
                                          
                                          
                                          
                                             E
                                             f
                                          
                                          
                                             (
                                             x
                                             
                                                [
                                                A
                                                ←
                                                y
                                                ]
                                             
                                             )
                                          
                                          ≤
                                          
                                             E
                                             f
                                          
                                          
                                             (
                                             x
                                             )
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     illustrated in Fig. 3
                     . We will generalize this property to the multilabel setting.

The overwrite operation discussed above can be represented by a discrete mapping 
                           
                              p
                              :
                              X
                              →
                              X
                              :
                              x
                              ↦
                              x
                              [
                              A
                              ←
                              y
                              ]
                           
                        . The following generalization of autarky to an arbitrary mapping is proposed.

                           Definition 2.1
                           A mapping 
                                 
                                    p
                                    :
                                    X
                                    →
                                    X
                                 
                               is called (weakly) improving for f if

                                 
                                    (12)
                                    
                                       
                                          
                                             (
                                             ∀
                                             x
                                             ∈
                                             X
                                             )
                                          
                                          
                                          
                                             E
                                             f
                                          
                                          
                                             (
                                             p
                                             
                                                (
                                                x
                                                )
                                             
                                             )
                                          
                                          ≤
                                          
                                             E
                                             f
                                          
                                          
                                             (
                                             x
                                             )
                                          
                                          ,
                                       
                                    
                                 
                              and strictly improving if

                                 
                                    (13)
                                    
                                       
                                          
                                             (
                                             p
                                             
                                                (
                                                x
                                                )
                                             
                                             ≠
                                             x
                                             )
                                          
                                          
                                          ⇒
                                          
                                          
                                             E
                                             f
                                          
                                          
                                             (
                                             p
                                             
                                                (
                                                x
                                                )
                                             
                                             )
                                          
                                          <
                                          
                                             E
                                             f
                                          
                                          
                                             (
                                             x
                                             )
                                          
                                          .
                                       
                                    
                                 
                              
                           

The idea of the improving mapping is illustrated in Fig. 4
                        . It easily follows from the definition that if p is improving then there exists an optimal solution 
                           
                              x
                              ∈
                              p
                              (
                              X
                              )
                           
                         and if p is strictly improving then all optimal solutions are contained in 
                           
                              p
                              (
                              X
                              )
                           
                        . In this way an improving mapping reduces the search space from 
                           X
                         to 
                           
                              p
                              (
                              X
                              )
                           
                        .

We will consider node-wise mappings, of the form 
                           
                              p
                              
                                 
                                    (
                                    x
                                    )
                                 
                                 s
                              
                              =
                              
                                 p
                                 s
                              
                              
                                 (
                                 
                                    x
                                    s
                                 
                                 )
                              
                              ,
                           
                         where 
                           
                              (
                              ∀
                              s
                              ∈
                              V
                              )
                           
                        
                        
                           
                              
                                 p
                                 s
                              
                              :
                              
                                 X
                                 s
                              
                              →
                              
                                 X
                                 s
                              
                           
                        . Furthermore, we restrict ourselves to idempotent mappings, i.e., satisfying 
                           
                              p
                              ∘
                              p
                              =
                              p
                           
                        . This restriction is without loss of generality. Indeed, for an improving node-wise mapping p its compositional power pk
                         will be idempotent for some k (e.g., for k = 
                           
                              (
                              
                                 max
                                 s
                              
                              |
                              
                                 X
                                 s
                              
                              |
                              )
                              !
                              ,
                           
                         which turns all cycles in the map to identity) and provides equally good or better reduction with 
                           
                              
                                 p
                                 k
                              
                              
                                 (
                                 X
                                 )
                              
                              ⊆
                              p
                              
                                 (
                                 X
                                 )
                              
                           
                        . Idempotent maps have two following properties. Let X be a set and p: X → X idempotent.

                           
                              •
                              If p(x) ≠ x then no y ∈ X is mapped to x.

For 
                                    
                                       Y
                                       =
                                       p
                                       (
                                       X
                                       )
                                    
                                  the restriction of p to Y is the identity map x ↦ x and there holds 
                                    
                                       p
                                       (
                                       X
                                       )
                                       =
                                       {
                                       x
                                       ∈
                                       X
                                       
                                       |
                                       
                                       p
                                       (
                                       x
                                       )
                                       =
                                       x
                                       }
                                    
                                 .

It follows that knowing an improving mapping p, we can eliminate labels (s, i) for which ps
                        (i) ≠ i and there will remain at least one global minimizer of Ef
                        .

Given a mapping p, the verification of the improving property (12) is NP-hard since already in the quadratic pseudo-Boolean case the verification of autarky property (11) is NP-hard [8]. A tractable sufficient condition will be constructed by embedding the mapping into the space 
                           
                              R
                              I
                           
                         and applying the relaxation there.


                        
                           Definition 2.2
                           A linear extension of 
                                 
                                    p
                                    :
                                    X
                                    →
                                    X
                                 
                               is a linear mapping 
                                 
                                    P
                                    :
                                    
                                       R
                                       I
                                    
                                    →
                                    
                                       R
                                       I
                                    
                                 
                               that satisfies

                                 
                                    (14)
                                    
                                       
                                          (
                                          ∀
                                          x
                                          ∈
                                          X
                                          )
                                          
                                          δ
                                          (
                                          p
                                          (
                                          x
                                          )
                                          )
                                          =
                                          P
                                          δ
                                          (
                                          x
                                          )
                                          .
                                       
                                    
                                 
                              
                           

See Fig. 5
                         for illustration. Avoiding the discussion of uniqueness,
                           2
                        
                        
                           2
                           When a linear extension exists, its restriction to the affine hull of 
                                 
                                    δ
                                    (
                                    X
                                    )
                                 
                               is unique.
                         we will only use the following linear extension for a node-wise mapping 
                           
                              p
                              :
                              X
                              →
                              X
                              ,
                           
                         which will be denoted [p]. The linear extension 
                           
                              P
                              =
                              [
                              p
                              ]
                           
                         is defined by

                           
                              (15)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   (
                                                   P
                                                   μ
                                                   )
                                                
                                                c
                                             
                                             
                                                (
                                                
                                                   x
                                                   c
                                                
                                                )
                                             
                                             =
                                             
                                                ∑
                                                
                                                   x
                                                   
                                                      c
                                                   
                                                   ′
                                                
                                             
                                             
                                                P
                                                
                                                   c
                                                   ,
                                                   
                                                      x
                                                      c
                                                   
                                                   ,
                                                   
                                                      x
                                                      c
                                                      ′
                                                   
                                                
                                             
                                             
                                                μ
                                                c
                                             
                                             
                                                (
                                                
                                                   x
                                                   
                                                      c
                                                   
                                                   ′
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                        with coefficients

                           
                              (16)
                              
                                 
                                    
                                       
                                          
                                             
                                                P
                                                
                                                   c
                                                   ,
                                                   
                                                      x
                                                      c
                                                   
                                                   ,
                                                   
                                                      x
                                                      c
                                                      ′
                                                   
                                                
                                             
                                             :
                                             =
                                             
                                                ∏
                                                
                                                   s
                                                   ∈
                                                   c
                                                
                                             
                                             〚
                                             
                                                p
                                                s
                                             
                                             
                                                (
                                                
                                                   x
                                                   s
                                                   ′
                                                
                                                )
                                             
                                             =
                                             
                                                x
                                                s
                                             
                                             〛
                                             =
                                             〚
                                             
                                                p
                                                c
                                             
                                             
                                                (
                                                
                                                   x
                                                   c
                                                   ′
                                                
                                                )
                                             
                                             =
                                             
                                                x
                                                c
                                             
                                             〛
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        These coefficients should be understood as a “matrix” representation of P. To verify that (14) holds true we simply substitute an integer labeling δ(x) and expand the components as

                           
                              (17)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   (
                                                   P
                                                   δ
                                                   
                                                      (
                                                      x
                                                      )
                                                   
                                                   )
                                                
                                                c
                                             
                                             
                                                (
                                                
                                                   x
                                                   c
                                                   ′
                                                
                                                )
                                             
                                          
                                       
                                       
                                          
                                             =
                                             
                                                ∑
                                                
                                                   x
                                                   c
                                                   
                                                      ′
                                                      ′
                                                   
                                                
                                             
                                             
                                                ∏
                                                
                                                   s
                                                   ∈
                                                   c
                                                
                                             
                                             〚
                                             
                                                p
                                                s
                                             
                                             
                                                (
                                                
                                                   x
                                                   s
                                                   
                                                      ′
                                                      ′
                                                   
                                                
                                                )
                                             
                                             =
                                             
                                                x
                                                s
                                                ′
                                             
                                             〛
                                             〚
                                             
                                                x
                                                c
                                             
                                             =
                                             
                                                x
                                                c
                                                
                                                   ′
                                                   ′
                                                
                                             
                                             〛
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             =
                                             δ
                                             
                                                
                                                   (
                                                   p
                                                   
                                                      (
                                                      x
                                                      )
                                                   
                                                   )
                                                
                                                c
                                             
                                             
                                                (
                                                
                                                   x
                                                   c
                                                   ′
                                                
                                                )
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Using the linear extension P of p we can write

                           
                              (18)
                              
                                 
                                    
                                       E
                                       f
                                    
                                    
                                       (
                                       p
                                       
                                          (
                                          x
                                          )
                                       
                                       )
                                    
                                    =
                                    
                                       〈
                                       f
                                       ,
                                       δ
                                       
                                          (
                                          p
                                          
                                             (
                                             x
                                             )
                                          
                                          )
                                       
                                       〉
                                    
                                    =
                                    
                                       〈
                                       f
                                       ,
                                       P
                                       δ
                                       
                                          (
                                          x
                                          )
                                       
                                       〉
                                    
                                    .
                                 
                              
                           
                        This allows to express the condition of improving mapping (12) as

                           
                              (19)
                              
                                 
                                    (
                                    ∀
                                    x
                                    ∈
                                    X
                                    )
                                    
                                    〈
                                    f
                                    ,
                                    P
                                    δ
                                    (
                                    x
                                    )
                                    〉
                                    ≤
                                    〈
                                    f
                                    ,
                                    δ
                                    (
                                    x
                                    )
                                    〉
                                 
                              
                           
                        or equivalently, fully in the embedding, as

                           
                              (20)
                              
                                 
                                    (
                                    ∀
                                    μ
                                    ∈
                                    δ
                                    (
                                    X
                                    )
                                    )
                                    
                                    〈
                                    f
                                    ,
                                    P
                                    μ
                                    〉
                                    ≤
                                    〈
                                    f
                                    ,
                                    μ
                                    〉
                                    .
                                 
                              
                           
                        Taking convex combinations in (20), we obtain an equivalent condition

                           
                              (21)
                              
                                 
                                    (
                                    ∀
                                    μ
                                    ∈
                                    M
                                    )
                                    
                                    〈
                                    f
                                    ,
                                    P
                                    μ
                                    〉
                                    ≤
                                    〈
                                    f
                                    ,
                                    μ
                                    〉
                                    .
                                 
                              
                           
                        Thus we have linearized the inequalities necessary for an improving mapping. However, the marginal polytope 
                           M
                         is not tractable. We introduce a sufficient condition by requiring that the same inequality (21) is satisfied over a larger (tractable) polytope 
                           
                              Λ
                              ⊃
                              M
                           
                        .

                           Definition 2.3
                           A linear mapping 
                                 
                                    P
                                    :
                                    
                                       R
                                       I
                                    
                                    →
                                    
                                       R
                                       I
                                    
                                 
                               is (weak) Λ-improving for f if

                                 
                                    (22)
                                    
                                       
                                          
                                             
                                             
                                                
                                                   (
                                                   ∀
                                                   μ
                                                   ∈
                                                   Λ
                                                   )
                                                   
                                                   〈
                                                   f
                                                   ,
                                                   P
                                                   μ
                                                   〉
                                                   ≤
                                                   〈
                                                   f
                                                   ,
                                                   μ
                                                   〉
                                                   ;
                                                
                                             
                                          
                                       
                                    
                                 
                              and is strict Λ-improving for f if

                                 
                                    (23)
                                    
                                       
                                          
                                             
                                             
                                                
                                                   (
                                                   ∀
                                                   μ
                                                   ∈
                                                   Λ
                                                   ,
                                                   
                                                   P
                                                   μ
                                                   ≠
                                                   μ
                                                   )
                                                   
                                                   〈
                                                   f
                                                   ,
                                                   P
                                                   μ
                                                   〉
                                                   <
                                                   〈
                                                   f
                                                   ,
                                                   μ
                                                   〉
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

Let 
                                 
                                    P
                                    :
                                    
                                       R
                                       I
                                    
                                    →
                                    
                                       R
                                       I
                                    
                                 
                               be a linear extension of 
                                 
                                    p
                                    :
                                    X
                                    →
                                    X
                                 
                               and Λ a relaxation polytope. If P is Λ-improving for f then p is improving for f.

A relaxed-improving mapping P satisfies inequality (22) over a superset Λ of 
                                 
                                    M
                                    ,
                                 
                               therefore condition (21) is satisfied, which by the definition of extension is equivalent to (12).□

The set of mappings for which (22) (respectively,  (23)) is satisfied will be denoted 
                           
                              W
                              f
                           
                         (respectively, 
                           
                              S
                              f
                           
                         ). For convenience, we will use the term relaxed improving when the relaxation is clear from the context.

Naturally, a strict relaxed improving map is relaxed improving, i.e., 
                           
                              
                                 S
                                 f
                              
                              
                              ⊂
                              
                                 W
                                 f
                              
                              
                           
                        . This is so because for all μ ∈ Λ such that 
                           
                              P
                              μ
                              =
                              μ
                           
                         the inequality (22) is trivially satisfied.

Next we show that the verification of 
                           
                              P
                              ∈
                              
                                 W
                                 f
                              
                              
                           
                         (respectively, 
                           
                              P
                              ∈
                              
                                 S
                                 f
                              
                              
                           
                        ) for a given P can be solved (decided) in polynomial time. The definition (22) of 
                           
                              P
                              ∈
                              
                                 W
                                 f
                              
                              
                           
                         is equivalent to the expression

                           
                              (24)
                              
                                 
                                    
                                       min
                                       
                                          μ
                                          ∈
                                          Λ
                                       
                                    
                                    
                                       〈
                                       
                                          (
                                          I
                                          −
                                          
                                             P
                                             T
                                          
                                          )
                                       
                                       f
                                       ,
                                       μ
                                       〉
                                    
                                    ≥
                                    0
                                    .
                                 
                              
                           
                        The optimization problem in (24) will be therefore called the verification LP. As a linear program over a tractable polytope Λ, it can be solved in polynomial time and hence the decision problem 
                           
                              P
                              ∈
                              
                                 W
                                 f
                              
                              
                           
                         is solvable in polynomial time.

In order to show that the verification of 
                           
                              
                                 [
                                 p
                                 ]
                              
                              ∈
                              
                                 S
                                 f
                              
                              
                           
                         can also be decided in polynomial time we introduce the following equivalent reformulation.

                           Statement 2.5
                           Let 
                                 
                                    O
                                    =
                                    
                                       argmin
                                       
                                          μ
                                          ∈
                                          Λ
                                       
                                    
                                    
                                       〈
                                       f
                                       ,
                                       
                                          (
                                          I
                                          −
                                          P
                                          )
                                       
                                       μ
                                       〉
                                    
                                 
                              . There holds 
                                 
                                    P
                                    ∈
                                    
                                       S
                                       f
                                    
                                    
                                 
                               iff

                                 
                                    (25)
                                    
                                       
                                          
                                             
                                                O
                                             
                                             
                                                
                                                   =
                                                   P
                                                   (
                                                   Λ
                                                   )
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

The statement says that a strictly relaxed improving mapping must not change the set of all optimal solutions to the verification LP. This can be further expressed in components of the mapping and of the support set 
                           O
                        .

                           Statement 2.6
                           Let 
                                 
                                    
                                       O
                                       c
                                    
                                    =
                                    
                                       {
                                       
                                          x
                                          c
                                       
                                       ∈
                                       
                                          X
                                          c
                                       
                                       
                                       |
                                       
                                       
                                          (
                                          ∃
                                          μ
                                          ∈
                                          O
                                          )
                                       
                                       
                                       
                                          μ
                                          c
                                       
                                       
                                          (
                                          
                                             x
                                             c
                                          
                                          )
                                       
                                       >
                                       0
                                       }
                                    
                                 
                              . There holds 
                                 
                                    
                                       [
                                       p
                                       ]
                                    
                                    ∈
                                    
                                       S
                                       f
                                    
                                    
                                 
                               iff

                                 
                                    (26)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      (
                                                      ∀
                                                      c
                                                      ∈
                                                      E
                                                      )
                                                   
                                                   
                                                   
                                                   
                                                      O
                                                      c
                                                   
                                                   =
                                                   
                                                      p
                                                      c
                                                   
                                                   
                                                      (
                                                      
                                                         X
                                                         c
                                                      
                                                      )
                                                   
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              The proof of Statement 2.6 is given in Appendix A.

Now, in order to solve the verification of 
                           
                              p
                              ∈
                              
                                 S
                                 f
                              
                              
                           
                         in polynomial time we can solve the verification LP in (24), obtain 
                           c
                        -support sets of its optimal solutions 
                           
                              O
                              c
                           
                         and check condition (26).

We next give necessary conditions for p in order that 
                           
                              
                                 [
                                 p
                                 ]
                              
                              ∈
                              
                                 W
                                 f
                              
                              
                           
                         or 
                           
                              
                                 [
                                 p
                                 ]
                              
                              ∈
                              
                                 S
                                 f
                              
                              
                           
                        . They help to narrow down the set of maps to be considered. A relaxed improving map must preserve optimality of solutions to the relaxation and consequently their support set (again in components).

                           Lemma 2.7
                           Necessary conditions I


                           
                              Let
                              
                                 
                                    p
                                    :
                                    X
                                    →
                                    X
                                 
                               
                              be node-wise and
                              
                                 
                                    P
                                    =
                                    [
                                    p
                                    ]
                                 
                              
                              . Let
                              
                                 
                                    O
                                    =
                                    
                                       argmin
                                       
                                          μ
                                          ∈
                                          Λ
                                       
                                    
                                    
                                       〈
                                       f
                                       ,
                                       μ
                                       〉
                                    
                                 
                               
                              and
                              
                                 
                                    
                                       O
                                       c
                                    
                                    =
                                    
                                       {
                                       
                                          x
                                          c
                                       
                                       ∈
                                       
                                          X
                                          c
                                       
                                       
                                       |
                                       
                                       
                                          (
                                          ∃
                                          μ
                                          ∈
                                          O
                                          )
                                       
                                       
                                       
                                       
                                          μ
                                          c
                                       
                                       
                                          (
                                          
                                             x
                                             c
                                          
                                          )
                                       
                                       >
                                       0
                                       }
                                    
                                 
                              
                              . Then
                              
                                 
                                    (i)
                                    
                                       For
                                       
                                          
                                             p
                                             ∈
                                             
                                                W
                                                f
                                             
                                             
                                          
                                        
                                       there holds
                                       
                                          
                                             (27a)
                                             
                                                
                                                   
                                                      
                                                      
                                                         
                                                            P
                                                            (
                                                            O
                                                            )
                                                            ⊂
                                                            O
                                                            ;
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       

                                       
                                          
                                             (27b)
                                             
                                                
                                                   
                                                      
                                                      
                                                         
                                                            
                                                               (
                                                               ∀
                                                               c
                                                               ∈
                                                               E
                                                               )
                                                            
                                                            
                                                            
                                                            
                                                               p
                                                               c
                                                            
                                                            
                                                               (
                                                               
                                                                  O
                                                                  c
                                                               
                                                               )
                                                            
                                                            ⊂
                                                            
                                                               O
                                                               c
                                                            
                                                            ;
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    


                                       For
                                       
                                          
                                             p
                                             ∈
                                             
                                                S
                                                f
                                             
                                             
                                          
                                        
                                       there holds
                                       
                                          
                                             (28a)
                                             
                                                
                                                   
                                                      
                                                      
                                                         
                                                            P
                                                            (
                                                            O
                                                            )
                                                            =
                                                            O
                                                            ;
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       

                                       
                                          
                                             (28b)
                                             
                                                
                                                   
                                                      
                                                      
                                                         
                                                            
                                                               (
                                                               ∀
                                                               c
                                                               ∈
                                                               E
                                                               )
                                                            
                                                            
                                                            
                                                            
                                                               p
                                                               c
                                                            
                                                            
                                                               (
                                                               
                                                                  O
                                                                  c
                                                               
                                                               )
                                                            
                                                            =
                                                            
                                                               O
                                                               c
                                                            
                                                            ;
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       The proof of Lemma 2.7 is given in Appendix A.

Next, we reformulate problems 
                           
                              
                                 [
                                 p
                                 ]
                              
                              ∈
                              
                                 W
                                 f
                              
                              
                           
                         and 
                           
                              
                                 [
                                 p
                                 ]
                              
                              ∈
                              
                                 S
                                 f
                              
                              
                           
                         dually, i.e., not with quantifier (∀x ∈ Λ) as in (22) but with existence quantifiers. This will become important in the formulation of the maximum persistency problem where we optimize over p subject to the constraints 
                           
                              
                                 [
                                 p
                                 ]
                              
                              ∈
                              
                                 W
                                 f
                              
                              
                           
                         (respectively, 
                           
                              
                                 [
                                 p
                                 ]
                              
                              ∈
                              
                                 S
                                 f
                              
                              
                           
                        ). Recall that the set 
                           
                              
                                 W
                                 f
                              
                              
                           
                         is defined for the relaxation polytope 
                           
                              Λ
                              =
                              {
                              μ
                              ∈
                              
                                 R
                                 I
                              
                              
                              |
                              
                              A
                              μ
                              ≥
                              0
                              ;
                              
                              
                                 μ
                                 ∅
                              
                              =
                              1
                              ;
                              
                              μ
                              ≥
                              0
                              }
                              ,
                           
                         where 
                           
                              A
                              ∈
                              
                                 R
                                 
                                    m
                                    ×
                                    |
                                    I
                                    |
                                 
                              
                           
                        .

                           Theorem 2.8
                           Dual representation of 
                                 
                                    W
                                    f
                                 
                              
                           


                           
                              Set
                              
                                 
                                    
                                       W
                                       f
                                    
                                    
                                 
                               
                              can be expressed as
                              
                                 
                                    (29)
                                    
                                       
                                          {
                                          P
                                          :
                                          
                                             R
                                             I
                                          
                                          →
                                          
                                             R
                                             I
                                          
                                          
                                          |
                                          
                                          
                                             (
                                             ∃
                                             φ
                                             ∈
                                             
                                                R
                                                +
                                                m
                                             
                                             )
                                          
                                          
                                          
                                          f
                                          −
                                          
                                             A
                                             T
                                          
                                          φ
                                          −
                                          
                                             P
                                             T
                                          
                                          f
                                          ≥
                                          0
                                          }
                                          .
                                       
                                    
                                 
                              
                           

Denote 
                                 
                                    g
                                    =
                                    (
                                    I
                                    −
                                    
                                       P
                                       T
                                    
                                    )
                                    f
                                 
                              . Condition (24), equivalent to (22), can be stated yet equivalently for the conical hull of Λ:

                                 
                                    (30)
                                    
                                       
                                          
                                             inf
                                             
                                                μ
                                                ∈
                                                coni
                                                (
                                                Λ
                                                )
                                             
                                          
                                          
                                             〈
                                             g
                                             ,
                                             μ
                                             〉
                                          
                                          ≥
                                          0
                                          .
                                       
                                    
                                 
                              This is because for any μ ∈ Λ and any α ≥ 0 vector αμ will satisfy RHS of (22) as well. Using the expression for the conical hull of Λ in (10), we can write the minimization problem in (30) and its dual as

                                 
                                    (31)
                                    
                                       
                                          
                                             
                                             
                                                
                                                   inf
                                                   〈
                                                   g
                                                   ,
                                                   μ
                                                   〉
                                                
                                             
                                             
                                                
                                                   
                                                   
                                                
                                             
                                             
                                                
                                                   max
                                                   0
                                                   
                                                   .
                                                
                                             
                                          
                                          
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            A
                                                            μ
                                                         
                                                      
                                                      
                                                         
                                                            ≥
                                                            0
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         μ
                                                      
                                                      
                                                         
                                                            ≥
                                                            0
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                             
                                                
                                                   
                                                      
                                                         φ
                                                      
                                                      
                                                         
                                                            ∈
                                                            
                                                               R
                                                               +
                                                               m
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            g
                                                            −
                                                            
                                                               A
                                                               T
                                                            
                                                            φ
                                                         
                                                      
                                                      
                                                         
                                                            ≥
                                                            0
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              Inequality (30) holds iff the primal problem is bounded, and it is bounded iff the dual is feasible, which is the case iff 
                                 
                                    (
                                    ∃
                                    φ
                                    ∈
                                    
                                       R
                                       +
                                       m
                                    
                                    )
                                 
                              
                              
                                 
                                    
                                       (
                                       f
                                       −
                                       
                                          A
                                          T
                                       
                                       φ
                                       )
                                    
                                    −
                                    
                                       P
                                       T
                                    
                                    f
                                    ≥
                                    0
                                 
                              .□

The set 
                           
                              
                                 S
                                 f
                              
                              
                           
                         is defined via a more complicated quantifier (∀μ ∈ Λ, Pμ ≠ μ). Fortunately, the following dual reformulation holds for node-wise maps.

                           Theorem 2.9
                           Dual representation of 
                                 
                                    S
                                    f
                                 
                              
                           


                           
                              Let
                              
                                 
                                    p
                                    :
                                    X
                                    →
                                    X
                                 
                               
                              be node-wise. Then: (i) there exists ε > 0 such that
                              
                                 
                                    
                                       [
                                       p
                                       ]
                                    
                                    ∈
                                    
                                       S
                                       f
                                    
                                    
                                 
                               
                              iff
                              
                                 
                                    (32)
                                    
                                       
                                          
                                             
                                             
                                                
                                                   
                                                   
                                                   
                                                      (
                                                      ∃
                                                      φ
                                                      ∈
                                                      
                                                         R
                                                         +
                                                         m
                                                      
                                                      )
                                                   
                                                   
                                                   
                                                   f
                                                   −
                                                   
                                                      A
                                                      T
                                                   
                                                   φ
                                                   −
                                                   
                                                      
                                                         [
                                                         p
                                                         ]
                                                      
                                                      T
                                                   
                                                   f
                                                   ≥
                                                   
                                                      ɛ
                                                   
                                                   h
                                                   ,
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           


                              where h is a function such that h ≥ 0 and
                              
                                 
                                    
                                       h
                                       c
                                    
                                    
                                       (
                                       
                                          x
                                          c
                                       
                                       )
                                    
                                    =
                                    0
                                 
                               
                              iff
                              
                                 
                                    
                                       p
                                       c
                                    
                                    
                                       (
                                       
                                          x
                                          c
                                       
                                       )
                                    
                                    =
                                    
                                       x
                                       c
                                    
                                 
                              
                              ; and (ii) for rational inputs (including h) the value of ε in (i) is a rational number of polynomial bit length.
                           

The proof of Theorem 2.9 is given in Appendix A.

The constraint 
                           
                              
                                 [
                                 p
                                 ]
                              
                              ∈
                              
                                 S
                                 f
                              
                              
                           
                         can thus be reduced to nearly the same representation as (29), with an addition of an εh slack term. By construction, this term is zero iff 
                           
                              [
                              p
                              ]
                              μ
                              =
                              μ
                           
                        . In practice, taking a larger value of ε always results in a sufficient condition for 
                           
                              
                                 S
                                 f
                              
                              
                           
                         and hence does not break correctness. In theory, we want a very small ε but not so small that it would break polynomiality of the reformulation, which is ensured by part (ii). Note, while the set 
                           
                              
                                 S
                                 f
                              
                              
                           
                         in the space of all maps 
                           
                              
                                 R
                                 I
                              
                              →
                              
                                 R
                                 I
                              
                           
                         was convex but not closed (as seen from definition (23)), the theorem encloses the discrete maps of our interest, 
                           
                              {
                              [
                              p
                              ]
                              
                              |
                              
                              p
                              :
                              X
                              →
                              X
                              
                              node-wise
                              }
                           
                         in a closed (convex) polytope.

Finally we give a necessary condition for 
                           
                              
                                 W
                                 f
                              
                              
                           
                        . The theorem has a primal and a dual counterparts. The primal counterpart states that when solving the verification LP, because its objective 
                           
                              (
                              I
                              −
                              
                                 P
                                 T
                              
                              )
                              f
                           
                         is in the null space of P, the constrains of the problem can be projected onto the same subspace providing a simplification. The dual counterpart states that there always exist dual multipliers such that the improving property holds component-wise for reparametrized costs. This is useful in proofs, providing an alternative reformulation of local inequalities (29).

                           Theorem 2.10
                           Necessary conditions II


                           
                              Let
                              
                                 
                                    P
                                    :
                                    
                                       R
                                       I
                                    
                                    →
                                    
                                       R
                                       I
                                    
                                 
                               
                              be idempotent, P(Λ) ⊂ Λ and
                              
                                 
                                    P
                                    ∈
                                    
                                       W
                                       f
                                    
                                    
                                 
                              
                              . Then
                              
                                 
                                    (33a)
                                    
                                       
                                          
                                             
                                             
                                                
                                                   
                                                      inf
                                                      
                                                         
                                                            
                                                               
                                                                  A
                                                                  (
                                                                  I
                                                                  −
                                                                  P
                                                                  )
                                                                  μ
                                                                  ≥
                                                                  0
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  μ
                                                                  ≥
                                                                  0
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      〈
                                                      
                                                         
                                                            (
                                                            I
                                                            −
                                                            P
                                                            )
                                                         
                                                         T
                                                      
                                                      f
                                                      ,
                                                      μ
                                                      〉
                                                   
                                                   =
                                                   0
                                                   ;
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (33b)
                                    
                                       
                                          
                                             
                                             
                                                
                                                   
                                                      (
                                                      ∃
                                                      φ
                                                      ∈
                                                      
                                                         R
                                                         +
                                                         m
                                                      
                                                      )
                                                   
                                                   
                                                   
                                                   
                                                      (
                                                      I
                                                      −
                                                      
                                                         P
                                                         T
                                                      
                                                      )
                                                   
                                                   
                                                      (
                                                      f
                                                      −
                                                      
                                                         A
                                                         T
                                                      
                                                      φ
                                                      )
                                                   
                                                   ≥
                                                   0
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              The proof of Theorem 2.10 is given in Appendix A.

These conditions become necessary and sufficient for standard relaxations as discussed in Section 3.1. The constraint 
                           
                              A
                              (
                              I
                              −
                              P
                              )
                              μ
                              ≥
                              0
                           
                         in (33a) replaces the constraint Aμ ≥ 0 in (31) and simplifies the problem.

We showed in Section 2.2 that weak/strict relaxed-improving property can be verified in polynomial time and have described sets 
                           
                              
                                 W
                                 f
                              
                              ,
                              
                           
                        
                        
                           
                              S
                              f
                           
                        . Any relaxed-improving map, with the exception of the identity, eliminates some labels as non-optimal. Recall that the label (s, i) is eliminated by node-wise mapping p if ps
                        (i) ≠ i. We formulate the following maximum persistency problem:

                           
                              (
                                    
                                       max
                                       −
                                       WI
                                    
                                 )
                              
                                 
                                    
                                       
                                          
                                             
                                                max
                                                p
                                             
                                             
                                                ∑
                                                
                                                   s
                                                   ,
                                                   i
                                                
                                             
                                             〚
                                             
                                                p
                                                s
                                             
                                             
                                                (
                                                i
                                                )
                                             
                                             
                                                ≠
                                                i
                                             
                                             〛
                                             
                                             s.t.
                                             
                                             
                                                [
                                                p
                                                ]
                                             
                                             ∈
                                             
                                                W
                                                f
                                             
                                             
                                             ,
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        i.e. we directly maximize the number of eliminated labels. The strict variant, with constraint 
                           
                              
                                 [
                                 p
                                 ]
                              
                              ∈
                              
                                 S
                                 f
                              
                              
                           
                         will be denoted max-SI.

The problem may look difficult to solve. Indeed, it optimizes over discrete maps and involves a general polyhedral relaxation in the specification of constraints. Nevertheless, if we place some additional restrictions on the set of maps, it turns out to be solvable in polynomial time in a number of cases summarized in Table 1. One of them is the pseudo-Boolean case, where there are only 3 possible idempotent maps for every node: (0, 1) ↦ (1, 1), (0, 1) ↦ (0, 0) and (0, 1) ↦ (0, 1). Problem (max-SI) turns out to be solvable in this case. For multilabel problems, node-wise mappings are more diverse. Motivated by the goal to include/generalize existing multilabel methods, the following sets of maps are introduced.

The set 
                              
                                 P
                                 
                                    1
                                    ,
                                    y
                                 
                              
                            of maps p of the form 
                              
                                 p
                                 :
                                 x
                                 ↦
                                 x
                                 [
                                 A
                                 ←
                                 y
                                 ]
                              
                            for all 
                              
                                 A
                                 ⊂
                                 V
                              
                            and fixed 
                              
                                 y
                                 ∈
                                 X
                              
                           . This class is a straightforward generalization of the overwrite operation in the autarky (11). A mapping 
                              
                                 p
                                 ∈
                                 
                                    P
                                    
                                       1
                                       ,
                                       y
                                    
                                 
                              
                            is illustrated in Fig. 10
                           (a). There are only two possible choices for every node s. The mapping ps
                            either contracts 
                              
                                 X
                                 s
                              
                            to a single label {ys
                           } or retains 
                              
                                 X
                                 s
                              
                            unchanged. This class allows to explain one-against-all method of Kovtun [39] and the central part of the method of Swoboda et al. [64] as discussed in Sections 4.4, 4.5.

Set 
                              
                                 
                                    P
                                    1
                                 
                                 =
                                 
                                    ⋃
                                    
                                       y
                                       ∈
                                       X
                                    
                                 
                                 
                                    P
                                    
                                       1
                                       ,
                                       y
                                    
                                 
                              
                           . A mapping 
                              
                                 p
                                 ∈
                                 
                                    P
                                    1
                                 
                              
                            has the same form as above, 
                              
                                 p
                                 :
                                 x
                                 ↦
                                 x
                                 [
                                 A
                                 ←
                                 y
                                 ]
                                 ,
                              
                            however the labeling y is not fixed now but a part of the specification of the mapping, see Fig. 11
                           . In every node there are 
                              
                                 
                                    |
                                 
                                 
                                    X
                                    s
                                 
                                 
                                    |
                                    +
                                    1
                                 
                              
                            choices for ps
                           : send all labels to a single one (which may be chosen) or change nothing. It is easy to see that in the case of two labels, 
                              
                                 P
                                 1
                              
                            contains all idempotent node-wise maps. As will be shown later the (max-SI) problem over this class decomposes into sufficient conditions to determine y from the integral part of the solution to the relaxation and the (max-SI) problem over 
                              
                                 P
                                 
                                    1
                                    ,
                                    y
                                 
                              
                           .

The set of maps 
                              
                                 P
                                 
                                    2
                                    ,
                                    y
                                 
                              
                            is defined as follows. Let 
                              
                                 V
                                 =
                                 {
                                 
                                    (
                                    s
                                    ,
                                    i
                                    )
                                 
                                 
                                 |
                                 
                                 s
                                 ∈
                                 V
                                 ,
                                 i
                                 ∈
                                 
                                    X
                                    s
                                 
                                 }
                              
                           —the set of labels in all nodes. Let ζ ∈ {0, 1}
                              V
                           . Mapping 
                              
                                 
                                    p
                                    ζ
                                 
                                 ∈
                                 
                                    P
                                    
                                       2
                                       ,
                                       y
                                    
                                 
                              
                            in every node either preserves the label xs
                            or overwrites it with ys
                           :

                              
                                 (34)
                                 
                                    
                                       
                                          p
                                          ζ
                                       
                                       
                                          
                                             (
                                             x
                                             )
                                          
                                          s
                                       
                                       =
                                       
                                          {
                                          
                                             
                                                
                                                   
                                                      y
                                                      s
                                                   
                                                
                                                
                                                   
                                                      
                                                      if
                                                      
                                                      
                                                      
                                                         ζ
                                                         
                                                            s
                                                            ,
                                                            
                                                               x
                                                               s
                                                            
                                                         
                                                      
                                                      =
                                                      0
                                                      ,
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      x
                                                      s
                                                   
                                                
                                                
                                                   
                                                      
                                                      if
                                                      
                                                      
                                                      
                                                         ζ
                                                         
                                                            s
                                                            ,
                                                            
                                                               x
                                                               s
                                                            
                                                         
                                                      
                                                      =
                                                      1
                                                      .
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           Vector 
                              
                                 (
                                 
                                    ζ
                                    
                                       s
                                       ,
                                       i
                                    
                                 
                                 
                                 |
                                 
                                 i
                                 ∈
                                 
                                    X
                                    s
                                 
                                 )
                              
                            serves as the indicator of the subset of labels in node s that stay immovable while all other labels are mapped to ys
                           , see Fig. 6. In a node s there are 
                              
                                 2
                                 
                                    
                                       |
                                    
                                    
                                       X
                                       s
                                    
                                    
                                       |
                                       −
                                       1
                                    
                                 
                              
                            choices for ps
                           . Clearly, this class generalizes 
                              
                                 P
                                 
                                    1
                                    ,
                                    y
                                 
                              
                           .

The main result of this paper is that both (max-WI) and (max-SI) problems are tractable for the class 
                              
                                 P
                                 
                                    2
                                    ,
                                    y
                                 
                              
                           . Other tractability results in Table 1 are obtained as corollaries. Intractability results are shown to hold for the basic LP relaxation in Section 3.1.

In the following three subsections we gradually show that (max-WI) problem over 
                           
                              P
                              
                                 2
                                 ,
                                 y
                              
                           
                         class can be written as a mixed integer linear program in which integrality constraints can be relaxed without loss of tightness and thus we obtain an equivalent LP formulation.

Using the dual representation of the constraint 
                           
                              
                                 [
                                 p
                                 ]
                              
                              ∈
                              
                                 W
                                 f
                              
                              
                           
                         (29) and the form of the mapping (34), the problem (max-WI) becomes

                           
                              (35a)
                              
                                 
                                    
                                       
                                       
                                          
                                             min
                                             
                                                ∑
                                                
                                                   s
                                                   ∈
                                                   V
                                                
                                             
                                             
                                                ∑
                                                
                                                   i
                                                   ∈
                                                   
                                                      X
                                                      s
                                                   
                                                
                                             
                                             
                                                ζ
                                                
                                                   s
                                                   ,
                                                   i
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (35b)
                              
                                 
                                    
                                       
                                          
                                       
                                       
                                          
                                             
                                                (
                                                
                                                   ζ
                                                   
                                                      s
                                                      ,
                                                      i
                                                   
                                                
                                                ∈
                                                
                                                   {
                                                   0
                                                   ,
                                                   1
                                                   }
                                                
                                                
                                                |
                                                
                                                s
                                                ∈
                                                V
                                                ,
                                                
                                                i
                                                ∈
                                                
                                                   X
                                                   s
                                                
                                                )
                                             
                                             ;
                                             
                                             φ
                                             ∈
                                             
                                                R
                                                +
                                                m
                                             
                                             ;
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             f
                                             −
                                             
                                                A
                                                T
                                             
                                             φ
                                             −
                                             
                                                
                                                   [
                                                   
                                                      p
                                                      ζ
                                                   
                                                   ]
                                                
                                                T
                                             
                                             f
                                             ≥
                                             0
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Constraints (35b) involve a complicating expression [pζ
                        ]. Let us express coefficients 
                           
                              P
                              
                                 c
                                 ,
                                 
                                    x
                                    c
                                 
                                 ,
                                 
                                    x
                                    c
                                    ′
                                 
                              
                           
                         (16) of the linear extension 
                           
                              P
                              =
                              [
                              
                                 p
                                 ζ
                              
                              ]
                           
                        . Substituting mapping pζ
                         (34) they are expressed as polynomials in ζ:

                           
                              (36)
                              
                                 
                                    
                                       
                                          
                                             
                                                P
                                                
                                                   c
                                                   ,
                                                   
                                                      x
                                                      c
                                                   
                                                   ,
                                                   
                                                      x
                                                      c
                                                      ′
                                                   
                                                
                                             
                                             =
                                          
                                       
                                       
                                          
                                             
                                                ∏
                                                
                                                   s
                                                   ∈
                                                   c
                                                
                                             
                                             〚
                                             
                                                p
                                                ζ
                                             
                                             
                                                
                                                   (
                                                   
                                                      x
                                                      ′
                                                   
                                                   )
                                                
                                                s
                                             
                                             =
                                             
                                                x
                                                s
                                             
                                             〛
                                          
                                       
                                    
                                    
                                       
                                          =
                                       
                                       
                                          
                                             
                                                ∏
                                                
                                                   s
                                                   ∈
                                                   c
                                                
                                             
                                             
                                                (
                                                〚
                                                
                                                   x
                                                   s
                                                   ′
                                                
                                                =
                                                
                                                   x
                                                   s
                                                
                                                〛
                                                
                                                   ζ
                                                   
                                                      s
                                                      ,
                                                      
                                                         x
                                                         s
                                                         ′
                                                      
                                                   
                                                
                                                +
                                                〚
                                                
                                                   y
                                                   s
                                                
                                                =
                                                
                                                   x
                                                   s
                                                
                                                〛
                                                
                                                   (
                                                   1
                                                   −
                                                   
                                                      ζ
                                                      
                                                         s
                                                         ,
                                                         
                                                            x
                                                            s
                                                            ′
                                                         
                                                      
                                                   
                                                   )
                                                
                                                )
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        It appears that after expanding [pζ
                        ] using (36) the constraint that we need to represent (35b) will involve products of binary variables 
                           
                              
                                 ∏
                                 
                                    s
                                    ∈
                                    d
                                 
                              
                              
                                 ζ
                                 
                                    s
                                    ,
                                    
                                       x
                                       s
                                       ′
                                    
                                 
                              
                           
                         for all 
                           
                              c
                              ∈
                              E
                              ,
                           
                        
                        
                           
                              d
                              ⊂
                              c
                           
                         and 
                           
                              
                                 x
                                 d
                                 ′
                              
                              ∈
                              
                                 X
                                 d
                              
                           
                        . To reach the ILP formulation we are going to replace each such product with a substitute variable 
                           
                              ζ
                              
                                 d
                                 ,
                                 
                                    x
                                    d
                                    ′
                                 
                              
                           
                        . This is achieved with the help of the relaxation of Sherali and Adams [58].

The relaxation of Sherali and Adams [58] is applicable to polynomial programs with binary variables 
                           
                              z
                              ∈
                              
                                 
                                    {
                                    0
                                    ,
                                    1
                                    }
                                 
                                 V
                              
                           
                        . The relaxation of order d performs a simultaneous lifting for all subsets of variables 
                           
                              c
                              ⊂
                              V
                           
                         with 
                           
                              |
                              c
                              |
                              =
                              d
                           
                        . Let us focus on a single hyperedge 
                           c
                         chosen for generality from the set of hyperedges 
                           
                              E
                              ⊂
                              
                                 2
                                 V
                              
                           
                        . The construction and its properties (within hyperedge 
                           c
                        ) are summarized in Table 2
                        . For every product 
                           
                              
                                 ∏
                                 
                                    s
                                    ∈
                                    d
                                 
                              
                              
                                 z
                                 s
                              
                              ,
                           
                        
                        
                           
                              d
                              ⊂
                              c
                              ,
                           
                         a new variable 
                           
                              ζ
                              d
                           
                         is introduced (S1). A pseudo-Boolean function 
                           
                              g
                              :
                              
                                 
                                    {
                                    0
                                    ,
                                    1
                                    }
                                 
                                 c
                              
                              →
                              R
                           
                         is linearized by writing it as a multilinear polynomial and replacing each monomial 
                           
                              
                                 ∏
                                 
                                    s
                                    ∈
                                    d
                                 
                              
                              
                                 z
                                 s
                              
                           
                         with the new variable 
                           
                              
                                 ζ
                                 d
                              
                              ,
                           
                         
                        (S2). From this definition we have linearity properties (S3), in particular.

                           Lemma 2.11
                           Identity equality (S3)


                           
                              Let G(ζ) be the linearization of g(z). Then
                              
                                 
                                    g
                                    (
                                    z
                                    )
                                    =
                                    0
                                 
                               
                              for all
                              
                                 
                                    z
                                    ∈
                                    
                                       
                                          {
                                          0
                                          ,
                                          1
                                          }
                                       
                                       c
                                    
                                 
                               
                              iff
                              
                                 
                                    G
                                    (
                                    ζ
                                    )
                                    =
                                    0
                                 
                               
                              for all
                              
                                 
                                    ζ
                                    ∈
                                    
                                       R
                                       
                                          2
                                          c
                                       
                                    
                                 
                              
                              .
                           

The proof of Lemma 2.11 is given in Appendix A.

Next, constraints on new variables are added which correspond to identity inequalities 
                           
                              
                                 ∏
                                 
                                    s
                                    ∈
                                    b
                                 
                              
                              
                                 z
                                 s
                              
                              
                                 ∏
                                 
                                    s
                                    ∈
                                    c
                                    ∖
                                    b
                                 
                              
                              
                                 (
                                 1
                                 −
                                 
                                    z
                                    s
                                 
                                 )
                              
                              ≥
                              0
                           
                         for each 
                           
                              b
                              ⊂
                              c
                           
                        . Clearly this inequality holds for all 
                           
                              z
                              ∈
                              
                                 
                                    {
                                    0
                                    ,
                                    1
                                    }
                                 
                                 c
                              
                           
                        . By expanding this expression one obtains its equivalent multilinear polynomial 
                           
                              g
                              
                                 (
                                 z
                                 )
                              
                              =
                              
                                 ∑
                                 
                                    d
                                    ⊂
                                    c
                                    ∖
                                    b
                                 
                              
                              
                                 
                                    (
                                    −
                                    1
                                    )
                                 
                                 
                                    |
                                    d
                                    |
                                 
                              
                              
                                 ∏
                                 
                                    s
                                    ∈
                                    d
                                    ∪
                                    b
                                 
                              
                              
                                 z
                                 s
                              
                              ≥
                              0
                           
                        . Constraints (S4) ensure that the linearization of this expression is non-negative. The set of all such constraints defines the polytope

                           
                              (37)
                              
                                 
                                    
                                       
                                          
                                             
                                                Z
                                                c
                                             
                                             =
                                             
                                                {
                                                ζ
                                                ∈
                                                
                                                   R
                                                   
                                                      2
                                                      c
                                                   
                                                
                                                
                                                |
                                                
                                                
                                                   ζ
                                                   ∅
                                                
                                                =
                                                1
                                                ,
                                                
                                                
                                                   (
                                                   ∀
                                                   b
                                                   ⊂
                                                   c
                                                   )
                                                
                                                
                                                
                                                   ∑
                                                   
                                                      d
                                                      ⊂
                                                      c
                                                      ∖
                                                      b
                                                   
                                                
                                                
                                                   
                                                      (
                                                      −
                                                      1
                                                      )
                                                   
                                                   
                                                      |
                                                      d
                                                      |
                                                   
                                                
                                                
                                                   ζ
                                                   d
                                                
                                                ≥
                                                0
                                                }
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

In fact, polytope 
                           
                              Z
                              c
                           
                         is the convex hull of all binary vectors ζ corresponding to configurations z.

                           Lemma 2.12
                           Convex hull


                           
                              Polytope
                              
                                 
                                    Z
                                    c
                                 
                               
                              equals the convex hull
                              
                                 
                                    (38)
                                    
                                       
                                          
                                             
                                                
                                                   conv
                                                   
                                                      {
                                                      ζ
                                                      
                                                         (
                                                         z
                                                         )
                                                      
                                                      ∈
                                                      
                                                         R
                                                         
                                                            2
                                                            c
                                                         
                                                      
                                                      
                                                      |
                                                      
                                                      ζ
                                                      
                                                         
                                                            (
                                                            z
                                                            )
                                                         
                                                         d
                                                      
                                                      =
                                                      
                                                         ∏
                                                         
                                                            s
                                                            ∈
                                                            d
                                                         
                                                      
                                                      
                                                         z
                                                         s
                                                      
                                                      ,
                                                      
                                                      ∀
                                                      d
                                                      ⊂
                                                      c
                                                      ,
                                                      ∀
                                                      z
                                                      ∈
                                                      
                                                         
                                                            {
                                                            0
                                                            ,
                                                            1
                                                            }
                                                         
                                                         c
                                                      
                                                      }
                                                   
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              The proof of Lemma 2.12 is given in Appendix A.

From the convex hull representation there naturally follows an equivalence of identity inequalities before and after linearization.

                           Lemma 2.13
                           Identity inequality (S5)


                           
                              Let G(ζ) be the linearization of g(z). Then g(z) ≥ 0 for all
                              
                                 
                                    z
                                    ∈
                                    
                                       
                                          {
                                          0
                                          ,
                                          1
                                          }
                                       
                                       c
                                    
                                 
                               
                              iff G(ζ) ≥ 0 for all
                              
                                 
                                    ζ
                                    ∈
                                    
                                       Z
                                       c
                                    
                                 
                              
                              .
                           

The proof of Lemma 2.13 is given in Appendix A.

In particular, for 
                           
                              ζ
                              ∈
                              
                                 Z
                                 c
                              
                           
                         there holds 
                           
                              0
                              ≤
                              
                                 ζ
                                 d
                              
                              ≤
                              1
                           
                         for 
                           
                              d
                              ⊂
                              c
                              ,
                           
                         a relation which is rather difficult to prove directly from (37). Finally, for our construction the next two results are necessary.

                           Theorem 2.14
                           Lemma 2 of [58]
                           


                           
                              If
                              
                                 
                                    ζ
                                    ∈
                                    
                                       Z
                                       c
                                    
                                 
                               
                              and unary components ζs are integer (i.e., equal to some zs
                               ∈ {0, 1}) for all
                              
                                 
                                    s
                                    ∈
                                    c
                                    ,
                                 
                               
                              then there holds
                              
                                 
                                    
                                       ζ
                                       d
                                    
                                    =
                                    
                                       ∏
                                       
                                          s
                                          ∈
                                          d
                                       
                                    
                                    
                                       z
                                       s
                                    
                                 
                               
                              for all
                              
                                 
                                    d
                                    ⊂
                                    c
                                 
                              
                              .
                           


                              For
                              
                                 
                                    ζ
                                    ∈
                                    
                                       Z
                                       c
                                    
                                 
                               
                              there holds
                              
                                 
                                    
                                       ζ
                                       2
                                    
                                    ∈
                                    
                                       Z
                                       c
                                    
                                    ,
                                 
                               
                              where the product
                              
                                 
                                    
                                       ζ
                                       2
                                    
                                    =
                                    ζ
                                    ζ
                                 
                               
                              is component-wise.
                           

The proof of Lemma 2.15 is given in Appendix A.

When applying the linearization to all hyperedges simultaneously, a variable 
                           
                              ζ
                              
                                 a
                                 ∩
                                 b
                              
                           
                         is introduced only once for (overlapping) hyperedges 
                           
                              a
                              ,
                              b
                              ∈
                              E
                           
                        . All local properties described above continue to hold for each hyperedge 
                           
                              c
                              ∈
                              E
                           
                         individually but of course they need not hold for the whole set 
                           V
                        .

Let us return to the reformulation (35) of (max-WI) . It is clear that by opening brackets in (36), the coefficients 
                           
                              P
                              
                                 c
                                 ,
                                 
                                    x
                                    c
                                 
                                 ,
                                 
                                    x
                                    c
                                    ′
                                 
                              
                           
                         can be expressed as

                           
                              (39)
                              
                                 
                                    
                                       
                                          
                                             
                                                P
                                                
                                                   c
                                                   ,
                                                   
                                                      x
                                                      c
                                                   
                                                   ,
                                                   
                                                      x
                                                      c
                                                      ′
                                                   
                                                
                                             
                                             =
                                             
                                                ∑
                                                
                                                   d
                                                   ⊂
                                                   c
                                                
                                             
                                             
                                                c
                                                
                                                   c
                                                   ,
                                                   d
                                                
                                             
                                             
                                                (
                                                
                                                   x
                                                   c
                                                
                                                ,
                                                
                                                   x
                                                   d
                                                   ′
                                                
                                                )
                                             
                                             
                                                ∏
                                                
                                                   s
                                                   ∈
                                                   d
                                                
                                             
                                             
                                                ζ
                                                
                                                   s
                                                   ,
                                                   
                                                      x
                                                      s
                                                      ′
                                                   
                                                
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 c
                                 
                                    c
                                    ,
                                    d
                                 
                              
                              
                                 (
                                 
                                    x
                                    c
                                 
                                 ,
                                 
                                    x
                                    d
                                    ′
                                 
                                 )
                              
                           
                         are appropriate constants not depending on ζ (detailed in Section A.3). Because for 
                           
                              
                                 x
                                 s
                                 ′
                              
                              =
                              
                                 y
                                 s
                              
                           
                         there holds 
                           
                              
                                 p
                                 ζ
                              
                              
                                 
                                    (
                                    y
                                    )
                                 
                                 s
                              
                              =
                              
                                 y
                                 s
                              
                           
                         irrespectively of 
                           
                              ζ
                              
                                 s
                                 ,
                                 
                                    y
                                    s
                                 
                              
                           
                         (label ys
                         is always mapped to itself) we may assume that 
                           
                              
                                 ζ
                                 
                                    s
                                    ,
                                    
                                       y
                                       s
                                    
                                 
                              
                              =
                              0
                           
                         as well as all products involving it.

The relaxation of Sherali and Adams is applied as follows. Let us denote 
                           
                              
                                 
                                    X
                                    ˜
                                 
                                 s
                              
                              =
                              
                                 X
                                 s
                              
                              
                                 ∖
                              
                              
                                 {
                                 
                                    y
                                    s
                                 
                                 }
                              
                           
                         and respectively 
                           
                              
                                 
                                    X
                                    ˜
                                 
                                 c
                              
                              =
                              
                                 ∏
                                 
                                    s
                                    ∈
                                    c
                                 
                              
                              
                                 
                                    X
                                    ˜
                                 
                                 s
                              
                           
                        . We substitute new variables 
                           
                              
                                 ζ
                                 
                                    d
                                    ,
                                    
                                       x
                                       d
                                       ′
                                    
                                 
                              
                              ∈
                              R
                           
                         in place of products 
                           
                              
                                 ∏
                                 
                                    s
                                    ∈
                                    d
                                 
                              
                              
                                 ζ
                                 
                                    s
                                    ,
                                    
                                       x
                                       s
                                       ′
                                    
                                 
                              
                           
                         in (39). For zero products, i.e., for 
                           
                              
                                 x
                                 d
                                 ′
                              
                              ∉
                              
                                 
                                    X
                                    ˜
                                 
                                 d
                              
                              ,
                           
                         we let 
                           
                              
                                 ζ
                                 
                                    d
                                    ,
                                    
                                       x
                                       d
                                       ′
                                    
                                 
                              
                              =
                              0
                           
                        . From now on, let ζ denote the vector of relaxed variables

                           
                              (40)
                              
                                 
                                    
                                       
                                          
                                             ζ
                                             =
                                             (
                                             
                                                ζ
                                                
                                                   d
                                                   ,
                                                   
                                                      x
                                                      d
                                                   
                                                
                                             
                                             ∈
                                             R
                                             
                                             |
                                             
                                             ∀
                                             c
                                             ∈
                                             E
                                             ,
                                             
                                             d
                                             ⊂
                                             c
                                             ,
                                             
                                                x
                                                d
                                             
                                             ∈
                                             
                                                X
                                                d
                                             
                                             )
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        New variables ζ must satisfy the following constraints, defining a polytope 
                           Z
                        :

                           
                              (41a)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                ζ
                                                ∅
                                             
                                             =
                                             1
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (41b)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                (
                                                ∀
                                                c
                                                ∈
                                                E
                                                ,
                                                
                                                ∀
                                                
                                                   x
                                                   c
                                                   ′
                                                
                                                ∈
                                                
                                                   X
                                                   c
                                                
                                                ∖
                                                
                                                   
                                                      X
                                                      ˜
                                                   
                                                   c
                                                
                                                ,
                                                
                                                ∀
                                                d
                                                ⊂
                                                c
                                                )
                                             
                                             
                                             
                                             
                                                ζ
                                                
                                                   d
                                                   ,
                                                   
                                                      x
                                                      d
                                                      ′
                                                   
                                                
                                             
                                             =
                                             0
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (41c)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                (
                                                ∀
                                                c
                                                ∈
                                                E
                                                ,
                                                
                                                ∀
                                                
                                                   x
                                                   c
                                                   ′
                                                
                                                ∈
                                                
                                                   
                                                      X
                                                      ˜
                                                   
                                                   c
                                                
                                                ,
                                                
                                                ∀
                                                d
                                                ⊂
                                                c
                                                )
                                             
                                             
                                             
                                             
                                                ∑
                                                
                                                   d
                                                   ⊂
                                                   c
                                                   ∖
                                                   b
                                                
                                             
                                             
                                                
                                                   (
                                                   −
                                                   1
                                                   )
                                                
                                                
                                                   |
                                                   d
                                                   |
                                                
                                             
                                             
                                                ζ
                                                
                                                   d
                                                   ,
                                                   
                                                      x
                                                      d
                                                      ′
                                                   
                                                
                                             
                                             ≥
                                             0
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Polytope 
                           Z
                         is the intersection of polytopes 
                           
                              Z
                              c
                           
                         (37) lifted to the space of all variables over 
                           
                              c
                              ∈
                              E
                           
                         and 
                           
                              
                                 
                                    x
                                 
                                 c
                                 ′
                              
                              ∈
                              
                                 
                                    X
                                    ˜
                                 
                                 c
                              
                           
                        . Let Pζ
                         denote the extension-linearization of pζ
                         (34), according to (39) and (S2) defined by:

                           
                              (42)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   (
                                                   
                                                      P
                                                      ζ
                                                   
                                                   )
                                                
                                                
                                                   c
                                                   ,
                                                   
                                                      x
                                                      c
                                                   
                                                   ,
                                                   
                                                      x
                                                      c
                                                      ′
                                                   
                                                
                                             
                                             =
                                             
                                                ∑
                                                
                                                   d
                                                   ⊂
                                                   c
                                                
                                             
                                             
                                                c
                                                
                                                   c
                                                   ,
                                                   d
                                                
                                             
                                             
                                                (
                                                
                                                   x
                                                   c
                                                
                                                ,
                                                
                                                   x
                                                   d
                                                   ′
                                                
                                                )
                                             
                                             
                                                ζ
                                                
                                                   d
                                                   ,
                                                   
                                                      x
                                                      d
                                                      ′
                                                   
                                                
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        For our purpose it is necessary that the linearized map Pζ
                         preserves the relaxation polytope Λ: Pζ
                        (Λ) ⊂ Λ. This constraint expresses as (∀μ ∈ Λ)

                           
                              (43a)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   (
                                                   
                                                      P
                                                      ζ
                                                   
                                                   μ
                                                   )
                                                
                                                ∅
                                             
                                             =
                                             1
                                             ;
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (43b)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                P
                                                ζ
                                             
                                             μ
                                             ≥
                                             0
                                             ;
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (43c)
                              
                                 
                                    
                                       
                                       
                                          
                                             A
                                             
                                                P
                                                ζ
                                             
                                             μ
                                             ≥
                                             0
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

We trivially have 
                           
                              
                                 
                                    (
                                    
                                       P
                                       ζ
                                    
                                    )
                                 
                                 ∅
                              
                              =
                              
                                 ζ
                                 ∅
                              
                              =
                              1
                           
                        . It is also easy to show that 
                           
                              
                                 
                                    (
                                    
                                       P
                                       ζ
                                    
                                    )
                                 
                                 
                                    c
                                    ,
                                    
                                       x
                                       c
                                    
                                    ,
                                    
                                       x
                                       c
                                       ′
                                    
                                 
                              
                              ≥
                              0
                           
                         for 
                           
                              ζ
                              ∈
                              Z
                           
                        : before linearization, coefficients 
                           
                              P
                              
                                 c
                                 ,
                                 
                                    x
                                    c
                                 
                                 ,
                                 
                                    x
                                    c
                                    ′
                                 
                              
                           
                         in the expression (36) are clearly non-negative and by property (S5) it is guaranteed that 
                           
                              
                                 
                                    (
                                    
                                       P
                                       ζ
                                    
                                    )
                                 
                                 
                                    c
                                    ,
                                    
                                       x
                                       c
                                    
                                    ,
                                    
                                       x
                                       c
                                       ′
                                    
                                 
                              
                              ≥
                              0
                           
                         holds on 
                           Z
                        . Then for μ ≥ 0 there holds Pζμ ≥ 0. Interestingly, the converse is also true (but this result is not necessary in the subsequent construction):

                           Theorem 2.16
                           
                              Inequalities (
                              
                                 41c
                              
                              ) in the definition of polytope
                              
                                 Z
                               
                              can be equivalently replaced with Pζ
                               ≥ 0.
                           

The proof of Theorem 2.16 is given in Appendix A.

There remains constraint (43c). In the case of standard local relaxations (to be defined later) constraint (43c) holds automatically and needs not be enforced. To account for general relaxations, we include constraint (43c) explicitly by representing it similarly to Theorem 2.8 in the dual form as:

                           
                              (44)
                              
                                 
                                    
                                       (
                                       ∃
                                       Φ
                                       ∈
                                       
                                          R
                                          +
                                          
                                             m
                                             ×
                                             |
                                             I
                                             |
                                          
                                       
                                       )
                                    
                                    
                                    
                                    A
                                    
                                       P
                                       ζ
                                    
                                    −
                                    
                                       Φ
                                       T
                                    
                                    A
                                    ≥
                                    0
                                    .
                                 
                              
                           
                        We arrive at the following relaxation of (max-WI) as a linear program:

                           
                              (L1)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                min
                                                
                                                   
                                                      
                                                         
                                                            
                                                               ζ
                                                               ,
                                                               φ
                                                               ,
                                                               Φ
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                ∑
                                                
                                                   s
                                                   ,
                                                   i
                                                
                                             
                                             
                                                ζ
                                                
                                                   s
                                                   ,
                                                   i
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (45a)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                (
                                                I
                                                −
                                                
                                                   P
                                                   ζ
                                                   T
                                                
                                                )
                                             
                                             f
                                             −
                                             
                                                A
                                                T
                                             
                                             φ
                                             ≥
                                             0
                                             ;
                                             
                                             
                                             φ
                                             ≥
                                             0
                                             ;
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (45b)
                              
                                 
                                    
                                       
                                       
                                          
                                             A
                                             
                                                P
                                                ζ
                                             
                                             −
                                             
                                                Φ
                                                T
                                             
                                             A
                                             ≥
                                             0
                                             ;
                                             
                                             
                                             Φ
                                             ≥
                                             0
                                             ;
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (45c)
                              
                                 
                                    
                                       
                                       
                                          
                                             ζ
                                             ∈
                                             Z
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Constraint (45a) ensures that mapping Pζ
                         is relaxed-improving, constraints (45b) that it preserves the polytope: Pζ
                        (Λ) ⊂ Λ and constraint (45c) ensures that for each 
                           
                              c
                              ∈
                              E
                           
                         relaxed variables 
                           
                              (
                              
                                 ζ
                                 
                                    d
                                    ,
                                    
                                       x
                                       d
                                    
                                 
                              
                              
                              |
                              
                              d
                              ⊂
                              c
                              )
                           
                         stay in the local convex hull for 
                           c
                        .

We claim that this relaxation is tight. As shown below, rounding down all components of ζ in a feasible solution maintains feasibility (with possibly different values of φ, Φ) and can only improve the objective. The rounding is performed by constructing the composite mapping PζPζ
                        . If Pζ
                         is relaxed-improving then so is (Pζ
                        )2 provided that it satisfies all feasibility constraints. The auxiliary lemma below establishes this feasibility: it verifies that 
                           
                              
                                 P
                                 ζ
                                 2
                              
                              =
                              
                                 P
                                 
                                    ζ
                                    2
                                 
                              
                           
                        . Starting from a non-integer ζ and building a feasible sequence by taking ζ ↦ ζ
                        2 we get each next point closer and closer to the integer limit.

                           Lemma 2.17
                           
                              For
                              
                                 
                                    ζ
                                    ∈
                                    Z
                                 
                               
                              there holds
                              
                                 
                                    
                                       P
                                       ζ
                                       2
                                    
                                    =
                                    
                                       P
                                       
                                          ζ
                                          2
                                       
                                    
                                 
                              
                              .
                           

The proof of Lemma 2.17 is given in Appendix A.


                              In a solution (ζ, φ, Φ) to (
                              
                                 L1
                              
                              ) vector ζ is integer.
                           

Because ζ is feasible to (L1), the mapping Pζ
                               is Λ-improving for f. Note, at this point, unless ζ is integer it is not guaranteed that 
                                 
                                    
                                       P
                                       ζ
                                    
                                    
                                       (
                                       M
                                       )
                                    
                                    ⊂
                                    M
                                 
                               and we cannot draw any partial optimality from it, neither Pζ
                               is guaranteed to be idempotent. By constraints (45b), (45c), there holds Pζ
                              (Λ) ⊂ Λ. Therefore

                                 
                                    (46)
                                    
                                       
                                          
                                             (
                                             ∀
                                             μ
                                             ∈
                                             Λ
                                             )
                                          
                                          
                                          
                                             〈
                                             f
                                             ,
                                             
                                                P
                                                ζ
                                             
                                             
                                                P
                                                ζ
                                             
                                             μ
                                             〉
                                          
                                          ≤
                                          
                                             〈
                                             f
                                             ,
                                             
                                                P
                                                ζ
                                             
                                             μ
                                             〉
                                          
                                          ≤
                                          
                                             〈
                                             f
                                             ,
                                             μ
                                             〉
                                          
                                          .
                                       
                                    
                                 
                              It follows that 
                                 
                                    
                                       P
                                       ζ
                                       2
                                    
                                    =
                                    
                                       P
                                       ζ
                                    
                                    
                                       P
                                       ζ
                                    
                                 
                               is Λ-improving. Since Pζ
                              (Λ) ⊂ Λ , it is also 
                                 
                                    
                                       P
                                       ζ
                                       2
                                    
                                    
                                       (
                                       Λ
                                       )
                                    
                                    ⊂
                                    
                                       P
                                       ζ
                                    
                                    
                                       (
                                       Λ
                                       )
                                    
                                    ⊂
                                    Λ
                                 
                              .

By Lemma 2.17, there holds 
                                 
                                    
                                       P
                                       ζ
                                       2
                                    
                                    =
                                    
                                       P
                                       
                                          ζ
                                          2
                                       
                                    
                                 
                               and by Lemma 2.15
                              
                                 
                                    
                                       ζ
                                       2
                                    
                                    ∈
                                    Z
                                 
                              . By induction, there holds 
                                 
                                    
                                       P
                                       ζ
                                       
                                          2
                                          n
                                       
                                    
                                    =
                                    
                                       P
                                       
                                          ζ
                                          
                                             2
                                             n
                                          
                                       
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       P
                                       ζ
                                       
                                          2
                                          n
                                       
                                    
                                    
                                       (
                                       Λ
                                       )
                                    
                                    ⊂
                                    Λ
                                 
                               and 
                                 
                                    P
                                    ζ
                                    
                                       2
                                       n
                                    
                                 
                               is Λ-improving. Let

                                 
                                    (47)
                                    
                                       
                                          
                                             ζ
                                             
                                                c
                                                ,
                                                
                                                   x
                                                   c
                                                
                                             
                                             *
                                          
                                          =
                                          
                                             lim
                                             
                                                n
                                                →
                                                ∞
                                             
                                          
                                          
                                             ζ
                                             
                                                c
                                                ,
                                                
                                                   x
                                                   c
                                                
                                             
                                             
                                                2
                                                n
                                             
                                          
                                          =
                                          〚
                                          
                                             ζ
                                             
                                                c
                                                ,
                                                
                                                   x
                                                   c
                                                
                                             
                                          
                                          =
                                          1
                                          〛
                                          .
                                       
                                    
                                 
                              Since 
                                 
                                    P
                                    
                                       ζ
                                       *
                                    
                                 
                               is Λ-improving and 
                                 
                                    
                                       ζ
                                       *
                                    
                                    ∈
                                    Z
                                    ,
                                 
                               it is feasible to (L1). Assume for contradiction that there exist (s′, i′) such that 
                                 
                                    0
                                    <
                                    
                                       ζ
                                       
                                          
                                             s
                                             ′
                                          
                                          
                                             i
                                             ′
                                          
                                       
                                    
                                    <
                                    1
                                 
                              . From (47) we have 
                                 
                                    
                                       ζ
                                       
                                          s
                                          i
                                       
                                       *
                                    
                                    ≤
                                    
                                       ζ
                                       
                                          s
                                          i
                                       
                                    
                                 
                               for all s, i and 
                                 
                                    
                                       ζ
                                       
                                          
                                             s
                                             ′
                                          
                                          
                                             i
                                             ′
                                          
                                       
                                       *
                                    
                                    <
                                    
                                       ζ
                                       
                                          
                                             s
                                             ′
                                          
                                          
                                             i
                                             ′
                                          
                                       
                                    
                                 
                              . It follows that ζ
                              * achieves a strictly better objective value, which contradicts the optimality of ζ. If all unary components ζ
                              
                                 s, i
                               are integer then by Theorem 2.14 
                              ζ is integer.□


                              The optimal solution to (
                              
                                 L1
                              
                              ) is unique.
                           

Assume for contradiction that ζ
                              1, ζ
                              2 are two distinct integer solutions to (L1). Since (L1) is a linear program, their combination 
                                 
                                    ζ
                                    =
                                    (
                                    
                                       ζ
                                       1
                                    
                                    +
                                    
                                       ζ
                                       1
                                    
                                    )
                                    /
                                    2
                                 
                               is an optimal solution (values of φ, Φ are omitted for clarity). But if ζ
                              1 ≠ ζ
                              2 then ζ is not integer, which contradicts Theorem 2.18.□

Clearly, for an integer vector 
                           
                              ζ
                              ∈
                              Z
                           
                         the linearization Pζ
                         coincides with the extension of the discrete mapping pζ
                         (34). It follows that the unique optimal solution to (L1) is the solution to (max-WI) .

Problem (max-SI) over 
                           
                              P
                              
                                 2
                                 ,
                                 y
                              
                           
                         can be reduced to (max-WI) with a perturbed cost vector 
                           
                              f
                              ˜
                           
                         as follows. It is sufficient to show that dual representation (32) of constraint 
                           
                              
                                 [
                                 p
                                 ]
                              
                              ∈
                              
                                 S
                                 f
                              
                              
                           
                         can be reduced to that of 
                           
                              
                                 [
                                 p
                                 ]
                              
                              ∈
                              
                                 W
                                 
                                    f
                                    ˜
                                 
                              
                              
                           
                        . For 
                           
                              p
                              ∈
                              
                                 P
                                 
                                    2
                                    ,
                                    y
                                 
                              
                           
                         we can choose components of vector h in the dual representation (32) of 
                           
                              
                                 S
                                 f
                              
                              
                           
                         as

                           
                              (48a)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                h
                                                c
                                             
                                             
                                                (
                                                
                                                   x
                                                   c
                                                
                                                )
                                             
                                             =
                                             
                                                g
                                                c
                                             
                                             
                                                (
                                                
                                                   p
                                                   c
                                                
                                                
                                                   (
                                                   
                                                      x
                                                      c
                                                   
                                                   )
                                                
                                                )
                                             
                                             −
                                             
                                                g
                                                c
                                             
                                             
                                                (
                                                
                                                   x
                                                   c
                                                
                                                )
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (48b)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                g
                                                c
                                             
                                             
                                                (
                                                
                                                   x
                                                   c
                                                
                                                )
                                             
                                             =
                                             
                                                ∑
                                                
                                                   s
                                                   ∈
                                                   c
                                                
                                             
                                             〚
                                             
                                                x
                                                s
                                             
                                             =
                                             
                                                y
                                                s
                                             
                                             〛
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Clearly, 
                           
                              
                                 p
                                 c
                              
                              
                                 (
                                 
                                    x
                                    c
                                 
                                 )
                              
                              =
                              
                                 x
                                 c
                              
                           
                         iff 
                           
                              
                                 h
                                 c
                              
                              
                                 (
                                 
                                    x
                                    c
                                 
                                 )
                              
                              =
                              0
                           
                         and for 
                           
                              
                                 p
                                 c
                              
                              
                                 (
                                 
                                    x
                                    c
                                 
                                 )
                              
                              ≠
                              
                                 x
                                 c
                              
                           
                         there holds 
                           
                              1
                              ≤
                              
                                 h
                                 c
                              
                              
                                 (
                                 
                                    x
                                    c
                                 
                                 )
                              
                              ≤
                              
                                 |
                                 c
                                 |
                              
                           
                        . With such a vector h the dual representation of 
                           
                              
                                 S
                                 f
                              
                              
                           
                         can be written as

                           
                              (49)
                              
                                 
                                    
                                       
                                          
                                             
                                                (
                                                f
                                                +
                                                
                                                   ɛ
                                                
                                                g
                                                )
                                             
                                             −
                                             
                                                
                                                   [
                                                   p
                                                   ]
                                                
                                                T
                                             
                                             
                                                (
                                                f
                                                +
                                                
                                                   ɛ
                                                
                                                g
                                                )
                                             
                                             −
                                             
                                                A
                                                T
                                             
                                             φ
                                             ≥
                                             0
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        i.e., the same constraint as (29) must hold but for an ε-perturbed cost vector

                           
                              (50)
                              
                                 
                                    
                                       f
                                       ˜
                                    
                                    :
                                    =
                                    f
                                    +
                                    
                                       ɛ
                                    
                                    g
                                    .
                                 
                              
                           
                        Since the solution ζ to the perturbed problem is integer and unique it is the optimal solution to (max-SI) .

Let us consider the class 
                           
                              P
                              
                                 1
                                 ,
                                 y
                              
                           
                        . Formulation (L1) can be adopted by incorporating additional constraints on ζ (making variables 
                           
                              ζ
                              
                                 s
                                 ,
                                 
                                    x
                                    s
                                 
                              
                           
                         equal for all xs
                        ). The proof of Theorem 2.18 is based on the fact that for a feasible ζ also ζ
                        2 is feasible. Clearly, this property is not destroyed by any equality constraints between components of ζ. Therefore Theorem 2.18 continues to hold and thus both (max-SI) and (max-WI) problems over 
                           
                              P
                              
                                 1
                                 ,
                                 y
                              
                           
                         are tractable.

For class 
                           
                              P
                              1
                           
                         the problem (max-SI) can be solved as proposed by Algorithm 1. It first solves the LP-relaxation in order to determine the test labeling y and then solves the (max-SI) problem for fixed y using perturbed (L1) for class 
                           
                              P
                              
                                 1
                                 ,
                                 y
                              
                           
                        .

                           Theorem 2.20
                           
                              Algorithm 
                              
                                 1
                               
                              solves (max-SI) over
                              
                                 
                                    P
                                    1
                                 
                              
                              .
                           

The necessary conditions of Lemma 2.7 for the optimal solution of LP-relaxation require that a strictly-improving mapping does not change optimal relaxed solutions. From the component-wise condition (28b) follows that when μs
                               if fractional for some s then ps
                               (assuming 
                                 
                                    p
                                    ∈
                                    
                                       P
                                       1
                                    
                                 
                              ) must be identity. When μs
                               is integer, the only possible value of ys
                               qualifying necessary conditions must correspond to 
                                 
                                    
                                       μ
                                       s
                                    
                                    
                                       (
                                       
                                          y
                                          s
                                       
                                       )
                                    
                                    =
                                    1
                                 
                              . Applying perturbation in step 3 and optimizing over 
                                 
                                    P
                                    
                                       1
                                       ,
                                       y
                                    
                                 
                               in step 4 we obtain the optimal solution.□

As a general heuristic, we can apply the same two-phase method, optimizing in step 4 over 
                           
                              P
                              
                                 1
                                 ,
                                 y
                              
                           
                         or 
                           
                              P
                              
                                 2
                                 ,
                                 y
                              
                           
                         with or without perturbation. The persistent assignment found by the heuristic is guaranteed to be at least as large as the solution of (max-SI) over 
                           
                              P
                              1
                           
                        .

In this section we consider a special case of local (or standard) LP relaxations in energy minimization [11,38,58,59,70], see also the survey by Werner [72]. In our notation local relaxations are described by the polytope Λ of the form

                        
                           (51)
                           
                              
                                 
                                    
                                       
                                          Λ
                                          =
                                          {
                                          μ
                                          ∈
                                          
                                             R
                                             I
                                          
                                          
                                          |
                                          
                                          A
                                          μ
                                          =
                                          0
                                          ;
                                          
                                          
                                             μ
                                             ∅
                                          
                                          =
                                          1
                                          ;
                                          
                                          μ
                                          ≥
                                          0
                                          }
                                          .
                                       
                                    
                                 
                              
                           
                        
                     
                  

Recall that in the embedding δ, different components of a relaxed labeling μ, e.g., 
                        
                           μ
                           c
                        
                      and 
                        
                           μ
                           d
                        
                      for 
                        
                           d
                           ⊊
                           c
                        
                      represent overlapping subsets of variables. In order that they represent all discrete labelings consistently they must satisfy marginalization constraints of the form

                        
                           (52)
                           
                              
                                 
                                    (
                                    ∀
                                    
                                       x
                                       d
                                    
                                    ∈
                                    
                                       X
                                       d
                                    
                                    )
                                 
                                 
                                 
                                    ∑
                                    
                                       x
                                       
                                          c
                                          ∖
                                          d
                                       
                                    
                                 
                                 
                                    μ
                                    c
                                 
                                 
                                    (
                                    
                                       x
                                       c
                                    
                                    )
                                 
                                 =
                                 
                                    μ
                                    d
                                 
                                 
                                    (
                                    
                                       x
                                       d
                                    
                                    )
                                 
                                 .
                              
                           
                        
                     
                  

Werner [74] considers a family of LP relaxations generated by enforcing constraint (52) for some pairs of subsets 
                        
                           c
                           ∈
                           E
                           ,
                           d
                           ⊊
                           c
                        
                     . The set of such pairs is called the coupling structure [74]. For 
                        
                           c
                           ,
                           d
                           ⊂
                           V
                        
                      we define coupling relation 
                        
                           d
                           
                              ⊊
                              .
                           
                           c
                        
                      of order d: let 
                        
                           d
                           
                              ⊊
                              .
                           
                           c
                        
                      iff

                        
                           (53)
                           
                              
                                 
                                    
                                       
                                          d
                                          ⊊
                                          c
                                          ,
                                          
                                          c
                                          ,
                                          d
                                          ∈
                                          E
                                          ,
                                          
                                          |
                                          d
                                          |
                                          ≤
                                          d
                                          .
                                       
                                    
                                 
                              
                           
                        
                     Subsequently, we will consider two possibilities: to include only first order constraints or all of them. Zero order constraints (52) define just normalization:

                        
                           
                              
                                 
                                    ∑
                                    
                                       x
                                       c
                                    
                                 
                                 
                                    μ
                                    c
                                 
                                 
                                    (
                                    
                                       x
                                       c
                                    
                                    )
                                 
                                 =
                                 
                                    μ
                                    ∅
                                 
                                 .
                              
                           
                        
                     Together with non-negativity they guarantee boundedness (which was assumed in the general case Section 1.3). The first order constraints (52) add marginalization constraints of the form

                        
                           (54)
                           
                              
                                 
                                    (
                                    ∀
                                    s
                                    ∈
                                    c
                                    ,
                                    
                                    ∀
                                    
                                       x
                                       s
                                    
                                    ∈
                                    
                                       X
                                       s
                                    
                                    )
                                 
                                 
                                 
                                    ∑
                                    
                                       x
                                       
                                          c
                                          ∖
                                          {
                                          s
                                          }
                                       
                                    
                                 
                                 
                                    μ
                                    c
                                 
                                 
                                    (
                                    
                                       x
                                       c
                                    
                                    )
                                 
                                 =
                                 
                                    μ
                                    s
                                 
                                 
                                    (
                                    
                                       x
                                       s
                                    
                                    )
                                 
                                 .
                              
                           
                        
                     And so on. By specifying larger d, we introduce more coupling between relaxed variables.

Note that any relaxation in the form (51) is local, i.e., tied to the hypergraph. We cannot add more facets (inequalities) without increasing the number of variables and the variables are defined by the fixed embedding δ. Tightening the relaxation is thus only possible by enlarging the hypergraph (adding zero interactions in [72]), which results in an exponential increase in the number of relaxed variables. An example of a non-local relaxation is the cutting plane method [60], which progressively adds facet-defining inequalities coupling many variables at a time. While general results of Section 2 are applicable, the local representation would not be tractable.

The primal and dual LP relaxation problems for coupling 
                        
                           ⊊
                           .
                        
                      are expressed as follows:

                        
                           
                              
                                 
                                    
                                    
                                       
                                          min
                                          〈
                                          f
                                          ,
                                          μ
                                          〉
                                          
                                          
                                          
                                          =
                                       
                                    
                                    
                                       
                                          max
                                          ψ
                                       
                                    
                                 
                                 
                                    
                                       
                                          (
                                          ∀
                                          d
                                          
                                             ⊊
                                             .
                                          
                                          c
                                          )
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                             
                                                x
                                                
                                                   c
                                                   ∖
                                                   d
                                                
                                             
                                          
                                          
                                             μ
                                             c
                                          
                                          
                                             (
                                             
                                                x
                                                c
                                             
                                             )
                                          
                                          =
                                          
                                             μ
                                             d
                                          
                                          
                                             (
                                             
                                                x
                                                d
                                             
                                             )
                                          
                                          ,
                                       
                                    
                                    
                                       
                                          
                                             φ
                                             
                                                d
                                                ,
                                                c
                                             
                                          
                                          
                                             (
                                             
                                                x
                                                d
                                             
                                             )
                                          
                                          ∈
                                          R
                                          ,
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                             μ
                                             ∅
                                          
                                          =
                                          1
                                          ,
                                       
                                    
                                    
                                       
                                          ψ
                                          ∈
                                          R
                                          ,
                                       
                                    
                                 
                                 
                                    
                                       
                                          (
                                          ∀
                                          c
                                          ∈
                                          E
                                          ,
                                          
                                          ∀
                                          
                                             x
                                             c
                                          
                                          )
                                       
                                    
                                    
                                       
                                          
                                             μ
                                             c
                                          
                                          
                                             (
                                             
                                                x
                                                c
                                             
                                             )
                                          
                                          ≥
                                          0
                                          ,
                                       
                                    
                                    
                                       
                                          
                                             f
                                             c
                                             φ
                                          
                                          
                                             (
                                             
                                                x
                                                c
                                             
                                             )
                                          
                                          ≥
                                          
                                             {
                                             
                                                
                                                   
                                                      
                                                         0
                                                         ,
                                                      
                                                   
                                                   
                                                      
                                                         c
                                                         ≠
                                                         ∅
                                                         ,
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         ψ
                                                         ,
                                                      
                                                   
                                                   
                                                      
                                                         c
                                                         =
                                                         ∅
                                                         .
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     Matrix A corresponds to primal equality constraints. Vector 
                        
                           
                              f
                              φ
                           
                           =
                           f
                           −
                           
                              A
                              T
                           
                           φ
                        
                      is an equivalent transformation [59] or reparametrization [70] of f. Its components are expressed as

                        
                           (55)
                           
                              
                                 
                                    
                                       
                                          
                                             f
                                             c
                                             φ
                                          
                                          
                                             (
                                             
                                                x
                                                c
                                             
                                             )
                                          
                                       
                                    
                                    
                                       
                                          =
                                          
                                             f
                                             c
                                          
                                          
                                             (
                                             
                                                x
                                                c
                                             
                                             )
                                          
                                          −
                                          
                                             ∑
                                             
                                                
                                                   
                                                      
                                                         
                                                            d
                                                            
                                                               ⊊
                                                               .
                                                            
                                                            c
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             φ
                                             
                                                d
                                                ,
                                                c
                                             
                                          
                                          
                                             (
                                             
                                                x
                                                d
                                             
                                             )
                                          
                                          +
                                          
                                             ∑
                                             
                                                
                                                   
                                                      
                                                         
                                                            h
                                                            
                                                               ⊋
                                                               .
                                                            
                                                            c
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             φ
                                             
                                                c
                                                ,
                                                h
                                             
                                          
                                          
                                             (
                                             
                                                x
                                                c
                                             
                                             )
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        
                     In particular, components 
                        
                           f
                           ∅
                           φ
                        
                      and 
                        
                           
                              f
                              s
                              φ
                           
                           
                              (
                              
                                 x
                                 s
                              
                              )
                           
                        
                      are expressed as

                        
                           (56a)
                           
                              
                                 
                                    
                                       
                                          f
                                          ∅
                                          φ
                                       
                                    
                                    
                                       
                                          =
                                          
                                             f
                                             ∅
                                          
                                          +
                                          
                                             ∑
                                             
                                                
                                                   
                                                      
                                                         
                                                            c
                                                            
                                                               ⊋
                                                               .
                                                            
                                                            ∅
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             φ
                                             
                                                ∅
                                                ,
                                                c
                                             
                                          
                                          ;
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (56b)
                           
                              
                                 
                                    
                                       
                                          
                                             f
                                             s
                                             φ
                                          
                                          
                                             (
                                             
                                                x
                                                s
                                             
                                             )
                                          
                                       
                                    
                                    
                                       
                                          =
                                          
                                             f
                                             s
                                          
                                          
                                             (
                                             
                                                x
                                                s
                                             
                                             )
                                          
                                          −
                                          
                                             φ
                                             
                                                ∅
                                                ,
                                                s
                                             
                                          
                                          +
                                          
                                             ∑
                                             
                                                
                                                   
                                                      
                                                         
                                                            h
                                                            
                                                               ⊋
                                                               .
                                                            
                                                            
                                                               {
                                                               s
                                                               }
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             φ
                                             
                                                s
                                                ,
                                                h
                                             
                                          
                                          
                                             (
                                             
                                                x
                                                s
                                             
                                             )
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        
                     
                  

For any 
                        
                           φ
                           ∈
                           
                              R
                              m
                           
                        
                      there holds

                        
                           (57)
                           
                              
                                 
                                    (
                                    ∀
                                    μ
                                    ∈
                                    Λ
                                    )
                                 
                                 
                                 
                                 
                                    〈
                                    
                                       f
                                       φ
                                    
                                    ,
                                    μ
                                    〉
                                 
                                 =
                                 
                                    〈
                                    f
                                    ,
                                    μ
                                    〉
                                 
                                 −
                                 
                                    〈
                                    φ
                                    ,
                                    A
                                    μ
                                    〉
                                 
                                 =
                                 
                                    〈
                                    f
                                    ,
                                    μ
                                    〉
                                 
                                 .
                              
                           
                        
                     Since 
                        
                           Λ
                           ⊃
                           M
                           ⊃
                           δ
                           (
                           X
                           )
                           ,
                        
                      it follows that 
                        
                           
                              E
                              f
                           
                           
                              (
                              x
                              )
                           
                           =
                           
                              E
                              
                                 f
                                 φ
                              
                           
                           
                              (
                              x
                              )
                           
                        
                      for all 
                        
                           x
                           ∈
                           X
                        
                     . Hence f
                     φ is indeed equivalent to f in defining the energy function.

The dual problem can be equivalently written as

                        
                           (58)
                           
                              
                                 max
                                 {
                                 
                                    f
                                    ∅
                                    φ
                                 
                                 
                                 |
                                 
                                 
                                    (
                                    ∀
                                    c
                                    ≠
                                    ∅
                                    )
                                 
                                 
                                 
                                    f
                                    c
                                    φ
                                 
                                 
                                    (
                                    
                                       x
                                       c
                                    
                                    )
                                 
                                 ≥
                                 0
                                 ,
                                 
                                 φ
                                 ∈
                                 
                                    R
                                    m
                                 
                                 }
                                 ,
                              
                           
                        
                     we therefore can speak of the dual solution as just φ.

Complementary slackness for (LP) reads that a feasible primal-dual pair (μ, φ) is optimal iff 
                           
                              (
                              ∀
                              c
                              ∈
                              E
                              ∖
                              
                                 {
                                 ∅
                                 }
                              
                              ,
                              
                              ∀
                              
                                 x
                                 c
                              
                              )
                           
                        
                        
                           
                              (59)
                              
                                 
                                    
                                       
                                          
                                             
                                                μ
                                                
                                                   c
                                                   
                                                      x
                                                      c
                                                   
                                                
                                             
                                             >
                                             0
                                             
                                             ⇒
                                             
                                             
                                          
                                       
                                       
                                          
                                             
                                                f
                                                c
                                                φ
                                             
                                             
                                                
                                                
                                                   x
                                                   c
                                                
                                             
                                             =
                                             0
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        Because a feasible dual solution satisfies 
                           
                              
                                 f
                                 c
                                 φ
                              
                              ≥
                              0
                              ,
                           
                         the condition on the RHS of (59) implies that assignment 
                           
                              x
                              c
                           
                         is locally minimal for 
                           
                              f
                              c
                              φ
                           
                        : 
                           
                              
                                 x
                                 c
                              
                              ∈
                              argmin
                              
                                 f
                                 c
                                 φ
                              
                              
                                 (
                                 ·
                                 )
                              
                           
                        .

Let (μ, φ) be a feasible primal-dual pair for (LP). This pair is called strictly complementary if

                           
                              (60a)
                              
                                 
                                    
                                       
                                          
                                             
                                                μ
                                                c
                                             
                                             
                                                (
                                                
                                                   x
                                                   c
                                                
                                                )
                                             
                                             >
                                             0
                                             
                                          
                                       
                                       
                                          
                                             ⇔
                                             
                                             
                                                f
                                                c
                                                φ
                                             
                                             
                                                (
                                                
                                                   x
                                                   c
                                                
                                                )
                                             
                                             =
                                             0
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Clearly, a strictly complementary pair is complementary and thus it is optimal. Such a pair always exists and can be found by interior point algorithms (see e.g., [68]). It is known that μ is a relative interior point of the primal optimal facet and φ is a relative interior point of the dual optimal facet.

The following conditions, known as arc consistency (AC, e.g., [74]), are satisfied for strictly complementary pairs:

                           
                              •
                              If 
                                    
                                       
                                          f
                                          c
                                          φ
                                       
                                       
                                          (
                                          
                                             x
                                             c
                                          
                                          )
                                       
                                       =
                                       0
                                    
                                  then 
                                    
                                       (
                                       ∀
                                       d
                                       
                                          ⊊
                                          .
                                       
                                       c
                                       )
                                    
                                 
                                 
                                    
                                       
                                          f
                                          d
                                          φ
                                       
                                       
                                          (
                                          
                                             x
                                             d
                                          
                                          )
                                       
                                       =
                                       0
                                    
                                 .

If 
                                    
                                       
                                          f
                                          d
                                          φ
                                       
                                       
                                          (
                                          
                                             x
                                             d
                                          
                                          )
                                       
                                       =
                                       0
                                    
                                  then 
                                    
                                       (
                                       ∀
                                       c
                                       
                                          ⊋
                                          .
                                       
                                       d
                                       )
                                    
                                 
                                 
                                    
                                       (
                                       ∃
                                       
                                          x
                                          c
                                          ′
                                       
                                       ∈
                                       
                                          X
                                          c
                                       
                                       
                                       |
                                       
                                       
                                          x
                                          d
                                          ′
                                       
                                       =
                                       
                                          x
                                          d
                                       
                                       )
                                    
                                 
                                 
                                    
                                       
                                          f
                                          c
                                          φ
                                       
                                       
                                          (
                                          
                                             x
                                             c
                                             ′
                                          
                                          )
                                       
                                       =
                                       0
                                    
                                 .

These conditions say that the set of local minimizers must be consistent over overlapping hyperedges. Arc consistency is a necessary but, in general, not sufficient condition for strict complementarity.

The relaxation with marginalization constraints of order 1 is known as basic LP relaxation (BLP) [74]. Note, if we do not enforce marginalization constraints of at least order 1 there may occur integer feasible solutions to the relaxation which are not consistent, i.e., do not correspond to a global assignment. Out of all local relaxations BLP is the least constrained useful one. It is remarkable that it is tight for all tractable languages [30,66,67]. However, for certain purposes BLP is not sufficient, as can be illustrated with pseudo-Boolean functions. Suppose we would like to express a pseudo-Boolean function of 3 variables as a cubic polynomial. We know it can be expressed in this form, however, such a desired equivalent transformation of the problem appears to be not equivalent for BLP and hence not equivalent for the maximum persistency problem. Another difficulty is that fixing a variable to its optimal value is not the same as eliminating this variable. Example in Fig. 7 illustrates that eliminating a persistent variable tightens the relaxation. It follows that under BLP relaxation we will not be able to compare theoretically neither to quadratization techniques (as they perform general equivalent transformations) nor to generalized roof duality [23], which incrementally eliminates persistent variables.

The relaxation with all marginalization constraints present will be referred to as full local LP relaxation (FLP). For every hyperedge all its subsets are assumed to be contained in 
                           E
                         and all constraints of the form (52) with d equal to the order of the problem are included. In case of pairwise model, individual nodes are the only proper subsets of edges and hence BLP and FLP are the same. In the pseudo-Boolean case, FLP matches the relaxation of Sherali and Adams [58] as discussed in Section A.9.

In this section we summarize how the general construction and formulation of (L1) simplifies for local relaxations. First, the constraint Pζ
                        (Λ) ⊂ Λ holds automatically and needs not be enforced. It is shown in two steps: first we consider the linear extension [p] of any node-wise mapping p and then the linearized mapping Pζ
                        , 
                           
                              ζ
                              ∈
                              Z
                           
                        .

                           Lemma 3.1
                           
                              Node-wise mapping [p] preserves the local polytope Λ.
                           

The proof of Lemma 3.1 is given in Appendix A.


                              Mapping Pζ for
                              
                                 
                                    ζ
                                    ∈
                                    Z
                                 
                               
                              preserves the local polytope: Pζ
                              (Λ) ⊂ Λ.
                           

The proof of Lemma 3.2. is given in Appendix A.

In short, Pζ
                         satisfies all the equality constraints satisfied by [p] and has all components non-negative for 
                           
                              ζ
                              ∈
                              Z
                           
                        . As a consequence of Lemma 3.2, the constraint of polytope preservation (45b) in the maximum persistency problem (L1) can be dropped. We can write (max-WI) as

                           
                              (61)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                min
                                                
                                                   
                                                      
                                                         
                                                            
                                                               ζ
                                                               ,
                                                               φ
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                ∑
                                                
                                                   s
                                                   ,
                                                   i
                                                
                                             
                                             
                                                ζ
                                                
                                                   s
                                                   ,
                                                   i
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                       
                                       
                                          
                                             
                                                (
                                                I
                                                −
                                                
                                                   P
                                                   ζ
                                                   T
                                                
                                                )
                                             
                                             f
                                             −
                                             
                                                A
                                                T
                                             
                                             φ
                                             ≥
                                             0
                                             ;
                                             
                                             φ
                                             ∈
                                             
                                                R
                                                m
                                             
                                             ;
                                          
                                       
                                    
                                    
                                       
                                          
                                       
                                       
                                          
                                             ζ
                                             ∈
                                             Z
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Further properties of improving mappings for local relaxations are as follows. Conditions that are necessary for 
                           
                              
                                 [
                                 p
                                 ]
                              
                              ∈
                              
                                 W
                                 f
                              
                              
                           
                         in the general case (Theorem 2.10) become necessary and sufficient for local relaxations and can be now summarized together with the dual representation Theorem 2.8.

                           Theorem 3.3
                           Characterizations


                           
                              For a local relaxation Λ all of the following are equivalent:
                              
                                 
                                    (a)
                                    
                                       
                                          
                                             P
                                             ∈
                                             
                                                W
                                                f
                                             
                                             
                                          
                                       
                                       ;
                                    


                                       
                                          
                                             
                                                (
                                                ∃
                                                φ
                                                ∈
                                                
                                                   R
                                                   m
                                                
                                                )
                                             
                                             
                                             
                                                f
                                                φ
                                             
                                             −
                                             
                                                P
                                                T
                                             
                                             f
                                             ≥
                                             0
                                          
                                       
                                       ;
                                    


                                       
                                          
                                             
                                                (
                                                ∃
                                                φ
                                                ∈
                                                
                                                   R
                                                   m
                                                
                                                )
                                             
                                             
                                             
                                                (
                                                I
                                                −
                                                
                                                   P
                                                   T
                                                
                                                )
                                             
                                             
                                                f
                                                φ
                                             
                                             ≥
                                             0
                                          
                                       
                                       ;
                                    


                                       
                                          
                                             inf
                                             {
                                             
                                                〈
                                                f
                                                −
                                                
                                                   P
                                                   T
                                                
                                                f
                                                ,
                                                μ
                                                〉
                                             
                                             
                                             |
                                             
                                             μ
                                             ∈
                                             
                                                R
                                                +
                                                I
                                             
                                             ,
                                             
                                             
                                             A
                                             
                                                (
                                                I
                                                −
                                                P
                                                )
                                             
                                             μ
                                             =
                                             0
                                             }
                                             =
                                             0
                                          
                                       
                                       .
                                    

We have transitions from a global property 
                           
                              
                                 (
                                 ∀
                                 μ
                                 ∈
                                 Λ
                                 )
                              
                              
                              
                              〈
                              
                                 (
                                 I
                                 −
                                 
                                    P
                                    T
                                 
                                 )
                              
                              f
                              ,
                              μ
                              〉
                              ≥
                              0
                           
                         (a) to component-wise local inequalities (b) and (c). Inequalities (c) offer an equivalent reparametrization f
                        φ in which mapping p improves every component independently:

                           
                              (62)
                              
                                 
                                    
                                       
                                          
                                             
                                                (
                                                ∀
                                                c
                                                ⊂
                                                E
                                                ,
                                                
                                                ∀
                                                
                                                   x
                                                   c
                                                
                                                ∈
                                                
                                                   X
                                                   c
                                                
                                                )
                                             
                                             
                                             
                                                f
                                                c
                                                φ
                                             
                                             
                                                (
                                                
                                                   p
                                                   c
                                                
                                                
                                                   (
                                                   
                                                      x
                                                      c
                                                   
                                                   )
                                                
                                                )
                                             
                                             ≤
                                             
                                                f
                                                c
                                                φ
                                             
                                             
                                                (
                                                
                                                   x
                                                   c
                                                
                                                )
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        This is a fairly simple condition similar in spirit to the idea of equivalent transformations by Shlezinger [59] (find an equivalent f
                        φ such that the global minimum may be recovered from independent component-wise minima). Condition (d) is a primal reformulation which has fewer equality constraints than the verification LP and hence is simpler.

Some properties expressed for all hyperedges 
                           
                              c
                              ∈
                              E
                           
                         can be simplified if we assume at least the BLP relaxation. In Statement 2.6 it is sufficient that only unary components satisfy 
                           
                              
                                 (
                                 ∀
                                 s
                                 ∈
                                 V
                                 )
                              
                              
                              
                              
                                 O
                                 s
                              
                              =
                              
                                 p
                                 s
                              
                              
                                 (
                                 
                                    X
                                    s
                                 
                                 )
                              
                           
                        . For other components the constraint is implied by marginalization. For the same reason, in the perturbation (50) it is sufficient to have only unary components fs
                        (ys
                        ) increased by ε for all s and leave higher-order terms intact.

Lastly, there are following NP-hardness results with BLP relaxation:

                           Theorem 3.4
                           
                              Problem (max-WI
                              ) over the
                              
                                 
                                    P
                                    1
                                 
                               
                              class of maps and the BLP relaxation is solvable in polynomial time for the quadratic pseudo-Boolean case and otherwise (when the problem is multilabel or higher order) it is NP-hard.
                           

The proof of Theorem 3.4 is given in Appendix A.


                              Problem (max-SI) with 4 or more labels over the class of maps
                              
                                 
                                    
                                       P
                                       2
                                    
                                    =
                                    
                                       ⋃
                                       
                                          y
                                          ∈
                                          X
                                       
                                    
                                    
                                       P
                                       
                                          2
                                          ,
                                          y
                                       
                                    
                                 
                               
                              and BLP relaxation is NP-hard.
                           

The proof of Theorem 3.5 is given in Appendix A.

We see that the difference between weak and strong persistency leads to different complexity classes for the maximum persistency problem. The question of complexity of (max-SI) with 3 labels is not resolved.

This section is devoted to theoretical comparison between different persistency techniques. The firs result is the following:

                        Theorem 4.1
                        
                           Let Λ ⊂ Λ′ and P be a Λ′-improving mapping for f. Then P is Λ-improving for f.
                        

The claim follows from Definition 2.2 and nesting of polytopes Λ ⊂ Λ′.□

We therefore have a natural hierarchy: if we can identify some variables as persistent by the proposed sufficient condition with relaxation Λ′ then for any tighter relaxation Λ ⊂ Λ′ we are guaranteed to find at least the same persistent variables. Other nesting results under different reformulations of the problem are obtained in Section 4.6 and A.7.


                     Table 3
                      gives an overview of the obtained comparisons to other methods. The first comparison column establishes that all listed methods correspond to a relaxed-improving mapping under standard relaxations (recall that in the pairwise case FLP = BLP). For cases when Algorithm 1 is optimal, as indicated in Table 1, it is guaranteed to find the same or larger set of persistent labels than any other method. This fills the second comparison column in Table 3. In the remainder of this section we give a more detailed overview of different methods and comparison results.

We will consider Goldstein’s simple DEE [17] (which is stronger than original DEE by Desmet et al. [14]) in the pairwise setting. For every node s this method considers its neighbors in the graph, 
                           
                              N
                              (
                              s
                              )
                              ,
                           
                         and for a pair of labels 
                           
                              α
                              ,
                              β
                              ∈
                              
                                 X
                                 s
                              
                           
                         verifies the condition

                           
                              (63)
                              
                                 
                                    
                                       
                                       
                                          
                                             (
                                             ∀
                                             x
                                             ∈
                                             
                                                X
                                                
                                                   N
                                                   (
                                                   s
                                                   )
                                                
                                             
                                             )
                                          
                                       
                                    
                                    
                                       
                                          
                                       
                                       
                                          
                                             
                                                f
                                                s
                                             
                                             
                                                (
                                                α
                                                )
                                             
                                             −
                                             
                                                f
                                                s
                                             
                                             
                                                (
                                                β
                                                )
                                             
                                             +
                                             
                                                ∑
                                                
                                                   t
                                                   ∈
                                                   N
                                                   (
                                                   s
                                                   )
                                                
                                             
                                             
                                                [
                                                
                                                   f
                                                   
                                                      {
                                                      s
                                                      ,
                                                      t
                                                      }
                                                   
                                                
                                                
                                                   (
                                                   α
                                                   ,
                                                   
                                                      x
                                                      t
                                                   
                                                   )
                                                
                                                −
                                                
                                                   f
                                                   
                                                      {
                                                      s
                                                      ,
                                                      t
                                                      }
                                                   
                                                
                                                
                                                   (
                                                   β
                                                   ,
                                                   
                                                      x
                                                      t
                                                   
                                                   )
                                                
                                                ]
                                             
                                             ≥
                                             0
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        illustrated in Fig. 8. If the condition is satisfied it means that a (weakly) improving switch from α to β exists for an arbitrary labeling x. In this case (s, α) can be eliminated while preserving at least one optimal assignment.

It is trivial to construct an improving mapping for this case. We let 
                           
                              
                                 p
                                 s
                              
                              
                                 (
                                 α
                                 )
                              
                              =
                              β
                              ,
                           
                        
                        
                           
                              
                                 p
                                 s
                              
                              
                                 (
                                 i
                                 )
                              
                              =
                              i
                           
                         for i ≠ α; and 
                           
                              
                                 p
                                 t
                              
                              
                                 (
                                 i
                                 )
                              
                              =
                              i
                           
                         for all t ≠ s. The non-zero terms of the problem 
                           
                              g
                              =
                              (
                              I
                              −
                              
                                 P
                                 T
                              
                              )
                              f
                           
                         form a tree with root node s and other nodes 
                           
                              t
                              ∈
                              N
                              (
                              s
                              )
                           
                         being leaves. It is known that in this case the FLP relaxation is tight and therefore p is FLP-improving. Similarly, the strict inequality in (63) implies 
                           
                              
                                 [
                                 p
                                 ]
                              
                              ∈
                              
                                 S
                                 f
                              
                              
                           
                        .

Let 
                           
                              
                                 X
                                 s
                              
                              =
                              B
                           
                        . The weak persistency theorem [20,44] can be formulated as follows. Let 
                           
                              μ
                              ∈
                              
                                 argmin
                                 
                                    μ
                                    ∈
                                    Λ
                                 
                              
                              
                                 〈
                                 f
                                 ,
                                 μ
                                 〉
                              
                           
                        . Let 
                           
                              
                                 O
                                 s
                              
                              =
                              
                                 {
                                 i
                                 ∈
                                 B
                                 
                                 |
                                 
                                 
                                    μ
                                    s
                                 
                                 
                                    (
                                    i
                                    )
                                 
                                 >
                                 0
                                 }
                              
                           
                        . Then

                           
                              (64)
                              
                                 
                                    
                                       (
                                       ∃
                                       x
                                       ∈
                                       
                                          argmin
                                          x
                                       
                                       
                                          E
                                          f
                                       
                                       
                                          (
                                          x
                                          )
                                       
                                       )
                                    
                                    
                                    
                                       (
                                       ∀
                                       s
                                       ∈
                                       V
                                       )
                                    
                                    
                                    
                                       x
                                       s
                                    
                                    ∈
                                    
                                       O
                                       s
                                    
                                    .
                                 
                              
                           
                        In the case 
                           
                              
                                 |
                              
                              
                                 O
                                 s
                              
                              
                                 |
                                 =
                                 1
                              
                           
                         vector μs
                         is necessarily integer and the theorem states that there is an optimal solution x to the discrete problem which is consistent with the integer part of the relaxed solution μ. The largest weakly persistent assignment is obtained in the case μ is the solution with the maximum number of integer components.

The strong persistency theorem [20,44] can be formulated as follows.

                           Theorem 4.2
                           
                              [20,44]
                           


                           
                              Let (μ, φ) be a strictly complementary primal-dual pair. Let
                              
                                 
                                    O
                                    s
                                 
                               
                              be defied as above. Then
                              
                                 
                                    (65)
                                    
                                       
                                          
                                             (
                                             ∀
                                             x
                                             ∈
                                             
                                                argmin
                                                x
                                             
                                             
                                                E
                                                f
                                             
                                             
                                                (
                                                x
                                                )
                                             
                                             )
                                          
                                          
                                          
                                             (
                                             ∀
                                             s
                                             ∈
                                             V
                                             )
                                          
                                          
                                          
                                             x
                                             s
                                          
                                          ∈
                                          
                                             O
                                             s
                                          
                                          .
                                       
                                    
                                 
                              
                           

The difference to (64) is in the quantifier ∀ v.s. ∃. Note, a strictly complementary solution has the minimum number of integer components.

                           Theorem 4.3
                           
                              [55]
                           


                           
                              Weak (respectively, strong) persistency by QPBO corresponds to an FLP-improving (respectively, strict FLP-improving) mapping.
                           

The mapping is defined by 
                           
                              
                                 p
                                 s
                              
                              
                                 (
                                 i
                                 )
                              
                              =
                              0
                           
                         if 
                           
                              
                                 O
                                 s
                              
                              =
                              
                                 {
                                 0
                                 }
                              
                              ,
                           
                        
                        
                           
                              
                                 p
                                 s
                              
                              
                                 (
                                 i
                                 )
                              
                              =
                              1
                           
                         if 
                           
                              
                                 O
                                 s
                              
                              =
                              
                                 {
                                 1
                                 }
                              
                           
                         and 
                           
                              
                                 p
                                 s
                              
                              
                                 (
                                 i
                                 )
                              
                              =
                              i
                           
                         otherwise. The idea of the proof is to show that the dual optimal solution φ provides the reparametrization in which the mapping improves every component independently, i.e., satisfies the inequalities of the characterization Theorem 3.3(c).

It follows from the theorem that solution by Algorithm 1 with perturbation coincides with the strong QPBO persistency.

The MQPBO method [25] extends partial optimality properties of QPBO to multilabel problems via the reduction of the problem to 0–1 variables. The reduction, known as “K to 2” transform [51] (
                           
                              
                                 K
                                 =
                                 |
                              
                              
                                 X
                                 s
                              
                              
                                 |
                              
                           
                        ), depends on the linear ordering of labels in 
                           
                              X
                              s
                           
                        . The method outputs two labelings x
                        min and x
                        max with the guarantee that there exists an optimal labeling x that satisfies 
                           
                              
                                 x
                                 s
                              
                              ∈
                              
                                 [
                                 
                                    x
                                    s
                                    min
                                 
                                 ,
                                 
                                 
                                    x
                                    s
                                    max
                                 
                                 ]
                              
                           
                        . The corresponding improving mapping has the form p: x ↦ (x∨x
                        min)∧x
                        max, where ∨ and ∧ are component-wise minimum and maximum, respectively in a given ordering of labels. The mapping is illustrated in Fig. 9. Because the reduction is component-wise and component-wise inequalities hold for QPBO it follows that the component-wise conditions of Theorem 3.3(c) hold for p (proof in [55]). For (x
                        min, x
                        max) obtained from weak (respectively, strong) persistency by QPBO there holds 
                           
                              
                                 [
                                 p
                                 ]
                              
                              ∈
                              
                                 W
                                 f
                              
                              
                           
                         (respectively, 
                           
                              
                                 [
                                 p
                                 ]
                              
                              ∈
                              
                                 S
                                 f
                              
                              
                           
                        ). Since the class of mappings of the form x ↦ (x∨x
                        min)∧x
                        max is not among the cases for which Algorithm 1 is optimal, the question of tractability of (max-SI) for this class remains open.

There were several methods proposed [39,40] which differ in detail. All methods construct an auxiliary submodular energy Eg
                        . A minimizer y of Eg
                         has the property that Eg
                        (x∨y) ≤ Eg
                        (x), implied by submodularity. It follows that mapping p: x ↦ x∨y is improving for g. Fig. 10 illustrates such mappings found by two of the methods in [40]. In case (a) the test labeling y must be the highest (the maximum) in the selected order of label. It follows that the mapping p is essentially of the form 
                           
                              x
                              ↦
                              x
                              [
                              A
                              ←
                              y
                              ]
                              ,
                           
                         
                        i.e., from the class 
                           
                              P
                              
                                 1
                                 ,
                                 y
                              
                           
                        . The construction of the auxiliary function ensures that improvement in f is at least as big as improvement in g and so p is improving for f.

                           Theorem 4.4
                           
                              [55]
                           


                           
                              Persistency by any method
                              
                                 [39
                              
                              , 
                              
                                 40]
                               
                              corresponds to an FLP-improving mapping.
                           

Since in the case (a) the mapping is in the class 
                           
                              
                                 P
                                 1
                              
                              ,
                           
                         we know that the strict version of the method is dominated by Algorithm 1. In the case (b), the class of maps is a subset of maps considered in MQPBO and tractability of (max-SI) problem is also open.

Computationally, methods of Kovtun [40] have an advantage as they rely on the minimization of a pairwise submodular function. In the case of the Potts model, the method [39] for all “flat” test labelings 
                           
                              
                                 y
                                 s
                              
                              =
                              α
                           
                         for 
                           
                              α
                              =
                              1
                              ⋯
                              K
                              ,
                           
                         (
                           
                              
                                 K
                                 =
                                 |
                              
                              
                                 X
                                 s
                              
                              
                                 |
                              
                           
                        ), can be efficiently performed using log (K) maximum flow computations [19]. It is very practical in some vision problems (e.g. results [3,19,39]), where unary costs are determining. At the same time experiments on difficult random problems in Section 5 reveal very poor performance of this method.

The iterative Pruning method was first proposed [63] for the Potts model and then extended to general pairwise and higher order energies [64]. The method can be interpreted as finding an improving mapping in the class 
                           
                              P
                              1
                           
                         (Fig. 11).

                           Theorem 4.5
                           
                              Persistency by method 
                              
                                 [64]
                               
                              in the pairwise multilabel case corresponds to an FLP-improving mapping.
                           


                              Theorem 4.5 is given in Appendix A.

In fact the optimal value of y is determined in [64] by the initial relaxation, similarly to how it is determined in Algorithm 1. Therefore, Algorithm 1 without perturbation identifies the same or better weak persistency. Algorithm 1 with perturbation identifies the same or larger set 
                           
                              A
                              strong
                           
                         as theoretically guaranteed in [64].

We now turn to the higher order pseudo-Boolean case. There is a number of different reductions proposed [5,15,22] which represent the initial function of 0–1 variables as a minimum of a quadratic function over auxiliary 0–1 variables. Persistency is obtained then by applying the QPBO method to the reduced problem. Since QPBO solves the FLP relaxation, our goal is to compare local relaxations as well as relaxed-improving maps before and after the reduction. Fortunately, full reductions [15,22] are defined by chaining certain elementary reductions applied to separate cliques or groups of cliques. We define a sufficient set of atomic reductions with the following property: the maximum persistent subset by an FLP-improving mapping for the reduced problem is not larger than that one for the initial problem. Chaining these atomic reductions we obtain the following comparisons.

                           Theorem 4.6
                           
                              Persistency by higher order clique reduction (HOCR) of Ishikawa 
                              
                                 [22]
                               
                              corresponds to an FLP-improving mapping.
                           

The proof of Theorem 4.6 is given in Appendix A.


                              Persistency by method of Fix et al. 
                              
                                 [15]
                               
                              corresponds to an FLP-improving mapping.
                           

The proof of Theorem 4.7 is given in Appendix A.

Ishikawa [22] proposed a family of elementary reductions (called γ-flipping) and posed the problem of what sequence of reductions gives in a certain sense the best overall reduction. This is a difficult combinatorial problem. While we do not address it directly, it follows that FLP maximum persistency by Algorithm 1 dominates persistencies that can be obtained by any reduction from the family and hence also the best one.

Submodular/bisubmodular relaxations were introduced by Kolmogorov [27] as a natural generalization of the roof duality approach to higher order pseudo-Boolean functions. Kolmogorov showed that all totally half-integral relaxations are bisubmodular relaxations and vice versa. Similar to roof duality, (bi)submodular relaxations have a global persistency property. However, to a given function many different (bi)submodular relaxations can be constructed. There are two challenges in this approach. One is that the class of all (bi)submodular relaxations is very large and it is not tractable to parametrize it. The other challenge is to answer the question of which relaxation provides the largest persistent assignment.

Kahl and Strandmark [23] build upon graph-cut reducible submodular relaxations. They propose that the relaxation which corresponds to the best lower bound on the energy is the optimal one. Their algorithm solves a series of linear programs to build the tightest graph-cut reducible submodular relaxation. However, not all submodular relaxations are graph-cut reducible (it is a hard problem to determine which ones actually are [69] with the exception of cubic functions). Moreover, it is not clear whether the relaxation that gives the best lower bound is also the best one w.r.t. the size of the persistent assignment.

We consider a more general case when the relaxation is a sum of bisubmodular functions (SoB) over the same hypergraph as f. This class includes all graph-cut reducible submodular relaxations. Exploiting the property that SoB function can be minimized exactly by BLP relaxation [66] and properties [27], we obtain the following theorem.

                           Theorem 4.8
                           
                              Persistency by SoB relaxation 
                              
                                 [27]
                               
                              corresponds to a BLP-improving mapping.
                           

The proof of Theorem 4.8 is given in Appendix A.

The work of Lu and Williams [43] is a special case of SoB relaxation, it follows that their result corresponds to a BLP-improving mapping as well.

As discussed above, the method of Kahl and Strandmark [23] finds persistencies by SoB relaxation and all such relaxations are dominated by BLP-improving maps. There is however a catch. The method reduces the problem progressively by finding in each iteration a BLP-improving map. While Lemma 2.7 guarantees that fixing variables to their persistent values does not tighten the BLP-relaxation, eliminating persistent variables actually does (as explained in Fig. 7). It follows that their method is not in general dominated by a single BLP-improving map. On the other hand, we can easily claim domination by a single FLP-improving map (as it is stronger than BLP and is not tightened by the elimination of persistent variables), which is also confirmed experimentally.

While avoiding the difficult question [23,27] of how to find the best SoS or SoB relaxation, we give an answer to how to find same or larger strong persistent assignment. In the case of 3rd order energies (quartic terms), Kolmogorov [27] gives an example where there is a tight bisubmodular relaxation but no tight submodular relaxation. It follows that in this case Algorithm 1 can determine strictly larger strong persistent assignment than [23]. We give experimental confirmation of larger persistent set for both cubic and quartic problems. The proposed two-phase algorithm is seen more computationally attractive than the series of LPs of Kahl and Strandmark [23].

Windheuser et al. [75] extended generalized roof duality [23,27] to multilabel case. For pairwise models they showed equivalence with MQPBO. For higher order models the approach can be seen as a combination of K to 2 transform [51] and application of submodular relaxation [23,27]. As we have given comparison with (bi)submodular relaxations and K to 2 transform is component-wise, it should follow that the sufficient condition of [75] corresponds to an FLP-improving mapping.

Adams et al. [2] proved a persistency result for the 0–1 polynomial programming problem. The result is based on the relaxation of Sherali and Adams [58], which can be identified with the FLP relaxation. They proposed a sufficient condition on the dual multipliers in the relaxation which provides a persistency guarantee. The sufficient condition is a linear feasibility program that can be verified for a given partial assignment, similar in spirit to our verification LP. No method to find a persistent partial assignment except for the case when the integer part of the optimal relaxed solution turns out to be persistent is proposed. We show the following.

                           Theorem 4.9
                           
                              Persistency by the sufficient condition of Adams et al. [
                              
                                 2
                              , Lemma 3.2] corresponds to an FLP-improving mapping.
                           

The proof of Theorem 4.9 is given in Appendix A.

In fact their sufficient conditions split the problem into two overlapping parts: one part, where an optimal assignment is unknown (call it the inner problem) and the second part, containing all the assigned variables and the coupled unassigned variables (call it outer problem). It can be seen that the sufficient condition guarantees that any choice of unassigned variables together with the assigned ones delivers an optimal solution to the outer problem. Thus what happens in the inner problem can be efficiently ignored. Any feasible solution of the inner problem is optimal to the outer one.

@&#EXPERIMENTS@&#

We propose two families of experiments: for pairwise multilabel energies and higher-order pseudo-Boolean energies. We first discuss linear program (L1) for FLP relaxation in these two cases.

Explicit form of (L1) for the pairwise multilabel case is given in [55]. It is expressed with variables ξ which are related to ζ by 
                           
                              
                                 ξ
                                 
                                    s
                                    ,
                                    i
                                 
                              
                              =
                              1
                              −
                              
                                 ζ
                                 
                                    s
                                    ,
                                    i
                                 
                              
                           
                        ; 
                           
                              
                                 ξ
                                 
                                    s
                                    t
                                    ,
                                    i
                                    j
                                 
                              
                              =
                              1
                              −
                              
                                 ζ
                                 
                                    s
                                    ,
                                    i
                                 
                              
                              −
                              
                                 ζ
                                 
                                    t
                                    ,
                                    j
                                 
                              
                              +
                              
                                 ζ
                                 
                                    s
                                    t
                                    ,
                                    i
                                    j
                                 
                              
                              ,
                           
                         so that ξ
                        
                           st, ij
                         is the linearization of 
                           
                              
                                 ξ
                                 
                                    s
                                    ,
                                    i
                                 
                              
                              
                                 ξ
                                 
                                    t
                                    ,
                                    j
                                 
                              
                              =
                              
                                 (
                                 1
                                 −
                                 
                                    ζ
                                    
                                       s
                                       ,
                                       i
                                    
                                 
                                 )
                              
                              
                                 (
                                 1
                                 −
                                 
                                    ζ
                                    
                                       t
                                       ,
                                       j
                                    
                                 
                                 )
                              
                           
                        . This parametrization is more convenient in the pairwise case. Its drawback is a more complex representation of 
                           
                              P
                              ζ
                              2
                           
                         (which is however not needed except for the proof).

Let us consider now the pseudo-Boolean case. Without loss of generality we assume that 
                           
                              y
                              =
                              0
                           
                         (otherwise variable values can be flipped). Let f be given in the form of a multilinear polynomial: 
                           
                              
                                 f
                                 c
                              
                              
                                 (
                                 
                                    x
                                    c
                                 
                                 )
                              
                              =
                              
                                 η
                                 c
                              
                              
                                 ∏
                                 
                                    s
                                    ∈
                                    c
                                 
                              
                              
                                 x
                                 s
                              
                           
                        . We let 
                           
                              ζ
                              c
                           
                         denote 
                           
                              ζ
                              
                                 c
                                 ,
                                 
                                    1
                                    c
                                 
                              
                           
                        . The expression Pζf simplifies as

                           
                              (66)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   (
                                                   
                                                      P
                                                      ζ
                                                   
                                                   f
                                                   )
                                                
                                                c
                                             
                                             
                                                (
                                                
                                                   x
                                                   c
                                                   ′
                                                
                                                )
                                             
                                          
                                       
                                       
                                          
                                             =
                                             
                                                ∑
                                                
                                                   
                                                      x
                                                      c
                                                   
                                                   ∈
                                                   
                                                      X
                                                      c
                                                   
                                                
                                             
                                             
                                                ∑
                                                
                                                   d
                                                   ⊂
                                                   c
                                                
                                             
                                             
                                                c
                                                
                                                   c
                                                   ,
                                                   d
                                                
                                             
                                             
                                                (
                                                
                                                   x
                                                   c
                                                
                                                ,
                                                
                                                   x
                                                   c
                                                   ′
                                                
                                                )
                                             
                                             
                                                ζ
                                                
                                                   d
                                                   ,
                                                   
                                                      x
                                                      d
                                                      ′
                                                   
                                                
                                             
                                             
                                                f
                                                c
                                             
                                             
                                                (
                                                
                                                   x
                                                   c
                                                
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                       
                                       
                                          
                                             =
                                             
                                                ∑
                                                
                                                   d
                                                   ⊂
                                                   c
                                                
                                             
                                             
                                                ∏
                                                
                                                   s
                                                   ∈
                                                   d
                                                
                                             
                                             
                                                (
                                                〚
                                                
                                                   x
                                                   s
                                                   ′
                                                
                                                =
                                                1
                                                〛
                                                −
                                                〚
                                                
                                                   y
                                                   s
                                                
                                                =
                                                1
                                                〛
                                                )
                                             
                                             
                                                ∏
                                                
                                                   s
                                                   ∈
                                                   c
                                                   ∖
                                                   d
                                                
                                             
                                             〚
                                             
                                                y
                                                s
                                             
                                             =
                                             1
                                             〛
                                             
                                                ζ
                                                
                                                   d
                                                   ,
                                                   
                                                      x
                                                      d
                                                      ′
                                                   
                                                
                                             
                                             
                                                f
                                                c
                                             
                                             
                                                (
                                                
                                                   1
                                                   c
                                                
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                       
                                       
                                          
                                             =
                                             〚
                                             
                                                x
                                                c
                                                ′
                                             
                                             =
                                             
                                                1
                                                c
                                             
                                             〛
                                             
                                                ζ
                                                c
                                             
                                             
                                                η
                                                c
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Components of 
                           
                              (
                              I
                              −
                              
                                 P
                                 ζ
                                 T
                              
                              )
                              f
                           
                         simplify as

                           
                              
                                 
                                    
                                       
                                          
                                       
                                       
                                          
                                             
                                                f
                                                c
                                             
                                             
                                                (
                                                
                                                   x
                                                   c
                                                   ′
                                                
                                                )
                                             
                                             −
                                             〚
                                             
                                                x
                                                c
                                                ′
                                             
                                             =
                                             
                                                1
                                                c
                                             
                                             〛
                                             
                                                ζ
                                                c
                                             
                                             
                                                η
                                                c
                                             
                                             =
                                             〚
                                             
                                                x
                                                c
                                                ′
                                             
                                             =
                                             
                                                1
                                                c
                                             
                                             〛
                                             
                                                (
                                                1
                                                −
                                                
                                                   ζ
                                                   c
                                                
                                                )
                                             
                                             
                                                η
                                                c
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        The set 
                           
                              
                                 
                                    X
                                    ˜
                                 
                                 s
                              
                              =
                              
                                 X
                                 s
                              
                              
                                 ∖
                              
                              
                                 {
                                 
                                    y
                                    s
                                 
                                 }
                              
                           
                         equals simply {1} and thus polytope 
                           Z
                         simplifies as

                           
                              (67)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                ζ
                                                ∅
                                             
                                             =
                                             1
                                             ,
                                          
                                       
                                    
                                    
                                       
                                          
                                       
                                       
                                          
                                             
                                                (
                                                ∀
                                                c
                                                ∈
                                                E
                                                ,
                                                
                                                ∀
                                                d
                                                ⊂
                                                c
                                                )
                                             
                                             
                                             
                                             
                                                ∑
                                                
                                                   d
                                                   ⊂
                                                   c
                                                   ∖
                                                   b
                                                
                                             
                                             
                                                
                                                   (
                                                   −
                                                   1
                                                   )
                                                
                                                
                                                   |
                                                   d
                                                   |
                                                
                                             
                                             
                                                ζ
                                                d
                                             
                                             ≥
                                             0
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        Problem (L1) can be written as

                           
                              (68)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                min
                                                
                                                   ζ
                                                   ,
                                                   φ
                                                
                                             
                                             
                                                ∑
                                                
                                                   s
                                                   ∈
                                                   V
                                                
                                             
                                             
                                                ζ
                                                s
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      (
                                                      ∀
                                                      c
                                                      ∈
                                                      E
                                                      )
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         ζ
                                                         c
                                                      
                                                      
                                                         η
                                                         c
                                                      
                                                      −
                                                      
                                                         
                                                            (
                                                            
                                                               A
                                                               T
                                                            
                                                            φ
                                                            )
                                                         
                                                         c
                                                      
                                                      
                                                         (
                                                         
                                                            1
                                                            c
                                                         
                                                         )
                                                      
                                                      ≥
                                                      0
                                                      ;
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         (
                                                         ∀
                                                         c
                                                         ∈
                                                         E
                                                         )
                                                      
                                                      
                                                         (
                                                         ∀
                                                         
                                                            x
                                                            c
                                                            ′
                                                         
                                                         ≠
                                                         
                                                            1
                                                            c
                                                         
                                                         )
                                                      
                                                      
                                                   
                                                
                                                
                                                   
                                                      −
                                                      
                                                         
                                                            (
                                                            
                                                               A
                                                               T
                                                            
                                                            φ
                                                            )
                                                         
                                                         c
                                                      
                                                      
                                                         (
                                                         
                                                            x
                                                            c
                                                            ′
                                                         
                                                         )
                                                      
                                                      ≥
                                                      0
                                                      ;
                                                   
                                                
                                             
                                             
                                                
                                                
                                                   
                                                      −
                                                      
                                                         
                                                            (
                                                            
                                                               A
                                                               T
                                                            
                                                            φ
                                                            )
                                                         
                                                         ∅
                                                      
                                                      ≥
                                                      0
                                                      ;
                                                   
                                                
                                             
                                             
                                                
                                                
                                                   
                                                      ζ
                                                      ∈
                                                      Z
                                                      .
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        Implementation in matlab is available at http://www.icg.tugraz.at/Members/shekhovtsov/persistency
 for research purposes.

@&#EVALUATION@&#

We evaluated all methods on small random problems. The purpose of the experiments is to validate the theory and to verify whether the improvement obtained by the new method is not negligible. For all methods, including ours, for each instance we numerically verified that:

                           
                              •
                              map p constructed by the method is relaxed improving w.r.t. FLP relaxation (by solving the verification LP (24));

the persistency guarantee is correct (by solving exactly the initial and the reduced problems).

We measure solution completeness as 
                           
                              
                                 
                                    n
                                    elim
                                 
                                 
                                    |
                                    V
                                    |
                                    (
                                    K
                                    −
                                    1
                                    )
                                 
                              
                              100
                              %
                              ,
                           
                         where K is the number of labels in every node (
                           
                              
                                 |
                              
                              
                                 X
                                 s
                              
                              
                                 |
                                 =
                                 K
                              
                           
                        ) and n
                        elim is the total number of labels 
                           
                              (
                              s
                              ∈
                              V
                              ,
                              i
                              ∈
                              
                                 X
                                 s
                              
                              )
                           
                         eliminated by the method as non-optimal.

We report results on random problems with Potts interactions and full interactions. Both types have unary weights fs
                           (i) ∼ U[0, 100] (uniformly distributed). Full random energies have pairwise terms fst
                           (i, j) ∼ U[0, 100] and Potts energies have 
                              
                                 
                                    f
                                    
                                       s
                                       t
                                    
                                 
                                 
                                    (
                                    i
                                    ,
                                    j
                                    )
                                 
                                 =
                                 −
                                 
                                    γ
                                    
                                       s
                                       t
                                    
                                 
                                 
                                    (
                                    i
                                    )
                                 
                                 〚
                                 i
                                 =
                                 j
                                 〛
                                 ,
                              
                            where γst
                           (i) ∼ U[0, 50]. All costs are integer to allow for exact verification of correctness. Only instances with non-zero integrality gap w.r.t. FLP relaxation are considered (non-FLP-tight). The results are shown in Fig. 12, while Table 4 gives details of the methods.

The proposed evaluation of higher order 0–1 models is based on the submodular library [24,61]. The library interfaces quadratization techniques HOCR [22] and Fix et al. [15] and implements three variants of generalized roof duality [24], GRD*
                           . Fig. 13
                            shows evaluation on random polynomials of degrees 3 and 4, sampled by the library. In the first series, we reproduce results [24] with similar parameters but smaller problems (e.g., 
                              
                                 n
                                 =
                                 100
                              
                            variables and 
                              
                                 T
                                 =
                                 30
                              
                            multilinear terms vs. 
                              
                                 n
                                 =
                                 1000
                              
                            and 
                              
                                 T
                                 =
                                 300
                              
                            in [24]). The results for baseline methods are consistent with [24]. It turned out however that most of the instances are FLP-tight. Our method, as well as [64], reduces in this case to solving the FLP relaxation and gives the trivial 100% persistency result. In the second series we increased the complexity by adding more terms as well as selecting only non-FLP-tight instances. The proposed approach determines a significantly larger persistent assignment.

In Fig. 14
                           , we generated grid problems of degree 3 with hyperedges 
                              
                                 {
                                 (
                                 i
                                 ,
                                 j
                                 )
                                 ,
                                 (
                                 i
                                 +
                                 1
                                 ,
                                 j
                                 )
                                 ,
                                 (
                                 i
                                 ,
                                 j
                                 +
                                 1
                                 )
                                 }
                              
                            and of degree 4 with hyperedges 
                              
                                 {
                                 (
                                 i
                                 ,
                                 j
                                 )
                                 ,
                                 (
                                 i
                                 +
                                 1
                                 ,
                                 j
                                 )
                                 ,
                                 (
                                 i
                                 ,
                                 j
                                 +
                                 1
                                 )
                                 ,
                                 (
                                 i
                                 +
                                 1
                                 ,
                                 j
                                 +
                                 1
                                 )
                                 }
                              
                            at every grid location 
                              
                                 
                                    (
                                    i
                                    ,
                                    j
                                    )
                                 
                                 ∈
                                 
                                    
                                       {
                                       1
                                       ,
                                       ⋯
                                       N
                                       −
                                       1
                                       }
                                    
                                    2
                                 
                              
                           . For each such hyperedge 
                              c
                            we sampled the term 
                              
                                 f
                                 c
                              
                            as a random posiform (
                              
                                 2
                                 
                                    |
                                    c
                                    |
                                 
                              
                            uniformly distributed numbers, one per configuration, as opposed to sampling coefficients of multilinear polynomials in Fig. 13). This results in somewhat more difficult problems to solve as there is no bias from an unsymmetrical treatment. We further selected only non-FLP-tight instances. It turns out that for the class of the problems of degree 4 none of the baseline methods identified more than 1–2% of the optimal solution, in contrast to the proposed method.


                           Fig. 14 (b) gives a rough idea of running times when using CPLEX to solve linear programs. The running time for L1-FLP and Swoboda et al. includes only the time to solve linear programs and excludes all data preparation in matlab. The method of Swoboda et al. is the slowest one because it needs to solve several LP relaxations in the inner loop (but see [64,65] for applicability with suboptimal solvers and incremental computation). The proposed two-phase methods (L1-FLP) solves two linear programs. Somewhat unexpectedly, the initialization phase (FLP) takes more than a half of the total time. The optimal version of GRD performs similarly to the proposed method but determines less variables. GRD-heur is much faster while the result is comparable to GRD. It can be concluded that for practical applicability of the proposed method a feasible but possibly only approximately maximal solution should be found.

@&#CONCLUSIONS@&#

Techniques for partial optimality avoid the NP-hardness of the energy minimization problem by exploiting different sufficient conditions by which a part of optimal solution can be found. We proposed a new sufficient condition corresponding to a given polyhedral relaxation and verifiable in polynomial time. The condition generalizes the mechanism of improving mapping which is present in many works (although often in a hidden form) and allows to explain them from this perspective. We can explain variety of methods originating in different fields and relate these methods to linear relaxations. In particular, it follows that all covered methods cannot be used to tighten FLP relaxation. Applying them as a preprocessing in solving the FLP relaxation may only speed it up but cannot change the set of optimal relaxed solutions. We formally posed and studied the problem of determining the largest set of persistent variables subject to the general sufficient condition. It appeared that there are reasonably large classes of this problem (restricted by the set of allowed mappings) which can be solved in polynomial time. While the proposed solution might not be the most efficient, its generality allows to subsume multiple problem reformulations, reductions, equivalent transformations and choices that other existing techniques depend on. In bisubmodular relaxations, this is the choice of a bisubmodular lower bound function, in method [40] the choice of the order of labels and the test labeling, in methods [15,22] choice of the sequence of the reductions and flips. While optimizing these methods w.r.t. to all such choices does not seem tractable, it is tractable to find a persistent assignment (by the proposed method) which is at least as good as if these choices were optimized over.

In the experimental evaluation we verified that our theoretical comparisons hold true, i.e. that all evaluated methods (except DEE2 for which we do not claim anything) have output FLP-improving maps in all test cases. Our linear program (L1) had always integer optimal solution
                        3
                     
                     
                        3
                        With exception of few cases when CPLEX experienced a numerical error.
                      
                     ζ. The persistent assignment found by our method with FLP-relaxation was larger per instance and significantly larger on average.

@&#DISCUSSION@&#

Do we get more persistencies if the algorithm is run iteratively?

If we consider FLP relaxation in the cases when maximality is guaranteed, a subsequent application of the method cannot give an improvement (it would contradict maximality). Maximality is achieved in pseudo-Boolean or multi-label class 
                              
                                 P
                                 1
                              
                            under strong persistency. It is also achieved if we keep the test labeling y fixed and consider the class 
                              
                                 P
                                 
                                    2
                                    ,
                                    y
                                 
                              
                            (for both weak and strong persistencies). In the other cases it would be possible to improve by iterating the method. Because for BLP relaxation excluding persistent variables may lead to a tighter relaxation (see Fig. 7), the method can be iterated similarly to generalized roof duality, but the result is still dominated by L1-FLP. In the multi-label case we can iterate while varying the test labeling y, however this is computationally expensive and does not seem practical.

The present work focused on theoretical aspects. Practical applicability of the method requires some further research and development of efficient specialized methods that use approximate solutions of the relaxation as [64] or a windowing technique [56] or alike. Method of Swoboda et al. [64] performs not the best in Fig. 14 and is also the slowest when implemented with CPLEX. However, it can be made optimal for class 
                              
                                 P
                                 1
                              
                            as proposed in [65] and fast in practice using scalable dual solvers. Our most recent work in this direction [57] proposes an algorithm of this type for the pairwise multilabel case and 
                              
                                 P
                                 
                                    2
                                    ,
                                    y
                                 
                              
                            class of maps. It can be viewed as an alternative (combinatorial w.r.t. the mapping) algorithm for the problem (L1) and achieves the necessary efficiency.

It was shown that strict persistency leads to a tractable problem for a larger set of maps. It guarantees not to remove ambiguous solutions. By increasing ε in the perturbation method one gets a potentially stronger guarantee w.r.t. the uncertainty of the data, which may be explored. The general approach holds for an arbitrary bounded polytope, allowing one to incorporate also global linear constraints. This suggests a generalization to linearly constrained discrete optimization problems or mixed integer linear programs. Another interesting direction is how to combine the proposed persistency method with cutting plane techniques. Finally, among the questions that remained open is polynomiality of (max-SI) problem for the following cases: (i) For all node-wise maps in a problem with 3 labels. (ii) For maps of the form 
                              
                                 x
                                 ↦
                                 
                                    (
                                    x
                                    ∨
                                    
                                       x
                                       min
                                    
                                    )
                                 
                                 ∧
                                 
                                    x
                                    max
                                 
                              
                            with x
                           min and x
                           max being free variables, which is relevant when labels have a natural linear ordering. The optimal solution to this case would improve over the iterative method of Kovtun [40], MQPBO and the method [75].

@&#ACKNOWLEDGMENTS@&#

I would like to thank the anonymous reviewers and my colleagues Thomas Pock and Paul Swoboda for their comments which helped to improve clarity and correctness.


                     
                        Lemma 1.1
                        
                           The conical hull of a relaxation polytope Λ (in the form (
                           
                              8
                           
                           ), non-empty and bounded) is obtained by dropping the constraint
                           
                              
                                 
                                    μ
                                    ∅
                                 
                                 =
                                 1
                              
                           
                           :
                           
                              
                                 (10)
                                 
                                    
                                       coni
                                       
                                          (
                                          Λ
                                          )
                                       
                                       =
                                       
                                          {
                                          μ
                                          ∈
                                          
                                             R
                                             I
                                          
                                          
                                          |
                                          
                                          A
                                          μ
                                          ≥
                                          0
                                          ;
                                          μ
                                          ≥
                                          0
                                          }
                                       
                                       .
                                    
                                 
                              
                           
                        

We will show that the defining set (9) is contained in (10) and vice versa. Let μ ∈ Λ, let α ≥ 0. Then 
                              
                                 A
                                 α
                                 μ
                                 =
                                 α
                                 A
                                 μ
                                 ≥
                                 0
                              
                            and αμ ≥ 0. Therefore αμ is contained in the set (10). Now let μ belong to the set (10). If μ
                           ∅ > 0, we can select 
                              
                                 α
                                 =
                                 
                                    μ
                                    ∅
                                 
                              
                            and vector 
                              
                                 
                                    μ
                                    ′
                                 
                                 =
                                 μ
                                 /
                                 
                                    μ
                                    ∅
                                 
                                 ∈
                                 Λ
                              
                            and conclude that 
                              
                                 μ
                                 =
                                 α
                                 
                                    μ
                                    ′
                                 
                              
                            belongs to (9). Let 
                              
                                 
                                    μ
                                    ∅
                                 
                                 =
                                 0
                              
                           . Assume for contradiction that μ ≠ 0. Set Λ is non-empty by assumption, let μ′ ∈ Λ. Then for any α ≥ 0 there holds 
                              
                                 
                                    μ
                                    ′
                                 
                                 +
                                 α
                                 μ
                                 ∈
                                 Λ
                              
                           . But 
                              
                                 
                                    ∥
                                 
                                 
                                    μ
                                    ′
                                 
                                 
                                    +
                                    α
                                    μ
                                    ∥
                                    ≥
                                    α
                                    ∥
                                    μ
                                    ∥
                                    ,
                                 
                              
                            which is unbounded and contradicts boundedness of Λ. Therefore 
                              
                                 μ
                                 =
                                 0
                                 ,
                              
                            which belongs to the set (9).□

Let 
                              
                                 O
                                 =
                                 
                                    argmin
                                    
                                       μ
                                       ∈
                                       Λ
                                    
                                 
                                 
                                    〈
                                    f
                                    ,
                                    
                                       (
                                       I
                                       −
                                       P
                                       )
                                    
                                    μ
                                    〉
                                 
                              
                           . There holds 
                              
                                 P
                                 ∈
                                 
                                    S
                                    f
                                 
                                 
                              
                            iff

                              
                                 (25)
                                 
                                    
                                       
                                          
                                             O
                                          
                                          
                                             
                                                =
                                                P
                                                (
                                                Λ
                                                )
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

By idempotency we have that 
                              
                                 P
                                 (
                                 Λ
                                 )
                                 =
                                 {
                                 μ
                                 ∈
                                 Λ
                                 ,
                                 
                                 P
                                 μ
                                 =
                                 μ
                                 }
                              
                           . Let μ′ ∈ P(Λ). Since 
                              
                                 〈
                                 
                                    (
                                    I
                                    −
                                    
                                       P
                                       T
                                    
                                    )
                                 
                                 f
                                 ,
                                 
                                    μ
                                    ′
                                 
                                 〉
                                 =
                                 0
                              
                            it is clear that the value of verification LP, 
                              
                                 
                                    min
                                    
                                       μ
                                       ∈
                                       Λ
                                    
                                 
                                 
                                    〈
                                    
                                       (
                                       I
                                       −
                                       
                                          P
                                          T
                                       
                                       )
                                    
                                    f
                                    ,
                                    μ
                                    〉
                                 
                              
                            is not positive.

Direction “⇐”. Let (25) hold. For 
                              
                                 μ
                                 ∈
                                 P
                                 (
                                 Λ
                                 )
                                 =
                                 O
                              
                            condition (23) is trivially satisfied and we find that the value of verification LP is zero. For μ ∈ Λ\P(Λ) from (25) follows that μ is not a minimizer, therefore the objective must be strictly larger than zero and the strict inequality in (23) is satisfied.

Direction “⇒”. Let P satisfy (23). Then the value of verification LP is zero. Since any μ ∈ P(Λ) satisfies 
                              
                                 P
                                 μ
                                 =
                                 μ
                              
                            and achieves zero objective we have 
                              
                                 P
                                 (
                                 Λ
                                 )
                                 ⊂
                                 O
                              
                           . Now let μ ∉ P(Λ). In this case Pμ ≠ μ and inequality (23) is strict. Therefore 
                              
                                 μ
                                 ∉
                                 O
                              
                           .□

The condition (25) can be further expressed in the components of mapping p as follows.

                        Statement 2.6
                        Let 
                              
                                 
                                    O
                                    c
                                 
                                 =
                                 
                                    {
                                    
                                       x
                                       c
                                    
                                    ∈
                                    
                                       X
                                       c
                                    
                                    
                                    |
                                    
                                    
                                       (
                                       ∃
                                       μ
                                       ∈
                                       O
                                       )
                                    
                                    
                                    
                                       μ
                                       c
                                    
                                    
                                       (
                                       
                                          x
                                          c
                                       
                                       )
                                    
                                    >
                                    0
                                    }
                                 
                              
                           . There holds 
                              
                                 
                                    [
                                    p
                                    ]
                                 
                                 ∈
                                 
                                    S
                                    f
                                 
                                 
                              
                            iff

                              
                                 (26)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   (
                                                   ∀
                                                   c
                                                   ∈
                                                   E
                                                   )
                                                
                                                
                                                
                                                
                                                   O
                                                   c
                                                
                                                =
                                                
                                                   p
                                                   c
                                                
                                                
                                                   (
                                                   
                                                      X
                                                      c
                                                   
                                                   )
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

Direction “⇒”: We prove the negation of the implication. Assume 
                              
                                 
                                    (
                                    ∃
                                    c
                                    ,
                                    
                                    ∃
                                    
                                       x
                                       c
                                    
                                    ∈
                                    
                                       O
                                       c
                                    
                                    )
                                 
                                 
                                 
                                    p
                                    c
                                 
                                 
                                    (
                                    
                                       x
                                       c
                                    
                                    )
                                 
                                 ≠
                                 
                                    x
                                    c
                                 
                              
                           . Then 
                              
                                 ∃
                                 μ
                                 ∈
                                 O
                              
                            such that 
                              
                                 
                                    μ
                                    c
                                 
                                 
                                    (
                                    
                                       x
                                       c
                                    
                                    )
                                 
                                 >
                                 0
                              
                           . By idempotency, there is no 
                              
                                 x
                                 c
                                 ′
                              
                            such that 
                              
                                 
                                    p
                                    c
                                 
                                 
                                    (
                                    
                                       x
                                       c
                                       ′
                                    
                                    )
                                 
                                 =
                                 
                                    x
                                    c
                                 
                              
                           . By (15)
                           
                              
                                 
                                    
                                       (
                                       
                                          [
                                          p
                                          ]
                                       
                                       μ
                                       )
                                    
                                    c
                                 
                                 
                                    (
                                    
                                       x
                                       c
                                    
                                    )
                                 
                                 =
                                 0
                                 ≠
                                 
                                    μ
                                    c
                                 
                                 
                                    (
                                    
                                       x
                                       c
                                    
                                    )
                                 
                              
                            and therefore [p]μ ≠ μ. From (25) follows that 
                              
                                 
                                    [
                                    p
                                    ]
                                 
                                 ∉
                                 
                                    S
                                    f
                                 
                                 
                              
                           .

Direction “⇐”: Let (26) hold. Let 
                              
                                 μ
                                 ∈
                                 O
                              
                           . Then for all 
                              
                                 c
                                 ,
                              
                           
                           
                              
                                 x
                                 c
                              
                            such that 
                              
                                 
                                    μ
                                    c
                                 
                                 
                                    (
                                    
                                       x
                                       c
                                    
                                    )
                                 
                                 >
                                 0
                              
                            there holds 
                              
                                 
                                    p
                                    c
                                 
                                 
                                    (
                                    
                                       x
                                       c
                                    
                                    )
                                 
                                 =
                                 
                                    x
                                    c
                                 
                              
                           . It follows from (15) that 
                              
                                 
                                    
                                       (
                                       
                                          [
                                          p
                                          ]
                                       
                                       μ
                                       )
                                    
                                    c
                                 
                                 =
                                 
                                    μ
                                    c
                                 
                              
                            and thus 
                              
                                 [
                                 p
                                 ]
                                 μ
                                 =
                                 μ
                              
                           . Therefore 
                              
                                 [
                                 p
                                 ]
                                 (
                                 O
                                 )
                                 =
                                 O
                              
                            and thus 
                              
                                 O
                                 ⊂
                                 P
                                 (
                                 Λ
                                 )
                              
                            and the value of the verification LP is zero. Because 
                              
                                 P
                                 (
                                 Λ
                                 )
                                 =
                                 {
                                 μ
                                 ∈
                                 Λ
                                 
                                 |
                                 
                                 P
                                 μ
                                 =
                                 μ
                                 }
                              
                            the value of the objective on P(Λ) is zero and thus 
                              
                                 P
                                 (
                                 Λ
                                 )
                                 ⊂
                                 O
                              
                           . From (25) follows 
                              
                                 
                                    [
                                    p
                                    ]
                                 
                                 ∈
                                 
                                    S
                                    f
                                 
                                 
                              
                           .□


                        
                           Lemma 2.7
                           Necessary conditions I


                           
                              Let
                              
                                 
                                    p
                                    :
                                    X
                                    →
                                    X
                                 
                               
                              be node-wise and
                              
                                 
                                    P
                                    =
                                    [
                                    p
                                    ]
                                 
                              
                              . Let
                              
                                 
                                    O
                                    =
                                    
                                       argmin
                                       
                                          μ
                                          ∈
                                          Λ
                                       
                                    
                                    
                                       〈
                                       f
                                       ,
                                       μ
                                       〉
                                    
                                 
                               
                              and
                              
                                 
                                    
                                       O
                                       c
                                    
                                    =
                                    
                                       {
                                       
                                          x
                                          c
                                       
                                       ∈
                                       
                                          X
                                          c
                                       
                                       
                                       |
                                       
                                       
                                          (
                                          ∃
                                          μ
                                          ∈
                                          O
                                          )
                                       
                                       
                                       
                                       
                                          μ
                                          c
                                       
                                       
                                          (
                                          
                                             x
                                             c
                                          
                                          )
                                       
                                       >
                                       0
                                       }
                                    
                                 
                              
                              . Then
                              
                                 
                                    (i)
                                    
                                       For
                                       
                                          
                                             p
                                             ∈
                                             
                                                W
                                                f
                                             
                                             
                                          
                                        
                                       there holds
                                       
                                          
                                             (27a)
                                             
                                                
                                                   
                                                      
                                                      
                                                         
                                                            P
                                                            (
                                                            O
                                                            )
                                                            ⊂
                                                            O
                                                            ;
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       

                                       
                                          
                                             (27b)
                                             
                                                
                                                   
                                                      
                                                      
                                                         
                                                            
                                                               (
                                                               ∀
                                                               c
                                                               ∈
                                                               E
                                                               )
                                                            
                                                            
                                                            
                                                            
                                                               p
                                                               c
                                                            
                                                            
                                                               (
                                                               
                                                                  O
                                                                  c
                                                               
                                                               )
                                                            
                                                            ⊂
                                                            
                                                               O
                                                               c
                                                            
                                                            ;
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    


                                       For
                                       
                                          
                                             p
                                             ∈
                                             
                                                S
                                                f
                                             
                                             
                                          
                                        
                                       there holds
                                       
                                          
                                             (28a)
                                             
                                                
                                                   
                                                      
                                                      
                                                         
                                                            P
                                                            (
                                                            O
                                                            )
                                                            =
                                                            O
                                                            ;
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       

                                       
                                          
                                             (28b)
                                             
                                                
                                                   
                                                      
                                                      
                                                         
                                                            
                                                               (
                                                               ∀
                                                               c
                                                               ∈
                                                               E
                                                               )
                                                            
                                                            
                                                            
                                                            
                                                               p
                                                               c
                                                            
                                                            
                                                               (
                                                               
                                                                  O
                                                                  c
                                                               
                                                               )
                                                            
                                                            =
                                                            
                                                               O
                                                               c
                                                            
                                                            ;
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    

(i) Assume 
                                 
                                    (
                                    ∃
                                    μ
                                    ∈
                                    O
                                    )
                                 
                              
                              
                                 
                                    P
                                    μ
                                    ∈
                                    Λ
                                    ∖
                                    O
                                 
                              . Then ⟨f, Pμ⟩ > ⟨f, μ⟩, therefore 
                                 
                                    p
                                    ∉
                                    
                                       W
                                       f
                                    
                                    
                                 
                              . This proves Eq. (27a).

Assume for contradiction that (27b) does not hold, i.e.  
                                 
                                    (
                                    ∃
                                    c
                                    ∈
                                    E
                                    ,
                                    
                                    ∃
                                    
                                       x
                                       c
                                    
                                    ∈
                                    
                                       O
                                       c
                                    
                                    )
                                 
                              
                              
                                 
                                    
                                       x
                                       c
                                       ′
                                    
                                    :
                                    =
                                    
                                       p
                                       c
                                    
                                    
                                       (
                                       
                                          x
                                          c
                                       
                                       )
                                    
                                    ≠
                                    
                                       x
                                       c
                                    
                                 
                              . Because 
                                 
                                    
                                       x
                                       c
                                    
                                    ∈
                                    
                                       O
                                       c
                                    
                                 
                               there exists 
                                 
                                    μ
                                    ∈
                                    O
                                 
                               such that 
                                 
                                    
                                       μ
                                       c
                                    
                                    
                                       (
                                       
                                          x
                                          c
                                       
                                       )
                                    
                                    >
                                    0
                                 
                              . From expression (16) it follows that 
                                 
                                    
                                       
                                          (
                                          
                                             [
                                             p
                                             ]
                                          
                                          μ
                                          )
                                       
                                       c
                                    
                                    
                                       (
                                       
                                          x
                                          c
                                          ′
                                       
                                       )
                                    
                                    >
                                    0
                                 
                               but 
                                 
                                    
                                       x
                                       c
                                       ′
                                    
                                    ∉
                                    
                                       O
                                       c
                                    
                                 
                               and therefore 
                                 
                                    [
                                    p
                                    ]
                                    μ
                                    ∉
                                    O
                                    ,
                                 
                               which contradicts to (27a).

(ii) Assume 
                                 
                                    (
                                    ∃
                                    μ
                                    ∈
                                    O
                                    )
                                 
                               
                              Pμ ≠ μ. Then ⟨f, Pμ⟩ ≥ ⟨f, μ⟩ and therefore 
                                 
                                    p
                                    ∉
                                    
                                       S
                                       f
                                    
                                    
                                 
                              . This proves Eq. (28a).

Assume for contradiction that (28b) does not hold, i.e.  
                                 
                                    (
                                    ∃
                                    c
                                    ∈
                                    V
                                    ,
                                    
                                    ∃
                                    
                                       x
                                       c
                                    
                                    ∈
                                    
                                       O
                                       c
                                    
                                    )
                                 
                              
                              
                                 
                                    
                                       p
                                       c
                                    
                                    
                                       (
                                       
                                          x
                                          c
                                       
                                       )
                                    
                                    ≠
                                    
                                       x
                                       c
                                    
                                 
                              . Because 
                                 
                                    
                                       x
                                       c
                                    
                                    ∈
                                    
                                       O
                                       c
                                    
                                 
                               there exists 
                                 
                                    μ
                                    ∈
                                    O
                                 
                               such that 
                                 
                                    
                                       μ
                                       c
                                    
                                    
                                       (
                                       
                                          x
                                          c
                                       
                                       )
                                    
                                    >
                                    0
                                 
                              . Since 
                                 
                                    
                                       p
                                       c
                                    
                                    
                                       (
                                       
                                          x
                                          c
                                       
                                       )
                                    
                                    ≠
                                    
                                       x
                                       c
                                    
                                    ,
                                 
                               from idempotency and (15) follows that 
                                 
                                    
                                       
                                          (
                                          
                                             [
                                             p
                                             ]
                                          
                                          μ
                                          )
                                       
                                       c
                                    
                                    
                                       (
                                       
                                          x
                                          c
                                       
                                       )
                                    
                                    =
                                    0
                                    ≠
                                    
                                       μ
                                       c
                                    
                                    
                                       (
                                       
                                          x
                                          c
                                       
                                       )
                                    
                                 
                               and thus [p]μ ≠ μ, which contradicts (28a).□


                              Let
                              
                                 
                                    p
                                    :
                                    X
                                    →
                                    X
                                 
                               
                              be node-wise. Then: (i) there exists ε > 0 such that
                              
                                 
                                    
                                       [
                                       p
                                       ]
                                    
                                    ∈
                                    
                                       S
                                       f
                                    
                                    
                                 
                               
                              iff
                              
                                 
                                    (32)
                                    
                                       
                                          
                                             
                                             
                                                
                                                   
                                                   
                                                   
                                                      (
                                                      ∃
                                                      φ
                                                      ∈
                                                      
                                                         R
                                                         +
                                                         m
                                                      
                                                      )
                                                   
                                                   
                                                   
                                                   f
                                                   −
                                                   
                                                      A
                                                      T
                                                   
                                                   φ
                                                   −
                                                   
                                                      
                                                         [
                                                         p
                                                         ]
                                                      
                                                      T
                                                   
                                                   f
                                                   ≥
                                                   
                                                      ɛ
                                                   
                                                   h
                                                   ,
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              where h is a function such that h ≥ 0 and
                              
                                 
                                    
                                       h
                                       c
                                    
                                    
                                       (
                                       
                                          x
                                          c
                                       
                                       )
                                    
                                    =
                                    0
                                 
                               
                              iff
                              
                                 
                                    
                                       p
                                       c
                                    
                                    
                                       (
                                       
                                          x
                                          c
                                       
                                       )
                                    
                                    =
                                    
                                       x
                                       c
                                    
                                 
                              
                              ; and (ii) for rational inputs (including h) the value of ε in (i) is a rational number of polynomial bit length.
                           

(i) The “if” part. Condition (32) implies a weaker condition

                                 
                                    (69)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      f
                                                      φ
                                                   
                                                   −
                                                   
                                                      
                                                         [
                                                         p
                                                         ]
                                                      
                                                      T
                                                   
                                                   f
                                                   ≥
                                                   0
                                                   ,
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              i.e. it satisfies dual representation of 
                                 
                                    
                                       W
                                       f
                                    
                                    
                                 
                               (29) and therefore p is relaxed-improving. It remains to prove strictness. The value of the verification LP in (24) is zero. The value of its dual problem

                                 
                                    (70)
                                    
                                       
                                          
                                             
                                                
                                                   max
                                                   {
                                                   ψ
                                                   ∈
                                                   R
                                                   
                                                   |
                                                   
                                                   
                                                      f
                                                      φ
                                                   
                                                   −
                                                   
                                                      
                                                         [
                                                         p
                                                         ]
                                                      
                                                      T
                                                   
                                                   f
                                                   −
                                                   
                                                      e
                                                      ∅
                                                   
                                                   ψ
                                                   ;
                                                   
                                                   φ
                                                   ∈
                                                   
                                                      R
                                                      +
                                                      m
                                                   
                                                   }
                                                
                                             
                                          
                                       
                                    
                                 
                              is thus also zero. It follows that φ is optimal to (70). We need to show that for 
                                 
                                    μ
                                    ∈
                                    O
                                 
                               there holds 
                                 
                                    [
                                    p
                                    ]
                                    μ
                                    =
                                    μ
                                 
                              . By multiplying (32) with 
                                 
                                    
                                       μ
                                       c
                                    
                                    
                                       (
                                       
                                          x
                                          c
                                       
                                       )
                                    
                                 
                               and summing over 
                                 c
                               and 
                                 
                                    x
                                    c
                                 
                               we obtain

                                 
                                    (71)
                                    
                                       
                                          
                                             
                                                
                                                   〈
                                                   
                                                      (
                                                      I
                                                      −
                                                      
                                                         
                                                            [
                                                            p
                                                            ]
                                                         
                                                         T
                                                      
                                                      )
                                                   
                                                   f
                                                   ,
                                                   μ
                                                   〉
                                                   −
                                                   
                                                      〈
                                                      φ
                                                      ,
                                                      A
                                                      μ
                                                      〉
                                                   
                                                   ≥
                                                   
                                                      ɛ
                                                   
                                                   
                                                      〈
                                                      h
                                                      ,
                                                      μ
                                                      〉
                                                   
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              Because μ, φ are optimal primal and dual solutions, by complementary slackness 
                                 
                                    〈
                                    φ
                                    ,
                                    A
                                    μ
                                    〉
                                    =
                                    0
                                 
                              . Assume for contradiction that [p]μ ≠ μ. Then 
                                 
                                    (
                                    ∃
                                    c
                                    ∈
                                    E
                                    ,
                                    
                                    ∃
                                    
                                       x
                                       c
                                    
                                    ∈
                                    
                                       X
                                       c
                                    
                                    )
                                 
                              
                              
                                 
                                    
                                       
                                          (
                                          
                                             [
                                             p
                                             ]
                                          
                                          μ
                                          )
                                       
                                       c
                                    
                                    
                                       (
                                       
                                          x
                                          c
                                       
                                       )
                                    
                                    ≠
                                    
                                       μ
                                       c
                                    
                                    
                                       (
                                       
                                          x
                                          c
                                       
                                       )
                                    
                                 
                              . We consider now two cases

Case 1: If 
                                 
                                    
                                       p
                                       c
                                    
                                    
                                       (
                                       
                                          x
                                          c
                                       
                                       )
                                    
                                    ≠
                                    
                                       x
                                       c
                                    
                                    ,
                                 
                               then by idempotency for all 
                                 
                                    x
                                    c
                                    ′
                                 
                               holds 
                                 
                                    
                                       p
                                       c
                                    
                                    
                                       (
                                       
                                          x
                                          c
                                          ′
                                       
                                       )
                                    
                                    ≠
                                    
                                       x
                                       c
                                    
                                 
                               and therefore from (15) we calculate that 
                                 
                                    
                                       
                                          (
                                          
                                             [
                                             p
                                             ]
                                          
                                          μ
                                          )
                                       
                                       c
                                    
                                    
                                       (
                                       
                                          x
                                          c
                                       
                                       )
                                    
                                    =
                                    0
                                 
                              . In this case from the assumption it must be 
                                 
                                    
                                       μ
                                       c
                                    
                                    
                                       (
                                       
                                          x
                                          c
                                       
                                       )
                                    
                                    >
                                    0
                                 
                               and

                                 
                                    (72)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      〈
                                                      μ
                                                      ,
                                                      h
                                                      〉
                                                   
                                                   ≥
                                                   
                                                      μ
                                                      c
                                                   
                                                   
                                                      (
                                                      
                                                         x
                                                         c
                                                      
                                                      )
                                                   
                                                   
                                                      h
                                                      c
                                                   
                                                   
                                                      (
                                                      
                                                         x
                                                         c
                                                      
                                                      )
                                                   
                                                   >
                                                   0
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              Case 2: If 
                                 
                                    
                                       p
                                       c
                                    
                                    
                                       (
                                       
                                          x
                                          c
                                       
                                       )
                                    
                                    =
                                    
                                       x
                                       c
                                    
                                 
                               then from (15) and the assumption follows 
                                 
                                    (
                                    ∃
                                    
                                       x
                                       c
                                       ′
                                    
                                    ≠
                                    
                                       x
                                       c
                                    
                                    )
                                 
                               such that 
                                 
                                    
                                       p
                                       c
                                    
                                    
                                       (
                                       
                                          x
                                          
                                             c
                                          
                                          ′
                                       
                                       )
                                    
                                    =
                                    
                                       x
                                       c
                                    
                                 
                               and 
                                 
                                    
                                       μ
                                       c
                                    
                                    
                                       (
                                       
                                          x
                                          c
                                          ′
                                       
                                       )
                                    
                                    >
                                    0
                                 
                              . In this case

                                 
                                    (73)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      〈
                                                      μ
                                                      ,
                                                      h
                                                      〉
                                                   
                                                   ≥
                                                   
                                                      μ
                                                      c
                                                   
                                                   
                                                      (
                                                      
                                                         x
                                                         c
                                                         ′
                                                      
                                                      )
                                                   
                                                   
                                                      h
                                                      c
                                                   
                                                   
                                                      (
                                                      
                                                         x
                                                         c
                                                         ′
                                                      
                                                      )
                                                   
                                                   >
                                                   0
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              In both cases 1 and 2 we have 
                                 
                                    〈
                                    
                                       (
                                       I
                                       −
                                       
                                          
                                             [
                                             p
                                             ]
                                          
                                          T
                                       
                                       )
                                    
                                    f
                                    ,
                                    μ
                                    〉
                                    >
                                    0
                                    ,
                                 
                               which contradicts optimality of μ.

We now prove the “only if” part of (i). Let 
                                 
                                    g
                                    =
                                    (
                                    I
                                    −
                                    
                                       P
                                       T
                                    
                                    )
                                    f
                                 
                               and let (μ, (φ, ψ)) be a primal-dual strictly complementary pair of solutions to

                                 
                                    (74)
                                    
                                       
                                          
                                             min
                                             
                                                μ
                                                ∈
                                                Λ
                                             
                                          
                                          
                                             〈
                                             g
                                             ,
                                             μ
                                             〉
                                          
                                          .
                                       
                                    
                                 
                              Let 
                                 
                                    O
                                    c
                                 
                               be the 
                                 c
                              -support set of primal solutions: 
                                 
                                    
                                       O
                                       c
                                    
                                    =
                                    
                                       {
                                       
                                          x
                                          c
                                       
                                       ∈
                                       
                                          X
                                          c
                                       
                                       
                                       |
                                       
                                       
                                          μ
                                          c
                                       
                                       
                                          (
                                          
                                             x
                                             c
                                          
                                          )
                                       
                                       >
                                       0
                                       }
                                    
                                 
                              . By Statement 2.6 and idempotency, there holds 
                                 
                                    
                                       p
                                       c
                                    
                                    
                                       (
                                       
                                          x
                                          c
                                       
                                       )
                                    
                                    =
                                    
                                       x
                                       c
                                    
                                 
                               for 
                                 
                                    
                                       x
                                       c
                                    
                                    ∈
                                    
                                       O
                                       c
                                    
                                 
                              . By strict complementarity, for 
                                 
                                    
                                       x
                                       c
                                    
                                    ∈
                                    
                                       O
                                       c
                                    
                                 
                               there holds 
                                 
                                    
                                       g
                                       c
                                       φ
                                    
                                    
                                       (
                                       
                                          x
                                          c
                                       
                                       )
                                    
                                    =
                                    0
                                 
                               and for 
                                 
                                    
                                       x
                                       c
                                    
                                    ∉
                                    
                                       O
                                       c
                                    
                                 
                               there holds 
                                 
                                    
                                       g
                                       c
                                       φ
                                    
                                    
                                       (
                                       
                                          x
                                          c
                                       
                                       )
                                    
                                    >
                                    0
                                 
                              . We let

                                 
                                    (75)
                                    
                                       
                                          
                                             ɛ
                                          
                                          =
                                          
                                             min
                                             
                                                
                                                   
                                                      
                                                         c
                                                         ∈
                                                         E
                                                         ,
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            x
                                                            c
                                                         
                                                         ∈
                                                         
                                                            X
                                                            c
                                                         
                                                         
                                                            ∖
                                                         
                                                         
                                                            O
                                                            c
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   g
                                                   c
                                                   φ
                                                
                                                
                                                   (
                                                   
                                                      x
                                                      c
                                                   
                                                   )
                                                
                                             
                                             
                                                
                                                   h
                                                   c
                                                
                                                
                                                   (
                                                   
                                                      x
                                                      c
                                                   
                                                   )
                                                
                                             
                                          
                                          >
                                          0
                                          .
                                       
                                    
                                 
                              Since for 
                                 
                                    
                                       x
                                       c
                                    
                                    ∈
                                    
                                       O
                                       c
                                    
                                 
                              
                              
                                 
                                    
                                       h
                                       c
                                    
                                    
                                       (
                                       
                                          x
                                          c
                                       
                                       )
                                    
                                    =
                                    0
                                    ,
                                 
                               we can bound now components of g
                              φ as follows

                                 
                                    (76)
                                    
                                       
                                          
                                             
                                                
                                                   (
                                                   ∀
                                                   c
                                                   ∈
                                                   E
                                                   ,
                                                   
                                                   ∀
                                                   
                                                      x
                                                      c
                                                   
                                                   )
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      g
                                                      c
                                                      φ
                                                   
                                                   
                                                      (
                                                      
                                                         x
                                                         c
                                                      
                                                      )
                                                   
                                                   ≥
                                                   
                                                      ɛ
                                                   
                                                   
                                                      h
                                                      c
                                                   
                                                   
                                                      (
                                                      
                                                         x
                                                         c
                                                      
                                                      )
                                                   
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              Expanding components of g
                              φ as 
                                 
                                    
                                       g
                                       c
                                       φ
                                    
                                    
                                       (
                                       
                                          x
                                          c
                                       
                                       )
                                    
                                    =
                                    
                                       f
                                       c
                                    
                                    
                                       (
                                       
                                          x
                                          c
                                       
                                       )
                                    
                                    −
                                    
                                       f
                                       c
                                    
                                    
                                       (
                                       
                                          p
                                          c
                                       
                                       
                                          (
                                          
                                             x
                                             c
                                          
                                          )
                                       
                                       )
                                    
                                    −
                                    
                                       
                                          (
                                          
                                             A
                                             T
                                          
                                          φ
                                          )
                                       
                                       c
                                    
                                    
                                       (
                                       
                                          x
                                          c
                                       
                                       )
                                    
                                    ,
                                 
                               we obtain relations (32).

The statement of part (ii) of the theorem is proved as follows. The bit length of the rational dual solution φ is polynomially bounded as well as the bit length of rational numbers h. It follows that ε calculated by (75) is a rational number of polynomially bounded bit length.□


                              Let
                              
                                 
                                    P
                                    :
                                    
                                       R
                                       I
                                    
                                    →
                                    
                                       R
                                       I
                                    
                                 
                               
                              be idempotent, P(Λ) ⊂ Λ and
                              
                                 
                                    P
                                    ∈
                                    
                                       W
                                       f
                                    
                                    
                                 
                              
                              . Then
                              
                                 
                                    (33a)
                                    
                                       
                                          
                                             
                                             
                                                
                                                   
                                                      inf
                                                      
                                                         
                                                            
                                                               
                                                                  A
                                                                  (
                                                                  I
                                                                  −
                                                                  P
                                                                  )
                                                                  μ
                                                                  ≥
                                                                  0
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  μ
                                                                  ≥
                                                                  0
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      〈
                                                      
                                                         
                                                            (
                                                            I
                                                            −
                                                            P
                                                            )
                                                         
                                                         T
                                                      
                                                      f
                                                      ,
                                                      μ
                                                      〉
                                                   
                                                   =
                                                   0
                                                   ;
                                                
                                             
                                          
                                       
                                    
                                 
                               
                              
                                 
                                    (33b)
                                    
                                       
                                          
                                             
                                             
                                                
                                                   
                                                      (
                                                      ∃
                                                      φ
                                                      ∈
                                                      
                                                         R
                                                         +
                                                         m
                                                      
                                                      )
                                                   
                                                   
                                                   
                                                   
                                                      (
                                                      I
                                                      −
                                                      
                                                         P
                                                         T
                                                      
                                                      )
                                                   
                                                   
                                                      (
                                                      f
                                                      −
                                                      
                                                         A
                                                         T
                                                      
                                                      φ
                                                      )
                                                   
                                                   ≥
                                                   0
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

Let 
                                 
                                    g
                                    =
                                    (
                                    I
                                    −
                                    
                                       P
                                       T
                                    
                                    )
                                    f
                                 
                              . The steps of the proof are given by the following chain:

                                 
                                    (77)
                                    
                                       
                                          
                                             
                                             
                                                
                                                   
                                                      inf
                                                      
                                                         
                                                            
                                                               
                                                                  A
                                                                  μ
                                                                  ≥
                                                                  0
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  μ
                                                                  ≥
                                                                  0
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      〈
                                                      f
                                                      −
                                                      
                                                         P
                                                         T
                                                      
                                                      f
                                                      ,
                                                      μ
                                                      〉
                                                   
                                                   
                                                      ≤
                                                      
                                                         (
                                                         b
                                                         )
                                                      
                                                   
                                                   
                                                      inf
                                                      
                                                         
                                                            
                                                               
                                                                  A
                                                                  P
                                                                  μ
                                                                  ≥
                                                                  0
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  A
                                                                  (
                                                                  I
                                                                  −
                                                                  P
                                                                  )
                                                                  μ
                                                                  ≥
                                                                  0
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  μ
                                                                  ≥
                                                                  0
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      〈
                                                      f
                                                      −
                                                      
                                                         P
                                                         T
                                                      
                                                      f
                                                      ,
                                                      μ
                                                      〉
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                                
                                                   
                                                      =
                                                      
                                                         (
                                                         c
                                                         )
                                                      
                                                   
                                                   
                                                      inf
                                                      
                                                         
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  A
                                                                  (
                                                                  I
                                                                  −
                                                                  P
                                                                  )
                                                                  μ
                                                                  ≥
                                                                  0
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  μ
                                                                  ≥
                                                                  0
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      〈
                                                      f
                                                      −
                                                      
                                                         P
                                                         T
                                                      
                                                      f
                                                      ,
                                                      μ
                                                      〉
                                                   
                                                   
                                                      =
                                                      
                                                         (
                                                         d
                                                         )
                                                      
                                                   
                                                   
                                                      sup
                                                      
                                                         
                                                            
                                                               
                                                                  φ
                                                                  ∈
                                                                  
                                                                     R
                                                                     +
                                                                     m
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     (
                                                                     I
                                                                     −
                                                                     
                                                                        P
                                                                        T
                                                                     
                                                                     )
                                                                  
                                                                  
                                                                     (
                                                                     f
                                                                     −
                                                                     
                                                                        A
                                                                        T
                                                                     
                                                                     φ
                                                                     )
                                                                  
                                                                  ≥
                                                                  0
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   0
                                                   
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              On the LHS we have problem (30). If 
                                 
                                    P
                                    ∈
                                    
                                       W
                                       f
                                    
                                    
                                 
                               this problem is bounded and the value of the problem is zero. Equalities (b) and (c) essentially claim boundedness of the other two minimization problems in the chain.

Inequality (b) is verified as follows. Inequality ≤ holds because by summing two inequalities

                                 
                                    (78a)
                                    
                                       
                                          
                                             
                                             
                                                
                                                   A
                                                   P
                                                   μ
                                                   ≥
                                                   0
                                                   ,
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (78b)
                                    
                                       
                                          
                                             
                                             
                                                
                                                   A
                                                   (
                                                   I
                                                   −
                                                   P
                                                   )
                                                   μ
                                                   ≥
                                                   0
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

we get Aμ ≥ 0.

Equality (c) is the key step. We removed one constraint, therefore ≥ trivially holds. Let us prove ≤ . Let μ be feasible to RHS of equality (c). Let 
                                 
                                    μ
                                    =
                                    
                                       μ
                                       1
                                    
                                    +
                                    
                                       μ
                                       2
                                    
                                    ,
                                 
                               where

                                 
                                    (79)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      μ
                                                      1
                                                   
                                                   =
                                                   P
                                                   μ
                                                   
                                                   ;
                                                   
                                                   
                                                   
                                                   
                                                   
                                                      μ
                                                      2
                                                   
                                                   =
                                                   
                                                      (
                                                      I
                                                      −
                                                      P
                                                      )
                                                   
                                                   μ
                                                   
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              There holds

                                 
                                    (80)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      (
                                                      I
                                                      −
                                                      P
                                                      )
                                                   
                                                   
                                                      μ
                                                      1
                                                   
                                                
                                             
                                             
                                                
                                                   =
                                                   
                                                      (
                                                      I
                                                      −
                                                      P
                                                      )
                                                   
                                                   P
                                                   μ
                                                   =
                                                   
                                                      (
                                                      P
                                                      −
                                                      
                                                         P
                                                         2
                                                      
                                                      )
                                                   
                                                   μ
                                                   =
                                                   0
                                                   
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                                
                                                   P
                                                   
                                                      μ
                                                      2
                                                   
                                                
                                             
                                             
                                                
                                                   =
                                                   P
                                                   (
                                                   I
                                                   −
                                                   P
                                                   )
                                                   μ
                                                   =
                                                   0
                                                   
                                                   ,
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              i.e., 
                                 
                                    
                                       μ
                                       1
                                    
                                    ∈
                                    null
                                    
                                       (
                                       I
                                       −
                                       P
                                       )
                                    
                                 
                               and 
                                 
                                    
                                       μ
                                       2
                                    
                                    ∈
                                    null
                                    
                                       (
                                       P
                                       )
                                    
                                 
                              . Let us chose 
                                 
                                    μ
                                    1
                                    ′
                                 
                               such that

                                 
                                    (81)
                                    
                                       
                                          
                                             μ
                                             1
                                             ′
                                          
                                          ≥
                                          
                                             μ
                                             1
                                          
                                          
                                          
                                          
                                          and
                                          
                                          
                                          
                                          A
                                          
                                             μ
                                             1
                                             ′
                                          
                                          ≥
                                          0
                                          
                                          .
                                       
                                    
                                 
                              For example, the relaxed labeling

                                 
                                    (82)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      μ
                                                      1
                                                      ′
                                                   
                                                   =
                                                   γ
                                                   
                                                      1
                                                      
                                                         |
                                                         X
                                                         |
                                                      
                                                   
                                                   
                                                      ∑
                                                      
                                                         x
                                                         ∈
                                                         X
                                                      
                                                   
                                                   δ
                                                   
                                                      (
                                                      x
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              will satisfy these constraints for sufficiently large γ > 0. Indeed, all components of 
                                 
                                    μ
                                    1
                                    ′
                                 
                               are strictly positive, it belongs to 
                                 M
                               as a convex combination of integer labelings and therefore satisfies constraints of the relaxation 
                                 
                                    A
                                    
                                       μ
                                       1
                                       ′
                                    
                                    ≥
                                    0
                                 
                               for any γ > 0. It remains to choose γ large enough so as to have 
                                 
                                    
                                       (
                                       
                                          μ
                                          1
                                          ′
                                       
                                       )
                                    
                                    ≥
                                    
                                       μ
                                       1
                                    
                                 
                               satisfied.

Notice, that 
                                 
                                    
                                       
                                          (
                                          
                                             μ
                                             1
                                             ′
                                          
                                          )
                                       
                                       ∅
                                    
                                    =
                                    γ
                                 
                              . Let 
                                 
                                    
                                       μ
                                       1
                                       
                                          ′
                                          ′
                                       
                                    
                                    =
                                    P
                                    
                                       μ
                                       1
                                       ′
                                    
                                 
                              . Because P ≥ 0, we have

                                 
                                    (83)
                                    
                                       
                                          
                                             μ
                                             1
                                             
                                                ′
                                                ′
                                             
                                          
                                          =
                                          P
                                          
                                             μ
                                             1
                                             ′
                                          
                                          ≥
                                          P
                                          
                                             μ
                                             1
                                          
                                          =
                                          
                                             μ
                                             1
                                          
                                          
                                          .
                                       
                                    
                                 
                              Because 
                                 
                                    
                                       μ
                                       1
                                       ′
                                    
                                    ∈
                                    coni
                                    
                                       (
                                       Λ
                                       )
                                    
                                    ,
                                 
                               there holds

                                 
                                    
                                       
                                          A
                                          P
                                          
                                             μ
                                             1
                                             
                                                ′
                                                ′
                                             
                                          
                                          =
                                          A
                                          P
                                          P
                                          
                                             μ
                                             1
                                             ′
                                          
                                          =
                                          A
                                          P
                                          
                                             μ
                                             1
                                             ′
                                          
                                          ≥
                                          0
                                          .
                                       
                                    
                                 
                              By idempotency, 
                                 
                                    
                                       (
                                       I
                                       −
                                       P
                                       )
                                    
                                    
                                       μ
                                       1
                                       
                                          ′
                                          ′
                                       
                                    
                                    =
                                    
                                       (
                                       I
                                       −
                                       P
                                       )
                                    
                                    P
                                    
                                       μ
                                       1
                                       ′
                                    
                                    =
                                    0
                                 
                              .

Let 
                                 
                                    
                                       μ
                                       *
                                    
                                    =
                                    
                                       μ
                                       
                                          1
                                       
                                       
                                          ′
                                          ′
                                       
                                    
                                    +
                                    
                                       μ
                                       2
                                    
                                 
                              . It preserves the objective,

                                 
                                    (84)
                                    
                                       
                                          
                                             
                                                
                                                   〈
                                                   f
                                                   −
                                                   
                                                      P
                                                      T
                                                   
                                                   f
                                                   ,
                                                   
                                                      μ
                                                      *
                                                   
                                                   〉
                                                
                                             
                                             
                                                
                                                   =
                                                   〈
                                                   f
                                                   ,
                                                   
                                                      (
                                                      I
                                                      −
                                                      P
                                                      )
                                                   
                                                   
                                                      (
                                                      
                                                         μ
                                                         
                                                            1
                                                         
                                                         
                                                            ′
                                                            ′
                                                         
                                                      
                                                      +
                                                      
                                                         μ
                                                         2
                                                      
                                                      )
                                                   
                                                   〉
                                                
                                             
                                          
                                          
                                             
                                                
                                             
                                             
                                                
                                                   =
                                                   
                                                      〈
                                                      f
                                                      ,
                                                      
                                                         (
                                                         I
                                                         −
                                                         P
                                                         )
                                                      
                                                      
                                                         μ
                                                         2
                                                      
                                                      〉
                                                   
                                                   =
                                                   
                                                      〈
                                                      f
                                                      ,
                                                      
                                                         (
                                                         I
                                                         −
                                                         P
                                                         )
                                                      
                                                      μ
                                                      〉
                                                   
                                                   
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              We also have that

                                 
                                    (85)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      μ
                                                      *
                                                   
                                                   =
                                                   
                                                      μ
                                                      
                                                         1
                                                      
                                                      
                                                         ′
                                                         ′
                                                      
                                                   
                                                   +
                                                   
                                                      μ
                                                      2
                                                   
                                                   ≥
                                                   
                                                      μ
                                                      1
                                                   
                                                   +
                                                   
                                                      μ
                                                      2
                                                   
                                                   =
                                                   μ
                                                   ≥
                                                   0
                                                   
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                                
                                                   A
                                                   
                                                      (
                                                      I
                                                      −
                                                      P
                                                      )
                                                   
                                                   
                                                      μ
                                                      *
                                                   
                                                   =
                                                   A
                                                   
                                                      (
                                                      I
                                                      −
                                                      P
                                                      )
                                                   
                                                   
                                                      μ
                                                      2
                                                   
                                                   =
                                                   A
                                                   
                                                      (
                                                      I
                                                      −
                                                      P
                                                      )
                                                   
                                                   μ
                                                   ≥
                                                   0
                                                   
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                                
                                                   A
                                                   P
                                                   
                                                      μ
                                                      *
                                                   
                                                   =
                                                   A
                                                   P
                                                   
                                                      μ
                                                      1
                                                      
                                                         ′
                                                         ′
                                                      
                                                   
                                                   ≥
                                                   0
                                                   
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              Therefore, μ
                              * satisfies all constraints of the LHS of equality (c). Equality (d) is the duality relation that asserts that the maximization problem on the RHS is feasible.□


                        
                           Lemma 2.11
                           Identity Equality (S3)
                           


                           
                              Let G(ζ) be the linearization of g(z). Then
                              
                                 
                                    g
                                    (
                                    z
                                    )
                                    =
                                    0
                                 
                               
                              for all
                              
                                 
                                    z
                                    ∈
                                    
                                       
                                          {
                                          0
                                          ,
                                          1
                                          }
                                       
                                       c
                                    
                                 
                               
                              iff
                              
                                 
                                    G
                                    (
                                    ζ
                                    )
                                    =
                                    0
                                 
                               
                              for all
                              
                                 
                                    ζ
                                    ∈
                                    
                                       R
                                       
                                          2
                                          c
                                       
                                    
                                 
                              
                              .
                           

The correspondence between g and G is through coefficients α:

                                 
                                    (86a)
                                    
                                       
                                          
                                             
                                             
                                                
                                                   g
                                                   
                                                      (
                                                      z
                                                      )
                                                   
                                                   =
                                                   
                                                      ∑
                                                      
                                                         d
                                                         ⊂
                                                         c
                                                      
                                                   
                                                   
                                                      α
                                                      d
                                                   
                                                   
                                                      ∏
                                                      
                                                         s
                                                         ∈
                                                         d
                                                      
                                                   
                                                   
                                                      z
                                                      s
                                                   
                                                   ;
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (86b)
                                    
                                       
                                          
                                             
                                             
                                                
                                                   G
                                                   
                                                      (
                                                      ζ
                                                      )
                                                   
                                                   =
                                                   
                                                      ∑
                                                      
                                                         d
                                                         ⊂
                                                         c
                                                      
                                                   
                                                   
                                                      α
                                                      d
                                                   
                                                   
                                                      ζ
                                                      d
                                                   
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

We have g ≡ 0 iff all coefficients of the (unique) multilinear polynomial representation α are zero and it is the case iff G ≡ 0.□

For subsequent proofs let us introduce the correspondence between binary variables z and their lifted representation ζ as the mapping ζ(z) from 
                           
                              
                                 {
                                 0
                                 ,
                                 1
                                 }
                              
                              c
                           
                         to 
                           
                              R
                              
                                 2
                                 c
                              
                           
                         with components

                           
                              (87)
                              
                                 
                                    
                                       
                                          
                                             ζ
                                             
                                                
                                                   (
                                                   z
                                                   )
                                                
                                                d
                                             
                                             =
                                             
                                                ∏
                                                
                                                   s
                                                   ∈
                                                   d
                                                
                                             
                                             
                                                z
                                                s
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           Lemma 2.13
                           Identity inequality (S5)


                           
                              Let G(ζ) be the linearization of g(z). Then g(z) ≥ 0 for all
                              
                                 
                                    z
                                    ∈
                                    
                                       
                                          {
                                          0
                                          ,
                                          1
                                          }
                                       
                                       c
                                    
                                 
                               
                              iff G(ζ) ≥ 0 for all
                              
                                 
                                    ζ
                                    ∈
                                    
                                       Z
                                       c
                                    
                                 
                              
                              .
                           

(⇐) This part follows from the fact that ζ(z) satisfies all constraints of 
                                 
                                    Z
                                    c
                                 
                               and thus 
                                 
                                    g
                                    (
                                    z
                                    )
                                    =
                                    G
                                    (
                                    ζ
                                    (
                                    z
                                    )
                                    )
                                    ≥
                                    0
                                 
                               for all 
                                 
                                    z
                                    ∈
                                    
                                       
                                          {
                                          0
                                          ,
                                          1
                                          }
                                       
                                       c
                                    
                                 
                              .

(⇒) Note that a special case when 
                                 
                                    g
                                    
                                       (
                                       z
                                       )
                                    
                                    =
                                    
                                       ∏
                                       
                                          s
                                          ∈
                                          b
                                       
                                    
                                    
                                       z
                                       s
                                    
                                    
                                       ∏
                                       
                                          s
                                          ∈
                                          a
                                       
                                    
                                    
                                       (
                                       1
                                       −
                                       
                                          z
                                          s
                                       
                                       )
                                    
                                 
                               and 
                                 
                                    a
                                    ∩
                                    b
                                    =
                                    ∅
                                    ,
                                 
                              
                              
                                 
                                    a
                                    ,
                                    
                                    b
                                    ⊂
                                    c
                                 
                               is proven in [58, Lemma 2]. Here is a different general proof.

Since g is non-negative, it can be represented as a posiform [6, Proposition 1]:

                                 
                                    (88)
                                    
                                       
                                          
                                             
                                                
                                                   g
                                                   
                                                      (
                                                      z
                                                      )
                                                   
                                                   =
                                                   
                                                      ∑
                                                      
                                                         b
                                                         ⊂
                                                         c
                                                      
                                                   
                                                   
                                                      α
                                                      b
                                                   
                                                   
                                                      ∏
                                                      
                                                         s
                                                         ∈
                                                         b
                                                      
                                                   
                                                   
                                                      z
                                                      s
                                                   
                                                   
                                                      ∏
                                                      
                                                         s
                                                         ∈
                                                         c
                                                         ∖
                                                         b
                                                      
                                                   
                                                   
                                                      (
                                                      1
                                                      −
                                                      
                                                         z
                                                         s
                                                      
                                                      )
                                                   
                                                   ,
                                                
                                             
                                          
                                       
                                    
                                 
                              where 
                                 
                                    
                                       α
                                       b
                                    
                                    =
                                    g
                                    
                                       (
                                       
                                          
                                             1
                                             l
                                          
                                          b
                                       
                                       )
                                    
                                    ≥
                                    0
                                 
                               and 
                                 
                                    
                                       
                                          1
                                          l
                                       
                                       b
                                    
                                    ∈
                                    
                                       
                                          {
                                          0
                                          ,
                                          1
                                          }
                                       
                                       c
                                    
                                 
                               is the indicator of the set 
                                 b
                               defined as: 
                                 
                                    
                                       
                                          (
                                          
                                             
                                                1
                                                l
                                             
                                             b
                                          
                                          )
                                       
                                       s
                                    
                                    :
                                    =
                                    〚
                                    s
                                    
                                    ∈
                                    
                                    b
                                    〛
                                 
                              . By linear combination property (S3), G(ζ) can be written as

                                 
                                    (89)
                                    
                                       
                                          
                                             
                                                
                                                   G
                                                   
                                                      (
                                                      ζ
                                                      )
                                                   
                                                   =
                                                   
                                                      ∑
                                                      
                                                         b
                                                         ⊂
                                                         c
                                                      
                                                   
                                                   
                                                      α
                                                      b
                                                   
                                                   
                                                      ∑
                                                      
                                                         d
                                                         ⊂
                                                         c
                                                         ∖
                                                         b
                                                      
                                                   
                                                   
                                                      
                                                         (
                                                         −
                                                         1
                                                         )
                                                      
                                                      
                                                         |
                                                         D
                                                         |
                                                      
                                                   
                                                   
                                                      ζ
                                                      
                                                         d
                                                         ∪
                                                         b
                                                      
                                                   
                                                   ,
                                                
                                             
                                          
                                       
                                    
                                 
                              which is a non-negative combination of non-negative summands, as ensured by constraints of 
                                 
                                    Z
                                    c
                                 
                              .□


                              Polytope
                              
                                 
                                    Z
                                    c
                                 
                               
                              equals the convex hull
                              
                                 
                                    (38)
                                    
                                       
                                          
                                             
                                                
                                                   conv
                                                   
                                                      {
                                                      ζ
                                                      
                                                         (
                                                         z
                                                         )
                                                      
                                                      ∈
                                                      
                                                         R
                                                         
                                                            2
                                                            c
                                                         
                                                      
                                                      
                                                      |
                                                      
                                                      ζ
                                                      
                                                         
                                                            (
                                                            z
                                                            )
                                                         
                                                         d
                                                      
                                                      =
                                                      
                                                         ∏
                                                         
                                                            s
                                                            ∈
                                                            d
                                                         
                                                      
                                                      
                                                         z
                                                         s
                                                      
                                                      ,
                                                      
                                                      ∀
                                                      d
                                                      ⊂
                                                      c
                                                      ,
                                                      ∀
                                                      z
                                                      ∈
                                                      
                                                         
                                                            {
                                                            0
                                                            ,
                                                            1
                                                            }
                                                         
                                                         c
                                                      
                                                      }
                                                   
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

Let 
                                 H
                               denote the convex hull (38). Clearly, any vertex of 
                                 H
                               is in 
                                 
                                    Z
                                    c
                                 
                               and therefore 
                                 
                                    H
                                    ⊂
                                    
                                       Z
                                       c
                                    
                                 
                              .

Let 
                                 
                                    G
                                    
                                       (
                                       ζ
                                       )
                                    
                                    =
                                    
                                       ∑
                                       
                                          d
                                          ⊂
                                          c
                                       
                                    
                                    
                                       α
                                       d
                                    
                                    
                                       ζ
                                       d
                                    
                                    ≥
                                    0
                                 
                               be a facet-defining inequality of 
                                 H
                              . Let us show it holds for all 
                                 
                                    ζ
                                    ∈
                                    
                                       Z
                                       c
                                    
                                 
                              . Let 
                                 
                                    g
                                    
                                       (
                                       z
                                       )
                                    
                                    =
                                    
                                       ∑
                                       
                                          d
                                          ⊂
                                          c
                                       
                                    
                                    
                                       α
                                       d
                                    
                                    
                                       ∏
                                       
                                          s
                                          ∈
                                          d
                                       
                                    
                                    
                                       z
                                       s
                                    
                                    ,
                                 
                              
                              
                                 
                                    z
                                    ∈
                                    
                                       
                                          {
                                          0
                                          ,
                                          1
                                          }
                                       
                                       c
                                    
                                    ,
                                 
                               a multilinear polynomial corresponding to G. For all vertices ζ(z) of 
                                 H
                               there holds 
                                 
                                    G
                                    (
                                    ζ
                                    (
                                    z
                                    )
                                    )
                                    =
                                    g
                                    (
                                    z
                                    )
                                 
                               and at the same time G(ζ) ≥ 0. It follows that g(z) ≥ 0 for all 
                                 
                                    z
                                    ∈
                                    
                                       
                                          {
                                          0
                                          ,
                                          1
                                          }
                                       
                                       c
                                    
                                 
                               and, by Lemma 2.13, G(ζ) ≥ 0 for all 
                                 
                                    ζ
                                    ∈
                                    
                                       Z
                                       c
                                    
                                 
                              . We have proven that 
                                 
                                    
                                       Z
                                       c
                                    
                                    ⊂
                                    H
                                 
                              .□


                              For
                              
                                 
                                    ζ
                                    ∈
                                    
                                       Z
                                       c
                                    
                                 
                               
                              there holds
                              
                                 
                                    
                                       ζ
                                       2
                                    
                                    ∈
                                    
                                       Z
                                       c
                                    
                                    ,
                                 
                               
                              where the product
                              
                                 
                                    
                                       ζ
                                       2
                                    
                                    =
                                    ζ
                                    ζ
                                 
                               
                              is component-wise.
                           

Using the convex hull property we can represent 
                                 
                                    ζ
                                    ∈
                                    
                                       Z
                                       c
                                    
                                 
                               as convex combination of vertices, i.e., 
                                 
                                    
                                       ζ
                                       d
                                    
                                    =
                                    
                                       ∑
                                       
                                          k
                                          =
                                          1
                                       
                                       n
                                    
                                    
                                       α
                                       k
                                    
                                    
                                       ∏
                                       
                                          s
                                          ∈
                                          d
                                       
                                    
                                    
                                       z
                                       s
                                       k
                                    
                                    ,
                                 
                              
                              
                                 
                                    d
                                    ⊂
                                    c
                                    ,
                                 
                               where 
                                 
                                    
                                       z
                                       k
                                    
                                    ∈
                                    
                                       
                                          {
                                          0
                                          ,
                                          1
                                          }
                                       
                                       c
                                    
                                 
                               for 
                                 
                                    k
                                    =
                                    1
                                    ,
                                    ⋯
                                    ,
                                    n
                                 
                               and αk
                               ≥ 0 and 
                                 
                                    
                                       ∑
                                       
                                          k
                                          =
                                          1
                                       
                                       n
                                    
                                    
                                       α
                                       k
                                    
                                    =
                                    1
                                 
                              . Then

                                 
                                    (90)
                                    
                                       
                                          
                                             
                                             
                                                
                                                   
                                                      ζ
                                                      d
                                                      2
                                                   
                                                   =
                                                   
                                                      ∑
                                                      
                                                         
                                                            k
                                                            1
                                                         
                                                         =
                                                         1
                                                      
                                                      n
                                                   
                                                   
                                                      ∑
                                                      
                                                         
                                                            k
                                                            2
                                                         
                                                         =
                                                         1
                                                      
                                                      n
                                                   
                                                   
                                                      α
                                                      
                                                         k
                                                         1
                                                      
                                                   
                                                   
                                                      α
                                                      
                                                         k
                                                         2
                                                      
                                                   
                                                   
                                                      ∏
                                                      
                                                         s
                                                         ∈
                                                         d
                                                      
                                                   
                                                   
                                                      z
                                                      s
                                                      
                                                         k
                                                         1
                                                      
                                                   
                                                   
                                                      ∏
                                                      
                                                         s
                                                         ∈
                                                         d
                                                      
                                                   
                                                   
                                                      z
                                                      s
                                                      
                                                         k
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (91)
                                    
                                       
                                          
                                             
                                             
                                                
                                                   =
                                                   
                                                      ∑
                                                      
                                                         
                                                            k
                                                            1
                                                         
                                                         ,
                                                         
                                                         
                                                            k
                                                            2
                                                         
                                                         =
                                                         1
                                                      
                                                      n
                                                   
                                                   
                                                      α
                                                      
                                                         k
                                                         1
                                                      
                                                   
                                                   
                                                      α
                                                      
                                                         k
                                                         2
                                                      
                                                   
                                                   
                                                      ∏
                                                      
                                                         s
                                                         ∈
                                                         d
                                                      
                                                   
                                                   
                                                      z
                                                      s
                                                      
                                                         
                                                            k
                                                            1
                                                         
                                                         ,
                                                         
                                                            k
                                                            k
                                                         
                                                      
                                                   
                                                   ,
                                                
                                             
                                          
                                       
                                    
                                 
                              where 
                                 
                                    
                                       z
                                       
                                          
                                             k
                                             1
                                          
                                          ,
                                          
                                             k
                                             2
                                          
                                       
                                    
                                    ∈
                                    
                                       
                                          {
                                          0
                                          ,
                                          1
                                          }
                                       
                                       c
                                    
                                 
                               is the coordinate-wise product of 
                                 
                                    z
                                    
                                       k
                                       1
                                    
                                 
                               and 
                                 
                                    z
                                    
                                       k
                                       2
                                    
                                 
                              . Note that 
                                 
                                    
                                       α
                                       
                                          k
                                          1
                                       
                                    
                                    
                                       α
                                       
                                          k
                                          2
                                       
                                    
                                    ≥
                                    0
                                 
                               and 
                                 
                                    
                                       ∑
                                       
                                          
                                             k
                                             1
                                          
                                          ,
                                          
                                          
                                             k
                                             2
                                          
                                          =
                                          1
                                       
                                       n
                                    
                                    
                                       α
                                       
                                          k
                                          1
                                       
                                    
                                    
                                       α
                                       
                                          k
                                          2
                                       
                                    
                                    =
                                    1
                                 
                              . Expression (90) proves that ζ
                              2 is representable as a convex combination of vertices and thus belongs to 
                                 
                                    Z
                                    c
                                 
                              . One could similarly show that for 
                                 
                                    ζ
                                    ,
                                    
                                    η
                                    ∈
                                    
                                       Z
                                       c
                                    
                                 
                               their product ζη also belongs to 
                                 
                                    Z
                                    c
                                 
                              .□

In Section 2.7 we used representation of coefficients 
                           
                              P
                              
                                 c
                                 ,
                                 
                                    x
                                    c
                                 
                                 ,
                                 
                                    x
                                    c
                                    ′
                                 
                              
                           
                         of the linear extension [pζ
                        ] in the form of a polynomial (39). This representation is obtained as follows. Starting from definition (36), we express:

                           
                              (92)
                              
                                 
                                    
                                       
                                          
                                             
                                                P
                                                
                                                   c
                                                   ,
                                                   
                                                      x
                                                      
                                                         c
                                                         ,
                                                      
                                                   
                                                   
                                                      x
                                                      c
                                                      ′
                                                   
                                                
                                             
                                             =
                                          
                                       
                                       
                                          
                                             
                                                ∏
                                                
                                                   s
                                                   ∈
                                                   c
                                                
                                             
                                             
                                                (
                                                
                                                   (
                                                   〚
                                                   
                                                      x
                                                      s
                                                      ′
                                                   
                                                   =
                                                   
                                                      x
                                                      s
                                                   
                                                   〛
                                                   −
                                                   〚
                                                   
                                                      y
                                                      s
                                                   
                                                   =
                                                   
                                                      x
                                                      s
                                                   
                                                   〛
                                                   )
                                                
                                                
                                                   ζ
                                                   
                                                      s
                                                      ,
                                                      
                                                         x
                                                         s
                                                         ′
                                                      
                                                   
                                                
                                                +
                                                〚
                                                
                                                   y
                                                   s
                                                
                                                =
                                                
                                                   x
                                                   s
                                                
                                                〛
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                          =
                                       
                                       
                                          
                                             
                                                ∑
                                                
                                                   d
                                                   ⊂
                                                   c
                                                
                                             
                                             
                                                c
                                                
                                                   c
                                                   ,
                                                   d
                                                
                                             
                                             
                                                (
                                                
                                                   x
                                                   c
                                                
                                                ,
                                                
                                                   x
                                                   d
                                                   ′
                                                
                                                )
                                             
                                             
                                                ∏
                                                
                                                   s
                                                   ∈
                                                   d
                                                
                                             
                                             
                                                ζ
                                                
                                                   s
                                                   ,
                                                   
                                                      x
                                                      s
                                                      ′
                                                   
                                                
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        where

                           
                              (93)
                              
                                 
                                    
                                       
                                          
                                             
                                                c
                                                d
                                             
                                             
                                                (
                                                
                                                   x
                                                   s
                                                
                                                ,
                                                
                                                   x
                                                   s
                                                   ′
                                                
                                                )
                                             
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             {
                                             
                                                
                                                   
                                                      
                                                         〚
                                                         
                                                            x
                                                            s
                                                            ′
                                                         
                                                         =
                                                         
                                                            x
                                                            s
                                                         
                                                         〛
                                                         −
                                                         〚
                                                         
                                                            y
                                                            s
                                                         
                                                         =
                                                         
                                                            x
                                                            s
                                                         
                                                         〛
                                                         ,
                                                      
                                                   
                                                   
                                                      
                                                         s
                                                         ∈
                                                         d
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         〚
                                                         
                                                            y
                                                            s
                                                         
                                                         =
                                                         
                                                            x
                                                            s
                                                         
                                                         〛
                                                         ,
                                                      
                                                   
                                                   
                                                      
                                                         s
                                                         ∈
                                                         c
                                                         /
                                                         d
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                c
                                                
                                                   c
                                                   ,
                                                   d
                                                
                                             
                                             
                                                (
                                                
                                                   x
                                                   c
                                                
                                                ,
                                                
                                                   x
                                                   d
                                                   ′
                                                
                                                )
                                             
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                ∏
                                                
                                                   s
                                                   ∈
                                                   c
                                                
                                             
                                             
                                                c
                                                d
                                             
                                             
                                                (
                                                
                                                   x
                                                   s
                                                
                                                ,
                                                
                                                   x
                                                   s
                                                   ′
                                                
                                                )
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           Theorem 2.16
                           
                              Inequalities (
                              
                                 41c
                              
                              ) in the definition of polytope
                              
                                 Z
                               
                              can be equivalently replaced with Pζ
                               ≥ 0.
                           

The fact that inequalities (41c) imply Pζ
                               ≥ 0, assuming equality constraints (41a) and (41b), was shown in Section 2.7. We show now that Pζ
                               ≥ 0 implies inequalities (41c).

The inequality Pζ
                               ≥ 0 for the linear mapping Pζ
                               means that all its matrix elements are non-negative, i.e., the defining coefficients 
                                 
                                    P
                                    
                                       c
                                       ,
                                       
                                          x
                                          c
                                       
                                       ,
                                       
                                          x
                                          c
                                          ′
                                       
                                    
                                 
                               for 
                                 
                                    c
                                    ∈
                                    E
                                    ,
                                 
                              
                              
                                 
                                    
                                       x
                                       c
                                    
                                    ∈
                                    
                                       X
                                       c
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       x
                                       c
                                       ′
                                    
                                    ∈
                                    
                                       X
                                       c
                                    
                                 
                               are non-negative. Let us detail the constraint

                                 
                                    (94)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      P
                                                      
                                                         c
                                                         ,
                                                         
                                                            x
                                                            c
                                                         
                                                         ,
                                                         
                                                            x
                                                            c
                                                            ′
                                                         
                                                      
                                                   
                                                   ≥
                                                   0
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              Let

                                 
                                    (95)
                                    
                                       
                                          a
                                          =
                                          
                                             {
                                             s
                                             ∈
                                             c
                                             
                                             |
                                             
                                             
                                                x
                                                s
                                             
                                             ≠
                                             
                                                x
                                                s
                                                ′
                                             
                                             }
                                          
                                          ,
                                          
                                          
                                          
                                          b
                                          =
                                          
                                             {
                                             s
                                             ∈
                                             c
                                             
                                             |
                                             
                                             
                                                x
                                                s
                                             
                                             ≠
                                             
                                                y
                                                s
                                             
                                             }
                                          
                                          .
                                       
                                    
                                 
                              and let 
                                 
                                    a
                                    ¯
                                 
                               denote the complement in 
                                 c
                              . From (93) we have

                                 
                                    (96)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      c
                                                      d
                                                   
                                                   
                                                      (
                                                      
                                                         x
                                                         s
                                                      
                                                      ,
                                                      
                                                         x
                                                         s
                                                         ′
                                                      
                                                      )
                                                   
                                                   =
                                                   
                                                      {
                                                      
                                                         
                                                            
                                                               
                                                                  1
                                                                  ,
                                                               
                                                            
                                                            
                                                               
                                                                  s
                                                                  ∈
                                                                  
                                                                     a
                                                                     ¯
                                                                  
                                                                  ∩
                                                                  b
                                                                  ∩
                                                                  d
                                                                  ,
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  −
                                                                  1
                                                                  ,
                                                               
                                                            
                                                            
                                                               
                                                                  s
                                                                  ∈
                                                                  a
                                                                  ∩
                                                                  
                                                                     b
                                                                     ¯
                                                                  
                                                                  ∩
                                                                  d
                                                                  ,
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  0
                                                                  ,
                                                               
                                                            
                                                            
                                                               
                                                                  s
                                                                  ∈
                                                                  
                                                                     
                                                                        (
                                                                        a
                                                                        ▵
                                                                        b
                                                                        )
                                                                     
                                                                     ¯
                                                                  
                                                                  ∩
                                                                  d
                                                                  ,
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               1
                                                            
                                                            
                                                               
                                                                  s
                                                                  ∈
                                                                  
                                                                     b
                                                                     ¯
                                                                  
                                                                  ∩
                                                                  
                                                                     d
                                                                     ¯
                                                                  
                                                                  ,
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  0
                                                                  ,
                                                               
                                                            
                                                            
                                                               
                                                                  s
                                                                  ∈
                                                                  b
                                                                  ∩
                                                                  
                                                                     d
                                                                     ¯
                                                                  
                                                                  .
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

Coefficient 
                                 
                                    
                                       c
                                       d
                                    
                                    
                                       (
                                       
                                          x
                                          c
                                       
                                       ,
                                       
                                          x
                                          c
                                          ′
                                       
                                       )
                                    
                                 
                               in (93), which is the product of (96) over 
                                 
                                    s
                                    ∈
                                    c
                                    ,
                                 
                               expresses as

                                 
                                    (97)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      c
                                                      d
                                                   
                                                   
                                                      (
                                                      
                                                         x
                                                         c
                                                      
                                                      ,
                                                      
                                                         x
                                                         c
                                                         ′
                                                      
                                                      )
                                                   
                                                   =
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         (
                                                         −
                                                         1
                                                         )
                                                      
                                                      
                                                         
                                                            |
                                                            a
                                                            ∩
                                                         
                                                         
                                                            b
                                                            ¯
                                                         
                                                         
                                                            ∩
                                                            d
                                                            |
                                                         
                                                      
                                                   
                                                   
                                                      0
                                                      
                                                         |
                                                         d
                                                         ∖
                                                         (
                                                         a
                                                         ▵
                                                         b
                                                         )
                                                         |
                                                      
                                                   
                                                   
                                                      0
                                                      
                                                         |
                                                         b
                                                         ∖
                                                         d
                                                         |
                                                      
                                                   
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              It is non-zero only when 
                                 
                                    d
                                    ∖
                                    (
                                    a
                                    ▵
                                    b
                                    )
                                    =
                                    ∅
                                 
                               and 
                                 
                                    b
                                    ∖
                                    d
                                    =
                                    ∅
                                 
                               or equivalently

                                 
                                    (98a)
                                    
                                       
                                          
                                             
                                             
                                                
                                                   b
                                                   ⊂
                                                   d
                                                   ,
                                                   
                                                   d
                                                   ⊂
                                                   a
                                                   ▵
                                                   b
                                                   ;
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (98b)
                                    
                                       
                                          
                                             
                                                
                                                   ⇔
                                                   
                                                   
                                                
                                             
                                             
                                                
                                                   b
                                                   ⊂
                                                   d
                                                   ,
                                                   
                                                   a
                                                   ⊂
                                                   
                                                      b
                                                      ¯
                                                   
                                                   ,
                                                   
                                                   d
                                                   ⊂
                                                   a
                                                   ∪
                                                   b
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

Using sets 
                                 
                                    a
                                    ,
                                    b
                                 
                               and coefficients (97) we obtain

                                 
                                    (99)
                                    
                                       
                                          
                                             P
                                             
                                                c
                                                ,
                                                
                                                   x
                                                   c
                                                
                                                ,
                                                
                                                   x
                                                   c
                                                   ′
                                                
                                             
                                          
                                          =
                                          
                                             ∑
                                             
                                                
                                                   
                                                      d
                                                   
                                                
                                                
                                                   
                                                      
                                                         b
                                                         ⊂
                                                         d
                                                         ⊂
                                                         a
                                                         ∪
                                                         b
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                (
                                                −
                                                1
                                                )
                                             
                                             
                                                |
                                                d
                                                ∖
                                                b
                                                |
                                             
                                          
                                          
                                             ζ
                                             
                                                d
                                                ,
                                                
                                                   x
                                                   d
                                                   ′
                                                
                                             
                                          
                                          ≥
                                          0
                                       
                                    
                                 
                              which is equivalent to

                                 
                                    (100)
                                    
                                       
                                          
                                             ∑
                                             
                                                
                                                   
                                                      
                                                         d
                                                         ⊂
                                                         a
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                (
                                                −
                                                1
                                                )
                                             
                                             
                                                |
                                                d
                                                |
                                             
                                          
                                          
                                             ζ
                                             
                                                d
                                                ∪
                                                b
                                                ,
                                                
                                                   x
                                                   
                                                      d
                                                      ∪
                                                      b
                                                   
                                                   ′
                                                
                                             
                                          
                                          ≥
                                          0
                                          .
                                       
                                    
                                 
                              In order to obtain inequalities (41c) we need to show that for all 
                                 
                                    
                                       
                                          x
                                       
                                       c
                                       ′
                                    
                                    ∈
                                    
                                       
                                          X
                                          ˜
                                       
                                       c
                                    
                                    ,
                                 
                               by varying 
                                 
                                    
                                       x
                                       c
                                    
                                    ∈
                                    
                                       X
                                       c
                                    
                                    ,
                                 
                               the set 
                                 b
                               ranges over all subsets in 
                                 c
                               while at the same time 
                                 a
                               equals to 
                                 
                                    b
                                    ¯
                                 
                              . Since 
                                 
                                    
                                       
                                          x
                                       
                                       c
                                       ′
                                    
                                    ∈
                                    
                                       
                                          X
                                          ˜
                                       
                                       c
                                    
                                 
                               we have 
                                 
                                    
                                       x
                                       s
                                       ′
                                    
                                    ≠
                                    
                                       y
                                       s
                                       ′
                                    
                                 
                               for all 
                                 
                                    s
                                    ∈
                                    c
                                 
                              . An arbitrary given set 
                                 
                                    b
                                    ˜
                                 
                               can be realized by the choice 
                                 
                                    
                                       x
                                       s
                                    
                                    =
                                    
                                       x
                                       s
                                       ′
                                    
                                 
                               if 
                                 
                                    s
                                    ∈
                                    
                                       b
                                       ˜
                                    
                                 
                               and 
                                 
                                    
                                       x
                                       s
                                    
                                    =
                                    
                                       y
                                       s
                                    
                                 
                               otherwise. At the same time for this choice of x there holds 
                                 
                                    a
                                    =
                                    
                                       b
                                       ¯
                                    
                                 
                              .□


                              For
                              
                                 
                                    ζ
                                    ∈
                                    Z
                                 
                               
                              there holds
                              
                                 
                                    
                                       P
                                       ζ
                                       2
                                    
                                    =
                                    
                                       P
                                       
                                          ζ
                                          2
                                       
                                    
                                 
                              
                              .
                           

Let us calculate the expression of 
                                 
                                    
                                       (
                                       
                                          P
                                          2
                                       
                                       )
                                    
                                    
                                       c
                                       ,
                                       
                                          x
                                          
                                             c
                                             ,
                                          
                                       
                                       
                                          x
                                          c
                                          
                                             ′
                                             ′
                                          
                                       
                                    
                                 
                              . It is equal to

                                 
                                    (101a)
                                    
                                       
                                          
                                             
                                             
                                                
                                                   
                                                      ∑
                                                      
                                                         
                                                            x
                                                            
                                                               c
                                                            
                                                            ′
                                                         
                                                         ∈
                                                         
                                                            X
                                                            c
                                                         
                                                      
                                                   
                                                   
                                                      P
                                                      
                                                         c
                                                         ,
                                                         
                                                            x
                                                            
                                                               c
                                                               ,
                                                            
                                                         
                                                         
                                                            x
                                                            c
                                                            ′
                                                         
                                                      
                                                   
                                                   
                                                      P
                                                      
                                                         c
                                                         ,
                                                         
                                                            x
                                                            
                                                               c
                                                            
                                                            ′
                                                         
                                                         ,
                                                         
                                                            x
                                                            c
                                                            
                                                               ′
                                                               ′
                                                            
                                                         
                                                      
                                                   
                                                   =
                                                   
                                                      ∑
                                                      
                                                         
                                                            d
                                                            1
                                                         
                                                         ⊂
                                                         c
                                                      
                                                   
                                                   
                                                      ∑
                                                      
                                                         
                                                            d
                                                            2
                                                         
                                                         ⊂
                                                         c
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (101b)
                                    
                                       
                                          
                                             
                                             
                                                
                                                   
                                                      ∑
                                                      
                                                         
                                                            x
                                                            c
                                                            ′
                                                         
                                                         ∈
                                                         
                                                            X
                                                            c
                                                         
                                                      
                                                   
                                                   
                                                      ∏
                                                      
                                                         s
                                                         ∈
                                                         c
                                                      
                                                   
                                                   
                                                      c
                                                      
                                                         d
                                                         1
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         x
                                                         s
                                                      
                                                      ,
                                                      
                                                         x
                                                         s
                                                         ′
                                                      
                                                      )
                                                   
                                                   
                                                      c
                                                      
                                                         d
                                                         2
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         x
                                                         s
                                                         ′
                                                      
                                                      ,
                                                      
                                                         x
                                                         s
                                                         
                                                            ′
                                                            ′
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      ζ
                                                      
                                                         
                                                            d
                                                            1
                                                         
                                                         ,
                                                         
                                                            x
                                                            
                                                               d
                                                               1
                                                            
                                                            ′
                                                         
                                                      
                                                   
                                                   
                                                      ζ
                                                      
                                                         
                                                            d
                                                            2
                                                         
                                                         ,
                                                         
                                                            x
                                                            
                                                               d
                                                               2
                                                            
                                                            
                                                               ′
                                                               ′
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

The expression in line (101b) factors as

                                 
                                    (102a)
                                    
                                       
                                          
                                             
                                             
                                                
                                                   (
                                                   
                                                      ∑
                                                      
                                                         
                                                            x
                                                            
                                                               d
                                                               1
                                                            
                                                            ′
                                                         
                                                         ∈
                                                         
                                                            X
                                                            
                                                               d
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      ∏
                                                      
                                                         s
                                                         ∈
                                                         
                                                            d
                                                            1
                                                         
                                                      
                                                   
                                                   
                                                      c
                                                      
                                                         d
                                                         1
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         x
                                                         s
                                                      
                                                      ,
                                                      
                                                         x
                                                         s
                                                         ′
                                                      
                                                      )
                                                   
                                                   
                                                      c
                                                      
                                                         d
                                                         2
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         x
                                                         s
                                                         ′
                                                      
                                                      ,
                                                      
                                                         x
                                                         s
                                                         
                                                            ′
                                                            ′
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      ζ
                                                      
                                                         
                                                            d
                                                            1
                                                         
                                                         ,
                                                         
                                                            x
                                                            
                                                               d
                                                               1
                                                            
                                                            ′
                                                         
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (102b)
                                    
                                       
                                          
                                             
                                             
                                                
                                                   
                                                      (
                                                      
                                                         ∏
                                                         
                                                            
                                                               s
                                                               ∈
                                                               c
                                                               ∖
                                                            
                                                            
                                                               d
                                                               1
                                                            
                                                         
                                                      
                                                      
                                                         ∑
                                                         
                                                            
                                                               x
                                                               s
                                                               ′
                                                            
                                                            ∈
                                                            
                                                               X
                                                               s
                                                            
                                                         
                                                      
                                                      
                                                         c
                                                         
                                                            d
                                                            1
                                                         
                                                      
                                                      
                                                         (
                                                         
                                                            x
                                                            s
                                                         
                                                         ,
                                                         
                                                            x
                                                            s
                                                            ′
                                                         
                                                         )
                                                      
                                                      
                                                         c
                                                         
                                                            d
                                                            2
                                                         
                                                      
                                                      
                                                         (
                                                         
                                                            x
                                                            s
                                                            ′
                                                         
                                                         ,
                                                         
                                                            x
                                                            s
                                                            
                                                               ′
                                                               ′
                                                            
                                                         
                                                         )
                                                      
                                                      )
                                                   
                                                   
                                                      (
                                                      
                                                         ζ
                                                         
                                                            
                                                               d
                                                               2
                                                            
                                                            ,
                                                            
                                                               x
                                                               
                                                                  d
                                                                  2
                                                               
                                                               
                                                                  ′
                                                                  ′
                                                               
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

The term of the second factor for 
                                 
                                    
                                       s
                                       ∈
                                       c
                                       ∖
                                    
                                    
                                       d
                                       1
                                    
                                 
                               equals

                                 
                                    •
                                    Case 
                                          
                                             s
                                             ∉
                                             
                                                d
                                                1
                                             
                                             ,
                                          
                                       
                                       
                                          
                                             s
                                             ∈
                                             
                                                d
                                                2
                                             
                                          
                                       :

                                          
                                             (103)
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               ∑
                                                               
                                                                  x
                                                                  s
                                                                  ′
                                                               
                                                            
                                                            〚
                                                            
                                                               y
                                                               s
                                                            
                                                            =
                                                            
                                                               x
                                                               s
                                                            
                                                            〛
                                                            
                                                               (
                                                               −
                                                               〚
                                                               
                                                                  y
                                                                  s
                                                               
                                                               =
                                                               
                                                                  x
                                                                  s
                                                                  ′
                                                               
                                                               〛
                                                               +
                                                               〚
                                                               
                                                                  x
                                                                  s
                                                                  
                                                                     ′
                                                                     ′
                                                                  
                                                               
                                                               =
                                                               
                                                                  x
                                                                  s
                                                                  ′
                                                               
                                                               〛
                                                               )
                                                            
                                                            =
                                                            0
                                                            .
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    

Case 
                                          
                                             s
                                             ∉
                                             
                                                d
                                                1
                                             
                                             ,
                                          
                                       
                                       
                                          
                                             s
                                             ∉
                                             
                                                d
                                                2
                                             
                                          
                                       :

                                          
                                             (104)
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               ∑
                                                               
                                                                  x
                                                                  s
                                                                  ′
                                                               
                                                            
                                                            〚
                                                            
                                                               y
                                                               s
                                                            
                                                            =
                                                            
                                                               x
                                                               s
                                                            
                                                            〛
                                                            〚
                                                            
                                                               y
                                                               s
                                                            
                                                            =
                                                            
                                                               x
                                                               s
                                                               ′
                                                            
                                                            〛
                                                            =
                                                            〚
                                                            
                                                               y
                                                               s
                                                            
                                                            =
                                                            
                                                               x
                                                               s
                                                            
                                                            〛
                                                            .
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    

It follows from (103) that for 
                                 
                                    
                                       d
                                       2
                                    
                                    ¬
                                    ⊂
                                    
                                       d
                                       1
                                    
                                 
                               the factors vanish and hence expression (101b) vanishes. In the first factor the coefficient 
                                 
                                    
                                       c
                                       
                                          d
                                          1
                                       
                                    
                                    
                                       (
                                       
                                          x
                                          s
                                       
                                       ,
                                       
                                          x
                                          s
                                          ′
                                       
                                       )
                                    
                                    
                                       c
                                       
                                          d
                                          2
                                       
                                    
                                    
                                       (
                                       
                                          x
                                          s
                                          ′
                                       
                                       ,
                                       
                                          x
                                          s
                                          
                                             ′
                                             ′
                                          
                                       
                                       )
                                    
                                 
                               expresses as:

                                 
                                    •
                                    Case 
                                          
                                             s
                                             ∈
                                             
                                                d
                                                1
                                             
                                             ,
                                          
                                       
                                       
                                          
                                             s
                                             ∈
                                             
                                                d
                                                2
                                             
                                          
                                       :

                                          
                                             (105)
                                             
                                                
                                                   
                                                      
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               (
                                                               −
                                                               〚
                                                               
                                                                  y
                                                                  s
                                                               
                                                               =
                                                               
                                                                  x
                                                                  s
                                                               
                                                               〛
                                                               +
                                                               〚
                                                               
                                                                  x
                                                                  s
                                                                  ′
                                                               
                                                               =
                                                               
                                                                  x
                                                                  s
                                                               
                                                               〛
                                                               )
                                                            
                                                            
                                                               (
                                                               −
                                                               〚
                                                               
                                                                  y
                                                                  s
                                                               
                                                               =
                                                               
                                                                  x
                                                                  s
                                                                  ′
                                                               
                                                               〛
                                                               +
                                                               〚
                                                               
                                                                  x
                                                                  s
                                                                  
                                                                     ′
                                                                     ′
                                                                  
                                                               
                                                               =
                                                               
                                                                  x
                                                                  s
                                                                  ′
                                                               
                                                               〛
                                                               )
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                      
                                                         
                                                            =
                                                            
                                                               (
                                                               −
                                                               〚
                                                               
                                                                  y
                                                                  s
                                                               
                                                               =
                                                               
                                                                  x
                                                                  s
                                                               
                                                               〛
                                                               +
                                                               〚
                                                               
                                                                  x
                                                                  s
                                                                  
                                                                     ′
                                                                     ′
                                                                  
                                                               
                                                               =
                                                               
                                                                  x
                                                                  s
                                                               
                                                               〛
                                                               )
                                                            
                                                            〚
                                                            
                                                               x
                                                               s
                                                               ′
                                                            
                                                            =
                                                            
                                                               x
                                                               s
                                                               
                                                                  ′
                                                                  ′
                                                               
                                                            
                                                            〛
                                                            .
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    

Case 
                                          
                                             s
                                             ∈
                                             
                                                d
                                                1
                                             
                                             ,
                                          
                                       
                                       
                                          
                                             s
                                             ∉
                                             
                                                d
                                                2
                                             
                                          
                                       :

                                          
                                             (106)
                                             
                                                
                                                   
                                                      
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               (
                                                               −
                                                               〚
                                                               
                                                                  y
                                                                  s
                                                               
                                                               =
                                                               
                                                                  x
                                                                  s
                                                               
                                                               〛
                                                               +
                                                               〚
                                                               
                                                                  x
                                                                  s
                                                                  ′
                                                               
                                                               =
                                                               
                                                                  x
                                                                  s
                                                               
                                                               〛
                                                               )
                                                            
                                                            〚
                                                            
                                                               y
                                                               s
                                                            
                                                            =
                                                            
                                                               x
                                                               s
                                                               ′
                                                            
                                                            〛
                                                         
                                                      
                                                   
                                                   
                                                      
                                                      
                                                         
                                                            =
                                                            −
                                                            〚
                                                            
                                                               y
                                                               s
                                                            
                                                            =
                                                            
                                                               x
                                                               s
                                                            
                                                            =
                                                            
                                                               x
                                                               s
                                                               ′
                                                            
                                                            〛
                                                            +
                                                            〚
                                                            
                                                               x
                                                               s
                                                               ′
                                                            
                                                            =
                                                            
                                                               x
                                                               s
                                                            
                                                            =
                                                            
                                                               y
                                                               s
                                                            
                                                            〛
                                                            =
                                                            0
                                                            .
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    

Therefore, if 
                                 
                                    
                                       d
                                       1
                                    
                                    ¬
                                    ⊂
                                    
                                       d
                                       2
                                    
                                    ,
                                 
                               for each value of 
                                 
                                    x
                                    
                                       d
                                       1
                                    
                                    ′
                                 
                               the product 
                                 
                                    
                                       ∏
                                       
                                          s
                                          ∈
                                          
                                             d
                                             1
                                          
                                       
                                    
                                    
                                       c
                                       
                                          d
                                          1
                                       
                                    
                                    
                                       (
                                       
                                          x
                                          s
                                       
                                       ,
                                       
                                          x
                                          s
                                          ′
                                       
                                       )
                                    
                                    
                                       c
                                       
                                          d
                                          2
                                       
                                    
                                    
                                       (
                                       
                                          x
                                          s
                                          ′
                                       
                                       ,
                                       
                                          x
                                          s
                                          
                                             ′
                                             ′
                                          
                                       
                                       )
                                    
                                 
                               vanishes and hence the sum (102a) and the expression (101b) vanish. It follows that we need to count expression (101b) only for the case 
                                 
                                    
                                       d
                                       1
                                    
                                    =
                                    
                                       d
                                       2
                                    
                                    =
                                    :
                                    d
                                 
                              . In this case, carrying the summation over 
                                 
                                    x
                                    
                                       d
                                       1
                                    
                                    ′
                                 
                               in (102a) we obtain

                                 
                                    (107)
                                    
                                       
                                          
                                             ∏
                                             
                                                s
                                                ∈
                                                d
                                             
                                          
                                          
                                             (
                                             −
                                             〚
                                             
                                                y
                                                s
                                             
                                             =
                                             
                                                x
                                                s
                                             
                                             〛
                                             +
                                             〚
                                             
                                                x
                                                s
                                                
                                                   ′
                                                   ′
                                                
                                             
                                             =
                                             
                                                x
                                                s
                                             
                                             〛
                                             )
                                          
                                          
                                             ζ
                                             
                                                d
                                                ,
                                                
                                                   x
                                                   d
                                                   
                                                      ′
                                                      ′
                                                   
                                                
                                             
                                          
                                          .
                                       
                                    
                                 
                              From the full expression (101) there remains

                                 
                                    (108)
                                    
                                       
                                          
                                             
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                      
                                                         d
                                                         ⊂
                                                         c
                                                      
                                                   
                                                   
                                                      ∏
                                                      
                                                         s
                                                         ∈
                                                         d
                                                      
                                                   
                                                   
                                                      (
                                                      −
                                                      〚
                                                      
                                                         y
                                                         s
                                                      
                                                      =
                                                      
                                                         x
                                                         s
                                                      
                                                      〛
                                                      +
                                                      〚
                                                      
                                                         x
                                                         s
                                                         
                                                            ′
                                                            ′
                                                         
                                                      
                                                      =
                                                      
                                                         x
                                                         s
                                                      
                                                      〛
                                                      )
                                                   
                                                   
                                                      ∏
                                                      
                                                         s
                                                         ∈
                                                         c
                                                         ∖
                                                         d
                                                      
                                                   
                                                   〚
                                                   
                                                      y
                                                      s
                                                   
                                                   =
                                                   
                                                      x
                                                      s
                                                   
                                                   〛
                                                   
                                                      ζ
                                                      
                                                         d
                                                         ,
                                                         
                                                            x
                                                            d
                                                            
                                                               ′
                                                               ′
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      ζ
                                                      
                                                         d
                                                         ,
                                                         
                                                            x
                                                            d
                                                            
                                                               ′
                                                               ′
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                                
                                                   =
                                                   
                                                      ∑
                                                      
                                                         d
                                                         ⊂
                                                         c
                                                      
                                                   
                                                   
                                                      c
                                                      
                                                         c
                                                         ,
                                                         d
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         x
                                                         c
                                                         ′
                                                      
                                                      ,
                                                      
                                                         x
                                                         c
                                                         
                                                            ′
                                                            ′
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      ζ
                                                      
                                                         c
                                                         ,
                                                         
                                                            x
                                                            d
                                                            
                                                               ′
                                                               ′
                                                            
                                                         
                                                      
                                                      2
                                                   
                                                   =
                                                   
                                                      
                                                         (
                                                         
                                                            P
                                                            
                                                               ζ
                                                               2
                                                            
                                                         
                                                         )
                                                      
                                                      
                                                         c
                                                         ,
                                                         
                                                            x
                                                            c
                                                         
                                                         ,
                                                         
                                                            x
                                                            c
                                                            
                                                               ′
                                                               ′
                                                            
                                                         
                                                      
                                                   
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              The claim 
                                 
                                    
                                       
                                          (
                                          
                                             P
                                             ζ
                                          
                                          )
                                       
                                       2
                                    
                                    =
                                    
                                       P
                                       
                                          ζ
                                          2
                                       
                                    
                                 
                               is proven.□


                        
                           Lemma 3.1
                           
                              Node-wise mapping [p] preserves the local polytope Λ.
                           

Clearly, [p] preserves non-negativity. Let μ satisfy marginalization constraint (52) for some 
                                 
                                    c
                                    ∈
                                    E
                                    ,
                                 
                              
                              
                                 
                                    d
                                    ⊊
                                    c
                                 
                               and 
                                 
                                    
                                       x
                                       d
                                    
                                    ∈
                                    
                                       X
                                       d
                                    
                                 
                              . Then

                                 
                                    (109a)
                                    
                                       
                                          
                                             
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                      
                                                         x
                                                         
                                                            c
                                                            ∖
                                                            d
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         (
                                                         
                                                            [
                                                            p
                                                            ]
                                                         
                                                         μ
                                                         )
                                                      
                                                      c
                                                   
                                                   
                                                      (
                                                      
                                                         x
                                                         c
                                                      
                                                      )
                                                   
                                                   =
                                                   
                                                      ∑
                                                      
                                                         x
                                                         
                                                            c
                                                            ∖
                                                            d
                                                         
                                                      
                                                   
                                                   
                                                      ∑
                                                      
                                                         
                                                            x
                                                            c
                                                            ′
                                                         
                                                         ∈
                                                         
                                                            X
                                                            c
                                                         
                                                      
                                                   
                                                   〚
                                                   
                                                      p
                                                      c
                                                   
                                                   
                                                      (
                                                      
                                                         x
                                                         c
                                                         ′
                                                      
                                                      )
                                                   
                                                   =
                                                   
                                                      x
                                                      c
                                                   
                                                   〛
                                                   
                                                      μ
                                                      c
                                                   
                                                   
                                                      (
                                                      
                                                         x
                                                         c
                                                         ′
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                                
                                                   =
                                                   
                                                      ∑
                                                      
                                                         x
                                                         c
                                                         ′
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         ∑
                                                         
                                                            x
                                                            
                                                               c
                                                               ∖
                                                               d
                                                            
                                                         
                                                      
                                                      〚
                                                      
                                                         p
                                                         c
                                                      
                                                      
                                                         (
                                                         
                                                            x
                                                            c
                                                            ′
                                                         
                                                         )
                                                      
                                                      =
                                                      
                                                         x
                                                         c
                                                      
                                                      〛
                                                      )
                                                   
                                                   
                                                      μ
                                                      c
                                                   
                                                   
                                                      (
                                                      
                                                         x
                                                         c
                                                         ′
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (109b)
                                    
                                       
                                          
                                             
                                             
                                                
                                                   =
                                                   
                                                      ∑
                                                      
                                                         x
                                                         c
                                                         ′
                                                      
                                                   
                                                   〚
                                                   
                                                      p
                                                      d
                                                   
                                                   
                                                      (
                                                      
                                                         x
                                                         d
                                                         ′
                                                      
                                                      )
                                                   
                                                   =
                                                   
                                                      x
                                                      d
                                                   
                                                   〛
                                                   
                                                      μ
                                                      c
                                                   
                                                   
                                                      (
                                                      
                                                         x
                                                         c
                                                         ′
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (109c)
                                    
                                       
                                          
                                             
                                             
                                                
                                                   =
                                                   
                                                      ∑
                                                      
                                                         
                                                            x
                                                            d
                                                            ′
                                                         
                                                         ∈
                                                         
                                                            X
                                                            d
                                                         
                                                      
                                                   
                                                   〚
                                                   
                                                      p
                                                      d
                                                   
                                                   
                                                      (
                                                      
                                                         x
                                                         d
                                                         ′
                                                      
                                                      )
                                                   
                                                   =
                                                   
                                                      x
                                                      d
                                                   
                                                   〛
                                                   
                                                      μ
                                                      d
                                                   
                                                   
                                                      (
                                                      
                                                         x
                                                         d
                                                         ′
                                                      
                                                      )
                                                   
                                                   =
                                                   
                                                      
                                                         (
                                                         
                                                            [
                                                            p
                                                            ]
                                                         
                                                         μ
                                                         )
                                                      
                                                      d
                                                   
                                                   
                                                      (
                                                      
                                                         x
                                                         d
                                                      
                                                      )
                                                   
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           


                              □


                              Mapping Pζ for
                              
                                 
                                    ζ
                                    ∈
                                    Z
                                 
                               
                              preserves the local polytope: Pζ
                              (Λ) ⊂ Λ.
                           

We need to prove that (∀μ ∈ Λ)

                                 
                                    (110a)
                                    
                                       
                                          
                                             
                                             
                                                
                                                   
                                                      
                                                         (
                                                         
                                                            P
                                                            ζ
                                                         
                                                         μ
                                                         )
                                                      
                                                      ∅
                                                   
                                                   =
                                                   1
                                                   ;
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (110b)
                                    
                                       
                                          
                                             
                                             
                                                
                                                   
                                                      P
                                                      ζ
                                                   
                                                   μ
                                                   ≥
                                                   0
                                                   ;
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (110c)
                                    
                                       
                                          
                                             
                                             
                                                
                                                   A
                                                   
                                                      P
                                                      ζ
                                                   
                                                   μ
                                                   =
                                                   0
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

Constraints (110a), (110b) are satisfied for any relaxation polytope (same as (43)). Constraint (110c) is local: for each 
                                 
                                    c
                                    ⊂
                                    E
                                 
                               it is given by equalities (52) for 
                                 
                                    
                                       
                                          (
                                          P
                                          μ
                                          )
                                       
                                       c
                                    
                                    ,
                                 
                               and hence involves only 
                                 
                                    (
                                    
                                       ζ
                                       d
                                    
                                    
                                    |
                                    
                                    d
                                    ⊂
                                    c
                                    )
                                 
                              . This constraint holds for all integer ζ by Lemma 3.1 and thus also for all 
                                 
                                    ζ
                                    ∈
                                    Z
                                 
                              .□


                              For a local relaxation Λ all of the following are equivalent:
                              
                                 
                                    (a)
                                    
                                       
                                          
                                             P
                                             ∈
                                             
                                                W
                                                f
                                             
                                             
                                          
                                       
                                       ;
                                    


                                       
                                          
                                             
                                                (
                                                ∃
                                                φ
                                                ∈
                                                
                                                   R
                                                   m
                                                
                                                )
                                             
                                             
                                             
                                                f
                                                φ
                                             
                                             −
                                             
                                                P
                                                T
                                             
                                             f
                                             ≥
                                             0
                                          
                                       
                                       ;
                                    


                                       
                                          
                                             
                                                (
                                                ∃
                                                φ
                                                ∈
                                                
                                                   R
                                                   m
                                                
                                                )
                                             
                                             
                                             
                                                (
                                                I
                                                −
                                                
                                                   P
                                                   T
                                                
                                                )
                                             
                                             
                                                f
                                                φ
                                             
                                             ≥
                                             0
                                          
                                       
                                       ;
                                    


                                       
                                          
                                             inf
                                             {
                                             
                                                〈
                                                f
                                                −
                                                
                                                   P
                                                   T
                                                
                                                f
                                                ,
                                                μ
                                                〉
                                             
                                             
                                             |
                                             
                                             μ
                                             ∈
                                             
                                                R
                                                +
                                                I
                                             
                                             ,
                                             
                                             
                                             A
                                             
                                                (
                                                I
                                                −
                                                P
                                                )
                                             
                                             μ
                                             =
                                             0
                                             }
                                             =
                                             0
                                          
                                       
                                       .
                                    

We already have (a) ⇔ (b) by Theorem 2.8 and (a) ⇒ (d) ⇔ (c) by Theorem 2.10 (equivalence is the duality relation discussed in the proof). Let us prove (c) ⇒ (a). Let μ ∈ Λ. We multiply component inequalities (c) with non-negative numbers 
                                 
                                    
                                       μ
                                       c
                                    
                                    
                                       (
                                       
                                          x
                                          c
                                       
                                       )
                                    
                                 
                               and sum over 
                                 
                                    x
                                    c
                                 
                               and 
                                 c
                              . We get inequality

                                 
                                    
                                       
                                          
                                             〈
                                             
                                                P
                                                T
                                             
                                             f
                                             ,
                                             μ
                                             〉
                                          
                                          −
                                          
                                             〈
                                             
                                                P
                                                T
                                             
                                             
                                                A
                                                T
                                             
                                             φ
                                             ,
                                             μ
                                             〉
                                          
                                          ≤
                                          
                                             〈
                                             f
                                             ,
                                             μ
                                             〉
                                          
                                          −
                                          
                                             〈
                                             
                                                A
                                                T
                                             
                                             φ
                                             ,
                                             μ
                                             〉
                                          
                                          .
                                       
                                    
                                 
                              The sum 
                                 
                                    
                                       〈
                                       
                                          A
                                          T
                                       
                                       φ
                                       ,
                                       μ
                                       〉
                                    
                                    =
                                    
                                       〈
                                       φ
                                       ,
                                       A
                                       μ
                                       〉
                                    
                                 
                               vanishes because 
                                 
                                    A
                                    μ
                                    =
                                    0
                                 
                               and similarly 
                                 
                                    
                                       〈
                                       
                                          P
                                          T
                                       
                                       
                                          A
                                          T
                                       
                                       φ
                                       ,
                                       μ
                                       〉
                                    
                                    =
                                    
                                       〈
                                       φ
                                       ,
                                       A
                                       P
                                       μ
                                       〉
                                    
                                    =
                                    0
                                 
                               since by Lemma 3.1 
                              Pμ ∈ Λ and thus 
                                 
                                    A
                                    P
                                    μ
                                    =
                                    0
                                 
                              . The remaining inequality proves that 
                                 
                                    P
                                    ∈
                                    
                                       W
                                       f
                                    
                                    
                                 
                              .□


                        
                           Theorem 3.4
                           
                              Problem (
                              
                                 max-WI
                              
                              ) over the
                              
                                 
                                    P
                                    1
                                 
                               
                              class of maps and the BLP relaxation is solvable in polynomial time for the quadratic pseudo-Boolean case and otherwise (when the problem is multilabel or higher order) it is NP-hard.
                           

In the quadratic pseudo-Boolean case the solution is given by the optimal relaxed labeling with the maximum number of integer components. For a more special case of vertex packing problem it was proven polynomial by Picard and Queyranne [46], whose proof we extended in [55, Statement 5]. For the general quadratic pseudo-Boolean case, the solution can be found efficiently by analyzing connected components in the network flow model [7], [32, §2.3].

Next we prove that (max-WI) is NP-hard if either: there are more than two labels or the order of the problem is 2 (cubic terms) or higher. We use reduction from pairwise constraint satisfaction problem (CSP) which is NP-complete when variables can take 3 or more values or when constraints can couple 3 or more variables at a time (this case includes 3-SAT). This problem can be represented as energy minimization with constraints 
                                 
                                    
                                       f
                                       c
                                    
                                    :
                                    
                                       X
                                       c
                                    
                                    →
                                    
                                       {
                                       0
                                       ,
                                       1
                                       }
                                    
                                 
                              . The CSP is satisfiable iff the minimum of the energy is zero. Let V be the value of the LP-relaxation. Then either it is larger than zero and in this case the CSP is not satisfiable or it equals zero. In the latter case, the CSP is satisfiable iff there exists an integer solution with cost zero, i.e., the relaxation is tight. This is the case iff (max-WI) determines all variables as persistent. Thus if (max-WI) was in P we could solve CSP, which is a contradiction.□


                              Problem (max-SI) with 4 or more labels over the class of maps
                              
                                 
                                    
                                       P
                                       2
                                    
                                    =
                                    
                                       ⋃
                                       
                                          y
                                          ∈
                                          X
                                       
                                    
                                    
                                       P
                                       
                                          2
                                          ,
                                          y
                                       
                                    
                                 
                               
                              and BLP relaxation is NP-hard.
                           

We again use a reduction from CSP with 3 labels, 
                                 
                                    
                                       X
                                       s
                                    
                                    =
                                    
                                       {
                                       1
                                       ,
                                       2
                                       ,
                                       3
                                       }
                                    
                                 
                              . Let the constraints of CSP be defined by 
                                 
                                    
                                       g
                                       c
                                    
                                    :
                                    
                                       X
                                       c
                                    
                                    →
                                    
                                       {
                                       0
                                       ,
                                       1
                                       }
                                    
                                 
                              . We construct an energy minimization problem with 4 labels as follows:

                                 
                                    (111)
                                    
                                       
                                          
                                             f
                                             c
                                          
                                          
                                             (
                                             
                                                x
                                                c
                                             
                                             )
                                          
                                          =
                                          
                                             {
                                             
                                                
                                                   
                                                      
                                                         
                                                            g
                                                            c
                                                         
                                                         
                                                            (
                                                            
                                                               x
                                                               c
                                                            
                                                            )
                                                         
                                                         ,
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            x
                                                            c
                                                         
                                                         ∈
                                                         
                                                            
                                                               {
                                                               1
                                                               ,
                                                               2
                                                               ,
                                                               3
                                                               }
                                                            
                                                            c
                                                         
                                                         ;
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         ɛ
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            x
                                                            c
                                                         
                                                         =
                                                         
                                                            4
                                                            c
                                                         
                                                         ;
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         B
                                                         ,
                                                      
                                                   
                                                   
                                                      
                                                         
                                                         otherwise
                                                         ,
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              where 
                                 
                                    B
                                    >
                                    |
                                    E
                                    |
                                 
                               and 
                                 
                                    
                                       ɛ
                                    
                                    <
                                    1
                                    /
                                    |
                                    E
                                    |
                                 
                              . Let V be the value of the BLP relaxation. If it is larger than zero, then the CSP is not satisfiable. Otherwise, the relaxation is tight iff the CSP is satisfiable. It is clear that if an integer solution of zero cost y
                              * exists, it must take values in {1, 2, 3}. If it exists, then mapping 
                                 
                                    
                                       p
                                       s
                                    
                                    :
                                    
                                       (
                                       1
                                       ,
                                       2
                                       ,
                                       3
                                       ,
                                       4
                                       )
                                    
                                    ↦
                                    
                                       (
                                       1
                                       ,
                                       2
                                       ,
                                       3
                                       ,
                                       
                                          y
                                          s
                                          *
                                       
                                       )
                                    
                                 
                               is strictly relaxed improving as it replaces components of cost ε > 0 with components of cost 0. Let q be the maximum strict relaxed improving mapping in class 
                                 
                                    P
                                    2
                                 
                              . Let 
                                 
                                    
                                       x
                                       s
                                    
                                    =
                                    4
                                 
                               for all 
                                 
                                    s
                                    ∈
                                    V
                                 
                              . If 
                                 
                                    (
                                    ∃
                                    s
                                    ∈
                                    V
                                    )
                                 
                              
                              
                                 
                                    q
                                    
                                       
                                          (
                                          x
                                          )
                                       
                                       s
                                    
                                    =
                                    4
                                    ,
                                 
                               then the CSP is not satisfiable, as q is not larger than p. Otherwise 
                                 
                                    (
                                    ∀
                                    s
                                    ∈
                                    V
                                    )
                                 
                               
                              q(x)
                                 s
                               ≠ 4 and 
                                 
                                    
                                       E
                                       f
                                    
                                    
                                       (
                                       q
                                       
                                          (
                                          x
                                          )
                                       
                                       )
                                    
                                    <
                                    
                                       |
                                       E
                                       |
                                    
                                    
                                       ɛ
                                    
                                    <
                                    1
                                 
                              . It follows that 
                                 
                                    g
                                    (
                                    q
                                    (
                                    x
                                    )
                                    )
                                    =
                                    0
                                 
                               and hence q(x) is a solution to CSP. We showed that CSP was reduced in polynomial time to (max-SI) .□


                        
                           Theorem 4.5
                           
                              Persistency by method
                              
                                 [64]
                               
                              in the pairwise multilabel case corresponds to an FLP-improving mapping.
                           

The method constructs a subset 
                                 
                                    A
                                    ⊂
                                    V
                                    ,
                                 
                               a labeling y on 
                                 A
                               and an auxiliary energy Eg
                               defined by:

                                 
                                    (112)
                                    
                                       
                                          
                                             
                                                
                                                   (
                                                   ∀
                                                   s
                                                   ∈
                                                   A
                                                   )
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      g
                                                      s
                                                   
                                                   =
                                                   
                                                      f
                                                      s
                                                   
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                                
                                                   (
                                                   ∀
                                                   s
                                                   t
                                                   ∈
                                                   E
                                                   ,
                                                   
                                                   s
                                                   ∈
                                                   A
                                                   ,
                                                   t
                                                   ∈
                                                   A
                                                   )
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      g
                                                      
                                                         s
                                                         t
                                                      
                                                   
                                                   =
                                                   
                                                      f
                                                      
                                                         s
                                                         t
                                                      
                                                   
                                                   ,
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (113)
                                    
                                       
                                          
                                             
                                                
                                             
                                             
                                                
                                                   (
                                                   ∀
                                                   s
                                                   t
                                                   ∈
                                                   E
                                                   ,
                                                   
                                                   s
                                                   ∈
                                                   A
                                                   ,
                                                   t
                                                   ∉
                                                   A
                                                   ,
                                                   
                                                   ∀
                                                   i
                                                   j
                                                   )
                                                   
                                                
                                             
                                             
                                          
                                          
                                             
                                             
                                                
                                                   
                                                      g
                                                      
                                                         s
                                                         t
                                                      
                                                   
                                                   
                                                      (
                                                      i
                                                      ,
                                                      j
                                                      )
                                                   
                                                   =
                                                   
                                                      {
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        max
                                                                        
                                                                           
                                                                              j
                                                                              ′
                                                                           
                                                                           ∈
                                                                           
                                                                              X
                                                                              t
                                                                           
                                                                        
                                                                     
                                                                     
                                                                        f
                                                                        
                                                                           s
                                                                           t
                                                                        
                                                                     
                                                                     
                                                                        (
                                                                        i
                                                                        ,
                                                                        
                                                                           j
                                                                           ′
                                                                        
                                                                        )
                                                                     
                                                                     ,
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  i
                                                                  =
                                                                  
                                                                     y
                                                                     s
                                                                  
                                                                  ,
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     min
                                                                     
                                                                        
                                                                           j
                                                                           ′
                                                                        
                                                                        ∈
                                                                        
                                                                           X
                                                                           t
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     f
                                                                     
                                                                        s
                                                                        t
                                                                     
                                                                  
                                                                  
                                                                     (
                                                                     i
                                                                     ,
                                                                     
                                                                        j
                                                                        ′
                                                                     
                                                                     )
                                                                  
                                                                  ,
                                                               
                                                            
                                                            
                                                               
                                                                  i
                                                                  ≠
                                                                  
                                                                     y
                                                                     s
                                                                  
                                                                  ,
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              with remaining terms set to zero. It can be seen that energy Eg
                               depends on the assignment of y only on the boundary
                              
                                 
                                    ∂
                                    A
                                    =
                                    {
                                    s
                                    ∈
                                    A
                                    
                                    |
                                    
                                    (
                                    ∃
                                    t
                                    ∈
                                    V
                                    ∖
                                    A
                                    )
                                    
                                    {
                                    s
                                    ,
                                    t
                                    }
                                    ∈
                                    E
                                    }
                                 
                              . Let us extend y to 
                                 V
                               in an arbitrary way, e.g., by 
                                 
                                    
                                       y
                                       
                                          V
                                          ∖
                                          A
                                       
                                    
                                    =
                                    0
                                 
                              . The sufficient condition of [64, Corollary 1] implies that 
                                 
                                    δ
                                    
                                       (
                                       y
                                       )
                                    
                                    ∈
                                    
                                       argmin
                                       
                                          μ
                                          ∈
                                          Λ
                                       
                                    
                                    
                                       〈
                                       g
                                       ,
                                       μ
                                       〉
                                    
                                 
                               (the relaxation is tight). We construct mapping p as

                                 
                                    (114)
                                    
                                       
                                          
                                             p
                                             s
                                          
                                          
                                             (
                                             i
                                             )
                                          
                                          =
                                          
                                             {
                                             
                                                
                                                   
                                                      
                                                         y
                                                         s
                                                      
                                                   
                                                   
                                                      
                                                         
                                                         if
                                                         
                                                         s
                                                         ∈
                                                         A
                                                         ,
                                                      
                                                   
                                                
                                                
                                                   
                                                      i
                                                   
                                                   
                                                      
                                                         
                                                         if
                                                         
                                                         s
                                                         ∉
                                                         A
                                                         ,
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              i.e., p replaces part of a labeling x on 
                                 A
                               with the labeling y. This mapping is illustrated in Fig. 11. We claim that mapping p is relaxed-improving.

We first show that g is auxiliary for f, i.e.,

                                 
                                    (115)
                                    
                                       
                                          
                                             (
                                             ∀
                                             μ
                                             ∈
                                             Λ
                                             )
                                          
                                          
                                          
                                          
                                             〈
                                             
                                                
                                                   (
                                                   I
                                                   −
                                                   P
                                                   )
                                                
                                                T
                                             
                                             f
                                             ,
                                             μ
                                             〉
                                          
                                          ≥
                                          
                                             〈
                                             
                                                
                                                   (
                                                   I
                                                   −
                                                   P
                                                   )
                                                
                                                T
                                             
                                             g
                                             ,
                                             μ
                                             〉
                                          
                                          .
                                       
                                    
                                 
                              We trivially have 
                                 
                                    
                                       f
                                       s
                                    
                                    
                                       (
                                       i
                                       )
                                    
                                    −
                                    
                                       f
                                       s
                                    
                                    
                                       (
                                       
                                          p
                                          s
                                       
                                       
                                          (
                                          i
                                          )
                                       
                                       )
                                    
                                    =
                                    
                                       g
                                       s
                                    
                                    
                                       (
                                       i
                                       )
                                    
                                    −
                                    
                                       g
                                       s
                                    
                                    
                                       (
                                       
                                          p
                                          s
                                       
                                       
                                          (
                                          i
                                          )
                                       
                                       )
                                    
                                 
                              . We also have equality of pairwise terms

                                 
                                    
                                       
                                          
                                             f
                                             
                                                s
                                                t
                                             
                                          
                                          
                                             (
                                             i
                                             ,
                                             j
                                             )
                                          
                                          −
                                          
                                             f
                                             
                                                s
                                                t
                                             
                                          
                                          
                                             (
                                             
                                                p
                                                s
                                             
                                             
                                                (
                                                i
                                                )
                                             
                                             ,
                                             
                                                p
                                                t
                                             
                                             
                                                (
                                                j
                                                )
                                             
                                             )
                                          
                                          =
                                          
                                             g
                                             
                                                s
                                                t
                                             
                                          
                                          
                                             (
                                             i
                                             ,
                                             j
                                             )
                                          
                                          −
                                          
                                             g
                                             
                                                s
                                                t
                                             
                                          
                                          
                                             (
                                             
                                                p
                                                s
                                             
                                             
                                                (
                                                i
                                                )
                                             
                                             ,
                                             
                                                p
                                                t
                                             
                                             
                                                (
                                                j
                                                )
                                             
                                             )
                                          
                                       
                                    
                                 
                              for 
                                 
                                    s
                                    t
                                    ∈
                                    E
                                 
                               in all of the following cases:

                                 
                                    (a)
                                    
                                       
                                          
                                             s
                                             ∈
                                             A
                                          
                                        and 
                                          
                                             t
                                             ∈
                                             A
                                          
                                       ;


                                       
                                          
                                             s
                                             ∉
                                             A
                                          
                                        and 
                                          
                                             t
                                             ∉
                                             A
                                          
                                       ;


                                       
                                          
                                             s
                                             ∈
                                             A
                                          
                                        and 
                                          
                                             t
                                             ∉
                                             A
                                             ,
                                          
                                       
                                       
                                          
                                             i
                                             =
                                             
                                                y
                                                s
                                             
                                          
                                       .

It remains to verify the inequality for boundary pairs 
                                 
                                    s
                                    ∈
                                    A
                                    ,
                                 
                              
                              
                                 
                                    t
                                    ∉
                                    A
                                 
                               in the case i ≠ ys
                              . We have

                                 
                                    (116)
                                    
                                       
                                          
                                             
                                             
                                                
                                                   
                                                      f
                                                      
                                                         s
                                                         t
                                                      
                                                   
                                                   
                                                      (
                                                      i
                                                      ,
                                                      j
                                                      )
                                                   
                                                   −
                                                   
                                                      f
                                                      
                                                         s
                                                         t
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         p
                                                         s
                                                      
                                                      
                                                         (
                                                         i
                                                         )
                                                      
                                                      ,
                                                      
                                                         p
                                                         t
                                                      
                                                      
                                                         (
                                                         j
                                                         )
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                                
                                                   ≥
                                                   
                                                      min
                                                      
                                                         
                                                            j
                                                            ′
                                                         
                                                         ∈
                                                         
                                                            X
                                                            t
                                                         
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         f
                                                         
                                                            s
                                                            t
                                                         
                                                      
                                                      
                                                         (
                                                         i
                                                         ,
                                                         
                                                            j
                                                            ′
                                                         
                                                         )
                                                      
                                                      −
                                                      
                                                         f
                                                         
                                                            s
                                                            t
                                                         
                                                      
                                                      
                                                         (
                                                         
                                                            p
                                                            s
                                                         
                                                         
                                                            (
                                                            i
                                                            )
                                                         
                                                         ,
                                                         
                                                            p
                                                            t
                                                         
                                                         
                                                            (
                                                            
                                                               j
                                                               ′
                                                            
                                                            )
                                                         
                                                         )
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             
                                                ≥
                                             
                                             
                                                
                                                   
                                                      min
                                                      
                                                         j
                                                         ′
                                                      
                                                   
                                                   
                                                      f
                                                      
                                                         s
                                                         t
                                                      
                                                   
                                                   
                                                      (
                                                      i
                                                      ,
                                                      
                                                         j
                                                         ′
                                                      
                                                      )
                                                   
                                                   −
                                                   
                                                      max
                                                      
                                                         j
                                                         ′
                                                      
                                                   
                                                   
                                                      f
                                                      
                                                         s
                                                         t
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         y
                                                         s
                                                      
                                                      ,
                                                      
                                                         p
                                                         t
                                                      
                                                      
                                                         (
                                                         
                                                            j
                                                            ′
                                                         
                                                         )
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                                
                                                   =
                                                   
                                                      g
                                                      
                                                         s
                                                         t
                                                      
                                                   
                                                   
                                                      (
                                                      i
                                                      ,
                                                      j
                                                      )
                                                   
                                                   −
                                                   
                                                      g
                                                      
                                                         s
                                                         t
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         p
                                                         s
                                                      
                                                      
                                                         (
                                                         i
                                                         )
                                                      
                                                      ,
                                                      
                                                         p
                                                         t
                                                      
                                                      
                                                         (
                                                         j
                                                         )
                                                      
                                                      )
                                                   
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              Because component-wise inequalities hold it follows that (115) holds.

The second step is to show that p is relaxed-improving for g. By assumption, we have 
                                 
                                    δ
                                    
                                       (
                                       y
                                       )
                                    
                                    ∈
                                    
                                       argmin
                                       
                                          μ
                                          ∈
                                          Λ
                                       
                                    
                                    
                                       〈
                                       g
                                       ,
                                       μ
                                       〉
                                    
                                 
                              . Given a labeling x, mapping p replaces part over 
                                 A
                               to the optimal labeling y. It follows that (∀μ ∈ Λ) 
                                 
                                    〈
                                    g
                                    ,
                                    P
                                    μ
                                    〉
                                    =
                                    〈
                                    g
                                    ,
                                    δ
                                    (
                                    y
                                    )
                                    〉
                                    ≤
                                    〈
                                    g
                                    ,
                                    μ
                                    〉
                                 
                              . Combining this inequality with (115), we obtain that 
                                 
                                    
                                       [
                                       p
                                       ]
                                    
                                    ∈
                                    
                                       W
                                       f
                                    
                                    
                                 
                              .□

In this section we define a sufficient set of atomic reductions to represent methods [15,22]. We first define a rather general reduction.

                           Definition A.1
                           An injective reduction is a procedure that for a given energy minimization problem described by 
                                 
                                    V
                                    ,
                                    E
                                    ,
                                    X
                                    ,
                                    f
                                 
                               specifies:

                                 
                                    •
                                    The reduced energy minimization problem described by 
                                          
                                             
                                                V
                                                ′
                                             
                                             ,
                                             
                                                E
                                                ′
                                             
                                             ,
                                             
                                                X
                                                ′
                                             
                                             ,
                                             
                                                f
                                                ′
                                             
                                          
                                       ;

An injective mapping 
                                          
                                             π
                                             :
                                             X
                                             →
                                             
                                                X
                                                ′
                                             
                                          
                                       ;

A left inverse of π, mapping 
                                          
                                             σ
                                             :
                                             dom
                                             (
                                             σ
                                             )
                                             →
                                             X
                                             ,
                                          
                                        where 
                                          
                                             
                                                X
                                                ′
                                             
                                             ⊃
                                             dom
                                             
                                                (
                                                σ
                                                )
                                             
                                             ⊃
                                             π
                                             
                                                (
                                                X
                                                )
                                             
                                          
                                       .

The energies are related by 
                                 
                                    
                                       E
                                       
                                          f
                                          ′
                                       
                                    
                                    
                                       (
                                       π
                                       
                                          (
                                          x
                                          )
                                       
                                       )
                                    
                                    =
                                    
                                       E
                                       f
                                    
                                    
                                       (
                                       x
                                       )
                                    
                                 
                               for all 
                                 
                                    x
                                    ∈
                                    X
                                 
                              .

Mapping π establishes a correspondence between labelings that preserves distinctness. Its left inverse always exists but may be non-unique (when 
                           
                              π
                              
                                 (
                                 X
                                 )
                              
                              ≠
                              
                                 X
                                 ′
                              
                           
                        ). For some labelings in 
                           
                              X
                              ′
                           
                         there may be no meaningful correspondence in 
                           X
                        . For this reason the domain of σ is allowed to be specified. We introduce the following atomic injective reductions. First, the ones not changing the hypergraph:

                           
                              •
                              
                                 reparametrize: Let 
                                    
                                       
                                          f
                                          ′
                                       
                                       :
                                       =
                                       f
                                       −
                                       
                                          A
                                          T
                                       
                                       φ
                                       ,
                                    
                                  where A is the matrix of a local relaxation. Mappings π and σ are identity.


                                 permute_labels: Apply a permutation (a bijection) of labels: for each 
                                    
                                       s
                                       ∈
                                       V
                                       ,
                                    
                                  mapping 
                                    
                                       
                                          π
                                          s
                                       
                                       :
                                       
                                          X
                                          s
                                       
                                       →
                                       
                                          X
                                          s
                                       
                                    
                                  is a bijection, 
                                    
                                       
                                          X
                                          s
                                          ′
                                       
                                       =
                                       
                                          X
                                          s
                                       
                                    
                                  and 
                                    
                                       
                                          σ
                                          s
                                       
                                       =
                                       
                                          π
                                          s
                                          
                                             −
                                             1
                                          
                                       
                                    
                                 . The reduced energy is 
                                    
                                       
                                          f
                                          c
                                          ′
                                       
                                       
                                          (
                                          π
                                          
                                             (
                                             
                                                x
                                                c
                                             
                                             )
                                          
                                          )
                                       
                                       =
                                       
                                          f
                                          c
                                       
                                       
                                          (
                                          
                                             x
                                             c
                                          
                                          )
                                       
                                    
                                 .


                                 add_labels: Expand variable domains as 
                                    
                                       
                                          X
                                          s
                                       
                                       ⊂
                                       
                                          X
                                          s
                                          ′
                                       
                                    
                                  and extend the objective component-wise: let 
                                    
                                       
                                          f
                                          c
                                          ′
                                       
                                       
                                          (
                                          
                                             x
                                             c
                                             ′
                                          
                                          )
                                       
                                       =
                                       
                                          f
                                          c
                                       
                                       
                                          (
                                          
                                             x
                                             c
                                             ′
                                          
                                          )
                                       
                                    
                                  for 
                                    
                                       
                                          x
                                          c
                                          ′
                                       
                                       ∈
                                       
                                          X
                                          c
                                       
                                    
                                  and arbitrary for 
                                    
                                       
                                          
                                             x
                                          
                                          c
                                          ′
                                       
                                       ∈
                                       
                                          X
                                          c
                                          ′
                                       
                                       
                                          ∖
                                       
                                       
                                          X
                                          c
                                       
                                    
                                 . Mapping 
                                    
                                       π
                                       :
                                       X
                                       →
                                       
                                          X
                                          ′
                                       
                                    
                                  is the injection x ↦ x. Mapping 
                                    
                                       σ
                                       :
                                       X
                                       →
                                       X
                                    
                                  is the identity (
                                    
                                       dom
                                       (
                                       σ
                                       )
                                       =
                                       X
                                    
                                 ).

Now, atomic reductions changing the hypergraph:

                           
                              •
                              
                                 remove_zero: If the term 
                                    
                                       
                                          f
                                          c
                                       
                                       
                                          (
                                          
                                             x
                                             c
                                          
                                          )
                                       
                                       =
                                       0
                                    
                                  for all 
                                    
                                       
                                          x
                                          c
                                       
                                       ∈
                                       
                                          X
                                          c
                                       
                                       ,
                                    
                                  exclude 
                                    c
                                  from 
                                    E
                                 : let 
                                    
                                       
                                          E
                                          ′
                                       
                                       
                                          =
                                          E
                                          ∖
                                          
                                             {
                                             c
                                             }
                                          
                                       
                                    
                                 . Mapping π is the identity. This operation is the converse of adding zero interactions in [72].


                                 clique_aux: For a given 
                                    
                                       c
                                       ∈
                                       E
                                       ,
                                    
                                  introduce a new node ω, an auxiliary variable 
                                    
                                       y
                                       ∈
                                       
                                          X
                                          ω
                                       
                                    
                                  and represent the term 
                                    
                                       f
                                       c
                                    
                                  as

                                    
                                       (117)
                                       
                                          
                                             
                                                f
                                                c
                                             
                                             
                                                (
                                                
                                                   x
                                                   c
                                                
                                                )
                                             
                                             =
                                             
                                                min
                                                y
                                             
                                             
                                                f
                                                
                                                   c
                                                   ∪
                                                   ω
                                                
                                                ′
                                             
                                             
                                                (
                                                
                                                   x
                                                   c
                                                
                                                ,
                                                y
                                                )
                                             
                                             .
                                          
                                       
                                    
                                 Define 
                                    
                                       
                                          V
                                          ′
                                       
                                       =
                                       V
                                       ∪
                                       
                                          {
                                          ω
                                          }
                                       
                                    
                                  and

                                    
                                       (118)
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         E
                                                         ′
                                                      
                                                      =
                                                      E
                                                      ∪
                                                      
                                                         {
                                                         d
                                                         ∪
                                                         
                                                            {
                                                            ω
                                                            }
                                                         
                                                         
                                                         |
                                                         
                                                         d
                                                         ∈
                                                         E
                                                         ,
                                                         
                                                         d
                                                         ⊂
                                                         c
                                                         }
                                                      
                                                      .
                                                   
                                                
                                             
                                          
                                       
                                    
                                 For hyperedges 
                                    
                                       d
                                       ∈
                                       E
                                       ∖
                                       {
                                       c
                                       }
                                    
                                  the energy terms are copied: 
                                    
                                       
                                          f
                                          d
                                          ′
                                       
                                       
                                          (
                                          
                                             x
                                             d
                                          
                                          )
                                       
                                       =
                                       
                                          f
                                          d
                                       
                                       
                                          (
                                          
                                             x
                                             d
                                          
                                          )
                                       
                                    
                                  and the remaining terms of f′ (other than in 
                                    
                                       (
                                       E
                                       ∖
                                       {
                                       c
                                       }
                                       )
                                       ∪
                                       {
                                       c
                                       ∪
                                       {
                                       ω
                                       }
                                       }
                                    
                                 ) are zero. The new labeling domain is 
                                    
                                       
                                          X
                                          ′
                                       
                                       =
                                       X
                                       ×
                                       
                                          X
                                          ω
                                       
                                    
                                 . Mapping 
                                    
                                       π
                                       :
                                       X
                                       →
                                       
                                          X
                                          ′
                                       
                                    
                                  is defined as π: x ↦ (x, y(x)) where

                                    
                                       (119)
                                       
                                          
                                             
                                                
                                                   
                                                      y
                                                      
                                                         (
                                                         x
                                                         )
                                                      
                                                      =
                                                      y
                                                      
                                                         (
                                                         
                                                            x
                                                            c
                                                         
                                                         )
                                                      
                                                      ∈
                                                      
                                                         argmin
                                                         y
                                                      
                                                      
                                                         f
                                                         
                                                            c
                                                            ∪
                                                            {
                                                            ω
                                                            }
                                                         
                                                         ′
                                                      
                                                      
                                                         (
                                                         
                                                            x
                                                            c
                                                         
                                                         ,
                                                         y
                                                         )
                                                      
                                                      .
                                                   
                                                
                                             
                                          
                                       
                                    
                                 Mapping 
                                    
                                       σ
                                       :
                                       
                                          X
                                          ′
                                       
                                       →
                                       X
                                    
                                  is the restriction (x, y) ↦ x.


                                 group_aux: Let 
                                    
                                       H
                                       ⊂
                                       E
                                    
                                  and intersection 
                                    
                                       c
                                       =
                                       
                                          ⋂
                                          
                                             h
                                             ∈
                                             H
                                          
                                       
                                       h
                                       ∈
                                       E
                                    
                                 . Introduce a new node ω and a variable 
                                    
                                       y
                                       ∈
                                       
                                          X
                                          ω
                                       
                                    
                                 . Let function 
                                    
                                       y
                                       :
                                       
                                          X
                                          c
                                       
                                       →
                                       
                                          X
                                          ω
                                       
                                    
                                  be such that 
                                    
                                       (
                                       ∀
                                       h
                                       ∈
                                       H
                                       )
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         f
                                                         h
                                                      
                                                      
                                                         (
                                                         
                                                            x
                                                            h
                                                         
                                                         )
                                                      
                                                      =
                                                      
                                                         f
                                                         
                                                            h
                                                            ∪
                                                            {
                                                            ω
                                                            }
                                                         
                                                         ′
                                                      
                                                      
                                                         (
                                                         
                                                            x
                                                            h
                                                         
                                                         ,
                                                         y
                                                         
                                                            (
                                                            
                                                               x
                                                               c
                                                            
                                                            )
                                                         
                                                         )
                                                      
                                                      =
                                                      
                                                         min
                                                         
                                                            y
                                                            ∈
                                                            
                                                               X
                                                               ω
                                                            
                                                         
                                                      
                                                      
                                                         f
                                                         
                                                            h
                                                            ∪
                                                            {
                                                            ω
                                                            }
                                                         
                                                         ′
                                                      
                                                      
                                                         (
                                                         
                                                            x
                                                            h
                                                         
                                                         ,
                                                         y
                                                         )
                                                      
                                                      .
                                                   
                                                
                                             
                                          
                                       
                                    
                                 Define 
                                    
                                       
                                          V
                                          ′
                                       
                                       =
                                       V
                                       ∪
                                       
                                          {
                                          ω
                                          }
                                       
                                    
                                  and

                                    
                                       (120)
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         E
                                                         ′
                                                      
                                                      =
                                                      E
                                                      ∪
                                                      
                                                         ⋃
                                                         
                                                            h
                                                            ∈
                                                            H
                                                         
                                                      
                                                      
                                                         {
                                                         d
                                                         ∪
                                                         
                                                            {
                                                            ω
                                                            }
                                                         
                                                         
                                                         |
                                                         
                                                         d
                                                         ∈
                                                         E
                                                         ,
                                                         
                                                         d
                                                         ⊂
                                                         h
                                                         }
                                                      
                                                      .
                                                   
                                                
                                             
                                          
                                       
                                    
                                 Define 
                                    
                                       π
                                       :
                                       X
                                       →
                                       
                                          X
                                          ′
                                       
                                       :
                                       x
                                       ↦
                                       
                                          (
                                          x
                                          ,
                                          y
                                          
                                             (
                                             
                                                x
                                                c
                                             
                                             )
                                          
                                          )
                                       
                                    
                                  and 
                                    
                                       σ
                                       :
                                       
                                          X
                                          ′
                                       
                                       →
                                       X
                                       :
                                       
                                          (
                                          x
                                          ,
                                          y
                                          )
                                       
                                       ↦
                                       x
                                    
                                 .

In order to relate relaxed-improving maps before and after the reduction we need a correspondence between them. However, not all maps 
                           
                              p
                              :
                              
                                 X
                                 ′
                              
                              →
                              
                                 X
                                 ′
                              
                           
                         of the reduced problem make sense for the initial problem.

                           Definition A.2
                           A node-wise mapping 
                                 
                                    
                                       p
                                       ′
                                    
                                    :
                                    
                                       X
                                       ′
                                    
                                    →
                                    
                                       X
                                       ′
                                    
                                 
                               is admissible for a reduction if 
                                 
                                    
                                       p
                                       ′
                                    
                                    
                                       (
                                       π
                                       
                                          (
                                          X
                                          )
                                       
                                       )
                                    
                                    ⊂
                                    dom
                                    
                                       (
                                       σ
                                       )
                                    
                                 
                              . In this case 
                                 
                                    p
                                    =
                                    σ
                                    ∘
                                    
                                       p
                                       ′
                                    
                                    ∘
                                    π
                                 
                               is the corresponding mapping for p′.

All the above atomic reductions fulfill the requirements of Definition A.1 and, with the exception of add_labels reduction, all mappings 
                           
                              
                                 p
                                 ′
                              
                              :
                              
                                 X
                                 ′
                              
                              →
                              
                                 X
                                 ′
                              
                           
                         are admissible.

                           Definition A.3
                           A reduction has inclusion of relaxed-improving maps for relaxations Λ and Λ′ if for every admissible Λ′-improving mapping p′ for f′ its corresponding mapping p is Λ-improving for f.


                              Atomic reductions reparametrize and permute_labels have inclusion of relaxed-improving maps for local relaxations.
                           

Let Λ be a local relaxation. Let p′ be Λ-improving for f′. In case of permute_labels, marginalization constraints are invariant w.r.t. the order of labels. We trivially get that σ ○ p′ ○ π is Λ-improving for f. In case of reparametrize, there holds 
                                 
                                    
                                       〈
                                       f
                                       −
                                       
                                          A
                                          T
                                       
                                       φ
                                       ,
                                       μ
                                       〉
                                    
                                    =
                                    
                                       〈
                                       f
                                       ,
                                       μ
                                       〉
                                    
                                 
                               for all μ ∈ Λ as well as for all μ ∈ [p′](Λ) ⊂ Λ and so 
                                 
                                    p
                                    =
                                    
                                       p
                                       ′
                                    
                                 
                               is Λ-improving for f.□

To a hypergraph 
                           
                              (
                              V
                              ,
                              E
                              )
                           
                         let us associate an induced local relaxation 
                           
                              Λ
                              E
                           
                         as follows. For 
                           
                              a
                              ,
                              b
                              ⊂
                              V
                           
                         let 
                           
                              a
                              
                                 ⊊
                                 .
                              
                              b
                           
                         if 
                           
                              a
                              ,
                              b
                              ∈
                              E
                           
                         and 
                           
                              a
                              ⊊
                              b
                           
                        . Let 
                           
                              Λ
                              E
                           
                         be the local relaxation for the coupling 
                           
                              ⊊
                              .
                           
                        .

                           Theorem A.5
                           
                              Atomic reductions remove_zero, add_labels have inclusion of admissible relaxed-improving maps for local relaxations
                              
                                 
                                    Λ
                                    E
                                 
                               
                              and
                              
                                 
                                    
                                       Λ
                                       ′
                                    
                                    =
                                    
                                       Λ
                                       
                                          E
                                          ′
                                       
                                    
                                 
                              
                              .
                           

(remove_zero). Because 
                                 
                                    E
                                    ′
                                 
                               does not contain hyperedge 
                                 
                                    c
                                    ,
                                 
                               all variables 
                                 
                                    
                                       μ
                                       c
                                    
                                    ,
                                 
                               as well as the associated marginalization constraints, are absent in Λ′. Polytope Λ′ can be still represented in 
                                 
                                    R
                                    I
                                 
                               as having unconstrained variables 
                                 
                                    
                                       μ
                                       c
                                       ′
                                    
                                    
                                       (
                                       
                                          x
                                          c
                                       
                                       )
                                    
                                 
                              . In this representation Λ ⊂ Λ′ and Theorem 4.1 applies.□

(add_labels). Let p′ be relaxed-improving for f′:

                                 
                                    (121)
                                    
                                       
                                          
                                             (
                                             ∀
                                             
                                                μ
                                                ′
                                             
                                             ∈
                                             
                                                Λ
                                                ′
                                             
                                             )
                                          
                                          
                                          
                                             〈
                                             
                                                f
                                                ′
                                             
                                             ,
                                             
                                                [
                                                
                                                   p
                                                   ′
                                                
                                                ]
                                             
                                             
                                                μ
                                                ′
                                             
                                             〉
                                          
                                          ≤
                                          
                                             〈
                                             
                                                f
                                                ′
                                             
                                             ,
                                             
                                                μ
                                                ′
                                             
                                             〉
                                          
                                          .
                                       
                                    
                                 
                              By the dual representation Theorem 3.3(b), there exists dual multipliers ψ for Λ′ such that

                                 
                                    (122)
                                    
                                       
                                          
                                             (
                                             ∀
                                             c
                                             ∈
                                             E
                                             ,
                                             
                                             ∀
                                             
                                                x
                                                c
                                                ′
                                             
                                             ∈
                                             
                                                X
                                                c
                                                ′
                                             
                                             )
                                          
                                          
                                          
                                             f
                                             c
                                             ′
                                          
                                          
                                             (
                                             
                                                p
                                                ′
                                             
                                             
                                                (
                                                
                                                   x
                                                   c
                                                   ′
                                                
                                                )
                                             
                                             )
                                          
                                          ≤
                                          
                                             f
                                             c
                                             
                                                ′
                                                ψ
                                             
                                          
                                          
                                             (
                                             
                                                x
                                                c
                                                ′
                                             
                                             )
                                          
                                          .
                                       
                                    
                                 
                              It must be that 
                                 
                                    
                                       p
                                       s
                                       ′
                                    
                                    
                                       (
                                       
                                          X
                                          s
                                       
                                       )
                                    
                                    ⊂
                                    
                                       X
                                       s
                                    
                                    ,
                                 
                               otherwise p′ is not admissible. The corresponding mapping 
                                 
                                    
                                       p
                                       s
                                    
                                    :
                                    
                                       X
                                       s
                                    
                                    →
                                    
                                       X
                                       s
                                    
                                 
                               is the restriction of 
                                 
                                    p
                                    s
                                    ′
                                 
                               to 
                                 
                                    X
                                    s
                                 
                              . Restricting (122) to 
                                 
                                    X
                                    s
                                 
                               we obtain 
                                 
                                    (
                                    ∀
                                    c
                                    ∈
                                    E
                                    ,
                                    
                                    ∀
                                    
                                       x
                                       c
                                    
                                    ∈
                                    
                                       X
                                       c
                                    
                                    )
                                 
                              
                              
                                 
                                    (123)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      f
                                                      c
                                                   
                                                   
                                                      (
                                                      p
                                                      
                                                         (
                                                         
                                                            x
                                                            c
                                                         
                                                         )
                                                      
                                                      )
                                                   
                                                   ≤
                                                   
                                                      f
                                                      c
                                                   
                                                   
                                                      (
                                                      
                                                         x
                                                         c
                                                      
                                                      )
                                                   
                                                   −
                                                   
                                                      
                                                         (
                                                         
                                                            
                                                               (
                                                               
                                                                  A
                                                                  ′
                                                               
                                                               )
                                                            
                                                            T
                                                         
                                                         ψ
                                                         )
                                                      
                                                      c
                                                   
                                                   
                                                      (
                                                      
                                                         x
                                                         c
                                                      
                                                      )
                                                   
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              The RHS expression is of the form (55) and thus is a valid reparametrization of f in Λ. Therefore (123) satisfies component-wise inequalities and by Theorem 3.3(b), p is relaxed-improving for f.□


                              Atomic reductions clique_aux and group_aux have inclusion of relaxed-improving maps for local relaxations
                              
                                 
                                    Λ
                                    E
                                 
                               
                              and
                              
                                 
                                    
                                       Λ
                                       ′
                                    
                                    =
                                    
                                       Λ
                                       
                                          E
                                          ′
                                       
                                    
                                 
                              
                              .
                           

(clique_aux). First, let us show that a relaxed solution μ ∈ Λ can be mapped to a relaxed solution of the reduced problem μ′ ∈ Λ′. Let

                                 
                                    (124a)
                                    
                                       
                                          
                                             
                                             
                                                
                                                   
                                                      (
                                                      ∀
                                                      d
                                                      ∈
                                                      E
                                                      )
                                                   
                                                   
                                                   
                                                      (
                                                      ∀
                                                      
                                                         x
                                                         d
                                                      
                                                      ∈
                                                      
                                                         X
                                                         d
                                                      
                                                      )
                                                   
                                                   
                                                   
                                                   
                                                      μ
                                                      d
                                                      ′
                                                   
                                                   
                                                      (
                                                      
                                                         x
                                                         d
                                                      
                                                      )
                                                   
                                                   :
                                                   =
                                                   
                                                      μ
                                                      d
                                                   
                                                   
                                                      (
                                                      
                                                         x
                                                         d
                                                      
                                                      )
                                                   
                                                   ,
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (124b)
                                    
                                       
                                          
                                             
                                             
                                                
                                                   
                                                      (
                                                      ∀
                                                      d
                                                      ⊂
                                                      c
                                                      ,
                                                      
                                                      d
                                                      ∈
                                                      E
                                                      )
                                                   
                                                   
                                                   
                                                      (
                                                      ∀
                                                      
                                                         x
                                                         d
                                                      
                                                      ∈
                                                      
                                                         X
                                                         d
                                                      
                                                      ,
                                                      ∀
                                                      y
                                                      ∈
                                                      
                                                         X
                                                         ω
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                             
                                             
                                                
                                                   
                                                      μ
                                                      
                                                         d
                                                         ∪
                                                         {
                                                         ω
                                                         }
                                                      
                                                      ′
                                                   
                                                   
                                                      (
                                                      
                                                         x
                                                         d
                                                      
                                                      ,
                                                      y
                                                      )
                                                   
                                                   :
                                                   =
                                                   
                                                      ∑
                                                      
                                                         x
                                                         
                                                            c
                                                            ∖
                                                            d
                                                         
                                                      
                                                   
                                                   
                                                      μ
                                                      c
                                                   
                                                   
                                                      (
                                                      
                                                         x
                                                         c
                                                      
                                                      )
                                                   
                                                   〚
                                                   y
                                                   
                                                      (
                                                      
                                                         x
                                                         c
                                                      
                                                      )
                                                   
                                                   =
                                                   y
                                                   〛
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

In particular, 
                                 
                                    
                                       μ
                                       
                                          c
                                          ∪
                                          {
                                          ω
                                          }
                                       
                                       ′
                                    
                                    
                                       (
                                       
                                          x
                                          c
                                       
                                       ,
                                       y
                                       )
                                    
                                    =
                                    
                                       μ
                                       c
                                    
                                    
                                       (
                                       
                                          x
                                          c
                                       
                                       )
                                    
                                    〚
                                    y
                                    
                                       (
                                       
                                          x
                                          c
                                       
                                       )
                                    
                                    =
                                    y
                                    〛
                                 
                               and 
                                 
                                    
                                       μ
                                       
                                          {
                                          ω
                                          }
                                       
                                       ′
                                    
                                    
                                       (
                                       y
                                       )
                                    
                                    =
                                    
                                       ∑
                                       
                                          x
                                          c
                                       
                                    
                                    
                                       μ
                                       c
                                    
                                    
                                       (
                                       
                                          x
                                          c
                                       
                                       )
                                    
                                    〚
                                    y
                                    
                                       (
                                       
                                          x
                                          c
                                       
                                       )
                                    
                                    =
                                    y
                                    〛
                                 
                              . Clearly, solution μ′ satisfies all those marginalization constraints that μ does. The additional marginalization constraints of 
                                 
                                    Λ
                                    
                                       E
                                       ′
                                    
                                 
                               are given for 
                                 
                                    b
                                    ⊂
                                    c
                                    ,
                                 
                              
                              
                                 
                                    a
                                    ⊊
                                    b
                                    ,
                                 
                              
                              
                                 
                                    a
                                    ,
                                    b
                                    ∈
                                    E
                                 
                               by couplings

                                 
                                    (125)
                                    
                                       
                                          
                                             
                                                
                                                   a
                                                   ,
                                                   
                                                   b
                                                   ,
                                                   
                                                   a
                                                   ∪
                                                   {
                                                   ω
                                                   }
                                                   ⊊
                                                   b
                                                   ∪
                                                   {
                                                   ω
                                                   }
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              Marginalization for 
                                 b
                               and 
                                 
                                    b
                                    ∪
                                    {
                                    ω
                                    }
                                 
                              :

                                 
                                    (126)
                                    
                                       
                                          
                                             
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                      y
                                                   
                                                   
                                                      μ
                                                      
                                                         b
                                                         ∪
                                                         {
                                                         ω
                                                         }
                                                      
                                                      ′
                                                   
                                                   
                                                      (
                                                      
                                                         x
                                                         b
                                                      
                                                      ,
                                                      y
                                                      )
                                                   
                                                   =
                                                   
                                                      ∑
                                                      y
                                                   
                                                   
                                                      ∑
                                                      
                                                         x
                                                         
                                                            c
                                                            ∖
                                                            b
                                                         
                                                      
                                                   
                                                   
                                                      μ
                                                      c
                                                   
                                                   
                                                      (
                                                      
                                                         x
                                                         c
                                                      
                                                      )
                                                   
                                                   〚
                                                   y
                                                   
                                                      (
                                                      
                                                         x
                                                         c
                                                      
                                                      )
                                                   
                                                   =
                                                   y
                                                   〛
                                                
                                             
                                          
                                          
                                             
                                             
                                                
                                                   =
                                                   
                                                      ∑
                                                      
                                                         x
                                                         
                                                            c
                                                            ∖
                                                            b
                                                         
                                                      
                                                   
                                                   
                                                      μ
                                                      c
                                                   
                                                   
                                                      (
                                                      
                                                         x
                                                         c
                                                      
                                                      )
                                                   
                                                   =
                                                   
                                                      μ
                                                      b
                                                   
                                                   
                                                      (
                                                      
                                                         x
                                                         b
                                                      
                                                      )
                                                   
                                                   =
                                                   
                                                      μ
                                                      b
                                                      ′
                                                   
                                                   
                                                      (
                                                      
                                                         x
                                                         b
                                                      
                                                      )
                                                   
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              Marginalization for 
                                 a
                               and 
                                 
                                    b
                                    ∪
                                    {
                                    ω
                                    }
                                 
                              :

                                 
                                    
                                       
                                          
                                             
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                      
                                                         
                                                            x
                                                            
                                                               b
                                                               ∖
                                                               a
                                                            
                                                         
                                                         ,
                                                         y
                                                      
                                                   
                                                   
                                                      μ
                                                      
                                                         b
                                                         ∪
                                                         {
                                                         ω
                                                         }
                                                      
                                                      ′
                                                   
                                                   
                                                      (
                                                      
                                                         x
                                                         b
                                                      
                                                      ,
                                                      y
                                                      )
                                                   
                                                   =
                                                   
                                                      ∑
                                                      
                                                         
                                                            x
                                                            
                                                               b
                                                               ∖
                                                               a
                                                            
                                                         
                                                         ,
                                                         y
                                                      
                                                   
                                                   
                                                      ∑
                                                      
                                                         x
                                                         
                                                            c
                                                            ∖
                                                            b
                                                         
                                                      
                                                   
                                                   
                                                      μ
                                                      c
                                                   
                                                   
                                                      (
                                                      
                                                         x
                                                         c
                                                      
                                                      )
                                                   
                                                   〚
                                                   y
                                                   
                                                      (
                                                      
                                                         x
                                                         c
                                                      
                                                      )
                                                   
                                                   =
                                                   y
                                                   〛
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (127)
                                    
                                       
                                          
                                             
                                             
                                                
                                                   =
                                                   
                                                      ∑
                                                      
                                                         x
                                                         
                                                            c
                                                            ∖
                                                            a
                                                         
                                                      
                                                   
                                                   
                                                      μ
                                                      c
                                                   
                                                   
                                                      (
                                                      
                                                         x
                                                         c
                                                      
                                                      )
                                                   
                                                   =
                                                   
                                                      μ
                                                      a
                                                   
                                                   
                                                      (
                                                      
                                                         x
                                                         a
                                                      
                                                      )
                                                   
                                                   =
                                                   
                                                      μ
                                                      a
                                                      ′
                                                   
                                                   
                                                      (
                                                      
                                                         x
                                                         a
                                                      
                                                      )
                                                   
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              Marginalization for 
                                 
                                    a
                                    ∪
                                    {
                                    ω
                                    }
                                 
                               and 
                                 
                                    b
                                    ∪
                                    {
                                    ω
                                    }
                                 
                              :

                                 
                                    (128)
                                    
                                       
                                          
                                             
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                      
                                                         x
                                                         
                                                            b
                                                            ∖
                                                            a
                                                         
                                                      
                                                   
                                                   
                                                      μ
                                                      
                                                         b
                                                         ∪
                                                         {
                                                         ω
                                                         }
                                                      
                                                      ′
                                                   
                                                   
                                                      (
                                                      
                                                         x
                                                         b
                                                      
                                                      ,
                                                      y
                                                      )
                                                   
                                                   =
                                                   
                                                      ∑
                                                      
                                                         x
                                                         
                                                            b
                                                            ∖
                                                            a
                                                         
                                                      
                                                   
                                                   
                                                      ∑
                                                      
                                                         x
                                                         
                                                            c
                                                            ∖
                                                            b
                                                         
                                                      
                                                   
                                                   
                                                      μ
                                                      c
                                                   
                                                   
                                                      (
                                                      
                                                         x
                                                         c
                                                      
                                                      )
                                                   
                                                   〚
                                                   y
                                                   
                                                      (
                                                      
                                                         x
                                                         c
                                                      
                                                      )
                                                   
                                                   =
                                                   y
                                                   〛
                                                
                                             
                                          
                                          
                                             
                                             
                                                
                                                   =
                                                   
                                                      ∑
                                                      
                                                         x
                                                         
                                                            c
                                                            ∖
                                                            a
                                                         
                                                      
                                                   
                                                   
                                                      μ
                                                      c
                                                   
                                                   
                                                      (
                                                      
                                                         x
                                                         c
                                                      
                                                      )
                                                   
                                                   〚
                                                   y
                                                   
                                                      (
                                                      
                                                         x
                                                         c
                                                      
                                                      )
                                                   
                                                   =
                                                   y
                                                   〛
                                                   =
                                                   
                                                      μ
                                                      
                                                         a
                                                         ∪
                                                         {
                                                         ω
                                                         }
                                                      
                                                      ′
                                                   
                                                   
                                                      (
                                                      
                                                         x
                                                         a
                                                      
                                                      ,
                                                      y
                                                      )
                                                   
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              Therefore μ′ ∈ Λ′. Since we have the equality 
                                 
                                    
                                       f
                                       c
                                    
                                    
                                       (
                                       
                                          x
                                          c
                                       
                                       )
                                    
                                    =
                                    
                                       f
                                       
                                          c
                                          ∪
                                          {
                                          ω
                                          }
                                       
                                       ′
                                    
                                    
                                       (
                                       
                                          x
                                          c
                                       
                                       ,
                                       y
                                       
                                          (
                                          
                                             x
                                             c
                                          
                                          )
                                       
                                       )
                                    
                                    ,
                                 
                               there holds

                                 
                                    (129)
                                    
                                       
                                          
                                             
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                      
                                                         x
                                                         c
                                                      
                                                   
                                                   
                                                      f
                                                      c
                                                   
                                                   
                                                      (
                                                      
                                                         x
                                                         c
                                                      
                                                      )
                                                   
                                                   
                                                      μ
                                                      c
                                                   
                                                   
                                                      (
                                                      
                                                         x
                                                         c
                                                      
                                                      )
                                                   
                                                   =
                                                   
                                                      ∑
                                                      
                                                         x
                                                         c
                                                      
                                                   
                                                   
                                                      f
                                                      
                                                         c
                                                         ∪
                                                         {
                                                         ω
                                                         }
                                                      
                                                      ′
                                                   
                                                   
                                                      (
                                                      
                                                         x
                                                         c
                                                      
                                                      ,
                                                      y
                                                      
                                                         (
                                                         
                                                            x
                                                            c
                                                         
                                                         )
                                                      
                                                      )
                                                   
                                                   
                                                      μ
                                                      c
                                                   
                                                   
                                                      (
                                                      
                                                         x
                                                         c
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                             
                                             
                                                
                                                   =
                                                   
                                                      ∑
                                                      
                                                         
                                                            x
                                                            c
                                                         
                                                         ,
                                                         y
                                                      
                                                   
                                                   
                                                      f
                                                      
                                                         c
                                                         ∪
                                                         {
                                                         ω
                                                         }
                                                      
                                                      ′
                                                   
                                                   
                                                      (
                                                      
                                                         x
                                                         c
                                                      
                                                      ,
                                                      y
                                                      )
                                                   
                                                   〚
                                                   y
                                                   =
                                                   y
                                                   
                                                      (
                                                      
                                                         x
                                                         c
                                                      
                                                      )
                                                   
                                                   〛
                                                   
                                                      μ
                                                      c
                                                   
                                                   
                                                      (
                                                      
                                                         x
                                                         c
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                                
                                                   =
                                                   
                                                      ∑
                                                      
                                                         
                                                            x
                                                            c
                                                         
                                                         ,
                                                         y
                                                      
                                                   
                                                   
                                                      f
                                                      
                                                         c
                                                         ∪
                                                         {
                                                         ω
                                                         }
                                                      
                                                      ′
                                                   
                                                   
                                                      (
                                                      
                                                         x
                                                         c
                                                      
                                                      ,
                                                      y
                                                      )
                                                   
                                                   
                                                      μ
                                                      
                                                         c
                                                         ∪
                                                         {
                                                         ω
                                                         }
                                                      
                                                      ′
                                                   
                                                   
                                                      (
                                                      
                                                         x
                                                         c
                                                      
                                                      ,
                                                      y
                                                      )
                                                   
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              For other components 
                                 
                                    d
                                    ∈
                                    E
                                    ∖
                                    {
                                    c
                                    }
                                 
                               we have

                                 
                                    (130)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ∑
                                                      
                                                         x
                                                         d
                                                      
                                                   
                                                   
                                                      f
                                                      d
                                                   
                                                   
                                                      (
                                                      
                                                         x
                                                         d
                                                      
                                                      )
                                                   
                                                   
                                                      μ
                                                      d
                                                   
                                                   
                                                      (
                                                      
                                                         x
                                                         d
                                                      
                                                      )
                                                   
                                                   =
                                                   
                                                      ∑
                                                      
                                                         x
                                                         d
                                                      
                                                   
                                                   
                                                      f
                                                      d
                                                      ′
                                                   
                                                   
                                                      (
                                                      
                                                         x
                                                         d
                                                      
                                                      )
                                                   
                                                   
                                                      μ
                                                      d
                                                      ′
                                                   
                                                   
                                                      (
                                                      
                                                         x
                                                         d
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              and for all 
                                 
                                    d
                                    ⊊
                                    c
                                    ,
                                 
                              
                              
                                 
                                    d
                                    ∈
                                    E
                                 
                               we have 
                                 
                                    
                                       f
                                       
                                          d
                                          ∪
                                          {
                                          ω
                                          }
                                       
                                       ′
                                    
                                    =
                                    0
                                 
                              . Let us denote the linear mapping 
                                 
                                    
                                       R
                                       I
                                    
                                    →
                                    
                                       R
                                       
                                          I
                                          ′
                                       
                                    
                                 
                               (124) by Π. It follows that for all μ ∈ Λ there holds Πμ ∈ Λ′ and from (129), (130) that

                                 
                                    (131)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      〈
                                                      f
                                                      ,
                                                      μ
                                                      〉
                                                   
                                                   =
                                                   
                                                      〈
                                                      
                                                         f
                                                         ′
                                                      
                                                      ,
                                                      Π
                                                      μ
                                                      〉
                                                   
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

This proves that

                                 
                                    (132)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      min
                                                      
                                                         μ
                                                         ∈
                                                         Λ
                                                      
                                                   
                                                   
                                                      〈
                                                      f
                                                      ,
                                                      μ
                                                      〉
                                                   
                                                   ≥
                                                   
                                                      min
                                                      
                                                         
                                                            μ
                                                            ′
                                                         
                                                         ∈
                                                         
                                                            Λ
                                                            ′
                                                         
                                                      
                                                   
                                                   
                                                      〈
                                                      
                                                         f
                                                         ′
                                                      
                                                      ,
                                                      
                                                         μ
                                                         ′
                                                      
                                                      〉
                                                   
                                                   ,
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              i.e., relaxation Λ′ is not tighter than Λ.

Let 
                                 
                                    
                                       p
                                       ′
                                    
                                    :
                                    
                                       X
                                       ′
                                    
                                    →
                                    
                                       X
                                       ′
                                    
                                 
                               be node-wise Λ′-improving for f′ and 
                                 
                                    p
                                    =
                                    σ
                                    ∘
                                    
                                       p
                                       ′
                                    
                                    ∘
                                    π
                                    ,
                                 
                               
                              i.e., 
                                 
                                    
                                       p
                                       s
                                    
                                    =
                                    
                                       p
                                       s
                                       ′
                                    
                                 
                               for 
                                 
                                    s
                                    ∈
                                    V
                                 
                              . Let 
                                 
                                    
                                       P
                                       ′
                                    
                                    =
                                    
                                       [
                                       
                                          p
                                          ′
                                       
                                       ]
                                    
                                    ,
                                 
                               the extension to 
                                 
                                    R
                                    
                                       I
                                       ′
                                    
                                 
                              . Similarly to (129) and (130) we can express parts of the scalar product

                                 
                                    (133)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      〈
                                                      f
                                                      ,
                                                      
                                                         [
                                                         p
                                                         ]
                                                      
                                                      μ
                                                      〉
                                                   
                                                   =
                                                   
                                                      ∑
                                                      
                                                         d
                                                         ∈
                                                         E
                                                      
                                                   
                                                   
                                                      ∑
                                                      
                                                         
                                                            x
                                                            d
                                                         
                                                         ∈
                                                         
                                                            X
                                                            d
                                                         
                                                      
                                                   
                                                   
                                                      f
                                                      d
                                                   
                                                   
                                                      (
                                                      
                                                         p
                                                         d
                                                         ′
                                                      
                                                      
                                                         (
                                                         
                                                            x
                                                            d
                                                         
                                                         )
                                                      
                                                      )
                                                   
                                                   
                                                      μ
                                                      d
                                                   
                                                   
                                                      (
                                                      
                                                         x
                                                         d
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              for each 
                                 
                                    d
                                    ∈
                                    E
                                 
                               as follows. For 
                                 
                                    d
                                    ∈
                                    E
                                    ∖
                                    {
                                    c
                                    }
                                 
                               we have

                                 
                                    (134)
                                    
                                       
                                          
                                             
                                             
                                                
                                                   
                                                      ∑
                                                      
                                                         x
                                                         d
                                                      
                                                   
                                                   
                                                      f
                                                      d
                                                   
                                                   
                                                      (
                                                      
                                                         p
                                                         d
                                                         ′
                                                      
                                                      
                                                         (
                                                         
                                                            x
                                                            d
                                                         
                                                         )
                                                      
                                                      )
                                                   
                                                   
                                                      μ
                                                      d
                                                   
                                                   
                                                      (
                                                      
                                                         x
                                                         d
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (135)
                                    
                                       
                                          
                                             
                                                
                                             
                                             
                                                
                                                   =
                                                   
                                                      ∑
                                                      
                                                         x
                                                         d
                                                      
                                                   
                                                   
                                                      ∑
                                                      
                                                         
                                                            x
                                                            ˜
                                                         
                                                         d
                                                      
                                                   
                                                   
                                                      f
                                                      d
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            x
                                                            ˜
                                                         
                                                         d
                                                      
                                                      )
                                                   
                                                   〚
                                                   
                                                      
                                                         x
                                                         ˜
                                                      
                                                      d
                                                   
                                                   =
                                                   
                                                      p
                                                      ′
                                                   
                                                   
                                                      (
                                                      
                                                         x
                                                         d
                                                      
                                                      )
                                                   
                                                   〛
                                                   
                                                      μ
                                                      d
                                                      ′
                                                   
                                                   
                                                      (
                                                      
                                                         x
                                                         d
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                                
                                                   =
                                                   
                                                      ∑
                                                      
                                                         
                                                            x
                                                            ˜
                                                         
                                                         d
                                                      
                                                   
                                                   
                                                      f
                                                      d
                                                      ′
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            x
                                                            ˜
                                                         
                                                         d
                                                      
                                                      )
                                                   
                                                   
                                                      
                                                         (
                                                         
                                                            P
                                                            ′
                                                         
                                                         
                                                            μ
                                                            ′
                                                         
                                                         )
                                                      
                                                      d
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            x
                                                            ˜
                                                         
                                                         d
                                                      
                                                      )
                                                   
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              For 
                                 c
                               let 
                                 
                                    
                                       
                                          c
                                       
                                       ′
                                    
                                    =
                                    c
                                    ∪
                                    
                                       {
                                       ω
                                       }
                                    
                                    ,
                                 
                               we have

                                 
                                    (136a)
                                    
                                       
                                          
                                             
                                             
                                                
                                                   
                                                      ∑
                                                      
                                                         x
                                                         c
                                                      
                                                   
                                                   
                                                      f
                                                      c
                                                   
                                                   
                                                      (
                                                      
                                                         p
                                                         c
                                                         ′
                                                      
                                                      
                                                         (
                                                         
                                                            x
                                                            c
                                                         
                                                         )
                                                      
                                                      )
                                                   
                                                   
                                                      μ
                                                      c
                                                   
                                                   
                                                      (
                                                      
                                                         x
                                                         c
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (136b)
                                    
                                       
                                          
                                             
                                                
                                             
                                             
                                                
                                                   =
                                                   
                                                      ∑
                                                      
                                                         x
                                                         c
                                                      
                                                   
                                                   
                                                      ∑
                                                      
                                                         
                                                            x
                                                            ˜
                                                         
                                                         c
                                                      
                                                   
                                                   
                                                      f
                                                      c
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            x
                                                            ˜
                                                         
                                                         c
                                                      
                                                      )
                                                   
                                                   〚
                                                   
                                                      
                                                         x
                                                         ˜
                                                      
                                                      c
                                                   
                                                   =
                                                   
                                                      p
                                                      ′
                                                   
                                                   
                                                      (
                                                      
                                                         x
                                                         c
                                                      
                                                      )
                                                   
                                                   〛
                                                   
                                                      μ
                                                      c
                                                   
                                                   
                                                      (
                                                      
                                                         x
                                                         c
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                                
                                                   =
                                                   
                                                      ∑
                                                      
                                                         x
                                                         c
                                                      
                                                   
                                                   
                                                      ∑
                                                      
                                                         
                                                            x
                                                            ˜
                                                         
                                                         c
                                                      
                                                   
                                                   
                                                      f
                                                      
                                                         
                                                            c
                                                         
                                                         ′
                                                      
                                                      ′
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            x
                                                            ˜
                                                         
                                                         c
                                                      
                                                      ,
                                                      y
                                                      
                                                         (
                                                         
                                                            
                                                               x
                                                               ˜
                                                            
                                                            c
                                                         
                                                         )
                                                      
                                                      )
                                                   
                                                   〚
                                                   
                                                      
                                                         x
                                                         ˜
                                                      
                                                      c
                                                   
                                                   =
                                                   
                                                      p
                                                      ′
                                                   
                                                   
                                                      (
                                                      
                                                         x
                                                         c
                                                      
                                                      )
                                                   
                                                   〛
                                                   
                                                      μ
                                                      c
                                                   
                                                   
                                                      (
                                                      
                                                         x
                                                         c
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (136c)
                                    
                                       
                                          
                                             
                                                
                                             
                                             
                                                
                                                   ≤
                                                   
                                                      ∑
                                                      
                                                         x
                                                         c
                                                      
                                                   
                                                   
                                                      ∑
                                                      
                                                         
                                                            x
                                                            ˜
                                                         
                                                         c
                                                      
                                                   
                                                   
                                                      f
                                                      
                                                         
                                                            c
                                                         
                                                         ′
                                                      
                                                      ′
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            x
                                                            ˜
                                                         
                                                         c
                                                      
                                                      ,
                                                      
                                                         p
                                                         ω
                                                         ′
                                                      
                                                      
                                                         (
                                                         y
                                                         
                                                            (
                                                            
                                                               x
                                                               c
                                                            
                                                            )
                                                         
                                                         )
                                                      
                                                      )
                                                   
                                                   〚
                                                   
                                                      
                                                         x
                                                         ˜
                                                      
                                                      c
                                                   
                                                   =
                                                   
                                                      p
                                                      ′
                                                   
                                                   
                                                      (
                                                      
                                                         x
                                                         c
                                                      
                                                      )
                                                   
                                                   〛
                                                   
                                                      μ
                                                      c
                                                   
                                                   
                                                      (
                                                      
                                                         x
                                                         c
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            =
                                                            
                                                               ∑
                                                               
                                                                  
                                                                     x
                                                                     c
                                                                  
                                                                  ,
                                                                  y
                                                               
                                                            
                                                            
                                                               ∑
                                                               
                                                                  
                                                                     
                                                                        x
                                                                        ˜
                                                                     
                                                                     c
                                                                  
                                                                  ,
                                                                  
                                                                     y
                                                                     ˜
                                                                  
                                                               
                                                            
                                                            
                                                               f
                                                               
                                                                  
                                                                     c
                                                                  
                                                                  ′
                                                               
                                                               ′
                                                            
                                                            
                                                               (
                                                               
                                                                  
                                                                     x
                                                                     ˜
                                                                  
                                                                  c
                                                               
                                                               ,
                                                               
                                                                  y
                                                                  ˜
                                                               
                                                               )
                                                            
                                                            〚
                                                            
                                                               
                                                                  x
                                                                  ˜
                                                               
                                                               c
                                                            
                                                            =
                                                            
                                                               p
                                                               ′
                                                            
                                                            
                                                               (
                                                               
                                                                  x
                                                                  c
                                                               
                                                               )
                                                            
                                                            〛
                                                            〚
                                                            
                                                               y
                                                               ˜
                                                            
                                                            =
                                                            
                                                               p
                                                               ω
                                                               ′
                                                            
                                                            
                                                               (
                                                               y
                                                               )
                                                            
                                                            〛
                                                         
                                                      
                                                      
                                                         
                                                            〚
                                                            y
                                                            =
                                                            y
                                                            
                                                               (
                                                               
                                                                  x
                                                                  c
                                                               
                                                               )
                                                            
                                                            〛
                                                            
                                                               μ
                                                               c
                                                            
                                                            
                                                               (
                                                               
                                                                  x
                                                                  c
                                                               
                                                               )
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (136d)
                                    
                                       
                                          
                                             
                                             
                                                
                                                   =
                                                   
                                                      ∑
                                                      
                                                         
                                                            x
                                                            c
                                                         
                                                         ,
                                                         y
                                                      
                                                   
                                                   
                                                      ∑
                                                      
                                                         
                                                            
                                                               x
                                                               ˜
                                                            
                                                            c
                                                         
                                                         ,
                                                         
                                                            y
                                                            ˜
                                                         
                                                      
                                                   
                                                   
                                                      f
                                                      
                                                         
                                                            c
                                                         
                                                         ′
                                                      
                                                      ′
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            x
                                                            ˜
                                                         
                                                         c
                                                      
                                                      ,
                                                      
                                                         y
                                                         ˜
                                                      
                                                      )
                                                   
                                                   
                                                      P
                                                      
                                                         
                                                            
                                                               c
                                                            
                                                            ′
                                                         
                                                         ,
                                                         
                                                            (
                                                            
                                                               
                                                                  x
                                                                  ˜
                                                               
                                                               c
                                                            
                                                            ,
                                                            
                                                               y
                                                               ˜
                                                            
                                                            )
                                                         
                                                         ,
                                                         
                                                            (
                                                            
                                                               x
                                                               c
                                                            
                                                            ,
                                                            y
                                                            )
                                                         
                                                      
                                                      ′
                                                   
                                                   
                                                      μ
                                                      
                                                         
                                                            c
                                                         
                                                         ′
                                                      
                                                      ′
                                                   
                                                   
                                                      (
                                                      
                                                         x
                                                         c
                                                      
                                                      ,
                                                      y
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (136e)
                                    
                                       
                                          
                                             
                                             
                                                
                                                   =
                                                   
                                                      ∑
                                                      
                                                         
                                                            
                                                               x
                                                               ˜
                                                            
                                                            c
                                                         
                                                         ,
                                                         
                                                            y
                                                            ˜
                                                         
                                                      
                                                   
                                                   
                                                      f
                                                      
                                                         c
                                                         ∪
                                                         {
                                                         ω
                                                         }
                                                      
                                                      ′
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            x
                                                            ˜
                                                         
                                                         c
                                                      
                                                      ,
                                                      
                                                         y
                                                         ˜
                                                      
                                                      )
                                                   
                                                   
                                                      
                                                         (
                                                         
                                                            P
                                                            ′
                                                         
                                                         
                                                            μ
                                                            ′
                                                         
                                                         )
                                                      
                                                      
                                                         c
                                                         ∪
                                                         {
                                                         ω
                                                         }
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         x
                                                         ˜
                                                      
                                                      ,
                                                      
                                                         y
                                                         ˜
                                                      
                                                      )
                                                   
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

The inequality is due to 
                                 
                                    y
                                    
                                       (
                                       
                                          
                                             x
                                             ˜
                                          
                                          c
                                       
                                       )
                                    
                                    ∈
                                    
                                       argmin
                                       y
                                    
                                    
                                       f
                                       
                                          
                                             c
                                          
                                          ′
                                       
                                       ′
                                    
                                    
                                       (
                                       
                                          
                                             x
                                             ˜
                                          
                                          c
                                       
                                       ,
                                       y
                                       )
                                    
                                 
                              . For all 
                                 
                                    d
                                    ⊊
                                    c
                                    ,
                                 
                              
                              
                                 
                                    d
                                    ∈
                                    E
                                 
                               there holds 
                                 
                                    
                                       f
                                       
                                          d
                                          ∪
                                          {
                                          ω
                                          }
                                       
                                       ′
                                    
                                    =
                                    0
                                 
                              . It follows that

                                 
                                    (137)
                                    
                                       
                                          
                                             
                                                
                                                   〈
                                                   f
                                                   ,
                                                   [
                                                   p
                                                   ]
                                                   μ
                                                   〉
                                                
                                             
                                             
                                                
                                                   =
                                                   〈
                                                   
                                                      f
                                                      ′
                                                   
                                                   ,
                                                   
                                                      [
                                                      
                                                         p
                                                         ′
                                                      
                                                      ]
                                                   
                                                   
                                                      μ
                                                      ′
                                                   
                                                   〉
                                                
                                             
                                          
                                          
                                             
                                                
                                             
                                             
                                                
                                                   ≤
                                                   
                                                      〈
                                                      
                                                         f
                                                         ′
                                                      
                                                      ,
                                                      
                                                         μ
                                                         ′
                                                      
                                                      〉
                                                   
                                                   =
                                                   
                                                      〈
                                                      
                                                         f
                                                         ′
                                                      
                                                      ,
                                                      Π
                                                      μ
                                                      〉
                                                   
                                                   =
                                                   
                                                      〈
                                                      f
                                                      ,
                                                      μ
                                                      〉
                                                   
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              Therefore 
                                 
                                    
                                       [
                                       p
                                       ]
                                    
                                    ∈
                                    
                                       W
                                       f
                                    
                                    
                                 
                              .□

(group_aux). Because 
                                 
                                    y
                                    (
                                    
                                       x
                                       c
                                    
                                    )
                                 
                               minimizes all group terms simultaneously, arguments of the proof for clique_aux apply to each 
                                 
                                    h
                                    ∈
                                    H
                                 
                              . It follows that the final relation (137) is satisfied.□


                              Persistency by higher order clique reduction (HOCR) of Ishikawa 
                              
                                 [22]
                               
                              corresponds to an FLP-improving mapping.
                           

Reductions used in HOCR are of the following form:

                                 
                                    (138)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      x
                                                      1
                                                   
                                                   
                                                      x
                                                      2
                                                   
                                                   ⋯
                                                   
                                                      x
                                                      n
                                                   
                                                   =
                                                   
                                                      min
                                                      
                                                         
                                                            y
                                                            1
                                                         
                                                         ,
                                                         
                                                            y
                                                            2
                                                         
                                                         ,
                                                         ⋯
                                                         
                                                            y
                                                            k
                                                         
                                                      
                                                   
                                                   g
                                                   
                                                      (
                                                      x
                                                      ,
                                                      y
                                                      )
                                                   
                                                   ,
                                                
                                             
                                          
                                       
                                    
                                 
                              where function g(x, y) is by design partially separable so that the reduction decreases the order of the problem. This reduction can be implemented as follows:

                                 
                                    •
                                    Use clique_aux to introduce new variables 
                                          
                                             
                                                y
                                                1
                                             
                                             ,
                                             ⋯
                                             
                                                y
                                                k
                                             
                                             ,
                                          
                                        one at a time, e.g., first let 
                                          
                                             
                                                x
                                                1
                                             
                                             
                                                x
                                                2
                                             
                                             ⋯
                                             
                                                x
                                                n
                                             
                                             =
                                             
                                                min
                                                
                                                   y
                                                   1
                                                
                                             
                                             
                                                f
                                                1
                                             
                                             
                                                (
                                                x
                                                ,
                                                
                                                   y
                                                   1
                                                
                                                )
                                             
                                             ,
                                          
                                        where 
                                          
                                             
                                                f
                                                1
                                             
                                             
                                                (
                                                x
                                                ,
                                                
                                                   y
                                                   1
                                                
                                                )
                                             
                                             =
                                             
                                                min
                                                
                                                   
                                                      y
                                                      2
                                                   
                                                   ,
                                                   ⋯
                                                   
                                                      y
                                                      k
                                                   
                                                
                                             
                                             g
                                             
                                                (
                                                x
                                                ,
                                                y
                                                )
                                             
                                             ,
                                          
                                        and so on.

Use reparametrize to rewrite the term g(x, y) that gets assigned to the hyperedge over all variables 
                                          
                                             
                                                x
                                                1
                                             
                                             ,
                                             ⋯
                                             ,
                                             
                                                x
                                                n
                                             
                                          
                                        and 
                                          
                                             
                                                y
                                                1
                                             
                                             ,
                                             ⋯
                                             ,
                                             
                                                y
                                                k
                                             
                                          
                                        as a sum of terms over smaller subsets of variables as guaranteed by design of g.

Use remove_zero to clean up the hypergraph so that all now zero higher order terms are excluded.

HOCR full reduction can be implemented by iterating the steps above. Starting from the FLP relaxation of the initial problem, the necessary reparametrize operations are feasible as we add all possible interactions during clique_aux. Each atomic reformulation has inclusion of relaxed-improving maps. It follows that the whole reformulation has inclusion of relaxed-improving maps. The persistency in the final reformulation is obtained with QPBO, which by Theorem 4.3 is an FLP-improving mapping. It follows that there is a corresponding FLP-improving mapping in the initial formulation.□


                              Persistency by method of Fix et al. 
                              
                                 [15]
                               
                              corresponds to an FLP-improving mapping.
                           

Method [15] uses reductions of HOCR and a new reduction for a group of cliques [15, Theorem 3.1]. Let us show that the group reduction has the form that can be implemented using group_aux, reparametrize and remove_zero. The optimal value of the auxiliary variable y in [15, Theorem 3.1] depends on the assignment of 
                                 
                                    x
                                    c
                                 
                               only: it is given by 
                                 
                                    y
                                    
                                       (
                                       
                                          x
                                          c
                                       
                                       )
                                    
                                    =
                                    1
                                    −
                                    
                                       ∏
                                       
                                          j
                                          ∈
                                          c
                                       
                                    
                                    
                                       x
                                       j
                                    
                                 
                              . Since all hyperedges 
                                 
                                    h
                                    ∈
                                    H
                                 
                               contain 
                                 
                                    c
                                    ,
                                 
                               the reduced expression [15, equation (2)] equals

                                 
                                    (139)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ∑
                                                      
                                                         h
                                                         ∈
                                                         H
                                                      
                                                   
                                                   
                                                      α
                                                      h
                                                   
                                                   
                                                      (
                                                      y
                                                      
                                                         (
                                                         
                                                            x
                                                            c
                                                         
                                                         )
                                                      
                                                      
                                                         ∏
                                                         
                                                            j
                                                            ∈
                                                            c
                                                         
                                                      
                                                      
                                                         x
                                                         j
                                                      
                                                      +
                                                      
                                                         (
                                                         1
                                                         −
                                                         y
                                                         
                                                            (
                                                            
                                                               x
                                                               c
                                                            
                                                            )
                                                         
                                                         )
                                                      
                                                      
                                                         ∏
                                                         
                                                            j
                                                            ∈
                                                            h
                                                            ∖
                                                            c
                                                         
                                                      
                                                      
                                                         x
                                                         j
                                                      
                                                      )
                                                   
                                                   ,
                                                
                                             
                                          
                                       
                                    
                                 
                              where 
                                 
                                    
                                       α
                                       h
                                    
                                    >
                                    0
                                    ,
                                 
                               
                              i.e., it has the form required by group_aux. The actual simplification of the problem is achieved by applying reparametrize and remove_zero similarly to HOCR.

It follows that reduction [15] can be implemented using operations clique_aux, group_aux, reparametrize and remove_zero.□

The section is organized as follows. We review definitions and the persistency property of bisubmodular functions. Then we define the sum of bisubmodular functions relaxation via injection of label space {0, 1} into 
                           
                              {
                              0
                              ,
                              
                                 1
                                 2
                              
                              ,
                              1
                              }
                           
                         (with operation add_labels). The comparison result is then achieved in two steps. We show that persistency for a bisubmodular function is a BLP-improving mapping on 3 labels (
                           
                              {
                              0
                              ,
                              
                                 1
                                 2
                              
                              ,
                              1
                              }
                           
                        ) admissible for add_labels and then apply the result that add_labels has inclusion of BLP-improving maps to transfer all persistencies by bisubmodular relaxations to the BLP-relaxation of the initial problem.

We follow the notation of [28]. A sum of bisubmodular functions (SoB) relaxation is constructed as follows. Let 
                           
                              
                                 X
                                 s
                              
                              =
                              
                                 {
                                 0
                                 ,
                                 1
                                 }
                              
                           
                         and

                           
                              (140)
                              
                                 
                                    
                                       K
                                       
                                          1
                                          /
                                          2
                                       
                                    
                                    =
                                    
                                       
                                          {
                                          0
                                          ,
                                          
                                             1
                                             2
                                          
                                          ,
                                          1
                                          }
                                       
                                       V
                                    
                                    .
                                 
                              
                           
                        
                     

Define binary operations ⊓, 
                           
                              ⊔
                              :
                              
                                 K
                                 
                                    1
                                    /
                                    2
                                 
                              
                              →
                              
                                 K
                                 
                                    1
                                    /
                                    2
                                 
                              
                           
                         component-wise according to:

                           
                              (141)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ⊓
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      
                                                         1
                                                         2
                                                      
                                                   
                                                   
                                                      1
                                                   
                                                
                                                
                                                   
                                                      
                                                   
                                                
                                                
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      
                                                         1
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         1
                                                         2
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         1
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         1
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         1
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         1
                                                         2
                                                      
                                                   
                                                
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      
                                                         1
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         1
                                                         2
                                                      
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                             
                                             
                                             
                                             
                                             
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   ⊔
                                                
                                                
                                                   0
                                                
                                                
                                                   
                                                      1
                                                      2
                                                   
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                                   0
                                                
                                                
                                                   0
                                                
                                                
                                                   
                                                      1
                                                      2
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      1
                                                      2
                                                   
                                                
                                                
                                                   0
                                                
                                                
                                                   
                                                      1
                                                      2
                                                   
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   1
                                                
                                                
                                                   
                                                      1
                                                      2
                                                   
                                                
                                                
                                                   1
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           Definition A.7
                           Function 
                                 
                                    f
                                    :
                                    
                                       K
                                       
                                          1
                                          /
                                          2
                                       
                                    
                                    →
                                    R
                                 
                               is called bisubmodular if

                                 
                                    (142)
                                    
                                       
                                          
                                             (
                                             ∀
                                             x
                                             ,
                                             y
                                             ∈
                                             
                                                K
                                                
                                                   1
                                                   /
                                                   2
                                                
                                             
                                             )
                                          
                                          
                                          
                                          f
                                          
                                             (
                                             x
                                             ⊓
                                             y
                                             )
                                          
                                          +
                                          f
                                          
                                             (
                                             x
                                             ⊔
                                             y
                                             )
                                          
                                          ≤
                                          f
                                          
                                             (
                                             x
                                             )
                                          
                                          +
                                          f
                                          
                                             (
                                             y
                                             )
                                          
                                          .
                                       
                                    
                                 
                              
                           

Function 
                                 
                                    
                                       f
                                       ′
                                    
                                    :
                                    
                                       K
                                       
                                          1
                                          /
                                          2
                                       
                                    
                                    →
                                    R
                                 
                               is a sum of bisubmodular functions relaxation (SoB relaxation) for 
                                 
                                    f
                                    :
                                    X
                                    →
                                    R
                                 
                               if for every 
                                 
                                    c
                                    ∈
                                    E
                                 
                               there holds:

                                 
                                    •
                                    
                                       
                                          
                                             
                                                f
                                                
                                                   c
                                                
                                                ′
                                             
                                             :
                                             
                                                K
                                                c
                                                
                                                   1
                                                   /
                                                   2
                                                
                                             
                                             →
                                             R
                                          
                                        is bisubmodular;


                                       
                                          
                                             
                                                (
                                                ∀
                                                e
                                                ∈
                                                E
                                                ,
                                                
                                                ∀
                                                
                                                   x
                                                   c
                                                
                                                ∈
                                                
                                                   X
                                                   c
                                                
                                                )
                                             
                                             
                                             
                                             
                                                f
                                                c
                                                ′
                                             
                                             
                                                (
                                                x
                                                )
                                             
                                             =
                                             
                                                f
                                                c
                                             
                                             
                                                (
                                                x
                                                )
                                             
                                          
                                       ;

The next lemma reviews persistency according to [28, Proposition 12].

                           Lemma A.9
                           
                              Let
                              
                                 
                                    
                                       x
                                       *
                                    
                                    ∈
                                    
                                       K
                                       
                                          1
                                          /
                                          2
                                       
                                    
                                 
                               
                              be a minimizer of f′. Define the following mappings
                              
                                 
                                    (143a)
                                    
                                       
                                          
                                             
                                             
                                                
                                                   
                                                      p
                                                      s
                                                      ′
                                                   
                                                   :
                                                   
                                                      K
                                                      s
                                                      
                                                         1
                                                         /
                                                         2
                                                      
                                                   
                                                   →
                                                   
                                                      K
                                                      s
                                                      
                                                         1
                                                         /
                                                         2
                                                      
                                                   
                                                   :
                                                   
                                                      x
                                                      s
                                                   
                                                   ↦
                                                   
                                                      (
                                                      
                                                         x
                                                         s
                                                      
                                                      ⊔
                                                      
                                                         x
                                                         s
                                                         *
                                                      
                                                      )
                                                   
                                                   ⊔
                                                   
                                                      x
                                                      s
                                                      *
                                                   
                                                   ;
                                                
                                             
                                          
                                       
                                    
                                 
                               
                              
                                 
                                    (143b)
                                    
                                       
                                          
                                             
                                             
                                                
                                                   
                                                      p
                                                      s
                                                   
                                                   :
                                                   
                                                      X
                                                      s
                                                   
                                                   →
                                                   
                                                      X
                                                      s
                                                   
                                                   :
                                                   
                                                      x
                                                      s
                                                   
                                                   ↦
                                                   
                                                      {
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     x
                                                                     s
                                                                     *
                                                                  
                                                                  ,
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                  if
                                                                  
                                                                  
                                                                     x
                                                                     s
                                                                     *
                                                                  
                                                                  ≠
                                                                  
                                                                     1
                                                                     2
                                                                  
                                                                  ;
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     x
                                                                     s
                                                                  
                                                                  ,
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                  otherwise
                                                                  .
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           


                              There holds
                              
                                 
                                    (a)
                                    
                                       Autarky:
                                       
                                          
                                             
                                                (
                                                ∀
                                                x
                                                ∈
                                                
                                                   K
                                                   
                                                      1
                                                      /
                                                      2
                                                   
                                                
                                                )
                                             
                                             
                                             
                                             
                                                f
                                                ′
                                             
                                             
                                                (
                                                
                                                   p
                                                   ′
                                                
                                                
                                                   (
                                                   x
                                                   )
                                                
                                                )
                                             
                                             ≤
                                             
                                                f
                                                ′
                                             
                                             
                                                (
                                                x
                                                )
                                             
                                             ;
                                          
                                       
                                    


                                       
                                          
                                             
                                                p
                                                ′
                                             
                                             
                                                (
                                                X
                                                )
                                             
                                             ⊂
                                             X
                                          
                                        
                                       and p is the restriction of p′ to
                                       
                                          X
                                       
                                       .
                                    

Part (a) follows from bisubmodularity (142) using that x
                              * is a minimizer: for all 
                                 
                                    y
                                    ∈
                                    
                                       K
                                       
                                          1
                                          /
                                          2
                                       
                                    
                                 
                               there holds

                                 
                                    (144)
                                    
                                       
                                          
                                             f
                                             ′
                                          
                                          
                                             (
                                             y
                                             ⊔
                                             
                                                x
                                                *
                                             
                                             )
                                          
                                          ≤
                                          
                                             (
                                             
                                                f
                                                ′
                                             
                                             
                                                (
                                                
                                                   x
                                                   *
                                                
                                                )
                                             
                                             −
                                             
                                                f
                                                ′
                                             
                                             
                                                (
                                                y
                                                ⊓
                                                
                                                   x
                                                   *
                                                
                                                )
                                             
                                             )
                                          
                                          +
                                          
                                             f
                                             ′
                                          
                                          
                                             (
                                             y
                                             )
                                          
                                          ≤
                                          
                                             f
                                             ′
                                          
                                          
                                             (
                                             y
                                             )
                                          
                                          .
                                       
                                    
                                 
                              It follows that 
                                 
                                    (
                                    ∀
                                    x
                                    ∈
                                    
                                       K
                                       
                                          1
                                          /
                                          2
                                       
                                    
                                    )
                                 
                              
                              
                                 
                                    (145)
                                    
                                       
                                          
                                             f
                                             ′
                                          
                                          
                                             (
                                             
                                                (
                                                x
                                                ⊔
                                                
                                                   x
                                                   *
                                                
                                                )
                                             
                                             ⊔
                                             
                                                x
                                                *
                                             
                                             )
                                          
                                          ≤
                                          
                                             f
                                             ′
                                          
                                          
                                             (
                                             x
                                             ⊔
                                             
                                                x
                                                *
                                             
                                             )
                                          
                                          ≤
                                          
                                             f
                                             ′
                                          
                                          
                                             (
                                             x
                                             )
                                          
                                          .
                                       
                                    
                                 
                              
                           

Part (b) can be verified explicitly by calculating the tables for mappings p and p′. They are represented respectively as:

                                 
                                    (146)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      p
                                                      s
                                                   
                                                   
                                                      (
                                                      
                                                         x
                                                         s
                                                      
                                                      )
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      p
                                                      s
                                                      ′
                                                   
                                                   
                                                      (
                                                      
                                                         x
                                                         s
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  x
                                                                  s
                                                               
                                                               
                                                                  ∖
                                                               
                                                               
                                                                  x
                                                                  s
                                                                  *
                                                               
                                                            
                                                         
                                                         
                                                            0
                                                         
                                                         
                                                            
                                                               1
                                                               2
                                                            
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      
                                                         
                                                            0
                                                         
                                                         
                                                            0
                                                         
                                                         
                                                            0
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      
                                                         
                                                            1
                                                         
                                                         
                                                            0
                                                         
                                                         
                                                            1
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                   
                                                   
                                                   
                                                   
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               x
                                                               s
                                                            
                                                            
                                                               ∖
                                                            
                                                            
                                                               x
                                                               s
                                                               *
                                                            
                                                         
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         
                                                            1
                                                            2
                                                         
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            1
                                                            2
                                                         
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         
                                                            1
                                                            2
                                                         
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              It is seen that for non-fractional xs
                               the results match.□

We now upgrade the autarky property by Lemma A.9(a) to the statement that p′ is BLP-improving for f′. In order to show this, we construct a reparametrization in which the improving inequality holds component-wise. This reparametrization is given by an optimal dual point, provided that it preserves bisubmodularity of all components. The next lemma shows such a dual solution exists.

                           Lemma A.10
                           
                              Let
                              
                                 
                                    f
                                    :
                                    
                                       K
                                       
                                          1
                                          /
                                          2
                                       
                                    
                                    →
                                    R
                                 
                               
                              be a sum of bisubmodular functions. BLP for f admits an optimal dual solution φ such that each component
                              
                                 
                                    (147)
                                    
                                       
                                          
                                             f
                                             c
                                             φ
                                          
                                          
                                             (
                                             
                                                x
                                                c
                                             
                                             )
                                          
                                          =
                                          
                                             f
                                             c
                                          
                                          
                                             (
                                             
                                                x
                                                c
                                             
                                             )
                                          
                                          −
                                          
                                             
                                                (
                                                
                                                   A
                                                   T
                                                
                                                φ
                                                )
                                             
                                             c
                                          
                                          
                                             (
                                             
                                                x
                                                c
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                              is bisubmodular.
                           

The plan of the proof is as follows:

                                 
                                    •
                                    Reformulate bisubmodular function 
                                          
                                             f
                                             :
                                             
                                                K
                                                
                                                   1
                                                   /
                                                   2
                                                
                                             
                                             →
                                             R
                                          
                                        as a function 
                                          
                                             g
                                             :
                                             
                                                B
                                                
                                                   2
                                                   V
                                                
                                             
                                             →
                                             R
                                          
                                       .

Show there exist a symmetric optimal dual solution to this BLP. Such symmetric solution defines a reparametrization which preserves the sum of bisubmodular functions property for g and consequently for f.

The following reformulation of bisubmodular function 
                                 
                                    f
                                    :
                                    
                                       K
                                       
                                          1
                                          /
                                          2
                                       
                                    
                                    →
                                    R
                                 
                               as a function 
                                 
                                    g
                                    :
                                    
                                       B
                                       
                                          2
                                          V
                                       
                                    
                                    →
                                    R
                                 
                               is according to [28]. Node s is represented by a pair of nodes (s, s′). Label 
                                 
                                    
                                       x
                                       s
                                    
                                    ∈
                                    
                                       K
                                       
                                          1
                                          /
                                          2
                                       
                                    
                                 
                               is represented by a pair of labels 
                                 
                                    (
                                    
                                       u
                                       s
                                    
                                    ,
                                    
                                       u
                                       s
                                       ′
                                    
                                    )
                                 
                               as follows:

                                 
                                    (148)
                                    
                                       
                                          
                                             
                                                
                                                   0
                                                   →
                                                   
                                                      (
                                                      1
                                                      ,
                                                      0
                                                      )
                                                   
                                                   ;
                                                   
                                                   
                                                   1
                                                   →
                                                   
                                                      (
                                                      0
                                                      ,
                                                      1
                                                      )
                                                   
                                                   ;
                                                   
                                                   
                                                   
                                                      1
                                                      2
                                                   
                                                   →
                                                   
                                                      (
                                                      0
                                                      ,
                                                      0
                                                      )
                                                   
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              To a hyperedge 
                                 c
                               there corresponds hyperedge 
                                 
                                    c
                                    ∪
                                    
                                       
                                          c
                                       
                                       ′
                                    
                                    ,
                                 
                               where 
                                 
                                    
                                       
                                          c
                                       
                                       ′
                                    
                                    =
                                    
                                       {
                                       
                                          s
                                          ′
                                       
                                       
                                       |
                                       
                                       s
                                       ∈
                                       c
                                       }
                                    
                                 
                              . In the hypergraph 
                                 
                                    (
                                    V
                                    ∪
                                    
                                       V
                                       ′
                                    
                                    ,
                                    G
                                    )
                                 
                               there are edges of the form 
                                 
                                    c
                                    ∪
                                    
                                       
                                          c
                                       
                                       ′
                                    
                                    ,
                                 
                               {s} and {s′} for 
                                 
                                    c
                                    ∈
                                    E
                                 
                               and 
                                 
                                    s
                                    ∈
                                    V
                                 
                              . We will denote components 
                                 
                                    g
                                    
                                       c
                                       ∪
                                       
                                          
                                             c
                                          
                                          ′
                                       
                                    
                                 
                               simply by 
                                 
                                    g
                                    c
                                 
                               for 
                                 
                                    |
                                    c
                                    |
                                    ≥
                                    1
                                 
                              . The energy g is defined by

                                 
                                    (149)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      (
                                                      ∀
                                                      u
                                                      ∈
                                                      
                                                         B
                                                         
                                                            c
                                                            ×
                                                            
                                                               
                                                                  c
                                                               
                                                               ′
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                   
                                                   
                                                      g
                                                      c
                                                   
                                                   
                                                      (
                                                      
                                                         u
                                                         c
                                                      
                                                      ,
                                                      
                                                         u
                                                         
                                                            
                                                               c
                                                            
                                                            ′
                                                         
                                                      
                                                      )
                                                   
                                                   =
                                                   
                                                      f
                                                      c
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            
                                                               u
                                                               c
                                                            
                                                            +
                                                            
                                                               
                                                                  u
                                                                  ¯
                                                               
                                                               
                                                                  
                                                                     c
                                                                  
                                                                  ′
                                                               
                                                            
                                                         
                                                         2
                                                      
                                                      )
                                                   
                                                   ,
                                                
                                             
                                          
                                       
                                    
                                 
                              where 
                                 
                                    
                                       u
                                       ¯
                                    
                                    :
                                    =
                                    1
                                    −
                                    u
                                 
                              . By definition, g has the symmetry property:

                                 
                                    (150)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      (
                                                      ∀
                                                      u
                                                      ∈
                                                      
                                                         B
                                                         
                                                            c
                                                            ×
                                                            
                                                               
                                                                  c
                                                               
                                                               ′
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                   
                                                   
                                                      g
                                                      c
                                                   
                                                   
                                                      (
                                                      
                                                         u
                                                         c
                                                      
                                                      ,
                                                      
                                                         u
                                                         
                                                            
                                                               c
                                                            
                                                            ′
                                                         
                                                      
                                                      )
                                                   
                                                   =
                                                   g
                                                   
                                                      (
                                                      
                                                         
                                                            u
                                                            ¯
                                                         
                                                         
                                                            
                                                               c
                                                            
                                                            ′
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            u
                                                            ¯
                                                         
                                                         c
                                                      
                                                      )
                                                   
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              Let 
                                 
                                    
                                       X
                                       s
                                       −
                                    
                                    =
                                    
                                       {
                                       
                                          (
                                          
                                             u
                                             s
                                          
                                          ,
                                          
                                             u
                                             
                                                s
                                                ′
                                             
                                          
                                          )
                                       
                                       ∈
                                       
                                          B
                                          2
                                       
                                       
                                       |
                                       
                                       
                                          (
                                          
                                             u
                                             s
                                          
                                          ,
                                          
                                             u
                                             
                                                s
                                                ′
                                             
                                          
                                          )
                                       
                                       ≠
                                       
                                          (
                                          1
                                          ,
                                          1
                                          )
                                       
                                       }
                                    
                                 
                               and 
                                 
                                    
                                       X
                                       −
                                    
                                    =
                                    
                                       ∏
                                       
                                          s
                                          ∈
                                          V
                                       
                                    
                                    
                                       X
                                       s
                                       −
                                    
                                 
                              . For 
                                 
                                    u
                                    ,
                                    v
                                    ∈
                                    
                                       X
                                       −
                                    
                                 
                               operations ⊔, ⊓ are defined by

                                 
                                    (151a)
                                    
                                       
                                          
                                             
                                                
                                                   u
                                                   ⊓
                                                   v
                                                
                                             
                                             
                                                
                                                   =
                                                   u
                                                   ∧
                                                   v
                                                   ,
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (151b)
                                    
                                       
                                          
                                             
                                                
                                                   u
                                                   ⊔
                                                   v
                                                
                                             
                                             
                                                
                                                   =
                                                   reduce
                                                   (
                                                   u
                                                   ∨
                                                   v
                                                   )
                                                   ,
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

where 
                                 
                                    reduce
                                    (
                                    w
                                    )
                                 
                               is the labeling obtaining from w by changing labels 
                                 
                                    (
                                    
                                       w
                                       s
                                    
                                    ,
                                    
                                       w
                                       
                                          s
                                          ′
                                       
                                    
                                    )
                                 
                               from (1, 1) to (0, 0) for all 
                                 
                                    s
                                    ∈
                                    V
                                 
                              . It can be seen that these definitions are consistent with Eqs. (141). Components 
                                 
                                    g
                                    c
                                 
                               satisfy

                                 
                                    (152)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      (
                                                      ∀
                                                      
                                                         u
                                                         c
                                                      
                                                      ,
                                                      
                                                         v
                                                         c
                                                      
                                                      ∈
                                                      
                                                         X
                                                         c
                                                         −
                                                      
                                                      )
                                                   
                                                   
                                                   
                                                   
                                                      g
                                                      c
                                                   
                                                   
                                                      (
                                                      
                                                         u
                                                         c
                                                      
                                                      ⊓
                                                      
                                                         v
                                                         c
                                                      
                                                      )
                                                   
                                                   +
                                                   
                                                      g
                                                      c
                                                   
                                                   
                                                      (
                                                      
                                                         u
                                                         c
                                                      
                                                      ⊔
                                                      
                                                         v
                                                         c
                                                      
                                                      )
                                                   
                                                
                                             
                                             
                                          
                                          
                                             
                                                
                                                   ≤
                                                   
                                                      g
                                                      c
                                                   
                                                   
                                                      (
                                                      
                                                         u
                                                         c
                                                      
                                                      )
                                                   
                                                   +
                                                   
                                                      g
                                                      c
                                                   
                                                   
                                                      (
                                                      
                                                         v
                                                         c
                                                      
                                                      )
                                                   
                                                
                                             
                                             
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           

With this reformulation we proceed as follows. Let φ be dual optimal to g. According to the hypergraph 
                                 
                                    (
                                    V
                                    ∪
                                    
                                       V
                                       ′
                                    
                                    ,
                                    G
                                    )
                                    ,
                                 
                               there are only components 
                                 
                                    
                                       φ
                                       
                                          s
                                          ,
                                          c
                                          ∪
                                          
                                             
                                                c
                                             
                                             ′
                                          
                                       
                                    
                                    
                                       (
                                       i
                                       )
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       φ
                                       
                                          
                                             s
                                             ′
                                          
                                          ,
                                          c
                                          ∪
                                          
                                             
                                                c
                                             
                                             ′
                                          
                                       
                                    
                                    
                                       (
                                       i
                                       )
                                    
                                 
                               for 
                                 
                                    c
                                    ∈
                                    E
                                    ,
                                 
                              
                              
                                 
                                    |
                                    c
                                    |
                                    >
                                    1
                                    ,
                                 
                              
                              
                                 
                                    s
                                    ∈
                                    c
                                    ,
                                 
                               and 
                                 
                                    i
                                    ∈
                                    B
                                 
                               and components 
                                 
                                    φ
                                    
                                       ∅
                                       ,
                                       c
                                       ∪
                                       
                                          
                                             c
                                          
                                          ′
                                       
                                    
                                 
                               for 
                                 
                                    c
                                    ∈
                                    E
                                 
                              . Similarly to function g, we can denote the index 
                                 
                                    c
                                    ∪
                                    
                                       
                                          c
                                       
                                       ′
                                    
                                 
                               as just 
                                 c
                              .

If 
                                 
                                    
                                       φ
                                       
                                          ∅
                                          ,
                                          c
                                       
                                    
                                    ≠
                                    0
                                 
                               for some 
                                 
                                    c
                                    ∈
                                    E
                                    ,
                                 
                               we can apply the transformation 
                                 
                                    
                                       g
                                       c
                                    
                                    :
                                    =
                                    
                                       g
                                       c
                                    
                                    −
                                    
                                       φ
                                       
                                          ∅
                                          ,
                                          c
                                       
                                    
                                 
                              ; 
                                 
                                    
                                       g
                                       ∅
                                    
                                    :
                                    =
                                    
                                       g
                                       ∅
                                    
                                    +
                                    
                                       φ
                                       
                                          ∅
                                          ,
                                          c
                                       
                                    
                                 
                              . Clearly this constant transformation does not change bisubmodularity of 
                                 
                                    g
                                    c
                                 
                              . Without loss of generality let us assume now that 
                                 
                                    
                                       φ
                                       
                                          ∅
                                          ,
                                          c
                                       
                                    
                                    =
                                    0
                                 
                               for all 
                                 
                                    c
                                    ∈
                                    E
                                 
                              .

Dual feasibility of BLP relaxation for each component 
                                 
                                    c
                                    ∪
                                    
                                       
                                          c
                                       
                                       ′
                                    
                                 
                               where 
                                 
                                    c
                                    ∈
                                    E
                                    ,
                                 
                              
                              
                                 
                                    |
                                    c
                                    |
                                    >
                                    1
                                 
                               reads 
                                 
                                    (
                                    ∀
                                    
                                       u
                                       
                                          c
                                          ∪
                                          
                                             
                                                c
                                             
                                             ′
                                          
                                       
                                    
                                    )
                                 
                              
                              
                                 
                                    (153)
                                    
                                       
                                          
                                             g
                                             c
                                          
                                          
                                             (
                                             
                                                u
                                                c
                                             
                                             ,
                                             
                                                u
                                                
                                                   
                                                      c
                                                   
                                                   ′
                                                
                                             
                                             )
                                          
                                          −
                                          
                                             ∑
                                             
                                                s
                                                ∈
                                                c
                                             
                                          
                                          
                                             (
                                             
                                                φ
                                                
                                                   s
                                                   ,
                                                   c
                                                
                                             
                                             
                                                (
                                                
                                                   u
                                                   s
                                                
                                                )
                                             
                                             +
                                             
                                                φ
                                                
                                                   
                                                      s
                                                      ′
                                                   
                                                   ,
                                                   c
                                                
                                             
                                             
                                                (
                                                
                                                   u
                                                   
                                                      s
                                                      ′
                                                   
                                                
                                                )
                                             
                                             )
                                          
                                          ≥
                                          0
                                          .
                                       
                                    
                                 
                              And for unary terms (i.e., 
                                 
                                    c
                                    =
                                    {
                                    s
                                    }
                                 
                              ), it is 
                                 
                                    (
                                    ∀
                                    
                                       u
                                       
                                          {
                                          s
                                          ,
                                          
                                             s
                                             ′
                                          
                                          }
                                       
                                    
                                    )
                                 
                              
                              
                                 
                                    (154)
                                    
                                       
                                          
                                             g
                                             s
                                          
                                          
                                             (
                                             
                                                u
                                                s
                                             
                                             ,
                                             
                                                u
                                                
                                                   s
                                                   ′
                                                
                                             
                                             )
                                          
                                          +
                                          
                                             ∑
                                             
                                                d
                                                
                                                   ⊋
                                                   .
                                                
                                                
                                                   {
                                                   s
                                                   }
                                                
                                             
                                          
                                          
                                             (
                                             
                                                φ
                                                
                                                   s
                                                   ,
                                                   d
                                                
                                             
                                             
                                                (
                                                
                                                   u
                                                   
                                                      s
                                                      ′
                                                   
                                                
                                                )
                                             
                                             +
                                             
                                                φ
                                                
                                                   
                                                      s
                                                      ′
                                                   
                                                   ,
                                                   d
                                                
                                             
                                             
                                                (
                                                
                                                   u
                                                   s
                                                
                                                )
                                             
                                             )
                                          
                                          ≥
                                          0
                                          .
                                       
                                    
                                 
                              
                           

By symmetry of g, condition (153) is equivalent to 
                                 
                                    (
                                    ∀
                                    
                                       u
                                       
                                          c
                                          ∪
                                          
                                             
                                                c
                                             
                                             ′
                                          
                                       
                                    
                                    )
                                 
                              
                              
                                 
                                    (155)
                                    
                                       
                                          
                                             g
                                             c
                                          
                                          
                                             (
                                             
                                                
                                                   u
                                                   ¯
                                                
                                                
                                                   
                                                      c
                                                   
                                                   ′
                                                
                                             
                                             ,
                                             
                                                
                                                   u
                                                   ¯
                                                
                                                c
                                             
                                             )
                                          
                                          −
                                          
                                             ∑
                                             
                                                s
                                                ∈
                                                c
                                             
                                          
                                          
                                             (
                                             
                                                φ
                                                
                                                   s
                                                   ,
                                                   c
                                                
                                             
                                             
                                                (
                                                
                                                   u
                                                   s
                                                
                                                )
                                             
                                             +
                                             
                                                φ
                                                
                                                   
                                                      s
                                                      ′
                                                   
                                                   ,
                                                   c
                                                
                                             
                                             
                                                (
                                                
                                                   u
                                                   
                                                      s
                                                      ′
                                                   
                                                
                                                )
                                             
                                             )
                                          
                                          ≥
                                          0
                                       
                                    
                                 
                              and, by flipping all bound variables 
                                 
                                    
                                       u
                                       
                                          c
                                          ∪
                                          
                                             
                                                c
                                             
                                             ′
                                          
                                       
                                    
                                    ,
                                 
                               to 
                                 
                                    (
                                    ∀
                                    
                                       u
                                       
                                          c
                                          ∪
                                          
                                             
                                                c
                                             
                                             ′
                                          
                                       
                                    
                                    )
                                 
                              
                              
                                 
                                    (156)
                                    
                                       
                                          
                                             g
                                             c
                                          
                                          
                                             (
                                             
                                                u
                                                c
                                             
                                             ,
                                             
                                                u
                                                
                                                   
                                                      c
                                                   
                                                   ′
                                                
                                             
                                             )
                                          
                                          −
                                          
                                             ∑
                                             
                                                s
                                                ∈
                                                c
                                             
                                          
                                          
                                             (
                                             
                                                φ
                                                
                                                   s
                                                   ,
                                                   c
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      u
                                                      ¯
                                                   
                                                   
                                                      s
                                                      ′
                                                   
                                                
                                                )
                                             
                                             +
                                             
                                                φ
                                                
                                                   
                                                      s
                                                      ′
                                                   
                                                   ,
                                                   c
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      u
                                                      ¯
                                                   
                                                   s
                                                
                                                )
                                             
                                             )
                                          
                                          ≥
                                          0
                                          .
                                       
                                    
                                 
                              Similarly, for unary terms there holds 
                                 
                                    (
                                    ∀
                                    
                                       u
                                       
                                          {
                                          s
                                          ,
                                          
                                             s
                                             ′
                                          
                                          }
                                       
                                    
                                    )
                                 
                              
                              
                                 
                                    (157)
                                    
                                       
                                          
                                             g
                                             s
                                          
                                          
                                             (
                                             
                                                u
                                                s
                                             
                                             ,
                                             
                                                u
                                                
                                                   s
                                                   ′
                                                
                                             
                                             )
                                          
                                          +
                                          
                                             ∑
                                             
                                                d
                                                
                                                   ⊋
                                                   .
                                                
                                                
                                                   {
                                                   s
                                                   }
                                                
                                             
                                          
                                          
                                             (
                                             
                                                φ
                                                
                                                   s
                                                   ,
                                                   d
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      u
                                                      ¯
                                                   
                                                   
                                                      s
                                                      ′
                                                   
                                                
                                                )
                                             
                                             +
                                             
                                                φ
                                                
                                                   
                                                      s
                                                      ′
                                                   
                                                   ,
                                                   d
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      u
                                                      ¯
                                                   
                                                   s
                                                
                                                )
                                             
                                             )
                                          
                                          ≥
                                          0
                                          .
                                       
                                    
                                 
                              Therefore the dual point φ′ with the following components is feasible:

                                 
                                    (158)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      φ
                                                      
                                                         s
                                                         ,
                                                         c
                                                      
                                                      ′
                                                   
                                                   
                                                      (
                                                      i
                                                      )
                                                   
                                                   :
                                                   =
                                                   
                                                      φ
                                                      
                                                         
                                                            s
                                                            ′
                                                         
                                                         ,
                                                         c
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         i
                                                         ¯
                                                      
                                                      )
                                                   
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      φ
                                                      
                                                         
                                                            s
                                                            ′
                                                         
                                                         ,
                                                         c
                                                      
                                                      ′
                                                   
                                                   
                                                      (
                                                      i
                                                      )
                                                   
                                                   :
                                                   =
                                                   
                                                      φ
                                                      
                                                         s
                                                         ,
                                                         c
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         i
                                                         ¯
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              for 
                                 
                                    c
                                    ∈
                                    E
                                    ,
                                 
                              
                              
                                 
                                    |
                                    c
                                    |
                                    >
                                    1
                                    ,
                                 
                              
                              
                                 
                                    s
                                    ∈
                                    c
                                    ,
                                 
                              
                              
                                 
                                    i
                                    ∈
                                    B
                                 
                               (components 
                                 
                                    
                                       φ
                                       
                                          ∅
                                          ,
                                          c
                                       
                                       ′
                                    
                                    =
                                    0
                                 
                               for 
                                 
                                    c
                                    ∈
                                    E
                                 
                               are omitted in this and subsequent steps). Solution φ′ is clearly optimal to BLP of g since

                                 
                                    
                                       
                                          
                                             g
                                             ∅
                                             φ
                                          
                                          =
                                          
                                             g
                                             ∅
                                          
                                          =
                                          
                                             g
                                             ∅
                                             
                                                φ
                                                ′
                                             
                                          
                                          .
                                       
                                    
                                 
                              Therefore the following symmetrized solution is optimal:

                                 
                                    (159)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         φ
                                                         ^
                                                      
                                                      
                                                         s
                                                         ,
                                                         c
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         u
                                                         s
                                                      
                                                      )
                                                   
                                                   :
                                                   =
                                                
                                             
                                             
                                                
                                                   
                                                      1
                                                      2
                                                   
                                                   
                                                      (
                                                      
                                                         φ
                                                         
                                                            s
                                                            ,
                                                            c
                                                         
                                                      
                                                      
                                                         (
                                                         
                                                            u
                                                            s
                                                         
                                                         )
                                                      
                                                      +
                                                      
                                                         φ
                                                         
                                                            
                                                               s
                                                               ′
                                                            
                                                            ,
                                                            c
                                                         
                                                      
                                                      
                                                         (
                                                         
                                                            
                                                               u
                                                               ¯
                                                            
                                                            s
                                                         
                                                         )
                                                      
                                                      )
                                                   
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         φ
                                                         ^
                                                      
                                                      
                                                         
                                                            s
                                                            ′
                                                         
                                                         ,
                                                         c
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         u
                                                         
                                                            s
                                                            ′
                                                         
                                                      
                                                      )
                                                   
                                                   :
                                                   =
                                                
                                             
                                             
                                                
                                                   
                                                      1
                                                      2
                                                   
                                                   
                                                      (
                                                      
                                                         φ
                                                         
                                                            
                                                               s
                                                               ′
                                                            
                                                            ,
                                                            c
                                                         
                                                      
                                                      
                                                         (
                                                         
                                                            u
                                                            
                                                               s
                                                               ′
                                                            
                                                         
                                                         )
                                                      
                                                      +
                                                      
                                                         φ
                                                         
                                                            s
                                                            ,
                                                            c
                                                         
                                                      
                                                      
                                                         (
                                                         
                                                            
                                                               u
                                                               ¯
                                                            
                                                            
                                                               s
                                                               ′
                                                            
                                                         
                                                         )
                                                      
                                                      )
                                                   
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              Let us check it is bisubmodular. We map this dual solution back to BLP for f by reversing (149) as

                                 
                                    (160)
                                    
                                       
                                          
                                             
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         φ
                                                         ˜
                                                      
                                                      
                                                         s
                                                         ,
                                                         c
                                                      
                                                   
                                                   
                                                      (
                                                      0
                                                      )
                                                   
                                                   :
                                                   =
                                                   
                                                      
                                                         φ
                                                         ^
                                                      
                                                      
                                                         s
                                                         ,
                                                         c
                                                      
                                                   
                                                   
                                                      (
                                                      1
                                                      )
                                                   
                                                   +
                                                   
                                                      
                                                         φ
                                                         ^
                                                      
                                                      
                                                         
                                                            s
                                                            ′
                                                         
                                                         ,
                                                         c
                                                      
                                                   
                                                   
                                                      (
                                                      0
                                                      )
                                                   
                                                   =
                                                   
                                                      φ
                                                      
                                                         s
                                                         ,
                                                         c
                                                      
                                                   
                                                   
                                                      (
                                                      0
                                                      )
                                                   
                                                   +
                                                   
                                                      φ
                                                      
                                                         
                                                            s
                                                            ′
                                                         
                                                         ,
                                                         c
                                                      
                                                   
                                                   
                                                      (
                                                      1
                                                      )
                                                   
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         φ
                                                         ˜
                                                      
                                                      
                                                         s
                                                         ,
                                                         c
                                                      
                                                   
                                                   
                                                      (
                                                      1
                                                      )
                                                   
                                                   :
                                                   =
                                                   
                                                      
                                                         φ
                                                         ^
                                                      
                                                      
                                                         s
                                                         ,
                                                         c
                                                      
                                                   
                                                   
                                                      (
                                                      0
                                                      )
                                                   
                                                   +
                                                   
                                                      
                                                         φ
                                                         ^
                                                      
                                                      
                                                         
                                                            s
                                                            ′
                                                         
                                                         ,
                                                         c
                                                      
                                                   
                                                   
                                                      (
                                                      1
                                                      )
                                                   
                                                   =
                                                   
                                                      φ
                                                      
                                                         s
                                                         ,
                                                         c
                                                      
                                                   
                                                   
                                                      (
                                                      1
                                                      )
                                                   
                                                   +
                                                   
                                                      φ
                                                      
                                                         
                                                            s
                                                            ′
                                                         
                                                         ,
                                                         c
                                                      
                                                   
                                                   
                                                      (
                                                      0
                                                      )
                                                   
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                             
                                                
                                                   
                                                      
                                                         φ
                                                         ˜
                                                      
                                                      
                                                         s
                                                         ,
                                                         c
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         1
                                                         2
                                                      
                                                      )
                                                   
                                                   :
                                                   =
                                                   
                                                      
                                                         φ
                                                         ^
                                                      
                                                      
                                                         s
                                                         ,
                                                         c
                                                      
                                                   
                                                   
                                                      (
                                                      0
                                                      )
                                                   
                                                   +
                                                   
                                                      
                                                         φ
                                                         ^
                                                      
                                                      
                                                         
                                                            s
                                                            ′
                                                         
                                                         ,
                                                         c
                                                      
                                                   
                                                   
                                                      (
                                                      0
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                             
                                             
                                                
                                                   =
                                                   
                                                      1
                                                      2
                                                   
                                                   
                                                      (
                                                      
                                                         φ
                                                         
                                                            s
                                                            ,
                                                            c
                                                         
                                                      
                                                      
                                                         (
                                                         0
                                                         )
                                                      
                                                      +
                                                      
                                                         φ
                                                         
                                                            s
                                                            ,
                                                            c
                                                         
                                                      
                                                      
                                                         (
                                                         1
                                                         )
                                                      
                                                      )
                                                   
                                                   +
                                                   
                                                      1
                                                      2
                                                   
                                                   
                                                      (
                                                      
                                                         φ
                                                         
                                                            
                                                               s
                                                               ′
                                                            
                                                            ,
                                                            c
                                                         
                                                      
                                                      
                                                         (
                                                         0
                                                         )
                                                      
                                                      +
                                                      
                                                         φ
                                                         
                                                            
                                                               s
                                                               ′
                                                            
                                                            ,
                                                            c
                                                         
                                                      
                                                      
                                                         (
                                                         1
                                                         )
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              It satisfies 
                                 
                                    
                                       
                                          φ
                                          ˜
                                       
                                       
                                          s
                                          ,
                                          c
                                       
                                    
                                    
                                       (
                                       
                                          1
                                          2
                                       
                                       )
                                    
                                    =
                                    
                                       1
                                       2
                                    
                                    
                                       (
                                       
                                          
                                             φ
                                             ˜
                                          
                                          
                                             s
                                             ,
                                             c
                                          
                                       
                                       
                                          (
                                          0
                                          )
                                       
                                       +
                                       
                                          
                                             φ
                                             ˜
                                          
                                          
                                             s
                                             ,
                                             c
                                          
                                       
                                       
                                          (
                                          1
                                          )
                                       
                                       )
                                    
                                 
                               and therefore both 
                                 
                                    
                                       φ
                                       ˜
                                    
                                    
                                       s
                                       ,
                                       c
                                    
                                 
                               and 
                                 
                                    −
                                    
                                       
                                          φ
                                          ˜
                                       
                                       
                                          s
                                          ,
                                          c
                                       
                                    
                                 
                               are bisubmodular.

It remains to show that 
                                 
                                    φ
                                    ˜
                                 
                               is optimal to BLP of f′. While it is well known that BLP relaxation is tight for SoB function 
                                 
                                    
                                       f
                                       ′
                                    
                                    :
                                    
                                       K
                                       
                                          1
                                          /
                                          2
                                       
                                    
                                    →
                                    R
                                    ,
                                 
                               
                              e.g. [66], it is not obvious that BLP relaxation for the reformulation 
                                 
                                    g
                                    :
                                    
                                       B
                                       
                                          2
                                          V
                                       
                                    
                                    →
                                    R
                                 
                               is tight as well. Let us show this is the case. It will follow then that 
                                 
                                    
                                       φ
                                       ˜
                                    
                                    ,
                                 
                               constructed from an optimal dual solution 
                                 
                                    φ
                                    ^
                                 
                               to BLP of g, is optimal to BLP of f′.

                                 Statement A.11
                                 The BLP relaxation for sum of bisubmodular functions 
                                       
                                          g
                                          :
                                          
                                             B
                                             
                                                2
                                                V
                                             
                                          
                                          →
                                          R
                                       
                                     is tight.

The schema of the proof is similar to e.g. [12, T.6.2] or [52] who considered sum of submodular functions. We construct a primal integer optimal solution from an arc-consistent optimal dual solution. In the construction we will need that the reparametrized problem g
                                    φ is a sum of bisubmodular functions. Therefore we need an arc consistent symmetric optimal dual solution.

We start by taking a pair (μ, φ) that satisfies strict complementarity slackness for BLP of g. Since arc consistency is a necessary condition for strict complementarity, φ is arc consistent. As was shown before, φ′ defined by Eqs. (158) is dual optimal to BLP of g. It is arc consistent because φ was arc consistent. By taking a symmetrized dual solution 
                                       
                                          φ
                                          ^
                                       
                                     defined by Eqs. (159) we obtain an optimal symmetric arc consistent dual solution. By symmetry, it preserves component-wise bisubmodularity.

Let now 
                                       
                                          φ
                                          :
                                          =
                                          
                                             φ
                                             ^
                                          
                                       
                                    . We construct an integer solution as:

                                       
                                          (161)
                                          
                                             
                                                
                                                   u
                                                   s
                                                   *
                                                
                                                =
                                                ⋀
                                                
                                                   {
                                                   i
                                                   ∈
                                                   B
                                                   
                                                   |
                                                   
                                                   
                                                      g
                                                      s
                                                      φ
                                                   
                                                   
                                                      (
                                                      i
                                                      )
                                                   
                                                   =
                                                   0
                                                   }
                                                
                                                .
                                             
                                          
                                       
                                    In order to show that u
                                    * is optimal we prove complementarity with φ. Let 
                                       
                                          c
                                          ∈
                                          E
                                       
                                    . By arc consistency, for every 
                                       
                                          s
                                          ∈
                                          c
                                       
                                     there exists 
                                       
                                          u
                                          
                                             c
                                          
                                          
                                             (
                                             s
                                             )
                                          
                                       
                                     such that 
                                       
                                          
                                             u
                                             s
                                             
                                                (
                                                s
                                                )
                                             
                                          
                                          =
                                          
                                             u
                                             s
                                             *
                                          
                                       
                                     and 
                                       
                                          
                                             g
                                             c
                                             φ
                                          
                                          
                                             (
                                             
                                                u
                                                c
                                                
                                                   (
                                                   s
                                                   )
                                                
                                             
                                             )
                                          
                                          =
                                          0
                                       
                                    . It also follows that 
                                       
                                          (
                                          ∀
                                          t
                                          ∈
                                          c
                                          
                                          |
                                          
                                          t
                                          ≠
                                          s
                                          )
                                       
                                    
                                    
                                       
                                          
                                             g
                                             t
                                             φ
                                          
                                          
                                             (
                                             
                                                u
                                                t
                                                
                                                   (
                                                   s
                                                   )
                                                
                                             
                                             )
                                          
                                          =
                                          0
                                       
                                     and hence 
                                       
                                          
                                             u
                                             t
                                             
                                                (
                                                s
                                                )
                                             
                                          
                                          ≥
                                          
                                             u
                                             t
                                             *
                                          
                                       
                                    . It follows that 
                                       
                                          
                                             u
                                             c
                                             *
                                          
                                          =
                                          
                                             ⋀
                                             
                                                s
                                                ∈
                                                c
                                             
                                          
                                          
                                             u
                                             c
                                             
                                                (
                                                s
                                                )
                                             
                                          
                                       
                                     and by component-wise bisubmodularity we have that

                                       
                                          
                                             
                                                
                                                   g
                                                   c
                                                   φ
                                                
                                                
                                                   (
                                                   
                                                      ⋀
                                                      
                                                         s
                                                         ∈
                                                         c
                                                      
                                                   
                                                   
                                                      u
                                                      c
                                                      
                                                         (
                                                         s
                                                         )
                                                      
                                                   
                                                   )
                                                
                                                =
                                                0
                                                .
                                             
                                          
                                       
                                    From feasibility and complementarity slackness follows u
                                    * is optimal. Therefore BLP relaxation for g is tight.□

It follows that 
                                 
                                    φ
                                    ˜
                                 
                               constructed in (160) not only feasible to BLP of f′ but achieves the optimal dual objective 
                                 
                                    
                                       f
                                       ∅
                                       
                                          φ
                                          ˜
                                       
                                    
                                    =
                                    
                                       g
                                       ∅
                                       φ
                                    
                                    =
                                    
                                       min
                                       
                                          u
                                          ∈
                                          
                                             B
                                             
                                                2
                                                V
                                             
                                          
                                       
                                    
                                    
                                       E
                                       g
                                    
                                    
                                       (
                                       u
                                       )
                                    
                                 
                              .□


                              Mapping p′ defined in Lemma 
                              
                                 A.9
                               
                              by an optimal solution
                              
                                 
                                    
                                       x
                                       *
                                    
                                    ∈
                                    
                                       K
                                       
                                          1
                                          /
                                          2
                                       
                                    
                                 
                               
                              is BLP-improving for f′.
                           

Let φ provide a component-wise bisubmodular optimal reparametrization f′φ for BLP of f′ which exists by Lemma A.10. Since BLP for f′ is tight, φ and δ(x
                              *) must satisfy complementary slackness. For every hyperedge 
                                 
                                    c
                                    ∈
                                    E
                                    ,
                                 
                              
                              
                                 
                                    c
                                    ≠
                                    ∅
                                 
                               by dual feasibility 
                                 
                                    
                                       f
                                       c
                                       
                                          ′
                                          φ
                                       
                                    
                                    ≥
                                    0
                                 
                               and by complementary slackness

                                 
                                    (162)
                                    
                                       
                                          
                                             f
                                             c
                                             
                                                ′
                                                φ
                                             
                                          
                                          
                                             (
                                             
                                                x
                                                c
                                                *
                                             
                                             )
                                          
                                          =
                                          0
                                          .
                                       
                                    
                                 
                              Therefore, labeling 
                                 
                                    x
                                    c
                                    *
                                 
                               is a minimizer of 
                                 
                                    f
                                    c
                                    
                                       ′
                                       φ
                                    
                                 
                              . Since 
                                 
                                    f
                                    c
                                    
                                       ′
                                       φ
                                    
                                 
                               is bisubmodular it follows by the same argument as in Eqs. (144), (145) that for each hyperedge 
                                 c
                               we have the component-wise autarky property:

                                 
                                    (163)
                                    
                                       
                                          
                                             (
                                             ∀
                                             
                                                x
                                                c
                                             
                                             ∈
                                             
                                                K
                                                c
                                                
                                                   1
                                                   /
                                                   2
                                                
                                             
                                             )
                                          
                                          
                                          
                                          
                                             f
                                             
                                                c
                                             
                                             ′
                                          
                                          
                                             
                                             φ
                                          
                                          
                                             (
                                             
                                                p
                                                c
                                                ′
                                             
                                             
                                                (
                                                
                                                   x
                                                   c
                                                
                                                )
                                             
                                             )
                                          
                                          ≤
                                          
                                             f
                                             
                                                c
                                             
                                             ′
                                          
                                          
                                             
                                             φ
                                          
                                          
                                             (
                                             
                                                x
                                                c
                                             
                                             )
                                          
                                          ;
                                       
                                    
                                 
                              By the characterization Theorem 3.3(c), mapping p′ is BLP-improving for f′.□


                              Persistency by SoB relaxation
                              
                                 [27]
                               
                              corresponds to a BLP-improving mapping.
                           

Let p′ and p be mappings defined in Lemma A.9, corresponding to the persistency [27]. We need to show that mapping p is BLP-improving for f. By Lemma A.12, p′ is BLP-improving for f′. The discrete relaxation f′ is obtained from f with add_labels which has inclusion of admissible BLP-improving maps (Theorem A.5). By Lemma A.9(b), p′ is admissible and thus Theorem A.5 applies.□

The 0–1 polynomial programming problem is the following optimization problem:

                           
                              (PP)
                              
                                 
                                    min
                                    
                                       ∑
                                       
                                          J
                                          ⊂
                                          V
                                       
                                    
                                    
                                       c
                                       J
                                    
                                    
                                       ∏
                                       
                                          j
                                          ∈
                                          J
                                       
                                    
                                    
                                       x
                                       j
                                    
                                    ,
                                 
                              
                           
                        where x is binary and coefficients 
                           
                              
                                 c
                                 J
                              
                              ∈
                              R
                           
                         are not necessarily all non-zero. The objective of (PP) is a multilinear polynomial expression, which can be written uniquely for any polynomial in 0–1 variables applying the identity 
                           
                              
                                 x
                                 j
                                 2
                              
                              =
                              
                                 x
                                 j
                              
                           
                        . Adams et al. [2] considered a hierarchy of relaxations of Sherali and Adams [58] for this problem. A relaxation of level d can be constructed assuming that for all |J| > d coefficients cJ
                         are zero.

To match their result we need the following:

                           
                              •
                              A hypergraph 
                                    
                                       (
                                       V
                                       ,
                                       E
                                       )
                                       ,
                                    
                                  where 
                                    E
                                  contains all subsets of 
                                    V
                                  of cardinality up to d (in case 
                                    
                                       d
                                       =
                                       2
                                    
                                  it is a fully connected graph):

                                    
                                       
                                          
                                             E
                                             =
                                             {
                                             J
                                             ⊂
                                             V
                                             
                                             |
                                             
                                             |
                                             J
                                             |
                                             ≤
                                             d
                                             }
                                          
                                       
                                    
                                 
                              

Represent the problem (PP) as energy minimization with terms

                                    
                                       (164)
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         f
                                                         J
                                                      
                                                      
                                                         (
                                                         
                                                            x
                                                            J
                                                         
                                                         )
                                                      
                                                      =
                                                      
                                                         {
                                                         
                                                            
                                                               
                                                                  
                                                                     c
                                                                     J
                                                                  
                                                               
                                                               
                                                                  
                                                                     
                                                                     if
                                                                     
                                                                     
                                                                        x
                                                                        J
                                                                     
                                                                     =
                                                                     
                                                                        1
                                                                        J
                                                                     
                                                                     ,
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  0
                                                               
                                                               
                                                                  
                                                                     
                                                                     otherwise
                                                                     .
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              

Consider the FLP relaxation.

The persistency result [2, Lemma 3.2] can be described as follows. Their lemma partitions the set of nodes as 
                           
                              V
                              =
                              
                                 N
                                 +
                              
                              ∪
                              
                                 N
                                 −
                              
                              ∪
                              
                                 N
                                 f
                              
                           
                        . A sufficient condition is proposed implying that the partial assignment 
                           
                              
                                 x
                                 
                                    N
                                    −
                                 
                              
                              =
                              0
                              ,
                           
                        
                        
                           
                              
                                 x
                                 
                                    N
                                    +
                                 
                              
                              =
                              1
                           
                         is globally optimal.

We interpret their result in the dual decomposition framework. The hypergraph 
                           
                              (
                              V
                              ,
                              E
                              )
                           
                         is split into two parts:

                           
                              •
                              Nodes 
                                    
                                       
                                          V
                                          1
                                       
                                       =
                                       
                                          N
                                          f
                                       
                                       ,
                                    
                                  hyperedges 
                                    
                                       
                                          E
                                          1
                                       
                                       =
                                       
                                          {
                                          
                                          J
                                          ∈
                                          E
                                          
                                          |
                                          
                                          J
                                          ⊂
                                          
                                             N
                                             f
                                          
                                          }
                                       
                                    
                                 .

Nodes 
                                    
                                       
                                          V
                                          2
                                       
                                       =
                                       
                                          N
                                          +
                                       
                                       ∪
                                       
                                          N
                                          −
                                       
                                       ∪
                                       b
                                       ,
                                    
                                  hyperedges 
                                    
                                       
                                          E
                                          2
                                       
                                       =
                                       
                                          {
                                          J
                                          ∈
                                          E
                                          
                                          |
                                          
                                          J
                                          ¬
                                          ⊂
                                          
                                             N
                                             f
                                          
                                          }
                                       
                                       ,
                                    
                                  where 
                                    b
                                  is the following boundary set:

                                    
                                       (165)
                                       
                                          
                                             B
                                             =
                                             {
                                             v
                                             ∈
                                             
                                                N
                                                f
                                             
                                             
                                             |
                                             
                                             
                                                (
                                                ∃
                                                J
                                                ∈
                                                E
                                                )
                                             
                                             
                                             v
                                             ∈
                                             J
                                             ,
                                             
                                             J
                                             ¬
                                             ⊂
                                             
                                                N
                                                f
                                             
                                             }
                                             .
                                          
                                       
                                    
                                 
                              

It can be seen that hyperedges 
                           
                              
                                 E
                                 1
                              
                              ,
                           
                        
                        
                           
                              E
                              2
                           
                         form a partition of 
                           E
                         whereas the sets of nodes 
                           
                              
                                 V
                                 1
                              
                              ,
                           
                        
                        
                           
                              V
                              2
                           
                         overlap over 
                           b
                        . Accordingly to the two hypergraphs we define the decomposition:

                           
                              (166)
                              
                                 
                                    f
                                    
                                       (
                                       x
                                       )
                                    
                                    =
                                    
                                       f
                                       1
                                    
                                    
                                       (
                                       
                                          x
                                          
                                             V
                                             1
                                          
                                       
                                       )
                                    
                                    +
                                    
                                       f
                                       2
                                    
                                    
                                       (
                                       
                                          x
                                          
                                             V
                                             2
                                          
                                       
                                       )
                                    
                                    ,
                                 
                              
                           
                        where

                           
                              (167a)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                f
                                                1
                                             
                                             :
                                             
                                                V
                                                1
                                             
                                             →
                                             R
                                             :
                                             x
                                             ↦
                                             
                                                ∑
                                                
                                                   J
                                                   ∈
                                                   
                                                      E
                                                      1
                                                   
                                                
                                             
                                             
                                                c
                                                J
                                             
                                             
                                                x
                                                J
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (167b)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                f
                                                2
                                             
                                             :
                                             
                                                V
                                                2
                                             
                                             →
                                             R
                                             :
                                             x
                                             ↦
                                             
                                                ∑
                                                
                                                   J
                                                   ∈
                                                   
                                                      E
                                                      2
                                                   
                                                
                                             
                                             
                                                c
                                                J
                                             
                                             
                                                x
                                                J
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

If we found an optimal solution to f
                        1 and an optimal solution to f
                        2 and accidentally they were consistent over the overlap part 
                           b
                         we would have obtained an optimal solution to f.

We will show that the conditions of Adams et al. [2] imply that an arbitrary solution 
                           
                              x
                              
                                 V
                                 1
                              
                           
                         to f
                        1 defines an optimal solution x′ to f
                        2 given by

                           
                              (168)
                              
                                 
                                    
                                       x
                                       s
                                       ′
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   
                                                      x
                                                      s
                                                   
                                                   ,
                                                
                                             
                                             
                                                
                                                   s
                                                   ∈
                                                   b
                                                
                                             
                                          
                                          
                                             
                                                
                                                   0
                                                   ,
                                                
                                             
                                             
                                                
                                                   s
                                                   ∈
                                                   
                                                      N
                                                      −
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   1
                                                   ,
                                                
                                             
                                             
                                                
                                                   s
                                                   ∈
                                                   
                                                      N
                                                      +
                                                   
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        In other words, any extension of 
                           
                              x
                              
                                 V
                                 1
                              
                           
                         to 
                           
                              V
                              2
                           
                         defines an optimal solution to f
                        2. In fact, under these conditions, what happens inside the problem f
                        1 is irrelevant.

Recall that the relaxation [2] is obtained by introducing a relaxed variable wJ
                         ∈ [0, 1] in place of every product ∏
                           s ∈ J
                        
                        xJ
                        . The constraints are represented by the following linear forms:

                           
                              (169)
                              
                                 
                                    
                                       f
                                       d
                                    
                                    
                                       (
                                       
                                          J
                                          1
                                       
                                       ,
                                       
                                          J
                                          2
                                       
                                       )
                                    
                                    =
                                    
                                       ∑
                                       
                                          
                                             J
                                             ′
                                          
                                          ⊂
                                          
                                             J
                                             2
                                          
                                       
                                    
                                    
                                       
                                          (
                                          −
                                          1
                                          )
                                       
                                       
                                          
                                             |
                                          
                                          
                                             J
                                             ′
                                          
                                          
                                             |
                                          
                                       
                                    
                                    
                                       w
                                       
                                          
                                             J
                                             1
                                          
                                          ∪
                                          
                                             J
                                             ′
                                          
                                       
                                    
                                 
                              
                           
                        for each 
                           
                              
                                 J
                                 1
                              
                              ∩
                              
                                 J
                                 2
                              
                              =
                              ∅
                           
                         and 
                           
                              
                                 |
                              
                              
                                 J
                                 1
                              
                              ∪
                              
                                 J
                                 2
                              
                              
                                 |
                                 =
                                 d
                              
                           
                        . The relaxation, denoted LP(d/n) is given by

                           
                              (170)
                              
                                 
                                    
                                       
                                       
                                          
                                             min
                                             
                                                ∑
                                                
                                                   J
                                                   ⊂
                                                   V
                                                
                                             
                                             
                                                c
                                                J
                                             
                                             
                                                w
                                                J
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                       
                                       
                                          
                                             
                                                (
                                                ∀
                                             
                                             
                                                J
                                                1
                                             
                                             ,
                                             
                                                J
                                                2
                                             
                                             
                                                
                                                |
                                             
                                             
                                                J
                                                1
                                             
                                             ∪
                                             
                                                J
                                                2
                                             
                                             
                                                |
                                                =
                                                d
                                                ,
                                                
                                                   J
                                                   1
                                                
                                                ∩
                                                
                                                   J
                                                   2
                                                
                                                =
                                                ∅
                                                )
                                             
                                             
                                             
                                                f
                                                d
                                             
                                             
                                                (
                                                
                                                   J
                                                   1
                                                
                                                ,
                                                
                                                   J
                                                   2
                                                
                                                )
                                             
                                             ≥
                                             0
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        This relaxation can be matched to FLP by the relation

                           
                              (171)
                              
                                 
                                    
                                       μ
                                       J
                                    
                                    
                                       (
                                       
                                          x
                                          J
                                       
                                       )
                                    
                                    =
                                    
                                       f
                                       d
                                    
                                    
                                       (
                                       
                                          J
                                          1
                                       
                                       ,
                                       
                                          J
                                          2
                                       
                                       )
                                    
                                    ,
                                 
                              
                           
                        where 
                           
                              
                                 J
                                 1
                              
                              ∩
                              
                                 J
                                 2
                              
                              =
                              ∅
                              ,
                           
                        
                        
                           
                              
                                 J
                                 1
                              
                              ∪
                              
                                 J
                                 2
                              
                              =
                              J
                              ,
                           
                        
                        
                           
                              d
                              =
                              |
                              J
                              |
                              ,
                           
                        
                        
                           
                              
                                 x
                                 
                                    J
                                    1
                                 
                              
                              =
                              1
                              ,
                           
                        
                        
                           
                              
                                 x
                                 
                                    J
                                    2
                                 
                              
                              =
                              0
                           
                        . In particular,

                           
                              (172)
                              
                                 
                                    
                                       μ
                                       J
                                    
                                    
                                       (
                                       
                                          1
                                          J
                                       
                                       )
                                    
                                    =
                                    
                                       w
                                       J
                                    
                                    ,
                                 
                              
                           
                        where 1
                           J
                         is a |J|-vector of ones. For w feasible to LP(d/n), the terms fd
                        (J
                        1, J
                        2) are non-negative and satisfy marginalization constraints according to [2, equation 2.3]. It follows from these marginalization constraints that a feasible solution satisfies further inequality constraints:

                           
                              
                                 
                                    
                                       (
                                       ∀
                                       p
                                       ≤
                                       d
                                       ,
                                       ∀
                                       
                                          
                                             (
                                             
                                                J
                                                1
                                             
                                             ,
                                             
                                                J
                                                2
                                             
                                             )
                                          
                                          d
                                       
                                       )
                                    
                                    
                                    
                                       f
                                       p
                                    
                                    
                                       (
                                       
                                          J
                                          1
                                       
                                       ,
                                       
                                          J
                                          2
                                       
                                       )
                                    
                                    ≥
                                    0
                                    .
                                 
                              
                           
                        This ensures that the corresponding solution μ is feasible to FLP and hence the relaxations are identical. The persistency lemma formulated in [2, Lemma 3.2] has the following form.

                           Lemma A.13
                           Lemma 3.2 of Adams et al. [2]
                           


                           
                              Let
                              
                                 
                                    
                                       N
                                       +
                                    
                                    ∪
                                    
                                       N
                                       −
                                    
                                    ∪
                                    
                                       N
                                       f
                                    
                                 
                               
                              be a partition of
                              
                                 V
                              
                              . Let there exist dual multipliers satisfying certain sufficient condition (as defined in 
                              
                                 [2]
                              
                              ). Then there exists an optimal solution to LP(d/n) having
                              
                                 
                                    
                                       w
                                       s
                                    
                                    =
                                    1
                                 
                               
                              for
                              
                                 
                                    s
                                    ∈
                                    
                                       N
                                       +
                                    
                                 
                               
                              and
                              
                                 
                                    
                                       w
                                       s
                                    
                                    =
                                    0
                                 
                               
                              for
                              
                                 
                                    s
                                    ∈
                                    
                                       N
                                       −
                                    
                                 
                              
                              .
                           

For an interested reader we remark that the sufficient conditions of their lemma ensure a dual feasible solution for f
                        2 which is complementary to the solution defined by 
                           
                              
                                 N
                                 +
                              
                              ,
                           
                        
                        
                           
                              N
                              −
                           
                         on 
                           
                              
                                 N
                                 +
                              
                              ∪
                              
                                 N
                                 −
                              
                           
                         and is zero on all boundary constraints 
                           
                              J
                              ⊂
                              b
                           
                        . This ensures complementarity with any feasible primal solution consistent with 
                           
                              
                                 N
                                 +
                              
                              ,
                           
                        
                        
                           
                              N
                              −
                           
                        . We are not going to prove this claim formally, but use the existing lemma together with the observation that their sufficient condition does not depend on the coefficients {cJ
                         | J ⊂ N f
                        }.

                           Lemma A.14
                           
                              Assume that the conditions of Lemma 
                              
                                 A.13
                               
                              are satisfied. Let
                              
                                 
                                    
                                       w
                                       s
                                    
                                    =
                                    1
                                 
                               
                              for
                              
                                 
                                    s
                                    ∈
                                    
                                       N
                                       +
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       w
                                       s
                                    
                                    =
                                    0
                                 
                               
                              for
                              
                                 
                                    s
                                    ∈
                                    
                                       N
                                       −
                                    
                                 
                               
                              and let w be feasible to LP(d/n). Then w is optimal to LP(
                              
                                 
                                    
                                       d
                                       /
                                       |
                                    
                                    
                                       V
                                       2
                                    
                                    
                                       |
                                    
                                 
                              
                              ) for f
                              2
                              .
                           

It can be seen from [2, equation 3.4d] that if the conditions of their Lemma are satisfied then they are also satisfied with coefficients 
                                 
                                    
                                       c
                                       J
                                    
                                    =
                                    0
                                 
                               for all J ⊂ N f
                              . Since w is feasible, it is also feasible to their equation 3.5[d]. The objective of the latter is identically zero, therefore w is optimal to their equation 3.5[d]. Lemma A.13 proves that w is optimal to LP(d/n). Since we made f
                              1 zero, w is optimal to LP(
                                 
                                    
                                       d
                                       /
                                       |
                                    
                                    
                                       V
                                       2
                                    
                                    
                                       |
                                    
                                 
                              ) for f
                              2.□

With this refined result we can easily prove the relaxed-improving property. Define the mapping

                           
                              (173)
                              
                                 
                                    
                                       p
                                       s
                                    
                                    
                                       (
                                       
                                          x
                                          s
                                       
                                       )
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   0
                                                   ,
                                                
                                             
                                             
                                                
                                                   s
                                                   ∈
                                                   
                                                      N
                                                      −
                                                   
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                                
                                                   1
                                                   ,
                                                
                                             
                                             
                                                
                                                   s
                                                   ∈
                                                   
                                                      N
                                                      +
                                                   
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      x
                                                      s
                                                   
                                                   ,
                                                
                                             
                                             
                                                
                                                   otherwise
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           Theorem A.15
                           
                              Persistency by the sufficient condition of Adams et al. [
                              
                                 2
                              
                              , Lemma 3.2] corresponds to an FLP-improving mapping.
                           

We need to show that mapping p is FLP-improving. Let μ ∈ Λ. Then μ′ ≔ [p]μ ∈ Λ is optimal to f
                              2 by Lemma A.14. At the same time 
                                 
                                    (
                                    ∀
                                    J
                                    ∈
                                    E
                                    ,
                                    J
                                    ∩
                                    
                                       N
                                       f
                                    
                                    ≠
                                    ∅
                                    )
                                 
                               we have 
                                 
                                    
                                       μ
                                       J
                                       ′
                                    
                                    =
                                    
                                       μ
                                       J
                                    
                                 
                               and hence 
                                 
                                    
                                       〈
                                       
                                          f
                                          1
                                       
                                       ,
                                       
                                          μ
                                          J
                                       
                                       〉
                                    
                                    =
                                    
                                       〈
                                       
                                          f
                                          1
                                       
                                       ,
                                       
                                          μ
                                          J
                                          ′
                                       
                                       〉
                                    
                                 
                              . It follows that

                                 
                                    (174)
                                    
                                       
                                          
                                             〈
                                             f
                                             ,
                                             
                                                [
                                                p
                                                ]
                                             
                                             μ
                                             〉
                                          
                                          =
                                          
                                             〈
                                             
                                                f
                                                1
                                             
                                             ,
                                             
                                                [
                                                p
                                                ]
                                             
                                             μ
                                             〉
                                          
                                          +
                                          
                                             〈
                                             
                                                f
                                                2
                                             
                                             ,
                                             
                                                [
                                                p
                                                ]
                                             
                                             μ
                                             〉
                                          
                                          ≤
                                          
                                             〈
                                             f
                                             ,
                                             μ
                                             〉
                                          
                                          .
                                       
                                    
                                 
                              
                              □

We obtained that FLP maximum persistency dominates the persistency result of Adams et al. [2]. In case of strong persistency, the former is found by Algorithm 1.

In the pairwise case, conditions [2] are always satisfied for the same persistency assignment as the roof dual. However, in the higher order case our conditions are less restrictive as can be seen from the dual representation (29): we require less inequalities than the complementarity slackness imposed on all solutions of the unassigned part.

@&#REFERENCES@&#

