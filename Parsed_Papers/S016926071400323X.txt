@&#MAIN-TITLE@&#Recurrence predictive models for patients with hepatocellular carcinoma after radiofrequency ablation using support vector machines with feature selection methods

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           To develop recurrence predictive models using the clinical data “before” RFA.


                        
                        
                           
                           To compare models using different feature selection methods combined with SVM.


                        
                        
                           
                           The hybrid methods combined with SVM had better performance.


                        
                        
                           
                           The predictive models can provide suggestive high-risk recurrent patients.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Predictive model

Radiofrequency ablation

Hepatocellular carcinoma

Feature selection

Support vector machine

@&#ABSTRACT@&#


               
               
                  Background and objective
                  Recurrence of hepatocellular carcinoma (HCC) is an important issue despite effective treatments with tumor eradication. Identification of patients who are at high risk for recurrence may provide more efficacious screening and detection of tumor recurrence. The aim of this study was to develop recurrence predictive models for HCC patients who received radiofrequency ablation (RFA) treatment.
               
               
                  Methods
                  From January 2007 to December 2009, 83 newly diagnosed HCC patients receiving RFA as their first treatment were enrolled. Five feature selection methods including genetic algorithm (GA), simulated annealing (SA) algorithm, random forests (RF) and hybrid methods (GA+RF and SA+RF) were utilized for selecting an important subset of features from a total of 16 clinical features. These feature selection methods were combined with support vector machine (SVM) for developing predictive models with better performance. Five-fold cross-validation was used to train and test SVM models.
               
               
                  Results
                  The developed SVM-based predictive models with hybrid feature selection methods and 5-fold cross-validation had averages of the sensitivity, specificity, accuracy, positive predictive value, negative predictive value, and area under the ROC curve as 67%, 86%, 82%, 69%, 90%, and 0.69, respectively.
               
               
                  Conclusions
                  The SVM derived predictive model can provide suggestive high-risk recurrent patients, who should be closely followed up after complete RFA treatment.
               
            

@&#INTRODUCTION@&#

HCC is the most common primary liver cancer [1–3]. According to the global cancer statistics in 2008, liver cancer is the third common cause of cancer death [4]. In a recent study of cancer statistics in the United States, death rates of liver cancer increased in both men and women between 1990–1991 and 2006 [5]. Meanwhile in Taiwan, HCC has been the leading cause of cancer death since 1984, causing 7700 annual cancer deaths (approximately 25.77 liver cancer mortality rate in one hundred thousand population) [6,7].

The commonly utilized modalities for treating HCC include liver transplantation, surgical resection, local ablation therapies (e.g., percutaneous ethanol injection therapy (PEIT), microwave coagulation therapy (MCT), and radiofrequency ablation (RFA)), transcatheter arterial chemoembolization (TACE) and target therapy [8,9]. For patients with unresectable HCC, RFA can be considered as a valuable treatment option [10]. Currently, both surgical resection and RFA are suggested as the first line treatment modalities to treat early stage hepatocellular carcinoma (Barcelona Clinic Liver Cancer staging 0 and stage A [11]) with good liver reserve according to the internationally endorsed guidelines, such as European Association for the Study of the Liver (EASL) [12], Asian Pacific Association for the Study of the Liver (APASL) [13], and American Association Study of the Liver Disease (AASLD) [14]. RFA is also a safe and effective bridging therapy before liver transplantation for cirrhotic patients with small HCC [15]. RFA had better complete tumor ablation rate and 3-year overall survival than PEIT [16]. Comparable overall survival was achieved by RFA for small HCC when compared with surgery [17–21]. In addition, RFA is less invasive and has lower rates of complications and lower costs than surgery [22,23].

However, recurrences of HCC are still common with cumulative 5-year recurrence rate of more than 70% despite effective tumor ablation by RFA [24–26]. Therefore, identification of the patients who are high risk for tumor recurrence after treatment is important. With the establishment of the recurrence predictive models, high-risk patients could be followed up more frequently than routine schedule. The recurrence predictive models play a crucial role for physicians and patients in supporting the clinical decision-making in the follow-up of these patients.

Recently, numerous studies have been proposed for analyzing the risk factors that affect the prognosis after RFA for the patients with HCC [25,27–29]. Different risk factors were identified in different studies and no conclusive results or presumptive predictive models were established.

In the past few years, support vector machines (SVMs) have been widely employed in medical domain, including the diagnosis of breast cancer [30], the diagnosis of fatty liver [31], the diagnosis of hepatitis disease [32,33], the classification and grading of liver fibrosis [34,35], the prediction of the preferred treatment position for patients with breast cancer [36], the prediction of radiation pneumonitis arising for patients with lung cancer [37], the diagnostic models for ovarian tumor [38], etc. However, SVMs are not applied for tumor recurrence risk identification in the past. With the use of pre-treatment data, the feature selection methods plus SVMs were employed for developing the recurrence predictive model for newly diagnosed HCC patients receiving RFA treatment in our study.

Our study was approved for data mining and information extraction by our institutional review board (Reg. 201002032R and 201302013RINC). A total of 83 newly diagnosed HCC patients were included in this study and they had received ultrasound guided RFA as the first treatment for HCC in National Taiwan University Hospital (NTUH) between 2007 and 2009. The diagnosis of HCC was confirmed according to the guideline from American Association for the Study of Liver Diseases [14,39] by one of the following diagnostic criteria: (1) Histopathology; (2) Elevated alpha-fetoprotein (AFP) level >200ng/ml plus one typical HCC vascular pattern on computed tomography (CT), magnetic resonance image (MRI) or angiography (Fig. 1A–C: tumor pre-treatment); (3) At least two typical imaging studies diagnostic for HCC if AFP levels were not elevated.

RFA was performed under anesthesia using LeVeen CoAccess™ electrode system (Boston Scientific Co, USA) with an RF-3000 generator. The tines of the needle were expanded to cover the whole treated tumor. The ablation protocol followed the suggestion from the industry accordingly. Complete tumor ablation was confirmed by computed tomography and/or magnetic resonance image within 2–4 weeks (Fig. 1D–F: tumor post-treatment). The complete tumor ablation of the HCC is defined as absence of any contrast enhancement within or at the periphery of the HCC nodules according to the mRECIST criteria [40]. Patients were subsequently followed regularly by imaging and alpha-fetoprotein levels every three to six months according to the guideline [41]. Tumor recurrence is defined as the appearance of the new hypervascular tumor with typical enhancement pattern by follow-up CT or MRI [42].

The data values before and closest to the RFA treatment were collected as pre-treatment values for this study. The 16 clinical features collected for analysis were age, gender, tumor number, the size of the maximal tumor, liver cirrhosis, Barcelona Clinic Liver Cancer (BCLC) staging classification [11], and 10 serum laboratory tests, including prothrombin time (INR), albumin, aspartate aminotransferase (AST), alanine transaminase (ALT), total bilirubin, creatinine, platelet count, α-fetoprotein (AFP), HBsAg, and anti-HCV.

The patients involved met one of these criteria: (1) 1-year Recurrence (1-y R): HCC was recurrent within 1 year after the RFA treatment, (2) 1-year Non-recurrence (1-y NR): HCC was not recurrent within 1 year after the RFA treatment. Of the 83 patients, 18 patients had recurrent HCCs in 1 year after the RFA treatment (and 65 patients had no HCC recurrence in 1 year). The characteristics comparisons between groups with and without HCC recurrence were performed by Mann–Whitney U test also known as Wilcoxon rank-sum test (for continuous clinical features) and Fisher's exact test (for categorical clinical features). Univariate and multivariate logistic regression tests were used for risk factor analysis of HCC recurrence.

The overview of method establishment was illustrated in Fig. 2
                        . The training data set was used for training the predictive models. To train and test these SVM models, a double five-fold cross-validation loop method was adopted. In an outer loop five-fold cross-validation, the whole data set was divided into five subsets. Four of these five subsets were combined and regarded as training data set, and the remaining one was regarded as testing/validation data set. This cross-validation process repeated 5 times, and each subset had been used exactly once for testing/validation. An inner loop five-fold cross-validation was further performed based on a training data set of an outer loop and used for searching appropriate parameter settings of SVM models.

Three steps were included in the process of developing and evaluating the predictive models, including feature selection, model training, and model testing/validation. In feature selection step, training data set was used for selecting appropriate clinical features from a total of 16 clinical features for training the SVM model. In the model training step, the appropriate parameters of SVM model were decided using grid search based on the inner loop five-fold cross-validation [43,44]. In the model testing/validation step, the selected parameter settings were used for training the whole training data set of an outer loop five-fold cross-validation. A trained SVM model was established and this training classification result was used for evaluating SVM models with different combinations of clinical features. Finally, classification results of outer loop five-fold cross-validation were averaged and presented as overall testing results of SVM models.

Three categories of feature selection methods including subset selection, weight assignment, and hybrid method (Fig. 2):
                           
                              (1)
                              
                                 Subset selection: Genetic algorithm (GA) and simulated annealing (SA) algorithm. GA and SA performed feature selection by selecting a subset of features from all features, which were optimal for representing the original feature set. These selected features were used to train SVM model.

Genetic algorithm (GA) was developed based on Darwin's “survival of the fittest” and was applied to search for the optimal solution [45]. In this study, the “solution” denoted the better subset of features [46]. The subset of features was selected based on current population (i.e., subset of features) through crossover, mutation, and selection according to the fitness function [46].

Simulated annealing (SA) algorithm was introduced by Metropolis et al. [47] and further developed by Kirkpatrick et al. [48] for solving optimization problems. SA was developed based on the concept of annealing of metallurgy. In this study, the “solution” denoted the better subset of features [46]. In the study, GA and SA were performed using R package, named “Subselect” [46,49]. RM [46,50], GCD [46,50], and RV [46,49,51] criteria were supported in this R package and these criteria were adopted as the metrics (regarding as fitness function in GA and calculating criterion values in SA) for judging the quality of the selected subset of features.


                                 Weight assignment: Random forests (RF). RF performed feature selection by assigning the importance weight for each feature. The features were sorted according to the weights. The most important N features were selected according to the importance weights and these features were added stepwise as the input data to train SVM model.

Random forests (RF) [52–54] have been improved from Classification and Regression Trees (CART) method [55,56]. The algorithm grew many classification trees or regression trees. For each node of the tree, a best split was selected from a random subset of the features rather than all of these features. The importance of feature was estimated by calculating the increased amount of prediction error when the data for this feature were permuted and all others were left unchanged [57]. In the study, RF was performed using R package, named “FSelector” [52–54].


                                 Hybrid method: GA was combined with RF and named “GA+RF”. SA was combined with RF and named “SA+RF”. The hybrid methods in the study contained two steps in the process of feature selection, including feature subset selection and feature weight assignment. In the feature subset selection step, GA or SA was employed for selecting a subset of features from all features. In the feature weight assignment step, RF was employed for assigning the weight of importance for each feature included in the selected subset. The selected features were added stepwise as the input data to train SVM model.

The SVM was first introduced by Cortes and Vapnik [58], and Boser et al. [59]. The SVM was widely used for solving classification problems. The features can be combined as a multidimensional feature vector. These input feature vectors were mapped into higher dimensional feature space through a mapping function, φ(x). The SVM worked in the higher dimensional feature space and the goal was to find a linear separating hyperplane with maximal margin for separating the data points into two classes as shown in Fig. 3
                           . A set of a patient's feature values was regarded as an input feature vector (x
                           
                              i
                           
                           ∈
                           R
                           
                              n
                           ) by SVM (in this study, there were 16 features and n is 16). These patients were classified as two types, which were recurrence and non-recurrence, and labeled by +1 and −1. SVM was employed for finding a hyperplane (
                              
                                 (
                                 
                                    w
                                    T
                                 
                                 φ
                                 (
                                 
                                    x
                                    i
                                 
                                 )
                                 +
                                 b
                                 )
                                 =
                                 0
                              
                           ) with maximal margin (
                              
                                 maximum margin
                                 =
                                 2
                                 /
                                 |
                                 |
                                 w
                                 |
                                 |
                              
                           ) to classify the patients’ data as two classes.

In the study, radial basis function (RBF) was selected as the kernel function. In this function, two major parameters can be determined, one was the cost parameter C and the other was the parameter of kernel function gamma, γ. In this study, functionalities of SVMs were directly performed by LIBSVM [44] for building the SVM-based predictive models. Decision values of SVMs were used for constructing the receiver operating characteristic (ROC) curve, and the area under the ROC curve (AUC) [60] was calculated as one of evaluated metrics for evaluating the predictive models.

As mentioned above, the cost parameter C and the parameter of kernel function gamma, γ, were the major parameters that have to be determined. In this study, the grid search based on 5-fold cross-validation was adopted for searching the appropriate C and γ, and for improving the classified results of the SVM [43,44]. As shown in Fig. 4
                           , different pairs of (C, γ) were tried and the one with the best result of cross-validation was selected. The intervals of C and γ were provided with grid space. All the grid points of (C, γ) were tried to check the classification results of the 5-fold cross-validation based on the training data set. The parameter pair (C, γ) with the best classification results was selected for building the SVM model using the whole training data set.

The following metrics were employed for evaluating the quality of SVM-based recurrence predictive model, including sensitivity (=recall), specificity, accuracy, balanced accuracy (BAC=(sensitivity+specificity)/2), positive predictive value (PPV) (=Precision), negative predictive value (NPV), and AUC (the area under the receiver operating characteristic curve).

@&#RESULTS@&#

The baseline 16 clinical characteristics of 83 patients are shown in Table 1
                     . Relatively larger tumor size, higher transaminases level (both aspartate aminotransferase and alanine transaminases) and lower alpha-fetoprotein level were noted in recurrent group, otherwise, there were no differences regarding to sex, cirrhosis status, tumor staging, viral hepatitis B/C and other laboratory factors.

During follow up one year after RFA, 18 of 83 patients developed recurrence (Table 2
                     ). Among these patients, two developed recurrent intra-hepatic tumors and vascular thrombosis. One patient had an intra-hepatic tumor and a metastatic tumor at adrenal gland. These three patients refused target therapy (as suggested by treatment guidelines) after discussion. Palliative treatment with TACE was performed for these three patients, but with only partial effect or ineffective result. The other 15 patients had only intra-hepatic recurrent tumors and three of them had more than 3 tumors. They are treated by RFA (9 patients; 8 of them with complete tumor ablation), TACE (5 patients; 2 with complete embolization and 3 with partial effect) and operation (one patient; with complete tumor removal).

The developed predictive models were evaluated based on 5-fold cross-validation. The evaluated results of five types of models were summarized in Table 3
                     . Of the five methods, the SA+RF_SVM had the best accuracy (82%) and balanced accuracy (=BAC) (76%).

In SA+RF_SVM method, the leading four presences of features are tumor size, tumor number, ALT and gender. In GA+RF_SVM method, the leading four presences of features are tumor number, gender, tumor size and cirrhosis (Table 4
                     ).

Univariate and multivariate logistic regression tests were used for risk factor analysis of HCC recurrence. By conventional statistical methods, only “tumor size” is statistically significant in univariate analysis (P
                     =0.02) regarding to the HCC recurrence after RFA treatment. In multivariate analysis, no definite significant factor could be identified, although the result of tumor size is borderline, with P value 0.051.

@&#DISCUSSION@&#

Despite curative treatment by RFA, recurrence is still high due to underlying risk factors of cirrhosis and viral hepatitis. The recurrence after the treatment involved 2 phases: an early phase within 2 years and a late phase beyond 2 years after treatment [61]. Recurrence number increased with duration of follow-up, such as that reported by Shiina et al. [62], with 4-year recurrence rates of 70% after RFA for patients with 3 or fewer small tumors (≤3cm). We would like to investigate the predictive model to identify the patients with high recurrence risk in one year, but not long time after treatment. Therefore, we select one year as study period and to identify the patients who are the most likely developing recurrence after treatment.

In our study, 18 of 83 patients developed recurrence (15 with intra-hepatic recurrence, 2 with additional vascular invasion and 1 with additional adrenal gland metastasis. The recurrence rate of this study is compatible with previous reports of recurrence rates one year after curative treatment, including operation and RFA [10,16,17]. Different modalities could be considered as treatment in recurrent HCC patients. In patients of limited tumor number, recurrent HCCs could be treatment effectively by RFA again. TACE could only provided effective in limited patients. One patient had multiple recurrent tumors located at right lobe liver, which were treated effectively by surgical resection. Early detection of recurrence may provide a chance to complete treatment of recurrent tumors.

The aims of this study were, as the following, (1) to develop recurrence predictive model using the clinical data “before” RFA treatment to provide information about HCC recurrence after receiving RFA treatment, and (2) to compare the performance of the recurrence predictive models using different feature selection methods combined with support vector machine (SVM).

In this study, the 5-fold cross-validation was employed for avoiding the problem of over-fitting. The parameters of SVM with the best classification results were selected during the process of grid search. Then, the trained SVM models using the selected parameters were evaluated by validation data set (which was not previously analyzed in the process of training models). The classification results were evaluated by several criteria (e.g., accuracy, BAC, and AUC). In this study, the data set was unbalanced with the rate of recurrence after RFA in one year was 22%. For this unbalanced situation, the accuracy may not be an appropriate criterion for evaluating the quality of a model. Because the number of non-recurrence patients was greater than that of recurrence patients, the accuracy may still be high when the specificity was high but sensitivity was low. For example, RF_SVM model had an accuracy of 73%and a specificity of 84%, however, its sensitivity is 35% which is lower than 50%. Also, case number in our study is still limited, and increasing enrolled patient numbers is indicated for future study.

In this study, the SVM-based recurrence predictive models were developed using training data set. The predictive models are expected to provide information about whether the patient is high risk for HCC recurrence in one year after receiving RFA.

According to the experiment results, SVM may not achieve better performance when more clinical features were regarded as input feature vector. That is the reason why feature selection methods were employed in this study for finding appropriate subset of features from all 16 clinical features. After the development of SVM-based predictive model, the important subset of clinical feature can be found and used to predict the recurrence status using the trained SVM-based models.

By conventional statistical analysis, risk factor for tumor recurrence was analyzed separately. Only tumor size was identified as a risk factor in our study. No significant factor could be shown in multivariate analysis. Linear correlation by conventional statistical method between factors and recurrence outcome may be a reason for the negative result. By SVM analysis with multi- and high dimensional feature vectors, better separation between recurrence and non-recurrence groups could be performed. Instead of regarding each clinical feature as an independent factor, SVMs regarded a set of clinical features as an input feature vector. From the SVM results, the common presences of features are tumor size, tumor number, ALT and gender in SA+RF_SVM analysis and tumor number, gender, tumor size and cirrhosis in GA+RF_SVM analysis, respectively. In the previous reports, these factors are also important factors in determining recurrence of HCC after treatment, including RFA. For tumor local recurrence after RFA treatment, tumor size >2.5cm and tumor size are identified as the main risk factor in Lam's study and Shiozawa's study, respectively [27,28]. Regarding to the recurrence after long term follow-up, tumor with diameter bigger than 3cm, located near the intrahepatic blood vessels, sub-capsular locations and prothrombin time more than 3s are independent risk factors in Yang's study [29]. Aspartate aminotransferase-platelet ratio index (APRI) more than 1, multi-nodularity, and tumor size bigger than 2cm predicted higher incidence of recurrence after RFA. In Tateishi's study [63], tumor size, AFP value and platelet count are risk factors for intra-subsegmental and extra-subsegmental recurrence in multivariate analysis. Different risk factors were identified in different studies. In our study, most of the clinical features were enrolled for analysis and combination effect of these features predicting to recurrence after RFA is analyzed. However, we could not take these factors separately in SVM analysis. The combination of these features is much more important than that in separate.

The development process of the predictive model was proposed in our study. In this study, only clinical features are used for predictive model establishment. Other important factors for HCC recurrence, including viral activities (HBV DNA, HCV RNA, etc.), pathologic features (vascular invasion, micro-metastasis, etc.), are not included in this study due to incomplete viral quantity data in these patients and no operation tissue available. Our method could be applied to other groups of HCC patient receiving different treatment methods with different features available.

@&#CONCLUSIONS@&#

In conclusion, the recurrence predictive model for HCC recurrence within one year in newly diagnosed HCC patients receiving RFA was proposed. Of the five different types of predictive models, the hybrid methods combined with SVM (GA+RF_SVM and SA+RF_SVM) had better performance. For patients received RFA treatment, the model may identify patients at higher risk for recurrence and more frequent follow-up may be required on these patients.

None declared.

@&#ACKNOWLEDGMENTS@&#

The authors acknowledge the members of the research team lead by F. Lai of National Taiwan University for their contributions toward this study.

F. Lai received grants from the National Science Council Taiwan (NSC 101-2221-E-002-203-MY3).

Ja-Der Liang received a grant from the New Century Health Care Promotion Foundation.

@&#REFERENCES@&#

