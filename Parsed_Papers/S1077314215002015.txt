@&#MAIN-TITLE@&#Fixed-point Gaussian Mixture Model for analysis-friendly surveillance video coding

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           The fGMM is mathematically derived to eliminate the floating-point calculations.


                        
                        
                           
                           A division simulation algorithm is proposed to replace the division operations.


                        
                        
                           
                           The fGMM is implemented in FPGA to process HD videos in real-time.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Surveillance video

Video coding

Analysis-friendly

Background modeling

Fixed-point Gaussian Mixture Model

@&#ABSTRACT@&#


               
               
                  With the recent explosion in the use of video surveillance in security, social and industrial applications, it is highly desired to develop “smart” cameras which are capable of not only supporting high-efficiency surveillance video coding but also facilitating some content analysis tasks such as moving object detection. Usually, background modeling is one of fundamental pre-processing steps in many surveillance video coding and analysis tasks. Among various background models, Gaussian Mixture Model (GMM) is considered as one of the best parametric modeling methods for both video coding and analysis tasks. However, a number of floating-point calculations and division operations largely limit its application in the hardware implementation (e.g., FPGA, SOC). To address this problem, this paper proposes a fixed-point Gaussian Mixture Model (fGMM), which can be used in the hardware implementation of the analysis-friendly surveillance video codec in smart cameras. In this paper, we first mathematically derive a fixed-point formulation of GMMs by introducing several integer variables to replace the corresponding float ones in GMM so as to eliminate the floating-point calculations, and then present a division simulation algorithm and an approximate calculation to replace the division operations. Extensive experiments on the PKU-SVD-A dataset show that fGMM can achieve comparable performance with the float GMM on both surveillance video coding and object detection tasks, and outperforms several state-of-the-art methods remarkably. We also implemented fGMM in FPGA. The result shows that the FPGA implementation of our fGMM can process HD videos in real-time, just requiring 140 MHz user logic and 622 MHz DDR3 memory with 64-bit data bus.
               
            

@&#INTRODUCTION@&#

In recent years, surveillance cameras have been widely deployed and video surveillance systems have reached every corner of our modern society. For example, more than 5.9 million surveillance cameras have been deployed in UK; while there are up to more than 30 million surveillance cameras in China. Obviously, with the explosion in the use of video surveillance, it is highly deserved to develop “smart” cameras which, in addition to image capture circuitry, are capable of extracting application-specific information from the captured images [1]. Such smart cameras can be used in a wide range of security, social and industrial applications, including unattended surveillance [1], in-home nanny monitoring [2], road surveillance and traffic control [3], robot guidance and vehicle control [4].

Usually, existing surveillance systems adopt the common video codecs such as H.264/AVC with general settings to compress the captured videos for weeks or months. Some systems even set the compression rate to 300:1 or higher to further reduce network bandwidth and storage capacity. On the other hand, these systems often conduct the video analysis task (e.g., object detection) on the whole frames after decoding the bit-stream from cameras. The better the quality of the frames, the higher the performance of video analysis and search might achieve. Thus a high compression ratio may inevitably influence the accuracy of video analysis. To partially solve this dilemma, as pointed out by [2], the video codec in a “smart” video surveillance system should be analysis-friendly (as Fig. 1
                      shows), which can not only support high-efficiency surveillance video coding but also facilitates some content analysis tasks such as object detection.

To achieve high-efficiency coding performance, a background-model-based coding method was proposed in [5,6] for surveillance videos, in which the background pictures are modeled from the original input frames so as to provide better reference for encoding the following frames, and these background pictures can be encoded into the bitstream as non-display frames to guarantee the decoding match. Experimental results showed that this method could obtain a remarkable compression gain on surveillance videos over H.264/AVC High Profile. It should be noted that this background-model-based coding technology has been adopted in IEEE 1857-S (AVS) and is expected to be implemented in hardware codecs for different video surveillance applications [2]. Meanwhile, background modeling is also one of fundamental pre-processing steps in surveillance video analysis (e.g., [3,7–10]). Many practical evidences have validated that a clean background can be very helpful for analysis tasks such as foreground segmentation and object detection. Therefore, to develop such a smart video surveillance system with the analysis-friendly video codec, it is crucial to design a background modeling method suitable for both video coding and content analysis.

Basically, background modeling in surveillance video coding should be done with low computational complexity and low memory cost. Till to now, two background modeling methods have been proposed in the literature for surveillance video coding. In [11], Zhang et al. proposed a Segment-and-Weight based Running Average (SWRA) method to approximately calculate the background by assigning a larger weight on the frequently-appearing values in the averaging process. As one of low-complexity background modeling methods, it can offer rather good reference for video coding, and more importantly, can be easily implemented in the hardware codec. In [12], Paul et al. proposed to embed the Gaussian Mixture Model (GMM) background generation procedure and the background prediction into H.264/AVC. Compared with SWRA, GMM is computationally complex since it has many floating-point calculations and division operations.

For video analysis, there are many methods in the literature [9], e.g., Frame Differencing, Temporal Median Filtering, Gaussian Mixture Models (GMMs), Bayesian, Kernel Density Estimation (KDE), Codebook methods. Among them, GMM [13–15] is considered as one of the best parametric background modeling methods, due to its good performance and high robustness over different scenes. Recently, many new background modeling algorithms, such as ViBe [16], PBAS [17], SOBS [18], Eigenbackground [19] and Neural-fuzzy model based approach [20], have been proposed. Totally speaking, they show promising performance on several video analysis tasks, and mostly even outperform GMMs. However, ViBe and PBAS are not able to generate backgrounds and thus cannot be embedded into the codec so as to provide prediction reference for video coding, while SOBS and Eigenbackground need massive calculations and thus are difficult to implement in the codecs with low computational complexity. On the other hand, as a variant of the simple running average method, SWRA [11] is not analysis-friendly. It cannot model dynamic background effectively and thus does not satisfy the needs for many video analysis tasks. Thus to the best of our knowledge, GMM should be the best background modeling method for both video coding and video analysis that can be found in the literature till to now.

However, the floating-point calculations and division operations in GMM still present a significant obstacle for its wide application in the hardware implementation of video codecs. For example, if we want to empower the cameras with the analysis-friendly video codec, we need to implement the GMM in FPGA and even SOC. To solve this problem, some recent works (e.g., 21–24) proposed several hardware implementation methods of GMM. Among them, [21] is the newest one and it can process the HD video in real-time. Totally speaking, all these methods adopt the similar strategy by using data conversion to accelerate the processing speed (i.e., using the fixed number of bits to represent the integer and fractional parts). Obviously, this strategy is not an optimization of the GMM model itself. What is more, due to the approximate representation of the fractional parts in the model, the quality of the constructed background will decrease inevitably.

In this paper, we propose a fixed-point Gaussian Mixture Model (fGMM) method for analysis-friendly surveillance video coding. Different from previous works, the proposed fGMM eliminates the floating-point calculations and division operations while being capable of achieving comparable performance. Towards this end, we mathematically derive a fixed-point formulation of GMMs by introducing several integer variables to replace the corresponding float ones in GMM so as to eliminate the float-point calculations. After this, we adopt a division simulation algorithm and an approximate calculation to replace the division operations. Experimental results show that this approximate calculation has little influence on the quality of the modeled background pictures. In addition, our analysis also shows that fGMM saves 46% memory cost compared with its float version.

Extensive experiments were performed on the PKU-SVD-A dataset
                        1
                     
                     
                        1
                        
                           http://mlg.idm.pku.edu.cn/resources/pku-svd-a.html
                        
                     . This dataset consists of more than 10 videos with different resolutions (ranging from SD, 720p, 1600 × 1200, and 1920 × 1080) and is online publically available. Experimental results show that both in surveillance video coding and object detection tasks, the proposed fGMM can achieve comparable performance with the float GMM, and also outperforms several state-of-the-art methods (e.g., [11,21,24]) remarkably. We also implemented our fGMM in FPGA. The result shows that fGMM has lower hardware requirements (e.g., user logic, memory) to process HD video in real-time, compared with [21].

Our main contributions can be summarized as follows:

                        
                           (1)
                           A fixed-point formulation of GMMs is mathematically derived by introducing several integer variables to replace the corresponding float ones in GMM so as to eliminate the floating-point calculations. Different from other data conversion methods, the proposed fGMM does not introduce any approximate presentation to convert float into integer.

A division simulation algorithm and an approximate calculation are further proposed for fGMM to replace the division operations. As a result, fGMM can complete all the calculations using integers to achieve comparable performance with the float version of GMM.

Without floating-point calculations and division operations, fGMM can be easily implemented in hardware devices. In our work, fGMM is implemented in FPGA to process HD videos in real-time, just requiring 140 MHz user logic and 622 MHz DDR3 memory with 64-bit data bus.

The remainder of this paper is organized as follows: Section 2 briefly reviews the Gaussian Mixture Model. The proposed fGMM is presented in Section 3. Experimental results are shown in Section 4. Section 5 mainly presents the FPGA implementation of fGMM and Section 6 concludes this paper.

Gaussian Mixture Model (GMM), firstly proposed by Stauffer and Grimson [13], is a widely-used parametric background modeling method. Its basic idea is to use several Gaussian distributions to describe a pixel, some of which represent the background in the scene while the others characterize the foreground. To facilitate the online model learning, KaewTraKulPong and Bowden [14] proposed to use Expectation Maximization (EM) to update the parameters. Thus this section briefly reviews the GMM in [14] and then discuss the possible problems when used in hardware implementation.

GMM models each pixel by a mixture of K Gaussian distributions. For each Gaussian distribution, there is a weight parameter w representing the time proportion this pixel stays. The greater the value of w is, the longer this pixel stays in this distribution. The Gaussian function is shown as follows:

                           
                              (1)
                              
                                 
                                    f
                                    
                                       (
                                       x
                                       )
                                    
                                    =
                                    
                                       1
                                       
                                          σ
                                          
                                             
                                                2
                                                π
                                             
                                          
                                       
                                    
                                    
                                       e
                                       
                                          −
                                          
                                             
                                                
                                                   (
                                                   x
                                                   −
                                                   μ
                                                   )
                                                
                                                2
                                             
                                             
                                                2
                                                
                                                   σ
                                                   2
                                                
                                             
                                          
                                       
                                    
                                    ,
                                 
                              
                           
                        where σ is the standard deviation. A smaller value of σ means a more stable distribution. The background pixel value tends to be the one which stays the longest and keeps static in the video. Therefore, static background tends to form tight clusters in the Gaussian distributions while moving ones form widen clusters. The measurement of this widen or tight cluster is called the fitness value 
                           
                              ϕ
                              k
                              N
                           
                        . It is calculated by

                           
                              (2)
                              
                                 
                                    
                                       ϕ
                                       k
                                       N
                                    
                                    =
                                    
                                       
                                          w
                                          k
                                          N
                                       
                                       
                                          σ
                                          k
                                          N
                                       
                                    
                                    ,
                                 
                              
                           
                        where wk
                         and σk
                         are the weight and the standard deviation of the kth Gaussian distribution respectively.

To allow the model to adapt to the changes in the video, an update scheme is applied. In this scheme, every new pixel value is checked through the existing model components in order of fitness, while the first matched Gaussian component will be updated. If it does not find a matched component, a new one will be added with a large standard deviation and a small value of the weighting parameter. The match rule is

                           
                              (3)
                              
                                 
                                    a
                                    b
                                    s
                                    
                                       (
                                       x
                                       −
                                       
                                          μ
                                          k
                                       
                                       )
                                    
                                    ≤
                                    T
                                    h
                                    ×
                                    
                                       σ
                                       k
                                    
                                    ,
                                 
                              
                           
                        where abs(i) is the absolute value function, x means the value of the current pixel, μk
                         is the mean value of the kth Gaussian distribution, and Th is a threshold value (always setting as 2 or 3). After finding the matched Gaussian distribution, the parameters will be updated using the EM algorithm.

To update the parameters of Gaussian distributions, the EM algorithm [14] begins the estimation of the GMM by using sufficient statistics update equations, then switches to L-recent window version after the first L samples are processed. That is, it uses different updating strategies in different processing stages. When the window size does not reach the threshold L, the EM algorithm can be characterized as follows:

                           
                              (4)
                              
                                 
                                    
                                       w
                                       k
                                       
                                          N
                                          +
                                          1
                                       
                                    
                                    =
                                    
                                       w
                                       k
                                       N
                                    
                                    +
                                    
                                       1
                                       
                                          N
                                          +
                                          1
                                       
                                    
                                    
                                       (
                                       p
                                       
                                          (
                                          
                                             w
                                             k
                                          
                                          |
                                          
                                             x
                                             
                                                N
                                                +
                                                1
                                             
                                          
                                          )
                                       
                                       −
                                       
                                          w
                                          k
                                          N
                                       
                                       )
                                    
                                    ,
                                 
                              
                           
                        
                        
                           
                              (5)
                              
                                 
                                    
                                       μ
                                       k
                                       
                                          N
                                          +
                                          1
                                       
                                    
                                    =
                                    
                                       μ
                                       k
                                       N
                                    
                                    +
                                    
                                       
                                          p
                                          (
                                          
                                             w
                                             k
                                          
                                          |
                                          
                                             x
                                             
                                                N
                                                +
                                                1
                                             
                                          
                                          )
                                       
                                       
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             
                                                N
                                                +
                                                1
                                             
                                          
                                          
                                             p
                                             (
                                             
                                                w
                                                k
                                             
                                             |
                                             
                                                x
                                                i
                                             
                                             )
                                          
                                       
                                    
                                    
                                       (
                                       
                                          x
                                          
                                             N
                                             +
                                             1
                                          
                                       
                                       −
                                       
                                          μ
                                          k
                                          N
                                       
                                       )
                                    
                                    ,
                                 
                              
                           
                        
                        
                           
                              (6)
                              
                                 
                                    
                                       Σ
                                       k
                                       
                                          N
                                          +
                                          1
                                       
                                    
                                    =
                                    
                                       Σ
                                       k
                                       N
                                    
                                    +
                                    
                                       
                                          p
                                          (
                                          
                                             w
                                             k
                                          
                                          |
                                          
                                             x
                                             
                                                N
                                                +
                                                1
                                             
                                          
                                          )
                                       
                                       
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             
                                                N
                                                +
                                                1
                                             
                                          
                                          
                                             p
                                             (
                                             
                                                w
                                                k
                                             
                                             |
                                             
                                                x
                                                i
                                             
                                             )
                                          
                                       
                                    
                                    
                                       (
                                       
                                          (
                                          
                                             x
                                             
                                                N
                                                +
                                                1
                                             
                                          
                                          −
                                          
                                             μ
                                             k
                                             N
                                          
                                          )
                                       
                                       
                                          (
                                          
                                             x
                                             
                                                N
                                                +
                                                1
                                             
                                          
                                          −
                                          
                                             μ
                                             k
                                             N
                                          
                                          )
                                       
                                       −
                                       
                                          Σ
                                          k
                                          N
                                       
                                       )
                                    
                                    .
                                 
                              
                           
                        Otherwise, the EM algorithm is shown as follows:

                           
                              (7)
                              
                                 
                                    
                                       w
                                       k
                                       
                                          N
                                          +
                                          1
                                       
                                    
                                    =
                                    
                                       w
                                       k
                                       N
                                    
                                    +
                                    
                                       1
                                       L
                                    
                                    
                                       (
                                       p
                                       
                                          (
                                          
                                             w
                                             k
                                          
                                          |
                                          
                                             x
                                             
                                                N
                                                +
                                                1
                                             
                                          
                                          )
                                       
                                       −
                                       
                                          w
                                          k
                                          N
                                       
                                       )
                                    
                                    ,
                                 
                              
                           
                        
                        
                           
                              (8)
                              
                                 
                                    
                                       μ
                                       k
                                       
                                          N
                                          +
                                          1
                                       
                                    
                                    =
                                    
                                       μ
                                       k
                                       N
                                    
                                    +
                                    
                                       1
                                       L
                                    
                                    
                                       (
                                       
                                          
                                             p
                                             
                                                (
                                                
                                                   w
                                                   k
                                                
                                                |
                                                
                                                   x
                                                   
                                                      N
                                                      +
                                                      1
                                                   
                                                
                                                )
                                             
                                             
                                                x
                                                
                                                   N
                                                   +
                                                   1
                                                
                                             
                                          
                                          
                                             w
                                             k
                                             
                                                N
                                                +
                                                1
                                             
                                          
                                       
                                       −
                                       
                                          μ
                                          k
                                          N
                                       
                                       )
                                    
                                    ,
                                 
                              
                           
                        
                        
                           
                              (9)
                              
                                 
                                    
                                       Σ
                                       k
                                       
                                          N
                                          +
                                          1
                                       
                                    
                                    =
                                    
                                       Σ
                                       k
                                       N
                                    
                                    +
                                    
                                       1
                                       L
                                    
                                    
                                       (
                                       
                                          
                                             p
                                             
                                                (
                                                
                                                   w
                                                   k
                                                
                                                |
                                                
                                                   x
                                                   
                                                      N
                                                      +
                                                      1
                                                   
                                                
                                                )
                                             
                                             
                                                (
                                                
                                                   x
                                                   
                                                      N
                                                      +
                                                      1
                                                   
                                                
                                                −
                                                
                                                   μ
                                                   k
                                                   N
                                                
                                                )
                                             
                                             
                                                (
                                                
                                                   x
                                                   
                                                      N
                                                      +
                                                      1
                                                   
                                                
                                                −
                                                
                                                   μ
                                                   k
                                                   N
                                                
                                                )
                                             
                                          
                                          
                                             w
                                             k
                                             
                                                N
                                                +
                                                1
                                             
                                          
                                       
                                       −
                                       
                                          Σ
                                          k
                                          N
                                       
                                       )
                                    
                                    .
                                 
                              
                           
                        From (4) to (9), 
                           
                              w
                              k
                              N
                           
                         and 
                           
                              μ
                              k
                              N
                           
                         denote the weight and the mean value of the kth Gaussian 
                           
                              M
                              k
                           
                         respectively when the window size equals to N, 
                           
                              Σ
                              k
                              N
                           
                         is the square of 
                           
                              σ
                              k
                              N
                           
                         while 
                           
                              σ
                              k
                              N
                           
                         means the variance of 
                           
                              M
                              k
                           
                        . xN
                         is the pixel value of the Nth frame, and 
                           
                              p
                              (
                              
                                 w
                                 k
                              
                              |
                              
                                 x
                                 
                                    N
                                    +
                                    1
                                 
                              
                              )
                           
                         is used to represent whether 
                           
                              M
                              k
                           
                         is the first match of the current pixel, which can be calculated as follows:

                           
                              (10)
                              
                                 
                                    p
                                    
                                       (
                                       
                                          w
                                          k
                                       
                                       |
                                       
                                          x
                                          
                                             N
                                             +
                                             1
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   1
                                                   ,
                                                
                                             
                                             
                                                
                                                   
                                                      M
                                                      k
                                                   
                                                   
                                                      
                                                      is
                                                      
                                                      the
                                                      
                                                      first
                                                      
                                                      match
                                                      ;
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   0
                                                   ,
                                                
                                             
                                             
                                                
                                                   otherwise
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

@&#DISCUSSIONS@&#

As we can see, the updating methods for variables w, μ and Σ all need the division operations. In the hardware implementation, the division operation is highly time-consuming, much more inefficient than the addition operation. Moreover, in the division operation, all variables must be represented using double or float. This further influences the efficiency of the hardware video codecs. At last, double or float variables need more bytes to store than char or short, so GMM is highly memory-consuming. All these limit its wide application in the hardware implementation of video codecs although it shows promising performance in both video coding and content analysis tasks. To solve these problems, we propose a variant of GMM, called fixed-point GMM (fGMM). It can generate clean background pictures as GMM does. More importantly, it has no division operation or floating-point calculation.

To avoid using floating-point calculations in the GMM, different data conversion methods were adopted in previous works. Moon et al. proposed a fixed-point GMM algorithm in [24]. For simplicity, their method is abbreviated as fpGMM in this paper. In fpGMM, each floating-point variable or constant is replaced by a 32-bit integer. It divides a 32-bit integer to three parts: sign, integer and fraction. The numbers of bits assigned to the integer field and the fraction field are called integer word-length (IWL) and fraction word-length (FWL), respectively. For instance, in the case of FWL = 12 and IWL = 19, a float-point number 1.875 is converted into a fixed-point number 7680 in decimal system (as shown in Fig. 2
                        ). Similarly, some other hardware implementations of the GMM (e.g., 21–23) use 8 bits to represent the integer part and 3 bits to represent the fractional part of a double value. Take the number 0.5625 in decimal system (or 0.1001 in binary system) as an example. It becomes 0.5 in decimal system (or 0.100 in binary system) after such a conversion. Obviously, both data conversion methods will bring in heavy approximate error, which further influences the quality of the background frame greatly. In the experiments, we implement the data conversion method in fpGMM and compare the surveillance video coding and analysis results of fpGMM and fGMM. Moreover, we will also discuss the hardware data conversion method in [21] in details and compare the FPGA implementations of [21] and our fGMM.

In this section, we first derive some mathematical formulations of fGMM by introducing several integer variables to replace the corresponding float ones in GMM, and then present a division simulation algorithm to replace the division operations. In Section 3.2, we further describe how to conduct the calculations in fGMM using these integer variables, including the matching rule and fitness sorting. Finally, a memory cost analysis is presented in Section 3.3.


                        Fig. 3
                         describes the sequence structure for video coding and object detection [6]. In this structure, several frames labelled as TrainSet are used to train the background pictures. That is, an initial group of frames are utilized as TrainSet
                        0 to generate the background picture for Segment
                        1, whereas the last group of frames in Segmenti
                         are utilized as TrainSeti
                         to generate the background picture for 
                           
                              S
                              e
                              g
                              m
                              e
                              n
                              
                                 t
                                 
                                    i
                                    +
                                    1
                                 
                              
                           
                         where i ≥ 1. Then the generated background picture can be used as the reference in video coding or for extracting the foreground mask in object detection on the next segment. In this sequence structure, (4)–(6) are more suitable for GMM parameter updating. Thus, we will conduct some mathematical derivations to them so as to eliminate the divisions and floating-point calculations.

The GMM updating method for w is shown in (4). To remove the division by 
                              
                                 N
                                 +
                                 1
                              
                            in the right term of (4), we rewrite it by multiplying 
                              
                                 N
                                 +
                                 1
                              
                            on both sides, as follows:

                              
                                 (11)
                                 
                                    
                                       
                                          w
                                          k
                                          
                                             N
                                             +
                                             1
                                          
                                       
                                       
                                          (
                                          N
                                          +
                                          1
                                          )
                                       
                                       =
                                       
                                          w
                                          k
                                          N
                                       
                                       N
                                       +
                                       
                                          w
                                          k
                                          N
                                       
                                       +
                                       p
                                       
                                          (
                                          
                                             w
                                             k
                                          
                                          |
                                          
                                             x
                                             
                                                N
                                                +
                                                1
                                             
                                          
                                          )
                                       
                                       −
                                       
                                          w
                                          k
                                          N
                                       
                                       .
                                    
                                 
                              
                           Here the term 
                              
                                 w
                                 k
                                 N
                              
                            can be offset. After this, we introduce a new variable 
                              
                                 f
                                 k
                                 N
                              
                            to represent the term 
                              
                                 
                                    w
                                    k
                                    N
                                 
                                 N
                              
                           . It means the product of the window size N and the weight parameter of 
                              
                                 M
                                 k
                              
                           . Then (11) can be simplified as

                              
                                 (12)
                                 
                                    
                                       
                                          f
                                          k
                                          
                                             N
                                             +
                                             1
                                          
                                       
                                       =
                                       
                                          f
                                          k
                                          N
                                       
                                       +
                                       p
                                       
                                          (
                                          
                                             w
                                             k
                                          
                                          |
                                          
                                             x
                                             
                                                N
                                                +
                                                1
                                             
                                          
                                          )
                                       
                                       .
                                    
                                 
                              
                           In this way, the updating of w becomes an iterative calculation of the variable 
                              
                                 f
                                 k
                                 N
                              
                           . As 
                              
                                 p
                                 (
                                 
                                    w
                                    k
                                 
                                 |
                                 
                                    x
                                    
                                       N
                                       +
                                       1
                                    
                                 
                                 )
                              
                            equals to either 0 or 1, the variable 
                              
                                 f
                                 k
                                 N
                              
                            in (12) can be represented as an integer.

The GMM updating method for μ is shown in (5). To remove the division by 
                              
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       N
                                       +
                                       1
                                    
                                 
                                 
                                    p
                                    (
                                    
                                       w
                                       k
                                    
                                    |
                                    
                                       x
                                       i
                                    
                                    )
                                 
                              
                            in the right term of (5), we rewrite it by multiplying 
                              
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       N
                                       +
                                       1
                                    
                                 
                                 
                                    p
                                    (
                                    
                                       w
                                       k
                                    
                                    |
                                    
                                       x
                                       i
                                    
                                    )
                                 
                              
                            on both sides, as follows:

                              
                                 (13)
                                 
                                    
                                       
                                          μ
                                          k
                                          
                                             N
                                             +
                                             1
                                          
                                       
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             N
                                             +
                                             1
                                          
                                       
                                       
                                          p
                                          (
                                          
                                             w
                                             k
                                          
                                          |
                                          
                                             x
                                             i
                                          
                                          )
                                       
                                       =
                                       
                                          μ
                                          k
                                          N
                                       
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             N
                                             +
                                             1
                                          
                                       
                                       
                                          p
                                          (
                                          
                                             w
                                             k
                                          
                                          |
                                          
                                             x
                                             i
                                          
                                          )
                                       
                                       +
                                       p
                                       
                                          (
                                          
                                             w
                                             k
                                          
                                          |
                                          
                                             x
                                             
                                                N
                                                +
                                                1
                                             
                                          
                                          )
                                       
                                       
                                          (
                                          
                                             x
                                             
                                                N
                                                +
                                                1
                                             
                                          
                                          −
                                          
                                             μ
                                             k
                                             N
                                          
                                          )
                                       
                                       .
                                    
                                 
                              
                           As 
                              
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       N
                                       +
                                       1
                                    
                                 
                                 
                                    p
                                    
                                       (
                                       
                                          w
                                          k
                                       
                                       |
                                       
                                          x
                                          i
                                       
                                       )
                                    
                                    =
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                       
                                       N
                                    
                                    
                                       p
                                       
                                          (
                                          
                                             w
                                             k
                                          
                                          |
                                          
                                             x
                                             i
                                          
                                          )
                                       
                                       +
                                       p
                                       
                                          (
                                          
                                             w
                                             k
                                          
                                          |
                                          
                                             x
                                             
                                                N
                                                +
                                                1
                                             
                                          
                                          )
                                       
                                    
                                 
                                 ,
                              
                            this equation can be transformed as follows:

                              
                                 (14)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   μ
                                                   k
                                                   
                                                      N
                                                      +
                                                      1
                                                   
                                                
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   
                                                      N
                                                      +
                                                      1
                                                   
                                                
                                                
                                                   p
                                                   (
                                                   
                                                      w
                                                      k
                                                   
                                                   |
                                                   
                                                      x
                                                      i
                                                   
                                                   )
                                                
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   μ
                                                   k
                                                   N
                                                
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   N
                                                
                                                
                                                   p
                                                   (
                                                   
                                                      w
                                                      k
                                                   
                                                   |
                                                   
                                                      x
                                                      i
                                                   
                                                   )
                                                
                                                +
                                                
                                                   μ
                                                   k
                                                   N
                                                
                                                p
                                                
                                                   (
                                                   
                                                      w
                                                      k
                                                   
                                                   |
                                                   
                                                      x
                                                      
                                                         N
                                                         +
                                                         1
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                +
                                                
                                                p
                                                
                                                   (
                                                   
                                                      w
                                                      k
                                                   
                                                   |
                                                   
                                                      x
                                                      
                                                         N
                                                         +
                                                         1
                                                      
                                                   
                                                   )
                                                
                                                
                                                   (
                                                   
                                                      x
                                                      
                                                         N
                                                         +
                                                         1
                                                      
                                                   
                                                   −
                                                   
                                                      μ
                                                      k
                                                      N
                                                   
                                                   )
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           After offsetting the same term 
                              
                                 
                                    μ
                                    k
                                    N
                                 
                                 p
                                 
                                    (
                                    
                                       w
                                       k
                                    
                                    |
                                    
                                       x
                                       
                                          N
                                          +
                                          1
                                       
                                    
                                    )
                                 
                              
                            in the right side of (14), it can be simplified as follows:

                              
                                 (15)
                                 
                                    
                                       
                                          μ
                                          k
                                          
                                             N
                                             +
                                             1
                                          
                                       
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             N
                                             +
                                             1
                                          
                                       
                                       
                                          p
                                          (
                                          
                                             w
                                             k
                                          
                                          |
                                          
                                             x
                                             i
                                          
                                          )
                                       
                                       =
                                       
                                          μ
                                          k
                                          N
                                       
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          N
                                       
                                       
                                          p
                                          (
                                          
                                             w
                                             k
                                          
                                          |
                                          
                                             x
                                             i
                                          
                                          )
                                       
                                       +
                                       p
                                       
                                          (
                                          
                                             w
                                             k
                                          
                                          |
                                          
                                             x
                                             
                                                N
                                                +
                                                1
                                             
                                          
                                          )
                                       
                                       
                                          x
                                          
                                             N
                                             +
                                             1
                                          
                                       
                                       .
                                    
                                 
                              
                           Then a new variable 
                              
                                 ν
                                 k
                                 N
                              
                            is introduced to represent the term 
                              
                                 
                                    μ
                                    k
                                    N
                                 
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    N
                                 
                                 
                                    p
                                    (
                                    
                                       w
                                       k
                                    
                                    |
                                    
                                       x
                                       i
                                    
                                    )
                                 
                              
                           . It means the product of 
                              
                                 M
                                 k
                              
                           ’s mean value and the matching sum of 
                              
                                 M
                                 k
                              
                            in first N frames. Then (15) can be finally simplified as

                              
                                 (16)
                                 
                                    
                                       
                                          ν
                                          k
                                          
                                             N
                                             +
                                             1
                                          
                                       
                                       =
                                       
                                          ν
                                          k
                                          N
                                       
                                       +
                                       p
                                       
                                          (
                                          
                                             w
                                             k
                                          
                                          |
                                          
                                             x
                                             
                                                N
                                                +
                                                1
                                             
                                          
                                          )
                                       
                                       
                                          x
                                          
                                             N
                                             +
                                             1
                                          
                                       
                                       .
                                    
                                 
                              
                           
                        

The GMM updating method for Σ is shown in (6). To remove the division by 
                              
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       N
                                       +
                                       1
                                    
                                 
                                 
                                    p
                                    (
                                    
                                       w
                                       k
                                    
                                    |
                                    
                                       x
                                       i
                                    
                                    )
                                 
                              
                            in the right term of (6), we rewrite it by multiplying 
                              
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       N
                                       +
                                       1
                                    
                                 
                                 
                                    p
                                    (
                                    
                                       w
                                       k
                                    
                                    |
                                    
                                       x
                                       i
                                    
                                    )
                                 
                              
                            on both sides, as follows:

                              
                                 (17)
                                 
                                    
                                       
                                          
                                          
                                          
                                             
                                                
                                                   Σ
                                                   k
                                                   
                                                      N
                                                      +
                                                      1
                                                   
                                                
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   
                                                      N
                                                      +
                                                      1
                                                   
                                                
                                                
                                                   p
                                                   (
                                                   
                                                      w
                                                      k
                                                   
                                                   |
                                                   
                                                      x
                                                      i
                                                   
                                                   )
                                                
                                                =
                                                
                                                   Σ
                                                   k
                                                   N
                                                
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   
                                                      N
                                                      +
                                                      1
                                                   
                                                
                                                
                                                   p
                                                   (
                                                   
                                                      w
                                                      k
                                                   
                                                   |
                                                   
                                                      x
                                                      i
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                +
                                                
                                                p
                                                
                                                   (
                                                   
                                                      w
                                                      k
                                                   
                                                   |
                                                   
                                                      x
                                                      
                                                         N
                                                         +
                                                         1
                                                      
                                                   
                                                   )
                                                
                                                
                                                   (
                                                   
                                                      (
                                                      
                                                         x
                                                         
                                                            N
                                                            +
                                                            1
                                                         
                                                      
                                                      −
                                                      
                                                         μ
                                                         k
                                                         N
                                                      
                                                      )
                                                   
                                                   
                                                      (
                                                      
                                                         x
                                                         
                                                            N
                                                            +
                                                            1
                                                         
                                                      
                                                      −
                                                      
                                                         μ
                                                         k
                                                         N
                                                      
                                                      )
                                                   
                                                   −
                                                   
                                                      Σ
                                                      k
                                                      N
                                                   
                                                   )
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           As 
                              
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       N
                                       +
                                       1
                                    
                                 
                                 
                                    p
                                    
                                       (
                                       
                                          w
                                          k
                                       
                                       |
                                       
                                          x
                                          i
                                       
                                       )
                                    
                                    =
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                       
                                       N
                                    
                                    
                                       p
                                       
                                          (
                                          
                                             w
                                             k
                                          
                                          |
                                          
                                             x
                                             i
                                          
                                          )
                                       
                                       +
                                       p
                                       
                                          (
                                          
                                             w
                                             k
                                          
                                          |
                                          
                                             x
                                             
                                                N
                                                +
                                                1
                                             
                                          
                                          )
                                       
                                    
                                 
                                 ,
                              
                            this equation can be transformed as follows:

                              
                                 (18)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   Σ
                                                   k
                                                   
                                                      N
                                                      +
                                                      1
                                                   
                                                
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   
                                                      N
                                                      +
                                                      1
                                                   
                                                
                                                
                                                   p
                                                   (
                                                   
                                                      w
                                                      k
                                                   
                                                   |
                                                   
                                                      x
                                                      i
                                                   
                                                   )
                                                
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   Σ
                                                   k
                                                   N
                                                
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   N
                                                
                                                
                                                   p
                                                   (
                                                   
                                                      w
                                                      k
                                                   
                                                   |
                                                   
                                                      x
                                                      i
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                +
                                                
                                                
                                                   Σ
                                                   k
                                                   N
                                                
                                                p
                                                
                                                   (
                                                   
                                                      w
                                                      k
                                                   
                                                   |
                                                   
                                                      x
                                                      
                                                         N
                                                         +
                                                         1
                                                      
                                                   
                                                   )
                                                
                                                +
                                                p
                                                
                                                   (
                                                   
                                                      w
                                                      k
                                                   
                                                   |
                                                   
                                                      x
                                                      
                                                         N
                                                         +
                                                         1
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                ×
                                                
                                                
                                                   (
                                                   
                                                      (
                                                      
                                                         x
                                                         
                                                            N
                                                            +
                                                            1
                                                         
                                                      
                                                      −
                                                      
                                                         μ
                                                         k
                                                         N
                                                      
                                                      )
                                                   
                                                   
                                                      (
                                                      
                                                         x
                                                         
                                                            N
                                                            +
                                                            1
                                                         
                                                      
                                                      −
                                                      
                                                         μ
                                                         k
                                                         N
                                                      
                                                      )
                                                   
                                                   −
                                                   
                                                      Σ
                                                      k
                                                      N
                                                   
                                                   )
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           After offsetting the same term 
                              
                                 
                                    Σ
                                    k
                                    N
                                 
                                 p
                                 
                                    (
                                    
                                       w
                                       k
                                    
                                    |
                                    
                                       x
                                       
                                          N
                                          +
                                          1
                                       
                                    
                                    )
                                 
                              
                            in the right side of (18), it can be simplified as follows:

                              
                                 (19)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   Σ
                                                   k
                                                   
                                                      N
                                                      +
                                                      1
                                                   
                                                
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   
                                                      N
                                                      +
                                                      1
                                                   
                                                
                                                
                                                   p
                                                   (
                                                   
                                                      w
                                                      k
                                                   
                                                   |
                                                   
                                                      x
                                                      i
                                                   
                                                   )
                                                
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   Σ
                                                   k
                                                   N
                                                
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   N
                                                
                                                
                                                   p
                                                   (
                                                   
                                                      w
                                                      k
                                                   
                                                   |
                                                   
                                                      x
                                                      i
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                +
                                                
                                                p
                                                
                                                   (
                                                   
                                                      w
                                                      k
                                                   
                                                   |
                                                   
                                                      x
                                                      
                                                         N
                                                         +
                                                         1
                                                      
                                                   
                                                   )
                                                
                                                
                                                   (
                                                   
                                                      x
                                                      
                                                         N
                                                         +
                                                         1
                                                      
                                                   
                                                   −
                                                   
                                                      μ
                                                      k
                                                      N
                                                   
                                                   )
                                                
                                                
                                                   (
                                                   
                                                      x
                                                      
                                                         N
                                                         +
                                                         1
                                                      
                                                   
                                                   −
                                                   
                                                      μ
                                                      k
                                                      N
                                                   
                                                   )
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           Then we introduce a new variable 
                              
                                 Ψ
                                 k
                                 N
                              
                            to represent the term 
                              
                                 
                                    Σ
                                    k
                                    N
                                 
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    N
                                 
                                 
                                    p
                                    (
                                    
                                       w
                                       k
                                    
                                    |
                                    
                                       x
                                       i
                                    
                                    )
                                 
                              
                           . It means the product of 
                              
                                 M
                                 k
                              
                           ’s variance and the matching sum of 
                              
                                 M
                                 k
                              
                            in first N frames. Then (19) can be finally simplified as:

                              
                                 (20)
                                 
                                    
                                       
                                          Ψ
                                          k
                                          
                                             N
                                             +
                                             1
                                          
                                       
                                       =
                                       
                                          Ψ
                                          k
                                          N
                                       
                                       +
                                       p
                                       
                                          (
                                          
                                             w
                                             k
                                          
                                          |
                                          
                                             x
                                             
                                                N
                                                +
                                                1
                                             
                                          
                                          )
                                       
                                       
                                          (
                                          
                                             x
                                             
                                                N
                                                +
                                                1
                                             
                                          
                                          −
                                          
                                             μ
                                             k
                                             N
                                          
                                          )
                                       
                                       
                                          (
                                          
                                             x
                                             
                                                N
                                                +
                                                1
                                             
                                          
                                          −
                                          
                                             μ
                                             k
                                             N
                                          
                                          )
                                       
                                       .
                                    
                                 
                              
                           In this equation, 
                              
                                 μ
                                 k
                                 N
                              
                            is needed to update 
                              
                                 Ψ
                                 k
                                 N
                              
                           . As 
                              
                                 ν
                                 k
                                 N
                              
                            equals to 
                              
                                 
                                    μ
                                    k
                                    N
                                 
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    N
                                 
                                 
                                    p
                                    (
                                    
                                       w
                                       k
                                    
                                    |
                                    
                                       x
                                       i
                                    
                                    )
                                 
                                 ,
                              
                            in order to get the value of 
                              
                                 
                                    μ
                                    k
                                    N
                                 
                                 ,
                              
                            the division operation is unavoidable. It should be noted that the dividend 
                              
                                 ν
                                 k
                                 N
                              
                            and the divisor 
                              
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    N
                                 
                                 
                                    p
                                    (
                                    
                                       w
                                       k
                                    
                                    |
                                    
                                       x
                                       i
                                    
                                    )
                                 
                              
                            are both integers.

To solve the division problem of two integers, [25] utilizes the look-up table and approximate calculations to simulate the division operations. In fact, this is the most efficient method to implement the division operations when the ranges of the dividend and the divisor are limited. However, from the perspective of saving memory, we propose an alternative division simulation algorithm using shift operations. As shown in Algorithm 1
                           , all the variables are integers and the approximate calculation is used. Note that the left and right shift operations in Algorithm 1 are based on powers of 2. Our experiments shown in Section 4 will prove that the approximate calculation has little influence on the constructed background pictures.


                           Table 1
                            shows the correspondence of the variables in fGMM and GMM. Note that we do not introduce any extra variables, just using the integer variables to replace the float ones.

In fGMM, the float variables w, μ and Σ are replaced by the corresponding integer variables f, ν and Ψ. However, without the variables w, μ and Σ, some calculations cannot be completed in fGMM, including the Gaussian distribution matching rule shown in (3) and the fitness sorting shown in (2). So this subsection will describe how to accomplish these calculations using the variables f, ν and Ψ.

To determine which Gaussian distribution a new pixel matches, fGMM must calculate the distance between the current pixel value and the mean value of the Gaussian distribution. As shown in (3), if the distance is smaller than the product of the stand deviation and a constant, the pixel is considered to match this Gaussian distribution. Since there are float variables μk
                            and σk
                            in (3), we conduct some transformations to (3) so that the calculation can be accomplished using variables νk
                            and 
                              
                                 Φ
                                 k
                                 N
                              
                           . As 
                              
                                 
                                    Σ
                                    k
                                    N
                                 
                                 =
                                 
                                    
                                       (
                                       
                                          σ
                                          k
                                          N
                                       
                                       )
                                    
                                    2
                                 
                                 ,
                              
                            by squaring both sides, (3) can then be transformed as follows:

                              
                                 (21)
                                 
                                    
                                       
                                          
                                             (
                                             
                                                x
                                                N
                                             
                                             −
                                             
                                                μ
                                                k
                                                N
                                             
                                             )
                                          
                                          2
                                       
                                       ≤
                                       
                                          
                                             T
                                             h
                                          
                                          2
                                       
                                       ×
                                       
                                          Σ
                                          k
                                          N
                                       
                                       .
                                    
                                 
                              
                           Then multiply 
                              
                                 
                                    (
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                       
                                       N
                                    
                                    
                                       p
                                       (
                                       
                                          w
                                          k
                                       
                                       |
                                       
                                          x
                                          i
                                       
                                       )
                                    
                                    )
                                 
                                 2
                              
                            at both ends, (21) is turned to the following expression:

                              
                                 (22)
                                 
                                    
                                       
                                          
                                          
                                          
                                             
                                                
                                                   
                                                      (
                                                      
                                                         x
                                                         N
                                                      
                                                      
                                                         ∑
                                                         
                                                            i
                                                            =
                                                            1
                                                         
                                                         N
                                                      
                                                      
                                                         p
                                                         (
                                                         
                                                            w
                                                            k
                                                         
                                                         |
                                                         
                                                            x
                                                            i
                                                         
                                                         )
                                                      
                                                      −
                                                      
                                                         μ
                                                         k
                                                         N
                                                      
                                                      
                                                         ∑
                                                         
                                                            i
                                                            =
                                                            1
                                                         
                                                         N
                                                      
                                                      
                                                         p
                                                         (
                                                         
                                                            w
                                                            k
                                                         
                                                         |
                                                         
                                                            x
                                                            i
                                                         
                                                         )
                                                      
                                                      )
                                                   
                                                   2
                                                
                                                ≤
                                                
                                                   
                                                      T
                                                      h
                                                   
                                                   2
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                ×
                                                
                                                   Σ
                                                   k
                                                   N
                                                
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   N
                                                
                                                
                                                   p
                                                   (
                                                   
                                                      w
                                                      k
                                                   
                                                   |
                                                   
                                                      x
                                                      i
                                                   
                                                   )
                                                
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   N
                                                
                                                
                                                   p
                                                   (
                                                   
                                                      w
                                                      k
                                                   
                                                   |
                                                   
                                                      x
                                                      i
                                                   
                                                   )
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           As 
                              
                                 
                                    μ
                                    k
                                    N
                                 
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    N
                                 
                                 
                                    p
                                    (
                                    
                                       w
                                       k
                                    
                                    |
                                    
                                       x
                                       i
                                    
                                    )
                                 
                              
                            equals to 
                              
                                 ν
                                 k
                                 N
                              
                            and 
                              
                                 
                                    Σ
                                    k
                                    N
                                 
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    N
                                 
                                 
                                    p
                                    (
                                    
                                       w
                                       k
                                    
                                    |
                                    
                                       x
                                       i
                                    
                                    )
                                 
                              
                            equals to 
                              
                                 
                                    Φ
                                    k
                                    N
                                 
                                 ,
                              
                            
                           (22) can be simplified as

                              
                                 (23)
                                 
                                    
                                       
                                          
                                             (
                                             
                                                x
                                                N
                                             
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                N
                                             
                                             
                                                p
                                                (
                                                
                                                   w
                                                   k
                                                
                                                |
                                                
                                                   x
                                                   i
                                                
                                                )
                                             
                                             −
                                             
                                                ν
                                                k
                                                N
                                             
                                             )
                                          
                                          2
                                       
                                       ≤
                                       
                                          
                                             T
                                             h
                                          
                                          2
                                       
                                       ×
                                       
                                          Ψ
                                          k
                                          N
                                       
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          N
                                       
                                       
                                          p
                                          (
                                          
                                             w
                                             k
                                          
                                          |
                                          
                                             x
                                             i
                                          
                                          )
                                       
                                       .
                                    
                                 
                              
                           Thus the new matching rule does not need any float variables. All the calculations can be accomplished using integers.

In order to find the first matching Gaussian distribution, GMM needs to sort the Gaussian distributions according to the fitness value 
                              
                                 ϕ
                                 k
                                 N
                              
                            after updating the parameters. This step is also prerequisite of fGMM. As shown in (2), the fitness value 
                              
                                 ϕ
                                 k
                                 N
                              
                            is represented by float or double because of the division operation in GMM. To avoid the division operations and floating-point calculations, fGMM does not calculate the fitness value 
                              
                                 ϕ
                                 k
                                 N
                              
                            directly. Instead, it adopts an indirect comparing method using diagonal multiplication to compare two fractions. For instance, if fGMM needs to compare 
                              
                                 ϕ
                                 k
                                 N
                              
                            of 
                              
                                 M
                                 k
                              
                            and 
                              
                                 ϕ
                                 j
                                 N
                              
                            of 
                              
                                 
                                    M
                                    j
                                 
                                 ,
                              
                            firstly square 
                              
                                 ϕ
                                 k
                                 N
                              
                            and 
                              
                                 
                                    ϕ
                                    j
                                    N
                                 
                                 ,
                              
                           
                           
                              
                                 (24)
                                 
                                    
                                       
                                          
                                             (
                                             
                                                ϕ
                                                k
                                                N
                                             
                                             )
                                          
                                          2
                                       
                                       =
                                       
                                          
                                             (
                                             
                                                
                                                   w
                                                   k
                                                   N
                                                
                                                
                                                   σ
                                                   k
                                                   N
                                                
                                             
                                             )
                                          
                                          2
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   (
                                                   
                                                      w
                                                      k
                                                      N
                                                   
                                                   )
                                                
                                             
                                             2
                                          
                                          
                                             Σ
                                             k
                                             N
                                          
                                       
                                       ,
                                    
                                 
                              
                           
                           
                              
                                 (25)
                                 
                                    
                                       
                                          
                                             (
                                             
                                                ϕ
                                                j
                                                N
                                             
                                             )
                                          
                                          2
                                       
                                       =
                                       
                                          
                                             (
                                             
                                                
                                                   w
                                                   j
                                                   N
                                                
                                                
                                                   σ
                                                   j
                                                   N
                                                
                                             
                                             )
                                          
                                          2
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   (
                                                   
                                                      w
                                                      j
                                                      N
                                                   
                                                   )
                                                
                                             
                                             2
                                          
                                          
                                             Σ
                                             j
                                             N
                                          
                                       
                                       .
                                    
                                 
                              
                           
                        

By multiplying N
                           2 at both ends of (24) and (25), we can get the following equations:

                              
                                 (26)
                                 
                                    
                                       
                                          
                                             (
                                             
                                                ϕ
                                                k
                                                N
                                             
                                             )
                                          
                                          2
                                       
                                       
                                          N
                                          2
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   (
                                                   
                                                      w
                                                      k
                                                      N
                                                   
                                                   N
                                                   )
                                                
                                             
                                             2
                                          
                                          
                                             Σ
                                             k
                                             N
                                          
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   (
                                                   
                                                      f
                                                      k
                                                      N
                                                   
                                                   )
                                                
                                             
                                             2
                                          
                                          
                                             Σ
                                             k
                                             N
                                          
                                       
                                       ,
                                    
                                 
                              
                           
                           
                              
                                 (27)
                                 
                                    
                                       
                                          
                                             (
                                             
                                                ϕ
                                                j
                                                N
                                             
                                             )
                                          
                                          2
                                       
                                       
                                          N
                                          2
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   (
                                                   
                                                      w
                                                      j
                                                      N
                                                   
                                                   N
                                                   )
                                                
                                             
                                             2
                                          
                                          
                                             Σ
                                             j
                                             N
                                          
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   (
                                                   
                                                      f
                                                      j
                                                      N
                                                   
                                                   )
                                                
                                             
                                             2
                                          
                                          
                                             Σ
                                             j
                                             N
                                          
                                       
                                       .
                                    
                                 
                              
                           Note that since N
                           2 is greater than 0, this multiplication would not change the inequality relationship of 
                              
                                 ϕ
                                 k
                                 N
                              
                            and 
                              
                                 ϕ
                                 j
                                 N
                              
                           .

Until now, the inequality relationship of 
                              
                                 ϕ
                                 k
                                 N
                              
                            and 
                              
                                 ϕ
                                 j
                                 N
                              
                            still cannot be determined, because the value of 
                              
                                 Σ
                                 k
                                 N
                              
                            and 
                              
                                 Σ
                                 j
                                 N
                              
                            cannot be obtained. To transform them to 
                              
                                 Ψ
                                 k
                                 N
                              
                            and 
                              
                                 
                                    Ψ
                                    j
                                    N
                                 
                                 ,
                              
                            we further multiply 
                              
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    N
                                 
                                 
                                    p
                                    (
                                    
                                       w
                                       k
                                    
                                    |
                                    
                                       x
                                       i
                                    
                                    )
                                 
                              
                            in the numerator and denominator of 
                              
                                 
                                    
                                       (
                                       
                                          f
                                          k
                                          N
                                       
                                       )
                                    
                                    2
                                 
                                 
                                    Σ
                                    k
                                    N
                                 
                              
                            in (26), and similarly multiply 
                              
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    N
                                 
                                 
                                    p
                                    (
                                    
                                       w
                                       j
                                    
                                    |
                                    
                                       x
                                       i
                                    
                                    )
                                 
                              
                            in the numerator and denominator of 
                              
                                 
                                    
                                       (
                                       
                                          f
                                          j
                                          N
                                       
                                       )
                                    
                                    2
                                 
                                 
                                    Σ
                                    j
                                    N
                                 
                              
                            in (27). Thus, (26) and (27) can be transformed as follows:

                              
                                 (28)
                                 
                                    
                                       
                                          
                                             (
                                             
                                                ϕ
                                                k
                                                N
                                             
                                             )
                                          
                                          2
                                       
                                       
                                          N
                                          2
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   (
                                                   
                                                      f
                                                      k
                                                      N
                                                   
                                                   )
                                                
                                             
                                             2
                                          
                                          
                                             Σ
                                             k
                                             N
                                          
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   (
                                                   
                                                      f
                                                      k
                                                      N
                                                   
                                                   )
                                                
                                             
                                             2
                                          
                                          
                                             Σ
                                             k
                                             N
                                          
                                       
                                       ×
                                       
                                          
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                N
                                             
                                             
                                                p
                                                (
                                                
                                                   w
                                                   k
                                                
                                                |
                                                
                                                   x
                                                   i
                                                
                                                )
                                             
                                          
                                          
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                N
                                             
                                             
                                                p
                                                (
                                                
                                                   w
                                                   k
                                                
                                                |
                                                
                                                   x
                                                   i
                                                
                                                )
                                             
                                          
                                       
                                       ,
                                    
                                 
                              
                           
                           
                              
                                 (29)
                                 
                                    
                                       
                                          
                                             (
                                             
                                                ϕ
                                                j
                                                N
                                             
                                             )
                                          
                                          2
                                       
                                       
                                          N
                                          2
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   (
                                                   
                                                      f
                                                      j
                                                      N
                                                   
                                                   )
                                                
                                             
                                             2
                                          
                                          
                                             Σ
                                             j
                                             N
                                          
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   (
                                                   
                                                      f
                                                      j
                                                      N
                                                   
                                                   )
                                                
                                             
                                             2
                                          
                                          
                                             Σ
                                             j
                                             N
                                          
                                       
                                       ×
                                       
                                          
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                N
                                             
                                             
                                                p
                                                (
                                                
                                                   w
                                                   j
                                                
                                                |
                                                
                                                   x
                                                   i
                                                
                                                )
                                             
                                          
                                          
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                N
                                             
                                             
                                                p
                                                (
                                                
                                                   w
                                                   j
                                                
                                                |
                                                
                                                   x
                                                   i
                                                
                                                )
                                             
                                          
                                       
                                       .
                                    
                                 
                              
                           As 
                              
                                 
                                    Ψ
                                    k
                                    N
                                 
                                 =
                                 
                                    Σ
                                    k
                                    N
                                 
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    N
                                 
                                 
                                    p
                                    (
                                    
                                       w
                                       k
                                    
                                    |
                                    
                                       x
                                       i
                                    
                                    )
                                 
                              
                            and 
                              
                                 
                                    Ψ
                                    j
                                    N
                                 
                                 =
                                 
                                    Σ
                                    j
                                    N
                                 
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    N
                                 
                                 
                                    p
                                    (
                                    
                                       w
                                       j
                                    
                                    |
                                    
                                       x
                                       i
                                    
                                    )
                                 
                                 ,
                              
                            
                           (28) and (29) can be further simplified as follows:

                              
                                 (30)
                                 
                                    
                                       
                                          
                                             (
                                             
                                                ϕ
                                                k
                                                N
                                             
                                             )
                                          
                                          2
                                       
                                       
                                          N
                                          2
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   
                                                      (
                                                      
                                                         f
                                                         k
                                                         N
                                                      
                                                      )
                                                   
                                                
                                                2
                                             
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                N
                                             
                                             
                                                p
                                                (
                                                
                                                   w
                                                   k
                                                
                                                |
                                                
                                                   x
                                                   i
                                                
                                                )
                                             
                                          
                                          
                                             Ψ
                                             k
                                             N
                                          
                                       
                                       ,
                                    
                                 
                              
                           
                           
                              
                                 (31)
                                 
                                    
                                       
                                          
                                             (
                                             
                                                ϕ
                                                j
                                                N
                                             
                                             )
                                          
                                          2
                                       
                                       
                                          N
                                          2
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   
                                                      (
                                                      
                                                         f
                                                         j
                                                         N
                                                      
                                                      )
                                                   
                                                
                                                2
                                             
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                N
                                             
                                             
                                                p
                                                (
                                                
                                                   w
                                                   j
                                                
                                                |
                                                
                                                   x
                                                   i
                                                
                                                )
                                             
                                          
                                          
                                             Ψ
                                             j
                                             N
                                          
                                       
                                       .
                                    
                                 
                              
                           As such, the inequality 
                              
                                 
                                    ϕ
                                    k
                                    N
                                 
                                 <
                                 
                                    ϕ
                                    j
                                    N
                                 
                              
                            equals to

                              
                                 (32)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      (
                                                      
                                                         f
                                                         k
                                                         N
                                                      
                                                      )
                                                   
                                                
                                                2
                                             
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                N
                                             
                                             
                                                p
                                                (
                                                
                                                   w
                                                   k
                                                
                                                |
                                                
                                                   x
                                                   i
                                                
                                                )
                                             
                                          
                                          
                                             Ψ
                                             k
                                             N
                                          
                                       
                                       <
                                       
                                          
                                             
                                                
                                                   
                                                      (
                                                      
                                                         f
                                                         j
                                                         N
                                                      
                                                      )
                                                   
                                                
                                                2
                                             
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                N
                                             
                                             
                                                p
                                                (
                                                
                                                   w
                                                   j
                                                
                                                |
                                                
                                                   x
                                                   i
                                                
                                                )
                                             
                                          
                                          
                                             Ψ
                                             j
                                             N
                                          
                                       
                                       .
                                    
                                 
                              
                           To avoid division operations, we can multiply 
                              
                                 
                                    Ψ
                                    k
                                    N
                                 
                                 
                                    Ψ
                                    j
                                    N
                                 
                              
                            in both sides of (32). Then the inequality 
                              
                                 
                                    ϕ
                                    k
                                    N
                                 
                                 <
                                 
                                    ϕ
                                    j
                                    N
                                 
                              
                            finally equals to

                              
                                 (33)
                                 
                                    
                                       
                                          
                                             (
                                             
                                                f
                                                k
                                                N
                                             
                                             )
                                          
                                          2
                                       
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          N
                                       
                                       
                                          p
                                          (
                                          
                                             w
                                             k
                                          
                                          |
                                          
                                             x
                                             i
                                          
                                          )
                                       
                                       
                                          Ψ
                                          j
                                          N
                                       
                                       <
                                       
                                          
                                             (
                                             
                                                f
                                                j
                                                N
                                             
                                             )
                                          
                                          2
                                       
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          N
                                       
                                       
                                          p
                                          (
                                          
                                             w
                                             j
                                          
                                          |
                                          
                                             x
                                             i
                                          
                                          )
                                       
                                       
                                          Ψ
                                          k
                                          N
                                       
                                       .
                                    
                                 
                              
                           After the derivations, all the variables are integers now and there is no division operation needed in (33).

In general, compared with other background modeling methods such as SWRA, GMM is much more memory-consuming. The reasons are two-folds. First, GMM needs to buffer one frame in memory and one pixel needs K Gaussian distributions (often setting to 5) to describe it. Supposing there are M pixels in one frame and the memory cost of one Gaussian distribution is S bytes, the total memory cost T is K × M × S bytes. Second, one Gaussian distribution needs to store 4 parameters: the weight parameter w, the mean parameter μ, the variance parameter Σ and the matching point counter. In these 4 parameters, the first three parameters are double and the last one is short, so the total memory cost T for GMM is 
                           
                              (
                              8
                              ×
                              3
                              +
                              2
                              )
                              K
                              M
                           
                         bytes, namely 26KM bytes.

In fGMM, we introduce some integer variables to replace the corresponding float ones. This will not lead to the increase of the memory complexity. The reasons are as follows: In fGMM, the pixel number M of one frame and the Gaussian distribution number K are the same with GMM. However, the memory cost of one Gaussian distribution S can be greatly reduced. As the three double parameters, namely weight, mean and variance, can be replaced by integer parameters, the total memory cost T for fGMM can decrease to 
                           
                              (
                              4
                              ×
                              3
                              +
                              2
                              )
                              K
                              M
                           
                         bytes, namely 14KM bytes. That is, compared with GMM, fGMM can save 46% memory cost. For fpGMM, as it just uses 4 bits to represent a double value, the total memory cost T also decreases to 
                           
                              (
                              4
                              ×
                              3
                              +
                              2
                              )
                              K
                              M
                           
                         bytes, namely 14KM bytes. Although achieving the goal of saving memory, the approximate fractional representations sacrifice the quality of the reconstructed background, which is demonstrated in Section 4 in details. The memory costs of different versions of GMM are shown in Table 2
                        .

In practice, we can further reduce the memory cost of fGMM by using less number of Gaussian distributions. Our experimental results in Section 4.3 show that by only using two Gaussian distributions for each pixel, fGMM-2 can also obtain comparable compression efficiency (with only increase of 0.3∼0.4% bit-rate) with GMM-5 (i.e., the GMM with five Gaussian distributions for each pixel), but can save 78.5% memory cost.

@&#EXPERIMENTS@&#

In order to verify the effectiveness of the proposed fGMM, three sets of experiments were conducted: the comparison of different versions of GMM in background qualify, the surveillance video coding experiments on the IEEE 1857-S platform (AVS) [2] when using different background modeling methods, and the object detection experiments to validate whether fGMM can be used to improve the performance of video analysis tasks. Note that IEEE 1857-S is the first video coding standard with the profile for surveillance videos (the jiankong profile in AVS) [2]. To make the experimental results applicable to different video codecs, experiments on the HEVC/H.265 were also conducted.

The experimental
                         sequences are all from the PKU-SVD-A dataset. This dataset consists of more than 10 uncompressed videos with different resolutions (ranging from SD, 720p, 1600 × 1200, and 1920 × 1080). We adopt this dataset because it is the only public dataset for surveillance video coding till to now, and some sequences from this dataset are also used as IEEE 1857-S surveillance test sequences.

Eight sequences from the PKU-SVD-A dataset were used in our experiments (shown in Fig. 4). In these sequences, four of them are 720 × 576 (SD) sequences and the other four are 1920 × 1080 (HD) sequences. In the SD sequences, the sequences Bank, Crossroad and Overbridge were captured from a very busy crossroad, and contain different kinds of objects such as cars, buses, buildings, pedestrians and so on. The other SD sequence Classover was captured from a campus and can be used to evaluate the methods in the uncomplicated scene. The four HD sequences RedHouseNo.4_north, WeiMingLake_east, RedHouseNo.4_west and RedHouseNo.1_east (abbreviated as No.4_north, Lake_east, No.4_west and No.1_east in this paper) can be used to evaluate the performance of the methods on high resolution videos. Especially, the sequence No.1_east captured in dusk was adopted to evaluate the background modeling methods in extreme illumination conditions. It should be noted that all the eight sequences were used in the video coding experiments, while the three HD sequences No.4_north, Lake_east and No.4_west were used in the object detection experiments, since they are more viable to label the ground-truths (i.e., the rectangles containing objects).

To compare the samples of different GMMs subjectively, we used three methods, namely GMM, fGMM and fpGMM [24], to build the background pictures through training on several frames. The experimental settings are the same as above. Note that for all GMM-related methods in the experiments, we used the same settings of these parameters.

Some examples of the background pictures generated by GMM and fGMM are shown in Fig. 5. We can see that, the background pictures generated by fGMM and GMM are visually almost the same, very hard to be distinguished by human eyes. This experimental result confirms that the approximate calculation in fGMM has little influence on the generated background pictures.

In addition, Fig. 6 visualizes some examples of background pictures generated by fGMM and fpGMM. In fpGMM’s results, there are several foreground pollution cases in the background pictures (marked by circles) caused by approximate calculations. Since there are many approximate calculations in fpGMM, the overall precision is rather low, exerting negative influence on the quality of background pictures.

Recently, some works [5,6,12,26] have showed that background modeling can significantly improve the performance of surveillance video coding, because the background picture can provide better reference for the following encoding frames. So the best way to assess whether a background modeling method is suitable for surveillance video coding is to evaluate the compressing ratio. Thus this set of experiments were to evaluate the performance of different background modeling methods [27,28] when used in video coding. Five background modeling methods and AVS baseline profile encoder were included in our experiment:

                           
                              (1)
                              Running Average (RA): a simple pixel-based background modeling method. The background update is as follows:

                                    
                                       (34)
                                       
                                          
                                             
                                                B
                                                
                                                   N
                                                   +
                                                   1
                                                
                                             
                                             =
                                             α
                                             
                                                x
                                                N
                                             
                                             +
                                             
                                                (
                                                1
                                                −
                                                α
                                                )
                                             
                                             
                                                B
                                                N
                                             
                                             ,
                                          
                                       
                                    
                                 where BN
                                  is the background value when the window size equals to N, xN
                                  is the pixel value and α is the updating ratio.

Segment-and-Weight based Running Average (SWRA): SWRA firstly divides pixels at each position in the training frames into several temporal segments, and then calculates their corresponding means and weights. After that, a running and weighted average procedure is used to reduce the influence of foreground pixels. This method is one of the recommended background modeling methods in the AVS reference software.

GMM: The float version of GMM in [14] is used to generate the background pic tures.

Motion Vector Average (MVA): In [29], Vacavant et al. proposed a block-size based background modeling method. Similar to [29], the testing method in this experiment uses the motion vector (MV) in video coding to build the background pictures. MV denotes the direction and distance of the movement of one block. If the size of MV is greater than four, this block is considered to be a foreground block and its pixel value cannot be used to update the background. Otherwise, it uses the current pixel value to update the background.

Fixed-point GMM in [24] (fpGMM): fpGMM uses the float-point conversion to complete the calculations in GMM.

AVS baseline profile encoder (BP): The standard AVS encoder without background modeling.

In our experiment,
                         except the AVS baseline profile encoder, the number of training frames of all the other encoders is 200 and the background update cycle is 600. The number of all the encoded frames is 1500. For fair comparison, all the anchors and our algorithm were implemented on the SM2_1.6 (very believable AVS reference software) jiankong profile with the common test conditions [2]. The configurations in our experiment are shown in Table 3 and the eight video sequences are encoded with QP = 27, 32, 38 and 45.

The compressing ratios of different methods are measured by bd-rate [30]. The bd-rate results for the eight sequences are shown in Table 4, while the rate-distortion curves are shown in Fig. 7
                        . Compared with the AVS baseline profile encoder (BP), due to the positive influences of the background references, fGMM saves 59.5% bit-rate for the SD sequences and 47.3% bit-rate for the HD sequences on average. These results again validate that background modeling is considerably helpful in surveillance video coding. For the SD sequences, fGMM saves 9.1, 5.8 and 3.7% bit-rate, respectively compared with MVA, RA and SWRA. For the HD sequences, fGMM also saves 9.5, 4.5 and 3.1% bit-rate. These results show that fGMM is more effective than MVA, RA and SWRA when used in video coding. By comparing with fpGMM in [24], fGMM saves 10.0% bit-rate for the SD sequences and 11.7% bit-rate for the HD sequences. At last, compared with GMM, fGMM increases 0.03% bit-rate for the SD sequences and 0.1% bit-rate for the HD sequences. This performance loss is mainly caused by the approximate calculation in fGMM. In practice, it is almost ignorable.

To evaluate the performance of fGMM on different encoders, an additional experiment based on HM12.0 (the HEVC/H.265 reference software) was conducted. In [31], a method which utilizes the background pictures for surveillance video coding and prediction in HEVC was proposed. We implemented this approach in our experiments and used GMM and fGMM to generate the background pictures so as to compare their performance. The configurations for HEVC/H.265 are shown in Table 5 and the eight video sequences are encoded with QP at 22, 27, 32 and 37. The experimental results are shown in Table 6. Since the HEVC encoder supports the variable block structure, the results are a little bit different with those on AVS. But no matter on HEVC or AVS, the performance loss is both considerably small and thus can be acceptable under the conditions of using approximate calculations in fGMM.

In the experiments above, the number of Gaussian distributions equals to 5. We conducted an additional experiment using fGMM-2 to build the background pictures for video coding. In this experiment, all the parameters are the same with above except the number of Gaussian distributions. The results are shown in Table 7. Compared with GMM-5, fGMM-2 increases 0.3% bit-rate on SD and 0.4% bit-rate on HD on average. Taking the memory saving brought by fGMM-2 into account, the bit-rate increase is rather acceptable.

The purpose of this set of experiments was to evaluate the performance of fGMM when used in video analysis tasks (e.g., object detection). In the experiment, the quantitative evaluation was done by comparing the similarity between the subtraction results and the ground-truths. Often, the ground-truths should be manually labelled in the form of accurate contours of all foreground objects. However, labeling such ground-truths on a large data set is very labor-consuming. A simplified method is proposed in [32] and this evaluation method has been used in many papers (e.g. 
                        [19]), where some random frames are extracted from the test data, and the ground-truths of these frames are generated by labeling the bounding boxes of foreground objects. When at least 40% pixels in an object bounding box (note that 25% was used in [32]) are determined as foregrounds by an algorithm, that object is viewed as a correct detection. The true positive TP is defined as the ratio of the number of correctly detecting objects vs. the number of labelled objects in the ground-truths, and the negative positive FP is measured as the percentage of objects outside the bounding box that are incorrectly classified as foreground [32]. For different background modeling methods, we can plot the ROC curves for each method under different thresholds, and then calculate the Area Under the ROC Curve (AUC). AUC measures the performance from different thresholds and then calculates a single overall score. The geometric meaning of AUC is the area between the ROC curve and the x-axis.

To conduct these experiments, we implemented a Smart Camera system proposed in [2]. The framework and backend interface are shown in Figs. 8 and 9, respectively. This Smart Camera is a real-time surveillance video processing system that can implement the background-model-based surveillance video coding and moving foreground detection inside the camera. Its input sequence is captured from a camera and the output contains four windows shown in Fig. 9. The top-left is the decoded frames, while the top-right is the background frames which can be used in video coding and video analysis at the same time. The bottom-left is foreground masks generated by background subtraction and the bottom-right is the object detection results that are obtained just using the foreground detection.

In this experiment, the performance of object detection in both processing speed and accuracy can be improved remarkably by utilizing the background pictures generated in the coding process. To evaluate the object detection performance, the well-known discriminatively trained part-based models (DPM) [33] is used in the video analysis module to get the final object detection results. It is based on mixtures of multi-scale deformable part models to represent highly variable object classes, thus achieving better performance than other state-of-the-art methods.

Six methods were used in this experiment
                        
                        
                         to evaluate their performances in terms of the object detection task. The first method does not have the background modeling and the background subtraction module in Fig. 8, but just completes the detection processes on the whole decoded video frames (directly denoted as DPM
                           Frame
                         here). The another three methods are to utilize the DPM with three different background modeling methods: fGMM, GMM and SWRA (denoted as DPM
                           fGMM
                        , DPM
                           GMM
                         and DPM
                           SWRA, respectively). The last two are to utilize the DPM with ViBe (denoted as DPM
                           ViBe
                        ) and PBAS (denoted as DPM
                           PBAS
                        ). Note that we directly used the segmentation results of ViBe and PBAS as the input of DPM, because it can only obtain the foregrounds. In all GMM-related methods, they exactly follow the framework in Fig. 8: in the encoding side, the input videos are encoded with background modeling, and the background pictures are also encoded into the bit-stream; while in the decoding side, the bit-streams are decoded to get the video frames and meanwhile the decoded background pictures can be utilized to extract the foreground regions; finally, object detection with DPM is conducted on those foreground regions. Noted that in the whole procedure of the three GMM-related methods, all the steps are identical except that different background modeling methods are used.

The ROC curves of different methods are shown in Fig. 10
                        
                        . We can see that DPM
                           fGMM
                        , DPM
                           GMM
                         and DPM
                           SWRA
                         all outperform the DPM
                           Frame
                        . The reason lies that the foreground regions obtained by background subtraction have excluded some areas where the foreground objects will not appear. For example, in the left frame in Fig. 11, the yellow rectangles are foreground regions generated by fGMM-based background subtraction and the green rectangles are the final detection results; while in the right frame in Fig. 11, the red rectangles are the detection results when DPM
                           Frame
                         is performed directly on the whole decoded frame. There is a false detection rectangle on the upper right corner in the right frame, where the leaves are regarded as a pedestrian. However, in the left side, since the fGMM-based detection is just performed inside the yellow box, this false detection can be avoided. We also notice that DPM
                           fGMM
                         and DPM
                           GMM
                         have nearly the same performance in most cases, both better than DPM
                           SWRA
                        . Basically, the DPM method is very sensitive to foreground regions. That is, one or two pixels deviation of the foreground region may result in a great difference of the final result. This is the reason why the DPM
                           fGMM
                         curve and the DPM
                           GMM
                         curve are separate in some parts. The AUCs of different background modeling methods are shown in Table 8. They are consistent with the ROC curves.

From Table 8, we can see that ViBe and PBAS are slightly better than the GMM-related methods in most cases. However, they cannot be used in video coding. Therefore, fGMM is still one of the best background modeling methods for the hardware implementation of the analysis-friendly video codec.

Also, the detection
                        
                        
                         time results of the six DPM methods on a 4-core PC with 3.3GHz CPU and 4G RAM are recorded in Table 9. Since the DPM
                           Frame
                         has to scan the whole frame, its speed is rather slow, more than 40 seconds per frame for 1920 × 1080 sequences on average. While the DPMs with background modeling methods (i.e., DPM
                           fGMM
                        , DPM
                           GMM
                         and DPM
                           SWRA
                        ) are much faster. The main reason is that the detection is only performed on foreground regions, thus saving a lot of time. Note that the DPM
                           SWRA
                         is slower than DPM
                           fGMM
                         and DPM
                           GMM
                        . This is because the foreground pollution in the background pictures generated by SWRA results in larger foreground regions, thus increasing the detection time of DPM
                           SWRA
                        .

As discussed in Section 2.4, most existing works (e.g., [21–23]) use data conversions to make the GMM more suitable for the hardware implementation. Different from them, the fGMM needs no data conversions because of the mathematical derivations presented in Section 3. Thus no approximate representation will be adopted in our method.

In [21], a simple experiment was conducted on the running average method to evaluate the influence of different fixed-point precisions on the background model. In this paper, a similar experiment is performed on the GMM. For simplicity, the number of Gaussians is set to 1. The matching rule and update strategy for Gaussian parameters (presented in details in Sections 2.1 and2.2) are as follows:

                        
                           (35)
                           
                              
                                 a
                                 b
                                 s
                                 
                                    (
                                    x
                                    −
                                    
                                       μ
                                       k
                                    
                                    )
                                 
                                 ≤
                                 T
                                 h
                                 ×
                                 
                                    σ
                                    k
                                 
                                 ,
                              
                           
                        
                     
                     
                        
                           (36)
                           
                              
                                 
                                    μ
                                    k
                                    
                                       N
                                       +
                                       1
                                    
                                 
                                 =
                                 
                                    μ
                                    k
                                    N
                                 
                                 +
                                 
                                    
                                       p
                                       (
                                       
                                          w
                                          k
                                       
                                       |
                                       
                                          x
                                          
                                             N
                                             +
                                             1
                                          
                                       
                                       )
                                    
                                    
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             N
                                             +
                                             1
                                          
                                       
                                       
                                          p
                                          (
                                          
                                             w
                                             k
                                          
                                          |
                                          
                                             x
                                             i
                                          
                                          )
                                       
                                    
                                 
                                 
                                    (
                                    
                                       x
                                       
                                          N
                                          +
                                          1
                                       
                                    
                                    −
                                    
                                       μ
                                       k
                                       N
                                    
                                    )
                                 
                                 ,
                              
                           
                        
                     
                     
                        
                           (37)
                           
                              
                                 
                                    Σ
                                    k
                                    
                                       N
                                       +
                                       1
                                    
                                 
                                 =
                                 
                                    Σ
                                    k
                                    N
                                 
                                 +
                                 
                                    
                                       p
                                       (
                                       
                                          w
                                          k
                                       
                                       |
                                       
                                          x
                                          
                                             N
                                             +
                                             1
                                          
                                       
                                       )
                                    
                                    
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             N
                                             +
                                             1
                                          
                                       
                                       
                                          p
                                          (
                                          
                                             w
                                             k
                                          
                                          |
                                          
                                             x
                                             i
                                          
                                          )
                                       
                                    
                                 
                                 
                                    (
                                    
                                       (
                                       
                                          x
                                          
                                             N
                                             +
                                             1
                                          
                                       
                                       −
                                       
                                          μ
                                          k
                                          N
                                       
                                       )
                                    
                                    
                                       (
                                       
                                          x
                                          
                                             N
                                             +
                                             1
                                          
                                       
                                       −
                                       
                                          μ
                                          k
                                          N
                                       
                                       )
                                    
                                    −
                                    
                                       Σ
                                       k
                                       N
                                    
                                    )
                                 
                                 .
                              
                           
                        
                     For several pre-selected values of Th (2, 2.5, 3) and 0∼5 bits for the fractional part, (36) was calculated for all possible input values. Then the mean error between the examined representation and double floating point precision was calculated. The result is presented in Fig. 12. We can see, the more bits it used for the fractional part, the less the error is. But using more bits means higher memory costs. To balance the memory costs and errors brought by approximate representations, most of existing methods (e.g., [21–23]) use 3 bits to represent the fractional part. This will influence the quality of the background frame greatly. For fGMM, we can directly implement it on hardware devices with few approximate calculations and lower hardware requirements by comparison with [21]. The framework and physical map of the FPGA implementation of our fGMM are shown in Figs. 13 and 14, respectively.

In [21], the one-model size (namely, the number of bits required to model a pixel using one Gaussian) is 47 bits. In the FPGA implementation of fGMM, it is 48 bits (16 bits for the mean value, 8 bits for the weight and 24 bits for the variance). In fact, we can further decrease the one-model size to 40 bits by just using 16 bits for the variance. But this means that some approximate representation should be adopted like [21]. Therefore, to guarantee the quality of the reconstructed background frame, the one-model size is set to 48 bits in our FPGA implementation. In [21], the processing speed can reach 60 fps for HD videos (1920 × 1080) when the hardware configurations are as follows: the user logic works with 200 MHz clock, the 64-bit data bus to DDR3 memory whose data rate is 800 MHz. In the FPGA implementation of our fGMM, we just requires 140 MHz user logic and 622 MHz DDR3 memory. The calculations are as follows: In our design, we combine two pixels as a group. With this strategy, only 9 cycles are required to update the GMM parameters for two pixels, so the required user logic is 1920 × 1080 × 60 × (9/2) = 560 MHz. As we have 4 processing units (PUs) in the background update module, the actual required user logic is 560/4 = 140 MHz. For the DDR3 memory, the total bandwidth is 1920 × 1080 × 60 × (2 × 2 × 6) = 2.986 GBps = 23.888 bits, where the first “2” in brackets means accessing the memory two times, for writing and reading memory, the second “2” in brackets represents the number of Gaussian distributions, while the number “6” in brackets means the cycles we need to process a pixel using pipeline. Assuming the bandwidth utilization is 60%, the required frequency for DDR3 memory is 23.888/64/0.6 = 0.622GHz = 622 MHz. Therefore, we can use a 622 MHz DDR3 memory to realize real-time processing. The requirements of hardware devices for fGMM and [21] are shown in Table 10.

More importantly, the background frames generated by [21] are obviously worse than those by fGMM. From Fig. 4 in [21], we can see that its background frame contains some visible foreground pollutions brought by converting float into integers. However, as shown in Fig. 5, few foreground pollutions can be found in the background frames generated by our fGMM.

@&#CONCLUSION@&#

This paper proposes a fixed-point Gaussian Mixture Model (fGMM) which eliminates the floating-point calculations and division operations so that it can be used in the hardware implementation of the analysis-friendly surveillance video codec. Compared with other data conversion methods, fGMM has three remarkable advantages. First, fGMM does not introduce any approximate representation to convert float into integer, and also avoids division operations by a division simulation algorithm and an approximate calculation. Extensive experiments on various video coding and content analysis tasks show that fGMM can complete all the calculations using integers to achieve comparable performance with the float version of GMM. Second, fGMM greatly cuts the memory cost due to the removal of floating-point calculations. Experimental results also show that fGMM can saves 46% memory cost compared with its float version. At last, fGMM can be easily implemented in hardware devices. Compared with the state-of-the-art method [21], fGMM has much lower requirements for real-time HD video processing. In the future, we will implement it in SOC so as to effectively empower the cameras with such a hardware codec.

@&#ACKNOWLEDGMENT@&#

This work is partially supported by a grant from the National Basic Research Program of China under 2015CB351806, and partially by grants from the National Natural Science Foundation of China under contract no. 61390515, no. 61425025, no. 61421062 and no. 61471042, and Y.H. Tian and T.J. Huang are also supported by Shenzhen Peacock Plan.

@&#REFERENCES@&#

