@&#MAIN-TITLE@&#A variational-difference numerical method for designing progressive-addition lenses

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We propose a variational-difference numerical method for designing progressive-addition lenses.


                        
                        
                           
                           The method can be very easily understood and implemented by optical engineers.


                        
                        
                           
                           The method can provide satisfactory designs for optical engineers in several seconds.


                        
                        
                           
                           The method can be a powerful candidate tool for designing various free-form lenses.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Progressive-addition lens

Variational-difference method

Linearization

Background surface

Functional minimization problem

@&#ABSTRACT@&#


               
               
                  We propose a variational-difference method for designing the optical free form surface of progressive-addition lenses (PALs). The PAL, which has a front surface with three important zones including the far-view, near-view and intermediate zones, is often used to remedy presbyopia by distributing optical powers of the three zones progressively and smoothly. The problem for designing PALs could be viewed as a functional minimization problem. Compared with the existing literature which solved the problem by the B-spline finite element method, the essence of the proposed variational-difference numerical method lies in minimizing the functional directly by finite difference method and/or numerical quadratures rather than in approximating the solution of the corresponding Euler–Lagrange equation to the functional. It is very easily understood and implemented by optical engineers, and the numerical results indicate that it can produce satisfactory designs for optical engineers in several seconds. We believe that our method can be a powerful candidate tool for designing various specifications of PALs.
               
            

@&#INTRODUCTION@&#

When we reach about forty years old, the natural process of aging begins to affect our vision, and the lens of our eyes thickens and progressively loses its flexibility to the point where we have trouble focusing on near points. This causes presbyopia. Therefore, it is natural that people with presbyopia need their vision to be corrected by wearing spectacle lenses. People can often use single-vision lenses to correct this problem. However, although these can enable very good vision for nearby regions, people need to take them off in order to have good vision for distance regions. To avoid this inconvenience, more complicated lenses such as the bifocal lens, trifocal lens and progressive-addition lens (PAL) have been designed.

Bifocal lenses, which were first invented by Benjamin Franklin in 1784 because he suffered from poor vision at that time, can be divided into two parts, the top half for viewing at distance and the bottom half for reading; trifocal lenses are made up of three parts, with the addition of a part for viewing at intermediate region. A major drawback for these two kinds of lenses is the vision jump when the eyes move from seeing far-distance to near-distance objects. PALs, also known as no-line bifocal lenses, can remove the vision jump drawback. Fig. 1
                      shows a schematic illustration of PALs. As shown in Fig. 1(a), a PAL has a front surface with three different view zones, including distance-view (i.e. far-view), near-view and intermediate zones. More precisely, a PAL has a large far-vision area with low refractive optical power in the upper part and a small near-vision area with high refractive optical power in the lower part, while an intermediate vision area where the optical power varies progressively and smoothly is used to connect with the upper and lower parts of the PAL. Fig. 1(b) shows a typical distribution of refractive optical power on the three different view zones of a PAL along the meridian line. In general, a good PAL design requires that the optical power on the far-view, near-view and intermediate zones be progressively and smoothly changed according to every patient’s prescription, and that the astigmatism on the three zones be as small as possible simultaneously. However, the remaining parts, which are called as blending zones shown in Fig. 1(a), also inevitably have astigmatism because of the prescribed power distribution along the three zones. Although the blending zones are the least frequently used by spectacle wearers, the astigmatism will bring them a bad visual feeling and make them uncomfortable. Therefore, a good PAL design also needs to require that the blending zones have relatively low astigmatism.

As early as 1907, British optometrist Owen Aves made a prototype design for PALs  [1,2]. His design idea came from the shape of elephant’s trunk, which consisted of a conical back surface and a cylindrical front with opposing axes in order to create a power progression. This design was the prototype of modern PALs, but it was not commercialized at that time. Since the invention of the first modern design and entry into the marketplace around the 1960s, PALs have been gradually accepted by worldwide customers due to their ability to eliminate the vision jump line between the far-view and near-view portions of the lens and offer spectacle wearers a smooth transition between different vision zones. Nowadays, PALs have gained worldwide acceptance as the high-performance spectacle lenses used in the correction of presbyopia and currently account for more than half of all multi-focal lens sales. Although early progressive lens designs have had great success in providing presbyopic patients with more comfortable vision, lens designers seem to be approaching a limiting state  [3]. Because the visual requirements of spectacle lens wearers vary greatly from person to person, it has been understood for some time that the traditional “one-size-fits-all” progressive lens design framework is no longer suitable for every progressive lens wearer. Therefore, designers need to tailor more suitable and specialized spectacle lenses by considering the unique visual requirements of the individual progressive lens wearer. Thus, the advances in design methods are becoming ever more significant for designing the next generation PALs.

Designing PALs is often regarded as a very complicated mathematical problem  [4–10]. In general, the design methods can be divided into two categories, direct methods and indirect methods. In a direct method, such as the research work of Winthrop [4,5] and Baudart, Ahsbahs and Miege  [6], the refractive optical power is first assigned along a line called the meridian line (shown in Fig. 1) on the lens, then the surface on the lens is generated from the meridian line by prescribing curves which are transverse to it. The shapes of these curves are chosen to have the desired surface curvature on the meridian line. However, the performance of such design methods is often less than satisfactory because there is no effective control over the distribution of the astigmatism. For the indirect method, such as the method proposed by Loos et al.  [7,8], the lens design can be simplified as an optimization problem or a functional minimization problem. In such a method, a cost function (functional), which attempts to balance between reaching the desired distribution of refractive optical power and the unwanted astigmatism, will be devised and beforehand given. The design objective is to minimize the cost function (functional) by numerical methods. The indirect method is often more effective and powerful, and it can be quickly implemented by powerful computer simulations. It can also provide more precise control for the distribution of the optical power and astigmatism on the lens surface. Therefore, it represents a powerful candidate tool for designing the customized PALs.

In this paper, we focus on the indirect methods for designing PALs. Based on a functional minimization mathematical model, we propose an efficient variational-difference numerical method for solving the problem. Compared with the existing literature which solved the problem by the 
                        B
                     -spline finite element method [7,9,10], the essence of the proposed variational-difference numerical method lies in minimizing the functional directly by the finite difference method rather than in approximating the solution of the corresponding Euler–Lagrange equation to the functional. It is very easily understood and implemented by optical engineers, and its memory and computational costs are smaller than that of the 
                        B
                     -spline finite element method. Our numerical results indicate that it could produce satisfactory design results for optical engineers in several seconds.

The rest of the paper is organized as follows. In the next section, we briefly present a mathematical model based on a quadratic functional minimization problem for designing PALs. In Section  3, a variational-difference numerical method is proposed for solving the quadratic functional minimization problem. In Section  4, numerical results are presented to demonstrate the high performances of the proposed numerical method. Finally, Section  5 concludes the paper with a summary and future research plans.

For the design of PALs, the optical power is one of the two crucial design parameters for optical engineers according to every patient’s prescription. In general, the optical power of PAL is determined by the shapes of the front and back surfaces, together with the material properties of the lens. In ophthalmic optics, the optical power 
                           P
                         of a lens can be expressed in terms of  [7,9,10]
                        
                           
                              (2.1)
                              
                                 P
                                 =
                                 
                                    (
                                    1
                                    −
                                    n
                                    )
                                 
                                 
                                    
                                       P
                                    
                                    
                                       b
                                    
                                 
                                 +
                                 
                                    
                                       
                                          (
                                          n
                                          −
                                          1
                                          )
                                       
                                       
                                          
                                             P
                                          
                                          
                                             f
                                          
                                       
                                    
                                    
                                       1
                                       −
                                       d
                                       
                                          (
                                          1
                                          −
                                          
                                             
                                                1
                                             
                                             
                                                n
                                             
                                          
                                          )
                                       
                                       
                                          
                                             P
                                          
                                          
                                             f
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 P
                              
                              
                                 b
                              
                           
                         and 
                           
                              
                                 P
                              
                              
                                 f
                              
                           
                         are the mean curvatures of the back and front surfaces, respectively, 
                           d
                         is the thickness of the lens and 
                           n
                         represents the refractive index of the lens material. Under the assumption that the lens is very thin, we obtain an approximate formula from (2.1) by setting 
                           d
                           =
                           0
                        : 
                           
                              (2.2)
                              
                                 P
                                 =
                                 
                                    (
                                    n
                                    −
                                    1
                                    )
                                 
                                 
                                    (
                                    
                                       
                                          P
                                       
                                       
                                          f
                                       
                                    
                                    −
                                    
                                       
                                          P
                                       
                                       
                                          b
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                         For the PAL discussed in the paper, the back surface is chosen as a spherical surface with constant mean curvature. Therefore, from the formula (2.2), the progressive change for the optical power 
                           P
                         of a PAL would be achieved by changing the mean curvature of the front surface smoothly and progressively. In this paper, the design objective is to determine the shape of the front surface of the PAL. For brevity, the optical power 
                           P
                         is referred to as the power of the front surface in the remainder of the paper. The optical power is measured in diopter, which is defined as the inverse of focal length (i.e. mean curvature) multiplied by 
                           
                              (
                              n
                              −
                              1
                              )
                           
                        . Therefore, the diopter is of unit 1/meter.

The other crucial design parameter for PALs is called as the (surface) astigmatism or cylinder. Suppose 
                           
                              
                                 κ
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 κ
                              
                              
                                 2
                              
                           
                         are the two local principal curvatures of the front surface, then the astigmatism of a lens is defined as 
                           
                              (2.3)
                              
                                 A
                                 =
                                 
                                    (
                                    n
                                    −
                                    1
                                    )
                                 
                                 
                                    |
                                    
                                       
                                          κ
                                       
                                       
                                          1
                                       
                                    
                                    −
                                    
                                       
                                          κ
                                       
                                       
                                          2
                                       
                                    
                                    |
                                 
                                 ,
                              
                           
                         and the unit of astigmatism is also used as diopter. We can see that the two parameters of interest for a PAL design, optical power and astigmatism, are only related to the sum and the difference of the two principal curvatures, respectively. In general, the optical power is needed to provide the appropriate corrections for patients, while the astigmatism is an undesirable effect for a PAL design in the paper. Because if a lens has severe astigmatism, vision distortion will occur and the spectacle wearer will feel uncomfortable, unless the wearer has any astigmatic defect of their eyes.

An ideal PAL is one with the prescribed smooth progressive optical power distribution and with the zero astigmatism everywhere on the lens. However, in order to attain zero astigmatism on the whole surface, the surface must be a plane or a sphere, which cannot provide prescribed progressive power. Therefore, the two key design factors, of reaching the desired distribution of optical power and the undesired astigmatism, compete with each other. Following the above observation, Loos et al. proposed a method for determining the shapes of thin progressive lenses, which enables the designers to create a large variety of different designs. Based on their method, to design the surface of PALs, we can minimize the following functional  [7]: 
                           
                              (2.4)
                              
                                 J
                                 
                                    (
                                    u
                                    )
                                 
                                 =
                                 
                                    
                                       ∫
                                    
                                    
                                       Ω
                                    
                                 
                                 
                                    [
                                    α
                                    
                                       (
                                       x
                                       ,
                                       y
                                       )
                                    
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   
                                                      
                                                         κ
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         κ
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                             )
                                          
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    β
                                    
                                       (
                                       x
                                       ,
                                       y
                                       )
                                    
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   
                                                      
                                                         κ
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         κ
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                             −
                                             
                                                
                                                   P
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                (
                                                x
                                                ,
                                                y
                                                )
                                             
                                             )
                                          
                                       
                                       
                                          2
                                       
                                    
                                    ]
                                 
                                 d
                                 A
                                 ,
                              
                           
                         where 
                           Ω
                           ⊂
                           
                              
                                 R
                              
                              
                                 2
                              
                           
                         is a bounded domain, 
                           u
                           ≔
                           u
                           
                              (
                              x
                              ,
                              y
                              )
                           
                         defines the shape of the designed lens surface, 
                           
                              
                                 κ
                              
                              
                                 1
                              
                           
                           ≔
                           
                              
                                 κ
                              
                              
                                 1
                              
                           
                           
                              (
                              x
                              ,
                              y
                              )
                           
                         and 
                           
                              
                                 κ
                              
                              
                                 2
                              
                           
                           ≔
                           
                              
                                 κ
                              
                              
                                 2
                              
                           
                           
                              (
                              x
                              ,
                              y
                              )
                           
                         represent the two principal curvatures of the surface, respectively, 
                           d
                           A
                         represents the area element on the graph of 
                           u
                           
                              (
                              x
                              ,
                              y
                              )
                           
                        , and the three functions 
                           α
                           ≔
                           α
                           
                              (
                              x
                              ,
                              y
                              )
                           
                           ,
                           β
                           ≔
                           β
                           
                              (
                              x
                              ,
                              y
                              )
                           
                         and 
                           
                              
                                 P
                              
                              
                                 0
                              
                           
                           ≔
                           
                              
                                 P
                              
                              
                                 0
                              
                           
                           
                              (
                              x
                              ,
                              y
                              )
                           
                         are previously prescribed functions in 
                           Ω
                        . More precisely, the prescribed function 
                           
                              
                                 P
                              
                              
                                 0
                              
                           
                         is the desired distribution of optical power, and its magnitude increases continuously from the far-view region to the near-view region; the weight functions 
                           α
                         and 
                           β
                         control the ratio relation between the occurrence of astigmatism and the derivation from the prescribed power distribution function 
                           
                              
                                 P
                              
                              
                                 0
                              
                           
                        .

Substituting the mean curvature 
                           H
                         and Gauss curvature 
                           K
                         defined as 
                           
                              (2.5)
                              
                                 H
                                 ≔
                                 H
                                 
                                    (
                                    x
                                    ,
                                    y
                                    )
                                 
                                 =
                                 
                                    
                                       
                                          
                                             κ
                                          
                                          
                                             1
                                          
                                       
                                       +
                                       
                                          
                                             κ
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                 K
                                 ≔
                                 K
                                 
                                    (
                                    x
                                    ,
                                    y
                                    )
                                 
                                 =
                                 
                                    
                                       κ
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       κ
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                 
                                    (
                                    x
                                    ,
                                    y
                                    )
                                 
                                 ∈
                                 Ω
                                 ,
                              
                           
                         into the functional (2.4), we can formulate the problem for designing PALs as the following minimization problem: 
                           
                              (2.6)
                              
                                 
                                    (
                                    
                                       P
                                    
                                    )
                                 
                                 
                                 
                                    Min
                                 
                                 
                                 J
                                 
                                    (
                                    u
                                    )
                                 
                                 =
                                 
                                    
                                       ∫
                                    
                                    
                                       Ω
                                    
                                 
                                 
                                    [
                                    α
                                    
                                       (
                                       x
                                       ,
                                       y
                                       )
                                    
                                    
                                       (
                                       
                                          
                                             H
                                          
                                          
                                             2
                                          
                                       
                                       
                                          (
                                          x
                                          ,
                                          y
                                          )
                                       
                                       −
                                       K
                                       
                                          (
                                          x
                                          ,
                                          y
                                          )
                                       
                                       )
                                    
                                    +
                                    β
                                    
                                       (
                                       x
                                       ,
                                       y
                                       )
                                    
                                    
                                       
                                          
                                             (
                                             H
                                             
                                                (
                                                x
                                                ,
                                                y
                                                )
                                             
                                             −
                                             
                                                
                                                   P
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                (
                                                x
                                                ,
                                                y
                                                )
                                             
                                             )
                                          
                                       
                                       
                                          2
                                       
                                    
                                    ]
                                 
                                 d
                                 A
                                 .
                              
                           
                         Suppose that in the Cartesian coordinates the surface of a lens is given by the graph function 
                           z
                           =
                           u
                           
                              (
                              x
                              ,
                              y
                              )
                           
                         for 
                           
                              (
                              x
                              ,
                              y
                              )
                           
                           ∈
                           Ω
                        , then the mean curvature 
                           H
                         and Gauss curvature 
                           K
                         can be given by 
                           
                              (2.7)
                              
                                 H
                                 =
                                 
                                    
                                       
                                          (
                                          1
                                          +
                                          
                                             
                                                u
                                             
                                             
                                                x
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                       
                                          
                                             u
                                          
                                          
                                             y
                                             y
                                          
                                       
                                       −
                                       2
                                       
                                          
                                             u
                                          
                                          
                                             x
                                          
                                       
                                       
                                          
                                             u
                                          
                                          
                                             y
                                          
                                       
                                       
                                          
                                             u
                                          
                                          
                                             x
                                             y
                                          
                                       
                                       +
                                       
                                          (
                                          1
                                          +
                                          
                                             
                                                u
                                             
                                             
                                                y
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                       
                                          
                                             u
                                          
                                          
                                             x
                                             x
                                          
                                       
                                    
                                    
                                       2
                                       
                                          
                                             g
                                          
                                          
                                             3
                                          
                                       
                                    
                                 
                                 ,
                                 
                                 K
                                 =
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             x
                                             x
                                          
                                       
                                       
                                          
                                             u
                                          
                                          
                                             y
                                             y
                                          
                                       
                                       −
                                       
                                          
                                             u
                                          
                                          
                                             x
                                             y
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       
                                          
                                             g
                                          
                                          
                                             4
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                         and the area element 
                           
                              d
                           
                           A
                         can be expressed by 
                           
                              (2.8)
                              
                                 d
                                 A
                                 =
                                 g
                                 
                                 d
                                 x
                                 d
                                 y
                                 ,
                                 
                                 with
                                 
                                 g
                                 =
                                 
                                    
                                       1
                                       +
                                       
                                          
                                             u
                                          
                                          
                                             x
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             u
                                          
                                          
                                             y
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 ,
                                 
                                 
                                    (
                                    x
                                    ,
                                    y
                                    )
                                 
                                 ∈
                                 Ω
                                 .
                              
                           
                         Plugging (2.7) and (2.8) into (2.6), we obtain the functional minimization problem for designing a PAL lens.

The Euler–Lagrange equation with respect to the functional in (2.6) is a highly nonlinear and high order partial differential equation. Therefore, it is generally very difficult and challenging to solve the problem 
                           
                              (
                              
                                 P
                              
                              )
                           
                         by direct numerical computation. In the literatures, Wang et al.  [11,9,12] adopted the linearization approximation method for the Euler–Lagrange equation generated from the variational problem 
                           
                              (
                              
                                 P
                              
                              )
                           
                         to design PALs. By assuming that the designed lens surfaces are a combination of two parts (one is a prescribed spherical background surface and the other is a small perturbation surface with respect to the chosen spherical surface) they simplified the Euler–Lagrange equation with respect to the functional in (2.6) to a linear fourth-order partial differential equation. Under the various boundary conditions including clamped, partially clamped and natural boundary conditions, they showed the existence and uniqueness as well as the regularity of the solutions with respect to the linear fourth-order partial differential equation  [11]. Furthermore, by using the 
                           B
                        -spline finite element method, they designed a numerical algorithm for solving the linearized problem  [9].

Following the linearization approach proposed by Wang et al.  [11,9] for designing PALs, we assume that the surface function 
                           u
                           
                              (
                              x
                              ,
                              y
                              )
                           
                         can be divided into two parts: 
                           
                              (2.9)
                              
                                 u
                                 
                                    (
                                    x
                                    ,
                                    y
                                    )
                                 
                                 =
                                 w
                                 
                                    (
                                    x
                                    ,
                                    y
                                    )
                                 
                                 +
                                 v
                                 
                                    (
                                    x
                                    ,
                                    y
                                    )
                                 
                                 ,
                                 
                                 
                                    (
                                    x
                                    ,
                                    y
                                    )
                                 
                                 ∈
                                 Ω
                                 ,
                              
                           
                         where 
                           w
                           ≔
                           w
                           
                              (
                              x
                              ,
                              y
                              )
                           
                         is a chosen background surface and 
                           v
                           ≔
                           v
                           
                              (
                              x
                              ,
                              y
                              )
                           
                         represents the perturbation surface. Therefore, the functional minimization problem 
                           
                              (
                              
                                 P
                              
                              )
                           
                         with respect to 
                           u
                           
                              (
                              x
                              ,
                              y
                              )
                           
                         can be converted to the problem with respect to the small perturbation function 
                           v
                           
                              (
                              x
                              ,
                              y
                              )
                           
                        . Substituting (2.9) into (2.7) and (2.8) and further assuming that the perturbation function 
                           v
                           
                              (
                              x
                              ,
                              y
                              )
                           
                         satisfies that 
                           
                              |
                              ∇
                              v
                              |
                           
                           ≈
                           0
                         and 
                           
                              |
                              
                                 
                                    ∇
                                 
                                 
                                    2
                                 
                              
                              v
                              |
                           
                         is bounded from above in the domain 
                           Ω
                        , we can obtain the approximation expressions for 
                           H
                           ,
                           K
                         and 
                           g
                         as 
                           
                              
                                 (2.10)
                                 
                                    H
                                    ≈
                                    
                                       
                                          H
                                       
                                       
                                          ̂
                                       
                                    
                                    
                                       (
                                       v
                                       ;
                                       w
                                       )
                                    
                                    =
                                    H
                                    
                                       (
                                       w
                                       )
                                    
                                    +
                                    
                                       
                                          
                                             (
                                             1
                                             +
                                             
                                                
                                                   w
                                                
                                                
                                                   x
                                                
                                                
                                                   2
                                                
                                             
                                             )
                                          
                                          
                                             
                                                v
                                             
                                             
                                                y
                                                y
                                             
                                          
                                          −
                                          2
                                          
                                             
                                                w
                                             
                                             
                                                x
                                             
                                          
                                          
                                             
                                                w
                                             
                                             
                                                y
                                             
                                          
                                          
                                             
                                                v
                                             
                                             
                                                x
                                                y
                                             
                                          
                                          +
                                          
                                             (
                                             1
                                             +
                                             
                                                
                                                   w
                                                
                                                
                                                   y
                                                
                                                
                                                   2
                                                
                                             
                                             )
                                          
                                          
                                             
                                                v
                                             
                                             
                                                x
                                                x
                                             
                                          
                                       
                                       
                                          2
                                          
                                             
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      ̂
                                                   
                                                
                                             
                                             
                                                3
                                             
                                          
                                       
                                    
                                    ,
                                    
                                    
                                       (
                                       x
                                       ,
                                       y
                                       )
                                    
                                    ∈
                                    Ω
                                    ,
                                 
                              
                              
                                 (2.11)
                                 
                                    K
                                    ≈
                                    
                                       
                                          K
                                       
                                       
                                          ̂
                                       
                                    
                                    
                                       (
                                       v
                                       ;
                                       w
                                       )
                                    
                                    =
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   w
                                                
                                                
                                                   x
                                                   x
                                                
                                             
                                             +
                                             
                                                
                                                   v
                                                
                                                
                                                   x
                                                   x
                                                
                                             
                                             )
                                          
                                          
                                             (
                                             
                                                
                                                   w
                                                
                                                
                                                   y
                                                   y
                                                
                                             
                                             +
                                             
                                                
                                                   v
                                                
                                                
                                                   y
                                                   y
                                                
                                             
                                             )
                                          
                                          −
                                          
                                             
                                                
                                                   (
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         x
                                                         y
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         x
                                                         y
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      ̂
                                                   
                                                
                                             
                                             
                                                4
                                             
                                          
                                       
                                    
                                    ,
                                    
                                    g
                                    ≈
                                    
                                       
                                          g
                                       
                                       
                                          ̂
                                       
                                    
                                    =
                                    
                                       
                                          1
                                          +
                                          
                                             
                                                w
                                             
                                             
                                                x
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                w
                                             
                                             
                                                y
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           
                         Inserting (2.10) and (2.11) into (2.6), we obtain the following functional which is an approximation to 
                           J
                           
                              (
                              u
                              )
                           
                         in (2.6): 
                           
                              (2.12)
                              
                                 I
                                 
                                    (
                                    v
                                    ;
                                    w
                                    )
                                 
                                 =
                                 
                                    
                                       ∫
                                    
                                    
                                       Ω
                                    
                                 
                                 
                                    [
                                    
                                       (
                                       α
                                       +
                                       β
                                       )
                                    
                                    
                                       
                                          
                                             
                                                H
                                             
                                             
                                                ̂
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                    −
                                    2
                                    β
                                    
                                       
                                          P
                                       
                                       
                                          0
                                       
                                    
                                    
                                       
                                          H
                                       
                                       
                                          ̂
                                       
                                    
                                    −
                                    α
                                    
                                       
                                          K
                                       
                                       
                                          ̂
                                       
                                    
                                    +
                                    β
                                    
                                       
                                          P
                                       
                                       
                                          0
                                       
                                       
                                          2
                                       
                                    
                                    ]
                                 
                                 
                                    
                                       g
                                    
                                    
                                       ̂
                                    
                                 
                                 
                                 d
                                 x
                                 d
                                 y
                                 .
                              
                           
                         For any given background surface 
                           w
                           
                              (
                              x
                              ,
                              y
                              )
                           
                        , substituting (2.10) and (2.11) into (2.12), we can easily find that the functional 
                           I
                           
                              (
                              v
                              ;
                              w
                              )
                           
                         only depends on the second-order partial derivatives of the perturbation function 
                           v
                           
                              (
                              x
                              ,
                              y
                              )
                           
                        , i.e. the terms 
                           
                              
                                 v
                              
                              
                                 x
                                 x
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 x
                                 y
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 y
                                 y
                              
                           
                        , and they are all in quadratic form. It should be noted that, for simplicity, we can drop all the constant terms in expression (2.12) and still denote the functional as 
                           I
                           
                              (
                              v
                              ;
                              w
                              )
                           
                        , then the functional 
                           I
                           
                              (
                              v
                              ;
                              w
                              )
                           
                         can be expressed by the following quadratic functional form: 
                           
                              (2.13)
                              
                                 I
                                 
                                    (
                                    v
                                    ;
                                    w
                                    )
                                 
                                 =
                                 
                                    
                                       ∫
                                    
                                    
                                       Ω
                                    
                                 
                                 F
                                 
                                    (
                                    x
                                    ,
                                    y
                                    ,
                                    
                                       
                                          v
                                       
                                       
                                          x
                                          x
                                       
                                    
                                    ,
                                    
                                       
                                          v
                                       
                                       
                                          x
                                          y
                                       
                                    
                                    ,
                                    
                                       
                                          v
                                       
                                       
                                          y
                                          y
                                       
                                    
                                    )
                                 
                                 
                                 d
                                 x
                                 d
                                 y
                                 ,
                              
                           
                         where the integrand 
                           F
                           
                              (
                              x
                              ,
                              y
                              ,
                              
                                 
                                    v
                                 
                                 
                                    x
                                    x
                                 
                              
                              ,
                              
                                 
                                    v
                                 
                                 
                                    x
                                    y
                                 
                              
                              ,
                              
                                 
                                    v
                                 
                                 
                                    y
                                    y
                                 
                              
                              )
                           
                         is continuous for all the arguments 
                           x
                           ,
                           y
                           ,
                           
                              
                                 v
                              
                              
                                 x
                                 x
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 x
                                 y
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 y
                                 y
                              
                           
                         and can be defined as 
                           
                              (2.14)
                              
                                 F
                                 
                                    (
                                    x
                                    ,
                                    y
                                    ,
                                    
                                       
                                          v
                                       
                                       
                                          x
                                          x
                                       
                                    
                                    ,
                                    
                                       
                                          v
                                       
                                       
                                          x
                                          y
                                       
                                    
                                    ,
                                    
                                       
                                          v
                                       
                                       
                                          y
                                          y
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       a
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       v
                                    
                                    
                                       x
                                       x
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       a
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       v
                                    
                                    
                                       x
                                       y
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       a
                                    
                                    
                                       3
                                    
                                 
                                 
                                    
                                       v
                                    
                                    
                                       y
                                       y
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       a
                                    
                                    
                                       4
                                    
                                 
                                 
                                    
                                       v
                                    
                                    
                                       x
                                       x
                                    
                                 
                                 
                                    
                                       v
                                    
                                    
                                       y
                                       y
                                    
                                 
                                 +
                                 
                                    
                                       a
                                    
                                    
                                       5
                                    
                                 
                                 
                                    
                                       v
                                    
                                    
                                       x
                                       y
                                    
                                 
                                 
                                    
                                       v
                                    
                                    
                                       y
                                       y
                                    
                                 
                                 +
                                 
                                    
                                       a
                                    
                                    
                                       6
                                    
                                 
                                 
                                    
                                       v
                                    
                                    
                                       x
                                       x
                                    
                                 
                                 
                                    
                                       v
                                    
                                    
                                       x
                                       y
                                    
                                 
                                 +
                                 
                                    
                                       a
                                    
                                    
                                       7
                                    
                                 
                                 
                                    
                                       v
                                    
                                    
                                       x
                                       x
                                    
                                 
                                 +
                                 
                                    
                                       a
                                    
                                    
                                       8
                                    
                                 
                                 
                                    
                                       v
                                    
                                    
                                       x
                                       y
                                    
                                 
                                 +
                                 
                                    
                                       a
                                    
                                    
                                       9
                                    
                                 
                                 
                                    
                                       v
                                    
                                    
                                       y
                                       y
                                    
                                 
                                 ,
                              
                           
                         where the coefficients 
                           
                              
                                 a
                              
                              
                                 i
                              
                           
                         for 
                           i
                           =
                           1
                           ,
                           2
                           ,
                           …
                           ,
                           9
                         are given by 
                           
                              
                                 
                                    
                                       
                                          a
                                       
                                       
                                          1
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   (
                                                   1
                                                   +
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         y
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          4
                                          
                                             
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      ̂
                                                   
                                                
                                             
                                             
                                                5
                                             
                                          
                                       
                                    
                                    
                                       (
                                       α
                                       +
                                       β
                                       )
                                    
                                    ,
                                    
                                    
                                       
                                          a
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                w
                                             
                                             
                                                x
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                w
                                             
                                             
                                                y
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      ̂
                                                   
                                                
                                             
                                             
                                                5
                                             
                                          
                                       
                                    
                                    
                                       (
                                       α
                                       +
                                       β
                                       )
                                    
                                    +
                                    
                                       
                                          α
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      ̂
                                                   
                                                
                                             
                                             
                                                3
                                             
                                          
                                       
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          a
                                       
                                       
                                          3
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   (
                                                   1
                                                   +
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         x
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          4
                                          
                                             
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      ̂
                                                   
                                                
                                             
                                             
                                                5
                                             
                                          
                                       
                                    
                                    
                                       (
                                       α
                                       +
                                       β
                                       )
                                    
                                    ,
                                    
                                    
                                       
                                          a
                                       
                                       
                                          4
                                       
                                    
                                    =
                                    
                                       
                                          
                                             (
                                             1
                                             +
                                             
                                                
                                                   w
                                                
                                                
                                                   x
                                                
                                                
                                                   2
                                                
                                             
                                             )
                                          
                                          
                                             (
                                             1
                                             +
                                             
                                                
                                                   w
                                                
                                                
                                                   y
                                                
                                                
                                                   2
                                                
                                             
                                             )
                                          
                                       
                                       
                                          2
                                          
                                             
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      ̂
                                                   
                                                
                                             
                                             
                                                5
                                             
                                          
                                       
                                    
                                    
                                       (
                                       α
                                       +
                                       β
                                       )
                                    
                                    −
                                    
                                       
                                          α
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      ̂
                                                   
                                                
                                             
                                             
                                                3
                                             
                                          
                                       
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          a
                                       
                                       
                                          5
                                       
                                    
                                    =
                                    −
                                    
                                       
                                          
                                             
                                                w
                                             
                                             
                                                x
                                             
                                          
                                          
                                             
                                                w
                                             
                                             
                                                y
                                             
                                          
                                          
                                             (
                                             1
                                             +
                                             
                                                
                                                   w
                                                
                                                
                                                   x
                                                
                                                
                                                   2
                                                
                                             
                                             )
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      ̂
                                                   
                                                
                                             
                                             
                                                5
                                             
                                          
                                       
                                    
                                    
                                       (
                                       α
                                       +
                                       β
                                       )
                                    
                                    ,
                                    
                                    
                                       
                                          a
                                       
                                       
                                          6
                                       
                                    
                                    =
                                    −
                                    
                                       
                                          
                                             
                                                w
                                             
                                             
                                                x
                                             
                                          
                                          
                                             
                                                w
                                             
                                             
                                                y
                                             
                                          
                                          
                                             (
                                             1
                                             +
                                             
                                                
                                                   w
                                                
                                                
                                                   y
                                                
                                                
                                                   2
                                                
                                             
                                             )
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      ̂
                                                   
                                                
                                             
                                             
                                                5
                                             
                                          
                                       
                                    
                                    
                                       (
                                       α
                                       +
                                       β
                                       )
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          a
                                       
                                       
                                          7
                                       
                                    
                                    =
                                    
                                       
                                          
                                             (
                                             1
                                             +
                                             
                                                
                                                   w
                                                
                                                
                                                   y
                                                
                                                
                                                   2
                                                
                                             
                                             )
                                          
                                          H
                                          
                                             (
                                             w
                                             )
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      ̂
                                                   
                                                
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    
                                       (
                                       α
                                       +
                                       β
                                       )
                                    
                                    −
                                    
                                       
                                          
                                             
                                                w
                                             
                                             
                                                y
                                                y
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      ̂
                                                   
                                                
                                             
                                             
                                                3
                                             
                                          
                                       
                                    
                                    α
                                    −
                                    
                                       
                                          1
                                          +
                                          
                                             
                                                w
                                             
                                             
                                                y
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      ̂
                                                   
                                                
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    β
                                    
                                       
                                          P
                                       
                                       
                                          0
                                       
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          a
                                       
                                       
                                          8
                                       
                                    
                                    =
                                    −
                                    
                                       
                                          2
                                          
                                             
                                                w
                                             
                                             
                                                x
                                             
                                          
                                          
                                             
                                                w
                                             
                                             
                                                y
                                             
                                          
                                          H
                                          
                                             (
                                             w
                                             )
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      ̂
                                                   
                                                
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    
                                       (
                                       α
                                       +
                                       β
                                       )
                                    
                                    +
                                    
                                       
                                          2
                                          
                                             
                                                w
                                             
                                             
                                                x
                                                y
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      ̂
                                                   
                                                
                                             
                                             
                                                3
                                             
                                          
                                       
                                    
                                    α
                                    +
                                    
                                       
                                          2
                                          
                                             
                                                w
                                             
                                             
                                                x
                                             
                                          
                                          
                                             
                                                w
                                             
                                             
                                                y
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      ̂
                                                   
                                                
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    β
                                    
                                       
                                          P
                                       
                                       
                                          0
                                       
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          a
                                       
                                       
                                          9
                                       
                                    
                                    =
                                    
                                       
                                          
                                             (
                                             1
                                             +
                                             
                                                
                                                   w
                                                
                                                
                                                   x
                                                
                                                
                                                   2
                                                
                                             
                                             )
                                          
                                          H
                                          
                                             (
                                             w
                                             )
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      ̂
                                                   
                                                
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    
                                       (
                                       α
                                       +
                                       β
                                       )
                                    
                                    −
                                    
                                       
                                          
                                             
                                                w
                                             
                                             
                                                x
                                                x
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      ̂
                                                   
                                                
                                             
                                             
                                                3
                                             
                                          
                                       
                                    
                                    α
                                    −
                                    
                                       
                                          1
                                          +
                                          
                                             
                                                w
                                             
                                             
                                                x
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      ̂
                                                   
                                                
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    β
                                    
                                       
                                          P
                                       
                                       
                                          0
                                       
                                    
                                    ,
                                    
                                    
                                       (
                                       x
                                       ,
                                       y
                                       )
                                    
                                    ∈
                                    Ω
                                    .
                                 
                              
                           
                        
                     

In the literature  [11,9,12] and in this paper, for simplicity, the background surface is often chosen as spherical, i.e. 
                           
                              (2.15)
                              
                                 w
                                 
                                    (
                                    x
                                    ,
                                    y
                                    )
                                 
                                 =
                                 
                                    
                                       
                                          
                                             R
                                          
                                          
                                             2
                                          
                                       
                                       −
                                       
                                          
                                             x
                                          
                                          
                                             2
                                          
                                       
                                       −
                                       
                                          
                                             y
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 ,
                                 
                                 
                                    (
                                    x
                                    ,
                                    y
                                    )
                                 
                                 ∈
                                 Ω
                                 ,
                              
                           
                         where 
                           R
                         is a constant to be determined. Under the spherical background surface for 
                           w
                        , noticing (2.7), we get 
                           
                              
                                 
                                    H
                                    
                                       (
                                       w
                                       )
                                    
                                    =
                                    −
                                    
                                       
                                          1
                                       
                                       
                                          R
                                       
                                    
                                    ,
                                    
                                    
                                       
                                          w
                                       
                                       
                                          x
                                       
                                    
                                    =
                                    −
                                    
                                       
                                          x
                                       
                                       
                                          
                                             
                                                
                                                   (
                                                   
                                                      
                                                         R
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                1
                                                /
                                                2
                                             
                                          
                                       
                                    
                                    ,
                                    
                                    
                                       
                                          w
                                       
                                       
                                          y
                                       
                                    
                                    =
                                    −
                                    
                                       
                                          y
                                       
                                       
                                          
                                             
                                                
                                                   (
                                                   
                                                      
                                                         R
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                1
                                                /
                                                2
                                             
                                          
                                       
                                    
                                    ,
                                    
                                    
                                       (
                                       x
                                       ,
                                       y
                                       )
                                    
                                    ∈
                                    Ω
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          w
                                       
                                       
                                          x
                                          x
                                       
                                    
                                    =
                                    
                                       
                                          −
                                          
                                             
                                                R
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                y
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   (
                                                   
                                                      
                                                         R
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                3
                                                /
                                                2
                                             
                                          
                                       
                                    
                                    ,
                                    
                                    
                                       
                                          w
                                       
                                       
                                          x
                                          y
                                       
                                    
                                    =
                                    −
                                    
                                       
                                          x
                                          y
                                       
                                       
                                          
                                             
                                                
                                                   (
                                                   
                                                      
                                                         R
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                3
                                                /
                                                2
                                             
                                          
                                       
                                    
                                    ,
                                    
                                    
                                       
                                          w
                                       
                                       
                                          y
                                          y
                                       
                                    
                                    =
                                    
                                       
                                          −
                                          
                                             
                                                R
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                x
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   (
                                                   
                                                      
                                                         R
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                3
                                                /
                                                2
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           
                         We remark here that other kinds of background surfaces can also be used but we omit their investigation and discussion here for brevity.

Since the lenses in use are often circular, in practice, for designing a PAL lens, the computational domain 
                           Ω
                         is usually chosen as a larger square containing the circular domain. When one finally finishes the design, one can ignore the other part and keep the targeted circular part as the prototype for manufacturing. Therefore, in our theoretical design, we always choose the computational domain as 
                           Ω
                           =
                           
                              
                                 
                                    [
                                    −
                                    
                                       
                                          L
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    
                                       
                                          L
                                       
                                       
                                          2
                                       
                                    
                                    ]
                                 
                              
                              
                                 2
                              
                           
                         with 
                           L
                         as the length of the square.

Since the functional (2.13) with (2.14) is a typical quadratic functional and it only depends on the second-order partial derivatives with respect to the perturbation function 
                           v
                           
                              (
                              x
                              ,
                              y
                              )
                           
                        , thus if a function 
                           
                              
                                 v
                              
                              
                                 0
                              
                           
                           
                              (
                              x
                              ,
                              y
                              )
                           
                         minimizes the functional 
                           I
                           
                              (
                              v
                              ;
                              w
                              )
                           
                        , then it is easy to check that the function 
                           
                              
                                 v
                              
                              
                                 0
                              
                           
                           
                              (
                              x
                              ,
                              y
                              )
                           
                           +
                           l
                           
                              (
                              x
                              ,
                              y
                              )
                           
                         also minimizes the functional 
                           I
                           
                              (
                              v
                              ;
                              w
                              )
                           
                         provided that 
                           l
                           
                              (
                              x
                              ,
                              y
                              )
                           
                         is a linear function on the domain 
                           Ω
                        , i.e. 
                           l
                           
                              (
                              x
                              ,
                              y
                              )
                           
                           =
                           
                              
                                 c
                              
                              
                                 1
                              
                           
                           x
                           +
                           
                              
                                 c
                              
                              
                                 2
                              
                           
                           y
                           +
                           
                              
                                 c
                              
                              
                                 3
                              
                           
                         with 
                           
                              
                                 c
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 c
                              
                              
                                 2
                              
                           
                         and 
                           
                              
                                 c
                              
                              
                                 3
                              
                           
                         any three given constants. In order to ensure the uniqueness of the minimizer to the minimization problem, we might fix the values of the perturbation surface 
                           v
                           
                              (
                              x
                              ,
                              y
                              )
                           
                         at three points, e.g. three corners, of the domain 
                           Ω
                        . Therefore, for designing the surface of PALs, we need to solve the following linearized functional minimization problem with respect to the perturbation surface function 
                           v
                           ≔
                           v
                           
                              (
                              x
                              ,
                              y
                              )
                           
                        : 
                           
                              (2.16)
                              
                                 
                                    (
                                    
                                       LP
                                    
                                    )
                                 
                                 
                                 
                                    {
                                    
                                       
                                          
                                             
                                                Min
                                             
                                             
                                             I
                                             
                                                (
                                                v
                                                ;
                                                w
                                                )
                                             
                                             =
                                             
                                                
                                                   ∫
                                                
                                                
                                                   Ω
                                                   =
                                                   
                                                      
                                                         
                                                            [
                                                            −
                                                            
                                                               
                                                                  L
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                            ,
                                                            
                                                               
                                                                  L
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                            ]
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             F
                                             
                                                (
                                                x
                                                ,
                                                y
                                                ,
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      x
                                                      x
                                                   
                                                
                                                ,
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      x
                                                      y
                                                   
                                                
                                                ,
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      y
                                                      y
                                                   
                                                
                                                )
                                             
                                             
                                             d
                                             x
                                             d
                                             y
                                             ,
                                          
                                       
                                       
                                          
                                             v
                                             
                                                (
                                                −
                                                
                                                   
                                                      L
                                                   
                                                   
                                                      2
                                                   
                                                
                                                ,
                                                −
                                                
                                                   
                                                      L
                                                   
                                                   
                                                      2
                                                   
                                                
                                                )
                                             
                                             =
                                             v
                                             
                                                (
                                                −
                                                
                                                   
                                                      L
                                                   
                                                   
                                                      2
                                                   
                                                
                                                ,
                                                
                                                   
                                                      L
                                                   
                                                   
                                                      2
                                                   
                                                
                                                )
                                             
                                             =
                                             v
                                             
                                                (
                                                
                                                   
                                                      L
                                                   
                                                   
                                                      2
                                                   
                                                
                                                ,
                                                
                                                   
                                                      L
                                                   
                                                   
                                                      2
                                                   
                                                
                                                )
                                             
                                             =
                                             0
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                         where the background surface 
                           w
                         is chosen as a spherical surface as (2.15).

In the section, we will present a variational-difference numerical method for solving the linearized functional minimization problem 
                        
                           (
                           
                              LP
                           
                           )
                        
                      by approximating the integral via trapezoid quadrature rule and derivatives via finite differences.

Denote the mesh size 
                        h
                        =
                        
                           Δ
                        
                        x
                        =
                        
                           Δ
                        
                        y
                        ≔
                        
                           
                              L
                           
                           
                              N
                           
                        
                      with 
                        N
                      a given positive integers and define 
                        
                           
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                              =
                              −
                              
                                 
                                    L
                                 
                                 
                                    2
                                 
                              
                              +
                              i
                              
                              h
                              ,
                              
                              i
                              =
                              0
                              ,
                              1
                              ,
                              …
                              ,
                              N
                              ;
                              
                              
                                 
                                    y
                                 
                                 
                                    j
                                 
                              
                              =
                              −
                              
                                 
                                    L
                                 
                                 
                                    2
                                 
                              
                              +
                              j
                              
                              h
                              ,
                              
                              j
                              =
                              0
                              ,
                              1
                              ,
                              …
                              ,
                              N
                              .
                           
                        
                      We partition the domain 
                        Ω
                      into 
                        
                           
                              N
                           
                           
                              2
                           
                        
                      sub-squares as 
                        
                           
                              Ω
                           
                           
                              i
                              j
                           
                        
                        =
                        
                           {
                           
                              (
                              x
                              ,
                              y
                              )
                           
                           ∣
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                           ≤
                           x
                           ≤
                           
                              
                                 x
                              
                              
                                 i
                                 +
                                 1
                              
                           
                           ,
                           
                           
                              
                                 y
                              
                              
                                 j
                              
                           
                           ≤
                           y
                           ≤
                           
                              
                                 y
                              
                              
                                 j
                                 +
                                 1
                              
                           
                           }
                        
                      for 
                        i
                        ,
                        j
                        =
                        0
                        ,
                        1
                        ,
                        …
                        ,
                        N
                        −
                        1
                     . Denote 
                        
                           
                              T
                           
                           
                              h
                           
                        
                      as the set of all grid points, i.e. 
                        
                           
                              T
                           
                           
                              h
                           
                        
                        =
                        
                           {
                           
                              (
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    y
                                 
                                 
                                    j
                                 
                              
                              )
                           
                           ∣
                           i
                           ,
                           j
                           =
                           0
                           ,
                           1
                           ,
                           …
                           ,
                           N
                           }
                        
                     , which is divided into the set of grid points inside 
                        Ω
                     , i.e.  
                        
                           
                              R
                           
                           
                              h
                           
                        
                        =
                        
                           {
                           
                              (
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    y
                                 
                                 
                                    j
                                 
                              
                              )
                           
                           ∣
                           i
                           ,
                           j
                           =
                           1
                           ,
                           2
                           ,
                           …
                           ,
                           N
                           −
                           1
                           }
                        
                     , and the set of grid points on the boundary of 
                        Ω
                     , i.e.  
                        
                           
                              S
                           
                           
                              h
                           
                        
                        =
                        
                           {
                           
                              (
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    y
                                 
                                 
                                    0
                                 
                              
                              )
                           
                           
                           or
                           
                           
                              (
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    y
                                 
                                 
                                    N
                                 
                              
                              )
                           
                           ∣
                           i
                           =
                           0
                           ,
                           1
                           ,
                           …
                           ,
                           N
                           }
                        
                        ∪
                        
                           {
                           
                              (
                              
                                 
                                    x
                                 
                                 
                                    0
                                 
                              
                              ,
                              
                                 
                                    y
                                 
                                 
                                    j
                                 
                              
                              )
                           
                           
                           or
                           
                           
                              (
                              
                                 
                                    x
                                 
                                 
                                    N
                                 
                              
                              ,
                              
                                 
                                    y
                                 
                                 
                                    j
                                 
                              
                              )
                           
                           ∣
                           j
                           =
                           0
                           ,
                           1
                           ,
                           …
                           ,
                           N
                           }
                        
                     . In addition, 
                        
                           
                              S
                           
                           
                              h
                           
                        
                      is further split into the set of corner points, i.e.  
                        
                           
                              S
                           
                           
                              0
                           
                        
                        =
                        
                           {
                           
                              (
                              
                                 
                                    x
                                 
                                 
                                    0
                                 
                              
                              ,
                              
                                 
                                    y
                                 
                                 
                                    0
                                 
                              
                              )
                           
                           ,
                           
                           
                              (
                              
                                 
                                    x
                                 
                                 
                                    0
                                 
                              
                              ,
                              
                                 
                                    y
                                 
                                 
                                    N
                                 
                              
                              )
                           
                           ,
                           
                           
                              (
                              
                                 
                                    x
                                 
                                 
                                    N
                                 
                              
                              ,
                              
                                 
                                    y
                                 
                                 
                                    0
                                 
                              
                              )
                           
                           ,
                           
                           
                              (
                              
                                 
                                    x
                                 
                                 
                                    N
                                 
                              
                              ,
                              
                                 
                                    y
                                 
                                 
                                    N
                                 
                              
                              )
                           
                           }
                        
                     , and the set of the remaining points on the boundary, i.e. 
                        
                           
                              S
                           
                           
                              h
                           
                           
                              1
                           
                        
                        =
                        
                           {
                           
                              (
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    y
                                 
                                 
                                    0
                                 
                              
                              )
                           
                           
                           or
                           
                           
                              (
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    y
                                 
                                 
                                    N
                                 
                              
                              )
                           
                           ∣
                           i
                           =
                           1
                           ,
                           2
                           ,
                           …
                           ,
                           N
                           −
                           1
                           }
                        
                        ∪
                        
                           {
                           
                              (
                              
                                 
                                    x
                                 
                                 
                                    0
                                 
                              
                              ,
                              
                                 
                                    y
                                 
                                 
                                    j
                                 
                              
                              )
                           
                           
                           or
                           
                           
                              (
                              
                                 
                                    x
                                 
                                 
                                    N
                                 
                              
                              ,
                              
                                 
                                    y
                                 
                                 
                                    j
                                 
                              
                              )
                           
                           ∣
                           j
                           =
                           1
                           ,
                           2
                           ,
                           …
                           ,
                           N
                           −
                           1
                           }
                        
                     . Thus we have 
                        
                           
                              T
                           
                           
                              h
                           
                        
                        =
                        
                           
                              R
                           
                           
                              h
                           
                        
                        ∪
                        
                           
                              S
                           
                           
                              h
                           
                        
                        =
                        
                           
                              R
                           
                           
                              h
                           
                        
                        ∪
                        
                           
                              S
                           
                           
                              h
                           
                           
                              1
                           
                        
                        ∪
                        
                           
                              S
                           
                           
                              0
                           
                        
                      and 
                        
                           
                              S
                           
                           
                              h
                           
                        
                        =
                        
                           
                              S
                           
                           
                              h
                           
                           
                              1
                           
                        
                        ∪
                        
                           
                              S
                           
                           
                              0
                           
                        
                     . Based on this partition, we can approximate the integral in (2.16) via the composite trapezoid rule as 
                        
                           (3.1)
                           
                              I
                              
                                 (
                                 v
                                 ;
                                 w
                                 )
                              
                              =
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    =
                                    0
                                 
                                 
                                    N
                                    −
                                    1
                                 
                              
                              
                                 
                                    ∑
                                 
                                 
                                    j
                                    =
                                    0
                                 
                                 
                                    N
                                    −
                                    1
                                 
                              
                              
                                 
                                    ∫
                                 
                                 
                                    
                                       
                                          Ω
                                       
                                       
                                          i
                                          j
                                       
                                    
                                 
                              
                              F
                              
                                 (
                                 x
                                 ,
                                 y
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       x
                                       x
                                    
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       x
                                       y
                                    
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       y
                                       y
                                    
                                 
                                 )
                              
                              
                              d
                              x
                              d
                              y
                              ≈
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    =
                                    0
                                 
                                 
                                    N
                                    −
                                    1
                                 
                              
                              
                                 
                                    ∑
                                 
                                 
                                    j
                                    =
                                    0
                                 
                                 
                                    N
                                    −
                                    1
                                 
                              
                              
                                 
                                    
                                       
                                          h
                                       
                                       
                                          2
                                       
                                    
                                 
                                 
                                    4
                                 
                              
                              
                                 (
                                 
                                    
                                       F
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 +
                                 
                                    
                                       F
                                    
                                    
                                       i
                                       ,
                                       j
                                       +
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       F
                                    
                                    
                                       i
                                       +
                                       1
                                       ,
                                       j
                                    
                                 
                                 +
                                 
                                    
                                       F
                                    
                                    
                                       i
                                       +
                                       1
                                       ,
                                       j
                                       +
                                       1
                                    
                                 
                                 )
                              
                              =
                              
                                 
                                    h
                                 
                                 
                                    2
                                 
                              
                              
                                 [
                                 
                                    
                                       ∑
                                    
                                    
                                       
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                y
                                             
                                             
                                                j
                                             
                                          
                                          )
                                       
                                       ∈
                                       
                                          
                                             R
                                          
                                          
                                             h
                                          
                                       
                                    
                                 
                                 
                                    
                                       F
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 +
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                y
                                             
                                             
                                                j
                                             
                                          
                                          )
                                       
                                       ∈
                                       
                                          
                                             S
                                          
                                          
                                             h
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 
                                    
                                       F
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 +
                                 
                                    
                                       1
                                    
                                    
                                       4
                                    
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                y
                                             
                                             
                                                j
                                             
                                          
                                          )
                                       
                                       ∈
                                       
                                          
                                             S
                                          
                                          
                                             0
                                          
                                       
                                    
                                 
                                 
                                    
                                       F
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 ]
                              
                              ,
                           
                        
                      where 
                        
                           (3.2)
                           
                              
                                 
                                    F
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                              =
                              F
                              
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       j
                                    
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       x
                                       x
                                    
                                 
                                 
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          y
                                       
                                       
                                          j
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       x
                                       y
                                    
                                 
                                 
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          y
                                       
                                       
                                          j
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       y
                                       y
                                    
                                 
                                 
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          y
                                       
                                       
                                          j
                                       
                                    
                                    )
                                 
                                 )
                              
                              ,
                              
                              i
                              ,
                              j
                              =
                              0
                              ,
                              1
                              ,
                              …
                              ,
                              N
                              .
                           
                        
                     
                  

In order to further discretize (3.1), we approximate the derivatives in (3.2) via finite differences. Let 
                        
                           
                              v
                           
                           
                              i
                              ,
                              j
                           
                        
                      be the numerical approximation of 
                        v
                        
                           (
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 y
                              
                              
                                 j
                              
                           
                           )
                        
                      for 
                        i
                        ,
                        j
                        =
                        0
                        ,
                        1
                        ,
                        …
                        ,
                        N
                      and denote the vector 
                        
                           V
                        
                        =
                        
                           {
                           
                              
                                 v
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                           ∣
                           i
                           ,
                           j
                           =
                           0
                           ,
                           1
                           ,
                           …
                           ,
                           N
                           }
                        
                     . Introduce the following standard finite difference operators (see Fig. 2
                     (a)–(i)): 
                        
                           
                              (3.3)
                              
                                 
                                    
                                       δ
                                    
                                    
                                       x
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       v
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       
                                          
                                             h
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   v
                                                
                                                
                                                   i
                                                   −
                                                   1
                                                   ,
                                                   j
                                                
                                             
                                             −
                                             2
                                             
                                                
                                                   v
                                                
                                                
                                                   i
                                                   ,
                                                   j
                                                
                                             
                                             +
                                             
                                                
                                                   v
                                                
                                                
                                                   i
                                                   +
                                                   1
                                                   ,
                                                   j
                                                
                                             
                                             ,
                                             
                                             i
                                             =
                                             1
                                             ,
                                             2
                                             ,
                                             …
                                             ,
                                             N
                                             −
                                             1
                                             ,
                                          
                                       
                                       
                                          
                                             
                                                
                                                   v
                                                
                                                
                                                   0
                                                   ,
                                                   j
                                                
                                             
                                             −
                                             2
                                             
                                                
                                                   v
                                                
                                                
                                                   1
                                                   ,
                                                   j
                                                
                                             
                                             +
                                             
                                                
                                                   v
                                                
                                                
                                                   2
                                                   ,
                                                   j
                                                
                                             
                                             ,
                                             
                                             i
                                             =
                                             0
                                             ,
                                          
                                       
                                       
                                          
                                             
                                                
                                                   v
                                                
                                                
                                                   N
                                                   ,
                                                   j
                                                
                                             
                                             −
                                             2
                                             
                                                
                                                   v
                                                
                                                
                                                   N
                                                   −
                                                   1
                                                   ,
                                                   j
                                                
                                             
                                             +
                                             
                                                
                                                   v
                                                
                                                
                                                   N
                                                   −
                                                   2
                                                   ,
                                                   j
                                                
                                             
                                             ,
                                             
                                             i
                                             =
                                             N
                                             ,
                                          
                                       
                                    
                                 
                                 
                                 j
                                 =
                                 0
                                 ,
                                 1
                                 ,
                                 …
                                 ,
                                 N
                                 ,
                              
                           
                           
                              (3.4)
                              
                                 
                                    
                                       δ
                                    
                                    
                                       y
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       v
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       
                                          
                                             h
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   v
                                                
                                                
                                                   i
                                                   ,
                                                   j
                                                   −
                                                   1
                                                
                                             
                                             −
                                             2
                                             
                                                
                                                   v
                                                
                                                
                                                   i
                                                   ,
                                                   j
                                                
                                             
                                             +
                                             
                                                
                                                   v
                                                
                                                
                                                   i
                                                   ,
                                                   j
                                                   +
                                                   1
                                                
                                             
                                             ,
                                             
                                             j
                                             =
                                             1
                                             ,
                                             2
                                             ,
                                             …
                                             ,
                                             N
                                             −
                                             1
                                             ,
                                          
                                       
                                       
                                          
                                             
                                                
                                                   v
                                                
                                                
                                                   i
                                                   ,
                                                   0
                                                
                                             
                                             −
                                             2
                                             
                                                
                                                   v
                                                
                                                
                                                   i
                                                   ,
                                                   1
                                                
                                             
                                             +
                                             
                                                
                                                   v
                                                
                                                
                                                   i
                                                   ,
                                                   2
                                                
                                             
                                             ,
                                             
                                             j
                                             =
                                             0
                                             ,
                                          
                                       
                                       
                                          
                                             
                                                
                                                   v
                                                
                                                
                                                   i
                                                   ,
                                                   N
                                                
                                             
                                             −
                                             2
                                             
                                                
                                                   v
                                                
                                                
                                                   i
                                                   ,
                                                   N
                                                   −
                                                   1
                                                
                                             
                                             +
                                             
                                                
                                                   v
                                                
                                                
                                                   i
                                                   ,
                                                   N
                                                   −
                                                   2
                                                
                                             
                                             ,
                                             
                                             j
                                             =
                                             N
                                             ,
                                          
                                       
                                    
                                 
                                 
                                 i
                                 =
                                 0
                                 ,
                                 1
                                 ,
                                 …
                                 ,
                                 N
                                 ,
                              
                           
                           
                              (3.5)
                              
                                 
                                    
                                       δ
                                    
                                    
                                       x
                                       y
                                    
                                 
                                 
                                    
                                       v
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       4
                                       
                                          
                                             h
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   v
                                                
                                                
                                                   i
                                                   −
                                                   1
                                                   ,
                                                   j
                                                   −
                                                   1
                                                
                                             
                                             −
                                             
                                                
                                                   v
                                                
                                                
                                                   i
                                                   −
                                                   1
                                                   ,
                                                   j
                                                   +
                                                   1
                                                
                                             
                                             −
                                             
                                                
                                                   v
                                                
                                                
                                                   i
                                                   +
                                                   1
                                                   ,
                                                   j
                                                   −
                                                   1
                                                
                                             
                                             +
                                             
                                                
                                                   v
                                                
                                                
                                                   i
                                                   +
                                                   1
                                                   ,
                                                   j
                                                   +
                                                   1
                                                
                                             
                                             ,
                                             i
                                             ,
                                             j
                                             =
                                             1
                                             ,
                                             2
                                             ,
                                             …
                                             ,
                                             N
                                             −
                                             1
                                             ,
                                          
                                       
                                       
                                          
                                             
                                                
                                                   v
                                                
                                                
                                                   0
                                                   ,
                                                   j
                                                   −
                                                   1
                                                
                                             
                                             −
                                             
                                                
                                                   v
                                                
                                                
                                                   0
                                                   ,
                                                   j
                                                   +
                                                   1
                                                
                                             
                                             −
                                             
                                                
                                                   v
                                                
                                                
                                                   2
                                                   ,
                                                   j
                                                   −
                                                   1
                                                
                                             
                                             +
                                             
                                                
                                                   v
                                                
                                                
                                                   2
                                                   ,
                                                   j
                                                   +
                                                   1
                                                
                                             
                                             ,
                                             i
                                             =
                                             0
                                             ,
                                             j
                                             =
                                             1
                                             ,
                                             2
                                             ,
                                             …
                                             ,
                                             N
                                             −
                                             1
                                             ,
                                          
                                       
                                       
                                          
                                             
                                                
                                                   v
                                                
                                                
                                                   N
                                                   −
                                                   2
                                                   ,
                                                   j
                                                   −
                                                   1
                                                
                                             
                                             −
                                             
                                                
                                                   v
                                                
                                                
                                                   N
                                                   −
                                                   2
                                                   ,
                                                   j
                                                   +
                                                   1
                                                
                                             
                                             −
                                             
                                                
                                                   v
                                                
                                                
                                                   N
                                                   ,
                                                   j
                                                   −
                                                   1
                                                
                                             
                                             +
                                             
                                                
                                                   v
                                                
                                                
                                                   N
                                                   ,
                                                   j
                                                   +
                                                   1
                                                
                                             
                                             ,
                                             i
                                             =
                                             N
                                             ,
                                             
                                             j
                                             =
                                             1
                                             ,
                                             2
                                             ,
                                             …
                                             ,
                                             N
                                             −
                                             1
                                             ,
                                          
                                       
                                       
                                          
                                             
                                                
                                                   v
                                                
                                                
                                                   i
                                                   −
                                                   1
                                                   ,
                                                   0
                                                
                                             
                                             −
                                             
                                                
                                                   v
                                                
                                                
                                                   i
                                                   −
                                                   1
                                                   ,
                                                   2
                                                
                                             
                                             −
                                             
                                                
                                                   v
                                                
                                                
                                                   i
                                                   +
                                                   1
                                                   ,
                                                   0
                                                
                                             
                                             +
                                             
                                                
                                                   v
                                                
                                                
                                                   i
                                                   +
                                                   1
                                                   ,
                                                   2
                                                
                                             
                                             ,
                                             j
                                             =
                                             0
                                             ,
                                             
                                             i
                                             =
                                             1
                                             ,
                                             2
                                             ,
                                             …
                                             ,
                                             N
                                             −
                                             1
                                             ,
                                          
                                       
                                       
                                          
                                             
                                                
                                                   v
                                                
                                                
                                                   i
                                                   −
                                                   1
                                                   ,
                                                   N
                                                   −
                                                   2
                                                
                                             
                                             −
                                             
                                                
                                                   v
                                                
                                                
                                                   i
                                                   −
                                                   1
                                                   ,
                                                   N
                                                
                                             
                                             −
                                             
                                                
                                                   v
                                                
                                                
                                                   i
                                                   +
                                                   1
                                                   ,
                                                   N
                                                   −
                                                   2
                                                
                                             
                                             +
                                             
                                                
                                                   v
                                                
                                                
                                                   i
                                                   +
                                                   1
                                                   ,
                                                   N
                                                
                                             
                                             ,
                                             j
                                             =
                                             N
                                             ,
                                             
                                             i
                                             =
                                             1
                                             ,
                                             2
                                             ,
                                             …
                                             ,
                                             N
                                             −
                                             1
                                             ,
                                          
                                       
                                       
                                          
                                             
                                                
                                                   v
                                                
                                                
                                                   0
                                                   ,
                                                   0
                                                
                                             
                                             −
                                             
                                                
                                                   v
                                                
                                                
                                                   0
                                                   ,
                                                   2
                                                
                                             
                                             −
                                             
                                                
                                                   v
                                                
                                                
                                                   2
                                                   ,
                                                   0
                                                
                                             
                                             +
                                             
                                                
                                                   v
                                                
                                                
                                                   2
                                                   ,
                                                   2
                                                
                                             
                                             ,
                                             i
                                             =
                                             0
                                             ,
                                             
                                             j
                                             =
                                             0
                                             ,
                                          
                                       
                                       
                                          
                                             
                                                
                                                   v
                                                
                                                
                                                   0
                                                   ,
                                                   N
                                                   −
                                                   2
                                                
                                             
                                             −
                                             
                                                
                                                   v
                                                
                                                
                                                   0
                                                   ,
                                                   N
                                                
                                             
                                             −
                                             
                                                
                                                   v
                                                
                                                
                                                   2
                                                   ,
                                                   N
                                                   −
                                                   2
                                                
                                             
                                             +
                                             
                                                
                                                   v
                                                
                                                
                                                   2
                                                   ,
                                                   N
                                                
                                             
                                             ,
                                             i
                                             =
                                             0
                                             ,
                                             
                                             j
                                             =
                                             N
                                             ,
                                          
                                       
                                       
                                          
                                             
                                                
                                                   v
                                                
                                                
                                                   N
                                                   −
                                                   2
                                                   ,
                                                   0
                                                
                                             
                                             −
                                             
                                                
                                                   v
                                                
                                                
                                                   N
                                                   −
                                                   2
                                                   ,
                                                   2
                                                
                                             
                                             −
                                             
                                                
                                                   v
                                                
                                                
                                                   N
                                                   ,
                                                   0
                                                
                                             
                                             +
                                             
                                                
                                                   v
                                                
                                                
                                                   N
                                                   ,
                                                   2
                                                
                                             
                                             ,
                                             i
                                             =
                                             N
                                             ,
                                             
                                             j
                                             =
                                             0
                                             ,
                                          
                                       
                                       
                                          
                                             
                                                
                                                   v
                                                
                                                
                                                   N
                                                   −
                                                   2
                                                   ,
                                                   N
                                                   −
                                                   2
                                                
                                             
                                             −
                                             
                                                
                                                   v
                                                
                                                
                                                   N
                                                   −
                                                   2
                                                   ,
                                                   N
                                                
                                             
                                             −
                                             
                                                
                                                   v
                                                
                                                
                                                   N
                                                   ,
                                                   N
                                                   −
                                                   2
                                                
                                             
                                             +
                                             
                                                
                                                   v
                                                
                                                
                                                   N
                                                   ,
                                                   N
                                                
                                             
                                             ,
                                             i
                                             =
                                             N
                                             ,
                                             
                                             j
                                             =
                                             N
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                      Then the second-order derivatives at the grid points can be approximated as 
                        
                           
                              (3.6)
                              
                                 
                                    
                                       v
                                    
                                    
                                       x
                                       x
                                    
                                 
                                 
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          y
                                       
                                       
                                          j
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       δ
                                    
                                    
                                       x
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       v
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 +
                                 
                                    {
                                    
                                       
                                          
                                             O
                                             
                                                (
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      2
                                                   
                                                
                                                )
                                             
                                             ,
                                          
                                          
                                             
                                                (
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ,
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      j
                                                   
                                                
                                                )
                                             
                                             ∈
                                             
                                                
                                                   R
                                                
                                                
                                                   h
                                                
                                             
                                             ,
                                          
                                       
                                       
                                          
                                             O
                                             
                                                (
                                                h
                                                )
                                             
                                             ,
                                          
                                          
                                             
                                                (
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ,
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      j
                                                   
                                                
                                                )
                                             
                                             ∈
                                             
                                                
                                                   S
                                                
                                                
                                                   h
                                                
                                             
                                             ,
                                          
                                       
                                    
                                 
                                 ≈
                                 
                                    
                                       δ
                                    
                                    
                                       x
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       v
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 ,
                              
                           
                           
                              (3.7)
                              
                                 
                                    
                                       v
                                    
                                    
                                       y
                                       y
                                    
                                 
                                 
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          y
                                       
                                       
                                          j
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       δ
                                    
                                    
                                       y
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       v
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 +
                                 
                                    {
                                    
                                       
                                          
                                             O
                                             
                                                (
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      2
                                                   
                                                
                                                )
                                             
                                             ,
                                          
                                          
                                             
                                                (
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ,
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      j
                                                   
                                                
                                                )
                                             
                                             ∈
                                             
                                                
                                                   R
                                                
                                                
                                                   h
                                                
                                             
                                             ,
                                          
                                       
                                       
                                          
                                             O
                                             
                                                (
                                                h
                                                )
                                             
                                             ,
                                          
                                          
                                             
                                                (
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ,
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      j
                                                   
                                                
                                                )
                                             
                                             ∈
                                             
                                                
                                                   S
                                                
                                                
                                                   h
                                                
                                             
                                             ,
                                          
                                       
                                    
                                 
                                 ≈
                                 
                                    
                                       δ
                                    
                                    
                                       y
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       v
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 ,
                                 
                                 i
                                 ,
                                 j
                                 =
                                 0
                                 ,
                                 1
                                 ,
                                 …
                                 ,
                                 N
                                 ,
                              
                           
                           
                              (3.8)
                              
                                 
                                    
                                       v
                                    
                                    
                                       x
                                       y
                                    
                                 
                                 
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          y
                                       
                                       
                                          j
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       δ
                                    
                                    
                                       x
                                       y
                                    
                                 
                                 
                                    
                                       v
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 +
                                 
                                    {
                                    
                                       
                                          
                                             O
                                             
                                                (
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      2
                                                   
                                                
                                                )
                                             
                                             ,
                                          
                                          
                                             
                                                (
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ,
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      j
                                                   
                                                
                                                )
                                             
                                             ∈
                                             
                                                
                                                   R
                                                
                                                
                                                   h
                                                
                                             
                                             ,
                                          
                                       
                                       
                                          
                                             O
                                             
                                                (
                                                h
                                                )
                                             
                                             ,
                                          
                                          
                                             
                                                (
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ,
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      j
                                                   
                                                
                                                )
                                             
                                             ∈
                                             
                                                
                                                   S
                                                
                                                
                                                   h
                                                
                                             
                                             ,
                                          
                                       
                                    
                                 
                                 ≈
                                 
                                    
                                       δ
                                    
                                    
                                       x
                                       y
                                    
                                 
                                 
                                    
                                       v
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 .
                              
                           
                        
                     
                  

Plugging (3.6)–(3.8) into (3.1), we obtain an approximation to the functional 
                        I
                        
                           (
                           v
                           ;
                           w
                           )
                        
                      as 
                        
                           (3.9)
                           
                              I
                              
                                 (
                                 v
                                 ;
                                 w
                                 )
                              
                              ≈
                              
                                 
                                    h
                                 
                                 
                                    2
                                 
                              
                              
                                 [
                                 
                                    
                                       ∑
                                    
                                    
                                       
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                y
                                             
                                             
                                                j
                                             
                                          
                                          )
                                       
                                       ∈
                                       
                                          
                                             R
                                          
                                          
                                             h
                                          
                                       
                                    
                                 
                                 
                                    
                                       F
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                    
                                       h
                                    
                                 
                                 +
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                y
                                             
                                             
                                                j
                                             
                                          
                                          )
                                       
                                       ∈
                                       
                                          
                                             S
                                          
                                          
                                             h
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 
                                    
                                       F
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                    
                                       h
                                    
                                 
                                 +
                                 
                                    
                                       1
                                    
                                    
                                       4
                                    
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                y
                                             
                                             
                                                j
                                             
                                          
                                          )
                                       
                                       ∈
                                       
                                          
                                             S
                                          
                                          
                                             0
                                          
                                       
                                    
                                 
                                 
                                    
                                       F
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                    
                                       h
                                    
                                 
                                 ]
                              
                              ≔
                              
                                 
                                    I
                                 
                                 
                                    h
                                 
                              
                              
                                 (
                                 
                                    V
                                 
                                 )
                              
                              ,
                           
                        
                      where 
                        
                           (3.10)
                           
                              
                                 
                                    F
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                                 
                                    h
                                 
                              
                              =
                              F
                              
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       j
                                    
                                 
                                 ,
                                 
                                    
                                       δ
                                    
                                    
                                       x
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       v
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 ,
                                 
                                    
                                       δ
                                    
                                    
                                       x
                                       y
                                    
                                 
                                 
                                    
                                       v
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 ,
                                 
                                    
                                       δ
                                    
                                    
                                       y
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       v
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 )
                              
                              ,
                              
                              i
                              ,
                              j
                              =
                              0
                              ,
                              1
                              ,
                              …
                              ,
                              N
                              .
                           
                        
                      Thus the linearized functional minimization problem (2.16) can be approximated by the following finite-dimensional minimization problem: 
                        
                           (3.11)
                           
                              
                                 (
                                 
                                    
                                       
                                          LP
                                       
                                    
                                    
                                       h
                                    
                                 
                                 )
                              
                              
                              
                                 {
                                 
                                    
                                       
                                          
                                             Min
                                          
                                          
                                          
                                             
                                                I
                                             
                                             
                                                h
                                             
                                          
                                          
                                             (
                                             
                                                V
                                             
                                             )
                                          
                                          =
                                          
                                             
                                                h
                                             
                                             
                                                2
                                             
                                          
                                          
                                             [
                                             
                                                
                                                   ∑
                                                
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            y
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      )
                                                   
                                                   ∈
                                                   
                                                      
                                                         R
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   F
                                                
                                                
                                                   i
                                                   ,
                                                   j
                                                
                                                
                                                   h
                                                
                                             
                                             +
                                             
                                                
                                                   1
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   ∑
                                                
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            y
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      )
                                                   
                                                   ∈
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         h
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   F
                                                
                                                
                                                   i
                                                   ,
                                                   j
                                                
                                                
                                                   h
                                                
                                             
                                             +
                                             
                                                
                                                   1
                                                
                                                
                                                   4
                                                
                                             
                                             
                                                
                                                   ∑
                                                
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            y
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      )
                                                   
                                                   ∈
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   F
                                                
                                                
                                                   i
                                                   ,
                                                   j
                                                
                                                
                                                   h
                                                
                                             
                                             ]
                                          
                                          ,
                                       
                                    
                                    
                                       
                                          
                                             V
                                          
                                          ∈
                                          
                                             
                                                R
                                             
                                             
                                                
                                                   
                                                      
                                                         (
                                                         N
                                                         +
                                                         1
                                                         )
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          
                                          satisfying
                                          
                                          
                                             
                                                v
                                             
                                             
                                                0
                                                ,
                                                0
                                             
                                          
                                          =
                                          
                                             
                                                v
                                             
                                             
                                                0
                                                ,
                                                N
                                             
                                          
                                          =
                                          
                                             
                                                v
                                             
                                             
                                                N
                                                ,
                                                N
                                             
                                          
                                          =
                                          0
                                          .
                                       
                                    
                                 
                              
                           
                        
                      Since the functional 
                        
                           
                              I
                           
                           
                              h
                           
                        
                        
                           (
                           
                              V
                           
                           )
                        
                      is a quadratic form of the vector 
                        
                           V
                        
                     , thus the minimization problem (3.11) admits a minimizer which is also a solution of the following linear system: 
                        
                           (3.12)
                           
                              
                                 
                                    ∂
                                    
                                       
                                          I
                                       
                                       
                                          h
                                       
                                    
                                    
                                       (
                                       
                                          V
                                       
                                       )
                                    
                                 
                                 
                                    ∂
                                    
                                       
                                          v
                                       
                                       
                                          i
                                          ,
                                          j
                                       
                                    
                                 
                              
                              =
                              0
                              ,
                              
                              i
                              ,
                              j
                              =
                              0
                              ,
                              1
                              ,
                              …
                              ,
                              N
                              .
                           
                        
                      Inserting the constraints 
                        
                           
                              v
                           
                           
                              0
                              ,
                              0
                           
                        
                        =
                        
                           
                              v
                           
                           
                              0
                              ,
                              N
                           
                        
                        =
                        
                           
                              v
                           
                           
                              N
                              ,
                              N
                           
                        
                        =
                        0
                      into the linear system (3.12), we obtain a linear system with 
                        
                           
                              
                                 (
                                 N
                                 +
                                 1
                                 )
                              
                           
                           
                              2
                           
                        
                        −
                        3
                      unknowns for finding the vector 
                        
                           V
                        
                     , whose coefficient matrix is sparse and symmetric, thus it can be solved very efficiently. We remark here that, if the perturbation surface 
                        v
                      is smooth, then the above discretization is the second-order approximation for the linearized functional. In fact, by denoting 
                        
                           (3.13)
                           
                              
                                 
                                    I
                                 
                                 
                                    h
                                 
                              
                              
                                 (
                                 v
                                 ;
                                 w
                                 )
                              
                              ≔
                              
                                 
                                    h
                                 
                                 
                                    2
                                 
                              
                              
                                 [
                                 
                                    
                                       ∑
                                    
                                    
                                       
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                y
                                             
                                             
                                                j
                                             
                                          
                                          )
                                       
                                       ∈
                                       
                                          
                                             R
                                          
                                          
                                             h
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             F
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                    
                                       h
                                    
                                 
                                 +
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                y
                                             
                                             
                                                j
                                             
                                          
                                          )
                                       
                                       ∈
                                       
                                          
                                             S
                                          
                                          
                                             h
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             F
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                    
                                       h
                                    
                                 
                                 +
                                 
                                    
                                       1
                                    
                                    
                                       4
                                    
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                y
                                             
                                             
                                                j
                                             
                                          
                                          )
                                       
                                       ∈
                                       
                                          
                                             S
                                          
                                          
                                             0
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             F
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                    
                                       h
                                    
                                 
                                 ]
                              
                              ,
                           
                        
                      with 
                        
                           (3.14)
                           
                              
                                 
                                    
                                       
                                          F
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                                 
                                    h
                                 
                              
                              =
                              F
                              
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       j
                                    
                                 
                                 ,
                                 
                                    
                                       δ
                                    
                                    
                                       x
                                    
                                    
                                       2
                                    
                                 
                                 v
                                 
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          y
                                       
                                       
                                          j
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                    
                                       δ
                                    
                                    
                                       x
                                       y
                                    
                                 
                                 v
                                 
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          y
                                       
                                       
                                          j
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                    
                                       δ
                                    
                                    
                                       y
                                    
                                    
                                       2
                                    
                                 
                                 v
                                 
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          y
                                       
                                       
                                          j
                                       
                                    
                                    )
                                 
                                 )
                              
                              ,
                              
                              i
                              ,
                              j
                              =
                              0
                              ,
                              1
                              ,
                              …
                              ,
                              N
                              ,
                           
                        
                      noticing (3.1), (2.14), (3.2) and (3.6)–(3.8), using the triangle inequality, we have 
                        
                           (3.15)
                           
                              
                                 |
                                 I
                                 
                                    (
                                    v
                                    ;
                                    w
                                    )
                                 
                                 −
                                 
                                    
                                       I
                                    
                                    
                                       h
                                    
                                 
                                 
                                    (
                                    v
                                    ;
                                    w
                                    )
                                 
                                 |
                              
                              ≤
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    =
                                    0
                                 
                                 
                                    N
                                    −
                                    1
                                 
                              
                              
                                 
                                    ∑
                                 
                                 
                                    j
                                    =
                                    0
                                 
                                 
                                    N
                                    −
                                    1
                                 
                              
                              
                                 |
                                 
                                    
                                       ∫
                                    
                                    
                                       
                                          
                                             Ω
                                          
                                          
                                             i
                                             j
                                          
                                       
                                    
                                 
                                 F
                                 
                                    (
                                    x
                                    ,
                                    y
                                    ,
                                    
                                       
                                          v
                                       
                                       
                                          x
                                          x
                                       
                                    
                                    ,
                                    
                                       
                                          v
                                       
                                       
                                          x
                                          y
                                       
                                    
                                    ,
                                    
                                       
                                          v
                                       
                                       
                                          y
                                          y
                                       
                                    
                                    )
                                 
                                 d
                                 x
                                 d
                                 y
                                 −
                                 
                                    
                                       
                                          
                                             h
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       4
                                    
                                 
                                 
                                    (
                                    
                                       
                                          F
                                       
                                       
                                          i
                                          ,
                                          j
                                       
                                    
                                    +
                                    
                                       
                                          F
                                       
                                       
                                          i
                                          ,
                                          j
                                          +
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          F
                                       
                                       
                                          i
                                          +
                                          1
                                          ,
                                          j
                                       
                                    
                                    +
                                    
                                       
                                          F
                                       
                                       
                                          i
                                          +
                                          1
                                          ,
                                          j
                                          +
                                          1
                                       
                                    
                                    )
                                 
                                 |
                              
                              +
                              
                                 
                                    h
                                 
                                 
                                    2
                                 
                              
                              
                                 [
                                 
                                    
                                       ∑
                                    
                                    
                                       
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                y
                                             
                                             
                                                j
                                             
                                          
                                          )
                                       
                                       ∈
                                       
                                          
                                             R
                                          
                                          
                                             h
                                          
                                       
                                    
                                 
                                 
                                    |
                                    
                                       
                                          F
                                       
                                       
                                          i
                                          ,
                                          j
                                       
                                    
                                    −
                                    
                                       
                                          
                                             
                                                F
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          i
                                          ,
                                          j
                                       
                                       
                                          h
                                       
                                    
                                    |
                                 
                                 +
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                y
                                             
                                             
                                                j
                                             
                                          
                                          )
                                       
                                       ∈
                                       
                                          
                                             S
                                          
                                          
                                             h
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 
                                    |
                                    
                                       
                                          F
                                       
                                       
                                          i
                                          ,
                                          j
                                       
                                    
                                    −
                                    
                                       
                                          
                                             
                                                F
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          i
                                          ,
                                          j
                                       
                                       
                                          h
                                       
                                    
                                    |
                                 
                                 +
                                 
                                    
                                       1
                                    
                                    
                                       4
                                    
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                y
                                             
                                             
                                                j
                                             
                                          
                                          )
                                       
                                       ∈
                                       
                                          
                                             S
                                          
                                          
                                             0
                                          
                                       
                                    
                                 
                                 
                                    |
                                    
                                       
                                          F
                                       
                                       
                                          i
                                          ,
                                          j
                                       
                                    
                                    −
                                    
                                       
                                          
                                             
                                                F
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          i
                                          ,
                                          j
                                       
                                       
                                          h
                                       
                                    
                                    |
                                 
                                 ]
                              
                              ≤
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    =
                                    0
                                 
                                 
                                    N
                                    −
                                    1
                                 
                              
                              
                                 
                                    ∑
                                 
                                 
                                    j
                                    =
                                    0
                                 
                                 
                                    N
                                    −
                                    1
                                 
                              
                              
                                 
                                    C
                                 
                                 
                                    1
                                 
                              
                              
                                 
                                    h
                                 
                                 
                                    4
                                 
                              
                              +
                              
                                 
                                    h
                                 
                                 
                                    2
                                 
                              
                              
                                 [
                                 
                                    
                                       ∑
                                    
                                    
                                       
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                y
                                             
                                             
                                                j
                                             
                                          
                                          )
                                       
                                       ∈
                                       
                                          
                                             R
                                          
                                          
                                             h
                                          
                                       
                                    
                                 
                                 
                                    
                                       C
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       h
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                y
                                             
                                             
                                                j
                                             
                                          
                                          )
                                       
                                       ∈
                                       
                                          
                                             S
                                          
                                          
                                             h
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 
                                    
                                       C
                                    
                                    
                                       3
                                    
                                 
                                 h
                                 +
                                 
                                    
                                       1
                                    
                                    
                                       4
                                    
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                y
                                             
                                             
                                                j
                                             
                                          
                                          )
                                       
                                       ∈
                                       
                                          
                                             S
                                          
                                          
                                             0
                                          
                                       
                                    
                                 
                                 
                                    
                                       C
                                    
                                    
                                       4
                                    
                                 
                                 h
                                 ]
                              
                              ≤
                              
                                 
                                    C
                                 
                                 
                                    1
                                 
                              
                              
                                 
                                    h
                                 
                                 
                                    4
                                 
                              
                              
                                 
                                    N
                                 
                                 
                                    2
                                 
                              
                              +
                              
                                 
                                    h
                                 
                                 
                                    2
                                 
                              
                              
                                 [
                                 
                                    
                                       C
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       h
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       
                                          (
                                          N
                                          −
                                          1
                                          )
                                       
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 2
                                 
                                    
                                       C
                                    
                                    
                                       3
                                    
                                 
                                 h
                                 
                                    (
                                    N
                                    −
                                    1
                                    )
                                 
                                 +
                                 
                                    
                                       C
                                    
                                    
                                       4
                                    
                                 
                                 h
                                 ]
                              
                              ≤
                              C
                              
                                 
                                    h
                                 
                                 
                                    2
                                 
                              
                              ,
                           
                        
                      where 
                        
                           
                              C
                           
                           
                              1
                           
                        
                        ,
                        
                           
                              C
                           
                           
                              2
                           
                        
                        ,
                        
                           
                              C
                           
                           
                              3
                           
                        
                        ,
                        
                           
                              C
                           
                           
                              4
                           
                        
                      and 
                        C
                      are positive constants depending on the function 
                        v
                      and the coefficients 
                        
                           
                              a
                           
                           
                              i
                           
                        
                      in (2.14), but they are independent of the mesh size 
                        h
                     . We assume here that the integrand function 
                        F
                        
                           (
                           x
                           ,
                           y
                           ,
                           
                              
                                 v
                              
                              
                                 x
                                 x
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 x
                                 y
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 y
                                 y
                              
                           
                           )
                        
                      is 
                        
                           
                              C
                           
                           
                              2
                           
                        
                     -continuous for 
                        
                           (
                           x
                           ,
                           y
                           )
                        
                        ∈
                        Ω
                     .

@&#RESULTS AND DISCUSSION@&#

In this section, we present several simulation results using the variational-difference method proposed above to demonstrate its high performance. Because in practice PALs are often designed on a circular region with the diameter of about 80 mm, we use the computational domain 
                        Ω
                        =
                        
                           
                              
                                 [
                                 −
                                 40
                                 ,
                                 40
                                 ]
                              
                           
                           
                              2
                           
                        
                      containing the circular domain with the length unit mm. The grid numbers 
                        N
                      along the 
                        x
                      and 
                        y
                      directions were chosen to be 80 except where noted. The convergence was checked by continuously reducing the grid sizes. The computational time for each simulation under the grid number 
                        N
                        =
                        80
                      was several seconds on a laptop with a CPU Intel Core i5-3317U 1.7 GHz. For all simulations presented in the paper, we chose the refractive index 
                        n
                        =
                        1.53
                     .

We discuss how to assign the three previously given functions involved in the design functional: the weight functions 
                        α
                        
                           (
                           x
                           ,
                           y
                           )
                        
                        ,
                        β
                        
                           (
                           x
                           ,
                           y
                           )
                        
                     , and the prescribed optical power (i.e. mean curvature) distribution 
                        
                           
                              P
                           
                           
                              0
                           
                        
                        
                           (
                           x
                           ,
                           y
                           )
                        
                     . Following the procedure used by Loos et al.  [7] and Wang et al.  [9], we can divide the computational square domain 
                        Ω
                      into seven subregions. Fig. 3
                      shows an example of the partition of seven subregions in 
                        Ω
                     . As shown in Fig. 3, the large red subregion is used for distance-view, the small blue subregion is used for near-view, and the green subregion connecting the two is used for intermediate-view. The rest of the subregions in 
                        Ω
                      belong to the blending zones, and we divide them into four in order to easily assign them the values of the weight functions and the prescribed mean curvature function.

First, we discuss how to assign the weight functions 
                        α
                        
                           (
                           x
                           ,
                           y
                           )
                        
                      and 
                        β
                        
                           (
                           x
                           ,
                           y
                           )
                        
                     . Based on the importance of the subregion to the PAL design, we assign a constant value to each subregion for the weight functions 
                        α
                        
                           (
                           x
                           ,
                           y
                           )
                        
                      and 
                        β
                        
                           (
                           x
                           ,
                           y
                           )
                        
                     . In a progressive lens design, the values of weight functions 
                        α
                        
                           (
                           x
                           ,
                           y
                           )
                        
                      and 
                        β
                        
                           (
                           x
                           ,
                           y
                           )
                        
                      should be weighted the most in the distance-view, near-view and intermediate-view subregions. Therefore, we put more weight in these subregions and less weight in the other four blending subregions. Meanwhile, because the practically used domain of the progressive lens design is a circular domain centered at the origin of 
                        Ω
                      with a radius of 30 mm (denoted as the domain 
                        D
                     ), if a point belongs to the above seven subregions but is outside the domain 
                        D
                     , we forcefully put the least weight on it. On the other hand, we noticed that the smoothness of the solution depends on that of 
                        α
                        
                           (
                           x
                           ,
                           y
                           )
                        
                        ,
                        β
                        
                           (
                           x
                           ,
                           y
                           )
                        
                      and 
                        
                           
                              P
                           
                           
                              0
                           
                        
                        
                           (
                           x
                           ,
                           y
                           )
                        
                      in the simulations. Therefore, we used the convolution or average methods to smooth these discrete data. Fig. 4
                     
                      shows the surface plots about the weight functions 
                        α
                        
                           (
                           x
                           ,
                           y
                           )
                        
                      and 
                        β
                        
                           (
                           x
                           ,
                           y
                           )
                        
                      used in the simulations of the paper.

The assignment of the optical power (or mean curvature) distribution 
                        
                           
                              P
                           
                           
                              0
                           
                        
                        
                           (
                           x
                           ,
                           y
                           )
                        
                      must rely on every spectacle wearer’s individual prescription. In general, there are two parameters for the power distribution: BASE power and ADD power. The BASE power is often defined as the power of the far-view region, and the ADD power is defined as the difference between the far-view and near-view regions. So the power of the near-view region is BASE+ADD. The BASE power and ADD power both have the unit of diopter. To remedy a patient who suffers from both presbyopia and myopia, the PAL should be a relevant combination of the front and back surfaces. For example, if a patient suffers from myopia with −2.00 diopter and presbyopia with 2.00 diopter, a PAL may be designed with a combination of the back surface with 7.00 diopter and the front surface with 5.00 diopter BASE and 2.00 diopter ADD. The combination criterion is that ADD power must be equal to the presbyopia, and BASE power can be determined by the myopia and the back spherical surface power. We performed numerical simulations of two kinds of prescriptions for designing the free-form front surface of a PAL (shown by Table 1). Taking Case A for example, we assigned the mean curvature with unit of 1/mm of the far-view region (the red region shown in Fig. 3) as 
                        −
                        
                           
                              
                                 BASE
                              
                           
                           
                              1000
                              
                                 (
                                 n
                                 −
                                 1
                                 )
                              
                           
                        
                        =
                        −
                        0.00943
                      (note that a spherical surface was assumed here to have a negative mean curvature); the mean curvature of the near-view region (the blue region shown in Fig. 3) was given as 
                        −
                        
                           
                              
                                 BASE
                              
                              +
                              
                                 ADD
                              
                           
                           
                              1000
                              
                                 (
                                 n
                                 −
                                 1
                                 )
                              
                           
                        
                        =
                        −
                        0.0132
                     ; a smooth function was assigned to connect with the above two parts in the green region shown in Fig. 3, and the mean curvatures of the other four regions were assigned as the average of the mean curvatures of the far-view and near-view regions. Then a smooth method was applied to smooth these discrete data. Fig. 5
                      is the prescribed mean curvature distribution 
                        
                           
                              P
                           
                           
                              0
                           
                        
                        
                           (
                           x
                           ,
                           y
                           )
                        
                      for Case A and Case B used in the simulations of the paper.

To check the accuracy and convergence rate of the proposed variational-difference method, we performed various numerical simulations for the linearized functional minimization problem 
                        
                           (
                           
                              LP
                           
                           )
                        
                      under different grid numbers. Table 2
                      shows the 
                        
                           
                              L
                           
                           
                              2
                           
                        
                      norm of the error and convergence rate for the perturbation function 
                        v
                        
                           (
                           x
                           ,
                           y
                           )
                        
                      under the two cases with the grid numbers 
                        N
                        =
                        80
                     , 160, 320, 640 and 1280. The numerical results were obtained under the spherical background surfaces with the radii of 
                        R
                        =
                        90
                        
                        
                           mm
                        
                      for Case A and 
                        R
                        =
                        137
                        
                        
                           mm
                        
                      for Case B, and the controlled parameters 
                        α
                        
                           (
                           x
                           ,
                           y
                           )
                        
                     , 
                        β
                        
                           (
                           x
                           ,
                           y
                           )
                        
                      and 
                        
                           
                              P
                           
                           
                              0
                           
                        
                        
                           (
                           x
                           ,
                           y
                           )
                        
                      involved in the computations were as presented above. The 
                        
                           
                              L
                           
                           
                              2
                           
                        
                      norm of the error was calculated by the following expression: 
                        
                           (4.1)
                           
                              
                                 
                                    E
                                 
                                 
                                    N
                                 
                              
                              =
                              
                                 
                                    
                                       [
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             =
                                             0
                                          
                                          
                                             N
                                             −
                                             1
                                          
                                       
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                             =
                                             0
                                          
                                          
                                             N
                                             −
                                             1
                                          
                                       
                                       
                                          
                                             
                                                [
                                                
                                                   
                                                      
                                                         V
                                                      
                                                   
                                                   
                                                      i
                                                      ,
                                                      j
                                                   
                                                   
                                                      N
                                                   
                                                
                                                −
                                                
                                                   
                                                      
                                                         V
                                                      
                                                   
                                                   
                                                      2
                                                      i
                                                      ,
                                                      2
                                                      j
                                                   
                                                   
                                                      2
                                                      N
                                                   
                                                
                                                ]
                                             
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             h
                                          
                                          
                                             2
                                          
                                       
                                       ]
                                    
                                 
                                 
                                    1
                                    /
                                    2
                                 
                              
                              ,
                           
                        
                      where 
                        
                           
                              
                                 V
                              
                           
                           
                              N
                           
                        
                      and 
                        
                           
                              
                                 V
                              
                           
                           
                              2
                              N
                           
                        
                      are the numerical solutions of 
                        
                           (
                           
                              
                                 
                                    LP
                                 
                              
                              
                                 h
                              
                           
                           )
                        
                     
                     (3.11) with 
                        N
                        +
                        1
                      and 
                        2
                        N
                        +
                        1
                      grid points in each direction, respectively, and the convergence rate was calculated by 
                        
                           
                              log
                           
                           
                              2
                           
                        
                        
                           (
                           
                              
                                 E
                              
                              
                                 N
                              
                           
                           /
                           
                              
                                 E
                              
                              
                                 2
                                 N
                              
                           
                           )
                        
                     . The numerical results shown by Table 2 indicate that the convergence rate for the perturbation function 
                        v
                        
                           (
                           x
                           ,
                           y
                           )
                        
                      is of second-order accuracy in the sense of the 
                        
                           
                              L
                           
                           
                              2
                           
                        
                      norm. Compared with the 
                        B
                     -spline finite element method  [9], although the accuracy is almost the same, the memory usage and computational cost for our proposed method are smaller, because there is no need to compute the numerical quadrature at each element and it is much easier to assemble the stiffness matrix. The biggest advantage of the proposed variational-difference approach is that it is more straightforward and its computational process is much easier.

For the simulations, there is another important issue—how to choose the optimal radius 
                        R
                      of spherical background surfaces. For each value of 
                        R
                     , we can solve the corresponding quadratic functional minimization problem 
                        
                           (
                           
                              LP
                           
                           )
                        
                      in (2.16) to get the solution 
                        
                           
                              v
                           
                           
                              R
                           
                        
                        
                           (
                           x
                           ,
                           y
                           )
                        
                     . Fig. 6
                      shows the numerical results for the perturbation surface 
                        
                           
                              v
                           
                           
                              R
                           
                        
                        
                           (
                           x
                           ,
                           y
                           )
                        
                      with respect to the four different radii of spherical background surfaces 
                        R
                        =
                        106
                        ,
                        98
                        ,
                        90
                        ,
                        80
                      under Case A. As shown in Fig. 6, when the radius reduces from 106 mm to 80 mm, the shape of computed perturbation surface 
                        
                           
                              v
                           
                           
                              R
                           
                        
                        
                           (
                           x
                           ,
                           y
                           )
                        
                      gradually changes from hump to valley structures (similar behavior of the shape change as 
                        R
                      decreases can be also observed under Case B, not shown here). We note that the shapes of 
                        
                           
                              v
                           
                           
                              R
                           
                        
                        
                           (
                           x
                           ,
                           y
                           )
                        
                     , when 
                        R
                        =
                        106
                        
                        
                           mm
                        
                      and 
                        R
                        =
                        98
                        
                        
                           mm
                        
                      (shown by Fig. 6(a)–(b)), are very similar to the numerical result produced by Wang et al. in  [9] using the 
                        B
                     -spline finite element method under the natural boundary condition, which shows that the two methods produce almost the same numerical results. When we have the solution of 
                        
                           
                              v
                           
                           
                              R
                           
                        
                        
                           (
                           x
                           ,
                           y
                           )
                        
                     , the designed surface of PAL can be given by 
                        
                           
                              u
                           
                           
                              R
                           
                        
                        
                           (
                           x
                           ,
                           y
                           )
                        
                        =
                        
                           
                              v
                           
                           
                              R
                           
                        
                        
                           (
                           x
                           ,
                           y
                           )
                        
                        +
                        
                           
                              
                                 
                                    R
                                 
                                 
                                    2
                                 
                              
                              −
                              
                                 
                                    x
                                 
                                 
                                    2
                                 
                              
                              −
                              
                                 
                                    y
                                 
                                 
                                    2
                                 
                              
                           
                        
                     . By this definition of 
                        
                           
                              u
                           
                           
                              R
                           
                        
                     , we can define a weight function 
                        
                           
                              I
                           
                           
                              
                                 disc
                              
                           
                        
                      to determine the optimal spherical background surface: 
                        
                           (4.2)
                           
                              
                                 
                                    I
                                 
                                 
                                    
                                       disc
                                    
                                 
                              
                              =
                              
                                 
                                    ∫
                                 
                                 
                                    D
                                 
                              
                              
                                 [
                                 α
                                 
                                    (
                                    x
                                    ,
                                    y
                                    )
                                 
                                 
                                    (
                                    
                                       
                                          H
                                       
                                       
                                          R
                                       
                                       
                                          2
                                       
                                    
                                    
                                       (
                                       x
                                       ,
                                       y
                                       )
                                    
                                    −
                                    
                                       
                                          K
                                       
                                       
                                          R
                                       
                                    
                                    
                                       (
                                       x
                                       ,
                                       y
                                       )
                                    
                                    )
                                 
                                 +
                                 β
                                 
                                    (
                                    x
                                    ,
                                    y
                                    )
                                 
                                 
                                    
                                       
                                          (
                                          
                                             
                                                H
                                             
                                             
                                                R
                                             
                                          
                                          
                                             (
                                             x
                                             ,
                                             y
                                             )
                                          
                                          −
                                          
                                             
                                                P
                                             
                                             
                                                0
                                             
                                          
                                          
                                             (
                                             x
                                             ,
                                             y
                                             )
                                          
                                          )
                                       
                                    
                                    
                                       2
                                    
                                 
                                 ]
                              
                              d
                              A
                              ,
                           
                        
                      where the mean curvature 
                        
                           
                              H
                           
                           
                              R
                           
                        
                      and Gauss curvature 
                        
                           
                              K
                           
                           
                              R
                           
                        
                      are calculated by the solution of 
                        
                           
                              u
                           
                           
                              R
                           
                        
                     , and 
                        D
                      is chosen as a circular domain centered at the origin of 
                        Ω
                      with the radius of 30 mm. It should be noted that, since the produced solution by the variational-difference method is the values on the discrete points, in order to calculate the first and second derivatives with regard to computing the quantities such as curvatures, power and astigmatism, we made use of these computed discrete values and fitted them as a smooth surface by tensor product 
                        B
                     -splines of degree 5, and then calculated the derivatives on the interpolated surfaces. Fig. 7
                      shows the weight function 
                        
                           
                              I
                           
                           
                              
                                 disc
                              
                           
                        
                      as a function of the radius 
                        R
                      under Case A and Case B. From the figure, we can clearly observe that there exists a critical value 
                        
                           
                              R
                           
                           
                              c
                           
                        
                      at which the weight function 
                        
                           
                              I
                           
                           
                              
                                 disc
                              
                           
                        
                      attains the minimal value. In the following simulations, we chose the radii of spherical background surfaces as the optimal radius 
                        
                           
                              R
                           
                           
                              c
                           
                        
                      given by Fig. 7. For Case A, the optimal radius 
                        
                           
                              R
                           
                           
                              c
                           
                        
                      is equal to 90 mm; and for Case B, it is 137 mm.

By using the above optimal radius for the spherical background surface, we presented the numerical results for the surface of designed PALs under Case A and Case B shown by Figs. 8–10
                     
                     
                     . Fig. 8 gives surface plots for the finally designed PAL surfaces under the two cases, and the designed surfaces are respectively very close to a spherical surface, which is consistent with the assumption in the paper. Figs. 9 and 10 both show the distribution for the power and astigmatism functions under the two cases, which are calculated by using the computed surfaces of PAL. The middle dashed circle in Fig. 9 gives the circular domain of radius smaller than 30 mm, i.e. 
                        D
                      mentioned above, which is the area practically used for a spectacle lens. As shown by Figs. 9 and 10, we can clearly see that the required ADD power of 2.0 diopter is reached for both the two cases, the power function changes progressively and smoothly, and also there is a clear “corridor” which connects with the far-view and near-view regions. On the other hand, the astigmatism also changes smoothly and the maximum astigmatism gets effectively controlled within less than 1.6 diopter, which is smaller than the prescribed ADD power of 2.0 diopter. These designs are better than typical PAL designs, which generally have the same maximum astigmatism and ADD power. The above numerical results demonstrated the efficiency and high performance as well as the simplicity for implementation of our proposed method.

@&#CONCLUSIONS@&#

In the paper, we have proposed a variational-difference method for designing the optical free form surface of PAL. The PAL, which has a front surface with three important zones including the far-view, near-view and intermediate zones, is often used to remedy presbyopia by distributing optical powers of the three zones progressively and smoothly. Based on the controls between the refractive optical power deviating from the prescribed power distribution and the unwanted astigmatism, a functional minimization mathematical model was presented. By assuming that the front surface of PALs is a perturbed one around a spherical background surface, we linearized and simplified the mathematical model to a quadratical functional minimization problem. A variational-difference numerical method was proposed for solving the quadratical functional minimization problem. Compared with the existing literature which solves the problem by the 
                        B
                     -spline finite element method, the essence of the proposed variational-difference numerical method lies in minimizing the functional directly by the finite difference method rather than in approximating the solution of the corresponding Euler–Lagrange equation to the functional. It is very easily understood and implemented by optical engineers, and its memory and computational cost are smaller than that of the 
                        B
                     -spline finite element method. Our extensive numerical results indicate that it can produce satisfactory designs for optical engineers in several seconds. We believe that our method could be a powerful candidate tool for designing various specifications of PALs.

In the present model, we used the perturbed background surface as a spherical surface and linearized the functional minimization problem 
                        
                           (
                           
                              P
                           
                           )
                        
                      in (2.6) to a quadratic functional minimization problem 
                        
                           (
                           
                              LP
                           
                           )
                        
                      in (2.16). So are there any better background surfaces, under which we might linearize the problem and obtain better design results? Future extensions may include the revolution surface and other surfaces as the background surfaces. On the other hand, we assumed that the back surface of the PAL is spherical in the paper and discussed how to design the free-form front surface. As a matter of fact, the coupling of the appropriately constructed design for both the back and front surfaces may produce more powerful and effective PALs, and this will be the trend for the design of new generation customized PALs. In future work, we will consider the design of both the back and front surfaces simultaneously, and incorporate more complicated design objectives, such as prescribed astigmatism, prism and many others, into the models.

@&#ACKNOWLEDGMENTS@&#

The authors would like to express their sincere thanks to Dr. Xiangdong Liu (Delta Optics Technologies Pte Ltd., Singapore) for introducing the problem to them. This work is partially supported by the Singapore A*STAR SERC PSF-Grant No. 1321202067 (W. Bao and Q. Tang), and the National Natural Science Foundation of China under Grant No. 11261065 (H. Wang).

@&#REFERENCES@&#

