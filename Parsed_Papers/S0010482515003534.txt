@&#MAIN-TITLE@&#A novel fuzzy logic-based image steganography method to ensure medical data security

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Secure multiple medical signals by combining them into one file format.


                        
                        
                           
                           Propose a new steganography method in literature.


                        
                        
                           
                           Secure patients׳ personal data by encryption and compression algorithms.


                        
                        
                           
                           Increase data repository and transmission capacity of multiple medical signals.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Medical image steganography

Medical data security

Fuzzy logic algorithm

Similarity based algorithm

Least significant bit

@&#ABSTRACT@&#


               Graphical abstract
               
                  
                     
                        
                           fx1
                           
                        
                     
                  
               
            

@&#INTRODUCTION@&#

These days, a recent cybercrime is the capture of medical data. If medical data is captured or altered, it may cause a violation of patient׳s rights and changes in medical treatment. Hence, all patient records, especially medical images, must be kept confidential [1,2].

An electronic health record (EHR) is a systematic collection of electronic health information about a patient or population [3]. It may include clinical examinations, patient demographics, diagnosis annotations, prescriptions, medications, past medical history, histological and other findings, vital signs, immunizations, laboratory data, and radiology reports [4]. It is gathered for patient care, clinical research, epidemiological studies, or insurance companies. It is shared by means of information systems and local or wide networks.

The process of medical image information accounts for at least 90% of all the medical information in a hospital system [5]. Medical images (X-ray, CT (computed tomography), MR (magnetic resonance) imaging, ultrasound, etc…) are handled, stored, printed, and transmitted using the Digital Imaging and Communications in Medicine (DICOM) standard. DICOM enables the integration between different devices, software, and platforms into a picture archiving and communication system (PACS). The DICOM format specifies a header that contains the metadata of the image (image size, data type, representation, etc…) and patient information, exam, modality, acquisition parameters, physician, and health center. The DICOM metadata is stored in the DICOM header [6,7]. Hence, patient information in DICOM file must be secured within the network to prevent tampering, illegal copying, and patient privacy leaks, and to ensure copyright protection, and other information security issues [8].

Medical information (MI) security protects the rights of patients and ensures the responsibilities of the health professionals. Health information systems must possess three mandatory characteristics: confidentiality, reliability, and availability [9]. Security tools such as firewalls, virtual private networks (VPNs), and cryptography techniques (symmetric, asymmetric, or hashing encryption) are used to secure medical data. However, firewalls are easily bypassed by hackers. Encryption does not guarantee the confidentiality or secrecy of data; moreover, it increases computational costs. In addition, the file headers of medical data can be captured in the plaintext format [1,9]. Alternatively, steganography techniques can be used to increase the security of medical data.

Steganography is the science that embeds a secret message in an appropriate multimedia cover, for example graphic, audio, and video files. The ultimate objectives of steganography are imperceptibility, robustness, capacity of the hidden message, and resistance to tampering [10]. Many methods concerning steganography methods are proposed to ensure medical data security in literature [1,9,11,12]. These methods, based on the processing domain, can be categorized as: (1) spatial domain and (2) transform domain. Spatial domain techniques (least significant bit (LSB) embedding, spread technique, fixed quantization, histogram methods, etc…) are simple and operate more rapidly, but they are vulnerable to compression, geometric distortion, and filtering. Techniques of transform domain (discrete wavelet transform, discrete cosine transform, discrete Fourier transform) are compatible compression, robust against many geometric distortions (e.g. rotation, scaling, translation, cropping, and filtering). However, they have high computational time and complexity. LSB embedding techniques offer comparatively higher embedding capacity. In either case, properties of the human visual system are exploited to control the quality of the image [1]. Hence, this study proposes two new steganography algorithms to modify the LSB technique.

In the literature, many approaches were proposed to secure the patients׳ medical image information with different modalities (MR, CT, X-ray, etc…), or in biological signals (EEG, ECG, EMG, etc…) [1,9,11–15]. In particular, some studies examined a similar subject as our study [16–22]. These studies used medical images as a cover to hide patients’ information (patient name, age, date of birth, weight, gender, address, etc…). Furthermore, embedded messages are composed of both patients׳ information and biological signals such as EEG, ECG, or EMG. These studies worked on limited images and biological signals, so that the capacity of hidden message was low.

This study aims to: (i) secure multiple medical signals by combining them into one file format; (ii) propose a new steganography method in literature; (iii) secure patients׳ personal data by encryption and compression algorithms; and (iv) increase data repository and transmission capacity of multiple medical signals. In this study, the EEG and MR images of 22 epilepsy patients were tested by the proposed steganography methods.

The remainder of the study is organized as follows. Section 2 describes materials and methods; the proposed methods are also presented in Section 3. The obtained results of proposed methods and discussion are given in Section 4. Finally, Section 5 includes the conclusion and future studies.

This study aims to use EEG signals and MR images that are obtained from same patients and to embed more data with EEG into MR images of same patient. For this reason, the MR images and EEG of 22 epilepsy patients are collected from the Department of Neurology at Gazi University. Eleven females and 11 males were included (age: 18–55 years; mean age: 32±7.9 years). The details of the medical dataset and capacity of the used data are presented in 
                     Table 1. Different sized 3762 MR images of 22 epilepsy patients with 16bits were used as cover images. The embedded message was combined with the patient׳s information, doctor׳s comments, and EEG file header information and segmented EEG data. The patient׳s information (patient name, patient ID, patient birth date, patient gender, patient age, patient weight, patient address, study date, study time, study ID, study modality, study description, series date, series time, and series description) were separately selected from the meta-header of each of the DICOM files. An EEG was also recorded from 21 multiple electrodes that are placed on the scalp using an International 10–20 system. EEG records take about 20–40min for the diagnosis or treatment. EEG file headers have information on record such as time points, number of electrodes, sampling interval, starting time, and name of electrodes. In Table 1, EEG data is stored using short data structure as 4 byte (The Capacity of EEG Data=The Number of Electrodes*Time Points of EEG*4). Furthermore, Visual Studio.NET 2010 platform and MATLAB were used to code the methods and analysis.

Least Significant Bit (LSB) embedding is a simple and fast strategy in steganography. It has high imperceptibility and embedding capability. Hence, this study proposes two new methods to modify LSB embedding using medical data. The analyses consist of two stages: embedding and extracting, respectively.

The embedding stage is shown in 
                     Fig. 1. Initially, the patient׳s information is obtained from DICOM series of epilepsy patient. The EEG data is segmented according to the size of these DICOM images. The information of the EEG file header and size of segmented EEG data are also integrated as embedding EEG data for each DICOM image.

In the message preprocessing stage as shown in Fig. 1, lossless compression methods, which are LZW (Lempel–Ziv–Welch) and Huffman Compression, are used to increase message capacity. Furthermore, LZW and Huffman Compression methods also ensure the complexity of the message. The detail of Huffman and LZW can be found in [23–25], respectively. To increase security, the compression message is encrypted by the Rijndael symmetric encryption algorithm using a 128-bit key. Secondly, the proposed methods, which are similarity-based LSB(SM-LSB) and fuzzy-logic-based LSB (FL-LSB), select non-sequential LSBs of image pixels with using the differences in gray levels of the pixels. Finally, the selected LSBs of the pixels are altered with the message bits in stego images. These processes are simultaneously run with all DICOM series to decrease computational time.

The extracting message stage requires stego-DICOM images and a stego-key, which is the authentication key for decryption, as shown 
                     Fig. 2. Firstly, the proposed methods give the pixels coordinates, which have an embedded message. These pixels are used to gather the message. Secondly, the obtained message is decrypted and decompressed. Finally, the patient׳s information, segmented EEG, and the doctor׳s comments are displayed in a GUI (Graphical User Interface) screen. All hidden EEG data can be also gathered from the DICOM series. The comparison results of the proposed algorithms are evaluated by correlation coefficient (R), PSNR (peak signal-to-noise ratio), MSE (mean square of error), SSIM (structural similarity measure), UQI (universal quality index) between the cover and the stego-DICOM series.

Two methods are proposed for medical image steganography, namely, the similarity-based LSB (SM-LSB) and fuzzy logic-based LSB (FL-LSB).

An image is sampled by pixels. In the gray-scale image, pixels have gray level intensities. In color images, pixels are also represented by three component intensities, being red (R), green (G), and blue (B) [26]. A similarity measure is the similarity degree between two groups or between two objects. In image processing, the similarity measure of two pixels is used with distance information in Euclidean color space [27,28]. Demirci [27] proposed a similarity-based method for edge detection. Furthermore, pixel-value differencing (PVD) or adjacent pixel difference (APD) methods determine embedding pixels in histogram-based steganography [29,30]. These methods have high embedding capacity and PSNR values [29,30]. Karakis et al. [31] used similarity to embed patient׳s information and EEG into medical images. However, the capacity of message was too low, and it does not show the capacities of proposed method. For this reason, this study proposes a new similarity-based LSB (SM-LSB) method using the adjacent pixel value differencing in an image as shown in 
                        Fig. 3.

The main idea of this method is to generate a new image whose pixels have double values at the interval [0 1]. This similar image of cover image is used to determine pixels for the embedding message. In this method, if the values of similar pixels are higher than the determined threshold (Th) by trial and error, they are selected to hide the message. The neighboring pixels of the image (P
                        1, P
                        2, …, P
                        9) using the 3×3 window have three color component (R, G, B) as shown in 
                        Fig. 4 
                        [27,28,31]. These pixels are defined as 
                           
                              
                                 
                                    P
                                 
                                 
                                    
                                       1(
                                    
                                    
                                       
                                          R
                                       
                                       
                                          1
                                       
                                    
                                    
                                       ,
                                    
                                    
                                       
                                          G
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          B
                                       
                                       
                                          1
                                       
                                    
                                    
                                       )
                                    
                                 
                              
                           
                        .

In the first stage, the similarity method calculates the pixel differences using color distance. The gray level differences of each color component between pixels P
                        1 and P
                        2 can be defined with Eq. (1).
                           
                              (1)
                              
                                 
                                    
                                       Δ
                                    
                                    R
                                    =
                                    
                                       |
                                       
                                          
                                             
                                                P
                                             
                                             
                                                1
                                                (
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                             
                                          
                                          −
                                          
                                             
                                                P
                                             
                                             
                                                2
                                                (
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      2
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       |
                                    
                                    
                                       Δ
                                    
                                    G
                                    =
                                    
                                       |
                                       
                                          
                                             
                                                P
                                             
                                             
                                                1
                                                (
                                                
                                                   
                                                      G
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                             
                                          
                                          −
                                          
                                             
                                                P
                                             
                                             
                                                2
                                                (
                                                
                                                   
                                                      G
                                                   
                                                   
                                                      2
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       |
                                    
                                    
                                       Δ
                                    
                                    B
                                    =
                                    
                                       |
                                       
                                          
                                             
                                                P
                                             
                                             
                                                1
                                                (
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                             
                                          
                                          −
                                          
                                             
                                                P
                                             
                                             
                                                2
                                                (
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      2
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       |
                                    
                                 
                              
                           
                        Where R is red, G is green, and B is blue in pixel in Eq. (1). The color distance between any two pixels in the color space is calculated with respect to the gray level differences by the Euclidean norm, following Eq. (2).
                           
                              (2)
                              
                                 
                                    
                                       
                                          d
                                       
                                       
                                          i
                                          ,
                                          j
                                       
                                    
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          
                                             
                                                3
                                             
                                          
                                       
                                    
                                    
                                       (
                                       
                                          
                                             Δ
                                          
                                          
                                             
                                                R
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             Δ
                                          
                                          
                                             
                                                G
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             Δ
                                          
                                          
                                             
                                                B
                                             
                                             
                                                2
                                             
                                          
                                       
                                       )
                                    
                                 
                              
                           
                        
                     

In the second stage, the similarity of two pixels is measured using Eqs. (2) and (3). Similarity can be expressed in terms of an exponential or Gaussian function of distance [27,28]. In this study, color similarity is calculated with Eq. (3).
                           
                              (3)
                              
                                 
                                    
                                       
                                          C
                                       
                                       
                                          k
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                x
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                x
                                             
                                             
                                                j
                                             
                                          
                                       
                                       )
                                    
                                    =
                                    exp
                                    
                                       (
                                       
                                          
                                             
                                                −
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      i
                                                      j
                                                   
                                                   
                                                      q
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      n
                                                   
                                                
                                             
                                          
                                       
                                       )
                                    
                                 
                              
                           
                        Where D
                        
                           n
                         is the normalization coefficient, and it is examined by trial and error in Eq. (3). The value of D
                        
                           n
                         is determined as 128.

In third step, local similarity values are calculated using a 3×3 window, as shown in 
                        Fig. 5. The local smoothness of kth pixel can be estimated with Eq. (4). It is also provided to decrease noise. Fig. 5 also shows the calculation similarity values for the P1 pixel with dashed lines.
                           
                              (4)
                              
                                 
                                    
                                       
                                          S
                                       
                                       
                                          k
                                       
                                    
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          8
                                       
                                    
                                    
                                       
                                          ∑
                                       
                                       
                                          n
                                          =
                                          1
                                       
                                       
                                          9
                                       
                                    
                                    
                                       
                                          
                                             C
                                          
                                          
                                             k
                                             ,
                                             n
                                          
                                       
                                    
                                    
                                    
                                       
                                          f
                                       
                                       
                                          o
                                       
                                       
                                          r
                                       
                                    
                                    
                                    k
                                    ≠
                                    n
                                 
                              
                           
                        
                     

In fourth stage, the similarity values of all image pixels are used to generate a similar image whose pixels have double values at the interval [0, 1]. The coordinates of the pixels in the similar image are held in a new matrix to hide the message, if the similarity values of the cover image are higher than the threshold (Th=0.5). These coordinates give pixels location in the byte array of image. Finally, the message is embedded in a stego-image via these obtained coordinates.
                     

In the extraction stage of the message in SM-LSB, the stego image and the same threshold (Th) was used. The gray level differences of color components are calculated the neighboring pixels of the stego image by Eq. (1). The color distance of pixels are calculated by the Euclidean norm in Eq. (2). The similarity values of pixels are found by using Eqs. (3) and (4). Similarly, the coordinates of the pixels are determined between the similarity values of pixels and threshold values. The hidden message is extracted using the coordinates of the stego image׳s pixels.

In image processing, the Euclidean color space is generally used to measure the distances of the pixels. However, some studies show that perceptual color proximity cannot be measured using Euclidean distance. In the literature, rule based approaches were proposed to overcome this problem. These approaches were also used for color image segmentation and filtering [27,28,32–34]. Karakis et al. [35] proposed a rule-based steganography method in BMP images. For this reason, this study proposes a new fuzzy logic-based LSB (FL-LSB) algorithm to determine pixels to embed the message into medical images and to increase the capacity of the embedding message as shown in 
                        Fig. 6.

In first stage, gray level differences of the neighbor pixels using a 3×3 window are used as inputs of FL-LSB algorithm. These differences of each color component between P
                        
                           1
                         and P
                        
                           2
                         are calculated using Eq. (1). Gray level differences (
                           
                              
                                 Δ
                              
                              R
                           
                        , 
                           
                              
                                 Δ
                              
                              G
                           
                        , and 
                           
                              
                                 Δ
                              
                              B
                           
                        ) of pixels are defined with three linguistic values as Zero: ZE, Medium: MD, and Large: LR [35].

In the second stage, the FL-LSB algorithm calculates membership values of the gray level difference of each color component for the neighbor pixels. Five triangular fuzzy sets are used to fuzzify the gray level difference as shown in 
                        Fig. 7. Their linguistic values are defined as: Not Similar: NS, Slightly Similar: SS, Moderately Similar: MS, Quite Similar: QS, and Exactly Similar: ES. Fig. 7 also shows the membership values (µ) with respect to similarities (S). Red, blue, and green components of gray levels in neighbor pixels are separately designed in Fig. 7. Cetin et al. [28] proposed a fuzzy-based filter and gray level differences were fuzzified by seven fuzzy sets and their linguistic values. However, this study uses five fuzzy sets to decrease computational time. Similarly, three fuzzy sets are not used due to obtaining different similar values [35].

In the third stage, the fuzzified gray level differences of each color component are combined according to the fuzzy rules as shown in 
                        Table 2. The fuzzy rules are defined as follows:
                           
                              
                                 
                                    Rule1: If 
                                 
                                    
                                       
                                          Δ
                                       
                                       R
                                    
                                  is Zero and 
                                 
                                    
                                       
                                          Δ
                                       
                                       G
                                    
                                  is Zero and 
                                 
                                    
                                       
                                          Δ
                                       
                                       B
                                    
                                  is Zero, Then P 
                                 1 and P
                                 2 are Exactly Similar,


                                 
                                    Rule2: If 
                                 
                                    
                                       
                                          Δ
                                       
                                       R
                                    
                                  is Large and 
                                 
                                    
                                       
                                          Δ
                                       
                                       G
                                    
                                  is Large and 
                                 
                                    
                                       
                                          Δ
                                       
                                       B
                                    
                                  is Large, Then P 
                                 1 and P
                                 2 are Not Similar,


                                 
                                    Rule3: If 
                                 
                                    
                                       
                                          Δ
                                       
                                       R
                                    
                                  is Large and 
                                 
                                    
                                       
                                          Δ
                                       
                                       G
                                    
                                  is Zero and 
                                 
                                    
                                       
                                          Δ
                                       
                                       B
                                    
                                  is Medium, Then P 
                                 1 and P
                                 2 are Moderately Similar, and so on.

In the fourth stage, the similar percentage of neighbor pixels values is obtained by using the center-average defuzzification and product, presented in Eq. (5) 
                        [28].
                           
                              (5)
                              
                                 
                                    S
                                    =
                                    
                                       
                                          
                                             ∑
                                             
                                                j
                                                =
                                                1
                                             
                                             Z
                                          
                                          
                                             
                                                
                                                   S
                                                
                                                
                                                   j
                                                
                                             
                                             
                                                
                                                   μ
                                                
                                                
                                                   p
                                                   r
                                                   e
                                                   m
                                                
                                                
                                                   j
                                                
                                             
                                             (
                                             L
                                             )
                                          
                                       
                                       
                                          
                                             ∑
                                             
                                                j
                                                =
                                                1
                                             
                                             Z
                                          
                                          
                                             
                                                
                                                   μ
                                                
                                                
                                                   p
                                                   r
                                                   e
                                                   m
                                                
                                                
                                                   j
                                                
                                             
                                             (
                                             L
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        Where S
                        
                           j
                         denotes the center of similarity percent in the jth rule, and Z also denotes the number of the rules. 
                           
                              
                                 
                                    μ
                                 
                                 
                                    p
                                    r
                                    e
                                    m
                                 
                                 
                                    j
                                 
                              
                              (
                              L
                              )
                           
                         is calculated in Eq. (6) 
                        [28].
                           
                              (6)
                              
                                 
                                    
                                       
                                          μ
                                       
                                       
                                          p
                                          r
                                          e
                                          m
                                       
                                       
                                          j
                                       
                                    
                                    (
                                    L
                                    )
                                    =
                                    
                                       
                                          μ
                                       
                                       
                                          R
                                       
                                       
                                          j
                                       
                                    
                                    (
                                    
                                       Δ
                                    
                                    R
                                    )
                                    
                                       
                                          μ
                                       
                                       
                                          G
                                       
                                       
                                          j
                                       
                                    
                                    (
                                    
                                       Δ
                                    
                                    G
                                    )
                                    
                                       
                                          μ
                                       
                                       
                                          B
                                       
                                       
                                          j
                                       
                                    
                                    (
                                    
                                       Δ
                                    
                                    B
                                    )
                                 
                              
                           
                        
                     

In the fifth stage, the similarity values of image are obtained using a 3×3 window using Eq. (4). The similarity values generate a new image whose pixels have double values at the interval [0, 1]. Finally, the mean similarity values of the 3×3 window are selected as the LSB pixels to embed the message. The FL-LSB method is modified as LSB method using similarity values of pixels according to the differences of gray levels. Hence, non-sequential LSBs of pixels are directly replaced to embed the message.

In the extraction stage of the message in FL-LSB, the stego image was used. Firstly, the gray level differences of the neighbor pixels using a 3×3 window are calculated by Eq. (1). Secondly, the gray level differences were fuzzified by five fuzzy sets and their linguistic values. The fuzzified gray level differences of each color component are combined according to the fuzzy rules. Finally, the similar percentage of neighbor pixels values is defuzzified by Eq. (5). The mean similarity values of the 3×3 window are selected as the LSB pixels to extract the message. The message is at last separated as patient׳s information, doctors׳ comment and EEG data.

In this study, the performance of the proposed methods was evaluated between the cover and stego DICOM series by five different comparison methods. These include: MSE (mean square of error), PSNR (peak signal-to-noise ratio), SSIM (structural similarity measure), UQI (universal quality index), and correlation coefficient (R), which are given as following in Eqs. (7)–(11), respectively.
                           
                              (7)
                              
                                 
                                    
                                       M
                                       S
                                       E
                                    
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          M
                                          N
                                       
                                    
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          0
                                       
                                       
                                          M
                                          −
                                          1
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                             =
                                             0
                                          
                                          
                                             N
                                             −
                                             1
                                          
                                       
                                       
                                          
                                             
                                                (
                                                f
                                                (
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ,
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      j
                                                   
                                                
                                                )
                                                −
                                                g
                                                (
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ,
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      j
                                                   
                                                
                                                )
                                                )
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                              
                           
                        Where M and N are the dimensions of the images; f(x, y) and g(x, y) are the cover and the stego images [35]. The peak signal-to-noise ratio (PSNR) calculates the noise effect of the embedding message between cover and stego images [35].
                           
                              (8)
                              
                                 
                                    
                                       P
                                       S
                                       N
                                       R
                                    
                                    =
                                    10
                                    
                                    log
                                    
                                       (
                                       
                                          
                                             
                                                255
                                                X
                                                255
                                             
                                             
                                                M
                                                S
                                                E
                                             
                                          
                                       
                                       )
                                    
                                 
                              
                           
                        
                     

MSE and PSNR are inconsistent with the human visual system (HVS). UQI evaluates the loss of correlation, luminance distortion, and contrast distortion. SSIM considers image degradation as perceived change in structural information. Hence, the performances of UQI and SSIM are better than the MSE and PSNR.
                           
                              (9)
                              
                                 
                                    
                                       S
                                       S
                                       I
                                       M
                                    
                                    (
                                    x
                                    ,
                                    y
                                    )
                                    =
                                    
                                       
                                          (
                                          2
                                          
                                             
                                                μ
                                             
                                             
                                                x
                                             
                                          
                                          
                                             
                                                μ
                                             
                                             
                                                y
                                             
                                          
                                          +
                                          
                                             
                                                c
                                             
                                             
                                                1
                                             
                                          
                                          )
                                          (
                                          2
                                          
                                             
                                                σ
                                             
                                             
                                                x
                                                y
                                             
                                          
                                          +
                                          
                                             
                                                c
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                       
                                          (
                                          
                                             
                                                μ
                                             
                                             
                                                x
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                μ
                                             
                                             
                                                y
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                c
                                             
                                             
                                                1
                                             
                                          
                                          )
                                          (
                                          
                                             
                                                σ
                                             
                                             
                                                x
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                σ
                                             
                                             
                                                y
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                c
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (10)
                              
                                 
                                    
                                       U
                                       Q
                                       I
                                    
                                    (
                                    x
                                    ,
                                    y
                                    )
                                    =
                                    
                                       
                                          (
                                          4
                                          
                                             
                                                μ
                                             
                                             
                                                x
                                             
                                          
                                          
                                             
                                                μ
                                             
                                             
                                                y
                                             
                                          
                                          2
                                          
                                             
                                                σ
                                             
                                             
                                                x
                                                y
                                             
                                          
                                          )
                                       
                                       
                                          (
                                          
                                             
                                                μ
                                             
                                             
                                                x
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                μ
                                             
                                             
                                                y
                                             
                                             
                                                2
                                             
                                          
                                          )
                                          (
                                          
                                             
                                                σ
                                             
                                             
                                                x
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                σ
                                             
                                             
                                                y
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              
                                 μ
                              
                              
                                 x
                              
                           
                         is the average of X, 
                           
                              
                                 μ
                              
                              
                                 y
                              
                           
                         is the average of Y, 
                           
                              
                                 σ
                              
                              
                                 x
                              
                              
                                 2
                              
                           
                         is the variance of X, 
                           
                              
                                 σ
                              
                              
                                 y
                              
                              
                                 2
                              
                           
                         is the variance of Y, 
                           
                              
                                 σ
                              
                              
                                 x
                                 y
                              
                           
                         is the covariance of X and Y. In Eq. (9), c
                        1 (
                           
                              
                                 
                                    c
                                 
                                 
                                    1
                                 
                              
                              =
                              
                                 
                                    (
                                    
                                       
                                          k
                                       
                                       
                                          1
                                       
                                    
                                    L
                                    )
                                 
                                 2
                              
                           
                        ) and c
                        2 (
                           
                              
                                 
                                    c
                                 
                                 
                                    2
                                 
                              
                              =
                              
                                 
                                    (
                                    
                                       
                                          k
                                       
                                       
                                          2
                                       
                                    
                                    L
                                    )
                                 
                                 2
                              
                           
                        ) are two variables to stabilize the division with a weak denominator. L is also the dynamic range of the pixel-values. k
                        1 and k
                        2 have default values as 0.01 and 0.03, respectively [36].

The correlation coefficient (R) compares two images for image registration in image processing. It is described in Eq. (11) 
                        [37].
                           
                              (11)
                              
                                 
                                    R
                                    =
                                    
                                       
                                          
                                             ∑
                                             M
                                          
                                          
                                             
                                                ∑
                                                N
                                             
                                             
                                                (
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      M
                                                      N
                                                   
                                                
                                                −
                                                
                                                   f
                                                   ¯
                                                
                                             
                                          
                                          )
                                          −
                                          (
                                          
                                             
                                                g
                                             
                                             
                                                M
                                                N
                                             
                                          
                                          −
                                          
                                             g
                                             
                                                ¯
                                             
                                          
                                          )
                                       
                                       
                                          
                                             
                                                
                                                   (
                                                   
                                                      
                                                         ∑
                                                         M
                                                      
                                                      
                                                         
                                                            ∑
                                                            N
                                                         
                                                         
                                                            
                                                               
                                                                  (
                                                                  
                                                                     
                                                                        
                                                                           f
                                                                        
                                                                        
                                                                           M
                                                                           N
                                                                        
                                                                     
                                                                     −
                                                                     
                                                                        f
                                                                        ¯
                                                                     
                                                                  
                                                                  )
                                                               
                                                               2
                                                            
                                                         
                                                      
                                                   
                                                   )
                                                
                                                
                                                   (
                                                   
                                                      
                                                         ∑
                                                         M
                                                      
                                                      
                                                         
                                                            ∑
                                                            N
                                                         
                                                         
                                                            
                                                               
                                                                  (
                                                                  
                                                                     
                                                                        
                                                                           g
                                                                        
                                                                        
                                                                           M
                                                                           N
                                                                        
                                                                     
                                                                     −
                                                                     
                                                                        g
                                                                        ¯
                                                                     
                                                                  
                                                                  )
                                                               
                                                               2
                                                            
                                                         
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              f
                              
                                 ¯
                              
                           
                         is mean of pixels in cover image, and 
                           
                              g
                              
                                 ¯
                              
                           
                         is also mean of pixels in stego images in Eq. (11).

@&#RESULTS AND DISCUSSION@&#

This section presents the analysis results of proposed algorithms using an epilepsy dataset, which was obtained from the Department of Neurology at Gazi University.


                        
                        Fig. 8 shows the cover and stego images of proposed algorithms. Whatever DICOM Viewer does not show any patient information in stego images after embedding the message as shown in Fig. 8. Patient information can be extracted from stego images by authorized person. The histograms of the cover and stego images are also shown in Fig. 8. There are little differences in the histograms of the cover and stego images. The histograms of the background׳s pixels on the interval [0 50] especially changed. In this study, EEG data was sequentially segmented according to the size of the image for each DICOM image, as shown in 
                        Fig. 9. EEG data was also gathered from the DICOM series while extracting the message.

The performances of proposed algorithms were evaluated by PSNR, MSE, SSIM, UQI, and R values, whose details were explained in Section 3. 
                        Table 3 shows the obtained comparison results of the SM-LSB algorithm between the cover and stego DICOM images of 22 epilepsy patients. The mean PSNR values ranged between 53.9520dB and 62.5025dB±2.3441. The mean of the MSE values were between 0.0428 and 0.3535±0.0786. The mean root of MSE (RMSE) values were between 0.2069 and 0.5946±0.1035. The means of the obtained SSIM and UQI values were between 0.9994 and 0.9999. The mean correlation coefficient (R) values were between 0.717321 and 0.999156±0.0795. The percentage of obtained altered pixels ratio (PR) was the number of replaced pixels/number of cover image pixels. The mean PR values were found between 4.2810% and 27.4140%.


                        
                        Table 4 shows the embedding performance of the FL-LSB algorithm between the cover and stego images. The mean of PSNR values were between 53.8708 and 62.9892±2.4389. The mean of MSE values were between 0.0428 and 0.3598±0.0812. The mean of RMSE values were between 0.2069 and 0.5998±0.1060. The mean of SSIM and UQI values were between 0.9994 and 0.9999. The mean of R values were between 0.814089 and 0.999277±0.0586. The mean of PR values were between 4.2809% and 28.0235%. The performances values of the proposed algorithms have similar values according to the obtained results, as shown in Tables 3 and 4.

The embedding capacity of the proposed algorithms is given in 
                        Table 5. The SM-LSB method without compression embedded data between 12.75% and 51.22%. The percentage of embedding capacity in the FL-LSB method without compression was between 12.68% and 50.99%. As shown in Table 5, even though the SM-LSB method embedded a bit more data than FL-LSB method, the embedding capacities of the proposed methods were quite similar to the performance results. Moreover, the capacity of SM-LSB method is related to the selection of threshold value. The threshold value has to be optimized for each DICOM series.

This study also investigated the data embedding capacity of the lossless compression algorithm using the epilepsy dataset in the proposed algorithms. Hence, the LZW and Huffman lossless compression methods are used to increase the embedding capacity. 
                        
                        Figs. 10 and 11 show the percentage of embedding data according to total data by means of the proposed methods. Huffman compression was better than the LZW method for both of the proposed algorithms, as shown in Figs. 10 and 11. The percentage of embedding capacity in the SM-LSB algorithm using LZW compression was between 13.41% and 57.96%. In Huffman compression, it was between 14.97% and 60.08%. The percentage of embedding capacity in FL-LSB using LZW compression was between 5.38% and 56.67%. In Huffman compression, it was between 14.88% and 59.81%. Lossless compression methods in FL-LSB also increased the capacity of the embedding message, as shown in Figs. 10 and 11.

The embedding capacity of the different sizes of images is given in 
                        Table 6. The mean of embedding capacity in the SM-LSB method was between 6962 bytes and 64838 bytes in DICOM images sized 176×176 and 512×512. The FL-LSB method embedded 6794 bytes and 64586 bytes in DICOM images sized 176×176 and 512×512.

The embedding capacities and performances of both SM-LSB and FL-LSB algorithms were obtained as similarly. However, SM-LSB method determines the embedding pixel with a threshold value, which is obtained by trial and error. For this reason, this study proposes FL-LSB algorithm to secure multiple medical data.

In other similar studies, Miaou et al. [16] embedded ECG record, the diagnosis report and the doctor׳s seals in medical images using LSB technique. PSNR values were obtained on the interval 33–43dB. However, the embedding capacities of methods were not given. The details of similar studies in literature can be shown in 
                        Table 7.

Giakoumaki et al. [18] proposed a wavelet based method using 512×512×20 medical images. The average PSNR values were found as 46.66±0.2 for nearly 668 bytes (5348 bits). Similarly, Nambakhsh et al. [17,19] introduced a new multi-resolution wavelet decomposition method to embed ECG and demographic text data in 256×256×25 PET images. PSNR values were achieved as 48.15±0.22 for 2-kilo bytes. This method is robust against the attacks. However, capacities of these methods were too low. They have also high computational time and complexity. This study ensures to sequentially hide message in DICOM series of patients.

Anand and Niranjan [20] proposed a LSB technique of data hiding in spatial domain. Firstly, text file is encrypted and interleaved in the LSB of the gray level values. Graphical data such as ECG or EEG signals are also hidden in the image. However, capacities of these methods were too low and they used only three cover images.

Acharya et al. [21] introduced a LSB method of embedding patient׳s information and ECG or EEG data. Data was encrypted by using Rijndael algorithm. During transmission or storage the data, channel coding technique has been used to decrease the effect of noise. Acharya et al. [22] proposed a LSB technique using DCT in frequency domain. The coefficients are run length encoded. Variable length Huffman encoding is used to save memory space. Text file is also encrypted and the bits in the equivalent binary number are interleaved in the LSB of high frequency DCT coefficients. However, the capacity evaluation of these methods was not given, and there are visible differences in the histograms of the cover and stego images.

The capacity of proposed FL-LSB algorithm is higher than the results of similar studies as shown in Table 7. The mean of PSNR values are obtained between 53.87 and 62.99±2.44. Embedding and extracting message were generated simultaneously for each DICOM series of patient. It also positively affects the computational time. Message was secured by compression and encryption algorithm. Furthermore, embedding message in each DICOM image can be separately observed in a GUI screen. EEG data can be investigated in each DICOM image, or it can be gathered from DICOM series of patient.

@&#CONCLUSION@&#

In medical information system, medical data is easily captured when being storing, receiving or transmission through computer network and Internet. Cryptology and steganography are generally used to ensure medical data security. For this reason, this study proposes two new algorithm that are similarity-based LSB (SM-LSB), and fuzzy logic-based LSB (FL-LSB) to secure medical data. EEG signals and MR images of 22 epilepsy patients are used to combine multiple medical signals into one file format. The embedding message is composed of EEG signals, doctor׳s comment, and patient information in file header of DICOM images. The message is secured by using Huffman and LZW lossless compression methods and Rijndael symmetric algorithm with 128bit-key to prevent the attacks.

The main idea of proposed methods is to create a similar image whose pixels have double values on the interval [0 1]. It is obtained by means of measuring the similarity of neighbor pixels. SM-LSB algorithm selects the LSB pixels to embed the message by a threshold value which is determined by trial and error. FL-LSB algorithm hides the message with selecting non-sequential LSB pixels of generated-similar image. The performance of stego image quality is measured by MSE, PSNR, SSIM, UQI, and R. In FL-LSB algorithm, mean PSNR values are obtained between 53.8708dB and 62.9892dB. The capacity of proposed algorithm is higher than the result of similar studies in literature. According to the obtained result, the proposed method ensures the confidentiality of the patient׳s information. The FL-LSB method hides EEG signals, patient׳s information and doctor׳s comment in the pixels of MR images. It also increases data repository and transmission capacity of the patients׳ multiple medical data.

In the future, noise cancellation and data reduction would possible to increase embedding capacity.

The authors confirm that this article content has no conflicts of interest.

@&#ACKNOWLEDGEMENTS@&#

This study has been supported by Gazi University Scientific and Research Project Fund (Project no: 07/2012-45).

@&#REFERENCES@&#

