@&#MAIN-TITLE@&#Probabilistic atlas prior for CT image reconstruction

@&#HIGHLIGHTS@&#


               
                  
                  
                     
                        
                           
                           A powerful statistical image reconstruction algorithm for CT is proposed.


                        
                        
                           
                           Data obtained from earlier scans are used to construct a probabilistic atlas with Laplacian mixture model.


                        
                        
                           
                           Prior information obtained from a probabilistic atlas is modeled for the CT image reconstruction.


                        
                        
                           
                           We consider low-dose CT imaging setups using proposed method and alternative approaches.


                        
                        
                           
                           The proposed method outperforms other alternative methods in terms of image quality.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Computed tomography

Statistical image reconstruction

Probabilistic atlas

Laplacian mixture model

@&#ABSTRACT@&#


               
               
                  Background and objectives
                  In computed tomography (CT), statistical iterative reconstruction (SIR) approaches can produce images of higher quality compared to the conventional analytical methods such as filtered backprojection (FBP) algorithm. Effective noise modeling and possibilities to incorporate priors in the image reconstruction problem are the main advantages that lead to continuous development of SIR methods. Oriented by low-dose CT requirements, several methods are recently developed to obtain a high-quality image reconstruction from down-sampled or noisy projection data. In this paper, a new prior information obtained from probabilistic atlas is proposed for low-dose CT image reconstruction.
               
               
                  Methods
                  The proposed approach consists of two main phases. In learning phase, a dataset of images obtained from different patients is used to construct a 3D atlas with Laplacian mixture model. The expectation maximization (EM) algorithm is used to estimate the mixture parameters. In reconstruction phase, prior information obtained from the probabilistic atlas is used to construct the cost function for image reconstruction.
               
               
                  Results
                  We investigate the low-dose imaging by considering the reduction of X-ray beam intensity and by acquiring the projection data through a small number of views or limited view angles. Experimental studies using simulated data and chest screening CT data demonstrate that the probabilistic atlas prior is a practically promising approach for the low-dose CT imaging.
               
               
                  Conclusions
                  The prior information obtained from probabilistic atlas constructed from earlier scans of different patients is useful in low-dose CT imaging.
               
            

@&#INTRODUCTION@&#

X-ray computed tomography (CT) has evolved into an essential imaging modality in clinical routines. It is hard to find a hospital that has no in-duty CT imaging equipments worldwide. Clinical diagnostic applications of CT are known as high-dose imaging techniques compared to the conventional plain-film radiography. The extensive use of CT scanning leads to a notable increase of the average patient dose and, consequently, increases possibilities to produce malignancy. The side effects of the radiation dose generated from CT scans become a concerning topic for further investigations. Although it is not yet strictly proven that regular CT scans may lead to malignancy, it is estimated that a rough of 2% of cancers may eventually be caused by the average radiation dose currently used in clinical CT [1]. Moreover, cancer lesion in radiosensitive organs such as lungs is correlated to relatively low dose of 100mGy [2]. It is estimated that about 75% of the collective dose from radiology is resulted from high-dose procedures such as CT in which organ doses are large enough to confirm a significant evidence on cancer risk increase [3]. The optimization of hardware factors such as scanning geometry, tube current and pitch factor would probably lead to a dose reduction. However, it is always preferable to obtain standard imaging techniques that minimize the patient dose with acceptable image quality. The conventional image reconstruction methods based on analytical inversion formulae are still the fundamental choice in clinical equipment [4]. On the other hand, statistical iterative reconstruction (SIR) methods are known to provide a higher image quality thanks to noise modeling and possibilities to incorporate prior information, which has a potential to be useful for some low-dose imaging protocols [5–8].

In this work, we investigate the problem of image reconstruction from low-dose imaging protocols. By low-dose imaging, we consider reducing X-ray beam intensity, which is known to increase statistical noise in the reconstructed image (Fig. 1
                     (b)). Moreover, we consider the problem of image reconstruction from a small number of projection views (Fig. 1(c)) and limited angle problem (Fig. 1(d)). Reducing the data sampling rate corresponds a reduction of patient dose, though it may meet some technical challenges when being implemented in clinical routines. In tomographic imaging, it is important to find the appropriate prior model to fit with the imaging application and data limitation. In this context, several prior models are presented to solve problems generated from limited tomographic data. Prior models can be classified into two categories based on the source of knowledge. First category is image-domain-based prior, where prior information is acquired from the reconstructed image domain such as Gibbs smoothing prior [9], total variation (TV) prior [10], Non-local means (NLM) [11] and Gaussian mixture priors [12]. Second category is auxiliary-domain-based, where prior information is calculated from auxiliary source such as reference image [13], dictionary-based [7] and intensity prior [14]. Anatomical information has been used in several tomographic imaging modalities such as emission tomography [15–21], transmission electron microscopy [22].

Using of prior information obtained from earlier CT scans to improve the quality of low-dose CT imaging is become an interesting research topic. Several approaches are developed to address this problem. For example, Ma et al. proposed a post-processing method based on nonlocal means filtering, named ndiNLM algorithm [23]. The ndiNLM algorithm is proved to be powerful approach for noise reduction. However, it does not consider the statistical properties of photons. Chen et al. proposed the PICCS algorithm, which incorporate prior information obtained from reference image into the image reconstruction problem within the framework of compressed sensing [13]. Another interesting approach is the PWLS-PINL algorithm [24], which consider a nonlocal regularization using prior image obtained earlier with normal-dose scan. Major limitation of prior image-based reconstruction is the requirement of an earlier scan of the same patient, which is not always available in several CT applications. A hybrid reconstruction method is proposed by Sadowwsky et al. for cone-beam C-arm CT to solve the problem of data truncation with the limited field-of-view of C-arm scanners [25].

The present study proposes a new framework for image generation in medical applications, which exploit a probabilistic atlas constructed by processing archived dataset to generate images with superior quality features in future scans. This framework might have a large potential to contribute to future trends in medical imaging such as modulating the patient dose, reducing data measurements, and improving image quality. Conceptually, the overlap between techniques of medical image creation (i.e. image reconstruction and imaging physics) and techniques of image processing (i.e. computational anatomy and computer-aided-diagnosis) is weak. The main stream between these two tracks is limited to forward medical images generated by imaging equipments into processing for diagnosis and analysis. In the context of image segmentation, the use of probabilistic atlas is a common approach to achieve accurate image segmentation in different imaging modalities. The atlas is essentially generated from a population of co-registered images corresponding to distinct patients and is then used to provide a complete spatial distribution of probability that a pixel belongs to each organ. This may provide a useful information that is used to decide an organ to which each pixel should be classified [26].

In this paper, we propose a new SIR method using prior information obtained from probabilistic atlas computed using auxiliary dataset. We used a set of reconstructed volumes obtained from previous scans of several patients to construct a probabilistic atlas using the Laplacian mixture model (LMM). The mixture parameters are estimated using the expectation maximization (EM) algorithm [27]. The atlas and the mixture model parameters are then used to construct the image reconstruction cost function from limited projection data. The developed method can be considered an extension of our earlier work of the intensity-based MAP (iMAP) algorithm [14]. The main contribution of this paper is to demonstrate that the spatial information provided by the atlas leads to a more accurate reconstruction when the projection data is limited.

This paper is organized as follows. In Section 2, the iMAP algorithm is briefly reviewed. The proposed method is detailed in Section 3. The experimental results are presented and discussed in Section 4. The limitations of the proposed method and future extensions are discussed in Section 5, while the paper is concluded in Section 6.

Although analytical image reconstruction methods are still the main approach for clinical equipments, it is known that the data limitations lead to significant artifacts in the reconstructed image [28]. An alternative approach is the SIR, where photon statistics and accurate physical imaging models can be incorporated into the image reconstruction. This would lead to suppression of statistical noise and other data limitation artifacts in an effective way. Indeed, this would increase the computation time, but this problem can be mitigated with the use of high-speed computation hardware such as GPUs. The data acquisition in the transmission X-ray CT can be described in a discrete form using the following statistical model.
                        
                           (1)
                           
                              
                                 y
                                 i
                              
                              ≈
                              Poisson
                              (
                              
                                 b
                                 i
                              
                              exp
                              (
                              −
                              〈
                              
                                 
                                    
                                       
                                          a
                                          i
                                       
                                    
                                 
                              
                              ,
                              
                                 
                                    x
                                 
                              
                              〉
                              )
                              )
                              ,
                              
                              i
                              =
                              1
                              ,
                              …
                              ,
                              m
                              ,
                           
                        
                     where x
                     =(x
                     1, …, x
                     
                        n
                     ) is the image vector representing the attenuation coefficients of object, y
                     =(y
                     1, …, y
                     
                        m
                     ) is a vector representing the raw detector measurements with the blank scan b
                     =(b
                     1, …, b
                     
                        m
                     ), A
                     ={a
                     
                        ij
                     } is the m
                     ×
                     n system matrix that models the imaging system, and 
                        〈
                        
                           
                              
                                 
                                    a
                                    i
                                 
                              
                           
                        
                        ,
                        
                           
                              x
                           
                        
                        〉
                        =
                        
                           ∑
                           
                              j
                              =
                              1
                           
                           n
                        
                        
                           a
                           ij
                        
                        
                           x
                           j
                        
                      is the inner product of ith row of matrix A and image vector x. In SIR, the maximum likelihood (ML) approach is used in many cases. In the case of transmission CT, the solution is found through solving the following optimization problem.
                        
                           (2)
                           
                              
                                 
                                    
                                       x
                                    
                                 
                                 *
                              
                              =
                              arg
                              
                                 min
                                 
                                    
                                       
                                          x
                                          ≥
                                          0
                                       
                                    
                                 
                              
                              l
                              (
                              
                                 
                                    x
                                 
                              
                              )
                           
                        
                     
                     
                        
                           (3)
                           
                              l
                              (
                              
                                 
                                    x
                                 
                              
                              )
                              =
                              −
                              
                                 ∑
                                 
                                    i
                                    =
                                    1
                                 
                                 m
                              
                              
                                 
                                    
                                       
                                          y
                                          i
                                       
                                       log
                                       (
                                       
                                          b
                                          i
                                       
                                       )
                                       −
                                       
                                          y
                                          i
                                       
                                       
                                          ∑
                                          
                                             j
                                             =
                                             1
                                          
                                          n
                                       
                                       
                                          a
                                          ij
                                       
                                       
                                          x
                                          j
                                       
                                       −
                                       log
                                       (
                                       
                                          y
                                          i
                                       
                                       !
                                       )
                                       −
                                       
                                          b
                                          i
                                       
                                       exp
                                       
                                          
                                             
                                                −
                                                
                                                   ∑
                                                   
                                                      j
                                                      =
                                                      1
                                                   
                                                   n
                                                
                                                
                                                   a
                                                   ij
                                                
                                                
                                                   x
                                                   j
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              ,
                           
                        
                     where l(x) is the (negative) log-likelihood function. However, the ML method is known to amplify the statistical noise in tomographic reconstruction, which is a high-dimensional inverse problem. The typical approach to solve this issue is the introduction of a regularization term into the penalty function. Bayesian approaches such as Maximum a posteriori (MAP) are the common framework in this regard. The solution is found by maximizing the MAP function defined as:
                        
                           (4)
                           
                              P
                              (
                              
                                 
                                    x
                                 
                              
                              |
                              
                                 
                                    y
                                 
                              
                              )
                              =
                              
                                 
                                    P
                                    (
                                    
                                       
                                          y
                                       
                                    
                                    |
                                    
                                       
                                          x
                                       
                                    
                                    )
                                    P
                                    (
                                    
                                       
                                          x
                                       
                                    
                                    )
                                 
                                 
                                    P
                                    (
                                    
                                       
                                          y
                                       
                                    
                                    )
                                 
                              
                              ,
                           
                        
                     and the solution of the image reconstruction problem is found by
                        
                           (5)
                           
                              
                                 
                                    
                                       x
                                    
                                 
                                 *
                              
                              =
                              arg
                              
                                 min
                                 
                                    
                                       
                                          x
                                       
                                    
                                    ≥
                                    0
                                 
                              
                              L
                              (
                              
                                 
                                    x
                                 
                              
                              )
                              +
                              β
                              U
                              (
                              
                                 
                                    x
                                 
                              
                              )
                              ,
                           
                        
                     where U(x) is the penalty term that represent the prior knowledge of the object in question. The compromise between the data fidelity enforced by the likelihood function and the regularization term is controlled by a hyper-parameter β. The penalty term (also known as the regularization term) can take several forms. The common approach used as a regularizer is the Gibbs smoothing prior [29–31]. Moreover, it is possible to integrate other prior information of the image such as intensity information. In the following section, we briefly introduce a recently developed algorithm by the authors with the name of intensity-based MAP (iMAP) algorithm. The iMAP algorithm is the basis used to derive the image reconstruction method proposed in this paper.

Recently, we have developed an iterative image reconstruction algorithm from a small number of projection views named as iMAP algorithm [14]. In this method, a regularization term based on prior information concerning a small number of intensity values contained in the object in question is introduced. The regularization term, named as intensity prior, is computed using average intensity values of uniform regions in the scanned object, and it leads to a considerable improvement in image quality. The framework of iMAP algorithm is based on the fact that, in many CT imaging applications, most of anatomical structures, and corresponding attenuation information can be easily known or estimated in prior to image reconstruction. Moreover, the intensity value within the same region (organ) is almost uniform or is slightly varying.

In the iMAP algorithm, the solution of image reconstruction problem is found by solving the following optimization problem.


                        
                           
                              (6)
                              
                                 
                                    min
                                    
                                       
                                          
                                             x
                                          
                                       
                                       ≥
                                       0
                                    
                                 
                                 f
                                 (
                                 
                                    
                                       x
                                    
                                 
                                 )
                                 =
                                 L
                                 (
                                 
                                    
                                       x
                                    
                                 
                                 )
                                 +
                                 β
                                 D
                                 (
                                 
                                    
                                       x
                                    
                                 
                                 )
                              
                           
                        
                        
                           
                              (7)
                              
                                 L
                                 (
                                 
                                    
                                       x
                                    
                                 
                                 )
                                 =
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    m
                                 
                                 
                                    
                                       
                                          
                                             b
                                             i
                                          
                                          exp
                                          (
                                          −
                                          〈
                                          
                                             
                                                
                                                   
                                                      a
                                                      i
                                                   
                                                
                                             
                                          
                                          ,
                                          
                                             
                                                x
                                             
                                          
                                          〉
                                          )
                                          +
                                          
                                             y
                                             i
                                          
                                          〈
                                          
                                             
                                                
                                                   
                                                      a
                                                      i
                                                   
                                                
                                             
                                          
                                          ,
                                          
                                             
                                                x
                                             
                                          
                                          〉
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (8)
                              
                                 D
                                 (
                                 
                                    
                                       x
                                    
                                 
                                 )
                                 =
                                 
                                    ∑
                                    
                                       j
                                       =
                                       1
                                    
                                    n
                                 
                                 
                                    min
                                    
                                       l
                                       =
                                       1
                                    
                                    L
                                 
                                 
                                    ω
                                    l
                                 
                                 
                                    ξ
                                    l
                                 
                                 (
                                 
                                    x
                                    j
                                 
                                 )
                                 ,
                                 
                                 
                                    ξ
                                    l
                                 
                                 (
                                 t
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   |
                                                   t
                                                   −
                                                   
                                                      z
                                                      l
                                                   
                                                   |
                                                
                                                
                                                   
                                                      z
                                                      
                                                         l
                                                         −
                                                         1
                                                      
                                                   
                                                   ≤
                                                   t
                                                   ≤
                                                   
                                                      z
                                                      
                                                         l
                                                         +
                                                         1
                                                      
                                                   
                                                   ,
                                                
                                             
                                             
                                                
                                                   ∞
                                                
                                                
                                                   (
                                                   otherwise
                                                   )
                                                   ,
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where L(x) is the negative log-likelihood after ignoring the irrelevant terms, D(x) is a distance function corresponding to the intensity prior, z
                        =(z
                        1, …, z
                        
                           L
                        ) is a set of a priori known intensity values arranged in ascending order (i.e. z
                        1
                        <
                        z
                        2
                        <…<
                        z
                        
                           L−1
                        <
                        z
                        
                           L
                        ) with z
                        0
                        =−∞ and z
                        
                           L+1
                        =∞, and ω
                        1, …, ω
                        
                           L
                         are empirically determined weighting parameters corresponding to the intensity values. The intensity vector z is assumed to be known in prior to reconstruction as it represents attenuation coefficients of uniform regions in the scanned object. The weighting parameter ω
                        
                           l
                         is determined from the frequency of intensity z
                        
                           l
                         appearing in the image, which can be estimated from the intensity histogram. Fig. 2
                         illustrates the penalty function defined in Eq. (8).

When the image reconstruction problem is ill-posed due to the limitations of projection data, the regularization term in Eq. (8) is used to find a solution which minimizes the ℓ1 norm distance between each image pixel x
                        
                           j
                         and a closest component of the known intensity vector z.

The main challenge in minimizing the cost function in Eq. (6) is that the regularization term D(x) defined by taking the minimum of several ℓ1 norm functions is neither convex nor differentiable. Therefore, it is difficult to employ an ordinary gradient-type iterative method to minimize the cost function. Instead, the majorization-minimization strategy [32,33] is used to replace the minimization problem into a sequence of minimizing a separable surrogate function 
                           
                              
                                 f
                                 ˜
                              
                           
                           (
                           
                              
                                 x
                              
                           
                           ,
                           
                              
                                 
                                    x
                                 
                              
                              k
                           
                           )
                        . At each iteration k, the non-separable part to the cost function is approximated by a separable function around x
                        =
                        x
                        
                           k
                         given by
                           
                              (9)
                              
                                 
                                    
                                       
                                          
                                             
                                                f
                                                ˜
                                             
                                          
                                          (
                                          
                                             
                                                x
                                             
                                          
                                          ;
                                          
                                             
                                                
                                                   x
                                                
                                             
                                             k
                                          
                                          )
                                          =
                                          
                                             ∑
                                             
                                                j
                                                =
                                                1
                                             
                                             n
                                          
                                          β
                                          
                                             
                                                
                                                   
                                                      c
                                                      j
                                                   
                                                   
                                                      
                                                         (
                                                         
                                                            x
                                                            j
                                                         
                                                         −
                                                         
                                                            p
                                                            j
                                                         
                                                         )
                                                      
                                                      2
                                                   
                                                   +
                                                   
                                                      ω
                                                      
                                                         h
                                                         (
                                                         
                                                            x
                                                            j
                                                         
                                                         )
                                                      
                                                   
                                                   |
                                                   
                                                      x
                                                      j
                                                   
                                                   −
                                                   
                                                      z
                                                      
                                                         h
                                                         (
                                                         
                                                            x
                                                            j
                                                         
                                                         )
                                                      
                                                   
                                                   |
                                                
                                             
                                          
                                          +
                                          T
                                          (
                                          
                                             
                                                
                                                   x
                                                
                                             
                                             k
                                          
                                          )
                                          ,
                                       
                                    
                                    
                                       
                                          h
                                          (
                                          
                                             x
                                             j
                                          
                                          )
                                          =
                                          {
                                          h
                                          ∈
                                          {
                                          1
                                          ,
                                          …
                                          ,
                                          L
                                          }
                                          :
                                          
                                             ω
                                             h
                                          
                                          |
                                          
                                             x
                                             j
                                          
                                          −
                                          
                                             z
                                             h
                                          
                                          |
                                          =
                                          
                                             min
                                             
                                                l
                                                =
                                                1
                                             
                                             L
                                          
                                          
                                             ω
                                             l
                                          
                                          |
                                          
                                             x
                                             j
                                          
                                          −
                                          
                                             z
                                             l
                                          
                                          |
                                          t
                                          }
                                          ,
                                       
                                    
                                 
                              
                           
                        where T(x
                        
                           k
                        ) is the term independent of x and (p
                        
                           j
                        , c
                        
                           j
                        ) are computed as follows.
                           
                              (10)
                              
                                 
                                    p
                                    j
                                 
                                 =
                                 
                                    x
                                    j
                                    k
                                 
                                 +
                                 
                                    x
                                    j
                                    k
                                 
                                 
                                    
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          m
                                       
                                       
                                          a
                                          ij
                                       
                                       (
                                       
                                          b
                                          i
                                       
                                       exp
                                       (
                                       −
                                       〈
                                       
                                          
                                             
                                                
                                                   a
                                                   i
                                                
                                             
                                          
                                       
                                       ,
                                       
                                          
                                             
                                                x
                                             
                                          
                                          k
                                       
                                       〉
                                       )
                                       −
                                       
                                          y
                                          i
                                       
                                       )
                                    
                                    
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          m
                                       
                                       
                                          a
                                          ij
                                       
                                       〈
                                       
                                          
                                             
                                                
                                                   a
                                                   i
                                                
                                             
                                          
                                       
                                       ,
                                       
                                          
                                             
                                                x
                                             
                                          
                                          k
                                       
                                       〉
                                       
                                          b
                                          i
                                       
                                       exp
                                       (
                                       −
                                       〈
                                       
                                          
                                             
                                                
                                                   a
                                                   i
                                                
                                             
                                          
                                       
                                       ,
                                       
                                          
                                             
                                                x
                                             
                                          
                                          k
                                       
                                       〉
                                       )
                                    
                                 
                              
                           
                        
                        
                           
                              (11)
                              
                                 
                                    c
                                    j
                                 
                                 =
                                 
                                    1
                                    
                                       2
                                       β
                                       
                                          x
                                          j
                                          k
                                       
                                    
                                 
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    m
                                 
                                 
                                    a
                                    ij
                                 
                                 〈
                                 
                                    
                                       
                                          
                                             a
                                             i
                                          
                                       
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          x
                                       
                                    
                                    k
                                 
                                 〉
                                 
                                    b
                                    i
                                 
                                 exp
                                 (
                                 −
                                 〈
                                 
                                    
                                       
                                          
                                             a
                                             i
                                          
                                       
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          x
                                       
                                    
                                    k
                                 
                                 〉
                                 )
                                 .
                              
                           
                        
                     

The computational procedure of the iMAP algorithm is summarized as follows.
                           
                              (i)
                              
                                 Initialization: Give the intensity prior z, set the initial image x
                                 0 as a uniform positive image, and initialize the iteration number as k
                                 =0.


                                 Majorization: The cost function f(x) is approximately majorized around the current estimate x
                                 
                                    k
                                  by the separable surrogate function 
                                    
                                       
                                          f
                                          ˜
                                       
                                    
                                    (
                                    
                                       
                                          x
                                       
                                    
                                    ;
                                    
                                       
                                          
                                             x
                                          
                                       
                                       k
                                    
                                    )
                                  in Eq. (9).


                                 Minimization: The separable surrogate function 
                                    
                                       
                                          f
                                          ˜
                                       
                                    
                                    (
                                    
                                       
                                          x
                                       
                                    
                                    ;
                                    
                                       
                                          
                                             x
                                          
                                       
                                       k
                                    
                                    )
                                  is minimized over x
                                 ≥0 to obtain the image estimate for next iterate x
                                 
                                    k+1.


                                 Stopping condition: Set the iteration number as k
                                 =
                                 k
                                 +1 and repeat steps (ii)–(iii) until a stopping criterion is satisfied.

During the implementation of the iMAP algorithm, we have found that the major challenge is how to estimate the parameters (z
                        
                           l
                        , ω
                        
                           l
                        ) contained in the intensity prior. One possible improvement direction is to develop a robust approach to automatically or semi-automatically estimate the intensity weighting parameter ω
                        
                           l
                         such that it matches to the intensity histogram of the image in question. Moreover, the structure of the iMAP algorithm is based on the pixel intensity values without consideration of any spatial information (i.e. spatially dependent nature). In other words, the iMAP algorithm uses prior information of expected intensity values for all image pixels equally. However, it would be useful to utilize additional information provided by the pixel position in the image. In the present work, based on these observations, we extend the iMAP algorithm by incorporating additional pixel-dependent probability obtained from a probabilistic atlas to further improve the reconstruction performance.

@&#PROPOSED METHOD@&#

In low-dose CT, image reconstructed from projection data acquired through a reduction of X-ray beam intensity is known to be of low quality due to the effect of statistical noise. It is common to use MAP-based reconstruction methods using various prior models to reduce the effect of noise or other artifacts. In this work, we develop a novel framework to construct a new class of MAP reconstruction methods based on techniques of computational anatomy fields. A general diagram explain the overview of the proposed framework is shown in Fig. 3
                     . The proposed framework consists of two essential phases. First, we construct a probabilistic atlas from dataset of CT images acquired from other patients through image processing techniques. In the second phase, the probabilistic atlas is used as prior knowledge for image reconstruction. Hereafter, this image reconstruction method is called Probabilistic-Atlas MAP (PA-MAP).

We start with a population of images (CT dataset) acquired from different patients under the same imaging configuration. Through an image processing step, including image registration and segmentation, this dataset can be probabilistically represented as a multivariate mixture of L intensity components. Each component, with median value μ
                        
                           l
                        , is representing an anatomical region within the scanned object. A schematic of the learning phase is presented in Fig. 4
                        . A In this paper, the probabilistic atlas is used to provide a complete spatial distribution of probabilities that each image pixel belongs to which region having uniform (or almost uniform) intensity. By constructing the probabilistic atlas, the probabilities π
                        
                           lj
                         (l
                        =1, …, L) are assigned to each pixel x
                        
                           j
                         together with the corresponding intensity value μ
                        =(μ
                        1, …, μ
                        
                           L
                        ), where π
                        
                           lj
                         represents the probability, that the pixel x
                        
                           j
                         belongs to the region l having the median intensity μ
                        
                           l
                        . To construct the atlas, a mixture model is used to define the distribution of image pixels. We use the Laplacian mixture model (LMM) to segment the dataset into L number of regions. The parameters of the LMM are estimated using the EM algorithm. Finally, the parameters of the probabilistic atlas, which we call the probabilistic atlas prior, are incorporated into the image reconstruction within the framework of the iMAP algorithm.

The probabilistic atlas is computed from dataset images obtained with the same imaging configurations. After images of the dataset are co-registered using an arbitrary patient image as a reference, the atlas is computed in the form of LMM. For the atlas construction, the registered images are clustered using the EM algorithm into L components and the atlas is computed by averaging the probability distribution of the LMM. A useful review of image registration techniques in medical applications can be found in Ref. [34]. Several image registration techniques might be successfully used in the proposed framework. Intuitively, we used a non-rigid image registration technique. Non-rigid image registration aims to transform an image (a member of the dataset) such that it becomes as similar as possible to a fixed image (reference image). In this study, we use a deformable image registration method based on the B-splines [35]. The registration process is optimized using gradient decent method with means squares as similarity measure and 20mm point spacing. An example of registration process is shown later in Section 4.

The Laplacian mixture model (LMM) is one of statistical models for multivariate analysis that is widely used within the context of robust clustering such as image segmentation [36]. The density function at an observation x is expressed as
                              
                                 (12)
                                 
                                    p
                                    (
                                    
                                       
                                          x
                                       
                                    
                                    )
                                    =
                                    
                                       ∏
                                       
                                          j
                                          =
                                          1
                                       
                                       n
                                    
                                    
                                       ∑
                                       
                                          l
                                          =
                                          1
                                       
                                       L
                                    
                                    
                                       π
                                       lj
                                    
                                    p
                                    (
                                    
                                       x
                                       j
                                    
                                    |
                                    
                                       Ω
                                       l
                                    
                                    )
                                    ,
                                 
                              
                           where Ω
                           
                              l
                            (l
                           =1, …, L) is the set of class labels and π
                           
                              lj
                            is the prior probability for each pixel x
                           
                              j
                            to belong to the class Ω
                           
                              l
                           . Obviously, π
                           
                              lj
                            satisfies the following constraints.


                           
                              
                                 (13)
                                 
                                    0
                                    ≤
                                    
                                       π
                                       lj
                                    
                                    ≤
                                    1
                                    
                                    (
                                    l
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    L
                                    ;
                                    j
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    n
                                    )
                                 
                              
                           and
                              
                                 (14)
                                 
                                    
                                       ∑
                                       
                                          l
                                          =
                                          1
                                       
                                       L
                                    
                                    
                                       π
                                       lj
                                    
                                    =
                                    1
                                    
                                    (
                                    j
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    n
                                    )
                                    .
                                 
                              
                           It is important to note that the mixture probability π
                           
                              lj
                            in the ordinary clustering problems is expressed with a single subscript in the form of π
                           
                              l
                           . However, in the current situation, to construct the atlas, the input data used to compute the LMM parameters is a set of multiple images of different patients (not a single image). Therefore, it is allowed to compute the pixel-dependent prior probability π
                           
                              lj
                            in a stable way. In Eq. (12), the probability density function (pdf) corresponding to each Laplacian component p(x
                           
                              j
                           |Ω
                           
                              l
                           ), called component of the mixture, is expressed as
                              
                                 (15)
                                 
                                    p
                                    (
                                    
                                       x
                                       j
                                    
                                    |
                                    
                                       Ω
                                       l
                                    
                                    )
                                    =
                                    
                                       1
                                       
                                          2
                                          
                                             λ
                                             l
                                          
                                       
                                    
                                    exp
                                    
                                       
                                          
                                             −
                                             
                                                
                                                   |
                                                   
                                                      x
                                                      j
                                                   
                                                   −
                                                   
                                                      μ
                                                      l
                                                   
                                                   |
                                                
                                                
                                                   
                                                      λ
                                                      l
                                                   
                                                
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           where μ
                           
                              l
                            and λ
                           
                              l
                            are the median value and the width parameter of density function corresponding to the label Ω
                           
                              l
                           , respectively. The set of LMM parameters (μ
                           
                              l
                           , λ
                           
                              l
                           , π
                           
                              lj
                           ) (l
                           =1, …, L
                           ;
                           j
                           =1, …, n) obtained by using the EM clustering algorithm specifies the probabilistic atlas [37]. An example of the mixture density function is shown in Fig. 5
                           . By taking the (negative) logarithm of Eq. (12), the prior term D
                           
                              LMM
                           (x) corresponding to the LMM model used for image reconstruction as prior knowledge is derived as
                              
                                 (16)
                                 
                                    
                                       D
                                       LMM
                                    
                                    (
                                    
                                       
                                          x
                                       
                                    
                                    )
                                    =
                                    −
                                    
                                       ∑
                                       
                                          j
                                          =
                                          1
                                       
                                       n
                                    
                                    log
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   l
                                                   =
                                                   1
                                                
                                                L
                                             
                                             
                                                π
                                                lj
                                             
                                             p
                                             (
                                             
                                                x
                                                j
                                             
                                             |
                                             
                                                Ω
                                                l
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (17)
                                 
                                    ≅
                                    
                                       ∑
                                       
                                          j
                                          =
                                          1
                                       
                                       n
                                    
                                    
                                       min
                                       
                                          l
                                          =
                                          1
                                       
                                       L
                                    
                                    
                                       
                                          
                                             −
                                             log
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               π
                                                               lj
                                                            
                                                         
                                                         
                                                            
                                                               λ
                                                               l
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             +
                                             
                                                
                                                   |
                                                   
                                                      x
                                                      j
                                                   
                                                   −
                                                   
                                                      μ
                                                      l
                                                   
                                                   |
                                                
                                                
                                                   
                                                      λ
                                                      l
                                                   
                                                
                                             
                                          
                                       
                                    
                                    +
                                    log
                                    2
                                 
                              
                           
                           
                              
                                 (18)
                                 
                                    =
                                    
                                       ∑
                                       
                                          j
                                          =
                                          1
                                       
                                       n
                                    
                                    
                                       min
                                       
                                          l
                                          =
                                          1
                                       
                                       L
                                    
                                    
                                       g
                                       l
                                    
                                    (
                                    
                                       x
                                       j
                                    
                                    )
                                    ,
                                 
                              
                           
                           
                              
                                 (19)
                                 
                                    
                                       g
                                       l
                                    
                                    (
                                    
                                       x
                                       j
                                    
                                    )
                                    =
                                    −
                                    log
                                    
                                       
                                          
                                             π
                                             lj
                                          
                                       
                                       
                                          
                                             λ
                                             l
                                          
                                       
                                    
                                    +
                                    
                                       
                                          |
                                          
                                             x
                                             j
                                          
                                          −
                                          
                                             μ
                                             l
                                          
                                          |
                                       
                                       
                                          
                                             λ
                                             l
                                          
                                       
                                    
                                 
                              
                           
                        

The regularization term in Eq. (16) is constructed as follows. First, we prepare CT images of many patients, or different scans of the same patient as in follow-up applications, spatially registered to one another. Then, by using the EM clustering algorithm, we fit the LMM (Eq. (12)) to the learning dataset. We call this process the learning phase, in which the mixture parameters (μ
                           
                              l
                           , λ
                           
                              l
                           , π
                           
                              lj
                           ) (l
                           =1, …, L
                           ;
                           j
                           =1, …, n) appearing in Eq. (17) are estimated. To derive Eq. (17) from Eq. (16), we have used the standard approximation in the mixture analysis to take only a single dominant component among all L components. For example, this approximation has been successfully used in image segmentation applications with the name of k-mean or k-median clustering.

The PA constructed in learning phase is computed by registering all the dataset to arbitrary selected image. Thus, the resulted atlas accuracy is highly dependent on the arbitrary selected reference image. To fit the PA with the image to be reconstructed, we use the following procedure. First, the FBP image is reconstructed and then clustered into L components using EM algorithm. Then the PA is registered to the clustered FBP image. The normalized PA that is aligned to the FBP image is then used for PA-MAP reconstruction. Fig. 6
                            details the atlas fitting procedure and experimental results is shown in Section 4.

To construct the image reconstruction method using the prior information generated from the probabilistic atlas, the median value of each mixture components μ
                           
                              l
                            can be considered as the known intensity values z
                           
                              l
                            in the iMAP algorithm. The inverse of width parameter 1/λ
                           
                              l
                            can be considered the weighting parameter 
                              
                                 w
                                 l
                              
                           . Furthermore, we also need to include the additional additive term −log(π
                           
                              lj
                           /λ
                           
                              l
                           ) into the cost function, which reflects the spatially-dependent nature of prior knowledge. These correspondences are clear from the comparison of Eqs. (8) and (16). Finally, the cost function for the PA-MAP algorithm is defined by
                              
                                 (20)
                                 
                                    f
                                    (
                                    
                                       
                                          x
                                       
                                    
                                    )
                                    =
                                    L
                                    (
                                    
                                       
                                          x
                                       
                                    
                                    )
                                    +
                                    β
                                    
                                       D
                                       LMM
                                    
                                    (
                                    
                                       
                                          x
                                       
                                    
                                    )
                                    .
                                 
                              
                           
                        

The minimization of cost function f(x) for image reconstruction is performed by using the iterative algorithm based on the majorization-minimization strategy similar to that of the iMAP algorithm previously described in Section 2. The cost function in Eq. (20) is approximately majorized around the current iterate x
                           
                              k
                            by using the following equation.
                              
                                 (21)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   f
                                                   ˜
                                                
                                             
                                             (
                                             
                                                
                                                   x
                                                
                                             
                                             ;
                                             
                                                
                                                   
                                                      x
                                                   
                                                
                                                k
                                             
                                             )
                                             =
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                n
                                             
                                             β
                                             
                                                
                                                   
                                                      
                                                         c
                                                         j
                                                      
                                                      
                                                         
                                                            (
                                                            
                                                               x
                                                               j
                                                            
                                                            −
                                                            
                                                               p
                                                               j
                                                            
                                                            )
                                                         
                                                         2
                                                      
                                                      +
                                                      
                                                         1
                                                         
                                                            
                                                               λ
                                                               
                                                                  h
                                                                  (
                                                                  
                                                                     x
                                                                     j
                                                                  
                                                                  )
                                                               
                                                            
                                                         
                                                      
                                                      |
                                                      
                                                         x
                                                         j
                                                      
                                                      −
                                                      
                                                         μ
                                                         
                                                            h
                                                            (
                                                            
                                                               x
                                                               j
                                                            
                                                            )
                                                         
                                                      
                                                      |
                                                   
                                                
                                             
                                             +
                                             T
                                             (
                                             
                                                
                                                   
                                                      x
                                                   
                                                
                                                k
                                             
                                             )
                                          
                                       
                                       
                                          
                                             h
                                             (
                                             
                                                x
                                                j
                                             
                                             )
                                             =
                                             {
                                             h
                                             ∈
                                             {
                                             1
                                             ,
                                             …
                                             ,
                                             L
                                             }
                                             :
                                             
                                                g
                                                h
                                             
                                             (
                                             
                                                x
                                                j
                                             
                                             )
                                             =
                                             
                                                min
                                                
                                                   l
                                                   =
                                                   1
                                                
                                                L
                                             
                                             
                                                g
                                                l
                                             
                                             (
                                             
                                                x
                                                j
                                             
                                             )
                                             }
                                          
                                       
                                    
                                 
                              
                           where p
                           
                              j
                            and c
                           
                              j
                            are defined in Eqs. (10) and (11), respectively and T(x
                           
                              k
                           ) is the term independent of x. The formulation of the cost function in Eq. (20) requires a considerable effort to minimize. This is due to the mixing of the discrete optimization corresponding to the label l and the continuous ℓ1 norm optimization with respect to x
                           
                              j
                           . A novel exact minimization algorithm is detailed in Appendix A. We note that both the intensity prior in Eq. (8) and the PA prior in Eq. (16) are different from a class of smoothing priors like total-variation (TV) and Gibbs priors so that they can be combined with a smoothing prior to further improve of the performances. We call the resulting reconstruction method PA-MAP, which provides a useful framework to improve the iMAP reconstruction method.

The advantages of the PA-MAP method compared to the iMAP method are summarized as follows. First, more accurate values of the prior intensity can be provided through the data modeling as LMM in the learning phase. Second, the weighting parameter 
                              
                                 w
                                 l
                              
                            can now be automatically computed as the corresponding width of the mixture component 1/λ
                           
                              l
                           . Finally, the prior knowledge is pixel-dependent, which contributes to improving image quality. Moreover, it is possible to use additional smoothing penalty terms to the cost function f(x) in Eq. (20), such as the well-known quadratic smoothing penalty. In the experimental studies presented in the paper, we have included a very weak smoothing penalty to improve the quality of reconstruction. In brief, the computational procedure of PA-MAP method is summarized as follows.


                           (I) Learning phase:
                           
                              
                                 (i)
                                 Input images dataset and specify the number of expected mixture components L.

Select an arbitrary reference image x
                                    
                                       ref
                                     from the image dataset.

Register the remaining images to x
                                    
                                       ref
                                    .

Compute the mixture parameters (μ
                                    
                                       l
                                    , λ
                                    
                                       l
                                    , π
                                    
                                       lj
                                    ) (l
                                    =1, …, L
                                    ;
                                    j
                                    =1, …, n) using the EM algorithm.


                           (II) Reconstruction phase:
                           
                              
                                 (i)
                                 Fit the PA with x
                                    
                                       FBP
                                     image as described in Fig. 6.

Set the initial image x
                                    0 to a uniform positive image.
                                       
                                          
                                             
                                                x
                                                j
                                                0
                                             
                                             =
                                             
                                                1
                                                dn
                                             
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                m
                                             
                                             −
                                             log
                                             (
                                             
                                                y
                                                i
                                             
                                             /
                                             
                                                b
                                                i
                                             
                                             )
                                             ,
                                             
                                             j
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             n
                                             ,
                                          
                                       
                                    where d is the number of projection view angles. Set the iteration number as k
                                    =0.

The cost function in Eq. (20) is approximately majorized around the current iterate x
                                    
                                       k
                                     by the separable surrogate function in Eq. (21).

The separable surrogate function is minimized over x
                                    ≥0.
                                       
                                          
                                             
                                                
                                                   
                                                      x
                                                   
                                                
                                                
                                                   k
                                                   +
                                                   1
                                                
                                             
                                             =
                                             arg
                                             
                                                min
                                                
                                                   
                                                      
                                                         x
                                                      
                                                   
                                                   ≥
                                                   0
                                                
                                             
                                             
                                                
                                                   f
                                                   ˜
                                                
                                             
                                             (
                                             
                                                
                                                   x
                                                
                                             
                                             ;
                                             
                                                
                                                   
                                                      x
                                                   
                                                
                                                k
                                             
                                             )
                                          
                                       
                                    
                                 

Increment the iteration number by k
                                    =
                                    k
                                    +1 and repeat step (iii) and step (iv) alternately until a stopping criterion is satisfied.

Below, we explain how to perform the minimization of the surrogate function 
                              
                                 
                                    f
                                    ˜
                                 
                              
                              (
                              
                                 
                                    x
                                 
                              
                              ,
                              
                                 
                                    
                                       x
                                    
                                 
                                 k
                              
                              )
                            appearing in the step (II)(iv), which is a key part in the PA-MAP method. First of all, from Eq. (21), it is clear that this minimization can be performed for each variable x
                           
                              j
                            separately (i.e. the cost function is separable). However, solving the resulting minimization problem for each x
                           
                              j
                            is not trivial, mainly because the cost function includes the minimization operation with respect to the label l, which is a discrete optimization. We have found that this minimization problem can be solved in an exact and simple way by using the novel procedure shown in Appendix A, which involves a sequence of the soft-thresholding operations for all label values l
                           =1, 2, …, L. See Appendix A for the details. We have used this algorithm to perform the minimization of the surrogate function 
                              
                                 
                                    f
                                    ˜
                                 
                              
                              (
                              
                                 
                                    x
                                 
                              
                              ,
                              
                                 
                                    
                                       x
                                    
                                 
                                 k
                              
                              )
                            (of course, if the optimal value of x
                           
                              j
                           , at which 
                              
                                 
                                    f
                                    ˜
                                 
                              
                              (
                              
                                 
                                    x
                                 
                              
                              ,
                              
                                 
                                    
                                       x
                                    
                                 
                                 k
                              
                              )
                            is minimum, is negative it is replaced by zero). We note that the computational cost of this algorithm is much smaller compared to those of the forward projection and the backprojection if the number of labels is not large. We also note that the similar algorithm was proposed for the iMAP method and was called multi-thresholdings.

One major concern in penalized reconstruction methods similar to the one presented in this paper is the possibility of losing abnormalities. The main purpose of diagnostic CT imaging is to find the abnormalities such as lesion, tumors or organ shape deformation. It is always preferable for physicians to look at true images with weak artifacts than beautiful images that are likely to be different from the truth. It is clear from Sections 2 and 3.2, the thresholding operation used in both the iMAP and PA-MAP algorithms is applied only to pixels having intensity values closer to one of the intensity priors z
                        
                           l
                         in the iMAP algorithm and one of the median values μ
                        
                           l
                         (l
                        =1, …, L) in the PA-MAP algorithm. Moreover, the effect of the regularization term is handled such that the strength of the thresholding operation is reduced while the iteration proceeds by using dynamic value of the parameter β that is gradually decreased. In early iterations, the parameter β is relatively large to increase the effect of the PA prior and thus enforce image pixels to be closer to the values of μ
                        
                           l
                        . Later, and as the iteration proceeds, the value of β is reduced to give higher weight to the data fidelity term. Thus, restore abnormalities lost in early iterations. In the experimental studies presented here, we use the following rule to calculate dynamic β
                        
                           
                              (22)
                              
                                 β
                                 =
                                 
                                    
                                       
                                          β
                                          ∘
                                       
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                 
                                 ,
                              
                           
                        where β
                        ∘ is the initial parameter value. Further details are described in our previous study [14], and are omitted here. Consequently, the power of preserving abnormalities of the iMAP and PA-MAP methods is rather strong. In the experimental studies detailed in the next section, we demonstrate how the proposed method can preserve abnormalities such as calcifications in lungs.

Throughout the experimental studies, the following image quality measures are used to evaluate the proposed method and its competitors. The noise reduction is measured using the relative root mean square error (RRME).
                           
                              (23)
                              
                                 RRME
                                 =
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                n
                                             
                                             
                                                
                                                   (
                                                   
                                                      x
                                                      j
                                                   
                                                   −
                                                   
                                                      x
                                                      j
                                                      *
                                                   
                                                   )
                                                
                                                2
                                             
                                          
                                          
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                n
                                             
                                             
                                                
                                                   (
                                                   
                                                      x
                                                      j
                                                      *
                                                   
                                                   )
                                                
                                                2
                                             
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        where x
                        
                           j
                         denotes the pixel value of reconstructed image and 
                           
                              x
                              j
                              *
                           
                         is the corresponding true value. The image contrast is measured using the following formulae.
                           
                              (24)
                              
                                 Contrast
                                 =
                                 
                                    
                                       |
                                       
                                          
                                             x
                                             ¯
                                          
                                          s
                                       
                                       −
                                       
                                          
                                             x
                                             ¯
                                          
                                          b
                                       
                                       |
                                    
                                    
                                       
                                          
                                             x
                                             ¯
                                          
                                          s
                                       
                                       +
                                       
                                          
                                             x
                                             ¯
                                          
                                          b
                                       
                                    
                                 
                                 ,
                              
                           
                        where 
                           
                              
                                 x
                                 ¯
                              
                              s
                           
                         and 
                           
                              
                                 x
                                 ¯
                              
                              b
                           
                         are the mean pixel values of selected region-of-interest (ROI) pixels (ROI
                        
                           s
                        ) and background pixels (ROI
                        
                           b
                        ), respectively. The mean values 
                           
                              
                                 x
                                 ¯
                              
                              s
                           
                         and 
                           
                              
                                 x
                                 ¯
                              
                              b
                           
                         are computed by


                        
                           
                              (25)
                              
                                 
                                    
                                       x
                                       ¯
                                    
                                    s
                                 
                                 =
                                 
                                    1
                                    
                                       
                                          n
                                          s
                                       
                                    
                                 
                                 
                                    ∑
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       
                                          n
                                          s
                                       
                                    
                                 
                                 
                                    x
                                    j
                                 
                                 ,
                                 
                                 (
                                 
                                    x
                                    j
                                 
                                 ∈
                                 
                                    ROI
                                    s
                                 
                                 )
                                 ,
                                 
                                 
                                 
                                    
                                       x
                                       ¯
                                    
                                    b
                                 
                                 =
                                 
                                    1
                                    
                                       
                                          n
                                          b
                                       
                                    
                                 
                                 
                                    ∑
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       
                                          n
                                          b
                                       
                                    
                                 
                                 
                                    x
                                    j
                                 
                                 ,
                                 
                                 (
                                 
                                    x
                                    j
                                 
                                 ∈
                                 
                                    ROI
                                    b
                                 
                                 )
                                 ,
                              
                           
                        where n
                        
                           s
                         (n
                        
                           b
                        ) is the number of pixels within ROI
                        
                           s
                         (ROI
                        
                           b
                        ). Furthermore, we use another metric to evaluate the image contrast and the noise properties. The contrast-to-noise ratio (CNR) is measured by
                           
                              (26)
                              
                                 CNR
                                 =
                                 
                                    
                                       2
                                       |
                                       
                                          
                                             x
                                             ¯
                                          
                                          s
                                       
                                       −
                                       
                                          
                                             x
                                             ¯
                                          
                                          b
                                       
                                       |
                                    
                                    
                                       
                                          δ
                                          s
                                       
                                       
                                          σ
                                          s
                                       
                                       +
                                       
                                          δ
                                          b
                                       
                                       
                                          σ
                                          b
                                       
                                    
                                 
                                 ,
                                 
                                 
                                    δ
                                    s
                                 
                                 =
                                 
                                    
                                       
                                          n
                                          s
                                       
                                    
                                    
                                       
                                          n
                                          s
                                       
                                       +
                                       
                                          n
                                          b
                                       
                                    
                                 
                                 ,
                                 
                                 
                                    δ
                                    b
                                 
                                 =
                                 
                                    
                                       
                                          n
                                          b
                                       
                                    
                                    
                                       
                                          n
                                          s
                                       
                                       +
                                       
                                          n
                                          b
                                       
                                    
                                 
                                 ,
                              
                           
                        where σ is the standard deviation over ROI and is computed as follows:
                           
                              (27)
                              
                                 
                                    σ
                                    s
                                 
                                 =
                                 
                                    
                                       
                                          1
                                          
                                             
                                                n
                                                s
                                             
                                             −
                                             1
                                          
                                       
                                       
                                          ∑
                                          
                                             j
                                             =
                                             1
                                          
                                          
                                             
                                                n
                                                s
                                             
                                          
                                       
                                       
                                          
                                             (
                                             
                                                x
                                                j
                                             
                                             −
                                             
                                                
                                                   x
                                                   ¯
                                                
                                                s
                                             
                                             )
                                          
                                          2
                                       
                                    
                                 
                                 ,
                                 
                                 
                                    σ
                                    b
                                 
                                 =
                                 
                                    
                                       
                                          1
                                          
                                             
                                                n
                                                b
                                             
                                             −
                                             1
                                          
                                       
                                       
                                          ∑
                                          
                                             j
                                             =
                                             1
                                          
                                          
                                             
                                                n
                                                b
                                             
                                          
                                       
                                       
                                          
                                             (
                                             
                                                x
                                                j
                                             
                                             −
                                             
                                                
                                                   x
                                                   ¯
                                                
                                                b
                                             
                                             )
                                          
                                          2
                                       
                                    
                                 
                                 .
                              
                           
                        
                     

In the simulation study, we have used digital phantoms to construct the probabilistic atlas. A set of 100 simulated phantoms were designed to simulate chest CT with change in organ size to take the individual variation into account. Each ellipse (organ) is assumed to have the same center point to avoid additional efforts for image registration. The sample image corresponding to patient #1 (largest ellipse contraction case) and patient #100 (largest expansion case) are shown in Fig. 7
                           (a) and (b), respectively and phantom parameters are shown in Table 1
                           . Attenuation values are assumed to be uniform within each organ and we assigned the values of 0.0, 0.25, 1.20, 1.0, and 1.80cm−1 for regions representing air, lungs, soft-tissue, cardiac and vertebra, respectively. The range of size changes in ellipses is illustrated in Fig. 7(c) and detailed in Table 1. The probabilistic atlas, computed from the simulated data, is shown in Fig. 8
                           , which is an ideal example where most of the image pixels possess crisp probabilities (either zeros or ones). Only pixels located near region boundaries possess non-crisp values.

The phantom image to be reconstructed is an intermediate case (patient #50) with some additional abnormality (which are not included in creating the atlas). Abnormalities are considered as change in anatomical structure shown by two ellipses added to the vertebra or lung lesions. One 6.4mm lesion insert in the right-side lung, two 25.4mm and two 4.8mm lesions insert on the left-side lung. The lesion in the right-side lung is with intensity value of 1.0cm−1, while lesions in the left-side lung are with intensity values of 1.0cm−1 and 0.6cm−1 as shown in Fig. 9
                           (a) and detailed in Table 2
                           . We use the lesion insert (1) in the right-side lung to compute quantitative lesion observation measures discussed above, while remaining lesions are used for visual quality observation. The image grid was set to 320×320 pixels, and the projection data was computed by assuming 320 detector bins for each view, 180° view angular range with parallel-beam geometry and simple line-integral projection model. We implemented the following three scenarios. First, we measure the projection data over 320 views with additional Poisson noise corresponds to 2×103, 1×104 and 2×104 photon counts. The filtered back-projection (FBP) and the standard OS-Convex [38] (with and without quadratic penalty) algorithms are used to evaluate the proposed PA-MAP algorithm. The number of iterations for OS-Convex, OS-Convex with quadratic penalty and PA-MAP are set to 10 iterations and β
                           ∘
                           =1.0. Reconstructed images are shown in Fig. 10
                            and quality measures are illustrated in Table 3
                           . In low photon counts (shown in the top row), the low-contrast lesion is highly degraded and very difficult to visually observed. However, due to the improvement is noise properties in the background, lesion detectability in PA-MAP is improved. With higher photon counts, the low-contrast lesion becomes more visible in FBP, OS-Convex and OS-Convex with quadratic penalty but PA-MAP still of higher quality. One drawback observed in the PA-MAP image is the degradation in regions close to boundaries. This effect is expected as the value of certainty is low around the boundaries.

In the second scenario, we consider the reconstruction from small number of views (16, 24 and 32 projections). Iterative algorithms are implemented using 100 iterations and β
                           ∘
                           =50.0. Results re shown in Fig. 11
                            and quality metrics are shown in Table 4
                           . In the third scenario, we consider the limited-angle problem by limiting the projection data to 320 views over the angular orbit of 90°, 120° and 150°. We consider 10 iterations for iterative reconstruction and β
                           ∘
                           =50.0. Reconstructed images are shown in Fig. 12
                            and image quality measurements are in Table 5
                           .

To evaluate the performances of the proposed PA-MAP method for image reconstruction from low-dose imaging setup, we have carried out a set of experimental studies. Chest screening CT dataset,
                           1
                        
                        
                           1
                           JAMIT medical image database, The Japanese Society of Medical Imaging Technology (JAMIT) (http://www.jamit.jp/cad/db/index.html).
                         was used to construct the probabilistic atlas. The dataset consists of 68 volumes for 14 normal and 54 abnormal patients scanned using Hitachi CT-W950SR scanner. The dataset include a confirmed diagnosis sheet for each patient. Each volume consists of 18–31 transaxial slices, where each slice consists of 320×320 pixels with pixel size of 1mm×1mm and slice thickness of 10mm. Sample images that demonstrate a large individual variation of anatomical information in the dataset used here are shown in Fig. 13
                        .

To construct the probabilistic atlas, a randomly selected image from the dataset (patient #24 in this experiment) was set to a reference image and all remaining corresponding slices (67 images) were registered to it. An example of image registration and clustering process used to construct the PA is shown in Fig. 14
                           . The EM algorithm was used to estimate the LMM parameters (λ, μ, π) and the prior probability function. We intuitively limited the mixture to six components (L
                           =6) that represent air, patient bed, lungs, fatty-tissues, muscles, and bones. After only 10 iterations of the EM algorithm, we obtained the atlas shown in Fig. 15
                           .

Due to the lack of the original raw projection data, we have forward-projected dataset images to simulate a realistic data acquisition. The forward projection was implemented through a 320 detector bins and 640 projection views using simple line-integral model and parallel-beam geometry. In this experiment, we evaluated the ability of PA-MAP method in lesion detection task with comparison with other conventional methods. We selected patient #50 (slice #10) and patient#59 (slice 14), where a lung cancer is defined and confirmed. We considered the case of low-power tube and the same parameter setup as in the previous experiment was used. First, we obtain initial FBP image, which is degraded with statistical noise. The initial PA shown in Fig. 15 was fitted using the clustered FBP components as shown in Fig. 16
                           . The fitted atlas shown in Fig. 16(e) is used for the implementation of the PA-MAP algorithm. Reconstruction results indicate an improvement of image quality with preservation of lung abnormalities (Fig. 17
                           ).

Another study was performed to evaluate the proposed method with relatively small abnormality. We consider patient #17 (slice #11), where a calcification is found and confirmed inside the left-side lung. We considered the case of low-power tube and data acquisition over a small number of projection views (64 views). We used the same parameter setup as in the previous experiment. Reconstructed images are shown in Fig. 18
                           , and image quality measurements defined in Section 4.1 were calculated as shown in Table 6
                           . It is observed that image reconstructed using conventional methods still suffer from artifacts, which is significantly suppressed when PA-MAP is used. It is also observed that the contrast of cancer lesion is also preserved with high contrast.

@&#DISCUSSION@&#

This section is dedicated for a general overview discussion of the proposed methods considering experimental results, current limitations and potential extensions. From the demonstrated results, it is clear that the PA-MAP method outperforms the conventional FBP in terms of noise suppression, artifacts reduction, and lesion contrast preservation. The abnormal inserts can be observed clearly in every considered imaging scenarios using the proposed PA-MAP method. The interesting result is the ability to reconstruct a nice image from the projection data measured over rotation orbit of 90° as shown in Fig. 12.

One concern about the PA-MAP method is the treatment of large-size abnormalities and variation of anatomical structures. It is observed that PA-MAP reconstruction produces a notable improvement in image quality for normal structures. However, pixels belong to abnormalities are still suffered from artifacts. The reason for this is the lack of PA prior to these pixels. This is clear from the appearance of lesions (2) and (3) in the PA-MAP reconstruction shown in Figs. 10–12. The interesting observation here is that pixels belong to regions of abnormalities or variation of anatomical structures are not incorrectly assigned to the corresponding PA intensity values. This reason of this feature is discussed above in Section 3.3.

To observe the behavior of the abnormal insert during PA-MAP reconstruction, we have traced a small ROI (16×16 pixels) surrounding lesion (1) iteration-by-iteration. We consider image reconstruction from 16 projections (Fig. 11) and the results are presented in Fig. 19
                     . Obviously, in very early iterations, the background intensity value reaches to the correct intensity value assigned to pixels of lungs (0.25cm−1). However, pixels corresponding to the abnormality is still far from the correct value (1.0cm−1). Soon after few iterations, as the parameter β decreases, the enforcement of data fidelity term is improved and the abnormality recovery gradually progresses.

In training-based approaches such as the one presented here, it is important to specify criteria for selecting the training set. There are several cases in which the dataset is insufficient to present enough knowledge. For example, if the number of patients used to construct the atlas are too small, there is large potential that it introduce incorrect pdf value. On the other hand, if the number of images are too large, there is possibilities that the atlas become uniformly distributed and the prior information is diminished. This is largely depends on the accuracy of the registration process. Selection of appropriate training set is a common problem in probabilistic atlas construction for medical imaging applications. Obviously, it is recommended that images used in the training set are acquired using similar conditions to the image in question. The term similar conditions means factors related to the patient (e.g. size, age, gender) and imaging environment (e.g. imaging facility, dose, contrast agent).

The PA-MAP method implemented in this work should be further investigated. A more sophisticated registration process is expected to contribute more to image quality. However, developing a high-performance image registration approach is out of the scope of this work. Also, it is worth noting that the use of probabilistic atlas is also useful in solving the limited angle problem, which is one of the challenging data limitation problems arising in several CT applications. The first results shown in this paper indicate a potential that most of lost image structures can be recovered well using the PA-MAP method. Another important direction to be investigated in the future is to incorporate the statistical shape prior in addition to the probabilistic atlas to further improve the performance. In the CT image segmentation field, it is known that the shape prior dramatically improves segmentation accuracy [39]. The similar improvement can be expected in the CT reconstruction applications.

@&#CONCLUSION@&#

This work presents a new image reconstruction method for low-dose CT imaging. We consider two imaging setups including the reduction of X-ray tube power and data acquisition over a small number of projection views or small orbital range. The main contribution of this work is the use of prior information obtained from probabilistic atlas constructed from earlier scans of different patients. This work provides a positive answer to the question of whether it is useful to utilize CT images generated from other patients to improve image quality when the projection data is limited. Within the framework of our iMAP reconstruction method, the prior information computed from the atlas is proved to be useful in improving image quality as well as lesion detection. The proposed PA-MAP method possesses several advantages summarized as follows. (1) The implementation requires minor efforts as it is essentially a combination of the conventional statistical iterative reconstruction and a sequence of soft-thresholding operations, (2) the convergence can be sped up by using the concept of ordered subsets similar to the implementation of the iMAP algorithm [14], and (3) the only parameter to be manually adjusted is the regularization parameter β as most of the iMAP parameters are automatically determined from the probabilistic atlas. The proposed PA-MAP method was evaluated using chest screening CT dataset with patients diagnosed for different types of abnormalities, and experimental results indicate image quality improvement compared to the conventional reconstruction methods such as FBP and OS-Convex algorithms.

@&#ACKNOWLEDGEMENT@&#

This work was supported financially by the Science and Technology Development Fund (STDF), Egypt, Grant No. 6104.

Assume a
                     
                        l
                     
                     >0. In the case of PA-MAP method, our problem is to find the solution of the minimization problem expressed in the following form.
                        
                           (A.1)
                           
                              f
                              (
                              
                                 
                                    x
                                    *
                                 
                              
                              )
                              =
                              
                                 min
                                 x
                              
                              
                                 
                                    
                                       
                                          min
                                          
                                             l
                                             =
                                             1
                                          
                                          L
                                       
                                       [
                                       
                                          b
                                          l
                                       
                                       +
                                       
                                          a
                                          l
                                       
                                       |
                                       x
                                       −
                                       
                                          m
                                          l
                                       
                                       |
                                       ]
                                       +
                                       
                                          1
                                          2
                                       
                                       
                                          
                                             (
                                             x
                                             −
                                             p
                                             )
                                          
                                          2
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (A.2)
                           
                              =
                              
                                 
                                    min
                                    
                                       l
                                       =
                                       1
                                    
                                    L
                                 
                                 
                                    
                                       
                                          
                                             b
                                             l
                                          
                                          +
                                          
                                             min
                                             x
                                          
                                          
                                             
                                                
                                                   
                                                      a
                                                      l
                                                   
                                                   |
                                                   x
                                                   −
                                                   
                                                      m
                                                      l
                                                   
                                                   |
                                                   +
                                                   
                                                      1
                                                      2
                                                   
                                                   
                                                      
                                                         (
                                                         x
                                                         −
                                                         p
                                                         )
                                                      
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           Step 1: For l
                              =1, …, L we perform the soft-thresholding to solve the inner minimization problem with respect to x in Eq. (A.2).
                                 
                                    (A.3)
                                    
                                       
                                          x
                                          l
                                       
                                       =
                                       soft-thresholding
                                       (
                                       p
                                       )
                                       =
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         p
                                                         +
                                                         
                                                            a
                                                            l
                                                         
                                                      
                                                      
                                                         (
                                                         p
                                                         <
                                                         
                                                            m
                                                            l
                                                         
                                                         −
                                                         
                                                            a
                                                            l
                                                         
                                                         )
                                                      
                                                   
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         (
                                                         
                                                            m
                                                            l
                                                         
                                                         −
                                                         
                                                            a
                                                            l
                                                         
                                                         ≤
                                                         p
                                                         ≤
                                                         
                                                            m
                                                            l
                                                         
                                                         +
                                                         
                                                            a
                                                            l
                                                         
                                                         )
                                                      
                                                   
                                                   
                                                      
                                                         p
                                                         −
                                                         
                                                            a
                                                            l
                                                         
                                                      
                                                      
                                                         (
                                                         p
                                                         >
                                                         
                                                            m
                                                            l
                                                         
                                                         +
                                                         
                                                            a
                                                            l
                                                         
                                                         )
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

Step 2: Using the result of Step 1, compute the index h at which the outer minimization with respect to l in Eq. (A.2) is achieved
                                 
                                    (A.4)
                                    
                                       h
                                       =
                                       arg
                                       
                                          min
                                          
                                             l
                                             =
                                             1
                                          
                                          L
                                       
                                       
                                          
                                             
                                                
                                                   b
                                                   l
                                                
                                                +
                                                
                                                   a
                                                   l
                                                
                                                |
                                                
                                                   x
                                                   l
                                                
                                                −
                                                
                                                   m
                                                   l
                                                
                                                |
                                                +
                                                
                                                   1
                                                   2
                                                
                                                
                                                   
                                                      (
                                                      
                                                         x
                                                         l
                                                      
                                                      −
                                                      p
                                                      )
                                                   
                                                   2
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

Step 3: The solution is given by
                                 
                                    (A.5)
                                    
                                       
                                          x
                                          *
                                       
                                       =
                                       
                                          x
                                          h
                                       
                                    
                                 
                              
                           

Step 1: Find the unique index n such that m
                              
                                 n
                              
                              ≤
                              p
                              <
                              m
                              
                                 n+1
                           

Step 2: Compute the two candidates of the solution
                                 
                                    (A.6)
                                    
                                       
                                          x
                                          n
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         (
                                                         
                                                            m
                                                            n
                                                         
                                                         ≤
                                                         p
                                                         ≤
                                                         
                                                            m
                                                            n
                                                         
                                                         +
                                                         
                                                            a
                                                            n
                                                         
                                                         )
                                                      
                                                   
                                                   
                                                      
                                                         p
                                                         −
                                                         
                                                            a
                                                            n
                                                         
                                                      
                                                      
                                                         (
                                                         p
                                                         >
                                                         
                                                            m
                                                            n
                                                         
                                                         +
                                                         
                                                            a
                                                            n
                                                         
                                                         )
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (A.7)
                                    
                                       
                                          x
                                          
                                             n
                                             +
                                             1
                                          
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         p
                                                         +
                                                         
                                                            a
                                                            
                                                               n
                                                               +
                                                               1
                                                            
                                                         
                                                      
                                                      
                                                         (
                                                         p
                                                         <
                                                         
                                                            m
                                                            
                                                               n
                                                               +
                                                               1
                                                            
                                                         
                                                         −
                                                         
                                                            a
                                                            
                                                               n
                                                               +
                                                               1
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         (
                                                         
                                                            m
                                                            
                                                               n
                                                               +
                                                               1
                                                            
                                                         
                                                         −
                                                         
                                                            a
                                                            
                                                               n
                                                               +
                                                               1
                                                            
                                                         
                                                         ≤
                                                         p
                                                         <
                                                         
                                                            m
                                                            
                                                               n
                                                               +
                                                               1
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

Step 3: Compute the index h at which the minimum is achieved
                                 
                                    (A.8)
                                    
                                       h
                                       =
                                       arg
                                       
                                          min
                                          
                                             l
                                             =
                                             n
                                             ,
                                             n
                                             +
                                             1
                                          
                                       
                                       
                                          
                                             
                                                
                                                   a
                                                   l
                                                
                                                |
                                                
                                                   x
                                                   l
                                                
                                                −
                                                
                                                   m
                                                   l
                                                
                                                |
                                                +
                                                
                                                   1
                                                   2
                                                
                                                
                                                   
                                                      (
                                                      
                                                         x
                                                         l
                                                      
                                                      −
                                                      p
                                                      )
                                                   
                                                   2
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

Step 4: The solution is given by
                                 
                                    (A.9)
                                    
                                       
                                          x
                                          *
                                       
                                       =
                                       
                                          x
                                          h
                                       
                                    
                                 
                              
                           

@&#REFERENCES@&#

