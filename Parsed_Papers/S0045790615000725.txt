@&#MAIN-TITLE@&#Color image watermarking based on quaternion Fourier transform and improved uniform log-polar mapping

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A robust blind color image watermarking scheme is proposed.


                        
                        
                           
                           An improved uniform log-polar mapping method is used to resist geometric attacks.


                        
                        
                           
                           A dual watermark is embedded into quaternion discrete Fourier transform domain.


                        
                        
                           
                           The holistic embedding manner rather than block-based achieves better robustness.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Color image watermarking

Log-polar mapping

Phase correlation

Quaternion discrete Fourier transform

@&#ABSTRACT@&#


               
               
                  In this paper, we propose a blind color image watermarking scheme based on quaternion discrete Fourier transform (QDFT) and on an improved uniform log-polar mapping (IULPM). The proposed watermarking scheme embeds dual watermarks: one is a meaningful binary image watermark and the other is a bipolar watermark. The former is embedded in the real part of mid-frequency QDFT coefficients using quantization index modulation. The latter is used to resynchronize the watermark after the watermarked image has been attacked, making the scheme resistant to geometric attacks. In particular, the IULPM allows for greater accuracy when estimating the rotation angle of a geometric attack. At the same time, the watermark embedding employs the image holistically, rather than in a block pattern. Experimental results demonstrate that the proposed scheme achieves better performance of robustness against both common signal operations and geometric attacks compared to other existing schemes.
               
            

@&#INTRODUCTION@&#

With the rapid development of Internet and sophisticated image editing tools, digital multimedia content can be replicated, as well as tampered with more easily, making copyright protection and content authentication a major concern. Digital watermarking is one of the mechanisms that can be used to address these issues. It provides access to data while, at the same time, maintains protection by means of an imperceptible watermark, i.e., a transparent protection. In past decades, digital watermarking has been widely studied using grayscale images, whereas color images have received much less attention though they constitute most of the displayed multimedia content. Color information is also viewed as a significant feature in many fields of image processing. If correctly handled, color information will lead to more effective watermarking schemes, especially when achieving a good trade-offs between imperceptibility and robustness.

When focusing on robust color image watermarking schemes, those working in transform-domains achieve satisfactory robustness in comparison with spatial-domain methods. These transforms mainly include discrete cosine transform (DCT) [1–3], discrete Fourier transform (DFT) [4], discrete wavelet transform (DWT) [5–9], and quaternion discrete Fourier transform (QDFT) [10–16].

Barni and Piva et al. [1] proposed to embed the watermark in a subset of DCT coefficients for each color channel while exploiting the characteristics of the human visual system (HVS) and the correlation between RGB channels in order to achieve a good trade-off between robustness and imperceptibility. These schemes have better performance than those based solely on image luminance. Since then, several other DCT methods have been proposed [2,3]. In [2], Ahmidi et al. designed a color image watermarking method where just noticeable difference (JND) is used to select DCT coefficients in order to embed the watermark. Su et al. [3] proposed a blind color image watermarking based on DCT, and proved that embedding the watermark in the DCT direct current (DC) coefficient could be replaced by working directly into the spatial domain, which is simpler and has higher efficiency. Regarding DFT-based color image watermarking, Tsui et al. [4] designed a scheme that represents the host image in La
                     ∗
                     b
                     ∗ color space, and encodes the chromatic channels a
                     ∗ and b
                     ∗ into complex numbers a
                     +
                     jb. The watermark is then embedded in the frequency domain by using spatiochromatic DFT. DWT has also attracted interest. Al-Otum et al. [5] designed a blind watermarking method which performs DWT on the three color channels in order to construct a wavelet-tree, and then searches for robust bit host locations based on dominant relations. Chou et al. [6] proposed a perceptually tuned watermarking scheme by exploiting JND in the wavelet domain. Good watermark invisibility was obtained. Vahedi et al. [7] explored the effects of choosing different decomposition levels, filter-banks, color models, and channels. To realize blind watermark extraction, Su et al. [8] developed a dual color image watermarking based on integer wavelet transform and state coding.

In this work, we focus on QDFT-based color image watermarking. QDFT offers a sound way to jointly deal with the three channels of color images so that the watermark energy is spread into three channels simultaneously rather than into only one channel. QDFT was first applied to color image watermarking by Bas et al. [10]. This approach was performed by inserting a binary watermark bit into QDFT coefficients of 8×8 pixel blocks. Tsui et al. [11] proposed a scheme that performs QDFT in the La
                     ∗
                     b
                     ∗ color space. The advantage of this scheme is that the watermark is evenly spread into the luminance and chrominance components of the host image. Ma et al. [12] introduced a color image watermarking scheme that takes advantage of an invariant feature transform and utilizing a geometric correction strategy to enhance the robustness of the watermark against geometric attacks. A watermark bit is embedded in QDFT coefficients of blocks centered on each of the invariant feature points. A semi-blind scheme that combines quaternion singular value decomposition and QDFT was presented by Sun et al. [13]. Recently, Chen et al. [14] demonstrated how to fully utilize the 4-D quaternion frequency domain in order to embed a large capacity color image watermark in the case of the well-known quantization index modulation (QIM) [14–16]. Wang et al. [15] developed a QDFT-based blind color image watermarking algorithm where least squares support vector machine (LS-SVM) were combined with pseudo-Zernike moments to resist geometric attacks. In [16], a blind color image watermarking method was proposed to resist geometric attacks by combining the uniform log-polar mapping (ULPM) with QDFT.

Geometric attacks are considered to be the most challenging when designing a robust image watermarking scheme. It is noted that some schemes [17–20] are robust against geometric attacks by combining DFT and log-polar mapping (LPM). The LMP simplifies the effects of rotation and scaling transforms in the spatial system to shifts in the log-polar system [20]. It is important to note that these schemes [17–20] work on grayscale images. In [17], Ruanaidh et al. proposed a watermarking scheme that works with the Fourier–Mellin transform similar to the effect of combining LPM and DFT. The watermarked images obtained, however, were of poor quality due to the use of LPM and its inverse LPM (ILPM). Some solutions have been proposed to overcome this issue [18,19]. For example, Lin et al. [18] embedded a watermark signal in a 1-D signal obtained by the summing function of the LPM Fourier magnitude along the log-radius axis. Zheng et al. [19] performed ILPM to obtain the exact corresponding embedding positions in the Cartesian system and then embedded each watermark bit in the four neighboring points around these positions. Although this scheme [19] showed improvement, it suffered drawbacks from the interference distortions introduced by the ILPM. In the case of grayscale images, Kang et al. [20] proposed a blind watermarking scheme based on DFT and ULPM utilizing an extension of LPM, based on the increase of the sampling interval of the log-polar mapping from non-uniform to near uniform. This scheme not only greatly expands watermarking cardinality but also eliminates interpolation and interference distortions. Unfortunately, when the watermarked image is rotated, the fractional angles of rotation correction cannot be estimated correctly.

In this paper, we focus on color image watermarking robustness against geometric attacks, and propose a blind and robust scheme based on QDFT and an improved uniform log-polar mapping (IULPM). We extend the ULPM method [20] and propose the IULPM method to improve the correction precision of the ULPM. We also introduce a color image watermark resynchronization method, based on IULPM and QDFT, to resist geometric attacks.

The remainder of this paper is organized as follows. Section 2 introduces the proposed IILPM method and watermark resynchronization procedure. Section 3 describes the proposed scheme including watermark embedding and extraction procedures. Section 4 provides the results of the experiment and discussion. Finally, Section 5 concludes the paper.

In this section, we introduce the watermark resynchronization method based on QDFT and IULPM. This method allows us to estimate the fractional angles of rotation that the watermarked image may have undergone and, consequently, increases the watermark robustness. The watermark resynchronization process utilizes a phase correlation method in order to estimate the geometrical distortion parameters. Herein, our contributions are twofold: (1) a more accurate estimation of distortion parameters based on IULPM; and (2) a watermark resynchronization method based on IULPM and QDFT.

In order to present our IULPM, we first refer to ULPM [16,20]. As stated in the above introduction subsection, ULPM not only simplifies the effects of rotation and scaling transforms in the spatial system into shifts in the log-polar system, it also expands watermarking cardinality, and eliminates interpolation and interference distortions. Fig. 1
                        (a) and (b) shows the mapping process of ULPM. Other concepts of quaternions and QDFT can be found in [14–16]. The watermark resynchronization process based on ULPM and QDFT [16] can be summarized as follows:
                           
                              (1)
                              
                                 QDFT transform: QDFT is performed on the host color image. Next, QDFT coefficients are shifted to ensure low-frequency coefficients are centered in the magnitude spectrum. As shown in Fig. 1(a), the region surrounded by the smallest circle denotes low-frequency coefficients while the region in between the biggest and smallest circles indicates mid-frequency coefficients. The gray region of Fig. 1(a) denotes the embedding positions, in which the resynchronization watermark will be embedded.


                                 Performing ULPM on the frequency domain index: ULPM described in Eq. (1) is performed in the QDFT domain. Doing so, maps the frequency index (u,
                                 v), or their polar coordinate (r,
                                 θ), to the discrete log-polar coordinate (l
                                 1,
                                 l
                                 2), as illustrated in Fig. 1(b).
                                    
                                       (1)
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         l
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   =
                                                   floor
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  log
                                                               
                                                               
                                                                  a
                                                               
                                                            
                                                            
                                                               
                                                                  r
                                                               
                                                               
                                                                  R
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         M
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   ,
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         l
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     -
                                                                     floor
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 
                                                                                    N
                                                                                    ×
                                                                                    θ
                                                                                 
                                                                                 
                                                                                    π
                                                                                 
                                                                              
                                                                           
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     θ
                                                                     <
                                                                     0
                                                                     ,
                                                                  
                                                               
                                                               
                                                                  
                                                                     -
                                                                     floor
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 
                                                                                    N
                                                                                    ×
                                                                                    θ
                                                                                 
                                                                                 
                                                                                    π
                                                                                 
                                                                              
                                                                           
                                                                        
                                                                     
                                                                     +
                                                                     N
                                                                  
                                                                  
                                                                     θ
                                                                     ⩾
                                                                     0
                                                                     ,
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   R
                                                   =
                                                   0.3
                                                   ×
                                                   (
                                                   
                                                      
                                                         Q
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   -
                                                   1
                                                   )
                                                   ,
                                                
                                             
                                          
                                       
                                    
                                 where 
                                    
                                       r
                                       =
                                       
                                          
                                             
                                                
                                                   u
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             
                                                
                                                   v
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       ,
                                       θ
                                       =
                                       arctan
                                       (
                                       u
                                       /
                                       v
                                       )
                                    
                                 ; R refers to the base frequency (see Fig. 1); Q
                                 1 is image size; 
                                    
                                       floor
                                       (
                                       )
                                    
                                  represents the floor operator; M is the number of log-polar intervals in [r
                                 min, r
                                 max]; and N is the number of intervals considered for polar angle θ.


                                 Mapping rule: When performing ULPM on the frequency domain index, the following condition should be satisfied: one QDFT coefficient is permitted to map only onto one point of the log-polar system. As jointly illustrated in Fig. 1(a) and (b), this rule leads to a one-to-one or many-to-one mapping from the Cartesian system to the log-polar system.


                                 Resynchronization watermark embedding: One bit of information is embedded in all the QDFT magnitude coefficients of same log-polar coordinate (l
                                 1,
                                 l
                                 2) as follows [16,20]:
                                    
                                       (2)
                                       
                                          
                                             
                                                c
                                             
                                             
                                                ′
                                             
                                          
                                          (
                                          u
                                          ,
                                          v
                                          )
                                          =
                                          c
                                          (
                                          u
                                          ,
                                          v
                                          )
                                          ×
                                          (
                                          1
                                          +
                                          α
                                          ×
                                          w
                                          (
                                          
                                             
                                                l
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                l
                                             
                                             
                                                2
                                             
                                          
                                          )
                                          )
                                          ,
                                       
                                    
                                 where c(u,
                                 v) and 
                                    
                                       
                                          
                                             c
                                          
                                          
                                             ′
                                          
                                       
                                       (
                                       u
                                       ,
                                       v
                                       )
                                    
                                  are QDFT magnitude coefficients before and after embedding, respectively, and α is the embedding strength. The bipolar resynchronization watermark w(l
                                 1,
                                 l
                                 2) is generated by a secret key. As stated earlier, the gray regions in Fig. 1 represent the positions of QDFT coefficients where the watermark is embedded. Note that, based on this mapping rule, the insertion of the watermark into the QDFT domain is equivalent to embedding it in the log-polar quaternion Fourier domain.


                                 Watermark resynchronization: During the detection process, QDFT magnitude coefficients, obtained from the possibly attacked watermarked image, are mapped onto the log-polar coordinate using Eq. (1). Given that f(l
                                 1,
                                 l
                                 2) denotes these mapping coefficients, the fast watermark resynchronization process begins. Utilizing the phase correlation method, as proposed in [20], the best matching position is calculated as follows:

ULPM greatly expanded the cardinality of the watermark into the log-polar domain, and also eliminated the interpolation distortion and interference distortion. However, the precision of rotation correction was only 0.5° [20]. As a consequence, the ability to increase such a precision would lead to better robustness performance. Our improved ULPM is based on four modifications of the original ULPM.
                           
                              (1)
                              In order to expand the cardinality of the watermark in the log-polar mapping domain, the parameter N, which is the number of intervals on the L
                                 2 axis (polar angle) in the log-polar coordinate system, was increased from 360 to 1800, or greater.

By changing the value of N, the ULPM mapping rule (see Section 2.1) is no longer satisfied. Due to the increase of the number of intervals on L
                                 2 axis, a new mapping rule should be considered. We refer to it as zero-to-one mapping, as illustrated in Fig. 1(a) and (c). In other words, some grid points of the log-polar coordinate system do not contain the mapping QDFT magnitude coefficients.

To estimate the rotation angle with high accuracy, the same number of QDFT magnitude coefficients as ULPM needs to be modified (see gray region in Fig. 1(a)). However, to meet this requirement, the size of the bipolar resynchronization watermark to be embedded, based on IULPM, should be five times the size of the ULPM just as the parameter N also increases five times. Note that, although the size of the resynchronization watermark increases, the watermarked image maintains its quality since IULPM and ULPM modify the same number of QDFT coefficients.

We further extend the IULPM method to the QDFT domain. It is important to note that, theoretically, QDFT, in a log-polar system, has similar properties to DFT [16,21].

In this section, we introduce our blind color image watermarking scheme, including its watermark embedding and extraction processes. As mentioned above, QDFT has the ability to spread watermark energy into three channels simultaneously. Utilizing QDFT in combination with IULPM, we can achieve a more accurate estimation of distortion parameters to make our scheme robust to geometric attacks.

As stated earlier, two watermarks are embedded in the host image in our scheme, i.e., the binary image ww1 and the bipolar uniform PN-sequence ww2. The former is a meaningful binary image and is used as copyright protection; the latter is used as watermark resynchronization against geometric attacks. Fig. 2
                         sketches the watermark embedding process. The main steps are described as follows:


                           
                              
                                 (1)
                                 The meaningful binary watermark ww1 of size k
                                    1
                                    ×
                                    k
                                    2 is scrambled by using Arnold transform with a secret Key1. This transform is commonly used to improve the security of the system and to resist a cropping attack [14].

The host color image of size Q
                                    1
                                    ×
                                    Q
                                    2 pixels is divided into blocks of size q
                                    1
                                    ×
                                    q
                                    2 pixels. In each block, one bit or several bits of watermark information are embedded. For example, when Q
                                    1
                                    =
                                    Q
                                    2
                                    =512, k
                                    1
                                    =
                                    k
                                    2
                                    =64, if q
                                    1
                                    =
                                    q
                                    2
                                    =8, each block inserts one bit watermark information; if q
                                    1
                                    =
                                    q
                                    2
                                    =16, each block inserts four bits of watermark information. In our scheme, we fixed q
                                    1
                                    =
                                    q
                                    2
                                    =512 so that the watermark would be embedded by a holistic embedding approach rather than by a block-based approach.

QDFT is performed on each block of host color image. The obtained QDFT coefficients are shifted to ensure that the low-frequency coefficients are located at the center of the magnitude spectrum, as illustrated in Section 2.1.

One bit of the scrambled watermark ww1 is inserted into the real part of one secretly selected QDFT mid-frequency coefficient by QIM method as follows:
                                       
                                          (4)
                                          
                                             
                                                
                                                   F
                                                
                                                
                                                   real
                                                
                                                
                                                   ′
                                                
                                             
                                             (
                                             m
                                             ,
                                             n
                                             )
                                             =
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               2
                                                               Δ
                                                               ∗
                                                               round
                                                               (
                                                               
                                                                  
                                                                     F
                                                                  
                                                                  
                                                                     real
                                                                  
                                                               
                                                               (
                                                               m
                                                               ,
                                                               n
                                                               )
                                                               /
                                                               2
                                                               Δ
                                                               )
                                                               +
                                                               Δ
                                                               /
                                                               2
                                                            
                                                            
                                                               if
                                                               
                                                               ww
                                                               1
                                                               (
                                                               i
                                                               ,
                                                               j
                                                               )
                                                               =
                                                               1
                                                            
                                                         
                                                         
                                                            
                                                               2
                                                               Δ
                                                               ∗
                                                               round
                                                               (
                                                               
                                                                  
                                                                     F
                                                                  
                                                                  
                                                                     real
                                                                  
                                                               
                                                               (
                                                               m
                                                               ,
                                                               n
                                                               )
                                                               /
                                                               2
                                                               Δ
                                                               )
                                                               -
                                                               Δ
                                                               /
                                                               2
                                                            
                                                            
                                                               if
                                                               
                                                               ww
                                                               1
                                                               (
                                                               i
                                                               ,
                                                               j
                                                               )
                                                               =
                                                               0
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             ,
                                          
                                       
                                    where Freal
                                     (m,
                                    n) denotes the real part of the QDFT coefficient at the frequency position (m,
                                    n); Δ represents QIM quantization step; round(·) is rounding operator; and ww1 (i,
                                    j) corresponds to one bit of the watermark at the position (i,
                                    j). Note that the corresponding anti-symmetric QDFT coefficients are modified in order to avoid watermark energy loss which, naturally, decreases the robustness of the watermark (see [14] for details).

Once the watermark ww1 is embedded into the real part of QDFT coefficients, the watermarked image is obtained by performing inverse quaternion Fourier transform (IQDFT) on each block.


                           
                              
                                 (6)
                                 Contrary to the above, QDFT is performed on the whole watermarked image. The magnitude coefficients of the QDFT are mapped onto the log-polar coordinate system by using IULPM, according to Eq. (1).

The resynchronization watermark ww2 is generated as follows. At first, a bipolar resynchronization sequence 
                                       
                                          T
                                          =
                                          {
                                          
                                             
                                                T
                                             
                                             
                                                i
                                             
                                          
                                          ∈
                                          {
                                          -
                                          1
                                          ,
                                          1
                                          }
                                          ,
                                          
                                          i
                                          =
                                          1
                                          ,
                                          2
                                          …
                                          
                                             
                                                N
                                             
                                             
                                                T
                                             
                                          
                                          }
                                       
                                     of length NT
                                    , as well as a uniform bipolar sequence P of length NP
                                     (the number of ‘−1’ is the same as ‘1’), is generated, based on the secret Key2. Afterward, the resynchronization watermark ww2 is generated, i.e., 
                                       
                                          
                                             
                                                T
                                             
                                             
                                                ′
                                             
                                          
                                          ·
                                          P
                                       
                                    .

Watermark ww2 is embedded in the mid-frequency magnitude coefficients of QDFT using Eq. (2).

IQDFT is performed to obtain the final watermarked image. Note that the phase of QDFT coefficients remains unchanged.


                        Fig. 3
                         shows the watermark extraction process. It begins with the watermark resynchronization process followed by the meaningful watermark extraction. The main steps are as follows:
                           
                              (1)
                              QDFT is performed on the test image.

After the mid-frequency magnitude coefficients of the QDFT have been mapped onto log-polar coordinates with the help of IULPM, a mapping matrix f(l
                                 1,
                                 l
                                 2) is computed.

The resynchronization watermark ww2 is re-generated, as in the embedding process, based on the knowledge of the secret Key2, and is then padded with 0s to obtain a matrix w(l
                                 1,
                                 l
                                 2) of the same size f(l
                                 1,
                                 l
                                 2).

DFT is performed on f(l
                                 1,
                                 l
                                 2) and w(l
                                 1,
                                 l
                                 2) to obtain F(L
                                 1,
                                 L
                                 2) and W(L
                                 1,
                                 L
                                 2), respectively, upon which the resynchronization process given by Eq. (3) is performed. Once the displacement position (p
                                 1,
                                 p
                                 2) is obtained (see Eq. (3)), the geometric distortion image can be inverted in order to obtain the corrected watermarked image.

QDFT is performed on each block of the corrected watermarked image, and a watermark ww is extracted as follows:
                                    
                                       (5)
                                       
                                          ww
                                          (
                                          i
                                          ,
                                          j
                                          )
                                          =
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            1
                                                         
                                                         
                                                            if
                                                            
                                                            
                                                               
                                                                  F
                                                               
                                                               
                                                                  real
                                                               
                                                            
                                                            (
                                                            i
                                                            ,
                                                            j
                                                            )
                                                            -
                                                            2
                                                            Δ
                                                            ∗
                                                            round
                                                            (
                                                            
                                                               
                                                                  F
                                                               
                                                               
                                                                  real
                                                               
                                                            
                                                            (
                                                            i
                                                            ,
                                                            j
                                                            )
                                                            /
                                                            2
                                                            Δ
                                                            )
                                                            >
                                                            0
                                                         
                                                      
                                                      
                                                         
                                                            0
                                                         
                                                         
                                                            esle
                                                            
                                                            
                                                               
                                                                  F
                                                               
                                                               
                                                                  real
                                                               
                                                            
                                                            (
                                                            i
                                                            ,
                                                            j
                                                            )
                                                            -
                                                            2
                                                            Δ
                                                            ∗
                                                            round
                                                            (
                                                            
                                                               
                                                                  F
                                                               
                                                               
                                                                  real
                                                               
                                                            
                                                            (
                                                            i
                                                            ,
                                                            j
                                                            )
                                                            /
                                                            2
                                                            Δ
                                                            )
                                                            ⩽
                                                            0
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          .
                                       
                                    
                                 
                              

The extracted meaningful watermark w′ is obtained by inverting Arnold transform onto ww. Secret Key1 is required for this step.

@&#EXPERIMENTAL RESULTS@&#

In our experiments, we use the standard color images from: (i) the Computer Vision Group at the University of Granada [22] from which 64 color images of size 512×512 pixels were used as test image set Data1; (ii) the Corel 1000 dataset [23] which includes 10 classes and 1000 color images of size 384×256 or 256×384 pixels, from which 100 color images were used (10 per class) as test image set Data2. Some samples of Data1 and Data2 are shown in Fig. 4
                     . The binary watermarks we used are of 64×64 pixels and are issued from the MPEG7_CE_shape descriptor database.

In order to evaluate the performance of our scheme in terms of image distortion and robustness, the PSNR and normalized correlation (NC) were used. They are defined as follows:
                        
                           (6)
                           
                              PSNR
                              =
                              10
                              
                                 
                                    log
                                 
                                 
                                    10
                                 
                              
                              
                                 
                                    
                                       3
                                       
                                          
                                             Q
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             Q
                                          
                                          
                                             2
                                          
                                       
                                       ×
                                       
                                          
                                             255
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         k
                                                         =
                                                         1
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         i
                                                         =
                                                         1
                                                      
                                                      
                                                         
                                                            
                                                               Q
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         j
                                                         =
                                                         1
                                                      
                                                      
                                                         
                                                            
                                                               Q
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      [
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      (
                                                      i
                                                      ,
                                                      j
                                                      )
                                                      -
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            k
                                                         
                                                         
                                                            w
                                                         
                                                      
                                                      (
                                                      i
                                                      ,
                                                      j
                                                      )
                                                      ]
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              ,
                           
                        
                     
                     
                        
                           (7)
                           
                              NC
                              =
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       p
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       q
                                    
                                 
                              
                              
                                 
                                    [
                                    w
                                    (
                                    i
                                    ,
                                    j
                                    )
                                    ×
                                    
                                       
                                          w
                                       
                                       
                                          ′
                                       
                                    
                                    (
                                    i
                                    ,
                                    j
                                    )
                                    ]
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            i
                                                            =
                                                            1
                                                         
                                                         
                                                            
                                                               
                                                                  k
                                                               
                                                               
                                                                  1
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            j
                                                            =
                                                            1
                                                         
                                                         
                                                            
                                                               
                                                                  k
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            [
                                                            w
                                                            (
                                                            i
                                                            ,
                                                            j
                                                            )
                                                            ]
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            i
                                                            =
                                                            1
                                                         
                                                         
                                                            
                                                               
                                                                  k
                                                               
                                                               
                                                                  1
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            j
                                                            =
                                                            1
                                                         
                                                         
                                                            
                                                               
                                                                  k
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            [
                                                            
                                                               
                                                                  w
                                                               
                                                               
                                                                  ′
                                                               
                                                            
                                                            (
                                                            i
                                                            ,
                                                            j
                                                            )
                                                            ]
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              ,
                           
                        
                     where 
                        
                           
                              
                                 f
                              
                              
                                 k
                              
                           
                        
                      and 
                        
                           
                              
                                 f
                              
                              
                                 k
                              
                              
                                 w
                              
                           
                        
                      denote the original host color image and its watermarked version, respectively; and w and w′ are the original and the extracted watermarks, respectively.

Some default parameters of our scheme have been experimentally determined. IULPM: M
                     =64, N
                     =1800, R
                     =0.3×(512–1), α
                     =0.3, QIM: Δ
                     =270–24,500 (for different block size using different Δ value). For instance, when the host image “Lena” is divided into blocks of size 8×8 or 512×512, the QIM parameter Δ may be set to 270 or 24,500, respectively, in order to achieve the same PSNR value of 40dB. The corresponding watermarked images are shown as Fig. 5
                     (a) and (b).

Let us now consider a modified version of our scheme where IULPM is replaced by ULPM. The purpose of this experiment is to show the limitation of ULPM. Suppose that the watermarked image “Lena” is rotated with an angle −10° combined with a cropping attack, and then these attacked watermarked images are manually corrected by a rotation angle from 10.1° to 10.3° with an interval step of 0.1° before extracting the watermark. It can be seen from Table 1
                         that the watermark is not successfully extracted for the two cases with correction angles 10.2° and 10.3°, whose corresponding NC values are 0.3989 and 0.1693, respectively. This experiment indicates that if the correction error is more than or equal to 0.2°, the watermark cannot be correctly extracted. However, the rotation correction precision of ULPM is only 0.5°. It is, therefore, necessary to improve the precision of ULPM.


                        Table 2
                         lists comparison results between IULPM and ULPM with rotation angle attacks from 10° to 11° with step 0.1°. These results include calculated displacement values, correction angles, and angle errors. It can be seen that the ULPM error goes up to 0.3° when computing the rotation correction angle. Such an error has a great influence on watermark extraction, as shown by the previous experiment in Table 1. On the contrary, the IULPM method can correctly estimate all rotation angles, except in the case of the rotation attack of −10.4° where it achieves an error of 0.1°. This situation results from a truncation error induced by a floor function in the IULPM computation (see Eq. (1)). Consequently, a slight bias is introduced when computing the displacement values by means of the phase correlation maximization method (see Section 2.1).

To further compare the watermark extraction performance of IULPM and ULPM, we implemented the two previous schemes in test image sets Data1 and Data2. Each test image underwent 50 rotation angle attacks from 5° to 10° or from 25° to 30° with step 0.1°. Fig. 6
                        (a) and (b) display the average of the NC value we obtained for our Data1 and Data2 test image sets, respectively. It can be observed that NC values of IULPM are closer to 0.9. Obviously, the detection performance of the IULPM method is much better than the UPLM method. The underlying reason is that the rotation accuracy of the IULPM is 0.1°, while the rotation accuracy of the ULPM is 0.5°. We also tested 1800 rotation angle attacks for each image from 0° to 180° with step 0.1° where similar results were obtained.

In this experiment, we focus on the influence of block size on the robustness of the meaningful watermark. The standard test images “Lena”, “F16”, “Sailboat”, “House”, and “Pepper” were used as host images with the block sizes: 8×8, 16×16, 32×32, 64×64, 128×128, 256×256 and 512×512 pixels, respectively. Note that the bigger the block size is, the greater is the number of QDFT coefficients used in a block for watermark embedding in order to ensure the same capacity (see Section 3.1). Regarding the robustness of our scheme, the QIM quantization step was adapted depending on the block size in order to ensure an image distortion of PSNR of 40dB for all considered block sizes. In Fig. 7
                           , we give the NC values we obtained after different attacks on the resulting watermarked images. It can be observed that the holistic embedding approach (q
                           1
                           =
                           q
                           2
                           =512) is more robust than the block-based approach. This is especially true for histogram equalization in Fig. 7(c), light adjustment Fig. 7(d), contrast adjustment Fig. 7(e), average filtering Fig. 7(g) and JPEG compression Fig. 7(h). The underlying reasons are that the watermark is embedded in the QDFT domain in a holistic manner (rather than block-based) so that the energy of each pixel of watermark image is spread into each pixel of whole watermarked image instead of the watermarked image block. Furthermore, the holist embedding approach is more robust against cropping attack. The reason is that, in the case of block-based embedding approaches, some watermark bits cannot be recovered from cropped blocks.

Various experiments were carried out on the test sets Data1 and Data2 in order to illustrate the robustness of our scheme. The PSNR value of all watermarked images is close to 40dB by adaptively adjusting the embedding strength of our method. These watermarked images were then submitted to different attacks: noise addition, filtering, JPEG compression, brightness adjustment, contrast adjustment, rotation, scaling, cropping, and various combinations of each. Fig. 8
                            shows results for such attacks. Table 3
                            displays some extracted watermarks with their corresponding NC values in the case of “Lena”, “Pepper”, “Lake” and “House” images. It can be observed that, although the “Lena” watermarked image suffers from serious distortion, e.g., light adjustment from [0.2,0.8] to [0,1], contrast adjustment 2 times, rotation 30°+light adjustment from [0.2,0.8] to [0,1] and a cropping attack with a rate of 1/4 (see Fig. 8), the average NC values we obtained are approximately 1, 0.9568, 0.7397 and 0.9779, respectively. To further demonstrate the robustness of our scheme, the last two columns of Table 3 provide the NC mean and standard deviation values we achieved with our two image datasets. It can be observed that our method achieves good watermark extraction capability against common image processing operations and geometric attacks independently of the image datasets.

We also compared our scheme with current, state-of-art methods working in the spatial [3], DCT [24], DWT [25] and QDFT [14] domains. For the QDFT method [14], we followed the steps provided by the authors who performed the QDFT on the j imaginary part. The DCT [24] and DWT [25] methods worked with the YCrCb brightness component, i.e., Y. All methods, including ours, were tested on Data1 and Data2. For a fair comparison, the PSNR value of all watermarked images were set close to 40dB by adaptively adjusting the embedding strength for all the methods. Robustness performance of these schemes, evaluated in terms of average NC, is given in Tables 4 and 5
                           
                           .

It can be seen from Table 4 that, although the spatial domain method [3] obtains good results, i.e., filtering operation and JPEG compression, it fails to resist light, contrast adjustment, or a combination of both. This is not the case for transform-based methods [14,24,25]. Although the DCT-based approach [24] provides best robustness results against JPEG compressions, DWT, QDFT-based schemes, as well as our methods, have larger NC values in the case of noise addition attack, light and contrast adjustment, image filtering, or a combination of the common signal operation attacks listed in Table 4. Compared to the QDFT method [14], our proposal shows better performance of robustness to common image processing operations since it employs a holistically embedding approach (q
                           1
                           =
                           q
                           2
                           =512) instead of a block-based one. It can be seen from Table 5 that our scheme is more robust to cropping attack than other block-based embedding methods [14,24,25]. The main reason stands on the fact that some parts of the watermark are lost when the cropping attack is performed on the block-based methods. It can also be observed that, compared with other approaches, our scheme is very robust to rotation attacks due to the use of IULPM for estimating the distortion rotation angle.

@&#DISCUSSION@&#

In our scheme, the resynchronization watermark ww2 is embedded in the watermarked image after embedding the meaningful watermark ww1. This approach guarantees that ww1 has no impact on the ww2 allowing us to estimate the geometric distortion parameters with better accuracy. On the other hand, the PSNR values we obtained after the embedding of ww1 and then after the one of ww2 are of 40dB and 39.75dB, respectively. For such a distortion, we consider of small value, ww1 was correctly extracted whatever the above experiments. Therefore, we consider the embedding of two watermarks feasible.

The parameter N denotes the number of log-polar L
                           2 axis intervals, which determines the rotation precision. The precision of rotation is 0.5 for ULPM when N is set to 360 in [20], whereas it is 0.1 for IULPM fixing N to 1800. Although N can be further increased, it is unnecessary because it meets the requirements of the watermarking application as shown in Subsection 4.1. Parameter α denotes the strength of the second embedded watermark and Δ the QIM quantification step. The greater these parameters α and Δ, the better the robustness and watermark imperceptibility. Based on the above experiments, the trade-off between robustness and imperceptibility for our scheme is achieved when α is set within the value range [0.3,0.5] and Δ is fixed to 24500.

In addition to robustness and imperceptibility, the security of our scheme is another important aspect to consider. Actually, it is ensured by the secret keys that parameterize Arnold transform and the generation of the resynchronization watermark ww2, as well as by the knowledge of Δ and α.

@&#CONCLUSIONS@&#

A blind robust color image watermarking scheme based on IULPM and QDFT has been presented in this paper. The IULPM method we proposed extended the ULPM by adding a new mapping rule, i.e. zero-to-one mapping, which not only expanded the cardinality of the watermark in the log-polar mapping domain, but also increased the precision of the image rotation correction up to 0.1°. The combination of IULPM and QDFT was successfully utilized in a color image watermarking that was both robust against geometric attacks and provided a blind approach for watermark extraction. Further, we compared different embedding approaches to different sizes of image blocks.

Experimental results show that precision gained from IULPM remarkably enhances the watermark robustness. In addition, our results show that the holistic embedding approach, rather than the block-based approach, obtains excellent robustness to histogram equalization, light adjustment, contrast adjustment, average filtering, JPEG compression, and cropping operation. Compared to existing schemes working in the spatial, DCT, and wavelet domains, our experimental results also show good performance against geometric attacks, as well as against common image processing operations. In its actual form, the proposed scheme only utilizes the real part and magnitude of QDFT coefficients for watermark embedding. Future work will focus on using imaginary parts in order to increase watermark capacity and robustness.

@&#ACKNOWLEDGMENTS@&#

The authors would like to thank the anonymous reviewers and all Editors for their very valuable comments and suggestions. This work was supported by the National Basic Research Program of China under Grant 2011CB707904, the National Natural Science Foundation of China under Grants 61073138, 61103141, 61271312, and 61201344, the Research Fund for the Doctoral Program of Higher Education of Ministry of Education of China under Grants 20110092110023 and 2012009212003, the Natural Science Foundation of Jiangsu Province under Grants BK2012329 and DZXX-031, the Qing Lan Project of Jiangsu province, and the Natural Science Foundation of the Jiangsu Higher Education Institutions of China under Grant 13KJB520015.

@&#REFERENCES@&#

