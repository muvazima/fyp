@&#MAIN-TITLE@&#A 5D computational phantom for pharmacokinetic simulation studies in dynamic emission tomography

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Dynamic image acquisition protocols are increasingly used in emission tomography.


                        
                        
                           
                           Need for computational phantoms to describe both the spatial and temporal distribution of radiotracers.


                        
                        
                           
                           A 5D anthropomorphic phantom was developed, for parametric imaging simulations in emission tomography.


                        
                        
                           
                           The phantom is based on real 4D MR data and a detailed multi-compartmental pharmacokinetic modelling simulator.


                        
                        
                           
                           Example applications are shown in parametric [18F]FDG and [15O]H2O PET imaging.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Parametric imaging

Pharmacokinetics

Tomography

Respiratory motion

Phantom

PET

SPECT

MR

@&#ABSTRACT@&#


               
               
                  Introduction
                  Dynamic image acquisition protocols are increasingly used in emission tomography for drug development and clinical research. As such, there is a need for computational phantoms to accurately describe both the spatial and temporal distribution of radiotracers, also accounting for periodic and non-periodic physiological processes occurring during data acquisition.
               
               
                  Methods
                  A new 5D anthropomorphic digital phantom was developed based on a generic simulation platform, for accurate parametric imaging simulation studies in emission tomography. The phantom is based on high spatial and temporal information derived from real 4D MR data and a detailed multi-compartmental pharmacokinetic modelling simulator.
               
               
                  Results
                  The proposed phantom is comprised of three spatial and two temporal dimensions, including periodic physiological processes due to respiratory motion and non-periodic functional processes due to tracer kinetics. Example applications are shown in parametric [18F]FDG and [15O]H2O PET imaging, successfully generating realistic macro- and micro-parametric maps.
               
               
                  Conclusions
                  The envisaged applications of this digital phantom include the development and evaluation of motion correction and 4D image reconstruction algorithms in PET and SPECT, development of protocols and methods for tracer and drug development as well as new pharmacokinetic parameter estimation algorithms, amongst others. Although the simulation platform is primarily developed for generating dynamic phantoms for emission tomography studies, it can easily be extended to accommodate dynamic MR and CT imaging simulation protocols.
               
            

@&#INTRODUCTION@&#

The continuous development of anthropomorphic and small animal computational phantoms during the last few decades has led to their ever increasing use in clinical and preclinical research [1]. The improved level of their realism and flexibility compared to physical phantoms has led to their widespread use and adoption in emission tomography. The ability to perform simulation studies using these computational phantoms allows a number of methods and techniques used in the field of medical imaging and more specifically emission tomography to be developed, evaluated and validated under controlled and known conditions.

Three-dimensional computational phantoms fall into three categories based on their design principle: mathematical stylized phantoms, voxelized phantoms and hybrid equation-voxel phantoms. Mathematical phantoms use mathematical equations to approximate the surface of simple and complex body structures. A number of such designs exist in the literature, such as the Shepp–Logan [2] and the mathematical cardiac-torso (MCAT) phantoms [3]. Such designs are useful, but their inability to model complex structures limits their application, especially since there is need for more realistic simulation studies [4].

On the other hand, voxelized phantoms are based on using segmented anatomical information from high resolution tomographic data (CT or MRI). A number of voxelized phantoms exist, covering anatomical variants (age, sex, body weight, height etc) [5–9]. Their main advantage is the level of realism compared to stylized approaches; however, it fails to provide the level of flexibility offered by mathematical phantoms.

The need to combine the detailed anatomical information provided by voxelized phantoms with the flexibility offered by the mathematical phantoms, has led to the development of hybrid phantoms [10]. These models enable the combination of flexibility and realism within a single anatomical phantom representation. The most popular is the non-uniform rational B-splines (NURBS)-based cardiac-torso (NCAT) phantom [11,12].

All these three-dimensional (3D) computational phantoms offer a relatively simple and practical simulation platform, but fail to take into account time-dependent physiological processes occurring during the course of the imaging process. Consequently, this has led to the development of four-dimensional (4D) phantoms incorporating time-dependent processes, such as cardiac and respiratory motion. The NCAT phantom and the latest generation in this family of phantoms, the extended cardiac-torso phantom (XCAT) [13] were generated from multi-detector respiratory-gated CT data, to model cardiac and respiratory motion. Similarly, dynamic MRI has also been used to derive the motion information, which is then used in a four-dimensional (4D) simulation framework [14,15].

Although such 4D phantoms combine accurate anatomical information with models of temporally periodic physiological processes, they do not take into account the variable and temporally non-periodic functional processes occurring during the course of the study, constraining the level of realism and thus their potential application in dynamic studies. However, the need for more accurate quantification both in clinical research and drug development has lead to the increasing use of dynamic imaging protocols [16]. Moreover, pharmacokinetic analysis of the time course of the activity distribution enables more targeted physiological parameters, such as blood flow, metabolism and receptor occupancy, to be derived. In many studies, such parameters are more informative compared to standardized uptake value (SUV) index, which remains the most widely adopted metric in static whole-body PET imaging [17]. Consequently, the development of realistic digital phantoms for multi-compartmental tracer kinetic studies in dynamic PET and SPECT is of interest. Although a number of studies in the field of image reconstruction and kinetic modelling have used in-house developed parametric phantoms, they often feature roughly approximated anatomical structures with simple geometrical shapes, while lacking the anatomical and physiological variability caused by temporally periodic phenomena such as respiratory motion [18–22]. Recently a variant of the XCAT phantom was developed, named the perfusion cardiac-torso phantom (PCAT), but its scope was limited to dynamic perfusion studies in cardiac imaging [23].

In this work, using high resolution anatomical and temporal information from real MR data, we develop a five-dimensional (5D) computational anthropomorphic phantom, incorporating temporal gating from respiratory induced body motion and compartmental modelling tracer kinetic capabilities for parametric imaging simulation studies in dynamic emission tomography. This new voxelized phantom, allows respiratory gated and non-gated datasets to be simulated along with any tracer-specific compartmental model representing the temporal distribution of the activity concentration during dynamic imaging protocols in PET and SPECT. Rather than being region and application specific, kinetic parameters are freely assigned in the entire field-of-view (FOV), generating voxel-wise parametric maps based on the tracer of interest.

@&#METHODS@&#

This section describes the generic methodology used by the simulation platform for generating 5D parametric imaging simulation phantoms using MR information for discerning anatomy and motion along with a kinetic modelling simulator and a virtual tomograph.

Anatomical information are obtained from a high resolution 3D MRI scan and different organ structures are segmented in order to generate the anatomical regions comprising the phantom, as described in Tsoumpas et al. [24] and Buerger et al. [25]. Segmentation of the major structures is performed using a semi-automatic algorithm with local thresholding [25]. This allows fast generation of 3D anatomical phantoms, facilitating personalized patient-specific anatomical phantom designs, derived from a real MR scan. Apart from template organ structures segmented from the MRI data, tumours of varying characteristics (e.g. size and tracer uptake) can be manually inserted in different phantom regions. However, since these tumours represent additional patient-specific structural variants, they can easily be manipulated. Other anatomical variants can also be included depending on the required anatomy and simulation conditions. Tumours or other anatomical variants can be manually delineated/drawn on the 3D anatomical phantom and the tumour ROI mask can be saved and given a separate value, different to the region it is embedded within. The complete anatomical phantom is a superposition of separate regions segmented from the MRI data.

To describe the temporal distribution of a given tracer and simulate time–activity curves (TACs), custom-made software capable of providing multi-compartmental modelling for 1- and 2-tissue models was developed. Given an input function, a temporal sampling protocol and known tracer-specific pharmacokinetic parameters (constant rates) controlling the bi-direction flux of the tracer between the blood and tissue compartments (for each organ structure in the anatomical phantom), TACs are generated. Typical input functions derived from arterial sampling can be used, along with user defined ones, based on a parameterized model. For the sampling protocol, any number of frames and frame durations can be accommodated within the typical scan times used for dynamic studies in emission tomography. A blood volume component can also be included to generate the simulated TACs, since typically both tissue and blood components are sampled at the voxel level in clinical acquisitions. The same principles apply for the different kinetic parameters used, with separate constant rates for the different organs and values obtained from the literature, if a generic activity distribution is to be realized. Alternatively, if a dynamic emission scan is available from a patient, personalized patient-specific pharmacokinetic parameters can be used based on mean organ parameters. Although individual micro-parameters are the endpoint parameters of interest, in some applications certain macro-parameters, such as the volume of distribution (V
                           
                              T
                           ) and the tracer's net uptake rate into the irreversibly bound compartment (K
                           
                              i
                           ) are often more relevant and provide a more complete picture of the underlying patho-physiology. These macro-parameters are combinations of micro-parameters and can easily be adjusted to reflect specific conditions. Generic schematic diagrams for a single-tissue and a two-tissue compartment model, used to generate the dynamic phantom image sequence, are shown in Fig. 1
                           . The time-dependent activity concentration in the tissue C
                           
                              T
                           , can be described as a convolution of the impulse response function (IRF), which is the response of the system to a delta-function, with the time-dependent activity concentration in the plasma C
                           
                              P
                           . For the single-tissue model, the time-course of the activity distribution can be described as
                              
                                 (1)
                                 
                                    
                                       
                                          C
                                          T
                                       
                                       =
                                       IRF
                                       
                                          
                                             
                                                K
                                                1
                                             
                                             ,
                                             
                                                k
                                                2
                                             
                                             ,
                                             t
                                          
                                       
                                       ⊗
                                       
                                          C
                                          P
                                       
                                       =
                                       
                                          K
                                          1
                                       
                                       
                                          e
                                          
                                             −
                                             
                                                k
                                                2
                                             
                                             t
                                          
                                       
                                       ⊗
                                       
                                          C
                                          P
                                       
                                       =
                                       
                                          K
                                          1
                                       
                                       
                                          e
                                          
                                             −
                                             
                                                
                                                   
                                                      
                                                         
                                                            K
                                                            1
                                                         
                                                      
                                                      /
                                                      
                                                         
                                                            V
                                                            T
                                                         
                                                      
                                                   
                                                
                                             
                                             t
                                          
                                       
                                       ⊗
                                       
                                          C
                                          P
                                       
                                    
                                 
                              
                           where K
                           1 is the plasma to tissue rate constant (ml/s/ml). K
                           1 can be further parameterized, based on the Renkin–Crone model, as a product of blood flow (perfusion) and extraction fraction as
                              
                                 (2)
                                 
                                    
                                       
                                          K
                                          1
                                       
                                       =
                                       E
                                       F
                                       =
                                       
                                          
                                             1
                                             −
                                             
                                                e
                                                
                                                   −
                                                   
                                                      
                                                         
                                                            
                                                               P
                                                               S
                                                            
                                                            /
                                                            F
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       F
                                    
                                 
                              
                           where PS is the permeability surface area product, E is the extraction fraction and F is the blood flow [26,27]. For tracers with high permeability surface area product, extraction is close to unity and is independent of flow and therefore K
                           1 provides a measure of blood flow [28]. The platform is highly flexible, enabling to define the plasma-to-tissue influx rate by adjusting the permeability surface product and subsequently the extraction fraction, based on the selected tracer. Alternatively, one can directly assign a fixed value for K
                           1. Similarly, k
                           2 can be given directly or as a ratio of the influx rate (K
                           1) and volume of distribution (V
                           
                              T
                           ).

For the two-tissue model, the time-course of the activity distribution can be described as
                              
                                 (3)
                                 
                                    
                                       
                                          C
                                          T
                                       
                                       =
                                       IRF
                                       (
                                       
                                          K
                                          1
                                       
                                       ,
                                       
                                          k
                                          2
                                       
                                       ,
                                       
                                          k
                                          3
                                       
                                       ,
                                       
                                          k
                                          4
                                       
                                       ,
                                       t
                                       )
                                       ⊗
                                       
                                          C
                                          P
                                       
                                       =
                                       
                                          
                                             
                                                K
                                                1
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      a
                                                      2
                                                   
                                                   −
                                                   
                                                      a
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      k
                                                      3
                                                   
                                                   +
                                                   
                                                      k
                                                      4
                                                   
                                                   −
                                                   
                                                      a
                                                      1
                                                   
                                                
                                             
                                             
                                                e
                                                
                                                   −
                                                   
                                                      a
                                                      1
                                                   
                                                   t
                                                
                                             
                                             +
                                             
                                                
                                                   
                                                      a
                                                      2
                                                   
                                                   −
                                                   
                                                      k
                                                      3
                                                   
                                                   −
                                                   
                                                      k
                                                      4
                                                   
                                                
                                             
                                             
                                                e
                                                
                                                   −
                                                   
                                                      a
                                                      2
                                                   
                                                   t
                                                
                                             
                                          
                                       
                                       ⊗
                                       
                                          C
                                          P
                                       
                                    
                                 
                              
                           where
                              
                                 (4)
                                 
                                    
                                       
                                          a
                                          1
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   
                                                      k
                                                      2
                                                   
                                                   +
                                                   
                                                      k
                                                      3
                                                   
                                                   +
                                                   
                                                      k
                                                      4
                                                   
                                                
                                             
                                             −
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  k
                                                                  2
                                                               
                                                               +
                                                               
                                                                  k
                                                                  3
                                                               
                                                               +
                                                               
                                                                  k
                                                                  4
                                                               
                                                            
                                                         
                                                      
                                                      2
                                                   
                                                   −
                                                   4
                                                
                                             
                                             
                                                k
                                                2
                                             
                                             
                                                k
                                                4
                                             
                                          
                                          2
                                       
                                    
                                 
                              
                           and
                              
                                 (5)
                                 
                                    
                                       
                                          a
                                          2
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   
                                                      k
                                                      2
                                                   
                                                   +
                                                   
                                                      k
                                                      3
                                                   
                                                   +
                                                   
                                                      k
                                                      4
                                                   
                                                
                                             
                                             +
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  k
                                                                  2
                                                               
                                                               +
                                                               
                                                                  k
                                                                  3
                                                               
                                                               +
                                                               
                                                                  k
                                                                  4
                                                               
                                                            
                                                         
                                                      
                                                      2
                                                   
                                                   −
                                                   4
                                                
                                             
                                             
                                                k
                                                2
                                             
                                             
                                                k
                                                4
                                             
                                          
                                          2
                                       
                                    
                                 
                              
                           
                        

Simple or complex models can be realized in different organs, including dual input function models simulating both arterial and venous blood supply in certain organs such as the liver [29]. Furthermore, the differential temporal distribution of the activity concentration in the blood as it circulates through the blood vessels, can be taken into account, with differential delay and dispersion in the input function in adjacent regions (Fig. 2
                           ) [30]:
                              
                                 (6)
                                 
                                    
                                       
                                          
                                             
                                                C
                                                P
                                             
                                          
                                          ′
                                       
                                       
                                          t
                                       
                                       =
                                       
                                          C
                                          P
                                       
                                       
                                          
                                             t
                                             −
                                             
                                                Δ
                                             
                                             t
                                          
                                       
                                       +
                                       τ
                                       
                                          
                                             d
                                             
                                                C
                                                P
                                             
                                             
                                                
                                                   t
                                                   −
                                                   
                                                      Δ
                                                   
                                                   t
                                                
                                             
                                          
                                          
                                             d
                                             t
                                          
                                       
                                    
                                 
                              
                           
                        

Given an input function C
                           
                              P
                           (t), a delay (Δt) and a dispersion coefficient (τ) one can estimate C
                           
                              P
                           ′(t). The tracer's radioactive decay can also be taken into account and incorporated into the operational equations as a global parameter.

TACs are assigned at the voxel level, generating time series of voxelized phantoms (4D phantom) with a temporal sampling dictated by the dynamic acquisition protocol selected during the TAC generation. Although only the case for single- and two-tissue models is presented in this work, the simulation platform allows any kinetic model variant to be accommodated with an increasing degree of complexity and is therefore applicable for simulating kinetics for any tracer and protocol.

So far the 4D phantom corresponds to a single reference position without including any information regarding respiratory motion. To simulate different types of realistic motion during a dynamic scan, the fast analytic simulation toolkit (FAST) is used [15]. A dynamic 4D MRI scan, providing uniform temporal sampling over consecutive respiratory cycles during the dynamic scan, is used to generate the motion fields. This is achieved using the amplitude signal from a virtual navigator and selecting a number of dynamic images from different phases of the respiratory cycle as the respiratory gates. A reference gate is then selected with the remaining gates being registered to the reference gate, in order to generate the motion fields. These MR-generated motion fields are subsequently used to warp the dynamic phantom emission data and generate a number of respiratory gates for each time frame in the dynamic image sequence. Using this methodology, deep and shallow breathing can be simulated along with other non-periodic types of motion. If anatomical variants, such as tumours, are utilized in the phantom, motion is simulated similar to the rest of the regions. Therefore, the tumour's shape (along with the other regions) is deformed based on the motion fields, and as such, the deformation depends on where the tumour is located.

The simulated gated dynamic emission and attenuation data can then be used in conjunction with any medical imaging simulation package which models the physics, image acquisition and detector properties of medical imaging systems. Data can be forward projected to generate projection datasets for investigation of numerous methods and techniques for motion correction, image reconstruction, and kinetic parameter estimation.

In order to evaluate the phantom design and demonstrate the potential application of this simulation platform in drug, clinical, algorithmic and methodology development, different clinical protocols were realized. Two dynamic PET protocols corresponding to a metabolic imaging study with [18F]FDG and a perfusion study with [15O]H2O were simulated and reconstructed. Subsequently and following image reconstruction, full kinetic analysis was performed on the dynamic datasets and parametric maps of micro- and macro-parameters were generated.

To generate the anatomical phantom, high resolution anatomical information (2×2×2mm3), covering the thoracic and upper abdominal area have been obtained from a healthy volunteer using MRI data [25]. As cortical bone is not normally visible using common MR sequences, an ultra-short echo-time (UTE) 3D MRI sequence was acquired (TR 6.5ms, flip angle 10°) obtaining one image during the free induction decay (TE1
                        =0.14ms) and one during the first echo time (TE2
                        =4.6ms). Data were respiratory corrected to the end-exhale position. From the difference image between the 2 UTE images, a number of regions of interest were segmented (soft tissue, cortical bones, liver and lungs) and used to construct the anatomical phantom. The myocardium, heart ventricles and large vessels were also segmented using a different ECG triggered balanced B-TFE MRI scan during free breathing (TR/TE 4.7ms/2.36ms, TFE factor 26, ﬂip angle of 90°) [15,31]. The scan was subsequently respiratory gated again to the end-exhale position using a virtual navigator. Based on these two MRI scans, the different segmented regions were combined to generate the anatomical phantom. Nine tumours of varying size were also embedded in the lung (3), liver (3) and dome of the diaphragm (3). The tumours were drawn on the phantom and the tumour masks were inserted as separate regions. The anatomical phantom was then sub-sampled to a volumetric resolution of 2×2×2mm3 in order to represent typical voxel resolution encountered in PET imaging, with an image volume of 336×336×81 voxels. Based on the segmented organs that were used to generate the anatomical phantom, an attenuation map was also generated using a 4-region classification of the phantom.(air: 0cm−1, lung: 0.03cm−1, soft tissue: 0.099cm−1, and bone: 0.15cm−1).

Two dynamic PET protocols were simulated, corresponding to typical [15O]H2O and [18F]FDG scanning sessions and representing a single-tissue and a two-tissue model. For the [15O]H2O protocol, TACs were generated using a single-tissue 3 parameter model, including a blood volume component (K
                        1
                        , k
                        2, bv). A 360s total scan duration was selected binned into 28 non-uniformly sampled time frames [14×5s, 5×10s, 3×20s, 6×30s], representing a typical [15O]H2O protocol [32]:
                           
                              (7)
                              
                                 
                                    
                                       C
                                       T
                                    
                                    =
                                    IRF
                                    (
                                    
                                       K
                                       1
                                    
                                    ,
                                    
                                       k
                                       2
                                    
                                    ,
                                    t
                                    )
                                    ⊗
                                    
                                       C
                                       P
                                    
                                    +
                                    b
                                    v
                                    
                                       C
                                       p
                                    
                                    =
                                    
                                       K
                                       1
                                    
                                    
                                       e
                                       
                                          −
                                          
                                             k
                                             2
                                          
                                          t
                                       
                                    
                                    ⊗
                                    
                                       C
                                       p
                                    
                                    +
                                    b
                                    v
                                    
                                       C
                                       p
                                    
                                 
                              
                           
                        
                     

For the [18F]FDG protocol, TACs were generated using a two-tissue 4 parameter model assuming irreversible kinetics during the course of the scan (k
                        4
                        =0) and including also a blood volume component (K
                        1
                        , k
                        2
                        , k
                        3 and bv). A 3300s total scan duration was chosen binned into 29 non-uniformly sampled time frames [9×10s, 3×30s, 4×60s, 4×120s, 8×300s] [33]:
                           
                              (8)
                              
                                 
                                    
                                       C
                                       T
                                    
                                    =
                                    IRF
                                    
                                       
                                          
                                             K
                                             1
                                          
                                          ,
                                          
                                             k
                                             2
                                          
                                          ,
                                          
                                             k
                                             3
                                          
                                          ,
                                          t
                                       
                                    
                                    ⊗
                                    
                                       C
                                       P
                                    
                                    +
                                    b
                                    v
                                    
                                       C
                                       p
                                    
                                    =
                                    
                                       K
                                       1
                                    
                                    
                                       
                                          
                                             e
                                             
                                                −
                                                
                                                   
                                                      
                                                         k
                                                         2
                                                      
                                                      +
                                                      
                                                         k
                                                         3
                                                      
                                                   
                                                
                                                t
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   k
                                                   3
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         k
                                                         3
                                                      
                                                      +
                                                      
                                                         k
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                1
                                                −
                                                
                                                   e
                                                   
                                                      −
                                                      
                                                         
                                                            
                                                               k
                                                               2
                                                            
                                                            +
                                                            
                                                               k
                                                               3
                                                            
                                                         
                                                      
                                                      t
                                                   
                                                
                                             
                                          
                                       
                                    
                                    ⊗
                                    
                                       C
                                       p
                                    
                                    +
                                    b
                                    v
                                    
                                       C
                                       p
                                    
                                 
                              
                           
                        
                     

In both imaging protocols, a single input function model was used, representing delivery through arterial blood, while no differential delay and dispersion were used in simulating the kinetics for the different regions, with a common reference delivery time between them. Furthermore, kinetic parameters derived from the literature, summarized in Tables 1 and 2
                        
                        , were used to generate the dynamic data. For the [15O]H2O study, a measured input function was used while for the [18F]FDG data a population based input function was used.

4D MR data were also acquired from the same healthy volunteer, providing a uniform temporal sampling of a few complete respiratory cycles (∼25s dynamic acquisition with 0.7s temporal sampling—35 dynamic image volumes) as described by Buerger et al. [25]. An amplitude signal from a virtual navigator on the diaphragm dome was then generated and 8 dynamic images were chosen to sample a full respiratory cycle. Subsequently, each gated image, corresponding to a different phase in the respiratory cycle, was registered to the reference gate (i.e. end-exhale position) to estimate the corresponding motion fields, using a local affine registration algorithm [34]. Using the MRI-derived motion fields, the dynamic emission phantom images were warped into 8 different phases over the respiratory cycle, representing a shallow breathing pattern. Therefore, 8 gated 3D images were generated for each time frame in the dynamic 4D phantom (3 spatial dimensions {336×336×81}×28/29 time frames×8 respiratory gates). Attenuation data were treated similarly, generating 8 gated attenuation maps for each phase in the respiratory cycle, but using the same gated maps for all the time frames since no motion between the kinetic modelling time frames was taken into account in this study (3 spatial dimensions {336×336×81}×8 respiratory gates).

To generate the forward projected data, an in-house simulator was used. The dynamic emission images for each respiratory gate and time frame along with the respiratory gated attenuation images, were forward projected into a virtual scanner using Siddon's line of response driven algorithm, along with the geometry configuration of the Biograph 6 Barrel HiRez PET/CT scanner (Siemens Molecular Imaging Inc.TN, USA) [35]. Both the noiseless emission as well as attenuation projection data were histogrammed into a 336×336×313 3D sinogram (336×336×313×28/29 time frames×8 respiratory gates for the emission data and 336×336×313×8 respiratory gates for the attenuation data). Subsequently the emission projection data were attenuated to generate the attenuated emission sinogram for each respiratory gate and time frame.

The generated projection data were reconstructed using in-house developed image reconstruction software capable of reconstructing data from the Biograph 6 HiRez PET/CT [36]. Data were reconstructed using an ordinary Poisson ordered subsets expectation maximization algorithm (OP-OSEM) with 10 iterations (21 subsets). Following image reconstruction, full compartmental analysis of the dynamic datasets was performed to derive parametric maps of micro- and macro-parameters of interests. For both clinical datasets, kinetic modelling equations similar to those used to generate the data, were used to model the time-course of the activity distribution. The models were linearized using the generalized linear least square (GLLS) method [37,38], and model parameters were fitted to the measured data by minimizing a non-negative weighted least square objective function (NNWLS). For the [15O]H2O dataset, the GLLS was used with 2 internal iterations while parameter initialization was based on the linear least square algorithm (LLS) [37]. For the [18F]FDG dataset, 4 internal GLLS iterations were used, while initialization was based on uniform parameters. For the [15O]H2O data, parametric images of perfusion (K
                        1), clearance rate (k
                        2), fractional blood volume (bv) and volume of distribution (V
                        
                           T
                        ), were derived. Similar for the [18F]FDG data, parametric images of K
                        1
                        , k
                        2
                        , k
                        3
                        , bv and net uptake rate K
                        
                           i. were generated.

@&#RESULTS@&#

Six regions were segmented from the 3D MRI scans: soft tissue, liver, heart ventricles, lungs, rib cage and spine and myocardium. Representative slices through the simulated attenuation map of the combined anthropomorphic phantom are shown in Fig. 3
                     . Using the kinetic parameters from Tables 1 and 2 and the kinetic modelling operational equations, TACs for each organ region were generated and plotted in Fig. 4
                     . In Fig. 4a, the generated TACs from the [15O]H2O study are shown for all 6 regions as well as the embedded tumours. Regions with high K
                     1 such as the myocardium and the tumours exhibit a high upslope, with the washout of the tracer governed by k
                     2. Similarly, Fig. 4c shows the same TACs but using a dual input function model in the liver while in the rest of the regions, a single arterial input function model is used, similar to the one used in Fig. 4a. The dual input model in the liver represents tracer delivery from both the hepatic artery and portal vein. In order to simulate the portal vein, the gastrointestinal compartment can be used, representing a region outside the simulated patient's FOV, which is a single compartment model between the arterial blood and the gut compartment. Although a delay in the delivery of each input can also be accommodated, no delay between the arterial and portal input functions was assumed. The TAC in the heart ventricles which represents the activity concentration in the arterial blood was simulated using a blood volume component equal to unity as can be seen from Table 1, with no contribution from the tissue component. Hence, the TAC is equal to the input function. To simulate the more realistic case of differential tracer delivery time in different regions, including differential dispersion of the input function, the generated TACs in each region can take these effects into account. Three input functions are shown in Fig. 4d with 8s delay between them and different dispersion coefficients. By changing the delay, the input function is shifted with respect to the reference global zero time point in the simulated protocol. Simulated TACs for the [18F]FDG dataset are shown in Fig. 4b, again for the same regions. Looking at the tumour TAC, the trapping of the tracer is evident due to the irreversible kinetics attributed to a high simulated k
                     3 parameter and a k
                     4
                     =0 which is a valid assumption for the duration of a typical [18F]FDG scan. Similar to the [15O]H2O dataset shown in Fig. 4a, the activity concentration in the ventricles is representative of the input function. The simulated TACs shown in Fig. 4a and b were used to generate the dynamic phantoms for the [15O]H2O and [18F]FDG studies.

Representative emission data from the simulated dynamic and respiratory gated [15O]H2O and [18F]FDG phantoms are shown in Figs. 5 and 6
                     
                     , respectively. Fig. 5 shows typical slices and volume rendered images from early and late time frames into the dynamic [15O]H2O dataset. The images are shown for a single respiratory gated phase (one of the eight gated images), which corresponds to the reference gate (end-exhale position). In the early frame, activity is high in the heart ventricles and aorta, representing the input function as seen in Fig. 4, with the tissue response governed by the influx rate constant. Conversely, in the late frame, activity is representative of the tracer's washout. As the temporal frames are shown from a single gate position, they correspond effectively to motionless data and hence without any blurring in the voxelized dynamic data. The same time frames are shown in Fig. 5ii and iv but with all eight respiratory gated images superimposed, creating a blurred representation of the simulated activity distribution. Although eight gates were simulated in this study, different gates can be included or excluded to accommodate simulation of different breathing patterns. Using all eight gates, increased motion is simulated in the superior-inferior direction since the bulk of the motion occurs in this direction. During end-inspiration the lungs covered 359,802mm3 while during end expiration a ∼23% difference in volume was observed with the lungs covering 283,954mm3. Similarly in Fig. 6, an early and late [18F]FDG time frame is shown for a single gate and for all gates superimposed. As seen from the coronal images (Fig. 6b), the irreversible trapping of the tracer in the tumours is evident with increased activity concentration in the late frame signifying increased uptake rate. Motionless projection data from the reference gate were reconstructed as described in Section 2. Fig. 7
                      Reconstructed images from both the dynamic [15O]H2O (i–ii) and [18F]FDG (iii–iv) studies are displayed in Fig. 8
                     . The images representing again an early and a late time frame correspond to those from the motionless dynamic phantoms shown in Figs. 5 and 6. The reconstructed images are qualitatively identical to the simulated ones, demonstrating the capabilities of this parametric phantom in algorithmic development for image reconstruction applications. However, in parametric imaging studies, the endpoint parameters are the micro- or macro-parameter maps, rather than images of activity concentration. As such and following image reconstruction, full kinetic analysis was performed on the dynamic datasets for both studies.


                     Fig. 9
                      shows the simulated parametric images of influx rate (K
                     1), efflux rate (k
                     2), blood volume (bv) and volume of distribution (V
                     
                        T
                     ) as well as the estimated parametric maps following post-reconstruction kinetic analysis of the dynamic [15O]H2O dataset. 3D rendered images of the estimated parametric maps are also shown. Similarly, Fig. 10
                      displays the simulated K
                     1, k
                     2, k
                     3, bv and K
                     
                        i
                      parametric images and the estimated transverse and 3D rendered parametric maps following post-reconstruction kinetic analysis of the dynamic [18F]FDG dataset. As can be seen in both studies, there is a good differentiation between the tissue and the blood components. The estimated parametric maps appear broadly similar to the simulated ones while both micro- and macro-parameter maps can be estimated with the proposed simulation platform. Again since projections from a single gate were used, the estimated parametric maps are representative of motionless data. Consequently, any visible blurring in the estimated parametric maps is attributed to the lack of convergence during image reconstruction. A more quantitative comparison can be seen in Fig. 11
                      where profiles through the V
                     
                        T
                      and K
                     
                        i
                      parametric images from the [15O]H2O and [18F]FDG dataset are plotted. Reconstructed V
                     
                        T
                      values vary between 0 and 1ml/ml depending on the region while K
                     
                        i
                     , representing the net uptake rate, vary between 0 and 0.00133ml/s/ml with the maximum net uptake seen in the tumours.

@&#DISCUSSION@&#

A 5D anthropomorphic computational phantom for parametric imaging studies in dynamic emission tomography based on a generic simulation platform is described. The new platform comprises of a patient specific MR-segmented anatomical representation, including user-defined patient specific anatomical variants, coupled with a detailed kinetic modelling simulator, capable of generating realistic dynamic imaging protocols based on any given tracer specific model. The phantom is envisaged to become available for academic research applications in imaging physics, providing a library of anatomical phantoms coupled with the pharmacokinetic simulator and representative motion fields. Supplementary models, in addition to those demonstrated in this study could be incorporated along with additional functionality.

Compared to current computational phantoms reported in the literature, such as the NCAT and XCAT [10], the proposed design lacks the flexibility offered by coupling mathematical models to detailed generalized anatomical information. However, the proposed methodology counterbalances this by benefiting from a fast simulation environment, with semi-automatic segmentation techniques, making it possible to simulate personalized dynamic protocols [39]. Having the MR data available, construction of the anatomical phantom, kinetic modelling simulation, motion field estimation and application, and forward projection to generate the raw emission and attenuation data should take between 20 and 25h [15]. However, the majority of this time is taken by the forward projection step and depends on the imaging system, the number of respiratory gates and the kinetic modelling framing being simulated. With the recent advent of hybrid PET–MR systems, MR information is readily available for each patient, omitting the need for additional scanning sessions [40]. Furthermore, MR offers a competitive advantage compared to CT-derived anatomical phantoms since it results in no radiation dose to the subject. However, if other patient-specific anatomical information is available from different modalities, this can easily be incorporated to picture a more detailed anatomical representation. However, in this case, the additional structural information would need to be registered to the MR space prior to being segmented and incorporated in the phantom. If MR information is not available and the anatomical information derived exclusively from a different modality (such as CT), then there is no need for additional registration as the structural information is derived solely from a single modality. While patient-specific models can be realized, in cases where only a generic anatomical representation is needed, template anatomical information can be drawn from an anatomical library based on databases of healthy males and females.

Apart from a more personalized anatomical design, the dynamic phantom in reference paves the way for generic realistic parametric imaging simulation studies not previously available with application-specific platforms such as PCAT [23]. For algorithmic development, kinetic parameters for all organ structures can be drawn from existing literature; however, again if a more personalized simulation is needed, following kinetic analysis of an existing dynamic study, patient-specific kinetic parameters can be used in conjunction with the tracer-specific model and a patient or population based input function.

One of the drawbacks of voxelized phantoms, previously seen as a disadvantage compared to mathematical and hybrid phantoms is their inability to describe periodical motion induced variations [10]. However, this drawback was overcame by exploiting the possibility to transform the dynamic PET data with MR-derived motion fields and to generate a number of PET gates, simulating realistic respiratory motion within each time frame in the dynamic imaging protocol. One of the benefits of such an approach, amongst others, is the ability to provide a platform to investigate and develop a number of kinetic modelling related methods and techniques in the presence of motion.

Although the current phantom significantly enhances the simulation capabilities in the field of parametric imaging in emission tomography, further improvements can be accommodated. Extension of the simulated FOV from a single bed position to a multi-bed coverage is achievable since current PET–MR systems perform whole body acquisition protocols. This is of particular relevance since whole-body parametric imaging protocols have recently been introduced, demonstrating enhanced tumour detectability and more accurate quantification compared to traditional static imaging protocols relying on SUV indices [41].

Apart from improvements in the anatomy, further improvements can be realized in simulating the transit of the tracer through the vasculature and capillaries following tracer injection. More detailed modelling of the underlying physiological processes governing the tracer's delivery and uptake can further enhance the simulation capabilities of the existing platform, especially for drug and tracer development studies. Two PET dynamic protocols were demonstrated in this work, representing the bulk of imaging applications in PET imaging. The platform can also be used in a similar way for any clinical application in SPECT imaging. Furthermore, even though the platform is primarily designed for parametric imaging studies in emission tomography, it can easily be extended to accommodate dynamic simulation studies for other modalities. Dynamic contrast enhanced MRI and CT using iodine-based contrast agents can take advantage of the proposed methodology to investigate different pharmacokinetic related methods and techniques [42]. Although kinetic modelling in these modalities is slightly different compared to emission tomography techniques [43], the software can easily be extended in the future to incorporate pharmacokinetic models tailored to DCE–MR and DCE–CT imaging protocols.

@&#CONCLUSION@&#

As dynamic imaging protocols are adopted more frequently for clinical research and drug development, simulation solutions for more efficient development, evaluation and validation of novel tracers, protocols, methods and techniques in parametric imaging studies, are of interest. In this work, a new 5D computational phantom for generating realistic datasets for parametric imaging studies in emission tomography, was presented. The proposed phantom can be used for a number of applications both in PET and SPECT, including motion tracking and correction, conventional and direct image reconstruction algorithm development, dynamic imaging protocol design, simulations for tracer and drug development and kinetic parameter estimation algorithm development. As such, the phantom and software platform will be a valuable tool for the molecular imaging community and is envisaged to become available for simulation studies in dynamic tomography.

The authors declare that they have no conflict of interest.

@&#ACKNOWLEDGMENTS@&#

This work was supported by the Swiss National Science Foundation under grants SNSF 31003A-135176 and 31003A-149957 as well as EU COST Action 
                  TD1007 (www.pet-mri.eu). Data are available at http://www.isd.kcl.ac.uk/pet-mri/simulated-data/.

@&#REFERENCES@&#

