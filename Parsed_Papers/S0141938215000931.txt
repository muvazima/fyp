@&#MAIN-TITLE@&#Low complexity Bi-Partition mode selection for 3D video depth intra coding

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We can skip most of Bi-Partition mode full RD-cost value calculation.


                        
                        
                           
                           We use the Smallest Rough RD Cost Value (SRCV) to speedup the encoder.


                        
                        
                           
                           More than 34% encoding time saving is achieved under all-intra configuration.


                        
                        
                           
                           Small encoding time saving is also achieved under random access configuration.


                        
                        
                           
                           Flexibility is provided to tradeoff between encoding time saving and BD-rate loss.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Video coding

3D-HEVC

Bi-Partition mode

Depth map

Intra coding

Low complexity

@&#ABSTRACT@&#


               
               
                  This paper proposes a fast mode decision algorithm for 3D High Efficiency Video Coding (3D-HEVC) depth intra coding. In the current 3D-HEVC design, it is observed that for most of the cases, full rate-distortion (RD) cost search of Bi-Partition mode could be skipped since most coding units (CUs) of depth map are very flat or smooth while Bi-Partition modes are designed for CUs with edge or sharp transition. Using the rough RD cost value calculated by HEVC Rough Mode Decision as a selection threshold, we propose a fast Bi-Partition modes selection algorithm to speed up the encoding process. The test result for the proposed fast algorithm reports a 34.4% encoding time saving with a 0.3% bitrate increase on synthesized views for the All-Intra test case and negligible impact under the random access test case. Moreover, by simply varying the selection threshold, we can make a tradeoff between encoding time saving and bitrate loss based on the requirement of different applications.
               
            

@&#INTRODUCTION@&#

With the rapid growing in the three dimensional video market in recent years, research in this field has also been intensified in all areas, from 3D video capture to the 3D display technology. This also includes novel 3D video coding methods for efficient compression and transmission [1].

As the next generation video coding standard, High Efficiency Video Coding (HEVC) achieves superior bitrate and quality performance compared with that of the H.264/MPEG-4 AVC standard. Alluded by the growing 3D video market, Joint Collaborative Team on 3D Video Coding Extension Development (JCT-3V), formed by the ISO/IEC MPEG and the ITU-T VCEG, started the work on developing a new extension, 3D-HEVC, for better 3D video delivery compared with previous generation of depth-based 3D video coding technology [2,4].

We use Fig. 1
                      
                     [5] to show the fundamental architecture of the 3D-HEVC based coding system. In general, the input signal for the encoder consists of multiple views, associated depth maps, and corresponding camera parameters. Then a 3D video encoder, which represents an extension of HEVC, is used to code the input signal. In this step, the base view is coded using an unchanged HEVC encoder, while the dependent views are coded with new tools developed for 3D-HEVC extension. If the bitstream is decoded using a 3D video decoder, the input videos, the associated depth data, and camera parameters are reconstructed with the given fidelity. To display the 3D content on an auto-stereoscopic display, depth-image-based rendering (DIBR) [3] algorithm is used to generate additional intermediate views. To display the 3D content on a conventional stereo display instead of to an auto-stereoscopic display, the view synthesizer can also generate a pair of stereo views, in case such a pair is not actually present in the bitstream.

Therefore, one of the key components in 3D-HEVC is depth map compression [5]. Depth maps mainly contain two types of areas: sharp edges (which represent object borders) and large areas of nearly constant or slowly varying sample values (which represent object areas) [16]. While the HEVC intra prediction and transform coding are well-suited for nearly constant or regular changing regions, it can result in significant coding artifacts at sharp edges, which are visible in synthesized views. For the coding of depth maps, the same concepts of intra-prediction, motion-compensated prediction, compensated prediction, and transform coding as for the coding of the video pictures are used. However, in contrast to natural video, depth maps are characterized by sharp edges and large regions with nearly constant values [5]. Accordingly, several new intra prediction modes, namely Depth Modeling Mode (DMM) [10] and Region Boundary Chain Coding Mode (RBC) [11], are added for intra depth frame coding. In all these modes, a depth block is approximated by a model that partitions the area of the block into two regions (usually non-rectangular). Therefore, these new modes are also named as Bi-Partition modes [8]. The information required for such a model consists of two elements, namely the partition information, specifying the region each sample belongs to, and the region value information, specifying a constant value for the samples of the corresponding region. The Bi-Partition modes are integrated as an alternative to the conventional intra prediction modes specified in HEVC. For these modes, a residual representing the difference between the approximation and the original depth signal can be transmitted via transform coding. In Ref. [5], it is reported that Bi-Partition modes show a bitrate reduction of up to 6% for intra depth frame coding and achieve a much better subjective quality for synthesized views.

In 3D-HEVC intra depth coding, the CU encoding process, which contains the partition size determination and prediction mode selection for each prediction unit (PU), involves large computational cost and plays a crucial role. This is also true for Bi-Partition modes selection since in the current 3D-HEVC model, all these new Bi-Partition modes are added to full-RD calculation list for mode selection which is very time-consuming.

Several fast depth intra coding algorithms [12,13,19,20] have been proposed to reduce the encoding complexity. In Ref. [12], irrational operations of DMM are analyzed and a simplified DMM Wedgelet Partition search method is proposed by using the correlations between the mode and Wedgelet Partition. Although significant encoding time is saved for several selected sequences, this method incurs very big BD-bitrate loss (1.6–5% according to different settings). In Ref. [13], a fast DMM selection algorithm is proposed depending on the first mode in full-RD cost calculation list. If the first mode in full-RD cost calculation list is not a planar mode, all the DMM modes are added to the full-RD cost calculation list. Otherwise, a full-RD cost calculation of DMM modes is skipped. In Ref. [13], a 27.8% encoding time saving was reported with only a 0.5% bitrate loss on synthesized views. However, the method proposed in Ref. [13] lacks of the flexibility of trading off between the bitrate loss and encoder speedup. In this paper, we propose a fast Bi-Partition mode selection algorithm to speed up encoding process by using RD cost value calculated in HEVC intra Rough Mode Decision as a threshold. Considerable encoding time saving is achieved with negligible performance loss. By varying the selection threshold, we can simply make a tradeoff between encoding time saving and bitrate loss based on the requirements of different applications.

The rest of the paper is organized as follows. In Section 2, the existing 3D-HEVC intra depth coding is introduced with a focus on Bi-Partition mode RD cost calculation. In Section 3, a fast Bi-Partition mode selection algorithm is proposed. Experiment results for both intra coding scenario are shown in Section 4. Section 5 concludes this paper.

In the current 3D-HEVC design [5], Bi-Partition mode is utilized together with the intra coding scheme of HEVC for intra coding of depth map.

In HEVC intra coding, it is very time consuming to run a full-RD cost calculation for all 35 intra prediction modes as shown in Fig. 2
                      
                     [17,18]. As a result, a full-RD calculation list is created and several intra prediction modes out of the all 35 modes (8 candidates for 4×4 and 8×8 PU sizes, 3 candidates for 16×16 and 32×32 PU sizes) are selected as full-RD cost calculation candidates with Rough Mode Decision (RMD). Next, the Most Probable Modes (MPMs) derived from neighboring blocks are added to the subset [9,15].

The modes in the full RD cost calculation list are ordered in an ascending order of rough RD cost. For example, the mode with the smallest rough RD cost is placed in the first position of the full RD cost calculation list and the mode with largest rough RD cost is placed in the last position.

All the Bi-Partition modes are then also added to the full-RD cost calculation list after the conventional intra prediction modes for 3D-HEVC intra depth map coding. This process is plotted in Fig. 3
                     .

However, different from conventional texture frames, depth frames contain larger areas of flat and smooth blocks, while Bi-Partition modes are designed for CU with edges or sharp transitions and are thus less efficient for smooth CU compression. Fig. 4
                      shows a texture frame and a depth frame for the sequence Newspaper. Because of this, after full-RD cost calculation, Bi-Partition modes are rarely selected as the best intra mode. In Table 1
                     , we summarize the best mode selection rate for the first 48 frames of 6 testing sequences with 4 quantization parameters (QPs) (readers can refer to [6] and Table 6
                     
                     
                     
                     
                      for the details of each test sequences and QP selection).

As summarized in Table 1, for most sequences, Bi-Partition modes only account for very small percentages of best modes. However, they are always added to full-RD cost calculation list. Therefore, we target to develop a simplified Bi-Partition modes selection algorithm to eliminate the redundant Bi-Partition modes selectively in full-RD cost calculation and speedup intra coding.

Based on the analysis in Section 2, we propose a fast depth map intra mode selection algorithm to decide whether to add Bi-Partition modes into full-RD cost calculation list.

As we introduced in Section 2, a Rough Mode Decision (RMD) process is carried out to select several conventional intra prediction modes for full-RD cost calculation. The “Candidate Mode [0]” in Fig. 3 is the mode with the Smallest Rough-RD Cost Value (SRCV) [9]. We notice that, the SRCV has a strong correlation with the type of best intra prediction mode.

In Tables 2 and 3, for both low QP case and high QP case, we calculated the average SRCV for several test sequences when the best intra prediction mode is conventional intra prediction mode and the average SRCV when the best intra prediction mode is Bi-Partition mode using the first depth I-frame.

From Tables 2 and 3, one could easily notice that when Bi-Partition modes are selected as the best intra prediction mode, the average SRCV is much larger than that of the cases when conventional intra modes are selected as the best intra prediction mode. This result is consistently observed from low QP cases to high QP cases. High smallest Rough-RD Cost Value implies that the conventional intra prediction mode could not compress the current PU well. Under this situation, Bi-Partition modes would have a higher potential to compress the PU better and be selected as best intra prediction mode since they are designed to compress PUs when conventional intra modes could not compress efficiently.

Based on this observation, we propose our fast Bi-Partition mode selection algorithm as follows.

First, we use the first depth I-frame to initialize the average SRCVs for conventional intra prediction modes and for Bi-Partition modes with respect to different PU sizes (from 4×4 to 32×32).

Then, starting from the second frame, during the intra depth mode decision process, for a certain PU, if its SRCV is larger than a threshold T, we add all the Bi-Partition modes in its full-RD cost calculation list, otherwise, Bi-Partition modes full-RD cost calculation is skipped.

In the meanwhile, the averages SRCV for conventional intra prediction modes and for Bi-Partition modes are being updated when the mode decision process for each PU is finished. Fig. 5
                      summarizes the proposed fast depth map intra mode selection algorithm with the generalized PU size of N
                     ×
                     N. Basically, for the PU size from 4×4 to 32×32, the same procedure depicted in Fig. 5 is carried out.

Moreover, since the average SRCV varying significantly from sequence to sequence (e.g. Newspaper and Poznan_Hall2 at QP 34), it is necessary to select a threshold T which also changes adaptively based on the video content. In this paper, we calculate the selection threshold of PU N
                     ×
                     N, TN
                     
                     ×
                     
                        N
                     , based on the average SRCV of conventional intra prediction modes in Eq. (1).
                        
                           (1)
                           
                              
                                 
                                    T
                                 
                                 
                                    N
                                    ×
                                    N
                                 
                              
                              =
                              a
                              ×
                              (
                              average SRCV of conventional
                              
                              N
                              ×
                              N
                              
                              intra prediction modes
                              )
                           
                        
                     
                  

In this way, by varying the multiplier 
                        a
                     , we can control the Bi-Partition modes full-RD cost calculation skip rate to make a tradeoff between encoding time saving and bitrate loss based on the requirements of different applications.

In Table 4, we show the miss rate when the proposed algorithm decides to skip Bi-Partition modes in full-RD cost calculation while Bi-Partition modes should have been selected as the best mode. As indicated in Table 4, when we set 
                        a
                     
                     =2 in Eq. (1), the miss rate is negligible, less than 0.3% for most cases. The experimental results in the next section also support this point.

To evaluate the performance of the proposed fast Bi-Partition modes selection algorithm, experiments are carried out under the Common Testing Conditions (CTC) required by JCT-3V using the reference software HTM 7.0r1 [7]. For the mode selection threshold T in Eq. (1), 
                        a
                     
                     =2 is used. The value was selected by empirical methods.

We list the test sequences and several important configuration parameters in Tables 5 and 6. The encoding order was in a center–left–right way. Three of them (Balloons, Kendo, and Newspaper) are with 1024×768 resolution and four (PoznanHall2, PoznanStreet, GhostTownFly, and UndoDancer) are with 1088×1920 resolution. For details of test conditions and test sequences, readers can refer to [6]. The test results are shown in Table 7
                      for all intra cases. The test platform was Intel® CPU 3GHz with 16 cores, 96GB RAM, with Windows 7 Professional 64-Bit operating system.

In DIBR-based techniques, the impact on depth map quality is measured by the impact on the visual quality of the views synthesized from it. In Fig. 6
                     , we show two examples of RD performance of synthesized views with our proposed fast mode selection algorithm under All Intra test configuration [6]. The corresponding sequences are also shown in Fig. 7
                     . Kendo is a camera captured sequence, while UndoDancer is a computer generated sequence. As shown in Fig. 6, the RD performance of the proposed algorithm is almost the same as that of the anchor [7] from low to high bitrates.

We further summarize the All Intra performance for all the test sequences in Table 7. Here “video PSNR/video bitrate” is the BD-bitrate [14] calculated by the PSNR of texture frames and bits used for texture frame coding; “video PSNR/total bitrate” is the BD-bitrate calculated by the PSNR of texture frames and bits used for texture frame and depth frame coding; “synth PSNR/total bitrate” is the BD-bitrate calculated by the PSNR of synthesized views and bits used for texture frame and depth frame coding.

We notice that the proposed algorithm does not make any impact on the texture videos compression (video PSNR/video bitrate) since it only works on depth map compression. It only affects the quality of depth maps and thus the synthesized views. Under the all intra configuration as shown in Table 7, about 34.4% of encoding time is saved with only a 0.3% BD-bitrate loss (i.e. increase) on synthesized views. Moreover, the proposed algorithm has almost no impact on the decoding and rendering times.

The coding performance under the Random Access configuration is also shown in Table 8
                     . The performance change is negligible since most of the frames are coded as inter frames under Random Access Configuration.

Since complexity reduction is calculated by encoding time saving, it depends on the configuration of hardware. To give more precise complexity reduction estimation, we further show the reduction of full-RD cost calculation for each sequence in Table 9
                     . As indicated in Table 9, the average full-RD search cycle reduction is about 30%, which is consistent with the encoding time saving.

In Table 10
                     , we give a simple comparison between the proposed algorithm and the work in [13]. The proposed method not only reduces more encoding complexity but also incurs less bitrate loss (i.e. less bitrate increase) for synthesized views.

In Table 11
                     , we show the dynamic performance of the proposed algorithm by varying the selection of threshold T. As indicated in Table 11 and Fig. 8
                     , our algorithm can be tuned to achieve a well tradeoff between encoding time saved and performance loss; this makes our algorithm very flexible. From Fig. 8, we also observe that the encoding time speedup tends to be saturated with the increase of 
                        a
                     . The selection of 
                        a
                      is also related to content characteristic of the sequences. If the ratio of SRCV between Bi-Partition modes and conventional intra modes is very big (e.g. more than 50 times for the CG video Undo_Dancer), it is rational to increase 
                        a
                      (
                        a
                     
                     >5) to achieve more encoding time saving. In most of the cases, 
                        a
                     
                     <4 is a good trade off parameter.

Finally, as shown in the last row of Table 6, when we turn off all the Bi-Partition modes, the encoding time saving is 53.7% while the BD-bitrate loss at synthesized views shoots to 7.3%. This result also supports that our fast mode selection algorithm is fairly accurate as we correctly skip most of the unnecessary Bi-Partition modes full-RD cost calculations as demonstrated in Table 5.

A simplified mode selection algorithm for intra depth coding for 3D-HEVC is proposed in this paper. The proposed method avoids unnecessary Bi-Partition modes full-RD cost calculations by using the Smallest Rough-RD Cost Value (SRCV) calculated by HEVC Rough Mode Decision (RMD) as mode selection threshold. Considerable time saving is achieved with negligible bitrate loss. It was reported that for all intra tests, the proposed method achieved a 34.4% encoding time saving with a 0.3% bitrate loss for synthesized views. Moreover, by simply varying the selection threshold, we can adjust the tradeoff between encoding time saving and performance loss, based on the requirements of different applications. It is worth noting that since our algorithm is designed at the mode decision level, it is compactable to other specific Bi-Partition modes simplification algorithms.

On the other hand, since the average SRCV is initialized from the first I-frame, it may not work well when scene change happens since average SRCV could change significantly from scene to scene. One possible solution would be refreshing the average SRCV whenever we have a new I-frame when scene change is detected.

@&#ACKNOWLEDGEMENT@&#

The project was supported in part by HiSilicon Technologies Co., Ltd. under Huawei Technologies grant.

@&#REFERENCES@&#

