@&#MAIN-TITLE@&#Evaluation of an anthropometric shape model of the human scalp

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           The human head shape can be predicted using a statistical shape model.


                        
                        
                           
                           Anthropometric measurements can be used as intuitive parameters for shape models.


                        
                        
                           
                           At least 90 scans are required to build a representative shape model.


                        
                        
                           
                           Measurement errors for the arc length have the least effect on the prediction.


                        
                        
                           
                           Shape models have applications for research and for industrial design.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Computer-aided design

Shape modeling

Anthropometry

@&#ABSTRACT@&#


               
               
                  This paper presents the evaluation a 3D shape model of the human head. A statistical shape model of the head is created from a set of 100 MRI scans. The ability of the shape model to predict new head shapes is evaluated by considering the prediction error distributions. The effect of using intuitive anthropometric measurements as parameters is examined and the sensitivity to measurement errors is determined. Using all anthropometric measurements, the average prediction error is 1.60 ± 0.36 mm, which shows the feasibility of the new parameters. The most sensitive measurement is the ear height, the least sensitive is the arc length. Finally, two applications of the anthropometric shape model are considered: the study of the male and female population and the design of a brain-computer interface headset. The results show that an anthropometric shape model can be a valuable tool for both research and design.
               
            

@&#INTRODUCTION@&#

Parametric shape modeling is a popular technique to describe a population of 3D shapes with a limited set of parameters (Wang, 2005). When applied to the human body, it enables medical doctors, product designers and researchers to study the human body through high-quality 3D representations (Magnenat-Thalmann et al., 2004). For the sake of simplicity, people working in these fields will be referred to as ‘ergonomists’ throughout the remainder of this article. The parameters that yield the most accurate shape predictions of the body are usually found by statistically analyzing a sample of 3D polygonal surfaces. Although the resulting statistical shape models (SSM) accurately describe the object's shape, these statistics are often difficult to interpret and non-intuitive for design specialists. Therefore, several methods have been proposed to compute a new set of parameters to characterize the human body shape. Most of them were focused on the full body (Allen et al., 2003; Wang, 2005; Chu et al., 2010; Baek and Lee, 2012; Wuhrer and Shu, 2012), the face (Blanz and Vetter, 1999) or head (Xi and Shu, 2009). This research shows that head shapes can indeed be predicted from either semantic parameters such as age, gender and ethnicity or from various body size measurements.

While more recent techniques were suggested as solutions for industrial designers (Meunier et al., 2000; Niu et al., 2009; Xi and Shu, 2009; Baek and Lee, 2012), it is not clear how they should interpret and use the results. Custom GUI applications have been suggested, in which the model can be varied according to statistical parameters (Meunier et al., 2009; Zhuang et al., 2013). However, statistical parameters are not intuitive enough to be used by ergonomists. Other suggestions include generating 3D models based on anthropometric measurements and then using these static shapes in 3D software (Lin and Wang, 2012), which is not far off from traditional anthropometry. Furthermore, only the average geometric (i.e. vertex-to-vertex) fit of the shape models to the scanning data was usually validated. While this is a valuable parameter, it only gives a very limited indication of the predictive capabilities of the models. Finally, despite the advent of head-centered products such as EEG-recording devices (Allison et al., 2012), to the best of the authors' knowledge no parametric models to date focus on the scalp.

In this work, a statistical 3D shape model of the human scalp is created and a linear mapping is made between statistical parameters and ten anthropometric measurements. The prediction accuracy of the model is examined by using three different error metrics, i.e. vertex-to-vertex, normal and tangential error. Both the average and point-to-point errors are evaluated for several combinations of anthropometric measurements. Cross-validation is used to verify both the statistical and the anthropometric shape model. The sensitivity the prediction to measurement errors for individual parameters is shown and the effect of measurement errors on the prediction is evaluated. Such extensive analysis will allow ergonomists to select the minimal required set of anthropometric measurements, determine the influence of measurement errors and accurately locate shape variation.

The remainder of this paper is organized as follows. Section 2 describes how the shape model is built, including the segmentation and parametrization of the MRI scans, the principal component analysis (PCA) of the 3D scalp geometry, the selection of the anthropometric measurements, and the correlation between these measurements and the PC weights. In Section 3, the shape model is evaluated in terms of prediction accuracy, the data set size is verified for the statistical as well as the anthropometric model, and the sensitivity of the prediction to measurement errors is discussed. The results are shown in Section 4, as well a discussion on how to select the right anthropometric measurements and an application for anthropometric research and for industrial design. Finally, the conclusion is formulated in Section 5.

@&#METHODS@&#

This section presents the workflow of the methodology that was used to create the anthropometric shape model (see Fig. 1
                     ). Because the input MRI scans contain more information than just the skin surface, they first need to be preprocessed to remove all artefacts and to extract the cranium surface as a geometric surface mesh. This process is described in Section 2.1.1. The surfaces then need to be aligned to each other and be projected into a simpler parameter space for further analysis. This ensures that corresponding points are used throughout the remainder of the methodology, instead of possibly comparing e.g. the tip of the nose with the tip of the earlobe. Section 2.1.2 describes how this was done. The surfaces are then sampled so as to obtain a uniform set of corresponding points on which PCA can be performed to examine the shape variation, as explained in Section 2.1.3. However, as will be discussed in Section 2.2.1, PCs are not intuitive enough to be used as parameters for the model. Therefore, Section 2.2.2 concludes the methodology by showing how ten intuitive measurements can be used instead to analyze the head geometry and predict new head shapes.

100 MRI T1-FFE-weighted MRI scans (50 male, 50 female aged between 20 and 30 years, Western population) were used as input for the shape model. The scans were acquired using a Philips ACS III 1.5 T scanner in the sagittal acquisition plane, with a slice thickness of 1 mm, an echo time of 10 ms, a repetition time of 18 ms and a flip angle of 30°. These scans were obtained from the International Consortium for Brain Mapping (ICBM) database (Capetillo-Cunliffe et al., 2007).

The first step in the processing pipeline was to segment the skin layer. Hereto, the MR images were debiased by Lloyd–Max quantization (Mai et al., 2011) and thresholded for grayscale intensity between 300 and 1800. Connected components labeling (Dillencourt et al., 1992) was used to separate the head from smaller noise artifacts and head fixation braces. Finally, a morphological closing operation was applied to fill cavities such as the ear canals and nostrils. The ensuing surface was then extracted using marching cubes (Lepage and Gore, 2004) and any remaining holes were interpolated using Poisson surface reconstruction (Simmons et al., 1994).

The skin surface of the cranium was extracted as the region of interest, because the aim of this work was to mainly examine the variability of the scalp. To that end, each surface was cut by the shortest path connecting four consecutive points that were manually annotated on each surface: the subnasale (sn), both otobasia inferia (obi1 and obi2) and the inion (i) (see Fig. 2
                           ). The shortest path was determined using fast marching, in which a distance map is first calculated from the one boundary point to the next, followed by gradient descent interpolation from the latter to former (Kimmel and Sethian, 1998). This resulted in a set of surfaces of the same topology 
                              
                                 S
                                 =
                                 
                                    {
                                    
                                       
                                          S
                                          1
                                       
                                       ,
                                       ⋯
                                       ,
                                       
                                          S
                                          
                                             
                                                n
                                                s
                                             
                                          
                                       
                                    
                                    }
                                 
                              
                           , with n
                           
                              s
                            the number of surfaces.

The next step was to correspond the 3D coordinate points of the surfaces to each other, enabling statistical analysis of the 100 scans. The surfaces 
                              S
                            were mapped to a simpler parameter space by a process called surface parametrization. Many parametrization methods exist: if the corresponding surface is disc-like or spherical, a disc or sphere is often taken as the parameter space, while other domains are used for more complex topologies (Huysmans et al., 2010). In this paper, the approach of (Huysmans et al., 2010) was used, with the exception that the head surfaces were mapped to a planer (two-dimensional) rectangle with sides of length 1. The set of parameterizations is 
                              
                                 P
                                 =
                                 
                                    {
                                    
                                       
                                          P
                                          1
                                       
                                       ,
                                       ⋯
                                       ,
                                       
                                          P
                                          
                                             
                                                n
                                                s
                                             
                                          
                                       
                                    
                                    }
                                 
                              
                           ; where 
                              
                                 
                                    P
                                    j
                                 
                              
                            is a parametrization for a surface 
                              
                                 
                                    S
                                    j
                                 
                              
                            only if its nodes, edges and faces are embedded in the rectangular planar domain and have a one-to-one correspondence to those of 
                              
                                 
                                    S
                                    j
                                 
                              
                           . The mapping 
                              
                                 ϕ
                                 :
                                 S
                                 →
                                 P
                              
                            between the parameterizations 
                              P
                            and surfaces 
                              S
                            was calculated by defining each point in 
                              
                                 
                                    P
                                    j
                                 
                              
                            as a linear combination of its neighbours (Floater, 1997). The resulting system of linear equations only has a unique solution if ϕ satisfies the Laplace equation Δϕ = 0 on the interior of 
                              S
                           . Once ϕ is defined on the boundary of 
                              S
                           , the system can be solved using finite element analysis as in (Floater, 2003).

With the parameterizations well defined, point-to-point correspondence is the next step. A group-wise correspondence optimization was performed (Huysmans et al., 2010), resulting in high-quality correspondences and a compact model. This method consisted of two steps: a rigid optimization in which the surfaces were aligned, and a non-rigid optimization in which the parameterizations were locally deformed while the surfaces were kept optimally aligned, resulting in new parameterizations 
                              P
                            and transformed surfaces 
                              S
                           . Fig. 3
                            shows the parametrization process and the correspondence optimization in more detail. Since there are no points to correspond below the boundary, the surfaces are aligned mainly according to the scalp region. The corresponded surfaces of all 100 scans used in this paper can be downloaded from http://www.visielab.ua.ac.be/sites/default/files/research_topic_files/shape-matrix_29910-coordinates_x_100-surfaces_0.xlsx.

The corresponding parameterizations were used for statistical analysis of the underlying shapes. Each surface was sampled in the parameter space 
                              
                                 P
                                 ≡
                                 
                                    
                                       [
                                       0,1
                                       ]
                                    
                                    2
                                 
                              
                            with a set of landmarks that resulted in a uniform distribution of landmarks over the average scalp. The 3D coordinates of these landmarks were concatenated into a vector 
                              
                                 
                                    
                                       
                                          x
                                          ˙
                                       
                                    
                                    i
                                 
                                 =
                                 
                                    [
                                    
                                       
                                          v
                                          
                                             i
                                             ,
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          v
                                          
                                             i
                                             ,
                                             
                                                n
                                                p
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 =
                                 
                                    [
                                    
                                       
                                          x
                                          
                                             i
                                             ,
                                             1
                                          
                                       
                                       ,
                                       
                                          y
                                          
                                             i
                                             ,
                                             1
                                          
                                       
                                       ,
                                       
                                          z
                                          
                                             i
                                             ,
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          x
                                          
                                             i
                                             ,
                                             
                                                n
                                                p
                                             
                                          
                                       
                                       ,
                                       
                                          y
                                          
                                             i
                                             ,
                                             
                                                n
                                                p
                                             
                                          
                                       
                                       ,
                                       
                                          z
                                          
                                             i
                                             ,
                                             
                                                n
                                                p
                                             
                                          
                                       
                                    
                                    ]
                                 
                              
                            with n
                           
                              p
                            the number of landmarks. A 3n
                           
                              p
                            × n
                           
                              s
                            shape matrix X was then defined as 
                              
                                 [
                                 
                                    
                                       
                                          x
                                          ˙
                                       
                                    
                                    1
                                    T
                                 
                                 ,
                                 ⋯
                                 ,
                                 
                                    
                                       
                                          x
                                          ˙
                                       
                                    
                                    
                                       
                                          n
                                          s
                                       
                                    
                                    T
                                 
                                 ]
                              
                            (with n
                           
                              s
                            the number of shapes) and zero-centered by subtracting the row-wise mean 
                              
                                 
                                    x
                                    ¯
                                 
                              
                            from each element for each respective surface:
                              
                                 (1)
                                 
                                    
                                       
                                          X
                                          c
                                       
                                       =
                                       
                                          [
                                          
                                             
                                                
                                                   
                                                      x
                                                      ˙
                                                   
                                                
                                                1
                                                T
                                             
                                             −
                                             
                                                
                                                   
                                                      x
                                                      ¯
                                                   
                                                
                                                T
                                             
                                             …
                                             
                                                
                                                   
                                                      x
                                                      ˙
                                                   
                                                
                                                
                                                   
                                                      n
                                                      s
                                                   
                                                
                                                T
                                             
                                             −
                                             
                                                
                                                   
                                                      x
                                                      ¯
                                                   
                                                
                                                T
                                             
                                          
                                          ]
                                       
                                    
                                 
                              
                           
                        

After applying PCA, each scalp can be represented as follows:
                              
                                 (2)
                                 
                                    
                                       
                                          x
                                          ′
                                       
                                       =
                                       
                                          
                                             x
                                             ¯
                                          
                                       
                                       +
                                       
                                          ∑
                                          
                                             j
                                             =
                                             1
                                          
                                          
                                             
                                                n
                                                s
                                             
                                             −
                                             1
                                          
                                       
                                       
                                          P
                                          j
                                       
                                       
                                          b
                                          j
                                          ′
                                       
                                       =
                                       
                                          
                                             x
                                             ¯
                                          
                                       
                                       +
                                       P
                                       
                                          b
                                          ′
                                       
                                    
                                 
                              
                           where x
                           ′ is a column vector containing the vertex coordinates of the scalp, P a 3n
                           
                              p
                            × (n
                           
                              s
                            − 1) orthonormal matrix containing the principal component vectors as columns, and b′ a (n
                           
                              s
                            − 1) × 1 column vector of weights of the respective PCs. By modifying the principal component weights b′, new scalp surfaces can be constructed. Hence, Eq. (2) represents a shape model that is parameterized by the PC weights.

The first five PCs are shown in Fig. 4
                           . Unfortunately, PC weights do not provide an intuitive description of the shape of the scalp because the principal components have no clear physical interpretation (e.g., ‘volume’ or ‘size’). This leads to ambiguous definitions and clearly shows the need for a new set of intuitive parameters, i.e. anthropometric measurements. NEN-EN-ISO 7250.

Anthropometric measurements are usually defined according to standards which are based on the work of Rudolf Martin (Martin and Saller, 1957) in Europe, e.g. The measurements are taken with respect to the Frankfurt plane, which is defined as the plane passing through the lower points of both eye sockets (in this work, the lowest point of the left eye socket (or) is used) and both tragia (t1 and t2) (Cheng et al., 2012). The other reference planes, the midsagittal and the transversal planes, are perpendicular to this plane (see Fig. 2). (For interpretation of the references to color in this figure legend, the reader is referred to the web version of this article.)

The following measurements were selected (see Fig. 2):
                              
                                 
                                    Head length (HL): glabella (g) to ophistokranion (op) distance.


                                    Face width (FW): left ektokanthia (ek1) to right ektokanthia (ek2) distance.


                                    Bitragion width (BW): left tragion (t1) to right tragion (t2) distance.


                                    Ear height (EH): sub-aurale (sba) to super-aurale (sa) distance.


                                    Projected ear height (PE): sub-aurale (sba) to super-aurale (sa) distance, projected on the midsagittal plane.


                                    Vertical position of the ear (VE): left tragion (t1) to vertex (v) distance, projected on midsagittal plane.


                                    Horizontal position of the ear (HE): left tragion (t1) projected on midsagittal plane to ophistokranion (op) distance, projected on Frankfurt plane.


                                    Head circumference (CF): the length of the intersection of the head surface and the plane perpendicular to the midsagittal plane and going through the glabella (g) and ophistokranion (op).


                                    Arc length (AL): measured over the surface of the head, from glabella (g) to inion (i) on the midsagittal plane.


                                    Arc width (AW): measured over the surface of the head, from tragion (t1) to tragion (t2) and perpendicular to the transversal plane (see below).

The measurements were performed on the input surfaces and concatenated into a vector f
                           
                              i
                            = [f
                           
                              i,1,…,f
                           
                              i,nm
                           ] for each surface 
                              
                                 
                                    S
                                    i
                                 
                              
                           , with n
                           
                              m
                            the number of measurements, and combined into a n
                           
                              m
                            × n
                           
                              s
                            measurement matrix 
                              
                                 F
                                 =
                                 
                                    [
                                    
                                       
                                          f
                                          i
                                          T
                                       
                                       ,
                                       …
                                       ,
                                       
                                          f
                                          
                                             
                                                n
                                                s
                                             
                                          
                                          T
                                       
                                    
                                    ]
                                 
                              
                           . The results of the measurements for the population head scans are summarized in Table 1
                           . The full measurements for all 100 scans can be downloaded as a labeled spreadsheet from http://www.visielab.ua.ac.be/sites/default/files/research_topic_files/anthropometric_measurements_0.xlsx, and as the data matrix used throughout this work from 
                           http://www.visielab.ua.ac.be/sites/default/files/research_topic_files/feature-matrix_10-measurements_x_100-surfaces_0.xlsx.

Next, the correlation between the anthropometric measurements and the PCs was studied. For this purpose, the multivariate regression approach of Allen et al. (Allen et al., 2003) was used. A linear method was chosen because it can be implemented using linear matrix operations, which are easy to calculate and allow for low delay dynamic interaction with the resulting shape model. An (n
                           
                              s
                            − 1) × (n
                           
                              m
                            + 1) mapping matrix M was calculated as follows:
                              
                                 (3)
                                 
                                    
                                       M
                                       =
                                       B
                                       
                                          
                                             
                                                F
                                                ˙
                                             
                                          
                                          +
                                       
                                    
                                 
                              
                           
                        


                           B is a (n
                           
                              s
                            − 1) × n
                           
                              s
                            matrix containing the weight vectors corresponding to the measurements for each PC, as calculated in Section 2.1.3. To account for y-intercepts in the regression, a row of ones was appended to the measurement matrix F, represented as (n
                           
                              m
                            + 1) × n
                           
                              s
                            matrix 
                              
                                 
                                    F
                                    ˙
                                 
                              
                           , with pseudo-inverse 
                              
                                 
                                    
                                       
                                          F
                                          ˙
                                       
                                    
                                    +
                                 
                              
                           . For the purpose of this paper, n
                           
                              s
                            = 100, n
                           
                              p
                            = 10000 and n
                           
                              m
                            = 10. Once the mapping matrix was obtained, it was possible to calculate a weight vector b′ for a new set of measurements 
                              
                                 
                                    f
                                    '
                                 
                                 =
                                 
                                    [
                                    
                                       
                                          f
                                          1
                                          ′
                                       
                                       ,
                                       …
                                       ,
                                       
                                          f
                                          
                                             
                                                n
                                                m
                                             
                                          
                                          ′
                                       
                                       ,
                                       1
                                    
                                    ]
                                 
                              
                           :
                              
                                 (4)
                                 
                                    
                                       
                                          b
                                          ′
                                       
                                       =
                                       M
                                       
                                          f
                                          
                                             ′
                                             T
                                          
                                       
                                    
                                 
                              
                           
                        

In order to create a new surface using custom anthropometric measurements, the new b′ is simply inserted into Eq. (2) to obtain a new shape 
                              
                                 
                                    x
                                    ′
                                 
                                 =
                                 
                                    [
                                    
                                       
                                          v
                                          
                                             i
                                             ,
                                             1
                                          
                                          ′
                                       
                                       ,
                                       …
                                       ,
                                       
                                          v
                                          
                                             i
                                             ,
                                             
                                                n
                                                p
                                             
                                          
                                          ′
                                       
                                    
                                    ]
                                 
                                 =
                                 
                                    [
                                    
                                       
                                          x
                                          
                                             i
                                             ,
                                             1
                                          
                                          ′
                                       
                                       ,
                                       
                                          y
                                          
                                             i
                                             ,
                                             1
                                          
                                          ′
                                       
                                       ,
                                       
                                          z
                                          
                                             i
                                             ,
                                             1
                                          
                                          ′
                                       
                                       ,
                                       …
                                       ,
                                       
                                          z
                                          
                                             i
                                             ,
                                             3
                                             
                                                n
                                                p
                                             
                                          
                                          ′
                                       
                                    
                                    ]
                                 
                              
                           :
                              
                                 (5)
                                 
                                    
                                       
                                          x
                                          ′
                                       
                                       =
                                       
                                          
                                             x
                                             ¯
                                          
                                       
                                       +
                                       P
                                       
                                          b
                                          ′
                                       
                                       =
                                       
                                          
                                             x
                                             ¯
                                          
                                       
                                       +
                                       P
                                       M
                                       
                                          f
                                          
                                             ′
                                             T
                                          
                                       
                                    
                                 
                              
                           
                        

Thus, the shape model can now also be parametrized according to the anthropometric measurements and will be further referred to as the anthropometric model.

@&#EXPERIMENTS@&#

In this section, the anthropometric shape model built in Section 2 is evaluated. First, a number of error metrics are introduced in Section 3.1.1 that will be used throughout the rest of the work to determine the accuracy of each prediction. The overall prediction quality is assessed in Section 3.1.2, for anthropometric models built with single measurements or with combinations of them. In order to examine the generalization ability of the models, cross-validation analysis is performed on the PCA model from Section 2.1.3 and the anthropometric model from Section 2.2.2 in Sections 3.2.1 and 3.2.2, respectively. Finally, since errors due to human error or due to equipment properties sometimes occur when measuring subjects, Section 3.3 discusses the sensitivity of each of the anthropometric measurements to measurement errors.

To assess the accuracy of the prediction of a given shape model, three distance metrics were introduced: the geometric d
                           
                              g
                           , the normal d
                           
                              n
                           , and the tangential error d
                           
                              t
                           , between a point v on the original surface and the corresponding point v
                           ' on the mapped surface (see Fig. 5
                           ):
                              
                                 (6)
                                 
                                    
                                       
                                          d
                                          g
                                       
                                       
                                          (
                                          
                                             v
                                             ,
                                             
                                                v
                                                ′
                                             
                                          
                                          )
                                       
                                       =
                                       
                                          |
                                          
                                             v
                                             −
                                             
                                                v
                                                ′
                                             
                                          
                                          |
                                       
                                    
                                 
                              
                           
                           
                              
                                 (7)
                                 
                                    
                                       
                                          d
                                          n
                                       
                                       
                                          (
                                          
                                             v
                                             ,
                                             
                                                v
                                                ′
                                             
                                          
                                          )
                                       
                                       =
                                       
                                          |
                                          
                                             
                                                (
                                                
                                                   v
                                                   −
                                                   
                                                      v
                                                      ′
                                                   
                                                
                                                )
                                             
                                             ·
                                             
                                                n
                                                v
                                             
                                          
                                          |
                                       
                                    
                                 
                              
                           
                           
                              
                                 (8)
                                 
                                    
                                       
                                          d
                                          t
                                       
                                       
                                          (
                                          
                                             v
                                             ,
                                             
                                                v
                                                ′
                                             
                                          
                                          )
                                       
                                       =
                                       
                                          
                                             
                                                d
                                                g
                                             
                                             
                                                
                                                   
                                                      (
                                                      
                                                         v
                                                         ,
                                                         
                                                            v
                                                            ′
                                                         
                                                      
                                                      )
                                                   
                                                
                                                2
                                             
                                             −
                                             
                                                d
                                                n
                                             
                                             
                                                
                                                   
                                                      (
                                                      
                                                         v
                                                         ,
                                                         
                                                            v
                                                            ′
                                                         
                                                      
                                                      )
                                                   
                                                
                                                2
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

To assess the quality of a shape model prediction, the errors need to be combined into a single meaningful number. To this end, the vertex errors are averaged into the shape geometric errors 
                              
                                 
                                    D
                                    g
                                 
                                 
                                    (
                                    
                                       
                                          S
                                          i
                                       
                                    
                                    )
                                 
                              
                            as follows:
                              
                                 (9)
                                 
                                    
                                       
                                          D
                                          g
                                       
                                       
                                          (
                                          
                                             
                                                S
                                                i
                                             
                                          
                                          )
                                       
                                       =
                                       
                                          1
                                          
                                             
                                                n
                                                p
                                             
                                          
                                       
                                       
                                          ∑
                                          
                                             v
                                             ∈
                                             
                                                S
                                                i
                                             
                                          
                                       
                                       
                                          d
                                          g
                                       
                                       
                                          (
                                          
                                             v
                                             ,
                                             
                                                v
                                                ′
                                             
                                          
                                          )
                                       
                                       
                                       ∀
                                       i
                                       =
                                       1
                                       ,
                                       ⋯
                                       ,
                                       
                                          n
                                          s
                                       
                                    
                                 
                              
                           
                        

Finally, the average of the shape geometric errors for a set of shapes 
                              S
                            is calculated for each mapping, resulting in the model geometric error 
                              
                                 
                                    E
                                    g
                                 
                                 
                                    (
                                    S
                                    )
                                 
                              
                           :
                              
                                 (10)
                                 
                                    
                                       
                                          E
                                          g
                                       
                                       
                                          (
                                          S
                                          )
                                       
                                       =
                                       
                                          1
                                          
                                             
                                                n
                                                s
                                             
                                          
                                       
                                       
                                          ∑
                                          
                                             
                                                S
                                                i
                                             
                                             ∈
                                             S
                                          
                                       
                                       
                                          D
                                          g
                                       
                                       
                                          (
                                          
                                             
                                                S
                                                i
                                             
                                          
                                          )
                                       
                                    
                                 
                              
                           
                        

Furthermore, the error metrics were also calculated per point, resulting in a vector 
                              
                                 
                                    e
                                    g
                                 
                                 =
                                 
                                    [
                                    
                                       
                                          e
                                          g
                                          
                                             
                                                (
                                                1
                                                )
                                             
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          e
                                          g
                                          
                                             
                                                (
                                                
                                                   
                                                      n
                                                      p
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                    ]
                                 
                              
                            of average point geometric errors, which can be used to visually locate the prediction errors of the model:
                              
                                 (11)
                                 
                                    
                                       
                                          e
                                          g
                                          
                                             
                                                (
                                                j
                                                )
                                             
                                          
                                       
                                       =
                                       
                                          1
                                          
                                             
                                                n
                                                s
                                             
                                          
                                       
                                       
                                          ∑
                                          
                                             
                                                S
                                                i
                                             
                                             ∈
                                             S
                                          
                                       
                                       
                                          d
                                          g
                                       
                                       
                                          (
                                          
                                             
                                                v
                                                
                                                   i
                                                   ,
                                                   j
                                                
                                             
                                             ,
                                             
                                                v
                                                
                                                   i
                                                   ,
                                                   j
                                                
                                                ′
                                             
                                          
                                          )
                                       
                                       
                                       ∀
                                       i
                                       =
                                       1
                                       ,
                                       ⋯
                                       ,
                                       
                                          n
                                          s
                                       
                                       ;
                                       j
                                       =
                                       1
                                       ,
                                       ⋯
                                       ,
                                       
                                          n
                                          p
                                       
                                       ;
                                       
                                          v
                                          i
                                       
                                       ∈
                                       
                                          S
                                          i
                                       
                                    
                                 
                              
                           
                        

Two approaches were considered for the calculation of the standard deviation. By taking the standard deviation over all 
                              
                                 
                                    D
                                    g
                                 
                                 
                                    (
                                    
                                       
                                          S
                                          i
                                       
                                    
                                    )
                                 
                              
                           , one can gain insight on how the prediction errors vary across the entire population. The standard deviation over all vertex errors instead gives more information on the local error variation. The former was deemed to be of more use in evaluating the feasibility of a shape model for design purposes and was therefore used throughout most of this paper.

The model, shape, and point normal error 
                              
                                 
                                    E
                                    n
                                 
                                 
                                    (
                                    S
                                    )
                                 
                              
                            and tangential error 
                              
                                 
                                    E
                                    t
                                 
                                 
                                    (
                                    S
                                    )
                                 
                              
                            are calculated analogously.

Apart from the sensitivity for each anthropometric measurement, the prediction errors of the mapping using several combinations of measurements were also taken into account. First, an anthropometric shape model was built for the entire input population, using only one individual measurement to calculate the mapping (Eq. (3)). The scalp shapes of the entire population (Eq. (4)) were predicted with this mapping. Each of the 100 predicted shapes was calculated by creating a model using the 99 remaining shapes and predicting the shape based on the measurements. The average geometric, tangential and normal errors 3.1.1 over all 100 scalp shapes were used to compare the prediction accuracy of each anthropometric measurement. In the same way, predictions were calculated for anthropometric models using all 1022 possible combinations of anthropometric measurements. This supports the creation of an anthropometric shape model with a minimal number of parameters.

To verify the robustness of the PCA model of Section 2.1.3, repeated random sub-sampling was applied. Subsets of 10, 20, …, 90 scans were randomly selected from the 100 scans. PCA was performed on each subset (see Section 2.1.3), resulting in a PC matrix 
                              
                                 
                                    P
                                    t
                                    T
                                 
                              
                            and an average surface 
                              
                                 
                                    
                                       
                                          x
                                          ¯
                                       
                                    
                                    t
                                 
                              
                           . One additional surface x
                           
                              v
                            was randomly selected from the original data set (excluding the scans in the subset) to serve as validation data. The PC weights b
                           
                              v
                            for x
                           
                              v
                            were calculated as follows:
                              
                                 (12)
                                 
                                    
                                       
                                          b
                                          v
                                       
                                       =
                                       
                                          P
                                          t
                                          T
                                       
                                       
                                          (
                                          
                                             
                                                x
                                                v
                                             
                                             −
                                             
                                                
                                                   
                                                      x
                                                      ¯
                                                   
                                                
                                                t
                                             
                                          
                                          )
                                       
                                    
                                 
                              
                           
                        

A new surface was then created by inserting the PC weights b
                           
                              v
                            in Eq. (2). The resulting surface is a restriction of the original shape to the space spanned by the PCs of the trained PCA model. The shape geometric errors (see Section 3.1.1) between this restricted surface and the validation surface x
                           
                              v
                            were then calculated. The above procedure was repeated for 1000 iterations. Finally, the average and standard deviation of all 1000 shape geometric errors were calculated for each of the subsets. Since the projection error contributes to the mapping error, it was important to ensure that it was in the range of the original resolution of the MRI scans (1 mm).

Next, the generalization ability of the anthropometric model using the mapping of Section 2.2.2 was examined. This was done in a similar way to Section 3.2.1, with the exception that a mapping was constructed between the PC weights and the measurements using Eq. (3) of the training data. This mapping was then used to predict the shape of a randomly selected scalp surface (excluded from the training data). The geometric error between the predicted surface and the original surface was used to assess the robustness of the mapping.

The prediction error of the anthropometric model is influenced by the skills of the practitioner (Kouchi et al., 1999; Kouchi and Mochimaru, 2011), the precision of the equipment and the measurement method (direct measurement, measurement from 2D images or from 3D images) (Yu et al., 2013). Therefore, the sensitivity of the prediction to measurement errors ought to be examined. In this section, a distinction is made between the anthropometric measurement (e.g. head length) and the measurement value (e.g. 190 mm). In order to obtain a single factor to express the sensitivity for each anthropometric measurement, a Monte Carlo analysis was performed on a full anthropometric model. Assuming that physical measurement errors follow a normal distribution, a range of normally distributed errors were added to the value of each anthropometric measurement, and a number of surfaces was predicted using the aberrated measurements. The prediction errors for these surfaces were averaged over 1000 trials for each step in the error range and a regression line was fitted to the averages and standard deviations.

@&#RESULTS AND DISCUSSION@&#

In this section, the results are shown. First, the data set size and region of interest are discussed in Section 4.1. A quantitative and qualitative analysis of the shape model is made in Section 4.2, and the selection of the right anthropometric models for a desired prediction accuracy is discussed. Two applications are discussed at the end of the chapter, Section 4.3 demonstrates a comparison between the male and female head shape, Section 4.4 explores the design of the brain-computer interface using an anthropometric shape model.

A data set of MRI scans was used as input because of several reasons. Firstly, the high availability of MRI data, e.g. in university hospitals, eliminates the need for volunteer recruitment and time-consuming scanning sessions. As opposed to CT, MRI does not operate with ionizing fields (Formica et al.,). Furthermore, extracting the skin layer directly means that there is no image occlusion due to hair. If necessary, the hair could be modeled separately. Alternatively, one might want to examine the effect of ethnicity, e.g. by considering scans from the Chinese population (Ball et al., 2010). As long as the data can be extracted as a polygon surface, the presented methodology can be extended to other input data sets.


                           Fig. 6
                            (left) shows the average and standard deviation of the geometric error for the PCA model, as defined in Section 3.2.1. The geometric error levels at 0.64 ± 0.12 mm for 100 shapes, indicating a proper approximation (around 1 mm) of the head shape for the given population. Furthermore, the fact that there is a linear correlation between the PCs and the anthropometric measurements is supported by the outcome of the procedure in Section 3.2.2: when using the anthropometric shape model for prediction, the geometric error again levels for 100 shapes, this time at 1.52 ± 0.37 mm. The results are plotted in Fig. 6 (right).

The three error metrics provide distinctly different information that benefits the interpretation of the prediction. The geometric error d
                           
                              g
                            is the most obvious one, and is commonly used in geometric modeling to determine the linear distance between an original and a predicted point. As such, it offers information on the spatial location of points in the prediction. In general, the higher this distance, the worse the prediction is considered to be. However, it contains no information on the direction in which the point has moved between predictions. The normal error d
                           
                              n
                           , on the other hand, shows whether the predicted point has moved towards the inside or outside of the shape. This knowledge is useful for fixation purposes: a higher normal error means that it is uncertain whether the retention system (e.g. a hinge or a spring system) will be able to provide the right amount of flexibility. A designer will then either have to choose other fixation regions or another anthropometric model. Finally, the tangential error d
                           
                              e
                            expresses how much the point has moved along the surface of the shape. The higher this number, the larger the contact area between a product and the head will have to be. If it is too high, this requirement might result in overlapping contact areas. This is problematic for sensor application, e.g. for EEG-electrodes. The three measures combined provide information for a wide range of applications and can be used both to evaluate the feasibility of a given shape model and to assist in the determination of product specifications.

As discussed in Sections 1 and 2.2.1, there is a clear need for a shape model parametrized by simple, intuitive parameters when head product design is envisaged. The prediction errors (see Section 3.1.1) for individual measurements are summarized in Table 2
                           , the errors for various combinations in Table 3
                           . The required number and combination of measurements will depend on the intended application. For example, if a geometric error of no more than 2.5 ± 0.1 mm on average is acceptable, one might use the head length, circumference or bitragion width individually to predict the three dimensional shape of a customer's head and create a 3D design.

Sometimes, an ergonomist will only have a limited set of physical measuring tools (e.g. calipers) at hand. In these cases, using a subset measurements would be preferred to finding the tools necessary to acquire all measurements. However, this advantage comes at a price: the average geometric prediction errors increase to 1.80 ± 0.47 mm, as shown in Tables 4 and 7
                           
                           
                           
                           .

If the prediction error should be lower (e.g. for personalized EEG devices), more anthropometric measurements will be required, as shown in Table 3. A surprising fact from this table is that the best prediction, with a geometric error of 1.38 ± 0.27 mm, a normal error 1.27 ± 0.26 mm, and a tangential error 0.15 ± 0.03 mm is achieved by using eight measurements, leaving out ear height and projected ear height. As of yet, it is not clear whether this is due to the segmentation process or because the anthropometry of the ear is actually not related to that of the head. Therefore, the current dataset cannot be used for designs that rely on detailed description of the ear geometry.

Another parameter to consider is the desired percentage of the population that the model should cover for a selected prediction error. This can be visualized by plotting the cumulative distribution function (CDF), as in Fig. 7
                           . For example, while the combination of head length and bitragion width offers an average geometric error of 1.88 ± 0.50 mm, Fig. 7 (top left) shows that less than 70 percent of the population will actually have a geometric error lower than 2 mm. This might suffice for designs which aim to incorporate a higher amount of customizability, but it will not be enough for highly personalized products with fewer customization options. In the latter case, a combinations covering a higher percentage will be preferred, e.g. head length, bitragion width, circumference, arc length and arc width (80 percent, see Fig. 7, top right).

Finally, the sensitivity of the anthropometric model to measurement errors, as explained in Section 3.3, should be taken into account. The results of the regression on prediction errors induced by measurement errors are listed in Table 5. Multiplying the slopes of these lines with an expected measurement error provides an estimate of the geometric error and standard deviation of the resulting shape model. While the head length and circumference both yield the very low individual prediction errors, head length is also more sensitive to measurement errors than circumference. Because the mapping was created using digital measurements, errors for measurements from digital surfaces will be smaller than those from physical measurements with calipers and measuring tapes. In this case, the sensitivity will be a less influential factor and a small number of anthropometric measurements can be used to build the anthropometric model (e.g. head length and bitragion width). In contrast, when performing physical measurements, it is advisable to include anthropometric measurements with lower sensitivity and lower geometric errors in the anthropometric model (e.g. circumference, arc length and arc width). Again, ear height and projected ear height seem to be the most sensitive. Seeing as they also offer the worst individual prediction errors, the authors do not recommend using these as parameters for scalp-based designs.

The average point geometric errors for all 100 predicted shapes are shown as a color map on the average head shape in Fig. 8
                           . The figure shows the errors for the model using all measurements and for several combinations. The predictions on the forehead and the temporal regions seem to degrade when using less anthropometric measurements, which is especially clear for the combination of head length and bitragion width. The error metrics give a rough indication of the direction and magnitude of the prediction errors. The color map makes it possible to locate the measurement errors and to inform ergonomists which areas need extra attention and testing. For example, areas with a low normal error allow for product parts that fit closely to the skin, while areas with a high normal error might need additional cushioning.

The high errors at the boundary result from the fact that the surfaces are aligned using the corresponding points in the upper region of the head and more variation is expected at the lower side, as explained in Section 2.1.2. Because the region of interest of the scalp, the bias is acceptable.


                           Fig. 9
                            shows some examples of shapes resulting from the mapping using all measurements. As long as the input range stays within three standard deviations of the mapped PC weights, realistic head shapes can be obtained. The variability of the underlying shapes can be visualized according to the tensor Frobenius norm of the landmark covariance matrix (GolubVan Loan, 1996). A color map of this norm overlaid on the average head shape is shown in Fig. 10
                           .

For this application, separate shape models were created for the male and female subgroups of the sample. The distribution of the PC weights for the entire population were separated into male and female subsets and statistically compared to find out which ones differ the most between the groups. The anthropometric measurements were also compared to discover which ones are best suited for characterizing male and female head shapes. A summary of the anthropometric measurements for the male and female parts of the population are shown in Table 6.


                        Table 7 shows that the most significantly different measurements (according to the Welch's t-test) are head length, bitragion width and circumference, which also offer the lowest individual prediction errors.

The first principal component seems to be the most significant one, see Table 8
                        . This is supported by Fig. 11
                        , where the average male and average female head are depicted, together with the distance between the respective shapes. For the sample means, the overall size of the clearly head seems to vary, which indeed corresponds to the first PC (see Fig. 4). Furthermore, the distance between the shapes seems to be the highest on the forehead, above the eyebrows. (As explained in Section 4.2.3, the higher error at the boundary is due to the correspondence algorithm.)

After this, the prediction errors for both models were first calculated separately as in Section 3.1.2. Because using the full shape model of 100 shapes to predict the 50 male or female shapes would inevitably result in a better comparison, 25 male and 25 female scans were randomly removed from the full shape model to create a mixed gender shape model. The mixed gender model was used to predict the remaining 25 male and 25 female shapes. This procedure was then repeated using the latter shapes as training data and the former ones for validation. The resulting predictions errors were then averaged. Finally, the predictions of the male shapes by a completely female shape model and the predictions of the female shapes by a male model were also calculated for comparison.

The results of the shape predictions are shown in Fig. 12
                         and Fig. 13
                        . As expected, the prediction of the male shapes by the male models offers a lower geometric error (1.71 ± 0.34 mm) than the prediction of the male shapes by the mixed model (1.89 ± 0.47 mm), and the prediction of the female shapes by the female model a lower one (1.62 ± 0.34 mm) than that of the female shapes by the mixed model (1.82 ± 0.47 mm). Furthermore, Figs. 12 and 13 show that when using a mixed model to predict either gender, most of the errors are concentrated at the eyebrow ridge, around the glabella.

The observations in this chapter support earlier literature that concludes male and female head shape differ mostly in overall size (Zhuang et al., 2010) and in the size of supraorbital ridge (Lee et al., 2010; Anibor et al., 2011). The same analysis could be performed to compare subsets of different ages and ethnicities. Unfortunately, the current data set does not contain information on the ethnicity of the subjects.

In this chapter, an application of the model for industrial design will be discussed. One product that would benefit from design using anthropometric shape models, is an EEG-monitoring headset for Brain-Computer Interfacing (BCI) (Brunner et al., 2011). One of the main challenges in BCI design is creating an EEG-monitor that is at the same time comfortable, easy to use, and accurate. These requirement can only be met if designers can properly accommodate for the variability of the head. An anthropometric shape model can be used to achieve the desired level of accuracy. To demonstrate this, a prototype headset was created using a custom plugin for SolidWorks (D. S. S. Corp, 2014). This plugin allows importing a shape model as a B-spline surface and parametrizing it according to a number of anthropometric features (Christis, 2013). Certain points of a CAD design can be linked to parametric head and will automatically adapt when it's dimensions are changed.

To create the BCI headset, the designer will first need to determine what the product should look like and how it should be fixated on the head. For instance, people generally do not prefer pressure on the temporal regions. Thus, a retention system that puts pressure on the frontal and occipital regions of the scalp is ideal. Using the color maps in Fig. 8, he can determine if a given shape model offers an accurate prediction on these region of interest. For this purpose, he needs to know how much error is acceptable on individual predictions. Say the customer is paralysed and wishes to use a BCI for assisted communication. Seeing as the patient will wear the headset for extended periods of time, the comfort and the fit are very important. In this case, the lowest possible prediction error will need to be achieved. As discussed in the paper, the lowest prediction error occurs for shape models parametrized by all of the measurements minus the ear length and projected ear length. While it will take some time to perform the remaining eight measurements, this process will only need to be performed once and thus speed is not as important as accuracy. The designer then predicts the user's individual head shape using the shape model and design a product using the head shape as a mannequin. An example of such a product is shown in Fig. 14
                         for three different shape predictions, with electrodes at locations Fpz1, Fpz2 and Oz according to the international 10-20 system (Oostenveld and Praamstra, 2001). While the shape of the headset is changed according to each individual prediction, the electrodes will remain at the proper positions. This is due to the fact that the electrode contact points have been linked with the shape model. The designer therefore does not have to realign the design for each new user. Instead, he has only to adapt the curvature of the headset's upper brace. Depending on the prediction error derived from Table 3, an extra layer of cushioning can be added to this product in order to ensure optimal fit and comfort.

Alternatively, a BCI headset might be required by a research lab in order to prototype BCI-software. In this case, a more generic product is preferable. The designer now needs to create an adjustable headset, using as few parameters as possible to predict the optimal size of the head. Based on the results in Tables 2 and 3, the designer selects head length and circumference as parameters. Comfort or fit is not as important in this case as the subject will only be wearing the device for a short time, so a higher prediction error is allowed. However, researchers might be in a hurry to set up the experiment and be less precise when performing the measurements. It is therefore in their best interest to select measurements that are not too sensitive to measurement errors. Upon considering Table 5, the designer decides to use arc length instead of head length. He then creates a 3D design by varying the two parameters within certain ranges and making sure the product offers the right amount of adjustability. Using Fig. 7, he knows this design will accommodate at least 75% of the population. An example of the final result is shown in Fig. 15
                        . Customizability can be achieved by turning the knob on the back of the head. Even though certain parts of the headset do not make contact with all user's heads, the electrodes remain at the proper positions, so measurement accuracy is not compromised. Furthermore, markings can be made on the knob to indicate the position to which it should be adjusted for different head sizes. The researcher can thus simply use a look-up-table or computer program to instantly find the proper adjustment for a specific test subject. This eliminates the need to rely on trial-and-error and decreases the preparation time required for the experiment.

The above discussion gives a limited description of how the shape model can be used to design one type of products. Other products that might benefit from anthropometric model design are sports and safety helmets, glasses, smart textiles and near-body sensors. A complete description of the design process using anthropometric shape models is out of scope for this paper, but will be the theme of future work.

@&#CONCLUSION@&#

This work describes a method to create an anthropometric shape model from 100 MRI scans that can be used to accurately predict and analyze the shape of the human scalp for a Western population. The shape model was parametrized by the anthropometric features head length, face width, bitragion width, ear height, horizontal position of the ear, vertical position of the ear, projected ear height, circumference, arc length and arc width. Several combinations of these anthropometric measurements offer good predictions, but the best one is obtained by combining all of them except for the ear height or projected ear height: 1.60 ± 0.36 mm. The sample size was verified using a cross-validation analysis on the anthropometric model, which revealed that the average geometric error levels at a sample size of 90 individuals. The sensitivity of the model to errors in input measurements was analyzed and it was shown that the arc length measurement is the least sensitive to measurement errors, while the (projected) ear height is the most sensitive one. Furthermore, the ear height seems to have no correlation with the overall shape of the head. It is not clear whether this is due to actual physical properties or due to the effect of the morphological operations that are applied to the input scans. It was shown that 3D scalp shapes generated with the proposed method look realistic and retain all information on the variability of the entire head. However, when the input measurements lie in extreme ranges or when an incompatible combination of values is used, realism is no longer guaranteed. Further research is needed to find the correlations between all anthropometric measurements values and to determine the correct input boundaries.

Two use cases were demonstrated for the model. The first case is an application for anthropometric research, discussing the shape variability between the male and female scalp. Using the anthropometric shape model, it was shown that the main difference between male and female head shapes is the overall size or volume of the head. Furthermore, when predicting a female scalps shape with a male shape model or vice versa, most errors seem to be located in the region of the forehead. A literature review confirmed that the main differences between male and female skull are indeed the size of the head and the size of the eyebrow ridge. This demonstrates that the anthropometric shape model can be used to accurately find variations in shape between different populations. A second use case was the CAD design of an elementary brain-computer interface (BCI) headset for two types of use cases: assisted communication and BCI research. A CAD design of a BCI headset was created for both cases using the data presented in this paper. Because the CAD design was linked to the shape model, it could automatically be adapted to various head sizes while retaining the correct electrode positions. This implies that the anthropometric shape model can indeed be used to aid the design of BCI-headsets and other near-body products such as helmets or glasses.

The current results demonstrate the usability of a shape model parametrized by anthropometric measurements for ergonomic studies and design. In summary, to determine the optimal combination of anthropometric measurements for product design or analysis, the prediction accuracy, cumulative distribution and sensitivity should be taken into account. The importance of each of these factors depends on the intended application. By incorporating the anthropometric model into CAD software, digital designs can be directly driven and verified before prototyping. It is expected that the implementation of the proposed methodology will save time and significantly improve the design process.

@&#ACKNOWLEDGMENTS@&#

Data collection and sharing for this project was provided by the International Consortium for Brain Mapping (ICBM; Principal Investigator: John Mazziotta, MD, PhD). ICBM funding was provided by the National Institute of Biomedical Imaging and BioEngineering. ICBM data are disseminated by the Laboratory of Neuro Imaging at the University of California, Los Angeles.

This work was partially supported by Interuniversity Attraction Poles Programme – Belgian Science Policy (IUAP), Grant number: IUAP P7/11.

@&#REFERENCES@&#

