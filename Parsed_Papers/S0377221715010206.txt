@&#MAIN-TITLE@&#An efficient algorithm for capacitated assortment planning with stochastic demand and substitution

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Increasing product variety requires efficient assortments as shelf space is scarce.


                        
                        
                           
                           The stochastic model integrates out-of-assortment and out-of-stock substitution.


                        
                        
                           
                           Algorithm has been developed for practically relevant problem sizes.


                        
                        
                           
                           An optimal solution procedure and a time-efficient heuristic are presented.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Assortment planning

Shelf space management

Newsvendor

Substitution

Stochastic demand

@&#ABSTRACT@&#


               
               
                  The ever increasing product variety in grocery retailing is in conflict with the limited shelf space. Managing the assortment and regular order quantity for perishable and non-perishable products is therefore a core task for retailers. Retailers want to maximize profit by considering potential revenues, purchase costs, diminishing profits for products and opportunity costs for unfulfilled demand when determining assortment sizes and order volume to meet stochastic consumer demand.
                  We considered a newsvendor-based decision model that jointly optimizes assortment size and the associated order volumes for listed items. The model considers out-of-assortment (OOA) and out-of-stock (OOS) substitution effects. The model is a structural equivalent to the model described in Kök and Fisher (2007) and solved there via a heuristic procedure. We develop an optimal solution procedure and a time-efficient heuristic that solves the model. The heuristic suggested is applicable for practically relevant, large-scale problem instances. Numerical tests reveal that the heuristic procedure produces close-to-optimal solutions and outperforms the Kök and Fisher heuristic with regard to both computational time and solution quality. A simulation study with discrete demand justifies our approach with using continuous demand distributions. The numerical analyses show that considering substitution effects in a decision-based model has a significant impact on the total profit and solution structure. Further managerial insights are presented with regard to assortment heterogeneity when shelf size, substitution and demand variability are varied.
               
            

@&#INTRODUCTION@&#

Several mutually reinforcing trends have made efficient assortment planning one of the most critical marketing and operational decisions for retailers (Mantrala et al., 2009). Retailers and consumer good producers rate “optimization of the product portfolio and category management” the key task for achieving performance goals (Breuer, Fritsch, Prauschke, & Steegmann, 2009). Product availability is one of top three factors affecting customer satisfaction (Eltze, Goergens, & Loury, 2013). These results are not surprising as competition for shelf space in retail stores is at an all-time high, driven by the competitive need to constantly introduce new items. The average number of items in overall store assortments has increased by 30 percent since 2000 (EHI Retail Institute, 2014). In confectionery, for example, the number of brands rose by more than 40 percent between 1997 and 2001, but overall sales by only 0.8 percent (Carlotti, Coe, & Perrey, 2006). Assortment levels have become so excessive that reducing variety greatly increases sales (Boatwright & Nunes, 2001; Sloot & Verhoef, 2008). It needs to be kept in mind that the increasing online market is leading to new customer shopping behavior that may also influence assortment decisions (Hübner, Holzapfel, & Kuhn, 2015). Even if retailers could determine the optimal assortment mix for each individual customer, it may be unprofitable to stock such an assortment. Out-of-shelf situations are therefore inevitable. Empirical studies show that between 45 percent and 84 percent of demand can be substituted (Aastrup & Kotzab, 2009; Campo, Gijsbrechts, & Nisol, 2003; Gruen, Corsten, & Bharadwaj, 2002; Xin, Messinger, & Li, 2009). These consumer reactions need to be reflected in assortment optimization. Tan and Karabati (2013) and Karabati, Tan, and Öztürk (2009) show the impact of substitution on service levels and how point-of-sales data can be used to estimate substitution rates. In addition, Kuhn and Sternbeck (2013) conducted an exploratory study with 28 European retailers showing that operational planning questions are impacted by assortment decisions.

As a result, retailers need to manage the complexity of satisfying consumer demand cost efficiently by determining the interdependent problems of assortment size and shelf inventory. In these circumstances they have to match consumer demand with shelf supply by balancing variety (number of products) and shelf service levels (number of items of a product). Offering broader assortments thus limits appropriate service levels and vice versa, as shelf space is scarce. Consequently, retailers need to make same-time decisions on which products to offer, how much space to allocate and how much to reorder for each product. This is a tactical decision problem as it results in mid-term changes, e.g., in supplier selection and shelf layout and therefore belongs to category planning (Hübner, Kuhn, & Sternbeck, 2013a; 2013b). The decision problem receives input from strategic planning and informs operational instore fulfillment tasks (Hübner & Kuhn, 2014). It entails three main aspects: (i) Assortment planning involves listing products by including the most profitable items according to consumer demand. Total demand consists of initial demand for a product and also the substitution by and complementary demand for other products. (ii) Shelf space planning assigns quantities under the constraints of limited shelf sizes. (iii) Instore inventory planning determines restocking policies. This is concerned with holding as little inventory as possible to ensure efficient refill costs and limit the risk that items will perish while still meeting demand, i.e., not getting out of stock. Replenishment frequency impacts the entire shelf supply and actual stock levels, which then influence consumer choice at the shelves. These planning problems are interrelated. For example, if a retailer lists more brands, he has less space for each brand (given that shelf space is limited) and needs to reorder the items more frequently, which reduces storage duration but increases the risk of getting out of stock. The problem is especially important for perishable items with a limited shelf life, but also applicable to non-perishable items. An assortment model needs to balance supply and demand effects. Firstly, assortment decisions with limited shelf space affect possible out-of-assortment (OOA) or out-of-stock (OOS) demand substitutions for unavailable items when the shopper enters the store. Secondly, inventory decisions such as space allocation and associated reorder volume impact operational refill costs and service levels, but also have to take into account space limitations. Finally, retailers need to choose their assortment and order volume carefully as consumer demand is stochastic and perishable items cannot be stored or can only be sold at a discount later whereas non-perishable items than impose higher storage costs. The demand can also not be backlogged.

Retailers typically solve decision problems sequentially: determining the assortment, allocating it to the shelf and finally determining order sizes. They tend to rely on software-based deterministic decision support. However these solutions use intuitive heuristics for the assortment decision problem (Hübner & Kuhn, 2012). Using heuristics is intuitive and often simple to understand, but does not result in optimal assortment configurations, especially when demand is stochastic. The available scientific models, however, are also limited concerning optimality. Our literature review shows that they are also limited to a very narrow set of items that can be optimized. A comprehensive and efficient decision model will therefore improve decision making and profit (Hübner & Kuhn, 2012). We propose applying a stochastic newsvendor model for perishable and non-perishable items that jointly optimizes assortment and order sizes under storage constraints, and enables the efficient solution of retail-specific problem sizes using an optimal procedure or—if problem instances are too large—a near-optimal solution heuristic procedure. We assume product categories that are jointly delivered once per sales period, e.g., once per day, every second day, once per season, etc. (see also Holzapfel, HÃ¼bner, Kuhn and Sternbeck, 2015, Sternbeck & Kuhn, 2014). Product examples for these categories with limited sale periods are fresh products (e.g., fruits, vegetables, bakery, meat, and dairy products), seasonal products (e.g., fashion, consumer electronics, seasonal fruits, holiday products), promotional products (e.g., “buy one, get one free”, product bundles, short-term price offers) or temporary offers (e.g., additional assortments for limited sales periods, pop-up stores, seasonal markets, promotions at the gondola end and in the promotion area). In addition, we assume that the stores have no or only very limited backroom storage available for these categories. This is because of their location in city centers, shopping malls, or the need for special facilities (e.g., refrigeration).

The rest of this paper is organized as follows. We first provide an overview of the associated literature in Section 2, and then develop the model in Section 3. In Section 4 we elaborate appropriate solution approaches to solve the problem. Section 5 presents computational tests. Finally, Section 6 discusses potential areas for future research.

@&#LITERATURE REVIEW@&#

We will investigate the related literature in three streams. The first stream deals with deterministic shelf space management models, while multi-item newsvendor problems are investigated in another related stream. Finally, we analyze newsvendor-based multi-item assortment problems with substitution effects.

Integrative assortment planning models have their origin in shelf space management that assumes a deterministic demand. Common denominators of these models are item demand as a function of the space allocated to an item and limited shelf space. The continuous inventory review model by Urban (1998) takes into account inventory-elastic demand. Yücel, Karaesmen, Salman, and Türkay (2009) develop three different models to examine the effects of substitution between products, supplier selection and shelf space limitations on the optimal assortment decision. The first model does not consider substitution effects, the second does not allow retailers to select their suppliers, and the third model implies unlimited shelf space. However, Yücel et al. (2009) prove that shelf space has a significant impact on the performance of assortments. Irion, Lu, Al-Khayyal, and Tsao (2012) use a piecewise linearization for modeling space- and cross-space elasticity. The logarithmic function, however, does not take into account effects of OOA substitution. The main drawback of all these studies is their limited applicability under conditions of stochastic demand. The deterministic models assume efficient instore logistics so that shelves are always stocked and consumer demand is deterministic. These assumptions can be valid to some extent for non-perishable products, but do not hold for perishable items.

Secondly, the related problem for perishable products is often described by the newsvendor model. The basic stochastic one-period one-item model is well known in literature (see for example Turken et al. (2012)). Extending this to include multi-item newsvendor problems has also been widely studied in literature, see for example reviews by Khouja (1999), Qin, Wang, Vakharia, Chen, and Seref (2011), and Turken et al. (2012). Multi-item newsvendor models with one constraint have been studied by Lau and Lau (1996). The latter develop solution procedures for strictly positive demand functions as well as demand functions with long tails, and extend their approach to a multi-constraint scenario. Abdel-Malek and Montanari (2005) extend the approach of Lau and Lau (1996) to ensure positive optimal order quantities. They formulate thresholds to estimate the tightness of the constraint. Abdel-Malek, Montanari, and Morales (2004) solve the newsvendor model under a budget constraint with multiple demand distributions. Lau and Lau (1995) apply multiple constraints in their newsvendor model. However, all these models do not take assortment planning and substitution effects into account.

Finally, the following assortment models use the newsvendor as a basic model to find the profit maximizing shelf configuration. The main feature of assortment planning is the integration of consumers’ willingness to accept a substitute when their favorite product is not available. An up-to-date literature review on planning models that considers product substitution is presented by Shin, Park, Lee, and Benton (2015).

The most popular approaches for estimating demand substitution in assortment planning are multinomial logit models (MNL) and exogenous demand models (ED). The MNL is a discrete consumer choice model that assumes that consumers are rational utility maximizers, and derives anticipations of consumer behavior (see for example Mahajan and van Ryzin (2001), Gaur and Honhon (2006), and Hopp and Xu (2008)). In this paper, we focus on ED models since the proposed MNL models neglect the limited shelf capacity and ED models are mostly used when inventory levels become relevant. In addition, MNL models assume that the products in the category differ by a single characteristic only, e.g., milk with a different amount of fat content, which does not affect quality or price. It is thus assumed that all products have identical costs and sales prices (see Gaur & Honhon, 2006).

ED models directly specify the demand for each product. Consumers choose from a set of items. If the preferred item is not available for any reason, an individual consumer might accept another item as a substitute according to a defined substitution probability. The ED models generally allow only one round of substitution. If the first alternative is also not available, sales are consequently lost. Kök (2003) shows that this is not too restrictive. Smith and Agrawal (2000) develop a probabilistic demand model capturing substitution and defining inventory levels. The multi-item newsvendor model maximizes total expected profit by setting product-specific order levels to achieve given service levels. They apply an approximate solution with Lagrangian relaxation using the space constraint. This is followed by full enumeration for small item sets to define optimal order levels, and a linearization approximation for large item sets. Illustrative examples with five products are used to obtain several insights, for example that substitution effects can reduce optimal assortment sizes. Ignoring substitution effects decreases profit significantly and it may not be optimal to stock the most popular item as a result of varying substitution relationships. Kök and Fisher (2007) develop an ED model with a shelf space constraint to maximize total profit. They provide evidence of the impact of space limitations. The substitution process is modeled similar to Smith and Agrawal (2000). They integrate lost sales arising from unmet demand into their objective function and develop an estimation approach using sales data from different stores. Kök and Fisher (2007) solve the model for OOA and OOS substitutions using an iterative heuristic to find the optimal number of facings for each product and a local search to derive the space required for a share of the entire assortment. They show structural properties that relate to gross margins, demand variability and size of products, i.e., it may be more profitable to first include smaller products in the assortment. The heuristics converge to a maximum value, but do not guarantee optimality. Their algorithm is only capable of handling a very narrow assortment.

Further contributions in this area concentrate on substitution effects in newsvendor settings: Wang and Parlar (1994) examine a multi-item approach where a customer can substitute products of other retailers if the item is not available. They find that the newsvendor will then order a larger quantity because of the opportunity to attain unfulfilled demand from other newsvendors. Khouja and Mehrez (1996) develop a two-item newsvendor model with substitution effects and use Monte-Carlo simulation to solve the problem. Bassok, Anupindi, and Akella (1999) build a model with multiple products and several demand classes and only focus on downward substitution effects. Rajaram and Tang (2001) analyze the impact of product substitution on retail merchandising with a service-rate heuristic based on the basic newsvendor model. They evaluate the impact of substitution on order quantities and expected profits, and show that substitution reduces shortages and overstocking costs.

To summarize, there is no stochastic model that optimizes assortment and inventory with limited shelf space for a relevant problem size from a practical viewpoint of 50 or more items per category. We also refer to more general reviews on assortment planning as presented in Kök, Fisher, and Vaidyanathan (2009) and Hübner and Kuhn (2012). An integrated approach assuming stochastic demand will reflect consumer behavior more comprehensively and broaden the perspective for the retailer. Not all papers include both substitutions effects arising from OOA or OOS situations. Apart from Kök and Fisher (2007), none of these contributions take into account limited shelf space. Most models are not of practical relevance as they are set up to optimize assortments with fewer than 25 items. Even if the ED models provide various extensions of multi-item settings, substitution modeling or constraints, there is a research gap for efficient solution approaches that can be applied to large-sized stochastic assortment problems and at the same time guarantee optimality.

We assume a retailer who needs to select items from a set 
                           N
                         within a category of perishable and/or non-perishable products and needs to define associated order sizes for each item so that the items fit onto the shelf. The shelf space for that product category is determined by previous planning steps and limited. There is no backroom storage available for those products. All products of the category are subject to the same replenishment cycle and jointly delivered to the store. We define the Capacitated Assortment Problem with Stochastic Demand and Substitution (CAP_SDS) under these general assumptions. The single-period model maximizes overall retailer profit (Π) by optimizing the assortment selection for all items j with 
                           
                              j
                              =
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              N
                              ,
                           
                         whereas 
                           N
                         denotes the entire set of possible items and 
                           
                              N
                              =
                              |
                              N
                              |
                           
                        . The assortment decision is expressed by the binary variable 
                           
                              
                                 x
                                 j
                              
                              ,
                              j
                              ∈
                              N
                              ,
                           
                         which is set to 1 if item j is carried by the store, and to 0 if the item is unlisted. The second type of decision variables, 
                           
                              
                                 q
                                 j
                              
                              ,
                              j
                              ∈
                              N
                              ,
                           
                         defines the order sizes of the items. The CAP_SDS is based on a multi-item newsvendor model to factor in stochastic demand for items, and is formulated as follows:

                           
                              (1)
                              
                                 
                                    max
                                    !
                                    
                                    Π
                                    
                                       (
                                       
                                          q
                                          ¯
                                       
                                       )
                                    
                                    =
                                    
                                       ∑
                                       
                                          j
                                          ∈
                                          N
                                       
                                    
                                    
                                       
                                          π
                                          j
                                       
                                       
                                          (
                                          
                                             q
                                             j
                                          
                                          )
                                       
                                    
                                 
                              
                           
                        subject to

                           
                              (2)
                              
                                 
                                    
                                       ∑
                                       
                                          j
                                          ∈
                                          N
                                       
                                    
                                    
                                       
                                          q
                                          j
                                       
                                       ·
                                       
                                          x
                                          j
                                       
                                       ·
                                       
                                          b
                                          j
                                       
                                    
                                    ≤
                                    S
                                    
                                    
                                    
                                 
                              
                           
                        
                        
                           
                              (3)
                              
                                 
                                    
                                       x
                                       j
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   1
                                                   
                                                   for
                                                   
                                                   
                                                      q
                                                      j
                                                   
                                                   >
                                                   0
                                                
                                             
                                          
                                          
                                             
                                                
                                                   else
                                                   
                                                   0
                                                
                                             
                                          
                                       
                                    
                                    
                                    
                                    
                                       q
                                       j
                                    
                                    ≥
                                    0
                                    
                                    and
                                    
                                    integer
                                    
                                    j
                                    ∈
                                    N
                                 
                              
                           
                        
                     


                        Eq. (1) quantifies the objective function, where the order quantity-related profit function πj
                        (qj
                        ) is given by Eq. (4). Eq. (2) limits the available shelf space to the size S. The item width is denoted by bj
                         for all items 
                           
                              j
                              ∈
                              N
                           
                        . Eq. (3) allows only binary values for xj
                         as well as positive and integer values for the order volume qj
                        .

                           
                              (4)
                              
                                 
                                    
                                       
                                          
                                             
                                                π
                                                j
                                             
                                             
                                                (
                                                
                                                   q
                                                   j
                                                
                                                )
                                             
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             −
                                             
                                                q
                                                j
                                             
                                             
                                                c
                                                j
                                             
                                             +
                                             
                                                r
                                                j
                                             
                                             
                                                ∫
                                                
                                                   0
                                                
                                                
                                                   q
                                                   j
                                                
                                             
                                             y
                                             
                                                f
                                                j
                                                *
                                             
                                             d
                                             y
                                             +
                                             
                                                v
                                                j
                                             
                                             
                                                ∫
                                                
                                                   0
                                                
                                                
                                                   q
                                                   j
                                                
                                             
                                             
                                                (
                                                
                                                   q
                                                   j
                                                
                                                −
                                                y
                                                )
                                             
                                             
                                                f
                                                j
                                                *
                                             
                                             d
                                             y
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             +
                                             
                                             
                                                r
                                                j
                                             
                                             
                                                ∫
                                                
                                                   
                                                      q
                                                      j
                                                   
                                                
                                                ∞
                                             
                                             
                                                q
                                                j
                                             
                                             
                                                f
                                                j
                                                *
                                             
                                             d
                                             y
                                             −
                                             
                                                s
                                                j
                                             
                                             
                                                ∫
                                                
                                                   
                                                      q
                                                      j
                                                   
                                                
                                                ∞
                                             
                                             
                                                (
                                                y
                                                −
                                                
                                                   q
                                                   j
                                                
                                                )
                                             
                                             
                                                f
                                                j
                                                *
                                             
                                             d
                                             y
                                             
                                             j
                                             ∈
                                             N
                                          
                                       
                                    
                                 
                              
                           
                        The profit 
                        πj
                        (qj
                        ) depends on the order size qj
                         for each item 
                           
                              j
                              ∈
                              N
                              ,
                           
                         and consists of the sales price rj
                        , which is offset by unit costs cj
                        , as well as the trade-off between shortage costs for unsatisfied demand sj
                         and salvage value vj
                         for unsold goods. If demand Dj
                         for item j is greater than the order quantity qj
                         for item j, the excess demand is lost and the retailer is punished by the shortage costs sj
                        . On the contrary if items remain in stock at the end of the period, they need to be disposed of at salvage value vj
                         and the retailer incurs a loss of 
                           
                              (
                              
                                 c
                                 j
                              
                              −
                              
                                 v
                                 j
                              
                              )
                           
                         on each item j. In the case of a non-perishable product, the salvage value vj
                         equals the cost price cj
                        .

The probability density function 
                           
                              f
                              j
                              *
                           
                         in Eq. (4) accounts for the relevant demand distribution which has to be quantified in accordance with the assumed customer behavior, i.e., assuming substitution effects or not.

We assume that the probability density function 
                           
                              f
                              
                                 D
                                 j
                              
                           
                         of the base demand for item j, 
                           
                              j
                              ∈
                              N
                           
                         is exogenously known and does not include any substitution effects. If the demand function 
                           
                              f
                              j
                              *
                           
                         in Eq. (4) is set to the probability density function of the base demand, i.e., 
                           
                              
                                 f
                                 j
                                 *
                              
                              =
                              
                                 f
                                 
                                    D
                                    j
                                 
                              
                              ,
                              
                              j
                              ∈
                              N
                              ,
                           
                         then model CAP_SD results ignoring substitution effects. This derivation follows the approach of Kök and Fisher (2007).

Assortment decisions with limited space, however, imply that it may not be possible to list all products, or that it may be more profitable to list other products to force consumers to switch to more profitable substitutes. We therefore extend the base demand model with OOA and OOS substitutions, i.e., we assume that if a product is not available (permanently not listed or temporarily out of stock), it can be substituted by another product. In this model type the demand function of each product j also depends on the vector of the decision variables, 
                           
                              
                                 x
                                 ¯
                              
                              =
                              
                                 (
                                 
                                    x
                                    j
                                 
                                 ,
                                 j
                                 ∈
                                 N
                                 )
                              
                           
                         and 
                           
                              
                                 q
                                 ¯
                              
                              =
                              
                                 (
                                 
                                    q
                                    j
                                 
                                 ,
                                 j
                                 ∈
                                 
                                    N
                                    +
                                 
                                 )
                              
                           
                        . The generic demand functions for the CAP_SDS model are then expressed as 
                           
                              
                                 f
                                 j
                                 *
                              
                              =
                              
                                 f
                                 
                                    
                                       D
                                       ^
                                    
                                    j
                                 
                              
                              
                                 (
                                 
                                    x
                                    ¯
                                 
                                 ,
                                 
                                    q
                                    ¯
                                 
                                 ,
                                 y
                                 )
                              
                              ,
                              
                              j
                              ∈
                              N
                           
                        . Listed items are denoted by the set 
                           
                              N
                              +
                           
                         and unlisted items by 
                           
                              N
                              −
                           
                        . Thus, 
                           
                              
                                 N
                                 +
                              
                              ,
                              
                                 N
                                 −
                              
                              ⊆
                              N
                              ,
                           
                        
                        
                           
                              
                                 N
                                 +
                              
                              ∪
                              
                                 N
                                 −
                              
                              =
                              N
                           
                         and 
                           
                              
                                 N
                                 +
                              
                              ∩
                              
                                 N
                                 −
                              
                              =
                              ⊘
                           
                        .

The total demand for a listed item 
                           
                              j
                              ,
                              
                              j
                              ∈
                              
                                 N
                                 +
                              
                              ,
                           
                         therefore consists of the base demand Dj
                         and the gain in demand for substitutions from temporarily stock-outs of listed items, 
                           
                              
                                 N
                                 +
                              
                              ,
                           
                         and of substitutions from the set of unlisted items, 
                           
                              
                                 N
                                 −
                              
                              ,
                           
                         to item j. We generally follow the ED model. Every consumer chooses their favorite item i from set 
                           N
                        . If their favorite product i is not available for some reason, probability βij
                         predicts that they will choose their second favorite j, 
                           
                              j
                              ∈
                              N
                              ,
                              j
                              ≠
                              i
                           
                        . The fraction of consumers who are willing to compromise their initial choice is expressed in the probability of δi
                        , with 
                           
                              (
                              1
                              −
                              
                                 δ
                                 i
                              
                              )
                           
                         as the share of consumers unwilling to substitute their initial choice (i.e., 
                           
                              
                                 δ
                                 i
                              
                              =
                              
                                 ∑
                                 
                                    j
                                    ∈
                                    N
                                    ,
                                    j
                                    ≠
                                    i
                                 
                              
                              
                                 β
                                 
                                    i
                                    j
                                 
                              
                              ,
                              
                              i
                              ∈
                              N
                           
                        ). However, in the general demand model we differentiate between OOA and OOS substitutions, i.e., 
                           
                              β
                              
                                 i
                                 j
                              
                              OOA
                           
                         and 
                           
                              
                                 β
                                 
                                    i
                                    j
                                 
                                 OOS
                              
                              ,
                           
                         respectively:

                           
                              (5)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   D
                                                   ^
                                                
                                                j
                                             
                                             
                                                (
                                                
                                                   x
                                                   ¯
                                                
                                                ,
                                                
                                                   q
                                                   ¯
                                                
                                                )
                                             
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                D
                                                j
                                             
                                             +
                                             
                                                ∑
                                                
                                                   i
                                                   ∈
                                                   
                                                      N
                                                      −
                                                   
                                                   ,
                                                   i
                                                   ≠
                                                   j
                                                
                                             
                                             
                                                β
                                                
                                                   i
                                                   j
                                                
                                                OOA
                                             
                                             
                                                D
                                                i
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             +
                                             
                                                ∑
                                                
                                                   i
                                                   ∈
                                                   
                                                      N
                                                      +
                                                   
                                                   ,
                                                   i
                                                   ≠
                                                   j
                                                
                                             
                                             
                                                β
                                                
                                                   i
                                                   j
                                                
                                                OOS
                                             
                                             
                                                [
                                                
                                                   (
                                                   
                                                      D
                                                      i
                                                   
                                                   −
                                                   
                                                      q
                                                      i
                                                   
                                                   )
                                                
                                                |
                                                
                                                   D
                                                   i
                                                
                                                >
                                                
                                                   q
                                                   i
                                                
                                                ]
                                             
                                             
                                             j
                                             ∈
                                             
                                                N
                                                +
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The first part of Eq. (5) thereby denotes the demand volume that the customer initially prefers item j. The second part quantifies the substitution volume of permanently unavailable items for item j and the third part the substitution volume of temporarily unavailable items. The CAP_SD model is, therefore, a special case of the CAP_SDS with no OOS and OOA substitutions, i.e., 
                           
                              
                                 β
                                 
                                    i
                                    j
                                 
                                 OOS
                              
                              =
                              0
                              ,
                              
                              i
                              ,
                              j
                              ∈
                              
                                 N
                                 +
                              
                           
                         and 
                           
                              
                                 β
                                 
                                    i
                                    j
                                 
                                 OOA
                              
                              =
                              0
                              ,
                              
                              i
                              ∈
                              
                                 N
                                 −
                              
                              ,
                              j
                              ∈
                              
                                 N
                                 +
                              
                           
                        . To summarize, the additional substitution volume for each listed item 
                           
                              j
                              ,
                              
                              j
                              ∈
                              
                                 N
                                 +
                              
                           
                         depends on the base demand for item j, the set of unlisted items 
                           
                              
                                 N
                                 −
                              
                              ,
                           
                         the substitution rate of unlisted items, 
                           
                              
                                 β
                                 
                                    i
                                    j
                                 
                                 OOA
                              
                              ,
                           
                         and the substitution rate of listed items which are temporarily out of stock, 
                           
                              β
                              
                                 i
                                 j
                              
                              OOS
                           
                        .

In addition, following the assumptions of Smith and Agrawal (2000) and Kök and Fisher (2007), one round of substitution is allowed. If consumers want to substitute their first choice by a product that is not available, the sales are consequently lost. There is no attempt to model individual consumer decisions. Instead, an ED model is applied that is capable of capturing aggregated consumer demand. The resulting model is cruder than some other substitution models, but has the advantage of being much easier to analyze and requiring less data. Without loss of generality we assume in the following the same substitution rate for OOS and OOA, i.e., 
                           
                              
                                 β
                                 
                                    i
                                    j
                                 
                                 OOA
                              
                              =
                              
                                 β
                                 
                                    i
                                    j
                                 
                                 OOS
                              
                              =
                              
                                 β
                                 
                                    i
                                    j
                                 
                              
                              ,
                              i
                              ,
                              j
                              ∈
                              N
                           
                        . From a customer’s point of view it is normally not obvious whether the product is out of stock or whether it is not listed. Therefore at least in the short term, the customer’s substitution behavior is the same. Campo, Gijsbrechts, and Nisol (2004) empirically show that OOAs are much more severe for retailers than OOS, due to switching stores for permanent assortment reductions. However, they also conclude that OOA substitution can be an approximation for OOS.

In the following we analyze the behavior of the profit function with and without substitution effects. This shows how the profit function is affected by substitution demand. We consider a two-product case and assume for either product the demand function formulated above Eq. (5), unlimited shelf space and following parameter values for product 1 and product 2: 
                           
                              
                                 r
                                 
                                    1
                                    ,
                                    2
                                 
                              
                              =
                              
                                 [
                                 50
                                 ,
                                 50
                                 ]
                              
                              ,
                           
                        
                        
                           
                              
                                 c
                                 
                                    1
                                    ,
                                    2
                                 
                              
                              =
                              
                                 [
                                 25
                                 ,
                                 25
                                 ]
                              
                              ,
                           
                        
                        
                           
                              
                                 v
                                 
                                    1
                                    ,
                                    2
                                 
                              
                              =
                              
                                 [
                                 0
                                 ,
                                 0
                                 ]
                              
                              ,
                           
                        
                        
                           
                              
                                 s
                                 
                                    1
                                    ,
                                    2
                                 
                              
                              =
                              
                                 [
                                 0
                                 ,
                                 0
                                 ]
                              
                              ,
                           
                        
                        
                           
                              
                                 μ
                                 
                                    1
                                    ,
                                    2
                                 
                              
                              =
                              
                                 [
                                 8.6
                                 ,
                                 7.85
                                 ]
                              
                              ,
                           
                        
                        
                           
                              
                                 σ
                                 
                                    1
                                    ,
                                    2
                                 
                                 2
                              
                              =
                              
                                 [
                                 1.5
                                 ,
                                 1.5
                                 ]
                              
                           
                         and 
                           
                              β
                              =
                              (
                              
                                 
                                    
                                       
                                          0
                                       
                                    
                                    
                                       
                                          0
                                       
                                    
                                 
                                 
                                    
                                       
                                          0
                                       
                                    
                                    
                                       
                                          0
                                       
                                    
                                 
                              
                              )
                           
                         for the non-substitution case and 
                           
                              β
                              =
                              (
                              
                                 
                                    
                                       
                                          0
                                       
                                    
                                    
                                       
                                          
                                             0.59
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             0.59
                                          
                                       
                                    
                                    
                                       
                                          0
                                       
                                    
                                 
                              
                              )
                           
                         for the substitution case. Fig. 1 shows the development of the profit function for the non-substitution case depending on the order size of product 1 and product 2, q
                        1 and q
                        2, in two different figures: (left) contour plot and (right) mesh plot.

The mesh plot (see right part of Fig. 1) shows a peak with a steep descent in all directions. The contour plot (left part of Fig. 1) is symmetrical, as expected, since for both products identical cost parameters are assumed. Consequently, identical critical ratios 
                           
                              
                                 CR
                                 
                                    1
                                    ,
                                    2
                                 
                              
                              =
                              
                                 [
                                 0.5
                                 ,
                                 0.5
                                 ]
                              
                           
                         result. In a newsvendor setting with symmetric demand distribution, a critical ratio of 
                           
                              CR
                              =
                              0.5
                           
                         leads to an optimal order size which equals mean demand. Thus, for the considered instances the optimal order quantities are: 
                           
                              
                                 q
                                 
                                    1
                                    ,
                                    2
                                 
                                 
                                    (
                                    opt
                                    )
                                 
                              
                              =
                              
                                 μ
                                 
                                    1
                                    ,
                                    2
                                 
                              
                              =
                              
                                 [
                                 8.6
                                 ,
                                 7.85
                                 ]
                              
                              .
                           
                         Nevertheless, when neither product can substitute the other it is imperative to achieve as close as possible the optimal order quantity for either product. This is shown by the symmetrical shape of the contour plot. The steep decline in profit for suboptimal order quantities is the result of high losses due to unsatisfied demand since there is no option to compensate unsatisfied demand for one product with another. On the other hand we observe an equivalent decline in the profit function for order quantities that are higher than optimal. These are due to the fact that items that cannot be sold due to their original demand cannot be used in another way, e.g., to fulfill demand in a substitution case for another product. Thus, the profit function sharply declines when overestimating or underestimating the demand. A quite different picture results when using substitution (see Fig. 2
                        ).

Assuming substitution, the mesh plot (see right part of Fig. 2) shows a steep descent toward and from the origin. The diagonal decline is much shallower as can be seen in the contour plot (see left part of Fig. 2). The diagonal structure of the contour plot arises from the possibility of transferring demand from one product to another. If demand for one product is underestimated it can be compensated by the product availability of its substitute. In case of substitution, therefore, it is more important to approximate the aggregated demand correctly than the specific demand values of each product. That is the sum of the two product quantities has to be close to the sum of the optimal quantities since there are only moderate penalties for substitution. In addition, the contour plot depicts a gradual descent in the direction of infinity than toward the origin. Thus, overestimating both products, i.e., assuming larger order quantities than calculated as optimal, has less impact than underestimating the optimal values. The overestimated demand for one product may be used as substitute for the other product and vice versa.

In a further case we assume two products with different parameter values, particularly for the variance of the demand distributions: 
                           
                              
                                 r
                                 
                                    1
                                    ,
                                    2
                                 
                              
                              =
                              
                                 [
                                 289
                                 ,
                                 286
                                 ]
                              
                              ,
                           
                        
                        
                           
                              
                                 c
                                 
                                    1
                                    ,
                                    2
                                 
                              
                              =
                              
                                 [
                                 181
                                 ,
                                 178
                                 ]
                              
                              ,
                           
                        
                        
                           
                              
                                 v
                                 
                                    1
                                    ,
                                    2
                                 
                              
                              =
                              
                                 [
                                 19.3
                                 ,
                                 17.4
                                 ]
                              
                              ,
                           
                        
                        
                           
                              
                                 s
                                 
                                    1
                                    ,
                                    2
                                 
                              
                              =
                              
                                 [
                                 18.4
                                 ,
                                 17.2
                                 ]
                              
                              ,
                           
                        
                        
                           
                              
                                 μ
                                 
                                    1
                                    ,
                                    2
                                 
                              
                              =
                              
                                 [
                                 8.85
                                 ,
                                 9.6
                                 ]
                              
                              ,
                           
                        
                        
                           
                              
                                 σ
                                 
                                    1
                                    ,
                                    2
                                 
                                 2
                              
                              =
                              
                                 [
                                 1.05
                                 ,
                                 3.04
                                 ]
                              
                           
                         as well as 
                           
                              β
                              =
                              (
                              
                                 
                                    
                                       
                                          0
                                       
                                    
                                    
                                       
                                          0
                                       
                                    
                                 
                                 
                                    
                                       
                                          0
                                       
                                    
                                    
                                       
                                          0
                                       
                                    
                                 
                              
                              )
                           
                         for the non-substitution case and 
                           
                              β
                              =
                              (
                              
                                 
                                    
                                       
                                          0
                                       
                                    
                                    
                                       
                                          
                                             0.5
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             0.5
                                          
                                       
                                    
                                    
                                       
                                          0
                                       
                                    
                                 
                              
                              )
                           
                         for the substitution case. However, the critical values for product 1 and product 2, result in nearly identical values: 
                           
                              
                                 CR
                                 
                                    1
                                    ,
                                    2
                                 
                              
                              =
                              
                                 [
                                 0.439
                                 ,
                                 0.438
                                 ]
                              
                           
                        . The left part of Fig. 3
                         shows the contour plot assuming no substitution. The contour lines have an elliptic shape which elongates parallel to the x-axes. This is due to the difference in the assumed variances of the demand distributions. The elongation is in a horizontal direction, since we assume higher variance for product 2. A simple case exemplifies this: When observing the single item case, it is obvious that an increase in variance spreads the weight of the probability density function over a larger area (of possible order quantities). Since the profit is calculated by integrating the probability density function, and thereby taking the weight of the order quantities into account, a widespread probability density function leads to a widespread profit function. This shows the relation between elongation and variance in the single item case, which can be transferred directly to the multi-item case. In contrast, the right part of Fig. 3 shows the contour plot assuming substitution. Again, the contour lines are spread out diagonally based on the same effects as described above.

This paragraph proves that the profit function in Eq. (4) is unimodal for strictly increasing cumulated demand distribution functions. Index j is suppressed for reasons of simplicity. It is easily confirmed that derivation of the profit function is defined by:

                           
                              (6)
                              
                                 
                                    
                                       d
                                       
                                          d
                                          q
                                       
                                    
                                    π
                                    
                                       (
                                       q
                                       )
                                    
                                    =
                                    r
                                    −
                                    c
                                    +
                                    s
                                    −
                                    F
                                    
                                       (
                                       q
                                       )
                                    
                                    
                                       (
                                       r
                                       −
                                       v
                                       +
                                       s
                                       )
                                    
                                 
                              
                           
                        
                     

The optimal order quantity q
                        opt in the newsvendor problem can easily be obtained using the critical ratio CR, with 
                           
                              CR
                              =
                              
                                 
                                    r
                                    −
                                    c
                                    +
                                    s
                                 
                                 
                                    r
                                    −
                                    v
                                    +
                                    s
                                 
                              
                           
                         (see e.g., Khouja, 1999). The following equation results:

                           
                              (7)
                              
                                 
                                    
                                       d
                                       
                                          d
                                          q
                                       
                                    
                                    π
                                    
                                       (
                                       q
                                       )
                                    
                                    =
                                    
                                       (
                                       r
                                       −
                                       c
                                       +
                                       s
                                       )
                                    
                                    
                                       (
                                       1
                                       −
                                       X
                                       )
                                    
                                 
                              
                           
                        
                     

Hereby X denotes a constant that is defined by 
                           
                              F
                              
                                 (
                                 q
                                 )
                              
                              =
                              X
                              ·
                              
                                 
                                    r
                                    −
                                    c
                                    +
                                    s
                                 
                                 
                                    r
                                    −
                                    v
                                    +
                                    s
                                 
                              
                           
                         for a fixed q. This constant is positive and for q < q
                        opt smaller than one, for q > q
                        opt larger than one, since the cdf is strictly increasing and q
                        opt is chosen equal to 
                           
                              
                                 r
                                 −
                                 c
                                 +
                                 s
                              
                              
                                 r
                                 −
                                 v
                                 +
                                 s
                              
                           
                        . In the view of this, the profit increases for q < q
                        opt and decreases for q > q
                        opt since the derivation is larger (smaller) than zero. The profit function is therefore unimodal.

Model CAP_SDS is a knapsack problem with a nonlinear and non-separable objective function whose coefficients need to be calculated for every combination of the decision variables, i.e., 0 ≤ qj
                         ≤ S, 
                           
                              j
                              ∈
                              N
                           
                         and 
                           
                              
                                 ∑
                                 
                                    j
                                    ∈
                                    N
                                 
                              
                              
                                 q
                                 j
                              
                              ≤
                              S
                           
                        . Assuming 
                           
                              
                                 b
                                 j
                              
                              =
                              1
                              ,
                           
                        
                        
                           
                              j
                              ∈
                              N
                              ,
                           
                         the number of different solutions Y is yielded by the following binomial coefficient: 
                           
                              Y
                              
                                 (
                                 N
                                 ,
                                 S
                                 )
                              
                              =
                              
                                 (
                                 
                                    
                                       N
                                       +
                                       S
                                       −
                                       1
                                    
                                    S
                                 
                                 )
                              
                              =
                              
                                 
                                    (
                                    N
                                    +
                                    S
                                    −
                                    1
                                    )
                                    !
                                 
                                 
                                    S
                                    !
                                    (
                                    N
                                    −
                                    1
                                    )
                                    !
                                 
                              
                           
                        . The problem results in a combinatorial explosion of the number of solutions, e.g., for 
                           
                              N
                              =
                              10
                           
                         and 
                           
                              S
                              =
                              100
                           
                         there are approximately 4.2 × 1012 possible solutions. However, retailers have typical category sizes of up to 200–300 items, averaging 60–80 items per category (EHI Retail Institute, 2014). The classical knapsack problem assuming a linear objective function is already known to be NP-hard (Kellerer, Pferschy, & Pisinger, 2004; Pisinger, 2005). We therefore need to develop an efficient solution approach that allows solutions to be generated within problem-specific time boundaries.

In this section we present an exact and heuristic solution approach to solve the CAP_SDS model. We denote the exact approach as Derivative Based Algorithm with Lagrange-multiplier and Modified Enumeration (DBALME), and the Heuristic version as DBALME-H. Both of them require a solution to the capacitated multi-item newsvendor problem and concepts to convolute multiple distributions of random variables to integrate the substitution effects into the demand functions. These all are defined in the first subsection.

Assuming the profit function as formulated in Eq. (4) and continuous order quantities, i. e., qj
                            ≥ 0, 
                              
                                 j
                                 ∈
                                 N
                                 ,
                              
                            the classical single-item newsvendor problem (NVP) results. Deriving the profit function (4) delivers the critical ratio CR
                              j
                            that makes it possible to compute the optimal order quantity q
                           
                              j, opt (Khouja, 1999). P(Dj
                            ≤ q
                           
                              j, opt) denotes the probability that the stochastic demand Dj
                            for an item j is less than or equal to q
                           
                              j, opt.

                              
                                 (8)
                                 
                                    
                                       
                                          CR
                                          j
                                       
                                       =
                                       P
                                       
                                          (
                                          
                                             D
                                             j
                                          
                                          ≤
                                          
                                             q
                                             
                                                j
                                                ,
                                                
                                                   opt
                                                
                                             
                                          
                                          )
                                       
                                       =
                                       
                                          
                                             
                                                r
                                                j
                                             
                                             −
                                             
                                                c
                                                j
                                             
                                             +
                                             
                                                s
                                                j
                                             
                                          
                                          
                                             
                                                r
                                                j
                                             
                                             −
                                             
                                                v
                                                j
                                             
                                             +
                                             
                                                s
                                                j
                                             
                                          
                                       
                                       
                                       j
                                       ∈
                                       N
                                    
                                 
                              
                           
                        

Assuming a product set 
                              N
                            and a limited shelf space as defined in constraint (2) the result is the capacitated multi-item newsvendor problem (CNVP). The CNVP can be solved by applying a Lagrangian approach (Lau & Lau, 1996). The solution to the CNVP is given in (9), where the Lagrange multiplier λ represents a cost factor to account for the limited shelf space.

                              
                                 (9)
                                 
                                    
                                       L
                                       
                                          (
                                          
                                             q
                                             j
                                          
                                          ,
                                          λ
                                          )
                                       
                                       =
                                       
                                          ∑
                                          
                                             j
                                             ∈
                                             N
                                          
                                       
                                       
                                          
                                             π
                                             j
                                          
                                          
                                             (
                                             
                                                q
                                                j
                                             
                                             )
                                          
                                       
                                       −
                                       λ
                                       
                                          (
                                          
                                             ∑
                                             
                                                j
                                                ∈
                                                N
                                             
                                          
                                          
                                             
                                                q
                                                j
                                             
                                             
                                                b
                                                j
                                             
                                          
                                          −
                                          S
                                          )
                                       
                                       ⇒
                                       
                                          
                                             ∂
                                             L
                                             (
                                             
                                                q
                                                j
                                             
                                             ,
                                             λ
                                             )
                                          
                                          
                                             ∂
                                             
                                                q
                                                j
                                             
                                          
                                       
                                       =
                                       0
                                    
                                 
                              
                           
                        

The partial derivative with respect to qj
                            is subsequently set to zero to find an optimal value for λ, i.e., λ
                           opt. If λ
                           opt is known, the optimal order quantity, q
                           
                              j, opt for each item j, 
                              
                                 j
                                 ∈
                                 N
                              
                            can be determined via the critical ratio, i. e., the ready rate or the probability of not being out of shelf:

                              
                                 (10)
                                 
                                    
                                       
                                          
                                             CR
                                             ˜
                                          
                                          j
                                       
                                       =
                                       P
                                       
                                          (
                                          
                                             D
                                             j
                                          
                                          ≤
                                          
                                             q
                                             
                                                j
                                                ,
                                                
                                                   opt
                                                
                                             
                                          
                                          )
                                       
                                       =
                                       
                                          
                                             
                                                r
                                                j
                                             
                                             −
                                             
                                                c
                                                j
                                             
                                             +
                                             
                                                s
                                                j
                                             
                                             −
                                             
                                                b
                                                j
                                             
                                             ·
                                             
                                                λ
                                                
                                                   opt
                                                
                                             
                                          
                                          
                                             
                                                r
                                                j
                                             
                                             −
                                             
                                                v
                                                j
                                             
                                             +
                                             
                                                s
                                                j
                                             
                                          
                                       
                                       
                                       j
                                       ∈
                                       N
                                    
                                 
                              
                           
                        

There are two interesting findings with regard to this critical ratio. First, the form of the critical ratio of the classical NVP remains unchanged. That is, the original has an influence on the in-stock probability of item j. Second, the shelf space constraint is included in the critical ratio through λ and the item width bj
                           . If the shelf space constraint is non-binding, i. e., 
                              
                                 λ
                                 =
                                 0
                                 ,
                              
                            the optimal order quantities equal those of the NVP. If, however, the shelf space constraint is violated, the order quantity of item j is too high. In order to reduce it, λ needs to be set to a positive value. The optimal value of the Lagrangian multiplier λ can be found using by a bi-sectional search method. During the search process λ is increased (reduced) until the shelf is entirely filled with 
                              
                                 
                                    ∑
                                    
                                       j
                                       ∈
                                       N
                                    
                                 
                                 
                                    
                                       q
                                       j
                                    
                                    
                                       b
                                       j
                                    
                                 
                                 =
                                 S
                              
                           .

The algorithms solving the general case of model CAP_SDS uses the convolution concept to generate the distribution of product’s demand including substitution effects. Since the distributions of the products j and i are independent for i ≠ j, the convolution of the related demand distribution functions results to the distribution of the sum of the demands of product j and i. Furthermore only non-negative demand is allowed, so all following distributions are restricted to 
                              
                                 R
                                 
                                    0
                                 
                                 +
                              
                           . Assuming the distributions are standardized on the feasible interval, the convolution of the additional demand distributions accounting for OOA and OOS for the item sets 
                              
                                 N
                                 −
                              
                            and 
                              
                                 
                                    N
                                    +
                                 
                                 ,
                              
                            respectively, are given as follows (Note: Since the substitution parameter βij
                            represents only a factor it will be omitted in the formulas):

                              
                                 (11)
                                 
                                    
                                       
                                          ⊛
                                          
                                             i
                                             ∈
                                             
                                                N
                                                −
                                             
                                          
                                       
                                       
                                          f
                                          
                                             D
                                             i
                                          
                                       
                                       =
                                       
                                          
                                             ∫
                                             …
                                             ∫
                                          
                                          
                                             
                                                R
                                                
                                                   0
                                                
                                                
                                                   +
                                                   ,
                                                   n
                                                
                                             
                                             ,
                                             i
                                             ∈
                                             
                                                N
                                                −
                                             
                                          
                                       
                                       
                                          f
                                          
                                             D
                                             i
                                          
                                       
                                       d
                                       τ
                                       …
                                       d
                                       υ
                                    
                                 
                              
                           
                           
                              
                                 (12)
                                 
                                    
                                       
                                          ⊛
                                          
                                             i
                                             ∈
                                             
                                                N
                                                +
                                             
                                          
                                       
                                       
                                          f
                                          
                                             D
                                             i
                                          
                                       
                                       =
                                       
                                          
                                             ∫
                                             …
                                             ∫
                                          
                                          
                                             
                                                q
                                                i
                                             
                                             ,
                                             i
                                             ∈
                                             
                                                N
                                                +
                                             
                                          
                                          ∞
                                       
                                       
                                          f
                                          
                                             D
                                             i
                                          
                                       
                                       d
                                       τ
                                       …
                                       d
                                       υ
                                    
                                 
                              
                           
                        

The ⊛ operator represents the convolution of all i ≠ j in 
                              
                                 
                                    N
                                    −
                                 
                                 ,
                              
                            respectively 
                              
                                 
                                    N
                                    +
                                 
                                 ,
                              
                            with each other, in the same way as the ∑ is used for summation. With the ability to convolute distributions we can calculate the demand distribution for product j including substitution effects in the following manner: We iteratively convolute the distribution 
                              
                                 f
                                 
                                    D
                                    j
                                 
                              
                            with 
                              
                                 
                                    β
                                    
                                       i
                                       j
                                    
                                 
                                 ·
                                 
                                    f
                                    
                                       D
                                       i
                                    
                                 
                              
                            (for all i ≠ j) resulting in the new 
                              
                                 
                                    f
                                    j
                                    *
                                 
                                 =
                                 
                                    f
                                    
                                       
                                          D
                                          ^
                                       
                                       j
                                    
                                 
                                 
                                    (
                                    
                                       x
                                       ¯
                                    
                                    ,
                                    
                                       q
                                       ¯
                                    
                                    ,
                                    y
                                    )
                                 
                              
                           . In this way we account for OOA and OOS substitutions. It is important to mention that 
                              
                                 
                                    f
                                    
                                       D
                                       i
                                    
                                 
                                 ,
                              
                           
                           
                              
                                 i
                                 ∈
                                 N
                              
                            used in the following iteration process are the distributions of unsatisfied demand without substitution, since we only investigate cases with one round of substitution.

The calculation of the demand distributions including substitution effects, 
                              
                                 
                                    f
                                    
                                       
                                          D
                                          ^
                                       
                                       j
                                    
                                 
                                 
                                    (
                                    
                                       x
                                       ¯
                                    
                                    ,
                                    
                                       q
                                       ¯
                                    
                                    ,
                                    y
                                    )
                                 
                                 ,
                                 
                                 j
                                 ∈
                                 N
                              
                            can be simplified if the base demands of all products satisfy the assumption of normality. Since the normal distribution is uniquely determined by its mean μ and variance σ
                           2, it is sufficient to calculate these parameters:

                              
                                 (13)
                                 
                                    
                                       
                                          
                                             μ
                                             ^
                                          
                                          j
                                       
                                       =
                                       
                                          μ
                                          j
                                       
                                       +
                                       
                                          ∑
                                          
                                             i
                                             ∈
                                             
                                                N
                                                −
                                             
                                             ,
                                             i
                                             ≠
                                             j
                                          
                                       
                                       
                                          β
                                          
                                             i
                                             j
                                          
                                       
                                       
                                          μ
                                          i
                                       
                                       +
                                       
                                          ∑
                                          
                                             i
                                             ∈
                                             
                                                N
                                                +
                                             
                                             ,
                                             i
                                             ≠
                                             j
                                          
                                       
                                       
                                          β
                                          
                                             i
                                             j
                                          
                                       
                                       
                                          (
                                          
                                             ∫
                                             
                                                
                                                   q
                                                   i
                                                
                                             
                                             ∞
                                          
                                          
                                             (
                                             y
                                             −
                                             
                                                q
                                                i
                                             
                                             )
                                          
                                          
                                             f
                                             
                                                D
                                                i
                                             
                                          
                                          
                                             (
                                             y
                                             )
                                          
                                          d
                                          y
                                          )
                                       
                                    
                                 
                              
                           
                           
                              
                                 (14)
                                 
                                    
                                       
                                          
                                          
                                          
                                             
                                                
                                                   
                                                      σ
                                                      ^
                                                   
                                                   
                                                      j
                                                   
                                                   2
                                                
                                                =
                                                
                                                   σ
                                                   
                                                      j
                                                   
                                                   2
                                                
                                                +
                                                
                                                   ∑
                                                   
                                                      i
                                                      ∈
                                                      
                                                         N
                                                         −
                                                      
                                                      ,
                                                      i
                                                      ≠
                                                      j
                                                   
                                                
                                                
                                                   β
                                                   
                                                      i
                                                      j
                                                   
                                                   2
                                                
                                                
                                                   σ
                                                   
                                                      i
                                                   
                                                   2
                                                
                                                +
                                                
                                                   ∑
                                                   
                                                      i
                                                      ∈
                                                      
                                                         N
                                                         +
                                                      
                                                      ,
                                                      i
                                                      ≠
                                                      j
                                                   
                                                
                                                
                                                   β
                                                   
                                                      i
                                                      j
                                                   
                                                   2
                                                
                                                
                                                   σ
                                                   
                                                      i
                                                   
                                                   
                                                      2
                                                      ,
                                                      *
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                with
                                                
                                                
                                                
                                                   σ
                                                   
                                                      i
                                                   
                                                   
                                                      2
                                                      ,
                                                      *
                                                   
                                                
                                                =
                                                
                                                   σ
                                                   
                                                      i
                                                   
                                                   2
                                                
                                                ·
                                                
                                                   J
                                                   N
                                                
                                                
                                                   {
                                                   
                                                      
                                                         
                                                            q
                                                            i
                                                         
                                                         −
                                                         
                                                            μ
                                                            i
                                                         
                                                      
                                                      
                                                         σ
                                                         i
                                                      
                                                   
                                                   }
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                with
                                                
                                                
                                                
                                                   J
                                                   N
                                                
                                                
                                                   (
                                                   z
                                                   )
                                                
                                                =
                                                
                                                   (
                                                   1
                                                   +
                                                   
                                                      z
                                                      2
                                                   
                                                   )
                                                
                                                ·
                                                
                                                   {
                                                   1
                                                   −
                                                   
                                                      F
                                                      i
                                                   
                                                   
                                                      (
                                                      z
                                                      )
                                                   
                                                   }
                                                
                                                −
                                                z
                                                ·
                                                
                                                   f
                                                   i
                                                
                                                
                                                   (
                                                   z
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

The function JN
                           ( · ) is twice the “second order loss function” (see Tempelmeier, 2011).

To sum up, we now have the ability to calculate the effects of substitution and can continue to search for the extremal values. The extremal values can be calculated via the critical ratio of the CNVP while using the distribution function with substitution. It is possible that the resulting equation is not unique. This case can only occur for distributions with more than one extremal value. For this paper, we restrict the possible distributions to the case of a single maximum value or strictly monotonic behavior.

To find an optimal solution for the CAP_SDS model we subdivide the solution problem into two sequential parts. In Part I we solve a relaxation of the CAP_SDS allowing continuous values for the order quantities of all products, i. e., 
                           
                              
                                 q
                                 j
                              
                              ≥
                              0
                              ,
                              j
                              ∈
                              N
                           
                        . Afterward in Part II, we solve the CAP_SDS with limited solution space by rounding the resulting order sizes up and down to the next integer values. The resulting solution space—a maximum of 2
                           N
                         different values—is evaluated on a full enumeration basis to find the optimal solution to the CAP_SDS. The solution procedure is shown in Fig. 4.

Part 0 initializes the variables and demand functions. Part I then finds a solution to the relaxed problem to the effect that order quantities are allowed to take on continuous values. The non-negativity constraint, i.e. 
                           
                              
                                 q
                                 j
                              
                              ≥
                              0
                              ,
                              j
                              ∈
                              N
                              ,
                           
                         still has to be fulfilled. Thus, a modified version of the CAP_SDS model is solved assuming the profit function (4), but including the demand function as formulated in Eq. (5) reflecting the OOA and OOS substitutions. Since the demand gains for listed products from substitution depend on the decision variables 
                           
                              x
                              ¯
                           
                         and 
                           
                              q
                              ¯
                           
                         an iterative solution procedure is applied which iteratively adapts the demand function.

The main steps of the procedure are Steps 2.1 to 2.3, which are described in more detail in the following. Step 2.1: In this step the λ
                        (k) value is calculated with a bisection method. For implementation it is important to differentiate between two different cases: (i) If the bracketing values for λ
                        (k) are positive and (ii) where negative values are needed to bracket the zero point. (i) Where the bracketing values are positive, i.e. the lower bracketing point is zero and the upper one is acquired by trial and error (rising by an order of magnitude for failure). (ii) If the lower bracketing value is negative, the λ
                        (k) value is set equal to zero, because in this case omitting the λ
                        (k) leads to the optimal solution. The defining equation for the λ
                        (k) calculation is given by:

                           
                              (15)
                              
                                 
                                    
                                       ∑
                                       
                                          j
                                          ∈
                                          N
                                       
                                    
                                    
                                       q
                                       j
                                    
                                    ·
                                    
                                       b
                                       j
                                    
                                    −
                                    S
                                    =
                                    0
                                    
                                    with
                                    
                                    
                                       q
                                       j
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   
                                                      F
                                                      j
                                                      
                                                         −
                                                         1
                                                         ,
                                                         (
                                                         k
                                                         )
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            
                                                               r
                                                               j
                                                            
                                                            −
                                                            
                                                               c
                                                               j
                                                            
                                                            +
                                                            
                                                               s
                                                               j
                                                            
                                                            −
                                                            
                                                               b
                                                               j
                                                            
                                                            ·
                                                            
                                                               λ
                                                               
                                                                  (
                                                                  k
                                                                  )
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               r
                                                               j
                                                            
                                                            −
                                                            
                                                               v
                                                               j
                                                            
                                                            +
                                                            
                                                               s
                                                               j
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                   for
                                                   
                                                   
                                                      q
                                                      
                                                         j
                                                         ,
                                                         opt
                                                      
                                                      
                                                         (
                                                         k
                                                         )
                                                      
                                                   
                                                   ≥
                                                   0
                                                
                                             
                                          
                                          
                                             
                                                
                                                   else
                                                   
                                                   0
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Step 2.2: The optimal order quantities and the assignment of the products to the assortment are determined as follows:

                           
                              (16)
                              
                                 
                                    
                                       q
                                       
                                          j
                                          ,
                                          opt
                                       
                                       
                                          (
                                          k
                                          )
                                       
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   
                                                      F
                                                      j
                                                      
                                                         −
                                                         1
                                                         ,
                                                         (
                                                         k
                                                         )
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            
                                                               r
                                                               j
                                                            
                                                            −
                                                            
                                                               c
                                                               j
                                                            
                                                            +
                                                            
                                                               s
                                                               j
                                                            
                                                            −
                                                            
                                                               b
                                                               j
                                                            
                                                            ·
                                                            
                                                               λ
                                                               
                                                                  (
                                                                  k
                                                                  )
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               r
                                                               j
                                                            
                                                            −
                                                            
                                                               v
                                                               j
                                                            
                                                            +
                                                            
                                                               s
                                                               j
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                   for
                                                   
                                                   
                                                      q
                                                      
                                                         j
                                                         ,
                                                         opt
                                                      
                                                      
                                                         (
                                                         k
                                                         )
                                                      
                                                   
                                                   ≥
                                                   0
                                                
                                             
                                          
                                          
                                             
                                                
                                                   else
                                                   
                                                   0
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

For the case with 
                           
                              
                                 λ
                                 
                                    (
                                    k
                                    )
                                 
                              
                              =
                              0
                           
                         the solution results from the critical ratio of the NVP. For λ
                        (k) ≥ 0 the critical ratio of the CNVP is applied. The assignment variable, 
                           
                              x
                              j
                              
                                 (
                                 k
                                 )
                              
                           
                         is given by:

                           
                              (17)
                              
                                 
                                    
                                       x
                                       j
                                       
                                          (
                                          k
                                          )
                                       
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                1
                                             
                                             
                                                
                                                   
                                                   for
                                                   
                                                   
                                                      q
                                                      
                                                         j
                                                         ,
                                                         opt
                                                      
                                                      
                                                         (
                                                         k
                                                         )
                                                      
                                                   
                                                   >
                                                   0
                                                
                                             
                                          
                                          
                                             
                                                
                                                   else
                                                   
                                                
                                             
                                             
                                                0
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Step 2.3: The demand calculation is then updated. To generate the distribution for the next iteration, the convolution of the different distribution functions is calculated. This is done by leveraging associativity and the substitution parameter βij
                        :

                           
                              (18)
                              
                                 
                                    
                                       f
                                       
                                          
                                             D
                                             ^
                                          
                                          j
                                       
                                       
                                          (
                                          k
                                          )
                                       
                                    
                                    =
                                    
                                       f
                                       
                                          D
                                          j
                                       
                                    
                                    *
                                    
                                       (
                                       
                                          ⊛
                                          
                                             i
                                             ∈
                                             
                                                N
                                                −
                                             
                                             ,
                                             i
                                             ≠
                                             j
                                          
                                       
                                       
                                          f
                                          
                                             D
                                             i
                                          
                                       
                                       
                                          β
                                          
                                             i
                                             j
                                          
                                       
                                       )
                                    
                                    
                                       ∣
                                       
                                          
                                             β
                                             
                                                i
                                                j
                                             
                                          
                                          ≠
                                          0
                                       
                                    
                                    *
                                    
                                       (
                                       
                                          ⊛
                                          
                                             i
                                             ∈
                                             
                                                N
                                                +
                                             
                                             ,
                                             i
                                             ≠
                                             j
                                          
                                       
                                       
                                          f
                                          
                                             D
                                             i
                                          
                                       
                                       
                                          β
                                          
                                             i
                                             j
                                          
                                       
                                       )
                                    
                                    
                                       ∣
                                       
                                          
                                             β
                                             
                                                i
                                                j
                                             
                                          
                                          ≠
                                          0
                                       
                                    
                                 
                              
                           
                        
                     

In the aforementioned equation 
                           
                              f
                              
                                 D
                                 i
                              
                           
                         is used and explicitly not 
                           
                              
                                 f
                                 
                                    
                                       D
                                       ^
                                    
                                    i
                                 
                                 
                                    (
                                    k
                                    )
                                 
                              
                              ,
                           
                         since only one-time substitution is allowed. In addition, if the demand functions of all products, 
                           
                              
                                 f
                                 
                                    D
                                    i
                                 
                              
                              ,
                           
                        
                        
                           
                              i
                              ∈
                              N
                           
                         satisfy the assumption of normality, the convolution does not have to be calculated via Eq. (18). Using Eqs. (13) and (14) saves a significant amount of computational effort. The other steps are not affected and the procedure remains the same as in the general case.

Step 3: The stop criterion is checked. The iteration process is stopped, if the order quantities have been altered to a sufficiently small extent between two succeeding iterations, i.e., the largest difference has to be smaller than a predefined tolerance level ϵ:

                           
                              (19)
                              
                                 
                                    
                                       max
                                       
                                          j
                                          ∈
                                          N
                                       
                                    
                                    ∣
                                    
                                       q
                                       
                                          j
                                          ,
                                          opt
                                       
                                       
                                          (
                                          k
                                          )
                                       
                                    
                                    −
                                    
                                       q
                                       
                                          j
                                          ,
                                          opt
                                       
                                       
                                          (
                                          k
                                          −
                                          1
                                          )
                                       
                                    
                                    ∣
                                    ≤
                                    ϵ
                                 
                              
                           
                        A suitable value for ϵ is in the order of magnitude 
                           
                              10
                              
                                 −
                                 3
                              
                           
                        . If the inequality in (19) holds true, the solution of the relaxation is stopped and the algorithm moves on to solve the integer problem in Part II, otherwise it continues with Step 1 of Part I.

The integer part of the algorithm is a modified enumeration to set 
                              
                                 q
                                 
                                    j
                                    ,
                                    opt
                                 
                                 
                                    (
                                    k
                                    )
                                 
                              
                            to integer values. As a result of the relaxation, the modification involves rounding up and down the optimal solution of the relaxation. This generates a solution space of 2
                              N
                            possible integer order quantities. One restriction that the solution space has to obey is the maximum shelf space capacity. The aim of this method is to minimize the solution space. All elements of the resulting solution space have to be evaluated and the best one is the global optimal order quantities. In detail, this involves the following steps (see Fig. 5
                           
                           ):

Step 4: A list of feasible integer solutions is generated. This is done via a combination of “full enumeration” and deleting solutions that do not fulfill the shelf space constraint. The output of the solution for relaxation is used and all possible combinations of integer order quantities 
                              
                                 q
                                 
                                    j
                                    ,
                                    int
                                 
                                 
                                    (
                                    k
                                    )
                                 
                              
                            obtainable by floor or ceiling functions are generated.

Step 4.1: The current combinations of integer order quantities is checked for compliance with the shelf space constraint. That is, if the sum of the order quantities (for one possible combination) is greater than the maximum available shelf space the corresponding entry in the list is deleted. The resulting list only consists of entries that all meet the shelf space constraint.

Step 4.2: The objective functions for all items j, πj
                           (qj
                           ) are calculated according to Eq. (4) with 
                              
                                 
                                    f
                                    
                                       j
                                    
                                    *
                                 
                                 =
                                 
                                    f
                                    
                                       
                                          D
                                          ^
                                       
                                       j
                                    
                                    
                                       (
                                       k
                                       )
                                    
                                 
                              
                           . Summing up these values leads to the total profit, 
                              
                                 Π
                                 (
                                 
                                    q
                                    ¯
                                 
                                 ,
                                 
                                    x
                                    ¯
                                 
                                 )
                              
                           . The listing decision, xj
                           , 
                              
                                 j
                                 ∈
                                 N
                                 ,
                              
                            for a combination of order quantities can be derived analog to the solution for the relaxation:

                              
                                 
                                    
                                       
                                          x
                                          j
                                       
                                       =
                                       
                                          {
                                          
                                             
                                                
                                                   
                                                      1
                                                      
                                                      for
                                                      
                                                      
                                                         q
                                                         
                                                            j
                                                            ,
                                                            int
                                                         
                                                      
                                                      >
                                                      0
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      else
                                                      
                                                      0
                                                   
                                                
                                             
                                          
                                       
                                       ∀
                                       j
                                       ∈
                                       N
                                    
                                 
                              
                           
                        

Step 5: The final step is to select the most profitable solution and the corresponding order quantities.

The DBALME finds the optimal solution to the CAP_SDS by evaluating all possible combinations of integer values in direct vicinity to the relaxed solution. Thus, a heuristic solution approach can be achieved more quickly by rounding the continuous values of the relaxed solution to their next possible integer values. DBALME-H is therefore identical to the DBALME described in Section 4.2 (Part I), with a modification in the process for generating integer values (Part II).

The ceiling and flooring values are combined with a check to see whether the resulting combination of order quantities still fulfills the shelf space requirement. This is implemented as follows (see Fig. 6):

First, in Step 4 the order quantities are sorted according to how close they are to the next higher integer value, i.e., the closer the non-integer value is to the next higher integer value, the higher the ranking. In Step 5 all values are floored. Starting with the first listed item, it is checked whether there is shelf space available to increase the order quantity to its next integer value (Step 6). If this is the case the order quantity is increased and the procedure continues to the next item in the list. This is continued until the shelf space is entirely filled up or the end of the sorted list is reached. The gained order quantities yield a heuristic solution to model CAP_SDS. Flooring the non-integer order quantities reduces the required shelf space in the first step and subsequently checking for the possibility of increasing individual quantities confines solutions to the feasible area. Thus, only feasible solutions can result.

Model CAP_SDS can also be solved by the heuristic suggested by Kök and Fisher (2007). However, Kök and Fisher (2007) consider a slightly different circumstance. They optimize the number of facings of products of several subcategories assuming that shelf space is limited for the entire product category. We denote this procedure “K/F-Heuristic.”

The solution method of Kök and Fisher (2007) consists of two parts, i.e., a greedy construction heuristic and a local search improvement method. The core component is a greedy heuristic that is in our case “greedy” referring to the largest increase in profit 
                           
                              Π
                              (
                              
                                 q
                                 ¯
                              
                              ,
                              
                                 x
                                 ¯
                              
                              )
                           
                        . That is, for the largest estimated value 
                           
                              Δ
                              
                                 π
                                 j
                              
                              =
                              
                                 π
                                 j
                              
                              
                                 (
                                 
                                    q
                                    j
                                 
                                 +
                                 1
                                 )
                              
                              −
                              
                                 π
                                 j
                              
                              
                                 (
                                 
                                    q
                                    j
                                 
                                 )
                              
                              ,
                           
                         the corresponding order quantity for product j, qj
                         is increased by one. The updated values are then treated in the same way until no more shelf space is available or the marginal profits become negative. The greedy heuristic constructs an initial solution. The local search method afterward sequentially reduces the order quantity of one product by one unit and uses the greedy heuristic to find better solutions in the neighborhood of the initial solution. Fig. 7
                         displays the implementation of the K/F-Heuristic applied in our case as benchmark to DBALME and DBALME-H.

In the following, we present computational tests to show the performance of the proposed algorithms. The section is divided into five subsections. Section 5.1 characterizes the test instances and models applied. We generate several test cases to prove the general applicability and efficiency of the models and algorithms. We then apply several numerical analyzes to assess the performance of the algorithms. Section 5.2 demonstrates the computational efficiency of the algorithms compared to full enumeration and to the heuristic suggested by Kök and Fisher (2007). The approximation using continuous demand is analyzed via simulation with discrete demand in Section 5.3. The results for assortment planning and order quantities with substitution effects are discussed in Section 5.4. Finally, we evaluate the impact of shelf size, substitution effects and demand variation on assortment planning with varying degrees of product homogeneity in Section 5.5.

We use model CAP_SDS presented above, taking into account substitutions that are not reflected in model CAP_SD. We add a posteriori substitution to the results of model CAP_SD to ensure comparability in the event of substitutions. This is denoted by CAP_SD*.

We denote the exact approach as DBALME and the heuristic version as DBALME-H for solving model CAP_SDS and model CAP_SD. We compute results assuming model CAP_SDS presented in Section 3 and applying DBALME and DBALME-H as shown in Section 4. For comparison reasons the model is also solved by full enumeration and a heuristic proposed by Kök and Fisher (2007).

Each test instance consists of 100 randomly generated examples if not stated otherwise. The assortment size 
                              N
                            and shelf size S are assumed to be identical for all examples of an instance. All algorithms are implemented in GNU Octave (Version 3.6.4). All tests were run on an Intel Core i5-4300U CPU @ 1.9 gigahertz–2.5 gigahertz with 8 gigabyte RAM. To make the test runs comparable and independent of OS influences, each test instance was confined to a single virtual core with 1.9 gigahertz.

We use the following criteria to evaluate the numerical results:

                              
                                 •
                                 Total profit 
                                       
                                          Π
                                          (
                                          
                                             x
                                             ¯
                                          
                                          ,
                                          
                                             q
                                             ¯
                                          
                                          )
                                       
                                     is calculated as 
                                       
                                          
                                             ∑
                                             
                                                j
                                                ∈
                                                N
                                             
                                          
                                          
                                             π
                                             j
                                          
                                          
                                             (
                                             
                                                q
                                                j
                                             
                                             )
                                          
                                       
                                     for each example. If not otherwise specified, we use the average of 100 examples in one test instance for the evaluation.

Computation time is the real time measured by Octave. The time span measured starts when the first parameters are generated and ends after the last result has been obtained. The average of the time span measured is used to measure the time for the test instance.

Assortment size is the average number of items that are carried in the assortment for all examples in one test instance. The larger the assortment size, the lower the order quantity for each qj
                                    , as shelf space S is fixed. This means that if more items are included in the assortment, the order size for each item needs to decrease to comply with the shelf space restriction.

We use randomly
                            generated input parameters for each example. These observe the following rules. Each item j, 
                              
                                 j
                                 ∈
                                 N
                              
                            has a positive item profit (rj
                            > cj
                           ) as well as a positive salvage value vj
                            and positive shortage costs sj
                           . The input parameters for all items j, 
                              
                                 j
                                 ∈
                                 N
                              
                            follow the ratio pattern rj
                            ≥ cj
                            ≥ vj
                            ≥ sj
                            and the following limits:

                              
                                 •
                                 Positive sales prices: 20 ≤ rj
                                     ≤ 300

Positive purchase costs: 10 ≤ cj
                                     ≤ 200

Positive salvage values at the end of period: 0 ≤ vj
                                     ≤ 90

Positive shortage costs: 0 ≤ sj
                                     ≤ 80

Unified item sizes: 
                                       
                                          
                                             b
                                             j
                                          
                                          =
                                          1
                                       
                                    
                                 

Normal distributed demands with parameters μj
                                     and 
                                       
                                          σ
                                          
                                             j
                                          
                                          2
                                       
                                    : 5 ≤ μj
                                     ≤ 10 and 
                                       
                                          0.5
                                          ≤
                                          
                                             σ
                                             
                                                j
                                             
                                             2
                                          
                                          ≤
                                          3.0
                                       
                                    
                                 

Substitution parameter βij
                                    : 0 ≤ βij
                                     ≤ 0.2 in the randomized test and 0 ≤ βij
                                     ≤ 1.0 in the test with fixed values. The constraint βij
                                    : ∑
                                       i
                                    
                                    βij
                                     ≤ 1 has to be fulfilled in order to obtain a convergent solution with a defined maximum. In this section we omit the OOA and OOS superscripts since we do not distinguish between the two substitution causes.

Tolerance level ϵ is 0.001. This guarantees sufficient accuracy for the relaxed part of the algorithm.

To enable the ratio between parameters as listed above, we proceed as follows. First we use uniform distribution to generate the value rj
                           . The value for cj
                            is generated via uniform distribution with a lower bound of 10 and an upper bound of min{200;rj
                           }. This procedure is applied in the same way for the other cost-related parameters. We followed a similar approach for the distribution demand parameters. We first generated the μi
                            values with a uniform distribution. To minimize the calculation errors that may occur because of the possibility of generating negative values with the normal distribution, we chose to generate the 
                              
                                 σ
                                 
                                    j
                                 
                                 2
                              
                            values with uniform distribution with an upper bound of 
                              
                                 
                                    1
                                    3
                                 
                                 ·
                                 
                                    μ
                                    i
                                 
                              
                            and a lower bound of 0.5. This ensures that the probability of negative values is considerably lower than 1 percent. If those values arise they are replaced with zero. We use identical item sizes to streamline the data analyzes and focus on the core demand effects. This assumption is not unrealistic, e.g., in categories with similar product sizes. The probability that a customer is willing to substitute an item if it is not available is assumed to be 
                              
                                 
                                    δ
                                    i
                                 
                                 =
                                 δ
                                 =
                                 0.6
                              
                            for all 
                              
                                 i
                                 ∈
                                 
                                    N
                                    −
                                 
                                 ,
                              
                            i.e., 40 percent refers to lost sales if an item is unavailable. Please note that the substitution level δ is an upper limit in this case. If the first alternative to product i, item j, j ≠ i is also not listed (i.e., 
                              
                                 j
                                 ∈
                                 
                                    N
                                    −
                                 
                              
                           ), the share of lost demand is accordingly higher.

The computation time in Table 1 lists the computational effort to solve the CAP_SDS model. The full enumeration can only be applied for small problems. Solutions were not found within three hours for N ≥ 10 since the exponential growth of the time required quickly diverges to infinity. Computations were then terminated.

For larger test cases with N ≥ 10, the DBALME-H and the K/F-Heuristic still compute solutions within seconds, whereas the DBALME can be used for problem sizes with N < 15, as illustrated in Fig. 8.

The slow increase in the DBALME-H runtime qualifies it as a time-efficient heuristic to solve large problems. The step-like appearance in the higher item numbers is due to the increase in the number of iterations, which need to be convergent. Experience shows that a further iteration step is needed approximately once every 100 items. The K/F-Heuristic represents a useful method for solving the problem even for large problem instances, but is inferior compared to the DBALME-H.

In Fig. 9
                            we analyze the solution quality of the procedures DBALME, DBALME-H, and the K/F-Heuristic with full enumeration. DBALME provides the optimal solution for all test examples. The weighted accuracy of DBALME-H is 99.8 percent. The K/F-Heuristic proves to be less accurate as DBALME-H, with a weighted accuracy of 96.8 percent.


                           Table 2
                           
                            compares the algorithms vs. full enumeration for different assortment sizes. The deviation of DBALME-H grows smaller with larger item numbers. This is due to the error of rounding to suboptimal order quantities. Increasing the number of items results in a relative decrease in the significance of the single rounding decision, thus decreasing the relative deviation from the optimal solution.

To summarize, the DBALME delivers identical solutions as the full enumeration, whereas DBALME-H shows a weighted accuracy of >99.8 percent. An accuracy of at least 98 percent is achieved in 95percent of the calculated examples. That means we have an optimal and fast algorithm for small and medium-sized problems, and an accurate and very fast algorithm for large ones. The K/F-Heuristic is a comparatively good alternative for small instances but is clearly outperformed by DBALME-H for large instances, as shown in Table 3.


                           Fig. 10
                            shows the robustness of DBALME. DBALME results in identical order quantity and assortment decisions to full enumeration for a range of different cost parameters. Since no deviation occurred in this test, this proves the robustness of DBALME. The y-axis indicates the absolute deviation of order quantities from optimal values obtained by full enumeration vs. DBALME. The x-axis indicates the different cost ratios of underestimating demand (cu
                           ) vs. costs for overestimating demand (co
                           ). It is scaled to 
                              
                                 
                                    
                                       c
                                       u
                                    
                                    
                                       c
                                       o
                                    
                                 
                                 =
                                 
                                    
                                       r
                                       −
                                       c
                                       +
                                       s
                                    
                                    
                                       c
                                       −
                                       v
                                    
                                 
                              
                           . This figure impressively reveals the robustness of the algorithm over a broad range of parameter sets, with rj
                           : 20 ≤ rj
                            ≤ 3000, cj
                           : 10 ≤ cj
                            ≤ 3000, vj
                           : 0 ≤ vj
                            ≤ 100 and sj
                           : 0 ≤ sj
                            ≤ 100 and rj
                            ≥ cj
                            ≥ vj
                            ≥ sj
                            for an example with 
                              
                                 N
                                 =
                                 6
                              
                            and 
                              
                                 S
                                 =
                                 10
                              
                           .

A further study analyzes the impact of varying S on solution accuracy and computation time of DBALME-H (see Fig. 11
                           ). In each instance we set 
                              
                                 N
                                 =
                                 6
                              
                            and adapt the average demand of product j, 
                              
                                 j
                                 ∈
                                 N
                              
                            according to the size of shelf space assumed, i.e., 
                              
                                 
                                    S
                                    
                                       μ
                                       j
                                    
                                 
                                 =
                                 0.9
                                 ,
                              
                           
                           
                              
                                 j
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 .
                                 .
                                 .
                                 ,
                                 6
                              
                           . Each instance comprises ten randomly generated test examples. The average results of these examples are presented in Fig. 11. On average DBALME-H achieves profit values that are almost identical to optimal values; the average accuracy for all instances is greater than 99 percent. Considering all individual test examples, DBALME-H achieves an accuracy of at least 98 percent. The computation times amount to between 1 and 2 seconds, and are not affected by the shelf-space size S.

These results can also be derived directly from the procedure developed since in the first part of the approach (Part I, see Fig. 4) the shelf space S only influences the Lagrangian factor λ and in the second part of the approach (Part II-H, see Fig. 6) the shelf space defines one constraint only. The number of iterations required in both parts of the procedure is therefore not explicitly affected by the shelf-space size S.

The solution approach presented approximates discrete customer demands by continuous demand distributions (
                           
                              
                                 f
                                 j
                                 *
                              
                              ,
                           
                         here abbreviated as “ContDmd”). This may result in an approximation error. In general the modeling and solution approach suggested could also be applied assuming discrete demand distributions. The computational effort, however, will noticeably increase because of the numerical operations required when convoluting the demand functions. In literature, customer demands are therefore often modeled by normal distributions even though real demands follow discrete distributions (cf. e.g., Smith & Agrawal, 2000; Kök & Fisher, 2007). Axsäter (2013), for example, shows under which circumstances a normal approximation is appropriate and sufficiently precise when modeling discrete demand distribution. We therefore follow the common practice here.

To confirm this approximation approach in our case we compare the objective function value obtained from our solution approach (Π
                        CntDmd) with that resulting from a simulation model assuming discrete customer arrivals and discrete customer demands (Π
                        Sim) that have a negative binomial distribution.

The simulation experiments conducted consist of three major steps. First, we generate instances, i.e., defining parameters, and generate the number of customers and their demands. As in Section 5.4, we assume that the average demand of all products considered requires approximately the entire shelf space. Second, we solve model CAP_SDS via procedure DBALME-H to determine the assortment and quantify the order quantities of the products. Third, we serve the purchases from the inventory one by one taking OOA and OOS into account. The instances are generated on the basis of the parameter pattern described in Section 5.1. In each simulation experiment a random number of up to 1000 customers are generated with product demands that have negative binomial distribution so that the mean and standard deviation of the demands are equal to the demand parameters μ and σ of the instance defined (see Adan, van Eenige, & Resing, 1995). Customer demands are fulfilled in ascending order of product indices as long as enough inventory is left. If the customer demand of a product exceeds its remaining inventory level, the demand is partially fulfilled, and the customer tries to substitute the remaining demand. One round of substitution is assumed according to the defined β-matrix, including the option of no substitution, i.e., customer demands get lost.

One thousand simulation experiments are conducted for each instance satisfying the criterion of sequential procedure presented by Law and Kelton (2000). A confidence level of 99 percent is assumed, and based on this the relative error is less than 1 percent of the real comparative value. Fig. 12 displays the results.

In the case of small assortments and small order sizes, e.g., 
                           
                              N
                              =
                              4
                              ,
                           
                        
                        
                           
                              S
                              =
                              10
                              ,
                           
                         the continuous demand approximation slightly underestimates the resulting profit of the discrete simulation experiments. However, in the case of larger order quantities (resulting when shelf space is increased for the same N), approximating discrete customer arrivals and their discrete demands by a normal demand distribution is almost exact. The magnitude of error decreases with increasing N and S and is below 0.2 percent for N ≥ 25. This confirms the results of Axsäter (2013).

Assume a retailer currently applying model CAP_SD when planning his assortment. In so doing, he neglects OOS and OOA substitution effects when modeling the demand functions of the products considered. Nevertheless he takes into account limited shelf space. The question arises now as to which benefit he would achieve when applying model CAP_SDS instead. In the following we analyze this question. We add a posteriori substitution to the results of model CAP_SD to ensure comparability in both cases and denote this approach CAP_SD*. Fig. 13
                        
                         presents the results of this analysis. Shelf-space size is assumed to be constant in all instances, 
                           
                              S
                              =
                              100
                           
                        . Mean demand values, μj
                        , 
                           
                              j
                              ∈
                              N
                              ,
                           
                         are therefore adapted so that the average demand of all products considered approximately requires the entire shelf space, i.e., 
                           
                              100
                              <
                              
                                 ∑
                                 
                                    j
                                    ∈
                                    N
                                 
                              
                              
                                 
                                    μ
                                    j
                                 
                                 
                                    b
                                    j
                                 
                              
                              <
                              110
                           
                        . One instance again comprises 100 test examples. The values presented are averages of these test examples.


                        Fig. 13 shows the average profit increase and the average change in assortment size, i.e., the number of products listed, when applying model CAP_SDS rather than model CAP_SD*. The results show a significant profit increase of up to 30 percent when substitution is taken into account a priori, especially when the substitution level is high. In addition, up to 16 percent fewer products are assigned to the assortment, since sales of products with a higher profit margin benefit from substitution demand of unlisted products.

Within the following investigation we analyze substitution effects in more detail considering one base data set consisting of 
                           
                              N
                              =
                              25
                           
                         products that satisfy identical demand parameters, 
                           
                              
                                 μ
                                 j
                              
                              =
                              10
                              ,
                           
                        
                        
                           
                              j
                              ∈
                              N
                           
                        . Using this base example we generate three test instances with varying degrees of product heterogeneity labeled low, medium, and high; i.e., revenue and cost parameters vary in the range of ± 5 percent for low, ± 10 percent for medium and ± 20 percent for high heterogeneity, assuming mean values of 
                           
                              r
                              =
                              50
                              ,
                           
                        
                        
                           
                              c
                              =
                              25
                              ,
                           
                        
                        
                           
                              v
                              =
                              15
                              ,
                           
                         and 
                           
                              s
                              =
                              5
                              ,
                           
                         respectively.

We vary the shelf-space size S, the substitution level δ, and the demand variability assumed for each instance. We analyze three outcomes for each of these cases, i.e., the number of products listed, additional demand generated via substitution, and profit achieved. All results are generated by solution procedure DBALME-H underlying the assumptions of model CAP_SDS.

In the first analysis we set the substitution rate to a constant level of 
                              
                                 δ
                                 =
                                 40
                              
                            percent and assume a fixed demand variability, i.e., 
                              
                                 
                                    σ
                                    j
                                 
                                 =
                                 2
                                 ,
                              
                           
                           
                              
                                 j
                                 ∈
                                 N
                              
                           . Shelf-space size S is then varied between 75 and 300. Fig. 14 depicts the results for the number of items listed (left-hand side) and the additional demand generated via substitution effects (right-hand side) as shelf-space size S increases.

The number of items listed increases with larger shelf-space size S. Limited shelf space means only the profitable products are listed. Products with lower profit margins will also be listed, as soon as more shelf space becomes available. For this reason, OOA substitution declines as shelf space S increases. Greater heterogeneity of the assortment, on the other hand, leads to fewer listed products since the more profitable products will gain additional substitution demand from unlisted products.

It is worth noting that the maximum space required for the optimal order sizes of all products, q
                           
                              j, opt, 
                              
                                 j
                                 ∈
                                 N
                                 ,
                              
                            is between 270 and 280 in the three cases considered, i.e., 
                              
                                 270
                                 <
                                 
                                    ∑
                                    
                                       j
                                       ∈
                                       N
                                    
                                 
                                 
                                    
                                       q
                                       
                                          j
                                          ,
                                          
                                             opt
                                          
                                       
                                    
                                    
                                       b
                                       j
                                    
                                 
                                 <
                                 280
                              
                           . Some shelf space above this level therefore remains unoccupied. OOS substitution however still occurs since product demand from sold-out products can be satisfied by units of their substitutes that are still available.


                           Fig. 15
                           
                            depicts the percentage profit dependent on shelf-space size S. The profit achieved for 
                              
                                 S
                                 =
                                 75
                              
                            is set at 100 percent, i.e., 
                              
                                 Π
                                 (
                                 
                                    x
                                    ¯
                                 
                                 ,
                                 
                                    q
                                    ¯
                                 
                                 |
                                 S
                                 =
                                 75
                                 )
                                 =
                                 100
                              
                            percent.

The profit functions sharply increase until a self-space level of around 
                              
                                 S
                                 =
                                 250
                              
                            is reached. This is quite obvious since larger order quantities and more listed items will increase sales and therefore increase profit. The profit increase however dissipates once S exceeds 250. From this level on all products are listed and ordered at their individual optimal order sizes. To summarize, larger shelf-space sizes increase the number of products listed and the attainable profit, but homogeneous assortments benefit more from this effect, if substitution is taken into account.

In the second investigation we vary the substitution level δ while fixing the shelf-space size at 
                              
                                 S
                                 =
                                 150
                              
                            and the demand variability at 
                              
                                 
                                    σ
                                    j
                                 
                                 =
                                 2
                                 ,
                              
                           
                           
                              
                                 j
                                 ∈
                                 N
                              
                           . The three identical test instances, low, medium, and high heterogeneity of products are considered (see above). Fig. 16 depicts the results for the number of items listed (left-hand side) and the additional demand generated via substitution effects (right-hand side) with increasing substitution level δ.

The number of items listed declines with increasing substitution level δ since a higher portion of unfulfilled demand of unlisted items can be substituted by listed items. It is therefore preferable that items with a low profit margin are not listed. Higher heterogeneity of the assortment supports this effect.

The additional demand generated via OOS and OOA substitutions is presented on the right-hand side of Fig. 16. All three heterogeneity levels demonstrate a steep incline in substitution demand as the substitution level δ increases. However, the increase in the high-heterogeneity assortment is slightly steeper. This effect is caused by the more reduced assortment size of the high-heterogeneity assortment, leading to a larger share of OOA substitution.


                           Fig. 17
                            depicts the percentage profit dependent on the substitution level δ. The profit achieved for 
                              
                                 δ
                                 =
                                 0
                              
                            is set at 100 percent, i.e., 
                              
                                 Π
                                 (
                                 
                                    x
                                    ¯
                                 
                                 ,
                                 
                                    q
                                    ¯
                                 
                                 |
                                 δ
                                 =
                                 0
                                 )
                                 =
                                 100
                              
                            percent.

The achievable profit increases as substitution level δ rises, but the degree of the increment depends on the heterogeneity level of the assortment considered. Inhomogeneous assortments offer more opportunities to gain additional profit from listed, high-margin products than homogeneous assortments. The high heterogeneity case therefore leads to the steepest profit increase when substitution level δ grows. In summary, larger substitution levels decrease the number of products listed and increase the attainable profit, but heterogeneous assortments benefit more from this effect.

In the third investigation we analyze the impact of demand variability on order size and profit. Again three identical test instances are considered: low, medium, and high heterogeneity of the assortment (see above). The shelf space and substitution level are fixed at the levels 
                              
                                 S
                                 =
                                 150
                              
                            and 
                              
                                 δ
                                 =
                                 40
                              
                            percent.

Since the outcomes depend on the relative demand variability between all products, we only vary the demand variability of one candidate product c out of all 
                              
                                 N
                                 =
                                 25
                              
                            products. Thus c is the text group and 
                              
                                 N
                                 −
                                 c
                              
                            the control group. This is implemented by varying the standard deviation σc
                            of product c and leaving the average demand rate unchanged, i.e., 
                              
                                 
                                    μ
                                    c
                                 
                                 =
                                 10
                              
                           . We then quantify the demand variability of candidate product c by its coefficient of variation CV(Dc
                           ). Note that the coefficient of variation of all other products 
                              
                                 j
                                 ∈
                                 N
                                 ,
                                 j
                                 ≠
                                 c
                              
                            are set at 
                              
                                 
                                    CV
                                 
                                 (
                                 
                                    D
                                    c
                                 
                                 )
                                 =
                                 0.1
                              
                           . We choose as candidate product c that product that achieves the maximum optimal order quantity out of all products considered when assuming 
                              
                                 
                                    CV
                                 
                                 (
                                 
                                    D
                                    j
                                 
                                 )
                                 =
                                 0.1
                                 ,
                              
                           
                           
                              
                                 j
                                 ∈
                                 N
                              
                           . This turns out to illustrate the causal relationships most vividly.

The results are presented in Fig. 18
                           . The optimal order quantity of product c, q
                           
                              c, opt, decreases when its demand variability increases (see left-hand side of Fig. 18). With increasing demand variability the risk increases having too few or too many units of this specific item c in stock. The order sizes therefore decrease and product c drops from the offered assortment at a certain variability value as c is substituted by less varying items. More heterogeneous assortments lead to larger optimal order sizes since fewer products are listed and therefore the optimal order quantities of all listed products are located at a higher level. In summary, the higher the demand variability of a product or a product range, the lower the order quantities. More heterogeneous assortments lessen this effect.

The profit however decreases when demand variability increases (see the right-hand side of Fig. 18) due to the increasing risk of having too few or too many units on stock. This becomes particularly relevant for heterogeneous assortments since fewer products are listed and each listed product contributes to a large share of revenue. In summary, the higher the demand variability of a product or product range, the lower the expected profit. More heterogeneous assortments enhance this effect.

Assortment planning has a significant impact on retailers’ profits. Assortment planning has been a focus of growing attention in recent literature (Kök et al., 2009) and substitution behaviors are examined in multiple studies (e.g., Gruen et al., 2002). This paper extends the discussion on efficient modeling of assortment management for perishable and non-perishable products with substitution. Our literature review shows that an efficient and effective solution approach has not yet been developed. Smith and Agrawal (2000) develop an assortment model with stochastic demand and substitution effects. However, the shelf space constraint is not included in the solution procedure. Kök and Fisher (2007) estimate the demand to determine assortments with shelf space restrictions and apply a heuristic for a limited problem size. However, their and other stochastic models are only capable of handling a very narrow assortment of less than 25 items. Retail practice thus benefits from an integrated assortment planning mode that provides a practical solution for relevant category sizes of more than 100 items and considers stochastic consumer demand with substitution for categories with limited shelf life.

We have filled this existing gap with the development of the CAP_SDS model. The model is based on a multi-item newsvendor model to optimize retailers’ assortments with restricted shelf space and taking into account OOA and OOS substitutions. The demand function not only includes the demand for a specific product but also the additional substituted demand for products that are not included in the assortment or temporarily not available. We develop the DBALME-H algorithm, which is time-efficient to compute for practically relevant problem sizes with a high solution quality. Numerical tests show that DBALME-H achieves nearly optimal solutions and outperforms the heuristic suggested by Kök and Fisher (2007) with regard to both computational time and solution quality.

In addition, we analyzed diverse problem instances covering a variety of relevant parameter sets. The results show that considering substitution effects while planning the assortment has a significant impact on profit and assortment structure.

Restrictions and assumptions of our model could be future research areas: (1) restocking assumptions, (2) demand effects, and (3) aspects of category captainship. (1) The model assumes fixed restocking costs. These costs could be specified in more detail, i.e., quantified by the optimal restocking cycles that would result from an integrated inventory model. Furthermore, retailers may also distinguish between group and individual product replenishment or leverage reorder options during a period. The model assumes unlimited transportation, warehouse and backroom capacity, as only showroom effects are considered. If some items have to be placed in backroom storage at the beginning of the planning period, the question arises, as to when and at what costs the shelf replenishment process of those products takes place. The replenishment costs could be specified in more detail, i.e., quantified by optimal restocking cycles resulting from an integrated inventory model. Additionally, aspects of a planning hierarchy as input to managerial constraints and enlarging the scope of the supply chain could provide additional insights. (2) Recent literature discusses the impact of the number of facings and positioning on the shelf on customer demand for a certain product (see Chandon, Hutchinson, Bradlow, & Young, 2009; Eisend, 2014). In-store marketing activities and demand-generating effects should therefore also be investigated. These particularly include space-dependent demand, positioning effects to account for different shelf layers and “eye-level” demand, price effects, and other marketing variables that generate in-store demand. We assume stationary demand. An extension would be to model weekly and annual seasonality. This would require further extending the model to include multiple periods and adding a demand estimate model. (3) Finally, a recent area of research is the analysis of effects in category captainship. For example, Kurtulus and Toktay (2011) model the effects of retailer-dominated category management vs. category captainship by a manufacturer. Martínez-de Albéniz and Roels (2011) analyze the competitive dynamics of pricing and shelf space assignment among competing manufacturers at a retail outlet. A comprehensive study should address all the relevant subjects of negotiation between manufacturers and retailers, such as assortment, prices and shelf space.

Our model builds the foundation for all these research projects and can be applied to generate additional insights into category planning.

@&#ACKNOWLEDGMENTS@&#

We would like to thank three anonymous reviewers for their valuable recommendations which significantly improved our paper.

@&#REFERENCES@&#

