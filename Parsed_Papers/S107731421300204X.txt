@&#MAIN-TITLE@&#TouchCut: Fast image and video segmentation using single-touch interaction

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           TouchCut requires only a single touch to bootstrap the object segmentation.


                        
                        
                           
                           It incorporates a new model that fuses edge, region, geometric and shape cues.


                        
                        
                           
                           A new fast dominant color extraction scheme to generate edge probability.


                        
                        
                           
                           Temporally propagated shape prior enables extension to video segmentation.


                        
                        
                           
                           Comprehensive qualitative and quantitative evaluations on images and videos.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Object cut-out

Touch interaction

Image and video segmentation

Level set methods

@&#ABSTRACT@&#


               
               
                  We present TouchCut; a robust and efficient algorithm for segmenting image and video sequences with minimal user interaction. Our algorithm requires only a single finger touch to identify the object of interest in the image or first frame of video. Our approach is based on a level set framework, with an appearance model fusing edge, region texture and geometric information sampled local to the touched point. We first present our image segmentation solution, then extend this framework to progressive (per-frame) video segmentation, encouraging temporal coherence by incorporating motion estimation and a shape prior learned from previous frames. This new approach to visual object cut-out provides a practical solution for image and video segmentation on compact touch screen devices, facilitating spatially localized media manipulation. We describe such a case study, enabling users to selectively stylize video objects to create a hand-painted effect. We demonstrate the advantages of TouchCut by quantitatively comparing against the state of the art both in terms of accuracy, and run-time performance.
               
            

@&#INTRODUCTION@&#

The segmentation of objects from cluttered natural images remains a fundamental and inherently challenging Computer Vision problem. The task is generally regarded as under-constrained since, in the absence of high level scene understanding, there can be more than one interpretation of pixels comprising the desired object of interest or ‘foreground’ object. The past decade has seen a trend toward better constraining the segmentation task through: (i) the development and increased reliance on global optimization methods and (ii) the combination of high-level prior scene understanding via user interaction with low-level cues such as color and edges observed in the image.

A key challenge of interactive segmentation is to maximize user provided prior information whilst minimizing user intervention. Although recent years have delivered significant advances, a considerable amount of user intervention is still required to achieve a satisfactory segmentation. Typically this involves the user indicating positive and negative class examples of pixels or regions. Often such indications requires correction either automatically to boost discrimination between by the positive or negative classes [1], or by the user iteratively working with the system to supply additional constraints [2]. Regardless of the interaction modality, the goal of any interactive image segmentation is to minimize the amount of effort to cut out a desired object while accurately selecting objects of interest.

To address this problem, this paper contributes an efficient algorithm for object segmentation driven by minimal user effort – a single touch. In contrast to previous interaction modes, ranging from roughly marking the desired boundary [3–5] to loosely drawing scribbles labeling the desired object and the background [6–8], to placing a bounding box around the desired object [9,10], our system requires only a single 
                        
                           (
                           x
                           ,
                           y
                           )
                        
                      coordinate from the user offering an intuitive and maximally “economical” interaction method. Our method has clear applications on emerging touch-screen tablet, mobile and pervasive devices, the form factor of which devices may be inconvenient for fine-motor interaction. Further, in some use cases (e.g. deployment in high throughput, or multi-tasking situations such as driving) the high cognitive load required to trace outlines or regions may also be undesirable.

Our core technical contribution is a new model for object segmentation that fuses edge, region, and geometric cues within a level set 
                     [11,12] framework. In contrast to previous expanding contour approaches relying on intensity gradient, our proposed model incorporates a probabilistic estimate of edge location derived from a novel dominant color extraction scheme. This scheme offers improved robustness when filling color or texture coherent regions, leading to more accurate localization of the desired object’s boundary. We also fuse this boundary information with a region-based maximum a posteriori (MAP) criterion designed to promote color similarity with pixels local to the touched foreground point. The robustness of this region-based criterion is further enhanced by a consistency constraint enforcing uniformity of deviation from the foreground color model, learned from the touched foreground region. This approach to color consistency, combined with a novel per-pixel adaptive weighting scheme, mitigates the tendency for contour expansion to skip the real boundary when color models of the foreground and background are indistinct. Finally, our proposed model also utilizes the geometric cue implied in single-touch input, that users typically touch image in close vicinity to the geometric center of the desired object.

All together, our edge-region-geometry model provides a robust and flexible description of the interactive object segmentation problem, leveraging the flexibility of level set methods to promote accurate boundary placement and strong region connectivity while requiring minimum user interaction. Using an incrementally built foreground color model, our framework also extends to address the temporally coherent video object segmentation problem, creating regions whose shape and neighborhood topology evolve smoothly over time whilst tracking the underlying video content. A motion estimation enabled shape prior is further introduced into the video adaptation to preserve temporal coherence when the foreground and background color distributions are indistinct.

Following a literature review, we briefly revisit level set methods in Section 3. We then describe the proposed framework for interactive object segmentation on still images (Section 4), explaining each of the energy terms comprising the proposed energy functional. We extend our system on still images to video sequences in Section 5, presenting an application of our proposed algorithm to tablet-based video manipulation. We present a comparative evaluation with previous work in Section 6 on both a qualitative and quantitative basis, concluding in Section 7.

@&#RELATED WORK@&#

Image segmentation underpins many visual analysis tasks and is a long-standing research topic in Computer Vision. Over the past decade a number of successful interactive approaches have emerged, enabling the user to seed or ‘scribble’ on part of the desired object and background to initialize the segmentation [6,13,7,8,10,14,15]. This approach is intuitive and generally tolerant of low accuracy user input, though requires the user to trace a contour contacting multiple points in the image. Drawing a bounding box [9,10] to constrain the spatial extent of object is simpler in many cases, taking two mouse clicks to specify the box. Yet scribble-based corrections are often needed to refine the results as the bounding box may not provide sufficiently tight capture for some object shapes.

Many methods [8,16] driven by scribbles selectively fill the desired region by expanding from the interior of the selected object outwards and do not explicitly consider the object boundary. This make it advantageous for segmenting objects with complex topologies, whilst it may suffer from a bias that favors shorter paths from the seeds. Another drawback of these methods is that it may fail to accurately identify the real object boundaries due to the lack of an explicit presentation of edge contrast.

An important class of seeded segmentation algorithm are those performing a Graph Cut optimization, after Boykov and Jolly [6] who address object segmentation in images via max-flow/min-cut energy minimization. Typical energy functionals balance the probability of pixels belonging to the foreground/background with spatial coherence constraints expressed via edge contrast. The user-specified scribbles serve as hard constraints and also provide statistical information. This region-edge combination is very effective in improving segmentations based on edge or region alone. However, there is an inherent bias of graph cut towards shorter paths, i.e. small segments as the optimization sums over the boundaries of segmented regions. By contrast, level set based methods include a length-based “ballooning” term which encourages a larger object segment (Fig. 10).

Our work is most closely related to prior image segmentation approaches using level set methods [11], which neatly enable the minimization of energy functionals such as those proposed by Mumford-Shah [17] or Zhu-Yuille [18].

An early application of level sets to image segmentation was the edge-based active contour model [19,20]. This approach depends primarily upon image gradient and therefore is sensitive to clutter and image noise, which can cause convergence to local minima that do not well describe the intended region shape. More robust approaches that encode region information were proposed later by Paragios et al. [21], who also tackle video segmentation, by modeling inter-frame difference using Laplacian or Gaussian distributions. Chan and Vese [22] propose the approach of active contours also harness Gaussian distributions, partitioning objects via intensity distributions modeled with different variances. Heiler et al. [23] also adopt Laplacan distributions for natural image segmentation.

Non-parametric methods have also been proposed to model the intensity distribution of image regions [24–26]. Although the method of modeling the distribution varies (e.g. histograms, compact encodings) all assume that pixels belonging to one region all share the same probability distribution and thus cannot handle intensity inhomogeneity in the sought regions. More recent work [27–29] have been proposed to incorporate local intensity statistics instead of modeling the intensity distribution globally for each region.

Higher level prior knowledge such as geometric shape priors have been introduced to level set framework [30–37]. Variational integration of the shape prior based on the assumption of a Gaussian distribution were proposed by Rousson and Paragios [30]. Implicit representations and distance transforms were considered to represent shape in a higher dimensional framework for optimization under level sets by Paragios et al. [31]. Tsai et al. [34] proposed a very efficient implementation of shape-driven level set segmentation by directly optimizing in the linear subspace spanned by the principal components. The use of non-parametric density estimation to model larger classes of level set based shape distributions was proposed by Cremers et al. [36] and Rousson and Cremers [35]. Paragios [38] proposes to integrate user interactive constraints to level set framework by taking into account distance from seeds, which is similar in aim to the geometric prior proposed in our work. Yezzi et al. have explored the fusion of multiple cues, including geometry, in their segmentation frameworks [39,40] and so share our goal. A more complete survey of previous works integrating multiple priors to level set framework, the reader is refereed to [41]. The incorporation of shape priors has also been investigated in non-level set based segmentation techniques. In particular, geometric priors based on distance from object center have been incorporated into Graph Cut approaches [42,43]. We later compare our proposed technique against GrabCut modified to incorporate such a shape prior [42].

One of the appealing advantages of level set methods is that they can neatly enable flexible forms of energy functionals. However, they are prone to getting stuck in a local minimum frequently caused by the sensitive edge-based term. Early approaches to edge detection aim at identifying the presence of a boundary through local measurements, such as Sobel operator [44] and Canny detector [45]. Recent local approaches incorporate color and texture information, either taking advantage of learning techniques for cue combination [46,47] or observing the local distribution of quantized color class labels without estimating a specific model for a texture region [48]. The latter approach provides a more efficient means to calculate an implicit edge indicator and is adapted in this paper.

The implicit edge detector proposed in [48] employs quantized color label as the basis of the color-texture property analysis. However, this can lead to an incorrect observation as color homogeneous regions with minor color or luminance variance might be treated non-homogeneous due to the sensitivity of color quantization. To circumvent this issue, we develop an efficient and robust dominant color extraction algorithm to facilitate the acquisition of color class label in [48]. A dominant color (DC) is defined as a set of similar colors, of which the corresponding pixels occupy a relatively large proportion in (a specific region of) an image. There have been many approaches proposed to address the DC extraction problem. Lin and Zhang [49] extract coarse DCs by considering each local maximum and its neighborhood within a diameter-fixed sphere in the HSV color space as a possible DC. Wang et al. [50] adopt EM algorithm to estimate the GMMs of the input colors. However, it is difficult to properly set the number of the Gaussians. The Generalized Lloyd Algorithm (GLA) is adopted to divide the input colors into clusters in [51,52]. Because the GLA aims at minimizing the global quantization distortion, the color ranges with high frequency are apt to be over-divided, and those with low frequency are apt to be under-divided. The Mean Shift algorithm is adopted to identify the dominant colors in [53]. However, it suffers from scale problem which makes it difficult to adaptively make a good trade-off between precision, robustness and roughness in the color histogram. To address these problems, we propose a novel non-parametric DC extraction algorithm which considers both color distribution and color similarity, to better explore the inherent characteristics of DC.

We additionally extend the proposed TouchCut segmentation system from still images to a video sequence, so facilitating interactive video object segmentation. Interactive video object segmentation systems have been proposed in recent years. Various directions have been investigated such as tracking region boundaries over time [54,55], extending 2D segmentation to 3D video volumes [56–58,8], applying graph cut segmentation on successive frames driven by motion flow [59–62]. Our algorithm propagates the foreground mask forward which initializes the segmentation on the new frame and provides a shape prior taking account of the inherent error in optical flow.

The basic idea of active contour models implemented via level set methods is that a contour 
                        
                           C
                        
                      in a domain 
                        
                           Ω
                        
                      can be represented by the zero level set of a higher level embedding function 
                        
                           ϕ
                           :
                           Ω
                           →
                           R
                        
                     . Evolving the contour 
                        
                           C
                        
                      is achieved by evolving the embedding function 
                        
                           ϕ
                        
                      which is defined as the signed distance function with 
                        
                           ϕ
                           >
                           0
                        
                      inside the contour, 
                        
                           ϕ
                           <
                           0
                        
                      outside the contour and 
                        
                           |
                           ∇
                           ϕ
                           |
                           =
                           1
                        
                      almost everywhere.

The evolution of the level set function 
                        
                           ϕ
                        
                      is governed by a partial differential equation (PDE). One can directly derive the PDE from a certain energy functional 
                        
                           E
                           (
                           ϕ
                           )
                        
                      on the space of level set functions. Subsequently one can derive the Euler–Lagrange equation which minimizes 
                        
                           E
                           (
                           ϕ
                           )
                        
                     :
                        
                           
                              
                                 
                                    ∂
                                    ϕ
                                 
                                 
                                    ∂
                                    t
                                 
                              
                              =
                              -
                              
                                 
                                    ∂
                                    E
                                    (
                                    ϕ
                                    )
                                 
                                 
                                    ∂
                                    ϕ
                                 
                              
                           
                        
                     These methods are known as variational level set methods [11]. Thus the segmentation boundary 
                        
                           C
                        
                      is derived by obtaining the best 
                        
                           ϕ
                        
                      at the zero level as
                        
                           
                              C
                              =
                              {
                              x
                              ∈
                              Ω
                              |
                              ϕ
                              (
                              x
                              )
                              =
                              0
                              }
                           
                        
                     The level set function is not uniquely defined. Depending on the chosen embedding, one can obtain slightly different evolution equations for 
                        
                           ϕ
                        
                     . This formulation enables direct incorporation of edge, shape and statistical prior information into the design of 
                        
                           E
                           (
                           ϕ
                           )
                        
                      in the segmentation framework. For instance image gradient is often incorporated to the energy function to align the contour with the boundaries of object, driven by an additional balloon force which leads to either a shrinking or an expansion of contours. It is also amenable to the introduction of shape information which was shown to significantly improve the segmentation of known objects in a given image [37].

In the level set paradigm, we propose a new energy functional taking account of probabilistic edge map, color distribution of foreground and background in an adaptive manner as well as the geometric cue implied by user touch:
                        
                           (1)
                           
                              E
                              (
                              ϕ
                              )
                              =
                              [
                              
                                 
                                    ω
                                 
                                 
                                    e
                                 
                              
                              
                                 
                                    ω
                                 
                                 
                                    a
                                 
                              
                              
                                 
                                    ω
                                 
                                 
                                    b
                                 
                              
                              
                                 
                                    ω
                                 
                                 
                                    u
                                 
                              
                              
                                 
                                    ω
                                 
                                 
                                    g
                                 
                              
                              ]
                              
                                 
                                    [
                                    
                                       
                                          E
                                       
                                       
                                          e
                                       
                                    
                                    (
                                    ϕ
                                    )
                                    
                                       
                                          E
                                       
                                       
                                          a
                                       
                                    
                                    (
                                    ϕ
                                    )
                                    
                                       
                                          E
                                       
                                       
                                          b
                                       
                                    
                                    (
                                    ϕ
                                    )
                                    
                                       
                                          E
                                       
                                       
                                          u
                                       
                                    
                                    (
                                    ϕ
                                    )
                                    
                                       
                                          E
                                       
                                       
                                          g
                                       
                                    
                                    (
                                    ϕ
                                    )
                                    ]
                                 
                                 
                                    T
                                 
                              
                              +
                              R
                              (
                              ϕ
                              )
                              ,
                           
                        
                     where
                        
                           •
                           
                              
                                 
                                    
                                       
                                          E
                                       
                                       
                                          e
                                       
                                    
                                    (
                                    ϕ
                                    )
                                 
                               is the edge probability term, which is minimized when the zero level contour of 
                                 
                                    ϕ
                                 
                               is located at the object boundaries; it is essential for the contour evolution to stop at the desired object boundary.


                              
                                 
                                    
                                       
                                          E
                                       
                                       
                                          a
                                       
                                    
                                    (
                                    ϕ
                                    )
                                 
                               is the ballooning term, which is introduced to speed up the motion of the zero level contour in the level set evolution process, necessary when the initial contour is placed far away from the desired object boundaries.


                              
                                 
                                    
                                       
                                          E
                                       
                                       
                                          u
                                       
                                    
                                    (
                                    ϕ
                                    )
                                 
                               is the foreground consistency term is tailored for single-touch interaction which preserves the consistency of appearance within zero level contour; the foreground appearance model has higher confidence than the background appearance model, especially when the desired object intersects the border of the image.


                              
                                 
                                    
                                       
                                          E
                                       
                                       
                                          b
                                       
                                    
                                    (
                                    ϕ
                                    )
                                 
                               is the Bayes statistical error term based on color distributions which measures the a posterior probability of the regions inside and outside the contour under the given prior, warranting a better separation of foreground and background.


                              
                                 
                                    
                                       
                                          E
                                       
                                       
                                          g
                                       
                                    
                                    (
                                    ϕ
                                    )
                                 
                               is the geometric cue term which incorporates a higher level semantic cue from single-touch interaction into the object segmentation framework which imposes a weak constraint that the user-input point is in the close vicinity of the geometry center of object; this allows incorporation of regions close to the touched location that significantly differ in appearance from the touched location which justified the importance of this term.


                              
                                 
                                    R
                                    (
                                    ϕ
                                    )
                                 
                               indicates the distance regularization term to ensure the stable evolution of the level set function by penalizing the deviation of the level set function from a signed distance function.

These terms can be categorized as: edge based energy, statistical prior energy, geometry energy and distance regularization. 
                        
                           [
                           
                              
                                 ω
                              
                              
                                 e
                              
                           
                           
                              
                                 ω
                              
                              
                                 a
                              
                           
                           
                              
                                 ω
                              
                              
                                 b
                              
                           
                           
                              
                                 ω
                              
                              
                                 u
                              
                           
                           
                              
                                 ω
                              
                              
                                 g
                              
                           
                           ]
                        
                      is a set of coefficients for each energy term; 
                        
                           [
                           
                              
                                 ω
                              
                              
                                 e
                              
                           
                           
                              
                                 ω
                              
                              
                                 a
                              
                           
                           
                              
                                 ω
                              
                              
                                 u
                              
                           
                           
                              
                                 ω
                              
                              
                                 g
                              
                           
                           ]
                        
                      are specified in Table 1
                     , and 
                        
                           
                              
                                 ω
                              
                              
                                 b
                              
                           
                        
                      is an adaptive parameter defined in Section 4.5. Fig. 1
                      presents an overview of the proposed system, where the dashed lines indicate these four energy categories. Each individual energy term is detailed in the following subsections, and we also illustrate the importance of each by disabling various terms to qualitatively demonstrate their contribution to segmentation performance.

Classical snakes and active contour models [19] typically use an edge detector to halt the evolution of the curve on the boundary of the desired object. The gradient based edge detector inherently captures high frequency information but not necessarily the real boundary of the desired object. Moreover, it is also sensitive to noise. The edge-based active contour model is thus not applicable to most natural images especially texture rich or noisy data.

In order to describe the edge probability of color-texture homogeneous region in natural image, we propose an approach inspired by JSEG [52], which calculates an edge indicator by observing the local distribution of color class labels without estimating a specific model for a texture region. In our proposed method, the color class labels are generated by extracting the dominant color modes and assigning each pixel with the label of according color mode.

The proposed algorithm is performed on the histogram in a CIE Lab color space due it being a perceptually uniform space, i.e. over which the differene of perceived color is approximated by Euclidean distance. The key procedure of this algorithm is shown in Fig. 2
                           .

The first step finds all the local maximums in the histogram and assigns a unique label to each of them. A histogram bin x (a vector), is a local maximum if the following condition, where 
                              
                                 H
                                 (
                                 ·
                                 )
                              
                            denotes the histogram value, and 
                              
                                 N
                                 (
                                 ·
                                 )
                              
                            denotes the neighborhood, is satisfied,
                              
                                 
                                    H
                                    (
                                    x
                                    )
                                    ⩾
                                    H
                                    (
                                    y
                                    )
                                    ,
                                    
                                    ∀
                                    
                                    y
                                    ∈
                                    N
                                    (
                                    x
                                    )
                                    .
                                 
                              
                           In case that neighboring peak bins have different labels, their labels are unified.

In the second step, the input colors are clustered via iteratively spreading the labels of all the peaks and regarding the bins with one same label as one cluster. The label spreading process is iteratively performed until every bin x with 
                              
                                 H
                                 (
                                 x
                                 )
                                 >
                                 0
                              
                            is labeled. In each iteration, bin x, which has not been labeled, may inherit the label of bin y, if 
                              
                                 H
                                 (
                                 x
                                 )
                                 ⩽
                                 H
                                 (
                                 y
                                 )
                                 ,
                                 y
                                 ∈
                                 N
                                 (
                                 x
                                 )
                              
                           . As the labels of different peaks are spread simultaneously, label of the peak that is closer to the bin is likely to arrive first. This scheme seeks the shortest ascending route to a local maximum. If multiple labels arrive at x in the same iteration, then x is labeled as the same as the neighboring bin with the larger histogram value.

A bin x is defined as a joint 
                              
                                 
                                    
                                       J
                                    
                                    
                                       t
                                    
                                 
                                 (
                                 ·
                                 ,
                                 ·
                                 )
                              
                            of two adjacent clusters 
                              
                                 Δ
                              
                            and 
                              
                                 Σ
                              
                            if the following is satisfied
                              
                                 
                                    x
                                    ∈
                                    Δ
                                    ,
                                    ∃
                                    y
                                    
                                    |
                                    
                                    (
                                    y
                                    ∈
                                    Σ
                                    )
                                    ∧
                                    [
                                    y
                                    ∈
                                    N
                                    (
                                    x
                                    )
                                    ]
                                    ∧
                                    [
                                    H
                                    (
                                    y
                                    )
                                    ⩾
                                    H
                                    (
                                    x
                                    )
                                    ]
                                    ,
                                 
                              
                           and thus 
                              
                                 x
                                 ∈
                                 
                                    
                                       J
                                    
                                    
                                       t
                                    
                                 
                                 (
                                 Δ
                                 ,
                                 Σ
                                 )
                              
                           . The connection value 
                              
                                 
                                    
                                       v
                                    
                                    
                                       c
                                    
                                 
                                 (
                                 ·
                                 ,
                                 ·
                                 )
                              
                            of these two adjacent clusters can be defined as
                              
                                 
                                    
                                       
                                          V
                                       
                                       
                                          c
                                       
                                    
                                    (
                                    Δ
                                    ,
                                    Σ
                                    )
                                    =
                                    
                                       max
                                    
                                    [
                                    H
                                    (
                                    x
                                    )
                                    |
                                    x
                                    ∈
                                    
                                       
                                          J
                                       
                                       
                                          t
                                       
                                    
                                    (
                                    Δ
                                    ,
                                    Σ
                                    )
                                    ]
                                    .
                                 
                              
                           
                        

After the second step, all the colors are clustered. However, color histograms, especially the high-resolution ones, are not smooth which normally leads to many local peaks. To make the algorithm robust to roughness of the histogram, some of the adjacent clusters should be properly merged. Considering the peaks as islets in a lake, some of small islets will be connected to form larger islets as the water level in the lake decreases. To this end, all the histogram values are first sorted in descending order. Then we scan the sorted values one by one to simulate the water level decreasing. We only consider merging the connected clusters during the scanning. The dominant mean color 
                              
                                 
                                    
                                       C
                                    
                                    
                                       m
                                    
                                 
                                 (
                                 ·
                                 )
                              
                            of each cluster 
                              
                                 Δ
                              
                            is updated as the water level h decreases as
                              
                                 
                                    
                                       
                                          C
                                       
                                       
                                          m
                                       
                                    
                                    (
                                    Δ
                                    ,
                                    h
                                    )
                                    =
                                    
                                       
                                          
                                             ∑
                                          
                                          x
                                          ·
                                          H
                                          (
                                          x
                                          )
                                       
                                       
                                          
                                             ∑
                                          
                                          H
                                          (
                                          x
                                          )
                                       
                                    
                                    |
                                    (
                                    x
                                    ∈
                                    Δ
                                    )
                                    ∧
                                    [
                                    H
                                    (
                                    x
                                    )
                                    ⩾
                                    h
                                    ]
                                 
                              
                           where x indicates both the bin and the color vector. Only the bins which are above the water level h contribute to the dominant mean color of their cluster. When the water level h reaches the joint of two adjacent clusters, they can be merged if the following two conditions are satisfied
                              
                                 
                                    |
                                    |
                                    
                                       
                                          C
                                       
                                       
                                          m
                                       
                                    
                                    (
                                    Δ
                                    ,
                                    h
                                    )
                                    -
                                    
                                       
                                          C
                                       
                                       
                                          m
                                       
                                    
                                    (
                                    Σ
                                    ,
                                    h
                                    )
                                    |
                                    |
                                    ⩽
                                    
                                       
                                          T
                                       
                                       
                                          d
                                       
                                    
                                    ,
                                 
                              
                           
                           
                              
                                 
                                    
                                       
                                          V
                                       
                                       
                                          c
                                       
                                    
                                    (
                                    Δ
                                    ,
                                    Σ
                                    )
                                    ⩾
                                    
                                       
                                          T
                                       
                                       
                                          p
                                       
                                    
                                    ·
                                    min
                                    {
                                    max
                                    [
                                    H
                                    (
                                    x
                                    )
                                    
                                    |
                                    
                                    x
                                    ∈
                                    Δ
                                    ]
                                    ,
                                    max
                                    [
                                    H
                                    (
                                    y
                                    )
                                    
                                    |
                                    
                                    y
                                    ∈
                                    Σ
                                    ]
                                    }
                                    ,
                                 
                              
                           where the threshold 
                              
                                 
                                    
                                       T
                                    
                                    
                                       d
                                    
                                 
                              
                            indicates a color difference that is distinctly visible to human eyes (suggested as 0.07) and 
                              
                                 
                                    
                                       T
                                    
                                    
                                       p
                                    
                                 
                                 ∈
                                 [
                                 0.5
                                 ,
                                 0.75
                                 ]
                              
                           . The conditions constrain that two clusters can be merged only if their dominant mean colors are similar enough and their connection value is not too small compared to their peak values.

Compared with the agglomerative algorithm used in [51,52], which only considers color similarity, the proposed cluster merging scheme also considers color distribution. When two clusters are merged, their connection relationships with other clusters will be inherited by the new cluster, so that the new cluster may be further merged with the adjacent clusters. As all the connection values are scanned, all the adjacent clusters will be considered for merging. Thus this step is finished when the iteration is over.

The average processing time on VGA (640×480) image is less than 60ms (Intel Core2 CPU 2.1GHz, single thread) which makes it a very efficient and robust algorithm for our application.

Suppose Z is the set of all N pixels in a dominant color mode map. Let 
                              
                                 z
                                 =
                                 (
                                 x
                                 ,
                                 y
                                 )
                                 ,
                                 z
                                 ∈
                                 Z
                              
                           . Z is classified into C DC modes. The means of Z and class 
                              
                                 
                                    
                                       Z
                                    
                                    
                                       i
                                    
                                 
                              
                            (
                              
                                 i
                                 ∈
                                 C
                              
                           ) in Z are
                              
                                 
                                    
                                       
                                          
                                          
                                             
                                                m
                                                =
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      N
                                                   
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         z
                                                         ∈
                                                         Z
                                                      
                                                   
                                                
                                                z
                                                ,
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                   
                                                      m
                                                   
                                                   
                                                      i
                                                   
                                                
                                                =
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         z
                                                         ∈
                                                         
                                                            
                                                               Z
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                
                                                z
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           respectively. Let
                              
                                 
                                    
                                       
                                          
                                          
                                             
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      T
                                                   
                                                
                                                =
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         z
                                                         ∈
                                                         Z
                                                      
                                                   
                                                
                                                |
                                                |
                                                z
                                                -
                                                m
                                                |
                                                
                                                   
                                                      |
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      W
                                                   
                                                
                                                =
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         i
                                                         =
                                                         1
                                                      
                                                      
                                                         C
                                                      
                                                   
                                                
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      i
                                                   
                                                
                                                =
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         i
                                                         =
                                                         1
                                                      
                                                      
                                                         C
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         z
                                                         ∈
                                                         
                                                            
                                                               Z
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                
                                                |
                                                |
                                                z
                                                -
                                                
                                                   
                                                      m
                                                   
                                                   
                                                      i
                                                   
                                                
                                                |
                                                
                                                   
                                                      |
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           be the variance of pixels in Z and the total variance of pixels belonging to the same DC mode. The edge indicator is defined as
                              
                                 
                                    J
                                    =
                                    (
                                    
                                       
                                          S
                                       
                                       
                                          T
                                       
                                    
                                    -
                                    
                                       
                                          S
                                       
                                       
                                          W
                                       
                                    
                                    )
                                    /
                                    
                                       
                                          S
                                       
                                       
                                          W
                                       
                                    
                                    .
                                 
                              
                           The value of J is large near the boundaries of color-texture homogeneous region and small in region interiors, and thus can serve as edge “probability” while suppressing high frequency information and noise as opposed to traditional edge detectors.


                           
                              
                                 
                                    
                                       E
                                    
                                    
                                       e
                                    
                                 
                              
                            incorporates the edge indicator J and is defined similarly as the geodesic model [19], which is minimized when the zero level contour of 
                              
                                 ϕ
                              
                            is located at the object boundaries
                              
                                 (2)
                                 
                                    
                                       
                                          E
                                       
                                       
                                          e
                                       
                                    
                                    =
                                    
                                       ∫
                                       
                                          Ω
                                       
                                    
                                    g
                                    δ
                                    (
                                    ϕ
                                    )
                                    |
                                    ∇
                                    ϕ
                                    |
                                    d
                                    x
                                    ,
                                 
                              
                           where 
                              
                                 g
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       1
                                       +
                                       cJ
                                    
                                 
                                 ,
                                 c
                              
                            is a constant, H is the Heaviside function and 
                              
                                 δ
                              
                            is the Dirac delta function.

We define the ballooning term as
                              
                                 (3)
                                 
                                    
                                       
                                          E
                                       
                                       
                                          a
                                       
                                    
                                    =
                                    
                                       ∫
                                       
                                          Ω
                                       
                                    
                                    gH
                                    (
                                    ϕ
                                    )
                                    d
                                    x
                                    ,
                                 
                              
                           which computes a weighted area of the region 
                              
                                 
                                    
                                       Ω
                                    
                                    
                                       ϕ
                                    
                                    
                                       +
                                    
                                 
                                 
                                 ≜
                                 
                                 {
                                 x
                                 :
                                 ϕ
                                 (
                                 x
                                 )
                                 >
                                 0
                                 }
                              
                           . This energy is introduced to speed up the motion of the zero level contour in the evolution process when the initial contour is not placed in the vicinity of the desired object boundary. The ballooning of the zero level contour is inhabited near the boundaries where J takes larger values.

A comparison of the Sobel edge map and the proposed edge probability is shown in Fig. 3
                           . The awareness of local color distribution avoids the converge of zero level contour stuck in a local minimum frequently caused by the traditional local edge detectors and facilitates the segmentation of natural image.

An optimal partition 
                           
                              P
                              (
                              Ω
                              )
                           
                         of the image plane 
                           
                              Ω
                           
                         can be computed by maximizing the a posterior probability 
                           
                              p
                              (
                              P
                              (
                              Ω
                              )
                              |
                              I
                              )
                           
                         for the given image I 
                        [12]. Applying Bayes’ rule, it can be expressed as
                           
                              
                                 p
                                 (
                                 P
                                 (
                                 Ω
                                 )
                                 |
                                 I
                                 )
                                 ∝
                                 p
                                 (
                                 I
                                 |
                                 P
                                 (
                                 Ω
                                 )
                                 )
                                 p
                                 (
                                 P
                                 (
                                 Ω
                                 )
                                 )
                                 .
                              
                           
                        
                        
                           
                              p
                              (
                              P
                              (
                              Ω
                              )
                              )
                           
                         allows to introduce prior knowledge such as geometric priors to cope with missing low-level information. Under the given prior, optimal two-region partition is achieved by maximizing
                           
                              (4)
                              
                                 p
                                 (
                                 I
                                 |
                                 P
                                 (
                                 Ω
                                 )
                                 )
                                 =
                                 p
                                 (
                                 I
                                 |
                                 
                                    
                                       Ω
                                    
                                    
                                       +
                                    
                                 
                                 )
                                 p
                                 (
                                 I
                                 |
                                 
                                    
                                       Ω
                                    
                                    
                                       -
                                    
                                 
                                 )
                                 ,
                              
                           
                        where 
                           
                              
                                 
                                    Ω
                                 
                                 
                                    +
                                 
                              
                           
                         and 
                           
                              
                                 
                                    Ω
                                 
                                 
                                    -
                                 
                              
                           
                         represent the regions inside and outside the contour respectively. Maximization of (4) is equivalent to minimizing its negative logarithm, we define 
                           
                              
                                 
                                    E
                                 
                                 
                                    b
                                 
                              
                              (
                              ϕ
                              )
                           
                         as
                           
                              (5)
                              
                                 
                                    
                                       E
                                    
                                    
                                       b
                                    
                                 
                                 (
                                 ϕ
                                 )
                                 =
                                 log
                                 p
                                 (
                                 I
                                 |
                                 
                                    
                                       Ω
                                    
                                    
                                       +
                                    
                                 
                                 )
                                 +
                                 log
                                 p
                                 (
                                 I
                                 |
                                 
                                    
                                       Ω
                                    
                                    
                                       -
                                    
                                 
                                 )
                                 .
                              
                           
                        We assume that the image I in each region is characterized by the individual pixel values at different locations 
                           
                              x
                           
                         and the pixel values are i.i.d. Let 
                           
                              ϕ
                              (
                              x
                              )
                              >
                              0
                           
                         if 
                           
                              x
                              ∈
                              
                                 
                                    Ω
                                 
                                 
                                    +
                                 
                              
                           
                         and 
                           
                              ϕ
                              (
                              x
                              )
                              <
                              0
                           
                         if 
                           
                              x
                              ∈
                              
                                 
                                    Ω
                                 
                                 
                                    -
                                 
                              
                           
                        . We reduce (5) to
                           
                              (6)
                              
                                 
                                    
                                       E
                                    
                                    
                                       b
                                    
                                 
                                 (
                                 ϕ
                                 )
                                 =
                                 -
                                 
                                    ∫
                                    
                                       Ω
                                    
                                 
                                 (
                                 H
                                 (
                                 ϕ
                                 )
                                 log
                                 p
                                 (
                                 I
                                 (
                                 x
                                 )
                                 |
                                 
                                    
                                       θ
                                    
                                    
                                       +
                                    
                                 
                                 )
                                 +
                                 (
                                 1
                                 -
                                 H
                                 (
                                 ϕ
                                 )
                                 )
                                 log
                                 p
                                 (
                                 I
                                 (
                                 x
                                 )
                                 |
                                 
                                    
                                       θ
                                    
                                    
                                       -
                                    
                                 
                                 )
                                 )
                                 d
                                 x
                                 ,
                              
                           
                        where 
                           
                              
                                 
                                    θ
                                 
                                 
                                    +
                                 
                              
                           
                         and 
                           
                              
                                 
                                    θ
                                 
                                 
                                    -
                                 
                              
                           
                         represent the foreground and background color model respectively.

The foreground and background color model are represented by Gaussian Mixture Model (GMM) as
                           
                              
                                 p
                                 (
                                 I
                                 (
                                 x
                                 )
                                 |
                                 
                                    
                                       θ
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          
                                             
                                                K
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       w
                                    
                                    
                                       ik
                                    
                                 
                                 N
                                 (
                                 I
                                 (
                                 x
                                 )
                                 ;
                                 
                                    
                                       ω
                                    
                                    
                                       ik
                                    
                                 
                                 ,
                                 
                                    
                                       Σ
                                    
                                    
                                       ik
                                    
                                 
                                 )
                                 ,
                              
                           
                        with parameters 
                           
                              
                                 
                                    w
                                 
                                 
                                    ik
                                 
                              
                              ,
                              
                                 
                                    ω
                                 
                                 
                                    ik
                                 
                              
                           
                         and 
                           
                              
                                 
                                    Σ
                                 
                                 
                                    ik
                                 
                              
                           
                         representing the weight, the mean and the covariance of the kth component. The parameters of all GMMs (
                           
                              
                                 
                                    θ
                                 
                                 
                                    i
                                 
                              
                              =
                              {
                              
                                 
                                    w
                                 
                                 
                                    ik
                                 
                              
                              ,
                              
                                 
                                    ω
                                 
                                 
                                    ik
                                 
                              
                              ,
                              
                                 
                                    Σ
                                 
                                 
                                    ik
                                 
                              
                              ,
                              i
                              =
                              1
                              ,
                              …
                              ,
                              L
                              ,
                              k
                              =
                              1
                              ,
                              …
                              ,
                              
                                 
                                    K
                                 
                                 
                                    i
                                 
                              
                              }
                           
                        ) are learned from observations of pixels; specifically the pixels in the user-specified area are assumed to be foreground and the border of the image is assumed to be the background. The second row in Fig. 1 visualizes the process of estimating the foreground and background color model.

The user-touched area is usually a part of the desired object, and thus the foreground color model has higher confidence than the background color model, especially when the desired object intersects the border of the image. We propose a foreground consistency term to enforce the minimization of foreground statistical error as
                           
                              (7)
                              
                                 
                                    
                                       E
                                    
                                    
                                       u
                                    
                                 
                                 (
                                 ϕ
                                 )
                                 =
                                 
                                    
                                       
                                          ∫
                                          
                                             Ω
                                          
                                       
                                       H
                                       (
                                       ϕ
                                       )
                                       (
                                       1
                                       -
                                       p
                                       (
                                       I
                                       (
                                       x
                                       )
                                       |
                                       
                                          
                                             θ
                                          
                                          
                                             +
                                          
                                       
                                       )
                                       )
                                       d
                                       x
                                    
                                    
                                       
                                          ∫
                                          
                                             Ω
                                          
                                       
                                       H
                                       (
                                       ϕ
                                       )
                                       d
                                       x
                                    
                                 
                                 .
                              
                           
                        This energy term computes the averaged classification error 
                           
                              1
                              -
                              p
                              (
                              I
                              (
                              x
                              )
                              |
                              
                                 
                                    θ
                                 
                                 
                                    +
                                 
                              
                              )
                           
                         inside the zero level contour regardless the accuracy of background color model. Fig. 5 gives examples where the background color model is confused with the foreground whilst foreground consistence term imposes the contour evolution proceeds as long as the foreground statistical error inside the contour is minimized.


                        Fig. 4
                        
                         presents segmentation results by disabling statistical prior energy and edge based energy respectively. Based on edge information alone, the system fails to converge to the correct object boundary without considering the global color distribution. Disabling edge based energy leads to unsmooth segmentation caused by the statistical prior error. Combining these two achieves robust segmentation in the presence of inaccurate edge information or color modeling.

People tend to select the geometrical center when they are indicating the object of interest. Although not a precise measurement, such a geometrical constraint provides a weak cue for the contour evolution process. We propose a central symmetry term to reflect this geometrical constraint, by computing the spatial deviation of the geometrical center of zero level contour from the user-input point as
                           
                              (8)
                              
                                 
                                    
                                       E
                                    
                                    
                                       g
                                    
                                 
                                 (
                                 ϕ
                                 )
                                 =
                                 |
                                 
                                    
                                       
                                          ∫
                                          
                                             Ω
                                          
                                       
                                       H
                                       (
                                       ϕ
                                       )
                                       (
                                       x
                                       -
                                       
                                          
                                             x
                                          
                                          
                                             ‾
                                          
                                       
                                       )
                                       d
                                       x
                                    
                                    
                                       
                                          ∫
                                          
                                             Ω
                                          
                                       
                                       H
                                       (
                                       ϕ
                                       )
                                       d
                                       x
                                    
                                 
                                 |
                              
                           
                        where 
                           
                              
                                 
                                    x
                                 
                                 
                                    ‾
                                 
                              
                           
                         represents the user-input point. As the desired object could have very complex shape, this term is regarded as a relatively weak indication of the desired object’s geometry. The utility of the geometric term is to allow incorporation of regions close to the touched location that significantly differ in appearance (e.g. color) from the touched location. This is well illustrated in Fig. 8; in the first example, since the touched area (white) is significantly different in color but still spatially local to the region of the blue trousers; the second example further demonstrates a situation where this higher level knowledge is explored to guide the contour evolution to segment the whole object of interest which cannot be achieved by low level color and edge information.

The proposed model incorporates the distance regularization term present in [63] to ensure stable evolution of the level set function, by penalizing the deviation of the level set function from a signed distance function. This deviation is characterized by the following integral
                           
                              (9)
                              
                                 R
                                 (
                                 ϕ
                                 )
                                 =
                                 μ
                                 
                                    ∫
                                    
                                       Ω
                                    
                                 
                                 P
                                 (
                                 |
                                 ∇
                                 ϕ
                                 |
                                 )
                                 d
                                 x
                              
                           
                        where 
                           
                              μ
                           
                         relates to the numerical stability condition detailed in Section 4.7 and 
                           
                              P
                              (
                              s
                              )
                           
                         is a double-well potential function defined as
                           
                              
                                 P
                                 (
                                 s
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         
                                                            
                                                               (
                                                               2
                                                               π
                                                               )
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                      
                                                   
                                                   (
                                                   1
                                                   -
                                                   cos
                                                   (
                                                   2
                                                   π
                                                   s
                                                   )
                                                   )
                                                   ,
                                                
                                                
                                                   if
                                                   
                                                   s
                                                   ⩽
                                                   1
                                                   ,
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         (
                                                         s
                                                         -
                                                         1
                                                         )
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   ,
                                                
                                                
                                                   if
                                                   
                                                   s
                                                   ⩾
                                                   1
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        This potential function maintains the signed distance property 
                           
                              |
                              ∇
                              ϕ
                              |
                              =
                              1
                           
                         only in a vicinity of the zero level contour, while keeps the embedding function 
                           
                              ϕ
                           
                         as a constant with 
                           
                              |
                              ∇
                              ϕ
                              |
                              =
                              0
                           
                         at locations far away from the zero level contour.

Minimizing the proposed energy functional (1) with constant coefficients usually gives good segmentations. However, when the foreground and background distribution is not distinct, the Bayes error term would be non-discriminative and the contour evolution process would not converge to the desired object boundaries. In this case, the weight of Bayes’ error term should be relatively small to increase the influence of other reliable terms. We expect it to be adaptively tuned based on the color modeling error on a per image basis. To this end, we estimate the misclassifying error in foreground/background seeds based on the posterior probability
                           
                              
                                 η
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       |
                                       
                                          
                                             Ω
                                          
                                          
                                             +
                                          
                                       
                                       |
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          x
                                          ∈
                                          
                                             
                                                Ω
                                             
                                             
                                                +
                                             
                                          
                                       
                                    
                                 
                                 p
                                 (
                                 I
                                 (
                                 x
                                 )
                                 |
                                 
                                    
                                       θ
                                    
                                    
                                       -
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       1
                                    
                                    
                                       |
                                       
                                          
                                             Ω
                                          
                                          
                                             -
                                          
                                       
                                       |
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          x
                                          ∈
                                          
                                             
                                                Ω
                                             
                                             
                                                -
                                             
                                          
                                       
                                    
                                 
                                 p
                                 (
                                 I
                                 (
                                 x
                                 )
                                 |
                                 
                                    
                                       θ
                                    
                                    
                                       +
                                    
                                 
                                 )
                              
                           
                        and define coefficient 
                           
                              
                                 
                                    ω
                                 
                                 
                                    b
                                 
                              
                              =
                              max
                              {
                              
                                 
                                    
                                       
                                          ω
                                       
                                       
                                          b
                                       
                                    
                                 
                                 
                                    ‾
                                 
                              
                              (
                              1
                              -
                              η
                              )
                              ,
                              0
                              }
                           
                        . When the misclassifying error 
                           
                              η
                           
                         is close to zero, the weight approaches 
                           
                              
                                 
                                    
                                       
                                          ω
                                       
                                       
                                          b
                                       
                                    
                                 
                                 
                                    ‾
                                 
                              
                           
                        . When the color models are indistinct, 
                           
                              
                                 
                                    ω
                                 
                                 
                                    b
                                 
                              
                           
                         approaches 0.

We empirically choose the weights listed in Table 1 by evaluating the segmentation quality resulted by a large range of weights. However note the system is not highly sensitive to weight choices and a single pre-configured system using the same weightings is applicable to a broad class of imagery tested. We owe this to the balance of energies in our proposed object segmentation model, as well as the adaptive weighting scheme we adopted described in Section 4.5. Fig. 8 demonstrates the effect on the segmentation result by significantly raising or lowering the weights 
                           
                              
                                 
                                    ω
                                 
                                 
                                    e
                                 
                              
                              ,
                              
                                 
                                    ω
                                 
                                 
                                    a
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          ω
                                       
                                       
                                          b
                                       
                                    
                                 
                                 
                                    ‾
                                 
                              
                           
                         and 
                           
                              
                                 
                                    ω
                                 
                                 
                                    u
                                 
                              
                           
                        , compared to the result (row 1 right) using our chosen weights listed in Table 1. Lower 
                           
                              
                                 
                                    ω
                                 
                                 
                                    e
                                 
                              
                           
                         (row 2 left) causes mis-segmentation dominated by statistic prior energy when the color distributions of foreground and background are not distinct, whilst higher 
                           
                              
                                 
                                    ω
                                 
                                 
                                    e
                                 
                              
                           
                         (row 2 right) stops the contour evolution at strong local edges. Lower 
                           
                              
                                 
                                    ω
                                 
                                 
                                    a
                                 
                              
                           
                         (row 3 left) causes prematured convergence whilst higher 
                           
                              
                                 
                                    ω
                                 
                                 
                                    a
                                 
                              
                           
                         (row 3 right) forces the contour to exceed the real boundary. Adjusting 
                           
                              
                                 
                                    
                                       
                                          ω
                                       
                                       
                                          b
                                       
                                    
                                 
                                 
                                    ‾
                                 
                              
                           
                         (row 4) around our chosen weight results in similar observations as adjusting 
                           
                              
                                 
                                    ω
                                 
                                 
                                    e
                                 
                              
                           
                         inversely. Higher 
                           
                              
                                 
                                    ω
                                 
                                 
                                    u
                                 
                              
                           
                         (row 5 right) strongly enforces the foreground consistency which results in under-segmentation compared to lower 
                           
                              
                                 
                                    ω
                                 
                                 
                                    u
                                 
                              
                           
                         (row 5 left). The weight of geometry energy 
                           
                              
                                 
                                    ω
                                 
                                 
                                    g
                                 
                              
                           
                         is relatively insensitive, though its presence incorporates the strong indication of higher-level semantic (Fig. 6
                        ).

We use the standard gradient descent method to minimize the energy functional (1)
                        
                           
                              (10)
                              
                                 
                                    
                                       ∂
                                       ϕ
                                    
                                    
                                       ∂
                                       t
                                    
                                 
                                 =
                                 -
                                 
                                    
                                       ∂
                                       
                                          
                                             E
                                          
                                          
                                             e
                                          
                                       
                                       (
                                       ϕ
                                       )
                                    
                                    
                                       ∂
                                       ϕ
                                    
                                 
                                 -
                                 
                                    
                                       ∂
                                       
                                          
                                             E
                                          
                                          
                                             b
                                          
                                       
                                       (
                                       ϕ
                                       )
                                    
                                    
                                       ∂
                                       ϕ
                                    
                                 
                                 -
                                 
                                    
                                       ∂
                                       
                                          
                                             E
                                          
                                          
                                             u
                                          
                                       
                                       (
                                       ϕ
                                       )
                                    
                                    
                                       ∂
                                       ϕ
                                    
                                 
                                 -
                                 
                                    
                                       ∂
                                       
                                          
                                             E
                                          
                                          
                                             g
                                          
                                       
                                       (
                                       ϕ
                                       )
                                    
                                    
                                       ∂
                                       ϕ
                                    
                                 
                                 -
                                 
                                    
                                       ∂
                                       
                                          
                                             E
                                          
                                          
                                             a
                                          
                                       
                                       (
                                       ϕ
                                       )
                                    
                                    
                                       ∂
                                       ϕ
                                    
                                 
                                 -
                                 
                                    
                                       ∂
                                       R
                                       (
                                       ϕ
                                       )
                                    
                                    
                                       ∂
                                       ϕ
                                    
                                 
                              
                           
                        where the gradient flows are deducted as follows:
                           
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   ∂
                                                   
                                                      
                                                         E
                                                      
                                                      
                                                         e
                                                      
                                                   
                                                   (
                                                   ϕ
                                                   )
                                                
                                                
                                                   ∂
                                                   ϕ
                                                
                                             
                                             =
                                             
                                                
                                                   ω
                                                
                                                
                                                   e
                                                
                                             
                                             δ
                                             (
                                             ϕ
                                             )
                                             div
                                             (
                                             g
                                             
                                                
                                                   ∇
                                                   ϕ
                                                
                                                
                                                   |
                                                   ∇
                                                   ϕ
                                                   |
                                                
                                             
                                             )
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   ∂
                                                   
                                                      
                                                         E
                                                      
                                                      
                                                         b
                                                      
                                                   
                                                   (
                                                   ϕ
                                                   )
                                                
                                                
                                                   ∂
                                                   ϕ
                                                
                                             
                                             =
                                             
                                                
                                                   ω
                                                
                                                
                                                   b
                                                
                                             
                                             δ
                                             (
                                             ϕ
                                             )
                                             log
                                             
                                                
                                                   p
                                                   (
                                                   I
                                                   (
                                                   x
                                                   )
                                                   |
                                                   
                                                      
                                                         θ
                                                      
                                                      
                                                         +
                                                      
                                                   
                                                   )
                                                
                                                
                                                   p
                                                   (
                                                   I
                                                   (
                                                   x
                                                   )
                                                   |
                                                   
                                                      
                                                         θ
                                                      
                                                      
                                                         -
                                                      
                                                   
                                                   )
                                                
                                             
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   ∂
                                                   
                                                      
                                                         E
                                                      
                                                      
                                                         u
                                                      
                                                   
                                                   (
                                                   ϕ
                                                   )
                                                
                                                
                                                   ∂
                                                   ϕ
                                                
                                             
                                             =
                                             
                                                
                                                   ω
                                                
                                                
                                                   u
                                                
                                             
                                             δ
                                             (
                                             ϕ
                                             )
                                             [
                                             
                                                
                                                   (
                                                   1
                                                   -
                                                   p
                                                   (
                                                   I
                                                   (
                                                   x
                                                   )
                                                   |
                                                   
                                                      
                                                         θ
                                                      
                                                      
                                                         +
                                                      
                                                   
                                                   )
                                                   )
                                                
                                                
                                                   
                                                      
                                                         (
                                                         
                                                            ∫
                                                            
                                                               Ω
                                                            
                                                         
                                                         H
                                                         (
                                                         ϕ
                                                         )
                                                         d
                                                         x
                                                         )
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                             
                                             -
                                             
                                                
                                                   
                                                      ∫
                                                      
                                                         Ω
                                                      
                                                   
                                                   (
                                                   1
                                                   -
                                                   p
                                                   (
                                                   I
                                                   (
                                                   x
                                                   )
                                                   |
                                                   
                                                      
                                                         θ
                                                      
                                                      
                                                         +
                                                      
                                                   
                                                   )
                                                   )
                                                   H
                                                   (
                                                   ϕ
                                                   )
                                                   d
                                                   x
                                                
                                                
                                                   
                                                      
                                                         (
                                                         
                                                            ∫
                                                            
                                                               Ω
                                                            
                                                         
                                                         H
                                                         (
                                                         ϕ
                                                         )
                                                         d
                                                         x
                                                         )
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             ]
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   ∂
                                                   
                                                      
                                                         E
                                                      
                                                      
                                                         g
                                                      
                                                   
                                                   (
                                                   ϕ
                                                   )
                                                
                                                
                                                   ∂
                                                   ϕ
                                                
                                             
                                             =
                                             
                                                
                                                   ω
                                                
                                                
                                                   g
                                                
                                             
                                             δ
                                             (
                                             ϕ
                                             )
                                             
                                                
                                                   |
                                                   (
                                                   x
                                                   -
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         ‾
                                                      
                                                   
                                                   )
                                                   -
                                                   
                                                      ∫
                                                      
                                                         Ω
                                                      
                                                   
                                                   (
                                                   x
                                                   -
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         ‾
                                                      
                                                   
                                                   )
                                                   H
                                                   (
                                                   ϕ
                                                   )
                                                   d
                                                   x
                                                   |
                                                
                                                
                                                   
                                                      
                                                         (
                                                         
                                                            ∫
                                                            
                                                               Ω
                                                            
                                                         
                                                         H
                                                         (
                                                         ϕ
                                                         )
                                                         d
                                                         x
                                                         )
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   ∂
                                                   
                                                      
                                                         E
                                                      
                                                      
                                                         a
                                                      
                                                   
                                                   (
                                                   ϕ
                                                   )
                                                
                                                
                                                   ∂
                                                   ϕ
                                                
                                             
                                             =
                                             
                                                
                                                   ω
                                                
                                                
                                                   a
                                                
                                             
                                             g
                                             δ
                                             (
                                             ϕ
                                             )
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   ∂
                                                   R
                                                   (
                                                   ϕ
                                                   )
                                                
                                                
                                                   ∂
                                                   ϕ
                                                
                                             
                                             =
                                             μ
                                             div
                                             (
                                             
                                                
                                                   
                                                      
                                                         P
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   (
                                                   |
                                                   ∇
                                                   ϕ
                                                   |
                                                   )
                                                
                                                
                                                   |
                                                   ∇
                                                   ϕ
                                                   |
                                                
                                             
                                             ∇
                                             ϕ
                                             )
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

To discretize the equations, we use a finite differences scheme. Considering the 2D case with a time dependent embedding function 
                           
                              ϕ
                              (
                              x
                              ,
                              y
                              ,
                              t
                              )
                           
                        , the spatial derivatives 
                           
                              ∂
                              ϕ
                              /
                              ∂
                              x
                           
                         and 
                           
                              ∂
                              ϕ
                              /
                              ∂
                              y
                           
                         are approximated by the central difference, where the space steps are fixed as 
                           
                              Δ
                              x
                              =
                              Δ
                              y
                              =
                              1
                           
                        . The temporal partial derivative 
                           
                              ∂
                              ϕ
                              /
                              ∂
                              t
                           
                         is approximated by the forward difference.

We discretize embedding function 
                           
                              ϕ
                              (
                              x
                              ,
                              y
                              ,
                              t
                              )
                           
                         as 
                           
                              
                                 
                                    ϕ
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                                 
                                    k
                                 
                              
                           
                        , where 
                           
                              (
                              i
                              ,
                              j
                              )
                           
                         is the spatial index and k is the temporal index. The level set evolution Eq. (1) is discretized as 
                           
                              (
                              
                                 
                                    ϕ
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                                 
                                    k
                                    +
                                    1
                                 
                              
                              -
                              
                                 
                                    ϕ
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                                 
                                    k
                                 
                              
                              )
                              /
                              Δ
                              t
                              =
                              F
                              (
                              
                                 
                                    ϕ
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                                 
                                    k
                                 
                              
                              )
                           
                         where 
                           
                              F
                              (
                              
                                 
                                    ϕ
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                                 
                                    k
                                 
                              
                              )
                           
                         approximates the right hand side in (1). The level set evolution is then expressed as an iteration process
                           
                              (11)
                              
                                 
                                    
                                       ϕ
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       ϕ
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                    
                                       k
                                    
                                 
                                 +
                                 Δ
                                 tF
                                 (
                                 
                                    
                                       ϕ
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                    
                                       k
                                    
                                 
                                 )
                                 ,
                                 
                                 k
                                 =
                                 0
                                 ,
                                 1
                                 ,
                                 2
                                 ,
                                 …
                              
                           
                        
                     

In the implementation, the Heaviside function H is approximated by a smooth function defined by
                           
                              
                                 
                                    
                                       H
                                    
                                    
                                       ∊
                                    
                                 
                                 (
                                 x
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            1
                                                            +
                                                            
                                                               
                                                                  x
                                                               
                                                               
                                                                  ∊
                                                               
                                                            
                                                            +
                                                            
                                                               
                                                                  1
                                                               
                                                               
                                                                  π
                                                               
                                                            
                                                            sin
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           π
                                                                           x
                                                                        
                                                                        
                                                                           ∊
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   ,
                                                
                                                
                                                   |
                                                   x
                                                   |
                                                   ⩽
                                                   ∊
                                                   ,
                                                
                                             
                                             
                                                
                                                   1
                                                   ,
                                                
                                                
                                                   x
                                                   >
                                                   ∊
                                                   ,
                                                
                                             
                                             
                                                
                                                   0
                                                   ,
                                                
                                                
                                                   x
                                                   <
                                                   -
                                                   ∊
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        and the Dirac delta function 
                           
                              δ
                           
                         is approximated by
                           
                              
                                 
                                    
                                       δ
                                    
                                    
                                       ∊
                                    
                                 
                                 (
                                 x
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         2
                                                         ∊
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            1
                                                            +
                                                            cos
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           π
                                                                           x
                                                                        
                                                                        
                                                                           ∊
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   ,
                                                
                                                
                                                   |
                                                   x
                                                   |
                                                   ⩽
                                                   ∊
                                                
                                             
                                             
                                                
                                                   0
                                                   ,
                                                
                                                
                                                   |
                                                   x
                                                   |
                                                   >
                                                   ∊
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

As the Dirac delta function and the Heaviside function multiply the entire image plane in (10), only the 
                           
                              ϕ
                           
                         values in the vicinity of the zero crossing points need to be updated. This is the central idea of the narrow band methods [64]. The computational cost of a level set method can be substantially reduced by confining the computation to a narrow band around the zero level set contour. For our proposed formulation, as re-initialization is not needed due to the incorporation of distance regularization term 
                           
                              
                                 
                                    E
                                 
                                 
                                    d
                                 
                              
                           
                         
                        [63], the narrow band implementation is simple and straightforward. Our narrow band implementation allows the use of a large time step in the finite difference scheme to greatly reduce the iterations as long as the choice of the time step 
                           
                              ▵
                              t
                           
                         satisfies the Courant–Friedrichs–Lewy (CFL) condition 
                           
                              μ
                              ▵
                              t
                              <
                              (
                              1
                              /
                              4
                              )
                           
                         for numerical stability.

We adopt the narrow band method [64] to substantially reduce the computational cost of level set method by confining the computation to a narrow band around the zero level set contour. The narrow band scheme is implemented in the following major steps:
                           
                              1.
                              Compute the narrow band 
                                    
                                       
                                          
                                             B
                                          
                                          
                                             k
                                          
                                       
                                       =
                                       
                                          
                                             ⋃
                                          
                                          
                                             (
                                             i
                                             ,
                                             j
                                             )
                                             ∈
                                             
                                                
                                                   C
                                                
                                                
                                                   0
                                                
                                             
                                          
                                       
                                       
                                          
                                             N
                                          
                                          
                                             i
                                             ,
                                             j
                                          
                                       
                                    
                                 , where 
                                    
                                       
                                          
                                             C
                                          
                                          
                                             k
                                          
                                       
                                    
                                  is the set of zero crossing points of 
                                    
                                       
                                          
                                             ϕ
                                          
                                          
                                             k
                                          
                                       
                                    
                                  and 
                                    
                                       
                                          
                                             N
                                          
                                          
                                             i
                                             ,
                                             j
                                          
                                       
                                    
                                  is a 
                                    
                                       3
                                       ×
                                       3
                                    
                                  neighborhood system centered at each point 
                                    
                                       (
                                       i
                                       ,
                                       j
                                       )
                                    
                                 . If either 
                                    
                                       
                                          
                                             ϕ
                                          
                                          
                                             i
                                             -
                                             1
                                             ,
                                             j
                                          
                                       
                                       
                                          
                                             ϕ
                                          
                                          
                                             i
                                             +
                                             1
                                             ,
                                             j
                                          
                                       
                                       ⩽
                                       0
                                    
                                  or 
                                    
                                       
                                          
                                             ϕ
                                          
                                          
                                             i
                                             ,
                                             j
                                             -
                                             1
                                          
                                       
                                       
                                          
                                             ϕ
                                          
                                          
                                             i
                                             ,
                                             j
                                             +
                                             1
                                          
                                       
                                       ⩽
                                       0
                                    
                                 , point 
                                    
                                       (
                                       i
                                       ,
                                       j
                                       )
                                    
                                  is regarded as a zero crossing point. 
                                    
                                       ∀
                                       (
                                       i
                                       ,
                                       j
                                       )
                                       ∈
                                       
                                          
                                             B
                                          
                                          
                                             k
                                          
                                       
                                    
                                  and 
                                    
                                       (
                                       i
                                       ,
                                       j
                                       )
                                       
                                       ∉
                                       
                                       
                                          
                                             B
                                          
                                          
                                             k
                                             -
                                             1
                                          
                                       
                                    
                                 , set 
                                    
                                       
                                          
                                             ϕ
                                          
                                          
                                             i
                                             ,
                                             j
                                          
                                          
                                             k
                                          
                                       
                                       =
                                       2
                                    
                                  if 
                                    
                                       
                                          
                                             ϕ
                                          
                                          
                                             i
                                             ,
                                             j
                                          
                                          
                                             k
                                             -
                                             1
                                          
                                       
                                       >
                                       0
                                    
                                 , or else set 
                                    
                                       
                                          
                                             ϕ
                                          
                                          
                                             i
                                             ,
                                             j
                                          
                                          
                                             k
                                          
                                       
                                       =
                                       -
                                       2
                                    
                                  if 
                                    
                                       
                                          
                                             ϕ
                                          
                                          
                                             i
                                             ,
                                             j
                                          
                                          
                                             k
                                             -
                                             1
                                          
                                       
                                       <
                                       0
                                    
                                 .

Update the embedding function 
                                    
                                       
                                          
                                             ϕ
                                          
                                          
                                             i
                                             ,
                                             j
                                          
                                          
                                             k
                                             +
                                             1
                                          
                                       
                                       =
                                       
                                          
                                             ϕ
                                          
                                          
                                             i
                                             ,
                                             j
                                          
                                          
                                             k
                                          
                                       
                                       +
                                       Δ
                                       tF
                                       (
                                       
                                          
                                             ϕ
                                          
                                          
                                             i
                                             ,
                                             j
                                          
                                          
                                             k
                                          
                                       
                                       )
                                    
                                  on the narrow band 
                                    
                                       
                                          
                                             B
                                          
                                          
                                             k
                                          
                                       
                                    
                                 .

If k exceeds a predefined maximum number of iterations K, the evolution process is halted. Otherwise, go to (1).

In our prototype, we use a mouse click and a fixed brush size 
                           
                              σ
                           
                         to simulate the finger touch of the user. The embedding function 
                           
                              ϕ
                           
                         is initialized by extracting the contour of the user input brush stroke. The embedding function is assigned as 2 inside the contour and −2 outside the contour. We empirically choose the parameters in the formulation which are listed in Table 1. Fig. 7
                        
                         illustrates the evolution process of the zero level contour which clearly indicates the speed of convergence.

The proposed TouchCut framework enables fast object segmentation with accurate boundary placement and strong region connectivity on still images. In this section, we extend TouchCut framework to video object segmentation. As one of the potential applications enabled by the proposed system, we stylize video objects or background into paintings based on the temporally coherent object/background region map.

After acquiring the object segmentation on the initial frame, TouchCut is performed on successive video frames using both photometric properties of the current frame and prior information propagated forward from previous frames. This information consists of:
                        
                           i. an incrementally built GMM encoding the color distribution of foreground/background over past frames;

ii. an initial contour for level set evolution;

iii. an estimated foreground object mask.

The image data labeled by the binary segmentation mask on previously segmented frames underpins accurate color distribution of foreground and background region respectively when the luminance variation on successive frames is minor. In practice, to cope with variations in luminance often present in the sequence and cumulative segmentation error near boundary, the proportion of samples 
                        
                           
                              
                                 S
                              
                              
                                 l
                                 ,
                                 t
                                 -
                                 
                                    
                                       t
                                    
                                    
                                       d
                                    
                                 
                              
                           
                           ∈
                           [
                           0
                           ,
                           1
                           ]
                           (
                           
                              
                                 t
                              
                              
                                 d
                              
                           
                           >
                           0
                           )
                           ,
                           l
                           ∈
                           
                              
                                 l
                              
                              
                                 f
                              
                           
                           ,
                           
                              
                                 l
                              
                              
                                 b
                              
                           
                        
                      drawn from all foreground (
                        
                           
                              
                                 l
                              
                              
                                 f
                              
                           
                        
                     ) and background (
                        
                           
                              
                                 l
                              
                              
                                 b
                              
                           
                        
                     ) pixels from historical frame 
                        
                           
                              
                                 I
                              
                              
                                 t
                                 -
                                 
                                    
                                       t
                                    
                                    
                                       d
                                    
                                 
                              
                           
                        
                      decreases exponentially as the temporal distance 
                        
                           
                              
                                 t
                              
                              
                                 d
                              
                           
                        
                      from the current frame 
                        
                           
                              
                                 I
                              
                              
                                 t
                              
                           
                        
                      increases where 
                        
                           
                              
                                 σ
                              
                              
                                 
                                    
                                       t
                                    
                                    
                                       d
                                    
                                 
                              
                              
                                 2
                              
                           
                        
                      is determined by the level of luminance variance. Smaller 
                        
                           
                              
                                 σ
                              
                              
                                 
                                    
                                       t
                                    
                                    
                                       d
                                    
                                 
                              
                              
                                 2
                              
                           
                        
                      is selected when luminance variance is large, contributing more recent data to the GMM, otherwise the historical data contributes more to increase robustness.
                        
                           (12)
                           
                              
                                 
                                    S
                                 
                                 
                                    l
                                    ,
                                    t
                                    -
                                    
                                       
                                          t
                                       
                                       
                                          d
                                       
                                    
                                 
                              
                              ∝
                              
                                 
                                    e
                                 
                                 
                                    -
                                    
                                       
                                          t
                                       
                                       
                                          d
                                       
                                       
                                          2
                                       
                                    
                                    /
                                    
                                       
                                          σ
                                       
                                       
                                          
                                             
                                                t
                                             
                                             
                                                d
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              ,
                           
                        
                     
                  

We employ optical flow to create a per-pixel propagation of the foreground mask from frame 
                        
                           
                              
                                 I
                              
                              
                                 t
                                 -
                                 1
                              
                           
                        
                      to create an estimated mask on frame 
                        
                           
                              
                                 I
                              
                              
                                 t
                              
                           
                        
                      which is used as the shape prior 
                        
                           
                              
                                 ϕ
                              
                              
                                 ̃
                              
                           
                        
                      which takes the value of the initial embedding function. We propose a shape energy term measuring the shape dissimilarity of two shapes represented by the embedding functions 
                        
                           ϕ
                        
                      and 
                        
                           
                              
                                 ϕ
                              
                              
                                 ̃
                              
                           
                        
                     , which is commonly computing the area of the set symmetric difference
                        
                           (13)
                           
                              
                                 
                                    E
                                 
                                 
                                    s
                                 
                              
                              (
                              ϕ
                              )
                              =
                              
                                 
                                    ω
                                 
                                 
                                    s
                                 
                              
                              
                                 ∫
                                 
                                    Ω
                                 
                              
                              
                                 
                                    (
                                    H
                                    (
                                    ϕ
                                    )
                                    -
                                    H
                                    (
                                    
                                       
                                          ϕ
                                       
                                       
                                          ̃
                                       
                                    
                                    )
                                    )
                                 
                                 
                                    2
                                 
                              
                              d
                              x
                              .
                           
                        
                     
                     
                        
                           
                              
                                 ω
                              
                              
                                 s
                              
                           
                        
                      is inversely proportional to the alignment error in the scope of the foreground object 
                        
                           
                              
                                 Ω
                              
                              
                                 f
                              
                           
                        
                     
                     
                        
                           (14)
                           
                              
                                 
                                    ω
                                 
                                 
                                    s
                                 
                              
                              ∝
                              1
                              /
                              
                                 
                                    
                                       
                                          1
                                       
                                       
                                          |
                                          
                                             
                                                Ω
                                             
                                             
                                                f
                                             
                                          
                                          |
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             x
                                             ∈
                                             
                                                
                                                   Ω
                                                
                                                
                                                   f
                                                
                                             
                                          
                                       
                                    
                                    |
                                    |
                                    
                                       
                                          I
                                       
                                       
                                          t
                                          -
                                          1
                                       
                                    
                                    (
                                    x
                                    )
                                    -
                                    
                                       
                                          I
                                       
                                       
                                          t
                                       
                                       
                                          ′
                                       
                                    
                                    (
                                    x
                                    )
                                    |
                                    
                                       
                                          |
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              .
                           
                        
                     where 
                        
                           
                              
                                 I
                              
                              
                                 t
                              
                              
                                 ′
                              
                           
                        
                      is the warped color image from frame 
                        
                           
                              
                                 I
                              
                              
                                 t
                                 -
                                 1
                              
                           
                        
                      to 
                        
                           
                              
                                 I
                              
                              
                                 t
                              
                           
                        
                      by the optical flow. Accurate alignment generally indicates reliable motion estimation and such shape priors thus contribute more to the contour evolution.

Applying the standard gradient descent method to minimize the shape energy term, we deduct the gradient flow of shape energy as
                        
                           (15)
                           
                              
                                 
                                    ∂
                                    
                                       
                                          E
                                       
                                       
                                          s
                                       
                                    
                                    (
                                    ϕ
                                    )
                                 
                                 
                                    ∂
                                    ϕ
                                 
                              
                              =
                              2
                              
                                 
                                    ω
                                 
                                 
                                    s
                                 
                              
                              δ
                              (
                              ϕ
                              )
                              (
                              H
                              (
                              ϕ
                              )
                              -
                              H
                              (
                              
                                 
                                    ϕ
                                 
                                 
                                    ̃
                                 
                              
                              )
                              )
                              .
                           
                        
                     
                  

The initial contour of TouchCut on current frame 
                        
                           
                              
                                 I
                              
                              
                                 t
                              
                           
                        
                      is acquired by computing the deviation of the initial contour 
                        
                           
                              
                                 ϕ
                              
                              
                                 0
                              
                              
                                 0
                              
                           
                        
                      on the first frame from the geometrical center 
                        
                           
                              
                                 g
                              
                              
                                 0
                              
                              
                                 0
                              
                           
                        
                     . Let the center of 
                        
                           
                              
                                 ϕ
                              
                              
                                 0
                              
                              
                                 0
                              
                           
                        
                      be 
                        
                           
                              
                                 b
                              
                              
                                 0
                              
                           
                        
                     , and the center 
                        
                           
                              
                                 b
                              
                              
                                 t
                              
                           
                        
                      of the initial contour on 
                        
                           
                              
                                 I
                              
                              
                                 t
                              
                           
                        
                      is estimated as 
                        
                           
                              
                                 b
                              
                              
                                 t
                              
                           
                           =
                           
                              
                                 g
                              
                              
                                 0
                              
                              
                                 t
                              
                           
                           +
                           
                              
                                 b
                              
                              
                                 0
                              
                           
                           -
                           
                              
                                 g
                              
                              
                                 0
                              
                              
                                 0
                              
                           
                        
                     . The geometrical center on frame 
                        
                           
                              
                                 I
                              
                              
                                 t
                              
                           
                           ,
                           
                              
                                 g
                              
                              
                                 0
                              
                              
                                 t
                              
                           
                        
                      is estimated from the estimated foreground mask. We use a circle centered at 
                        
                           
                              
                                 b
                              
                              
                                 t
                              
                           
                        
                      with a radius 
                        
                           
                              
                                 r
                              
                              
                                 c
                              
                           
                        
                      as the initial contour on frame 
                        
                           
                              
                                 I
                              
                              
                                 t
                              
                           
                        
                     . 
                        
                           
                              
                                 r
                              
                              
                                 c
                              
                           
                        
                      is two times as large as the maximum distance from the contour to the touch point on the initial frame.

Due to the inherent error of optical flow, the new initial contour might be slightly drifting from the desired object, i.e. part of the area inside the initial contour might be the background. The robust formulation based on color and shape priors push the contour evolution, minimizing the pixel classification error inside and outside the contour, while satisfying other criteria defined in the energy function, to achieve accurate and temporally coherent segmentation.

We have applied the proposed algorithm on a dataset consisting of the combined Berkeley BSDS300 dataset [65], and image dataset accompanying GrabCut [9]. We also demonstrate the application of TouchCut to video sequences exhibiting clutter and agile motion. We assess segmentation performance on both qualitatively through visual comparison to prior work, and quantitatively based on a manual ground truth segmentation. We indicate relative performance to the state of the art for both image and video comparisons.


                        Fig. 10 presents a qualitative comparison of the proposed method with standard graph cut (column 2) [6], GrabCut (column 3) [9], star-convexity prior graph cut (column 4) [42], and its variant using geodesic distance (column 5) [43]. In all cases, other than Graph cut, we adapted such the modeling of color distributions to exactly that of the proposed approach to make a fair comparison – i.e. to solely evaluate performance of the single touch segmentation paradigm. Specifically, the foreground color was modeled from the pixels in user-touch area while the background color was modeled by taking pixels from the border of the image. With significantly less user input, our method gives satisfactory segmentation even when the foreground and background colors lack distinction (first row) or regions exhibit complex topology (second row). Graph cut fails to separate the objects exhibiting a similar color to the desired object, whilst our approach fills the desired region by expanding from the interior of the selected object outwards and explicitly considers the object boundary and geometric properties. GrabCut presents better spatial constraints than graph cut, benefiting from the bounding box while failed to exclude noisy extraneous regions (e.g. the varying levels of luminance underneath the tiger) which do not appear outside the bounding box. The latter method also suffers from “short-cutting” regions (e.g. the elephant’s legs and trunk). Star-convexity prior graph cut appears to alleviate the bias of a graph cut towards shorter segmentation boundaries and also spatially confine the segmentation to the proximity of foreground (rows 4 and 5). However, the strong assumption of star convexity does not apply on complex object which restricts its applications to natural image (e.g. the elephant’s legs and trunk, and the head of the jockey), although geodesic distance is also adopted in its variant.

For our objective comparison, we adopt the measure used to evaluate segmentation quality in the VOC segmentation challenge [66] to quantify segmentation accuracy against a manual specified ground-truth, which is given by 
                           
                              
                                 
                                    y
                                    ∩
                                    
                                       
                                          y
                                       
                                       
                                          gt
                                       
                                    
                                 
                                 
                                    y
                                    ∪
                                    
                                       
                                          y
                                       
                                       
                                          gt
                                       
                                    
                                 
                              
                           
                         (with y denoting the output segmentation and 
                           
                              
                                 
                                    y
                                 
                                 
                                    gt
                                 
                              
                           
                         denoting ground truth). Table 2
                         and Fig. 9
                        
                         summarize the results of this objective comparison, confirming that the proposed method outperforms state-of-the-art methods adapted to accept a single touch, with the highest average overlap score 0.8729 across the dataset. All graph cut variants enhanced by spatial or shape constraint outperform the standard graph cut which reaches a low average overlap score 0.6640. GrabCut outperforms (average overlap score 0.8140) the star-convexity prior graph cut methods (average overlap score 0.7242 and 0.7159 respectively) owing to its robust foreground and background prior. The statistics of the segmentation overlap score in Table 2 further confirms the robustness of the proposed method across various natural images in the dataset, with a much tighter standard deviation (0.1012). The box-plot of Fig. 9 in demonstrates higher reliability than methods, such as regular Graph Cut, which have both a broader standard deviation and in sporadic poor performance (indicated by box limits). All of the above analysis matches our intuition and theory that our proposed model gives more robust representation of the object segmentation problem given very limited input.


                        Fig. 11
                         presents further segmentation results.
                           1
                           More results can be viewed online at: http://personal.ee.surrey.ac.uk/Personal/Tinghuai.Wang/CVIU2012.
                        
                        
                           1
                         The first row shows the results on highly-textured images. The edge probability map enables the contour evolution over color-texture homogeneous regions without being stopped at local minimum. The second row shows the segmentation results of images with indistinct foreground and background colors. In this case, the color modeling error is large which adaptively results in a small weight on color based term 
                           
                              
                                 
                                    E
                                 
                                 
                                    b
                                 
                              
                           
                        . On the other hand, the foreground consistency term 
                           
                              
                                 
                                    E
                                 
                                 
                                    u
                                 
                              
                           
                         enforces the region inside the zero level contour to be coherent in the sense of color distribution regardless the background color distribution. Such a constraint significantly imposes the stability of the contour evolution process in the case of indistinct color distributions. The third row contains segmentation results to deal with objects with complex shape. By leveraging the strength of the implicit contour representation in level set methods, our system is robust in coping with complex topologies without exhibiting short-cutting problem which is common in graph-cut based systems. The system is able to cope with weak boundaries and complex foregrounds and backgrounds, to extract meaningful objects in most cases.

For all image results the running time on a Core2 2.1GHz PC is constant ∼0.4s per VGA image (640×480). More representative segmentation results are presented in Fig. 12
                        .

Object segmentation provides an object level parsing for a scene, where special effects can be applied on either the object or background to create novel compositions in photography or media production. Our proposed single-touch object segmentation algorithm can deliver intuitive, efficient and precise object segmentation. We demonstrate an application of TouchCut to create oil painting effects by compositing virtual brush strokes, which is also known as stroke-based painterly rendering (SBR). We apply an automatic SBR algorithm by Shugrina et al. [67] to create novel oil painting and photo composition as shown in Fig. 13
                        , where the background scene is stylized as oil painting effects.

We quantitatively test TouchCut on three videos and ground-truth for the primary foreground object present in [68,69]. The videos tested exhibit various challenging conditions such as foreground and background color overlap, luminance variation, shape deformation and camera motion. We compare against two state-of-the-art approaches: another level set based tracking approach by Chockalingham et al. [68] and the ‘motion coherent segmentation’ method of Tsai et al. [69]. These methods require human labeling of the object boundary (contour) in the first frame, whilst TouchCut requires minimal user intervention to guide the segmentation of whole video via a single touch on the first frame. The segmentation accuracy is quantified as the average per-frame pixel error rate, 
                           
                              ∊
                              (
                              S
                              )
                              =
                              
                                 
                                    |
                                    XOR
                                    (
                                    S
                                    ,
                                    GT
                                    )
                                    |
                                 
                                 
                                    F
                                 
                              
                           
                        , where S is the segmentation, GT is the ground-truth segmentation and F is the total number of frames. As shown in Table 3
                        , our method outperforms the approaches present in [68,69] on two of the three videos (PARACHUTE, BIRDFALL), and produces the second best result on the GIRL video. Our higher error rate on GIRL is caused by the inaccurate optical flow motion estimations and indistinct color of foreground and background, which is reasonable since the object exhibits large appearance variation, considering TouchCut does not either explicitly employ global optimizations to enforce motion coherence across frames as in [69] and or manually bootstrapping the first frame. Further, TouchCut requires only a single touch to bootstrap the entire video segmentation – and we believe these comparative results to be very encouraging. Per-frame segmentaion accuracy of the three videos is shown in Fig. 16
                        . Further qualitative segmentation results with comparisons to [69] are shown in Fig. 14
                        .

We study the impact of the proposed shape prior underpinning our video segmentation, comparing against a baseline implementation that does not incorporate the shape prior, but otherwise follows the same pipeline as our full method. Fig. 15
                         shows the results. The shape energy significantly improves segmentation accuracy, quantified against a manual ground truth.

Temporally coherent segmentation of video forms a stable representation of visual structure in the scene which enables other computer vision and graphics applications. We demonstrate an application of TouchCut system on videos to create stylized region-based effects such as painterly rendering. We incorporate a framework of automatic non-photorealistic rendering by Kyprianidis and Döllner [70] to facilitate the domestic user to create artistic stylizations on either the desired object or the background scene.

As qualitative evaluation, we apply our segmentation algorithm to several video sequences exhibiting both slow moving and agile motion – summarized in Table 4
                        . Fig. 17
                         presents the segmentation results applying TouchCut to these five video sequences and the foreground object or background painterly stylization effects. Our segmentation algorithm ensures the foreground and background regions deform in a coherent manner.

In Fig. 17(a) there is significant agile motion in “YUNAKIM” – Yuna swings and suffers frequent inter-occlusion over duration of the clip. Despite the adoption of a forward propagation (2D
                        +
                        t) strategy over several hundred frames of video there is no significant degradation. With an incrementally learned GMM color model, TouchCut is able to deal with the strong luminance variation on the boy’s face (“BEACH”) and produce stable segmentations with temporal coherence present in Fig. 18
                        (a). Similar situation can be observed in “WALK” sequence, where both strong luminance variation and agile motion present. As an application of TouchCut, the domestic user can choose either the foreground or background to create special effects, i.e. painterly stylization, with single finger touch on the first frame as shown in Fig. 17 (foreground object stylized) and Fig. 18(c) (background stylized). Drawing upon the coherent video segmentation by TouchCut, the stylized videos create either a painting object in a realistic scene or a realistic object in an unrealistic scene with painting style. Other special effects would be creating a new movie with the selected object in a totally different scene or emphasizing the desired object by blurring the background.

We have presented a single-touch object segmentation system using level set methods. The core contribution is an edge-region-geometry based segmentation model to robustly tackle the interactive object segmentation problem – encoding boundary probabilities of color-texture homogeneous regions, and the statistical and geometric priors inferred from the user input. Our edge model gives a robust description of the coherent color-texture region, which mitigates against the contour becoming stuck in local minima in the presence of noisy data. This frequently occurs in prior approaches, where traditional intensity gradient-based edge maps are used. Edge information alone only provides local information to drive contour evolution towards potential object boundary. Augmenting this model with color information from user input introduced a global term, balancing the a posterior probabilities of region models inside and outside the putative object contour.

By leveraging the flexibility of level set methods in energy minimization, our system achieved promising results in various natural images with complex scenes and objects. We also demonstrated that TouchCut can be extended to segment video sequences into temporally coherent foreground and background region maps. This gives rise to potential applications to video special effects (e.g. artistic stylization) with minimal user intervention, that may be suited to consumer touch-screen video cameras. Coherence was promoted through an incrementally learned color model, providing robustness against drift of the contour otherwise caused by motion estimation error. The introduction of a shape prior into the motion estimation framework was shown to deliver a further significant enhancement to coherence, especially when the foreground and background color distribution became indistinct.

Nevertheless, TouchCut can still experiences difficulties in separating the desired object from the adjacent background in the presence of highly similar colors. This remains an open question in the image segmentation community in the absence of other higher level semantic priors, e.g. shape, or other forms of global measurement. One interesting direction for future work would be to improve the background color modeling by measuring the salience of different dominant color modes. Another direction of future work with respect to the video extension might include detecting occlusion boundaries discovered from motion disparity in the scene, and using these to compensate for any ambiguity in appearance between the foreground and background.

Future applications of TouchCut fall within our original project motivation, to develop an image and video object segmentation algorithm with minimal user intervention suitable for emerging tablet and touch-screen devices. These applications could span embedded object extraction and tracking, intelligent focus, and video stylization [71,72] on these devices.

@&#REFERENCES@&#

