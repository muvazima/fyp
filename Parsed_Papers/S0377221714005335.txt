@&#MAIN-TITLE@&#The economic lot-sizing problem with an emission capacity constraint

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We consider a lot-sizing problem with one global constraint on carbon emissions.


                        
                        
                           
                           We show that this problem is NP-hard.


                        
                        
                           
                           We present a Lagrangian heuristic, pseudo-polynomial algorithm and FPTAS.


                        
                        
                           
                           Special attention is paid to an efficient implementation of the FPTAS.


                        
                        
                           
                           Tests show that a combination of the heuristic and FPTAS is very fast.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Integer programming

Approximation scheme

Lot-sizing

Carbon emissions

@&#ABSTRACT@&#


               
               
                  We consider a generalisation of the lot-sizing problem that includes an emission capacity constraint. Besides the usual financial costs, there are emissions associated with production, keeping inventory and setting up the production process. Because the capacity constraint on the emissions can be seen as a constraint on an alternative objective function, there is also a clear link with bi-objective optimisation. We show that lot-sizing with an emission capacity constraint is 
                        
                           NP
                        
                     -hard and propose several solution methods. Our algorithms are not only able to handle a fixed-plus-linear cost structure, but also more general concave cost and emission functions. First, we present a Lagrangian heuristic to provide a feasible solution and lower bound for the problem. For costs and emissions such that the zero inventory property is satisfied, we give a pseudo-polynomial algorithm, which can also be used to identify the complete set of Pareto optimal solutions of the bi-objective lot-sizing problem. Furthermore, we present a fully polynomial time approximation scheme (FPTAS) for such costs and emissions and extend it to deal with general costs and emissions. Special attention is paid to an efficient implementation with an improved rounding technique to reduce the a posteriori gap, and a combination of the FPTASes and a heuristic lower bound. Extensive computational tests show that the Lagrangian heuristic gives solutions that are very close to the optimum. Moreover, the FPTASes have a much better performance in terms of their actual gap than the a priori imposed performance, and, especially if the heuristic’s lower bound is used, they are very fast.
               
            

@&#INTRODUCTION@&#

In recent years, there has been a growing tendency to not only focus on financial costs in a production process, but also on its impact on the environment. An important example of an environmental implication is the emission of pollutants during production. Particular interest is paid to the emission of greenhouse gases, such as carbon dioxide (CO2), nitrous oxide (N2O) and methane (CH4). By now, there is a general consensus about the effect that these gases have on global warming. Consequently, many countries strive towards a reduction of these greenhouse gases, as formalised in treaties, such as the Kyoto Protocol (United Nations, 1998), as well as in legislation, of which the European Union Emissions Trading System (European Commission, 2010) is an important example.

The shift towards a more environmentally friendly production process can be caused by such legal restrictions, but also by a company’s desire to pursue a ‘greener’ image by reducing its carbon footprint. As Vélazquez-Martínez, Fransoo, Blanco, and Mora-Vargas (2014) mention: “A substantial number of companies publicly state carbon emission reduction targets. For instance, in the 2011 Carbon Disclosure Project annual report (Carbon Disclosure Project, 2011), 926 companies publicly commit to a self-imposed carbon target, such as FedEx, UPS, Wal-Mart, AstraZeneca, PepsiCo, Coca-Cola, Danone, Volkswagen, Campbell and Ericsson.”

In order to reduce their carbon footprints, companies can reduce their emissions by, for instance, using less polluting machines or vehicles, or using cleaner energy sources. One should not overlook the potential benefit that changing operational decisions has on emission reduction. As mentioned by Absi, Dauzère-Pérèz, Kedad-Sidhoum, Penz, and Rapine (2013), examples of studies at the operational level are Bektas and Laporte (2011) who consider a vehicle routing problem where the objective function consists of both travel distance and environmental costs, and Fang, Uhan, Zhao, and Sutherland (2011) who study a flow shop scheduling problem with both cycle time and environmental factors as an objective. Also in production planning there is no guarantee that minimising costs of operations will lead to low emissions. In fact, fashionable production strategies like just-in-time production, with its frequent less-than-truckload shipments and frequent change-overs on machines, may lead to emission levels that are far from optimal.

For these reasons, we consider a generalisation of the classic economic lot-sizing model. Besides the usual financial costs, emission levels are associated with production, keeping inventory and setting up the production process. Set-up emissions can for example originate from having fixed per-truckload emissions of an order, or from a production process that needs to ‘warm up’ (see e.g. Jans & Degraeve, 2004), where usable products are not created until the production process has gone through a set-up phase that is already polluting. Keeping inventory can also emit pollutants, for instance because products need to be stored in a specific way, e.g. refrigerated, or because of lighting systems in a warehouse, which emit indirectly due to their electricity consumption. The lot-sizing model that we consider in this paper minimises the (financial) costs under an emission capacity constraint. This constraint is imposed as one global restriction over all periods. This problem was introduced by Benjaafar, Li, and Daskin (2013), who integrate carbon emission constraints in lot-sizing models in several ways. They consider a capacity on the total emissions over the entire problem horizon, as we do in this paper, but also a carbon tax, a capacity combined with emissions trade, or carbon offsets (where additional emission rights may be bought, but not sold). Moreover, they study the effect of collaboration between multiple firms within a serial supply chain. They examine how the values of the problem parameters, as well as the parameters of regulatory emission control policies, affect costs and emissions. They assume that all cost and emission functions follow a fixed-plus-linear structure, and no attention is paid to finding good solution methods.

In our paper, we study a lot-sizing problem with an emission constraint under concave cost and emission functions. We show that this problem is 
                        
                           NP
                        
                     -hard, even if only production emits pollutants (linearly). We will see that this model is also capable of handling multiple production modes. Furthermore, we develop several solution methods. First, we develop a Lagrangian heuristic that finds both very good solutions and a lower bound in 
                        
                           O
                           (
                           
                              
                                 T
                              
                              
                                 4
                              
                           
                           )
                        
                      time, where T is the number of time periods. We also prove several structural properties of an optimal solution that we use while working towards a fully polynomial time approximation scheme (FPTAS). As a first step, a pseudo-polynomial algorithm is developed in case the costs and emissions are such that the single-sourcing (or zero inventory) property is satisfied in an optimal solution, that is, there is no period with both strictly positive production and strictly positive incoming inventory. This pseudo-polynomial algorithm is then turned into an FPTAS, which, in turn, is generalised to deal with costs and emissions that do not satisfy the single-sourcing property. We expect that this technique to construct a pseudo-polynomial algorithm and an FPTAS can be applied to more problems where one overall capacity constraint is added to a problem for which a polynomial time dynamic program exists.

Special attention is paid to an efficient practical implementation of these algorithms. This includes a combination of the lower bound that is provided by the Lagrangian heuristic with an FPTAS. This combination results in excellent solutions within short computation times, as becomes clear from the extensive computational tests of all algorithms that have been carried out for this paper. Besides that, our algorithms do not only have an a priori gap (
                        
                           ε
                        
                     ), but they also produce a (smaller) a posteriori gap. To reduce this gap even further, we develop an improved rounding technique, which we think can be applied to other FPTASes of the same type. Furthermore, if we compare the algorithms’ solutions to the optima, we see that the gaps are even much smaller.

The model is more general than it looks at first sight, since the ‘emissions’ in the ‘emission constraint’ that we consider do not necessarily need to literally refer to emissions. They can be any kind of costs or output, other than those in the objective function, related to the three types of decisions (i.e., set-up, production and inventory). This makes the relationship with bi-objective lot-sizing clear. In multi-objective optimisation (and bi-objective optimisation in particular), one is usually interested in the set of Pareto optimal solutions or Pareto optimal set for short. Theoretically, finding the optimal costs for all possible emission capacities would result in finding the Pareto optimal set. The multi-objective lot-sizing problem is studied in more detail by Van den Heuvel, Romeijn, Romero Morales, and Wagelmans (2011), who divide the horizon in several blocks, each with its own objective function. The case with one block of length T corresponds to our problem (with fixed-plus-linear costs and emissions). In our paper, we will show that we can find the Pareto optimal set in pseudo-polynomial time, if the costs and emissions are such that the single-sourcing (zero-inventory) property is satisfied.

Besides the works of Benjaafar et al. (2013) and Van den Heuvel et al. (2011), there are other papers that integrate carbon emission constraints in lot-sizing problems. Absi et al. (2013) introduce several lot-sizing models with multiple production modes and a constraint on the average amount of emission per unit produced, which may be on a periodic, cumulative, global (as we have) or rolling horizon basis. Although the models are similar to our work, the main difference is the type of emission constraint: we have a bound on the total emission, which acts as a kind of capacity constraint, while Absi et al. (2013) have a bound on the average emission per unit produced. Furthermore, in Absi et al. (2013) the emission is linear in the amount produced, while our emission functions are more general with emissions caused by setups and holding inventory. Since our model can also handle multiple production modes, the models coincide (except for the emission function structure) in case of a global emission constraint. Vélazquez-Martínez et al. (2014) study the effect of different levels of aggregation to estimate the transportation carbon emissions in the economic lot-sizing model with backlogging. Heck and Schmidt (2010) discuss lot-sizing with an ‘eco-term’, which they solve heuristically with an ‘eco-enhanced’ Wagner–Whitin and Part Period Balancing algorithm, with the possibility of ‘eco-balancing’. Other papers approach the emission problem from an EOQ (economic order quantity) point of view, such as Chen, Benjaafar, and Elomri (2013), Hua, Cheng, and Wang (2011), and Bouchery, Ghaffari, Jemai, and Dallery (2012).

The remainder of this paper is organised as follows. The next section provides a formal, mathematical definition of the lot-sizing problem with a global emission capacity constraint. In Section 3, we show that this problem, as well as a variant with two production modes, is 
                        
                           NP
                        
                     -hard under quite general conditions. Furthermore, we prove several structural properties of an optimal solution, which are used by the algorithms that are introduced in Section 4. Section 4.1 gives a Lagrangian heuristic. Sections 4.2 and 4.3 present a pseudo-polynomial algorithm, respectively FPTAS, for what we will define as co-behaving costs and emissions, that is, cost and emission functions which move in the same direction. An FPTAS for general costs and emissions is derived in Section 4.4. The combination of the heuristic and FPTASes is discussed in Section 4.5. Section 5 describes the results of the extensive computational tests and the paper is concluded in Section 6. In an online supplement, the proofs of several theorems from this article are given, as well as pseudocode for the Lagrangian heuristic, additional information on backtracking in one of the FPTASes, and tables with detailed results.

The model can be formally defined as follows:
                        
                           (1)
                           
                              
                                 min
                              
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       t
                                       =
                                       1
                                    
                                    
                                       T
                                    
                                 
                              
                              (
                              
                                 
                                    p
                                 
                                 
                                    t
                                 
                              
                              (
                              
                                 
                                    x
                                 
                                 
                                    t
                                 
                              
                              )
                              +
                              
                                 
                                    h
                                 
                                 
                                    t
                                 
                              
                              (
                              
                                 
                                    I
                                 
                                 
                                    t
                                 
                              
                              )
                              )
                              ,
                           
                        
                     
                     
                        
                           (2)
                           
                              s
                              .
                              t
                              .
                              
                              
                                 
                                    I
                                 
                                 
                                    t
                                 
                              
                              =
                              
                                 
                                    I
                                 
                                 
                                    t
                                    -
                                    1
                                 
                              
                              +
                              
                                 
                                    x
                                 
                                 
                                    t
                                 
                              
                              -
                              
                                 
                                    d
                                 
                                 
                                    t
                                 
                              
                              
                              t
                              =
                              1
                              ,
                              …
                              ,
                              T
                              ,
                           
                        
                     
                     
                        
                           (3)
                           
                              
                              
                                 
                                    I
                                 
                                 
                                    0
                                 
                              
                              =
                              0
                              ,
                           
                        
                     
                     
                        
                           (4)
                           
                              
                              
                                 
                                    x
                                 
                                 
                                    t
                                 
                              
                              ,
                              
                                 
                                    I
                                 
                                 
                                    t
                                 
                              
                              ⩾
                              0
                              
                              t
                              =
                              1
                              ,
                              …
                              ,
                              T
                              ,
                           
                        
                     
                     
                        
                           (5)
                           
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       t
                                       =
                                       1
                                    
                                    
                                       T
                                    
                                 
                              
                              (
                              
                                 
                                    
                                       
                                          p
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    t
                                 
                              
                              (
                              
                                 
                                    x
                                 
                                 
                                    t
                                 
                              
                              )
                              +
                              
                                 
                                    
                                       
                                          h
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    t
                                 
                              
                              (
                              
                                 
                                    I
                                 
                                 
                                    t
                                 
                              
                              )
                              )
                              ⩽
                              
                                 
                                    C
                                 
                                 
                                    ^
                                 
                              
                              ,
                           
                        
                     where 
                        
                           
                              
                                 x
                              
                              
                                 t
                              
                           
                        
                      is the quantity produced in period t, and 
                        
                           
                              
                                 I
                              
                              
                                 t
                              
                           
                        
                      is the inventory at the end of period t. The demand in period t is given by 
                        
                           
                              
                                 d
                              
                              
                                 t
                              
                           
                        
                     , the length of the problem horizon is T, and 
                        
                           
                              
                                 C
                              
                              
                                 ^
                              
                           
                        
                      is the emission capacity. Furthermore, 
                        
                           
                              
                                 p
                              
                              
                                 t
                              
                           
                        
                      and 
                        
                           
                              
                                 h
                              
                              
                                 t
                              
                           
                        
                      are production and holding cost functions, and 
                        
                           
                              
                                 
                                    
                                       p
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 t
                              
                           
                        
                      and 
                        
                           
                              
                                 
                                    
                                       h
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 t
                              
                           
                        
                      are production and holding emission functions, respectively. We assume that all functions are concave, nondecreasing and nonnegative. A cost function that is concave in the number of items, means that we assume that there are economies of scale. We assume that these economies of scale also apply to the emissions. Since the functions are not assumed to be strictly concave, constant returns to scale fit within this framework too. Note that the production and holding costs and emission functions (
                        
                           
                              
                                 p
                              
                              
                                 t
                              
                           
                           ,
                           
                              
                                 h
                              
                              
                                 t
                              
                           
                           ,
                           
                              
                                 
                                    
                                       p
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 t
                              
                           
                        
                      and 
                        
                           
                              
                                 
                                    
                                       h
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 t
                              
                           
                        
                     ) can also contain a fixed component. The fixed component in 
                        
                           
                              
                                 p
                              
                              
                                 t
                              
                           
                        
                      can represent set-up costs for example. This includes the well-known case with fixed set-up costs and linear production and holding costs.

Eq. (2) gives the inventory balance constraints. There is no initial inventory (3). The nonnegativity constraints are given by (4), and (5) constrains the emissions over the whole problem horizon. We shall refer to problem (1)–(5) as ELSEC (Economic Lot-Sizing with an Emission Constraint).

The right hand side of (5) can be chosen in several ways dependent on the setting. Besides viewing it as a global constraint, we can interpret it as a bound on the average emission per period or per produced item (since the total demand is known). This may still lead to unbalanced solutions in the sense that some periods/produced items may have more emissions than others. In this case one can model the emission constraint as in Absi et al. (2013), in which smaller or overlapping intervals are considered, but this is beyond the scope of this paper.

Of course, 
                        
                           
                              
                                 
                                    
                                       p
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 t
                              
                           
                        
                      and 
                        
                           
                              
                                 
                                    
                                       h
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 t
                              
                           
                        
                      do not necessarily refer to emissions. They can be any kind of costs other than those in the objective function. Examples of what can be modelled by 
                        
                           
                              
                                 
                                    
                                       p
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 t
                              
                           
                        
                      and 
                        
                           
                              
                                 
                                    
                                       h
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 t
                              
                           
                        
                      include other types of negative externalities for society, such as other pollutants or noise resulting from production or carrying inventories. Moreover, we can impose a maximum on the total or average inventory by choosing 
                        
                           
                              
                                 
                                    
                                       h
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 t
                              
                           
                           (
                           
                              
                                 I
                              
                              
                                 t
                              
                           
                           )
                           =
                           
                              
                                 I
                              
                              
                                 t
                              
                           
                        
                      and 
                        
                           
                              
                                 
                                    
                                       p
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 t
                              
                           
                           (
                           
                              
                                 x
                              
                              
                                 t
                              
                           
                           )
                           =
                           0
                        
                      for all t, and 
                        
                           
                              
                                 C
                              
                              
                                 ^
                              
                           
                        
                      equal to the maximum total inventory or T times the maximum average inventory.

Also, we can model a lot-sizing problem with m production modes and T periods by transforming it into an instance of ELSEC with Tm periods. To formalise this transformation, consider an instance with m production modes and let 
                        
                           
                              
                                 p
                              
                              
                                 t
                              
                              
                                 i
                              
                           
                        
                      (resp. 
                        
                           
                              
                                 
                                    
                                       p
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 t
                              
                              
                                 i
                              
                           
                        
                     ) be the production cost (resp.emission) function of mode i (
                        
                           i
                           =
                           1
                           ,
                           …
                           ,
                           m
                        
                     ) in period t (
                        
                           t
                           =
                           1
                           ,
                           …
                           ,
                           T
                        
                     ). Then we can construct a new instance of ELSEC with (i) 
                        
                           
                              
                                 T
                              
                              
                                 ′
                              
                           
                           =
                           Tm
                        
                      periods, (ii) production functions 
                        
                           
                              
                                 p
                              
                              
                                 m
                                 (
                                 t
                                 -
                                 1
                                 )
                                 +
                                 i
                              
                              
                                 ′
                              
                           
                           =
                           
                              
                                 p
                              
                              
                                 t
                              
                              
                                 i
                              
                           
                        
                      and 
                        
                           
                              
                                 
                                    
                                       p
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 m
                                 (
                                 t
                                 -
                                 1
                                 )
                                 +
                                 i
                              
                              
                                 ′
                              
                           
                           =
                           
                              
                                 
                                    
                                       p
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 t
                              
                              
                                 i
                              
                           
                        
                      for 
                        
                           i
                           =
                           1
                           ,
                           …
                           ,
                           m
                           ;
                           
                           t
                           =
                           1
                           ,
                           …
                           ,
                           T
                        
                     , and (iii) holding functions 
                        
                           
                              
                                 h
                              
                              
                                 tm
                              
                              
                                 ′
                              
                           
                           =
                           
                              
                                 h
                              
                              
                                 t
                              
                           
                        
                      and 
                        
                           
                              
                                 
                                    
                                       h
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 tm
                              
                              
                                 ′
                              
                           
                           =
                           
                              
                                 
                                    
                                       h
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 t
                              
                           
                        
                      and demands 
                        
                           
                              
                                 d
                              
                              
                                 tm
                              
                              
                                 ′
                              
                           
                           =
                           
                              
                                 d
                              
                              
                                 t
                              
                           
                        
                      for 
                        
                           t
                           =
                           1
                           ,
                           …
                           ,
                           T
                        
                      and values zero for the other indices. Note that this transformation is valid because periods appear in groups of m, such that each of these periods corresponds to another production mode, with zero holding costs within such a group and where demand occurs only in the last period of a group of m periods. This implies that our model is able to handle the extension of ELSEC with multiple production modes.

If the costs and emissions follow a fixed-plus-linear structure, then the model can also be formulated as the standard mixed integer linear program (6)–(12). We shall refer to this problem as ELSEC-MILP. See Fig. 1
                      for a graphical representation with four periods.
                        
                           (6)
                           
                              
                                 min
                              
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       t
                                       =
                                       1
                                    
                                    
                                       T
                                    
                                 
                              
                              (
                              
                                 
                                    K
                                 
                                 
                                    t
                                 
                              
                              
                                 
                                    y
                                 
                                 
                                    t
                                 
                              
                              +
                              
                                 
                                    p
                                 
                                 
                                    t
                                 
                              
                              
                                 
                                    x
                                 
                                 
                                    t
                                 
                              
                              +
                              
                                 
                                    h
                                 
                                 
                                    t
                                 
                              
                              
                                 
                                    I
                                 
                                 
                                    t
                                 
                              
                              )
                              ,
                           
                        
                     
                     
                        
                           (7)
                           
                              s
                              .
                              t
                              .
                              
                              
                                 
                                    I
                                 
                                 
                                    t
                                 
                              
                              =
                              
                                 
                                    I
                                 
                                 
                                    t
                                    -
                                    1
                                 
                              
                              +
                              
                                 
                                    x
                                 
                                 
                                    t
                                 
                              
                              -
                              
                                 
                                    d
                                 
                                 
                                    t
                                 
                              
                              
                              t
                              =
                              1
                              ,
                              …
                              ,
                              T
                              ,
                           
                        
                     
                     
                        
                           (8)
                           
                              
                              
                                 
                                    x
                                 
                                 
                                    t
                                 
                              
                              ⩽
                              
                                 
                                    y
                                 
                                 
                                    t
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       s
                                       =
                                       t
                                    
                                    
                                       T
                                    
                                 
                              
                              
                                 
                                    d
                                 
                                 
                                    s
                                 
                              
                              
                              t
                              =
                              1
                              ,
                              …
                              ,
                              T
                              ,
                           
                        
                     
                     
                        
                           (9)
                           
                              
                              
                                 
                                    I
                                 
                                 
                                    0
                                 
                              
                              =
                              0
                              ,
                           
                        
                     
                     
                        
                           (10)
                           
                              
                              
                                 
                                    x
                                 
                                 
                                    t
                                 
                              
                              ,
                              
                                 
                                    I
                                 
                                 
                                    t
                                 
                              
                              ⩾
                              0
                              
                              t
                              =
                              1
                              ,
                              …
                              ,
                              T
                              ,
                           
                        
                     
                     
                        
                           (11)
                           
                              
                              
                                 
                                    y
                                 
                                 
                                    t
                                 
                              
                              ∈
                              {
                              0
                              ,
                              1
                              }
                              
                              t
                              =
                              1
                              ,
                              …
                              ,
                              T
                              ,
                           
                        
                     
                     
                        
                           (12)
                           
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       t
                                       =
                                       1
                                    
                                    
                                       T
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   K
                                                
                                                
                                                   ^
                                                
                                             
                                          
                                          
                                             t
                                          
                                       
                                       
                                          
                                             y
                                          
                                          
                                             t
                                          
                                       
                                       +
                                       
                                          
                                             
                                                
                                                   p
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             t
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             t
                                          
                                       
                                       +
                                       
                                          
                                             
                                                
                                                   h
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             t
                                          
                                       
                                       
                                          
                                             I
                                          
                                          
                                             t
                                          
                                       
                                    
                                 
                              
                              ⩽
                              
                                 
                                    C
                                 
                                 
                                    ^
                                 
                              
                              ,
                           
                        
                     
                     
                        
                           
                              
                                 K
                              
                              
                                 t
                              
                           
                        
                      and 
                        
                           
                              
                                 
                                    
                                       K
                                    
                                    
                                       ^
                                    
                                 
                              
                              
                                 t
                              
                           
                        
                      are the set-up cost and emissions, respectively. Now, 
                        
                           
                              
                                 p
                              
                              
                                 t
                              
                           
                           ,
                           
                              
                                 
                                    
                                       p
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 t
                              
                           
                           ,
                           
                              
                                 h
                              
                              
                                 t
                              
                           
                        
                      and 
                        
                           
                              
                                 
                                    
                                       h
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 t
                              
                           
                        
                      refer to the unit production and holding costs and emissions. 
                        
                           
                              
                                 y
                              
                              
                                 t
                              
                           
                        
                      is a binary variable indicating a set-up in period t and constraints (8) ensure that production can only take place if there is a set-up in that period.

The fixed-plus-linear cost structure is said to have the Wagner–Whitin or non-speculative motives property if the cost parameters satisfy the condition 
                        
                           
                              
                                 p
                              
                              
                                 t
                                 -
                                 1
                              
                           
                           +
                           
                              
                                 h
                              
                              
                                 t
                              
                           
                           ⩾
                           
                              
                                 p
                              
                              
                                 t
                              
                           
                        
                      for 
                        
                           t
                           =
                           2
                           ,
                           …
                           ,
                           T
                        
                     . This means that it is better to postpone production as much as possible in terms of variable costs. Similarly, we say that the emissions satisfy the Wagner–Whitin property if this condition holds on the emission parameters.


                        Van den Heuvel et al. (2011) show that some special cases of ELSEC-MILP can be solved in polynomial time. Moreover, they show that ELSEC-MILP is 
                           
                              NP
                           
                        -complete in general, even if only set-ups emit pollutants and under Wagner–Whitin (non-speculative) costs and emissions.

In this section, we show that another special case of ELSEC-MILP is 
                           
                              NP
                           
                        -hard.
                           Theorem 1
                           
                              Lot-sizing with a capacity constraint on the total emissions is 
                              
                                 
                                    NP
                                 
                              
                              -hard, even if only production emits pollutants and these emissions are linear in the quantity produced.
                           

We show that knapsack is a special case of ELSEC-MILP by defining an instance of ELSEC-MILP in which periods appear in pairs, in which production in an even period corresponds to putting an item in the knapsack and production in an odd period to not putting an item in the knapsack. The details of the proof can be found in Appendix A.1.□

We can view the instance from the proof as a lot-sizing problem with an emission constraint and two different production modes in each period, with a horizon of 
                           
                              
                                 
                                    1
                                 
                                 
                                    2
                                 
                              
                              T
                           
                         periods. The even and odd periods then correspond to these two different production modes, and we get the following corollary.
                           Corollary 2
                           
                              Lot-sizing with a capacity constraint on the total emissions and two production modes in each period is 
                              
                                 
                                    NP
                                 
                              
                              -hard, even if only production emits pollutants (linearly) and either all (financial) costs or all emissions are time-invariant.
                           

Theorem 5 in Absi et al. (2013) states that lot-sizing with a cumulative emission capacity is 
                           
                              NP
                           
                        -hard. Our problem (with a global emission capacity constraint) is a relaxation of that problem. Absi et al. (2013) mention that the problem with a global emission capacity is 
                           
                              NP
                           
                        -hard as well and that the same reduction as in the proof of their Theorem 5 could be used, but a precise proof is omitted. One important difference between their proof and ours is that they assume a general number of production modes, whereas we consider the more restricted case with only two modes. On the other hand, they have time-invariant instances with unit demand, whereas we have either costs or emissions that are time-invariant and non-unit demand.

Before we introduce our algorithms in Section 4, we prove the correctness of some structural properties of an optimal solution, which these algorithms will use.

We use the common definition of a block as an interval 
                           
                              [
                              t
                              ,
                              s
                              ]
                           
                         such that 
                           
                              
                                 
                                    I
                                 
                                 
                                    t
                                    -
                                    1
                                 
                              
                              =
                              
                                 
                                    I
                                 
                                 
                                    s
                                 
                              
                              =
                              0
                           
                         and 
                           
                              
                                 
                                    I
                                 
                                 
                                    τ
                                 
                              
                              
                              ≠
                              
                              0
                              
                              ∀
                              t
                              ⩽
                              τ
                              ⩽
                              s
                              -
                              1
                           
                        . Furthermore, let a period t be called a double-sourcing period, if 
                           
                              
                                 
                                    I
                                 
                                 
                                    t
                                    -
                                    1
                                 
                              
                              >
                              0
                           
                         and 
                           
                              
                                 
                                    x
                                 
                                 
                                    t
                                 
                              
                              >
                              0
                           
                        , that is, there is both inventory carried over from the previous period and positive production in period t. Let a period t be called a single-sourcing period if either 
                           
                              
                                 
                                    I
                                 
                                 
                                    t
                                    -
                                    1
                                 
                              
                              =
                              0
                           
                         or 
                           
                              
                                 
                                    x
                                 
                                 
                                    t
                                 
                              
                              =
                              0
                           
                        . Note that the single-sourcing property is also called the zero inventory (ordering) property in the literature.

Later, we will want to consider a given solution and find out what happens to the costs (and emissions) when we shift production from period i to period j and vice versa. Therefore, it is convenient to make the following definitions. Let 
                           
                              x
                           
                         be a given solution. Let 
                           
                              
                                 
                                    x
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                           
                         be the quantity produced in period i that is kept in inventory until at least period j in that solution. Define 
                           
                              
                                 
                                    q
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                           
                         as the additional production quantity in period i (compared to 
                           
                              x
                           
                        ) that is kept in inventory until at least period j. We can interpret 
                           
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                           
                         as the production quantity in period i in the ‘old’ (given) situation and 
                           
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                              +
                              
                                 
                                    q
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                           
                         as the production quantity in period i in the ‘new’ situation. Similarly, we can interpret the quantities 
                           
                              
                                 
                                    I
                                 
                                 
                                    k
                                 
                              
                              +
                              
                                 
                                    q
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                           
                         as the inventories in periods k (
                           
                              i
                              ⩽
                              k
                              ⩽
                              j
                              -
                              1
                           
                        ) in the ‘new’ situation. Now, define 
                           
                              
                                 
                                    C
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                              (
                              
                                 
                                    q
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                              ;
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    I
                                 
                                 
                                    i
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    I
                                 
                                 
                                    j
                                    -
                                    1
                                 
                              
                              )
                              
                              ≔
                              
                              
                                 
                                    p
                                 
                                 
                                    i
                                 
                              
                              (
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                              +
                              
                                 
                                    q
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                              )
                              +
                              
                                 
                                    ∑
                                 
                                 
                                    k
                                    =
                                    i
                                 
                                 
                                    j
                                    -
                                    1
                                 
                              
                              
                                 
                                    h
                                 
                                 
                                    k
                                 
                              
                              (
                              
                                 
                                    I
                                 
                                 
                                    k
                                 
                              
                              +
                              
                                 
                                    q
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                              )
                           
                        . We will use 
                           
                              
                                 
                                    C
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                              (
                              
                                 
                                    q
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                              )
                           
                         as shorthand for 
                           
                              
                                 
                                    C
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                              (
                              
                                 
                                    q
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                              ;
                              
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    I
                                 
                                 
                                    i
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    I
                                 
                                 
                                    j
                                    -
                                    1
                                 
                              
                              )
                           
                         and 
                           
                              
                                 
                                    C
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                           
                         as shorthand for 
                           
                              
                                 
                                    C
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                              (
                              0
                              )
                              =
                              
                                 
                                    C
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                              (
                              0
                              ;
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    I
                                 
                                 
                                    i
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    I
                                 
                                 
                                    j
                                    -
                                    1
                                 
                              
                              )
                           
                        . In this way, 
                           
                              
                                 
                                    C
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                              (
                              0
                              )
                           
                         gives the production costs in period i plus the holding costs incurred in periods i through 
                           
                              j
                              -
                              1
                           
                         in the ‘old’ situation, and 
                           
                              
                                 
                                    C
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                              (
                              
                                 
                                    q
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                              )
                           
                         gives the production and holding costs in the same periods in the ‘new’ situation. Because of concavity of 
                           
                              
                                 
                                    p
                                 
                                 
                                    i
                                 
                              
                           
                         and 
                           
                              
                                 
                                    h
                                 
                                 
                                    k
                                 
                              
                           
                        , it holds that 
                           
                              
                                 
                                    C
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                           
                         is concave (in 
                           
                              
                                 
                                    q
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                           
                        ) too. Note that 
                           
                              
                                 
                                    C
                                 
                                 
                                    j
                                    ,
                                    j
                                 
                              
                              (
                              
                                 
                                    q
                                 
                                 
                                    j
                                    ,
                                    j
                                 
                              
                              )
                              =
                              
                                 
                                    p
                                 
                                 
                                    j
                                 
                              
                              (
                              
                                 
                                    x
                                 
                                 
                                    j
                                 
                              
                              +
                              
                                 
                                    q
                                 
                                 
                                    j
                                    ,
                                    j
                                 
                              
                              )
                           
                        . Similarly, define 
                           
                              
                                 
                                    
                                       
                                          C
                                       
                                       
                                          ^
                                       
                                    
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                              (
                              
                                 
                                    q
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                              ;
                              
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    I
                                 
                                 
                                    i
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    I
                                 
                                 
                                    j
                                    -
                                    1
                                 
                              
                              )
                              
                              ≔
                              
                              
                                 
                                    
                                       
                                          p
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              (
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                              +
                              
                                 
                                    q
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                              )
                              +
                              
                                 
                                    ∑
                                 
                                 
                                    k
                                    =
                                    i
                                 
                                 
                                    j
                                    -
                                    1
                                 
                              
                              
                                 
                                    
                                       
                                          h
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    k
                                 
                              
                              (
                              
                                 
                                    I
                                 
                                 
                                    k
                                 
                              
                              +
                              
                                 
                                    q
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                              )
                           
                        , and use 
                           
                              
                                 
                                    
                                       
                                          C
                                       
                                       
                                          ^
                                       
                                    
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                              (
                              0
                              )
                           
                         and 
                           
                              
                                 
                                    
                                       
                                          C
                                       
                                       
                                          ^
                                       
                                    
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                           
                         as shorthand for 
                           
                              
                                 
                                    
                                       
                                          C
                                       
                                       
                                          ^
                                       
                                    
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                              (
                              0
                              ;
                              
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    I
                                 
                                 
                                    i
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    I
                                 
                                 
                                    j
                                    -
                                    1
                                 
                              
                              )
                           
                        . Define
                           
                              
                                 
                                    
                                       p
                                    
                                    
                                       i
                                    
                                    
                                       ′
                                    
                                 
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 ≔
                                 
                                    
                                       
                                          lim
                                       
                                       
                                          h
                                          ↓
                                          0
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             i
                                          
                                       
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             i
                                          
                                       
                                       +
                                       h
                                       )
                                       -
                                       
                                          
                                             p
                                          
                                          
                                             i
                                          
                                       
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                    
                                       h
                                    
                                 
                                 ,
                              
                           
                        i.e., 
                           
                              
                                 
                                    p
                                 
                                 
                                    i
                                 
                                 
                                    ′
                                 
                              
                           
                         is the right derivative of 
                           
                              
                                 
                                    p
                                 
                                 
                                    i
                                 
                              
                           
                        . Because 
                           
                              
                                 
                                    p
                                 
                                 
                                    i
                                 
                              
                           
                         is real-valued and concave, we know that this right derivative exists for 
                           
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                              >
                              0
                           
                        .

Similarly, let 
                           
                              
                                 
                                    
                                       
                                          p
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    i
                                 
                                 
                                    ′
                                 
                              
                              ,
                              
                                 
                                    h
                                 
                                 
                                    i
                                 
                                 
                                    ′
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          h
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    i
                                 
                                 
                                    ′
                                 
                              
                              ,
                              
                                 
                                    C
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                                 
                                    ′
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          C
                                       
                                       
                                          ^
                                       
                                    
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                                 
                                    ′
                                 
                              
                           
                         be the right derivatives of their respective functions. We know that the right derivative of 
                           
                              
                                 
                                    
                                       
                                          p
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                           
                         exists for 
                           
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                              >
                              0
                           
                        , the right derivatives of 
                           
                              
                                 
                                    h
                                 
                                 
                                    i
                                 
                              
                           
                         and 
                           
                              
                                 
                                    
                                       
                                          h
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                           
                         exist for 
                           
                              
                                 
                                    I
                                 
                                 
                                    i
                                 
                              
                              >
                              0
                           
                        , and the right derivatives of 
                           
                              
                                 
                                    C
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                           
                         and 
                           
                              
                                 
                                    
                                       
                                          C
                                       
                                       
                                          ^
                                       
                                    
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                           
                         exist for 
                           
                              
                                 
                                    q
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                              +
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                              >
                              0
                           
                         and 
                           
                              
                                 
                                    q
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                              +
                              
                                 
                                    I
                                 
                                 
                                    k
                                 
                              
                              >
                              0
                              
                              (
                              i
                              ⩽
                              k
                              <
                              j
                              )
                           
                         (i.e., the quantity that is produced less in period i is such that the remaining production quantity, respectively inventories are positive).

In the next theorem we prove that the single-sourcing property still holds under a special cost structure, which we call co-behaving. The cost structure is said to be co-behaving if for each pair 
                           
                              i
                              ⩽
                              j
                           
                        , either 
                           
                              
                                 
                                    
                                       
                                          
                                             C
                                          
                                          
                                             i
                                             ,
                                             j
                                          
                                          
                                             ′
                                          
                                       
                                       (
                                       
                                          
                                             q
                                          
                                          
                                             i
                                             ,
                                             j
                                          
                                       
                                       )
                                       ⩽
                                       
                                          
                                             C
                                          
                                          
                                             j
                                             ,
                                             j
                                          
                                          
                                             ′
                                          
                                       
                                       (
                                       
                                          
                                             q
                                          
                                          
                                             j
                                             ,
                                             j
                                          
                                       
                                       )
                                       
                                       and
                                       
                                       
                                          
                                             
                                                
                                                   C
                                                
                                                
                                                   ^
                                                
                                             
                                          
                                          
                                             i
                                             ,
                                             j
                                          
                                          
                                             ′
                                          
                                       
                                       (
                                       
                                          
                                             q
                                          
                                          
                                             i
                                             ,
                                             j
                                          
                                       
                                       )
                                       ⩽
                                       
                                          
                                             
                                                
                                                   C
                                                
                                                
                                                   ^
                                                
                                             
                                          
                                          
                                             j
                                             ,
                                             j
                                          
                                          
                                             ′
                                          
                                       
                                       (
                                       
                                          
                                             q
                                          
                                          
                                             j
                                             ,
                                             j
                                          
                                       
                                       )
                                    
                                 
                              
                           
                         or 
                           
                              
                                 
                                    
                                       
                                          
                                             C
                                          
                                          
                                             i
                                             ,
                                             j
                                          
                                          
                                             ′
                                          
                                       
                                       (
                                       
                                          
                                             q
                                          
                                          
                                             i
                                             ,
                                             j
                                          
                                       
                                       )
                                       ⩾
                                       
                                          
                                             C
                                          
                                          
                                             j
                                             ,
                                             j
                                          
                                          
                                             ′
                                          
                                       
                                       (
                                       
                                          
                                             q
                                          
                                          
                                             j
                                             ,
                                             j
                                          
                                       
                                       )
                                       
                                       and
                                       
                                       
                                          
                                             
                                                
                                                   C
                                                
                                                
                                                   ^
                                                
                                             
                                          
                                          
                                             i
                                             ,
                                             j
                                          
                                          
                                             ′
                                          
                                       
                                       (
                                       
                                          
                                             q
                                          
                                          
                                             i
                                             ,
                                             j
                                          
                                       
                                       )
                                       ⩾
                                       
                                          
                                             
                                                
                                                   C
                                                
                                                
                                                   ^
                                                
                                             
                                          
                                          
                                             j
                                             ,
                                             j
                                          
                                          
                                             ′
                                          
                                       
                                       (
                                       
                                          
                                             q
                                          
                                          
                                             j
                                             ,
                                             j
                                          
                                       
                                       )
                                    
                                 
                              
                           
                         holds, for all 
                           
                              (
                              x
                              ,
                              I
                              )
                           
                         and all 
                           
                              (
                              
                                 
                                    q
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                              ,
                              
                                 
                                    q
                                 
                                 
                                    j
                                    ,
                                    j
                                 
                              
                              )
                           
                         (such that 
                           
                              
                                 
                                    q
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                              +
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                              >
                              0
                              ,
                              
                                 
                                    q
                                 
                                 
                                    j
                                    ,
                                    j
                                 
                              
                              +
                              
                                 
                                    x
                                 
                                 
                                    j
                                 
                              
                              >
                              0
                           
                         and 
                           
                              
                                 
                                    q
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                              +
                              
                                 
                                    I
                                 
                                 
                                    k
                                 
                              
                              >
                              0
                              
                              (
                              i
                              ⩽
                              k
                              <
                              j
                              )
                           
                        ). Note that such cost and emission functions ‘co-behave’, because over time, they move in the same direction, i.e. if one increases (decreases), the other increases (decreases) as well.
                           Theorem 3
                           
                              If the financial costs and the emissions are co-behaving, then there exists an optimal solution to ELSEC, such that the single-sourcing property holds in all periods.
                           

Suppose there exists an optimal solution 
                                 
                                    (
                                    x
                                    ,
                                    I
                                    )
                                 
                               with (at least) one double-sourcing period. Let v be a double-sourcing period. Suppose that period v’s demand is procured from two periods, t and s, then it must be that either 
                                 
                                    v
                                    =
                                    t
                                 
                               or 
                                 
                                    v
                                    =
                                    s
                                 
                              . Furthermore, assume that 
                                 
                                    
                                       
                                          C
                                       
                                       
                                          t
                                          ,
                                          v
                                       
                                       
                                          ′
                                       
                                    
                                    (
                                    0
                                    )
                                    ⩾
                                    
                                       
                                          C
                                       
                                       
                                          s
                                          ,
                                          v
                                       
                                       
                                          ′
                                       
                                    
                                    (
                                    0
                                    )
                                 
                               and 
                                 
                                    
                                       
                                          
                                             
                                                C
                                             
                                             
                                                ^
                                             
                                          
                                       
                                       
                                          t
                                          ,
                                          v
                                       
                                       
                                          ′
                                       
                                    
                                    (
                                    0
                                    )
                                    ⩾
                                    
                                       
                                          
                                             
                                                C
                                             
                                             
                                                ^
                                             
                                          
                                       
                                       
                                          s
                                          ,
                                          v
                                       
                                       
                                          ′
                                       
                                    
                                    (
                                    0
                                    )
                                 
                              . (Note that this also covers the case 
                                 
                                    
                                       
                                          C
                                       
                                       
                                          t
                                          ,
                                          v
                                       
                                       
                                          ′
                                       
                                    
                                    (
                                    0
                                    )
                                    ⩽
                                    
                                       
                                          C
                                       
                                       
                                          s
                                          ,
                                          v
                                       
                                       
                                          ′
                                       
                                    
                                    (
                                    0
                                    )
                                 
                               and 
                                 
                                    
                                       
                                          
                                             
                                                C
                                             
                                             
                                                ^
                                             
                                          
                                       
                                       
                                          t
                                          ,
                                          v
                                       
                                       
                                          ′
                                       
                                    
                                    (
                                    0
                                    )
                                    ⩽
                                    
                                       
                                          
                                             
                                                C
                                             
                                             
                                                ^
                                             
                                          
                                       
                                       
                                          s
                                          ,
                                          v
                                       
                                       
                                          ′
                                       
                                    
                                    (
                                    0
                                    )
                                 
                              , because we can switch the indices t and s.) Now, we should produce 
                                 
                                    
                                       
                                          x
                                       
                                       
                                          t
                                          ,
                                          v
                                       
                                    
                                 
                               units in period s instead of period t, so that we obtain a solution with single-sourcing in period v. We show that this will decrease both costs and emissions. Because of concavity, it holds that
                                 
                                    
                                       
                                          
                                             C
                                          
                                          
                                             t
                                             ,
                                             v
                                          
                                       
                                       (
                                       0
                                       )
                                       -
                                       
                                          
                                             C
                                          
                                          
                                             t
                                             ,
                                             v
                                          
                                       
                                       (
                                       -
                                       
                                          
                                             x
                                          
                                          
                                             t
                                             ,
                                             v
                                          
                                       
                                       )
                                       ⩾
                                       
                                          
                                             C
                                          
                                          
                                             t
                                             ,
                                             v
                                          
                                          
                                             ′
                                          
                                       
                                       (
                                       0
                                       )
                                       
                                          
                                             x
                                          
                                          
                                             t
                                             ,
                                             v
                                          
                                       
                                       ⩾
                                       
                                          
                                             C
                                          
                                          
                                             s
                                             ,
                                             v
                                          
                                          
                                             ′
                                          
                                       
                                       (
                                       0
                                       )
                                       
                                          
                                             x
                                          
                                          
                                             t
                                             ,
                                             v
                                          
                                       
                                       ⩾
                                       
                                          
                                             C
                                          
                                          
                                             s
                                             ,
                                             v
                                          
                                       
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             t
                                             ,
                                             v
                                          
                                       
                                       )
                                       -
                                       
                                          
                                             C
                                          
                                          
                                             s
                                             ,
                                             v
                                          
                                       
                                       (
                                       0
                                       )
                                       ,
                                    
                                 
                              i.e., the savings are larger than the extra expenses. Completely analogously,
                                 
                                    
                                       
                                          
                                             
                                                
                                                   C
                                                
                                                
                                                   ^
                                                
                                             
                                          
                                          
                                             t
                                             ,
                                             v
                                          
                                       
                                       (
                                       0
                                       )
                                       -
                                       
                                          
                                             
                                                
                                                   C
                                                
                                                
                                                   ^
                                                
                                             
                                          
                                          
                                             t
                                             ,
                                             v
                                          
                                       
                                       (
                                       -
                                       
                                          
                                             x
                                          
                                          
                                             t
                                             ,
                                             v
                                          
                                       
                                       )
                                       ⩾
                                       
                                          
                                             
                                                
                                                   C
                                                
                                                
                                                   ^
                                                
                                             
                                          
                                          
                                             t
                                             ,
                                             v
                                          
                                          
                                             ′
                                          
                                       
                                       (
                                       0
                                       )
                                       
                                          
                                             x
                                          
                                          
                                             t
                                             ,
                                             v
                                          
                                       
                                       ⩾
                                       
                                          
                                             
                                                
                                                   C
                                                
                                                
                                                   ^
                                                
                                             
                                          
                                          
                                             s
                                             ,
                                             v
                                          
                                          
                                             ′
                                          
                                       
                                       (
                                       0
                                       )
                                       
                                          
                                             x
                                          
                                          
                                             t
                                             ,
                                             v
                                          
                                       
                                       ⩾
                                       
                                          
                                             
                                                
                                                   C
                                                
                                                
                                                   ^
                                                
                                             
                                          
                                          
                                             s
                                             ,
                                             v
                                          
                                       
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             t
                                             ,
                                             v
                                          
                                       
                                       )
                                       -
                                       
                                          
                                             
                                                
                                                   C
                                                
                                                
                                                   ^
                                                
                                             
                                          
                                          
                                             s
                                             ,
                                             v
                                          
                                       
                                       (
                                       0
                                       )
                                       .
                                    
                                 
                              
                           

If there are any double-sourcing periods left, then repeat the above procedure until there are only single-sourcing periods left.□


                              If both the financial costs and emissions satisfy the Wagner–Whitin property, then there exists an optimal solution to ELSEC, such that the single-sourcing property holds in all periods.
                           

By definition, the Wagner–Whitin property means that it is cheapest to procure products from the most recent production period, i.e. 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   C
                                                
                                                
                                                   i
                                                   ,
                                                   j
                                                
                                                
                                                   ′
                                                
                                             
                                             ⩾
                                             
                                                
                                                   C
                                                
                                                
                                                   j
                                                   ,
                                                   j
                                                
                                                
                                                   ′
                                                
                                             
                                             
                                             and
                                             
                                             
                                                
                                                   
                                                      
                                                         C
                                                      
                                                      
                                                         ^
                                                      
                                                   
                                                
                                                
                                                   i
                                                   ,
                                                   j
                                                
                                                
                                                   ′
                                                
                                             
                                             ⩾
                                             
                                                
                                                   
                                                      
                                                         C
                                                      
                                                      
                                                         ^
                                                      
                                                   
                                                
                                                
                                                   j
                                                   ,
                                                   j
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                       
                                    
                                 
                               for all 
                                 
                                    i
                                    ⩽
                                    j
                                 
                              . □

The following corollary is a direct consequence of Theorem 3.
                           Corollary 5
                           
                              If the emission functions are time-invariant and the holding emissions are zero, OR the financial cost functions are time-invariant and the holding costs are zero, then there exists a solution to ELSEC, such that the single-sourcing property holds in all periods.
                           

In general, the following property holds.
                           Theorem 6
                           
                              There exists an optimal solution to ELSEC, such that the single-sourcing property holds in all but at most one period.
                           

We show that if there are at least two periods with double-sourcing in an optimal solution, we can alter the solution by shifting production such that only one double-sourcing period remains and the costs do not increase. By repeating this argument, we end up with an optimal solution having at most one double-sourcing period. The details of the proof can be found in Appendix A.2.□

Finally, we prove the next property, which is used in Section 4.4.
                           Theorem 7
                           
                              There exists an optimal solution in which either the full emission capacity is used, or the single-sourcing property holds.
                           

We show that any optimal solution that does not satisfy any of the two properties can be modified by shifting production such that one of the properties holds and the costs do not increase. The details of the proof can be found in Appendix A.3.□

We propose several algorithms to solve ELSEC. First, we present a Lagrangian heuristic that provides an upper and lower bound for the problem. Secondly, we develop an exact algorithm that solves the co-behaving version of ELSEC in pseudo-polynomial time. We turn this algorithm into a fully-polynomial approximation scheme (FPTAS). Next, this FPTAS is extended to deal with more general cost and emission functions. Finally, we show how the FPTASes can be sped up by using a lower bound, such as the one given by the Lagrangian heuristic.

In this section, we present a Lagrangian heuristic that is based on relaxation of the emission capacity constraint (5). The resulting formulation is given below. This heuristic will give us both a lower bound and a feasible solution.
                           
                              (13)
                              
                                 
                                    
                                       
                                          
                                             
                                                min
                                             
                                          
                                       
                                       
                                          
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      t
                                                      =
                                                      1
                                                   
                                                   
                                                      T
                                                   
                                                
                                             
                                             (
                                             
                                                
                                                   p
                                                
                                                
                                                   t
                                                
                                             
                                             (
                                             
                                                
                                                   x
                                                
                                                
                                                   t
                                                
                                             
                                             )
                                             +
                                             
                                                
                                                   h
                                                
                                                
                                                   t
                                                
                                             
                                             (
                                             
                                                
                                                   I
                                                
                                                
                                                   t
                                                
                                             
                                             )
                                             )
                                             +
                                             λ
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      t
                                                      =
                                                      1
                                                   
                                                   
                                                      T
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  p
                                                               
                                                               
                                                                  ˆ
                                                               
                                                            
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      )
                                                      +
                                                      
                                                         
                                                            
                                                               
                                                                  h
                                                               
                                                               
                                                                  ˆ
                                                               
                                                            
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            I
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      )
                                                      -
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            ^
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                             =
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      t
                                                      =
                                                      1
                                                   
                                                   
                                                      T
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      )
                                                      +
                                                      λ
                                                      
                                                         
                                                            
                                                               
                                                                  p
                                                               
                                                               
                                                                  ˆ
                                                               
                                                            
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      )
                                                      +
                                                      
                                                         
                                                            h
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            I
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      )
                                                      +
                                                      λ
                                                      
                                                         
                                                            
                                                               
                                                                  h
                                                               
                                                               
                                                                  ˆ
                                                               
                                                            
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            I
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                             -
                                             λ
                                             
                                                
                                                   C
                                                
                                                
                                                   ^
                                                
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (14)
                              
                                 s
                                 .
                                 t
                                 .
                                 
                                 
                                    
                                       I
                                    
                                    
                                       t
                                    
                                 
                                 =
                                 
                                    
                                       I
                                    
                                    
                                       t
                                       -
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       x
                                    
                                    
                                       t
                                    
                                 
                                 -
                                 
                                    
                                       d
                                    
                                    
                                       t
                                    
                                 
                                 
                                 t
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 T
                                 ,
                              
                           
                        
                        
                           
                              (15)
                              
                                 
                                 
                                    
                                       x
                                    
                                    
                                       t
                                    
                                 
                                 ,
                                 
                                    
                                       I
                                    
                                    
                                       t
                                    
                                 
                                 ⩾
                                 0
                                 
                                 t
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 T
                                 ,
                              
                           
                        
                        
                           
                              (16)
                              
                                 
                                 
                                    
                                       I
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 0
                                 ,
                              
                           
                        
                        
                           
                              (17)
                              
                                 
                                 λ
                                 ⩾
                                 0
                                 ,
                              
                           
                        First, suppose that 
                           
                              λ
                           
                         is given. Obviously, constraints (14)–(16) are the same as in the classic (uncapacitated, single-item) lot-sizing problem. Moreover, 
                           
                              
                                 
                                    p
                                 
                                 
                                    t
                                 
                              
                              +
                              λ
                              
                                 
                                    
                                       
                                          p
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    t
                                 
                              
                           
                         is a concave function of 
                           
                              
                                 
                                    x
                                 
                                 
                                    t
                                 
                              
                           
                        , because both 
                           
                              
                                 
                                    p
                                 
                                 
                                    t
                                 
                              
                           
                         and 
                           
                              
                                 
                                    
                                       
                                          p
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    t
                                 
                              
                           
                         are concave, and 
                           
                              λ
                           
                         is nonnegative. Similarly, 
                           
                              
                                 
                                    h
                                 
                                 
                                    t
                                 
                              
                              +
                              λ
                              
                                 
                                    
                                       
                                          h
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    t
                                 
                              
                           
                         is a concave function of 
                           
                              
                                 
                                    I
                                 
                                 
                                    t
                                 
                              
                           
                        . Furthermore, 
                           
                              λ
                              
                                 
                                    C
                                 
                                 
                                    ^
                                 
                              
                           
                         is a constant, so we can ignore it when optimising. Hence, for a given 
                           
                              λ
                           
                        , the relaxed problem (13)–(16) is a classic lot-sizing problem and we can solve it with Wagner and Whitin (1958)’s algorithm.

We apply Megiddo (1979)’s algorithm for combinatorial problems that involve minimisation of a rational objective function to the lot-sizing problem. Gusfield (1983) showed that this is equivalent to minimising an objective of the form 
                           
                              a
                              +
                              λ
                              b
                           
                        . See also Wagelmans (1990) and Megiddo (1983). These papers imply that if, for a given 
                           
                              λ
                           
                        , the relaxed problem can be solved in 
                           
                              O
                              (
                              A
                              )
                           
                         (with a ‘suitable’ algorithm) and we can check in 
                           
                              O
                              (
                              B
                              )
                           
                         whether the relaxed constraint is violated or not, then the parameterised problem (
                           
                              a
                              +
                              λ
                              b
                           
                        ) can be solved in 
                           
                              O
                              (
                              AB
                              )
                           
                        . For a given 
                           
                              λ
                           
                        , our relaxed problem (13)–(16) can be solved in 
                           
                              O
                              (
                              
                                 
                                    T
                                 
                                 
                                    2
                                 
                              
                              )
                           
                         with the Wagner–Whitin algorithm. Moreover, the same algorithm can be used to determine whether the emission constraint is violated or not. Although Megiddo (1979) only mentions fractions of linear functions, his algorithm can be generalised to our problem in a straightforward manner. Hence, we can solve our Lagrangian relaxation in 
                           
                              O
                              (
                              
                                 
                                    T
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    T
                                 
                                 
                                    2
                                 
                              
                              )
                              =
                              O
                              (
                              
                                 
                                    T
                                 
                                 
                                    4
                                 
                              
                              )
                           
                        .

In Appendix B, we give the pseudo code for Megiddo (1979)’s algorithm applied to our problem.

After executing the algorithm, we get an interval 
                           
                              [
                              
                                 
                                    λ
                                 
                                 
                                    LB
                                 
                              
                              ,
                              
                                 
                                    λ
                                 
                                 
                                    UB
                                 
                              
                              ]
                           
                         such that 
                           
                              
                                 
                                    λ
                                 
                                 
                                    ∗
                                 
                              
                           
                         is one of the endpoints. At 
                           
                              
                                 
                                    λ
                                 
                                 
                                    ∗
                                 
                              
                           
                        , we are indifferent between two solutions, of which one is infeasible and the other feasible. The latter will give us an upper bound. Furthermore, suppose that 
                           
                              
                                 
                                    x
                                 
                                 
                                    ∗
                                 
                              
                           
                         is an optimal solution of problem (13)–(16) for some value of 
                           
                              λ
                           
                        , say for 
                           
                              λ
                              =
                              
                                 
                                    λ
                                 
                                 
                                    ¯
                                 
                              
                           
                        . Then we can compute 
                           
                              
                                 
                                    ∑
                                 
                                 
                                    t
                                    =
                                    1
                                 
                                 
                                    T
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             t
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      t
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                             
                                          
                                       
                                       +
                                       
                                          
                                             h
                                          
                                          
                                             t
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      I
                                                   
                                                   
                                                      t
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              +
                              
                                 
                                    λ
                                 
                                 
                                    ¯
                                 
                              
                              
                                 
                                    ∑
                                 
                                 
                                    t
                                    =
                                    1
                                 
                                 
                                    T
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   p
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             t
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      t
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                             
                                          
                                       
                                       +
                                       
                                          
                                             
                                                
                                                   h
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             t
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      I
                                                   
                                                   
                                                      t
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                             
                                          
                                       
                                       -
                                       
                                          
                                             C
                                          
                                          
                                             ^
                                          
                                       
                                    
                                 
                              
                           
                        , which is a lower bound for our problem. Observe that both 
                           
                              
                                 
                                    x
                                 
                                 
                                    LB
                                 
                              
                           
                         and 
                           
                              
                                 
                                    x
                                 
                                 
                                    UB
                                 
                              
                           
                         are optimal solutions, for 
                           
                              
                                 
                                    λ
                                 
                                 
                                    LB
                                 
                              
                           
                         and 
                           
                              
                                 
                                    λ
                                 
                                 
                                    UB
                                 
                              
                           
                        , respectively. Hence, we can compute that above expression for both solutions and take the higher lower bound.

Apart from the heuristic, we also give a dynamic programming algorithm that solves ELSEC to optimality in case the costs and emissions satisfy the conditions in Theorem 3. We shall see that this algorithm works in pseudo-polynomial time. We construct this algorithm in such a way that it will be easy to turn it into an FPTAS in the next section.

First, assume that demand and all cost functions are integer, i.e., 
                           
                              
                                 
                                    d
                                 
                                 
                                    t
                                 
                              
                              ∈
                              N
                           
                         and 
                           
                              
                                 
                                    p
                                 
                                 
                                    t
                                 
                              
                              (
                              
                                 
                                    x
                                 
                                 
                                    t
                                 
                              
                              )
                              ,
                              
                                 
                                    h
                                 
                                 
                                    t
                                 
                              
                              (
                              
                                 
                                    I
                                 
                                 
                                    t
                                 
                              
                              )
                              ∈
                              N
                           
                         for 
                           
                              
                                 
                                    x
                                 
                                 
                                    t
                                 
                              
                              ,
                              
                                 
                                    I
                                 
                                 
                                    t
                                 
                              
                              ∈
                              N
                           
                        . Note that this does not have to hold for the emission functions, 
                           
                              
                                 
                                    
                                       
                                          p
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    t
                                 
                              
                           
                         and 
                           
                              
                                 
                                    
                                       
                                          h
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    t
                                 
                              
                           
                        .

The general idea of the algorithm is as follows: we minimise the emissions under a (financial) budget constraint. Because of Theorem 3, we know that the single-sourcing property holds and we can extend Wagner and Whitin’s well-known algorithm for the classic lot-sizing problem (Wagner & Whitin, 1958) with an extra state variable €, which denotes the budget. More precisely, let 
                           
                              f
                              (
                              t
                              ,
                              €
                              )
                           
                         denote the minimum emissions for periods t until T, given budget €. We define the following recursion:
                           
                              (18)
                              
                                 f
                                 (
                                 t
                                 ,
                                 €
                                 )
                                 =
                                 
                                    
                                       
                                          min
                                       
                                       
                                          s
                                          >
                                          t
                                          :
                                          €
                                          ⩾
                                          c
                                          (
                                          t
                                          ,
                                          s
                                          )
                                       
                                    
                                 
                                 {
                                 e
                                 (
                                 t
                                 ,
                                 s
                                 )
                                 +
                                 f
                                 (
                                 s
                                 +
                                 1
                                 ,
                                 €
                                 -
                                 c
                                 (
                                 t
                                 ,
                                 s
                                 )
                                 )
                                 }
                                 
                                 for
                                 
                                 t
                                 ⩽
                                 T
                                 ,
                              
                           
                        
                        
                           
                              (19)
                              
                                 f
                                 (
                                 T
                                 +
                                 1
                                 ,
                                 €
                                 )
                                 =
                                 0
                                 .
                              
                           
                        
                        
                           
                              (20)
                              
                                 Here
                                 ,
                                 
                                 c
                                 (
                                 t
                                 ,
                                 s
                                 )
                                 ≔
                                 
                                    
                                       p
                                    
                                    
                                       t
                                    
                                 
                                 (
                                 
                                    
                                       D
                                    
                                    
                                       t
                                       ,
                                       s
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          τ
                                          =
                                          t
                                       
                                       
                                          s
                                          -
                                          1
                                       
                                    
                                 
                                 
                                    
                                       h
                                    
                                    
                                       τ
                                    
                                 
                                 (
                                 
                                    
                                       D
                                    
                                    
                                       τ
                                       ,
                                       s
                                    
                                 
                                 )
                                 ,
                              
                           
                        
                        
                           
                              (21)
                              
                                 e
                                 (
                                 t
                                 ,
                                 s
                                 )
                                 ≔
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       t
                                    
                                 
                                 (
                                 
                                    
                                       D
                                    
                                    
                                       t
                                       ,
                                       s
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          τ
                                          =
                                          t
                                       
                                       
                                          s
                                          -
                                          1
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             h
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       τ
                                    
                                 
                                 (
                                 
                                    
                                       D
                                    
                                    
                                       τ
                                       ,
                                       s
                                    
                                 
                                 )
                                 ,
                              
                           
                        where 
                           
                              
                                 
                                    D
                                 
                                 
                                    t
                                    ,
                                    s
                                 
                              
                           
                         is defined as 
                           
                              
                                 
                                    ∑
                                 
                                 
                                    τ
                                    =
                                    t
                                 
                                 
                                    s
                                 
                              
                              
                                 
                                    d
                                 
                                 
                                    τ
                                 
                              
                           
                        . Now, 
                           
                              f
                              (
                              1
                              ,
                              €
                              )
                           
                         gives the minimum emissions given budget €. We first compute 
                           
                              f
                              (
                              1
                              ,
                              €
                              )
                           
                         for 
                           
                              €
                              =
                              1
                           
                        . We consecutively compute 
                           
                              f
                              (
                              1
                              ,
                              €
                              )
                           
                         for budgets 
                           
                              €
                              =
                              1
                              ,
                              2
                              ,
                              3
                              ,
                              …
                           
                         and compute the corresponding 
                           
                              f
                              (
                              1
                              ,
                              €
                              )
                           
                         until 
                           
                              f
                              (
                              1
                              ,
                              €
                              )
                              ⩽
                              
                                 
                                    C
                                 
                                 
                                    ^
                                 
                              
                           
                        , i.e., the minimum emissions are less than or equal to the emission cap. The first budget € for which this holds, is the optimal value.

For each 
                           
                              f
                              (
                              t
                              ,
                              €
                              )
                           
                        , the optimal s is stored. The production schedule corresponding to the solution found by the algorithm can then be found through a simple backtracking procedure.

It is easy to see that the running time of this dynamic program is 
                              
                                 O
                                 (
                                 
                                    
                                       T
                                    
                                    
                                       2
                                    
                                 
                                 opt
                                 )
                              
                           , where opt is the optimal value (of the financial budget).

This algorithm needs 
                              
                                 O
                                 (
                                 Topt
                                 )
                              
                            memory, to store all values 
                              
                                 f
                                 (
                                 t
                                 ,
                                 €
                                 )
                              
                            and the corresponding optimal s.

In the process of finding the optimal solution, we construct part of the Pareto optimal set. This is because for each budget 
                              
                                 €
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 opt
                              
                           , we find the minimum emissions, 
                              
                                 f
                                 (
                                 1
                                 ,
                                 €
                                 )
                              
                           . This algorithm can be used to find the whole Pareto optimal set. We first minimise emissions regardless of costs. This can be done by executing the (classic) Wagner–Whitin algorithm with the emission level as the objective (instead of the financial costs). Denote the corresponding costs by 
                              
                                 
                                    
                                       €
                                    
                                    
                                       ∼
                                    
                                 
                              
                           ; it is easy to see that this is polynomial in the input of a problem instance. Now, we can compute the minimum emissions, 
                              
                                 f
                                 (
                                 1
                                 ,
                                 €
                                 )
                              
                            for each budget 
                              
                                 €
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 
                                    
                                       €
                                    
                                    
                                       ∼
                                    
                                 
                              
                           . This procedure gives the whole Pareto optimal set for co-behaving costs and emissions in 
                              
                                 O
                                 (
                                 
                                    
                                       T
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       €
                                    
                                    
                                       ∼
                                    
                                 
                                 )
                              
                            time.

An alternative to find Pareto optimal solutions is to take linear combinations of the objective functions. However, in contrast to our pseudopolynomial algorithm, this method will not find the complete Pareto optimal set as our experiments (see Section 5) show that non-supported solutions exist in general (i.e., solutions not on the convex hull of the set of Pareto outcomes). Namely, each time the Lagrangian heuristic does not find an optimal solution of ELSEC, the corresponding solution is non-supported. To see this, the objective function in the Lagrangian heuristic is a weighted average of the original objective function and the left hand side of the emission constraint. Hence, for each value of 
                              
                                 λ
                              
                            (and in particular for an optimal value of 
                              
                                 λ
                              
                           ) we find a supported efficient solution of the bi-objective problem corresponding to ELSEC.

Clearly, it is the large number of budgets € to consider that makes the algorithm in the previous section run in pseudo rather than fully polynomial time. However, it is possible to turn the pseudo-polynomial algorithm into an FPTAS by reducing the number of states of € in a smart way. Instead of all budgets 
                           
                              €
                              =
                              1
                              ,
                              2
                              ,
                              …
                           
                        , we now only consider budgets equal to
                           
                              (22)
                              
                                 
                                    
                                       Δ
                                    
                                    
                                       k
                                    
                                 
                                 ≔
                                 
                                    
                                       
                                          
                                             1
                                             +
                                             
                                                
                                                   ε
                                                
                                                
                                                   (
                                                   e
                                                   -
                                                   1
                                                   )
                                                   (
                                                   T
                                                   +
                                                   1
                                                   )
                                                
                                             
                                          
                                       
                                    
                                    
                                       k
                                    
                                 
                                 ,
                                 
                                 k
                                 ∈
                                 N
                                 .
                              
                           
                        (See Fig. 2
                        .) This means that in every step of the dynamic programming recursion, we have to round down the budget to the nearest value of 
                           
                              
                                 
                                    Δ
                                 
                                 
                                    k
                                 
                              
                           
                        .
                           
                              (23)
                              
                                 f
                                 (
                                 t
                                 ,
                                 €
                                 )
                                 =
                                 
                                    
                                       
                                          min
                                       
                                       
                                          s
                                          >
                                          t
                                          :
                                          €
                                          ⩾
                                          c
                                          (
                                          t
                                          ,
                                          s
                                          )
                                       
                                    
                                 
                                 
                                    
                                       
                                          e
                                          (
                                          t
                                          ,
                                          s
                                          )
                                          +
                                          f
                                          (
                                          s
                                          +
                                          1
                                          ,
                                          round
                                          (
                                          €
                                          -
                                          c
                                          (
                                          t
                                          ,
                                          s
                                          )
                                          )
                                          )
                                       
                                    
                                 
                                 
                                 for
                                 
                                 t
                                 ⩽
                                 T
                                 ,
                              
                           
                        
                        
                           
                              (24)
                              
                                 f
                                 (
                                 T
                                 +
                                 1
                                 ,
                                 €
                                 )
                                 =
                                 0
                                 ,
                              
                           
                        
                        
                           
                              (25)
                              
                                 where
                                 
                                 round
                                 (
                                 a
                                 )
                                 
                                 ≔
                                 
                                 
                                    
                                       
                                          max
                                       
                                       
                                          k
                                          ∈
                                          N
                                       
                                    
                                 
                                 {
                                 
                                    
                                       Δ
                                    
                                    
                                       k
                                    
                                 
                                 :
                                 
                                    
                                       Δ
                                    
                                    
                                       k
                                    
                                 
                                 ⩽
                                 a
                                 }
                                 .
                              
                           
                        Analogously to what we did before, we try budget 
                           
                              €
                              =
                              
                                 
                                    Δ
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    Δ
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                                 
                                    Δ
                                 
                                 
                                    3
                                 
                              
                              ,
                              …
                           
                         until 
                           
                              f
                              (
                              1
                              ,
                              €
                              )
                              ⩽
                              
                                 
                                    C
                                 
                                 
                                    ^
                                 
                              
                           
                        , i.e. the minimum emissions are less than or equal to the emission cap. Again, for each 
                           
                              f
                              (
                              t
                              ,
                              €
                              )
                           
                        , the optimal s is stored. The production schedule corresponding to the solution found by the algorithm can then be found through a simple backtracking procedure.

The approach in which an exact, but only pseudo-polynomial dynamic program is transformed into a FPTAS by trimming the state space is attributable to Woeginger (2000) and Schuurman and Woeginger (2008) (see also Ibarra & Kim, 1975), as well as the idea to use a so-called trimming parameter 
                           
                              Δ
                           
                         of the type 
                           
                              Δ
                              
                              ≔
                              
                              1
                              +
                              
                                 
                                    ε
                                 
                                 
                                    2
                                    gT
                                 
                              
                           
                        . The FPTAS presented in this section takes an approach that is similar to Woeginger (2000). As far as we know, the FPTAS that is presented in Section 4.4 does not fit within his framework, because it is not based on a pseudo-polynomial algorithm, but rather on a generalisation of another FPTAS.

We verify that the obtained solution is in fact a 
                              
                                 (
                                 1
                                 +
                                 ε
                                 )
                              
                            approximation of the true optimum. The question is: how much of the budget is ‘wasted’ by repeatedly rounding off the budget?

In each production period, at most the size of one interval 
                              
                                 [
                                 
                                    
                                       Δ
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       Δ
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                 
                                 )
                              
                            is lost. In the worst case this is the largest interval. Since there are at most T production periods, the maximum rounding error equals the size of the T largest intervals. Suppose that for some budget 
                              
                                 €
                                 =
                                 
                                    
                                       Δ
                                    
                                    
                                       k
                                       +
                                       T
                                    
                                 
                              
                           , the algorithm gives no feasible solution (i.e., 
                              
                                 f
                                 (
                                 1
                                 ,
                                 
                                    
                                       Δ
                                    
                                    
                                       k
                                       +
                                       T
                                    
                                 
                                 )
                                 >
                                 
                                    
                                       C
                                    
                                    
                                       ^
                                    
                                 
                              
                           ). Then we know that 
                              
                                 
                                    
                                       Δ
                                    
                                    
                                       k
                                    
                                 
                              
                            is a lower bound, because we could have lost at most T intervals. Now, suppose that for the next budget, the algorithm does find a feasible solution (i.e., 
                              
                                 f
                                 (
                                 1
                                 ,
                                 
                                    
                                       Δ
                                    
                                    
                                       k
                                       +
                                       T
                                       +
                                       1
                                    
                                 
                                 )
                                 ⩽
                                 
                                    
                                       C
                                    
                                    
                                       ^
                                    
                                 
                              
                           ). So because we raise the budget from 
                              
                                 
                                    
                                       Δ
                                    
                                    
                                       k
                                       +
                                       T
                                    
                                 
                              
                            to 
                              
                                 
                                    
                                       Δ
                                    
                                    
                                       k
                                       +
                                       T
                                       +
                                       1
                                    
                                 
                              
                            each time we compute 
                              
                                 f
                                 (
                                 1
                                 ,
                                 €
                                 )
                              
                           , we may lose one more interval. Hence, the maximum total error equals the size of the 
                              
                                 T
                                 +
                                 1
                              
                            largest intervals. That means that if the algorithm finds a solution 
                              
                                 
                                    
                                       Δ
                                    
                                    
                                       k
                                       +
                                       T
                                       +
                                       1
                                    
                                 
                              
                           , the optimal value is at least 
                              
                                 
                                    
                                       Δ
                                    
                                    
                                       k
                                    
                                 
                              
                           . We therefore need to show that
                              
                                 
                                    
                                       
                                          
                                             
                                                1
                                                +
                                                
                                                   
                                                      ε
                                                   
                                                   
                                                      (
                                                      e
                                                      -
                                                      1
                                                      )
                                                      (
                                                      T
                                                      +
                                                      1
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                       
                                          k
                                          +
                                          T
                                          +
                                          1
                                       
                                    
                                    ⩽
                                    
                                       
                                          
                                             
                                                1
                                                +
                                                
                                                   
                                                      ε
                                                   
                                                   
                                                      (
                                                      e
                                                      -
                                                      1
                                                      )
                                                      (
                                                      T
                                                      +
                                                      1
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                       
                                          k
                                       
                                    
                                    (
                                    1
                                    +
                                    ε
                                    )
                                 
                              
                           or equivalently, 
                              
                                 
                                    
                                       
                                          
                                             1
                                             +
                                             
                                                
                                                   ε
                                                
                                                
                                                   (
                                                   e
                                                   -
                                                   1
                                                   )
                                                   (
                                                   T
                                                   +
                                                   1
                                                   )
                                                
                                             
                                          
                                       
                                    
                                    
                                       T
                                       +
                                       1
                                    
                                 
                                 ⩽
                                 (
                                 1
                                 +
                                 ε
                                 )
                              
                           . This is true because
                              
                                 
                                    
                                       
                                          
                                             
                                                1
                                                +
                                                
                                                   
                                                      ε
                                                      /
                                                      (
                                                      e
                                                      -
                                                      1
                                                      )
                                                   
                                                   
                                                      T
                                                      +
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                       
                                          T
                                          +
                                          1
                                       
                                    
                                    ⩽
                                    1
                                    +
                                    (
                                    e
                                    -
                                    1
                                    )
                                    ·
                                    
                                       
                                          ε
                                       
                                       
                                          e
                                          -
                                          1
                                       
                                    
                                    =
                                    1
                                    +
                                    ε
                                    
                                    (
                                    if
                                    
                                    0
                                    <
                                    ε
                                    ⩽
                                    (
                                    e
                                    -
                                    1
                                    )
                                    )
                                    .
                                 
                              
                           
                        

The inequality follows from the fact that 
                              
                                 
                                    
                                       
                                          
                                             1
                                             +
                                             
                                                
                                                   z
                                                
                                                
                                                   n
                                                
                                             
                                          
                                       
                                    
                                    
                                       n
                                    
                                 
                                 ⩽
                                 1
                                 +
                                 (
                                 e
                                 -
                                 1
                                 )
                                 z
                              
                           , if 
                              
                                 0
                                 ⩽
                                 z
                                 ⩽
                                 1
                              
                           .

The pseudo-polynomial algorithm in Section 4.2 has a running time of 
                              
                                 O
                                 (
                                 
                                    
                                       T
                                    
                                    
                                       2
                                    
                                 
                                 opt
                                 )
                              
                           . Instead of opt intervals, the algorithm in this section needs to consider at most 
                              
                                 
                                    
                                       n
                                    
                                    
                                       FPTAS
                                    
                                 
                              
                            intervals, where 
                              
                                 
                                    
                                       n
                                    
                                    
                                       FPTAS
                                    
                                 
                              
                            is the smallest integer such that 
                              
                                 
                                    
                                       Δ
                                    
                                    
                                       
                                          
                                             n
                                          
                                          
                                             FPTAS
                                          
                                       
                                    
                                 
                                 ⩾
                                 (
                                 1
                                 +
                                 ε
                                 )
                                 opt
                              
                           . It follows that:
                              
                                 
                                    
                                       
                                          n
                                       
                                       
                                          FPTAS
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   log
                                                
                                                
                                                   1
                                                   +
                                                   
                                                      
                                                         ε
                                                      
                                                      
                                                         (
                                                         e
                                                         -
                                                         1
                                                         )
                                                         (
                                                         T
                                                         +
                                                         1
                                                         )
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      (
                                                      1
                                                      +
                                                      ε
                                                      )
                                                      opt
                                                   
                                                
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   ln
                                                   
                                                      
                                                         
                                                            (
                                                            1
                                                            +
                                                            ε
                                                            )
                                                            opt
                                                         
                                                      
                                                   
                                                
                                                
                                                   ln
                                                   
                                                      
                                                         
                                                            1
                                                            +
                                                            
                                                               
                                                                  ε
                                                               
                                                               
                                                                  (
                                                                  e
                                                                  -
                                                                  1
                                                                  )
                                                                  (
                                                                  T
                                                                  +
                                                                  1
                                                                  )
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    ⩽
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      1
                                                      +
                                                      
                                                         
                                                            (
                                                            e
                                                            -
                                                            1
                                                            )
                                                            (
                                                            T
                                                            +
                                                            1
                                                            )
                                                         
                                                         
                                                            ε
                                                         
                                                      
                                                   
                                                
                                             
                                             ln
                                             (
                                             (
                                             1
                                             +
                                             ε
                                             )
                                             opt
                                             )
                                          
                                       
                                    
                                    ,
                                 
                              
                           where the inequality follows from the fact that 
                              
                                 ln
                                 (
                                 x
                                 +
                                 1
                                 )
                                 ⩾
                                 
                                    
                                       x
                                    
                                    
                                       x
                                       +
                                       1
                                    
                                 
                              
                           , which can be seen from the Taylor expansion of 
                              
                                 ln
                                 (
                                 x
                                 +
                                 1
                                 )
                              
                            (see also Schuurman & Woeginger, 2008). Therefore, there are 
                              
                                 O
                                 
                                    
                                       
                                          
                                             
                                                T
                                                max
                                                {
                                                ln
                                                (
                                                opt
                                                )
                                                ,
                                                1
                                                }
                                             
                                             
                                                ε
                                             
                                          
                                       
                                    
                                 
                              
                            budgets € to consider. Hence, the total running time is 
                              
                                 O
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      T
                                                   
                                                   
                                                      3
                                                   
                                                
                                                max
                                                {
                                                ln
                                                (
                                                opt
                                                )
                                                ,
                                                1
                                                }
                                             
                                             
                                                ε
                                             
                                          
                                       
                                    
                                 
                              
                           , which is fully polynomial.

This algorithm needs 
                              
                                 O
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      T
                                                   
                                                   
                                                      2
                                                   
                                                
                                                max
                                                {
                                                ln
                                                (
                                                opt
                                                )
                                                ,
                                                1
                                                }
                                             
                                             
                                                ε
                                             
                                          
                                       
                                    
                                 
                              
                            memory, to store all values 
                              
                                 f
                                 (
                                 t
                                 ,
                                 €
                                 )
                              
                            and the corresponding optimal s.

As we have shown that the algorithm described in this section is a 
                              
                                 (
                                 1
                                 +
                                 ε
                                 )
                              
                            approximation, we know a priori that the optimality gap of the obtained solution is at most 
                              
                                 100
                                 ε
                                 %
                              
                           . Previously, we have seen that 
                              
                                 
                                    
                                       Δ
                                    
                                    
                                       k
                                    
                                 
                              
                            is a lower bound for the optimal value, if 
                              
                                 
                                    
                                       Δ
                                    
                                    
                                       k
                                       +
                                       T
                                       +
                                       1
                                    
                                 
                              
                            is the (final) budget € corresponding to the algorithm’s solution. Afterwards, we can compute the actual costs of this solution, which we will call 
                              
                                 
                                    
                                       v
                                    
                                    
                                       FPTAS
                                    
                                 
                              
                           . We know that 
                              
                                 
                                    
                                       v
                                    
                                    
                                       FPTAS
                                    
                                 
                                 ⩽
                                 
                                    
                                       Δ
                                    
                                    
                                       k
                                       +
                                       T
                                       +
                                       1
                                    
                                 
                              
                           . That means that, a posteriori, we can compute the optimality gap more accurately as 
                              
                                 
                                    
                                       
                                          
                                             v
                                          
                                          
                                             FPTAS
                                          
                                       
                                       -
                                       
                                          
                                             Δ
                                          
                                          
                                             k
                                          
                                       
                                    
                                    
                                       
                                          
                                             Δ
                                          
                                          
                                             k
                                          
                                       
                                    
                                 
                              
                           .

An even smaller a posteriori gap can be obtained if we round down as much as possible during the execution of the algorithm. The reasoning behind this is as follows. The algorithm tries to find if there is a solution with some budget 
                              
                                 
                                    
                                       Δ
                                    
                                    
                                       k
                                    
                                 
                              
                           , such that the emissions are at most 
                              
                                 
                                    
                                       C
                                    
                                    
                                       ^
                                    
                                 
                              
                           . However, because of rounding, we may lose at most 
                              
                                 T
                                 +
                                 1
                              
                            intervals. Therefore, we start the algorithm with a budget 
                              
                                 
                                    
                                       Δ
                                    
                                    
                                       k
                                       +
                                       T
                                       +
                                       1
                                    
                                 
                              
                           , of which 
                              
                                 
                                    
                                       Δ
                                    
                                    
                                       k
                                       +
                                       T
                                       +
                                       1
                                    
                                 
                                 -
                                 
                                    
                                       Δ
                                    
                                    
                                       k
                                    
                                 
                              
                            may be ‘spent’ on rounding. To be precise, we round down once in each block. Since there are T periods, there are at most T blocks, and we round down at most T times. (Another interval may be lost, because we raise the budget from 
                              
                                 
                                    
                                       Δ
                                    
                                    
                                       k
                                       +
                                       T
                                    
                                 
                              
                            to 
                              
                                 
                                    
                                       Δ
                                    
                                    
                                       k
                                       +
                                       T
                                       +
                                       1
                                    
                                 
                              
                            each time we compute 
                              
                                 f
                                 (
                                 1
                                 ,
                                 €
                                 )
                              
                           , as mentioned earlier.) However, if, at some point during the execution of the algorithm, we consider a block of length k, we know that in the future periods, we can have at most 
                              
                                 T
                                 -
                                 k
                              
                            blocks. These 
                              
                                 T
                                 -
                                 k
                              
                            blocks need at most 
                              
                                 T
                                 -
                                 k
                              
                            extra intervals for the budget € for the approximation to be correct. In other words, if we consider a block of length k, we may lose one interval because of rounding and we are allowed to ‘throw away’ 
                              
                                 k
                                 -
                                 1
                              
                            intervals of the budget. By throwing away 
                              
                                 k
                                 -
                                 1
                              
                            intervals, or rounding down more as we call it, we keep the available budget in the algorithm low and the costs of the solution that the algorithm finds (given the initial budget 
                              
                                 
                                    
                                       Δ
                                    
                                    
                                       k
                                       +
                                       T
                                       +
                                       1
                                    
                                 
                              
                           ), 
                              
                                 
                                    
                                       v
                                    
                                    
                                       FPTAS
                                    
                                 
                              
                           , are lower than without rounding down extra. Because 
                              
                                 
                                    
                                       v
                                    
                                    
                                       FPTAS
                                    
                                 
                              
                            is lower, the a posteriori gap will be lower, since this is computed as 
                              
                                 
                                    
                                       
                                          
                                             v
                                          
                                          
                                             FPTAS
                                          
                                       
                                       -
                                       
                                          
                                             Δ
                                          
                                          
                                             k
                                          
                                       
                                    
                                    
                                       
                                          
                                             Δ
                                          
                                          
                                             k
                                          
                                       
                                    
                                 
                              
                           .

Formally, we round down the budget according to the following rounding function:
                              
                                 (26)
                                 
                                    roundmore
                                    
                                    (
                                    
                                       
                                          Δ
                                       
                                       
                                          i
                                       
                                    
                                    -
                                    c
                                    (
                                    t
                                    ,
                                    s
                                    )
                                    ,
                                    t
                                    ,
                                    s
                                    )
                                    
                                    ≔
                                    
                                    
                                       
                                          
                                             max
                                          
                                          
                                             k
                                             ∈
                                             N
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   Δ
                                                
                                                
                                                   k
                                                
                                             
                                             :
                                             
                                                
                                                   Δ
                                                
                                                
                                                   k
                                                
                                             
                                             ⩽
                                             
                                                
                                                   Δ
                                                
                                                
                                                   i
                                                   -
                                                   s
                                                   +
                                                   t
                                                
                                             
                                             -
                                             c
                                             (
                                             t
                                             ,
                                             s
                                             )
                                          
                                       
                                    
                                    .
                                 
                              
                           So we lose not just one interval in each block, but a number of intervals equal to the length of the block. It follows that the maximum number of intervals that we lose by rounding equals the total number of periods (T), as before. The roundmore function replaces the round function, defined in Eq. (25).

As the FPTAS in the previous section is based on the single-sourcing property, it cannot be applied to the problem with general costs and emissions in a straightforward manner. However, Theorem 6 tells us that there is at most one period with double-sourcing. This leads to the following idea for a general FPTAS.

All blocks are ‘normal’ single-sourcing blocks, except for one double-sourcing block, say 
                           
                              [
                              t
                              ,
                              s
                              ]
                           
                        . The costs and emissions in the double-sourcing block depend on which period between t and s, say v, is the double-sourcing period. This implies that t and v are the two production periods in this block. The costs and emissions also depend on how much of the demand in periods v until s is produced in period t and how much in v. Note that the demand for 
                           
                              t
                              ,
                              …
                              ,
                              v
                              -
                              1
                           
                        , the earlier periods in this block, always has to be produced in period t. The costs to satisfy all demand in double-sourcing block 
                           
                              [
                              t
                              ,
                              s
                              ]
                           
                         are between, say, 
                           
                              
                                 
                                    a
                                 
                                 
                                    ts
                                 
                              
                           
                         and 
                           
                              
                                 
                                    b
                                 
                                 
                                    ts
                                 
                              
                           
                        . The existence of these bounds follows directly from the boundedness of the lot-sizing problem. These costs 
                           
                              
                                 
                                    a
                                 
                                 
                                    ts
                                 
                              
                           
                         and 
                           
                              
                                 
                                    b
                                 
                                 
                                    ts
                                 
                              
                           
                         can be computed by considering all double-sourcing periods v and calculating the costs corresponding to the situation where there is a set-up (if applicable) in both periods t and v, but all demand in periods v until s is produced in either period t or period v. Now, we iterate over a ‘suitable subset’ of all values between 
                           
                              
                                 
                                    a
                                 
                                 
                                    ts
                                 
                              
                           
                         and 
                           
                              
                                 
                                    b
                                 
                                 
                                    ts
                                 
                              
                           
                        . These are the ‘double-sourcing block budgets’, $. For each $, we can compute the corresponding best v and (minimum) emissions in the double-sourcing block. For all other blocks, the single-sourcing property holds, so we can use a recursion like in the previous section.

The precise recursion is defined as follows:
                           
                              (27)
                              
                                 g
                                 (
                                 t
                                 ,
                                 €
                                 )
                                 =
                                 
                                    min
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   min
                                                
                                                
                                                   s
                                                   ⩾
                                                   t
                                                   :
                                                   €
                                                   ⩾
                                                   c
                                                   (
                                                   t
                                                   ,
                                                   s
                                                   )
                                                
                                             
                                          
                                          {
                                          e
                                          (
                                          t
                                          ,
                                          s
                                          )
                                          +
                                          g
                                          (
                                          s
                                          +
                                          1
                                          ,
                                          round
                                          (
                                          €
                                          -
                                          c
                                          (
                                          t
                                          ,
                                          s
                                          )
                                          )
                                          )
                                          }
                                          ,
                                          
                                             
                                                
                                                   min
                                                
                                                
                                                   s
                                                   ⩾
                                                   t
                                                   ,
                                                   $
                                                   ∈
                                                   
                                                      
                                                         B
                                                      
                                                      
                                                         ts
                                                      
                                                   
                                                   :
                                                   €
                                                   ⩾
                                                   $
                                                
                                             
                                          
                                          {
                                          e
                                          (
                                          t
                                          ,
                                          s
                                          ,
                                          $
                                          )
                                          +
                                          f
                                          (
                                          s
                                          +
                                          1
                                          ,
                                          round
                                          (
                                          €
                                          -
                                          $
                                          )
                                          )
                                          }
                                       
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              (28)
                              
                                 g
                                 (
                                 T
                                 +
                                 1
                                 ,
                                 €
                                 )
                                 =
                                 0
                                 ,
                              
                           
                        
                        
                           
                              (29)
                              
                                 e
                                 (
                                 t
                                 ,
                                 s
                                 ,
                                 $
                                 )
                                 =
                                 
                                    
                                       
                                          min
                                       
                                       
                                          v
                                          =
                                          t
                                          +
                                          1
                                          ,
                                          …
                                          ,
                                          s
                                       
                                    
                                 
                                 {
                                 e
                                 (
                                 t
                                 ,
                                 v
                                 ,
                                 s
                                 ,
                                 $
                                 )
                                 }
                                 ,
                              
                           
                        
                        
                           
                              (30)
                              
                                 e
                                 (
                                 t
                                 ,
                                 v
                                 ,
                                 s
                                 ,
                                 $
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       t
                                    
                                 
                                 (
                                 
                                    
                                       D
                                    
                                    
                                       t
                                       ,
                                       v
                                       -
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       α
                                    
                                    
                                       tvs
                                       $
                                    
                                 
                                 
                                    
                                       D
                                    
                                    
                                       v
                                       ,
                                       s
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       v
                                    
                                 
                                 (
                                 (
                                 1
                                 -
                                 
                                    
                                       α
                                    
                                    
                                       tvs
                                       $
                                    
                                 
                                 )
                                 
                                    
                                       D
                                    
                                    
                                       v
                                       ,
                                       s
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          τ
                                          =
                                          t
                                       
                                       
                                          v
                                          -
                                          1
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             h
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       τ
                                    
                                 
                                 (
                                 
                                    
                                       D
                                    
                                    
                                       τ
                                       ,
                                       v
                                       -
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       α
                                    
                                    
                                       tvs
                                       $
                                    
                                 
                                 
                                    
                                       D
                                    
                                    
                                       v
                                       ,
                                       s
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          τ
                                          =
                                          v
                                       
                                       
                                          s
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             h
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       τ
                                    
                                 
                                 (
                                 
                                    
                                       D
                                    
                                    
                                       τ
                                       ,
                                       s
                                    
                                 
                                 )
                                 ,
                              
                           
                        
                        
                           
                              f
                              (
                              t
                              ,
                              €
                              )
                              ,
                              c
                              (
                              t
                              ,
                              s
                              )
                              ,
                              e
                              (
                              t
                              ,
                              s
                              )
                           
                         and 
                           
                              round
                              (
                              •
                              )
                           
                         are exactly the same as in Eqs. (23), (20), (21) and (25), respectively.

The interpretation of recursion (27) is: 
                           
                              g
                              (
                              t
                              ,
                              €
                              )
                           
                         gives the minimum emissions in periods t until T, given that there is a budget € and that there may be double-sourcing (once) in periods t until T. To find the value of 
                           
                              g
                              (
                              t
                              ,
                              €
                              )
                           
                        , we need to determine whether the current block should have double-sourcing or not. The first line of (27) corresponds to the situation in which there is no double-sourcing in the current block 
                           
                              [
                              t
                              ,
                              s
                              ]
                           
                        . In that case, there may be double-sourcing in a later block and we should minimise over all possible values of the next production period, in a recursion that is similar to the 
                           
                              f
                              (
                              t
                              ,
                              €
                              )
                           
                         recursion (see Section 4.3). If there is double-sourcing in the current block, as in the second line of (27), then we need to minimise over s and 
                           
                              $
                           
                        , where s is the end of the current block and 
                           
                              $
                           
                         is the amount of money that is spent in double-sourcing block 
                           
                              [
                              t
                              ,
                              s
                              ]
                           
                        . Since there cannot be another block with double-sourcing, the recursion uses the value 
                           
                              f
                              (
                              s
                              +
                              1
                              ,
                              €
                              )
                           
                         (see Section 4.3) as the minimum emissions of periods 
                           
                              s
                              +
                              1
                              ,
                              …
                              ,
                              T
                           
                        .

The minimum emissions given a budget € are given by 
                           
                              g
                              (
                              1
                              ,
                              €
                              )
                           
                        . Try budget 
                           
                              €
                              =
                              
                                 
                                    Δ
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    Δ
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                                 
                                    Δ
                                 
                                 
                                    3
                                 
                              
                              ,
                              …
                           
                         until 
                           
                              g
                              (
                              1
                              ,
                              €
                              )
                              ⩽
                              
                                 
                                    C
                                 
                                 
                                    ^
                                 
                              
                           
                        , i.e., the minimum emissions are less than or equal to the emission cap, where 
                           
                              Δ
                           
                         is defined as in Eq. (22).

The suitable subset of double-sourcing block budgets 
                           
                              
                                 
                                    B
                                 
                                 
                                    ts
                                 
                              
                           
                         is defined as
                           
                              (31)
                              
                                 
                                    
                                       B
                                    
                                    
                                       ts
                                    
                                 
                                 =
                                 
                                    
                                       
                                          $
                                          :
                                          $
                                          =
                                          
                                             
                                                (
                                                1
                                                +
                                                ε
                                                )
                                             
                                             
                                                k
                                             
                                          
                                          ,
                                          k
                                          ∈
                                          N
                                          ,
                                          
                                             
                                                a
                                             
                                             
                                                ts
                                             
                                          
                                          ⩽
                                          
                                             
                                                (
                                                1
                                                +
                                                ε
                                                )
                                             
                                             
                                                k
                                             
                                          
                                          ⩽
                                          
                                             
                                                b
                                             
                                             
                                                ts
                                             
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              (32)
                              
                                 where
                                 
                                 
                                    
                                       a
                                    
                                    
                                       ts
                                    
                                 
                                 =
                                 
                                    
                                       
                                          min
                                       
                                       
                                          v
                                          =
                                          t
                                          ,
                                          …
                                          ,
                                          s
                                       
                                    
                                 
                                 {
                                 c
                                 (
                                 t
                                 ,
                                 v
                                 -
                                 1
                                 )
                                 +
                                 c
                                 (
                                 v
                                 ,
                                 s
                                 )
                                 }
                                 ,
                              
                           
                        
                        
                           
                              (33)
                              
                                 and
                                 
                                 
                                    
                                       b
                                    
                                    
                                       ts
                                    
                                 
                                 =
                                 
                                    
                                       
                                          max
                                       
                                       
                                          v
                                          =
                                          t
                                          ,
                                          …
                                          ,
                                          s
                                       
                                    
                                 
                                 {
                                 c
                                 (
                                 t
                                 ,
                                 v
                                 -
                                 1
                                 )
                                 +
                                 c
                                 (
                                 v
                                 ,
                                 s
                                 )
                                 }
                                 .
                              
                           
                        That is, the double-sourcing block budget $ is equal to 
                           
                              
                                 
                                    (
                                    1
                                    +
                                    ε
                                    )
                                 
                                 
                                    k
                                 
                              
                           
                         for some integer k and has to lie between the minimum and maximum costs in the double-sourcing block. See Fig. 3
                        .

In Eq. (29) 
                        
                           
                              e
                              (
                              t
                              ,
                              s
                              ,
                              $
                              )
                           
                         gives the minimum emissions in double-sourcing block 
                           
                              [
                              t
                              ,
                              s
                              ]
                           
                        , given a budget $. It is computed by minimising over all the possible double-sourcing periods v.

In Eq. (30), 
                           
                              e
                              (
                              t
                              ,
                              v
                              ,
                              s
                              ,
                              $
                              )
                           
                         gives the emissions in double-sourcing block 
                           
                              (
                              t
                              ,
                              v
                              ,
                              s
                              )
                           
                         (so given the double-sourcing period v), if a budget of $ is spent. If the production and holding emissions are fixed-plus-linear, then this equation reduces to
                           
                              (34)
                              
                                 e
                                 (
                                 t
                                 ,
                                 v
                                 ,
                                 s
                                 ,
                                 $
                                 )
                                 =
                                 
                                    
                                       α
                                    
                                    
                                       tvs
                                       $
                                    
                                 
                                 
                                    
                                       
                                          
                                             a
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       tvs
                                    
                                 
                                 +
                                 (
                                 1
                                 -
                                 
                                    
                                       α
                                    
                                    
                                       tvs
                                       $
                                    
                                 
                                 )
                                 
                                    
                                       
                                          
                                             b
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       tvs
                                    
                                 
                                 ,
                              
                           
                        where 
                           
                              
                                 
                                    
                                       
                                          a
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    tvs
                                 
                              
                           
                         and 
                           
                              
                                 
                                    
                                       
                                          b
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    tvs
                                 
                              
                           
                         are the emissions to satisfy demand in the double-sourcing block, when there is a set-up (if applicable) in both periods t and v, but all demand in periods v through s is produced in period t, respectively v. 
                           
                              
                                 
                                    α
                                 
                                 
                                    tvs
                                    $
                                 
                              
                           
                         gives the fraction of demand in periods v through s that is produced in period t, if the budget in double-sourcing block 
                           
                              (
                              t
                              ,
                              v
                              ,
                              s
                              )
                           
                         is $; the remaining 
                           
                              (
                              1
                              -
                              
                                 
                                    α
                                 
                                 
                                    tvs
                                    $
                                 
                              
                              )
                           
                         is then produced in period v. If the production and holding emissions are fixed-plus-linear, then this is simply
                           
                              
                                 
                                    
                                       α
                                    
                                    
                                       tvs
                                       $
                                    
                                 
                                 =
                                 
                                    
                                       $
                                       -
                                       
                                          
                                             b
                                          
                                          
                                             tvs
                                          
                                       
                                    
                                    
                                       
                                          
                                             a
                                          
                                          
                                             tvs
                                          
                                       
                                       -
                                       
                                          
                                             b
                                          
                                          
                                             tvs
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        where 
                           
                              
                                 
                                    a
                                 
                                 
                                    tvs
                                 
                              
                           
                         and 
                           
                              
                                 
                                    b
                                 
                                 
                                    tvs
                                 
                              
                           
                         are the costs to satisfy demand in the double-sourcing block, when there is a set-up (if applicable) in both periods t and v, but all demand in periods v through s is produced in period t, respectively v. In general, 
                           
                              
                                 
                                    α
                                 
                                 
                                    tvs
                                    $
                                 
                              
                           
                         is the solution of
                           
                              (35)
                              
                                 
                                    
                                       p
                                    
                                    
                                       t
                                    
                                 
                                 (
                                 
                                    
                                       D
                                    
                                    
                                       t
                                       ,
                                       v
                                       -
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       α
                                    
                                    
                                       tvs
                                       $
                                    
                                 
                                 
                                    
                                       D
                                    
                                    
                                       v
                                       ,
                                       s
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       p
                                    
                                    
                                       v
                                    
                                 
                                 (
                                 (
                                 1
                                 -
                                 
                                    
                                       α
                                    
                                    
                                       tvs
                                       $
                                    
                                 
                                 )
                                 
                                    
                                       D
                                    
                                    
                                       v
                                       ,
                                       s
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          τ
                                          =
                                          t
                                       
                                       
                                          v
                                          -
                                          1
                                       
                                    
                                 
                                 
                                    
                                       h
                                    
                                    
                                       τ
                                    
                                 
                                 (
                                 
                                    
                                       D
                                    
                                    
                                       τ
                                       ,
                                       v
                                       -
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       α
                                    
                                    
                                       tvs
                                       $
                                    
                                 
                                 
                                    
                                       D
                                    
                                    
                                       v
                                       ,
                                       s
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          τ
                                          =
                                          v
                                       
                                       
                                          s
                                       
                                    
                                 
                                 
                                    
                                       h
                                    
                                    
                                       τ
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                D
                                             
                                             
                                                τ
                                                ,
                                                s
                                             
                                          
                                       
                                    
                                 
                                 =
                                 $
                                 .
                              
                           
                        We assume that this 
                           
                              
                                 
                                    α
                                 
                                 
                                    tvs
                                    $
                                 
                              
                           
                         can be found in constant time. This is the case for e.g. fixed-plus-linear costs, cost functions that are polynomials of degree at most four, and compound functions of which every piece is such a function (as long as the resulting function is concave for relevant production/inventory quantities). Otherwise, if finding an 
                           
                              
                                 
                                    α
                                 
                                 
                                    tvs
                                    $
                                 
                              
                           
                         takes 
                           
                              O
                              (
                              A
                              )
                           
                         time and this is more than 
                           
                              O
                              
                                 
                                    
                                       
                                          
                                             max
                                             {
                                             ln
                                             (
                                             opt
                                             )
                                             ,
                                             1
                                             }
                                          
                                          
                                             ε
                                          
                                       
                                    
                                 
                              
                           
                        , the time complexity becomes 
                           
                              O
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   T
                                                
                                                
                                                   3
                                                
                                             
                                             max
                                             {
                                             
                                                
                                                   ln
                                                
                                                
                                                   2
                                                
                                             
                                             (
                                             opt
                                             )
                                             ,
                                             1
                                             }
                                          
                                          
                                             
                                                
                                                   ε
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       +
                                       
                                          
                                             
                                                
                                                   T
                                                
                                                
                                                   3
                                                
                                             
                                             max
                                             {
                                             ln
                                             (
                                             opt
                                             )
                                             ,
                                             1
                                             }
                                          
                                          
                                             ε
                                          
                                       
                                       ·
                                       A
                                    
                                 
                              
                           
                         (see ‘Running time’ in Section 4.3). Note that we may approximate 
                           
                              
                                 
                                    α
                                 
                                 
                                    tvs
                                    $
                                 
                              
                           
                        , for instance with a numerical method like bisection. However, in order for the algorithm to be accurate enough, we may not overestimate 
                           
                              
                                 
                                    α
                                 
                                 
                                    tvs
                                    $
                                 
                              
                           
                        . (Here we assume that the left hand side in (35) is an increasing function in 
                           
                              
                                 
                                    α
                                 
                                 
                                    tvs
                                    $
                                 
                              
                           
                        . Otherwise, define 
                           
                              
                                 
                                    α
                                 
                                 
                                    tvs
                                    $
                                 
                                 
                                    new
                                 
                              
                              =
                              1
                              -
                              
                                 
                                    α
                                 
                                 
                                    tvs
                                    $
                                 
                              
                           
                        .)

In practise, the algorithm can be sped up, because we know that for many choices of 
                           
                              t
                              ,
                              v
                           
                         and s, the triple 
                           
                              (
                              t
                              ,
                              v
                              ,
                              s
                              )
                           
                         does not have to form a double-sourcing block in an optimal solution. This is because Theorem 3 tells us that the single-sourcing property holds for a triple 
                           
                              (
                              t
                              ,
                              v
                              ,
                              s
                              )
                           
                         such that 
                           
                              
                                 
                                    
                                       
                                          
                                             C
                                          
                                          
                                             t
                                             ,
                                             s
                                          
                                       
                                       ⩽
                                       
                                          
                                             C
                                          
                                          
                                             v
                                             ,
                                             s
                                          
                                       
                                       
                                       and
                                       
                                       
                                          
                                             
                                                
                                                   C
                                                
                                                
                                                   ^
                                                
                                             
                                          
                                          
                                             t
                                             ,
                                             s
                                          
                                       
                                       ⩽
                                       
                                          
                                             
                                                
                                                   C
                                                
                                                
                                                   ^
                                                
                                             
                                          
                                          
                                             v
                                             ,
                                             s
                                          
                                       
                                    
                                 
                              
                           
                         or 
                           
                              (
                              
                                 
                                    C
                                 
                                 
                                    t
                                    ,
                                    s
                                 
                              
                              ⩾
                              
                                 
                                    C
                                 
                                 
                                    v
                                    ,
                                    s
                                 
                              
                              
                              and
                              
                              
                                 
                                    
                                       
                                          C
                                       
                                       
                                          ^
                                       
                                    
                                 
                                 
                                    t
                                    ,
                                    s
                                 
                              
                              ⩾
                              
                                 
                                    
                                       
                                          C
                                       
                                       
                                          ^
                                       
                                    
                                 
                                 
                                    v
                                    ,
                                    s
                                 
                              
                              )
                           
                        . This means that, if these conditions hold for a triple 
                           
                              (
                              t
                              ,
                              v
                              ,
                              s
                              )
                           
                        , there exists an optimal solution in which period t is the only production period in block 
                           
                              [
                              t
                              ,
                              s
                              ]
                           
                        . Therefore, it is not necessary to consider all possible second production periods v to compute the minimum in (29).

The production schedule corresponding to the solution found by the algorithm can be found through a relatively simple backtracking procedure. For each 
                              
                                 f
                                 (
                                 t
                                 ,
                                 €
                                 )
                              
                           , we store the optimal s, as before. For each 
                              
                                 g
                                 (
                                 t
                                 ,
                                 €
                                 )
                              
                           , we store the optimal s, whether double-sourcing in block 
                              
                                 [
                                 t
                                 ,
                                 s
                                 ]
                              
                            is optimal or not, and if so, which budget $ is optimal. We could also store the optimal double-sourcing period v, but in certain cases, we can choose an approach to make a solution with lower costs by using as much of the (remaining) emission capacity as possible. More details of this approach are given in Appendix C.

As in Section 4.3, we verify that the obtained solution is in fact a 
                              
                                 (
                                 1
                                 +
                                 ε
                                 )
                              
                            approximation of the true optimum by answering the question: how much of the budget is ‘wasted’ by repeatedly rounding off the budget?

Rounding values of $ costs at most one ‘big’ 
                              
                                 (
                                 1
                                 +
                                 ε
                                 )
                              
                           -interval. In the remainder of the algorithm, at most 
                              
                                 T
                                 +
                                 1
                              
                            ‘small’ 
                              
                                 Δ
                              
                           -intervals are lost. In Section 4.3, we have shown that these small intervals add up to at most one ‘big’ 
                              
                                 (
                                 1
                                 +
                                 ε
                                 )
                              
                           -interval. Hence, the maximum total error is 
                              
                                 ε
                                 ·
                                 opt
                                 +
                                 ε
                                 (
                                 1
                                 +
                                 ε
                                 )
                                 opt
                                 =
                                 (
                                 2
                                 ε
                                 +
                                 
                                    
                                       ε
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 opt
                                 ⩽
                                 3
                                 ε
                                 ·
                                 opt
                                 (
                                 for
                                 
                                 0
                                 ⩽
                                 ε
                                 ⩽
                                 1
                                 )
                              
                           . We could define 
                              
                                 ε
                                 ≔
                                 
                                    
                                       δ
                                    
                                    
                                       3
                                    
                                 
                              
                            to get a 
                              
                                 (
                                 1
                                 +
                                 δ
                                 )
                              
                            approximation. In practise, we choose 
                              
                                 ε
                                 =
                                 
                                    
                                       1
                                       +
                                       δ
                                    
                                 
                                 -
                                 1
                                 ⩾
                                 
                                    
                                       δ
                                    
                                    
                                       3
                                    
                                 
                              
                           . That way, 
                              
                                 ε
                              
                            is the positive solution of 
                              
                                 2
                                 ε
                                 +
                                 
                                    
                                       ε
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 δ
                              
                           .

As in the FPTAS for co-behaving costs, there are 
                              
                                 O
                                 
                                    
                                       
                                          
                                             
                                                T
                                                max
                                                {
                                                ln
                                                (
                                                opt
                                                )
                                                ,
                                                1
                                                }
                                             
                                             
                                                ε
                                             
                                          
                                       
                                    
                                 
                              
                            values for €. Similarly, we can show that there are 
                              
                                 O
                                 
                                    
                                       
                                          
                                             
                                                max
                                                {
                                                ln
                                                (
                                                opt
                                                )
                                                ,
                                                1
                                                }
                                             
                                             
                                                ε
                                             
                                          
                                       
                                    
                                 
                              
                            intervals for 
                              
                                 $
                              
                           , because the number of double-sourcing block budgets 
                              
                                 $
                              
                            is at most
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                
                                                   1
                                                   +
                                                   ε
                                                
                                             
                                             log
                                             (
                                             opt
                                             )
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   ln
                                                   (
                                                   opt
                                                   )
                                                
                                                
                                                   ln
                                                   
                                                      
                                                         
                                                            1
                                                            +
                                                            ε
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    ⩽
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      1
                                                      +
                                                      
                                                         
                                                            1
                                                         
                                                         
                                                            ε
                                                         
                                                      
                                                   
                                                
                                             
                                             ln
                                             (
                                             opt
                                             )
                                          
                                       
                                    
                                    .
                                 
                              
                           In total, there are 
                              
                                 O
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      T
                                                   
                                                   
                                                      2
                                                   
                                                
                                                max
                                                {
                                                ln
                                                (
                                                opt
                                                )
                                                ,
                                                1
                                                }
                                             
                                             
                                                ε
                                             
                                          
                                       
                                    
                                 
                              
                            values of both 
                              
                                 g
                                 (
                                 t
                                 ,
                                 €
                                 )
                              
                            and 
                              
                                 f
                                 (
                                 t
                                 ,
                                 €
                                 )
                              
                            that need to be computed. As in Section 4.3, it takes 
                              
                                 O
                                 (
                                 T
                                 )
                              
                            time to compute one 
                              
                                 f
                                 (
                                 t
                                 ,
                                 €
                                 )
                              
                           . Computing one 
                              
                                 g
                                 (
                                 t
                                 ,
                                 €
                                 )
                              
                            takes 
                              
                                 O
                                 
                                    
                                       
                                          T
                                          +
                                          T
                                          ·
                                          
                                             
                                                max
                                                {
                                                ln
                                                (
                                                opt
                                                )
                                                ,
                                                1
                                                }
                                             
                                             
                                                ε
                                             
                                          
                                       
                                    
                                 
                                 =
                                 O
                                 
                                    
                                       
                                          
                                             
                                                T
                                                max
                                                {
                                                ln
                                                (
                                                opt
                                                )
                                                ,
                                                1
                                                }
                                             
                                             
                                                ε
                                             
                                          
                                       
                                    
                                 
                              
                            time, because there are two minimisations in recursion (27); the first one over periods s; the second one over periods s and 
                              
                                 $
                                 ∈
                                 
                                    
                                       B
                                    
                                    
                                       ts
                                    
                                 
                              
                           . Hence, the total time needed to compute all 
                              
                                 g
                                 (
                                 t
                                 ,
                                 €
                                 )
                              
                            and 
                              
                                 f
                                 (
                                 t
                                 ,
                                 €
                                 )
                              
                            is 
                              
                                 O
                                 
                                    
                                       
                                          
                                             
                                                T
                                                max
                                                {
                                                ln
                                                (
                                                opt
                                                )
                                                ,
                                                1
                                                }
                                             
                                             
                                                ε
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   
                                                      T
                                                   
                                                   
                                                      3
                                                   
                                                
                                                max
                                                {
                                                
                                                   
                                                      ln
                                                   
                                                   
                                                      2
                                                   
                                                
                                                (
                                                opt
                                                )
                                                ,
                                                1
                                                }
                                             
                                             
                                                
                                                   
                                                      ε
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 =
                                 O
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      T
                                                   
                                                   
                                                      3
                                                   
                                                
                                                max
                                                {
                                                
                                                   
                                                      ln
                                                   
                                                   
                                                      2
                                                   
                                                
                                                (
                                                opt
                                                )
                                                ,
                                                1
                                                }
                                             
                                             
                                                
                                                   
                                                      ε
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           .

Furthermore, there are 
                              
                                 O
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      T
                                                   
                                                   
                                                      2
                                                   
                                                
                                                max
                                                {
                                                ln
                                                (
                                                opt
                                                )
                                                ,
                                                1
                                                }
                                             
                                             
                                                ε
                                             
                                          
                                       
                                    
                                 
                              
                            values of 
                              
                                 e
                                 (
                                 t
                                 ,
                                 s
                                 ,
                                 $
                                 )
                              
                            that need to be computed. Computing one 
                              
                                 e
                                 (
                                 t
                                 ,
                                 s
                                 ,
                                 $
                                 )
                              
                            takes 
                              
                                 O
                                 (
                                 T
                                 )
                              
                            time, so the time needed to compute all 
                              
                                 e
                                 (
                                 t
                                 ,
                                 s
                                 ,
                                 $
                                 )
                              
                            is 
                              
                                 O
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      T
                                                   
                                                   
                                                      3
                                                   
                                                
                                                max
                                                {
                                                ln
                                                (
                                                opt
                                                )
                                                ,
                                                1
                                                }
                                             
                                             
                                                ε
                                             
                                          
                                       
                                    
                                 
                              
                           . Since all 
                              
                                 e
                                 (
                                 t
                                 ,
                                 s
                                 ,
                                 $
                                 )
                              
                            can be computed beforehand, it follows that the time complexity of the whole FPTAS is 
                              
                                 O
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      T
                                                   
                                                   
                                                      3
                                                   
                                                
                                                max
                                                {
                                                
                                                   
                                                      ln
                                                   
                                                   
                                                      2
                                                   
                                                
                                                (
                                                opt
                                                )
                                                ,
                                                1
                                                }
                                             
                                             
                                                
                                                   
                                                      ε
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           .

As in the co-behaving case, this algorithm needs 
                              
                                 O
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      T
                                                   
                                                   
                                                      2
                                                   
                                                
                                                max
                                                {
                                                ln
                                                (
                                                opt
                                                )
                                                ,
                                                1
                                                }
                                             
                                             
                                                ε
                                             
                                          
                                       
                                    
                                 
                              
                            memory to store all values 
                              
                                 f
                                 (
                                 t
                                 ,
                                 €
                                 )
                              
                            and the corresponding optimal s, and all values 
                              
                                 g
                                 (
                                 t
                                 ,
                                 €
                                 )
                              
                            and the corresponding optimal s and 
                              
                                 $
                              
                           . Storing all values 
                              
                                 e
                                 (
                                 t
                                 ,
                                 s
                                 ,
                                 $
                                 )
                              
                            requires 
                              
                                 O
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      T
                                                   
                                                   
                                                      3
                                                   
                                                
                                                max
                                                {
                                                ln
                                                (
                                                opt
                                                )
                                                ,
                                                1
                                                }
                                             
                                             
                                                ε
                                             
                                          
                                       
                                    
                                 
                              
                            memory. Hence, the total required memory is of the same order.

As we have shown that the algorithm described in this section is a 
                              
                                 (
                                 1
                                 +
                                 ε
                                 )
                              
                            approximation, we know a priori that the optimality gap of the obtained solution is at most 
                              
                                 100
                                 ε
                                 %
                              
                           . Previously, we have seen that 
                              
                                 
                                    
                                       
                                          
                                             Δ
                                          
                                          
                                             k
                                             +
                                             T
                                             +
                                             1
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                2
                                                ε
                                                +
                                                
                                                   
                                                      ε
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                            (or even: 
                              
                                 
                                    
                                       
                                          
                                             Δ
                                          
                                          
                                             k
                                             +
                                             T
                                             +
                                             1
                                          
                                       
                                    
                                    
                                       (
                                       1
                                       +
                                       ε
                                       )
                                       
                                          
                                             Δ
                                          
                                          
                                             T
                                             +
                                             1
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             Δ
                                          
                                          
                                             k
                                          
                                       
                                    
                                    
                                       1
                                       +
                                       ε
                                    
                                 
                              
                           ) is a lower bound for the optimal value, if 
                              
                                 
                                    
                                       Δ
                                    
                                    
                                       k
                                       +
                                       T
                                       +
                                       1
                                    
                                 
                              
                            is the (final) budget € corresponding to the algorithm’s solution. Afterwards, we can compute the actual costs of this solution, which we will call 
                              
                                 
                                    
                                       v
                                    
                                    
                                       FPTAS
                                    
                                 
                              
                           . We know that 
                              
                                 
                                    
                                       v
                                    
                                    
                                       FPTAS
                                    
                                 
                                 ⩽
                                 
                                    
                                       Δ
                                    
                                    
                                       k
                                       +
                                       T
                                       +
                                       1
                                    
                                 
                              
                           . That means that we can compute the optimality gap more sharply as 
                              
                                 
                                    
                                       
                                          
                                             v
                                          
                                          
                                             FPTAS
                                          
                                       
                                       -
                                       
                                          
                                             
                                                
                                                   Δ
                                                
                                                
                                                   k
                                                
                                             
                                          
                                          
                                             1
                                             +
                                             ε
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   Δ
                                                
                                                
                                                   k
                                                
                                             
                                          
                                          
                                             1
                                             +
                                             ε
                                          
                                       
                                    
                                 
                              
                           .

As in Section 4.3, an even better a posteriori gap can be obtained if we round down €as much as possible during the execution of the algorithm. We round down the budget €according to the roundmore function (see Eq. (26)). As before, it follows that the total number of 
                              
                                 Δ
                              
                           -intervals that we lose by rounding € equals the total number of periods (T).

In the execution of the FPTASes in Sections 4.3 and 4.4, we encounter many small intervals. For example, we need to compute 
                           
                              f
                              (
                              t
                              ,
                              €
                              )
                           
                         for 
                           
                              €
                              =
                              
                                 
                                    Δ
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    Δ
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                                 
                                    Δ
                                 
                                 
                                    3
                                 
                              
                              ,
                              …
                           
                        , even though the optimal value is closer to, say, 
                           
                              
                                 
                                    Δ
                                 
                                 
                                    100
                                 
                              
                           
                        . In retrospect, we would not have needed intervals smaller than 
                           
                              
                                 
                                    ε
                                 
                                 
                                    (
                                    e
                                    -
                                    1
                                    )
                                    (
                                    T
                                    +
                                    1
                                    )
                                 
                              
                              opt
                           
                         for €. Of course, we do not know the optimal value beforehand. However, we can compute a lower bound (LB) first, so that we know that we do not need intervals smaller than 
                           
                              
                                 
                                    ε
                                 
                                 
                                    (
                                    e
                                    -
                                    1
                                    )
                                    (
                                    T
                                    +
                                    1
                                    )
                                 
                              
                              LB
                           
                         for 
                           
                              €
                           
                         during the execution of the FPTAS. We replace all intervals below LB by intervals of size 
                           
                              
                                 
                                    ε
                                 
                                 
                                    (
                                    e
                                    -
                                    1
                                    )
                                    (
                                    T
                                    +
                                    1
                                    )
                                 
                              
                              LB
                           
                        . To see why this works, we look back at the paragraph entitled ‘Correctness of the approximation’ in Section 4.3. Again, suppose we find a solution when 
                           
                              €
                              =
                              
                                 
                                    Δ
                                 
                                 
                                    k
                                    +
                                    T
                                    +
                                    1
                                 
                              
                           
                         (
                           
                              ⩾
                              LB
                           
                        ). Also, suppose we have a lower bound after executing the algorithm, say 
                           
                              
                                 
                                    LB
                                 
                                 
                                    post
                                 
                              
                           
                        . In Section 4.3, this lower bound is equal to 
                           
                              
                                 
                                    Δ
                                 
                                 
                                    k
                                 
                              
                           
                        ; now, it is 
                           
                              
                                 
                                    LB
                                 
                                 
                                    post
                                 
                              
                              =
                              max
                              {
                              
                                 
                                    Δ
                                 
                                 
                                    k
                                 
                              
                              ,
                              LB
                              }
                           
                        . If 
                           
                              LB
                              ⩾
                              
                                 
                                    Δ
                                 
                                 
                                    k
                                 
                              
                           
                        , then it follows that we have found a 
                           
                              (
                              1
                              +
                              ε
                              )
                           
                         approximation, because 
                           
                              opt
                              -
                              LB
                              ⩽
                              opt
                              -
                              
                                 
                                    Δ
                                 
                                 
                                    k
                                 
                              
                              ⩽
                              
                                 
                                    Δ
                                 
                                 
                                    k
                                    +
                                    T
                                    +
                                    1
                                 
                              
                              -
                              
                                 
                                    Δ
                                 
                                 
                                    k
                                 
                              
                              ⩽
                              
                                 
                                    Δ
                                 
                                 
                                    k
                                 
                              
                              (
                              
                                 
                                    Δ
                                 
                                 
                                    T
                                    +
                                    1
                                 
                              
                              -
                              1
                              )
                              ⩽
                              
                                 
                                    Δ
                                 
                                 
                                    k
                                 
                              
                              (
                              1
                              +
                              ε
                              -
                              1
                              )
                              ⩽
                              LB
                              ·
                              ε
                              ⩽
                              opt
                              ·
                              ε
                           
                        , where the correctness of the fourth inequality was shown in Section 4.3. Alternatively, suppose that 
                           
                              
                                 
                                    Δ
                                 
                                 
                                    k
                                 
                              
                              >
                              LB
                           
                        . In the worst case, we have lost the 
                           
                              T
                              +
                              1
                           
                         intervals due to rounding. In the proof in Section 4.3, we have shown that losing the 
                           
                              T
                              +
                              1
                           
                         biggest intervals still resulted in a 
                           
                              (
                              1
                              +
                              ε
                              )
                           
                         approximation. There, the smallest of the biggest intervals had size 
                           
                              
                                 
                                    Δ
                                 
                                 
                                    k
                                    +
                                    1
                                 
                              
                              -
                              
                                 
                                    Δ
                                 
                                 
                                    k
                                 
                              
                              =
                              
                                 
                                    Δ
                                 
                                 
                                    k
                                 
                              
                              (
                              Δ
                              -
                              1
                              )
                              =
                              
                                 
                                    Δ
                                 
                                 
                                    k
                                 
                              
                              ·
                              
                                 
                                    ε
                                 
                                 
                                    (
                                    e
                                    -
                                    1
                                    )
                                    (
                                    T
                                    +
                                    1
                                    )
                                 
                              
                           
                        . In the algorithm in this section, the intervals above LB are the same as before; the intervals below LB have size 
                           
                              
                                 
                                    ε
                                 
                                 
                                    (
                                    e
                                    -
                                    1
                                    )
                                    (
                                    T
                                    +
                                    1
                                    )
                                 
                              
                              LB
                              ⩽
                              
                                 
                                    ε
                                 
                                 
                                    (
                                    e
                                    -
                                    1
                                    )
                                    (
                                    T
                                    +
                                    1
                                    )
                                 
                              
                              
                                 
                                    Δ
                                 
                                 
                                    k
                                 
                              
                           
                        . Because the 
                           
                              T
                              +
                              1
                           
                         biggest intervals that can be lost in this section have the same size as or are smaller than in Section 4.3, we conclude that we still have a 
                           
                              (
                              1
                              +
                              ε
                              )
                           
                         approximation.

Similarly, we may use intervals of size at least 
                           
                              ε
                              ·
                              LB
                           
                         for $ in the FPTAS for general costs and emissions. We replace all intervals below LB by intervals of size 
                           
                              ε
                              ·
                              LB
                           
                        . See Fig. 4
                         for an example with 
                           
                              LB
                              =
                              4
                              ε
                              =
                              
                                 
                                    (
                                    1
                                    +
                                    ε
                                    )
                                 
                                 
                                    k
                                 
                              
                           
                        .

In the computational tests of the next section, we will use the Lagrangian heuristic from Section 4.1 to compute a lower bound, but of course any method to compute a nonzero lower bound would do.

We would like to point out that, if we have a nonzero lower bound that we use in the FPTASes, the assumption of integer demand and cost functions, which we made in Section 4.2, is not necessary anymore. The only reason why we needed this assumption for correctness of the FPTASes, is that 1 had to be a trivial lower bound for the problems. This is because the FPTASes in the previous sections have one big interval between 0 and 
                           
                              1
                              =
                              
                                 
                                    Δ
                                 
                                 
                                    0
                                 
                              
                              =
                              
                                 
                                    (
                                    1
                                    +
                                    ε
                                    )
                                 
                                 
                                    0
                                 
                              
                           
                         for 
                           
                              €
                           
                         and $. (Note that the points after this, 
                           
                              
                                 
                                    Δ
                                 
                                 
                                    0
                                 
                              
                              ,
                              
                                 
                                    Δ
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    Δ
                                 
                                 
                                    2
                                 
                              
                              ,
                              …
                           
                         or 
                           
                              
                                 
                                    (
                                    1
                                    +
                                    ε
                                    )
                                 
                                 
                                    0
                                 
                              
                              ,
                              
                                 
                                    (
                                    1
                                    +
                                    ε
                                    )
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    (
                                    1
                                    +
                                    ε
                                    )
                                 
                                 
                                    2
                                 
                              
                              ,
                              …
                           
                        , are much closer to each other in general.) A problem instance with an optimal value lower than 1 would therefore require more intervals between 0 and 1. However, if we use a nonzero lower bound in the FPTASes in this section, we already know that all intervals have a size of at most 
                           
                              
                                 
                                    ε
                                 
                                 
                                    (
                                    e
                                    -
                                    1
                                    )
                                    (
                                    T
                                    +
                                    1
                                    )
                                 
                              
                              LB
                           
                         for 
                           
                              €
                           
                         and 
                           
                              ε
                              ·
                              LB
                           
                         for $, and that these intervals are small enough, as discussed above. Of course, it is possible that we are unable to find a nonzero lower bound. In this case, the assumption of integer demand and cost functions can still be useful, because it guarantees a nonzero lower bound (namely 1), but any other method to obtain a nonzero lower bound would suffice for the FPTASes in this section.

To determine the running times of both FPTASes if we use the minimum interval size as described above, we must compute the new numbers of values for 
                              
                                 €
                              
                            and 
                              
                                 $
                              
                           .

For the total budget 
                              
                                 €
                              
                           , we compute the number of values that we had in the FPTAS before, subtract the number of values that lay below LB (as these values will not be used anymore), and add the number of newly created, larger intervals that lie below LB. We get:
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                
                                                   1
                                                   +
                                                   
                                                      
                                                         ε
                                                      
                                                      
                                                         (
                                                         e
                                                         -
                                                         1
                                                         )
                                                         (
                                                         T
                                                         +
                                                         1
                                                         )
                                                      
                                                   
                                                
                                             
                                             log
                                             (
                                             opt
                                             )
                                          
                                       
                                    
                                    -
                                    
                                       
                                          
                                             
                                                
                                                
                                                   1
                                                   +
                                                   
                                                      
                                                         ε
                                                      
                                                      
                                                         (
                                                         e
                                                         -
                                                         1
                                                         )
                                                         (
                                                         T
                                                         +
                                                         1
                                                         )
                                                      
                                                   
                                                
                                             
                                             log
                                             (
                                             LB
                                             )
                                          
                                       
                                    
                                    +
                                    
                                       
                                          
                                             
                                                
                                                   LB
                                                
                                                
                                                   
                                                      
                                                         ε
                                                      
                                                      
                                                         (
                                                         e
                                                         -
                                                         1
                                                         )
                                                         (
                                                         T
                                                         +
                                                         1
                                                         )
                                                      
                                                   
                                                   LB
                                                
                                             
                                          
                                       
                                    
                                    ⩽
                                    
                                       
                                       
                                          1
                                          +
                                          
                                             
                                                ε
                                             
                                             
                                                (
                                                e
                                                -
                                                1
                                                )
                                                (
                                                T
                                                +
                                                1
                                                )
                                             
                                          
                                       
                                    
                                    log
                                    (
                                    opt
                                    )
                                    -
                                    
                                       
                                       
                                          1
                                          +
                                          
                                             
                                                ε
                                             
                                             
                                                (
                                                e
                                                -
                                                1
                                                )
                                                (
                                                T
                                                +
                                                1
                                                )
                                             
                                          
                                       
                                    
                                    log
                                    (
                                    LB
                                    )
                                    +
                                    
                                       
                                          (
                                          e
                                          -
                                          1
                                          )
                                          (
                                          T
                                          +
                                          1
                                          )
                                       
                                       
                                          ε
                                       
                                    
                                    +
                                    3
                                    =
                                    
                                       
                                       
                                          1
                                          +
                                          
                                             
                                                ε
                                             
                                             
                                                (
                                                e
                                                -
                                                1
                                                )
                                                (
                                                T
                                                +
                                                1
                                                )
                                             
                                          
                                       
                                    
                                    log
                                    
                                       
                                          
                                             
                                                
                                                   opt
                                                
                                                
                                                   LB
                                                
                                             
                                          
                                       
                                    
                                    +
                                    
                                       
                                          (
                                          e
                                          -
                                          1
                                          )
                                          (
                                          T
                                          +
                                          1
                                          )
                                       
                                       
                                          ε
                                       
                                    
                                    +
                                    3
                                    ,
                                 
                              
                           so there are 
                              
                                 O
                                 
                                    
                                       
                                          
                                             
                                                T
                                                max
                                                {
                                                ln
                                                
                                                   
                                                      
                                                         
                                                            
                                                               opt
                                                            
                                                            
                                                               LB
                                                            
                                                         
                                                      
                                                   
                                                
                                                ,
                                                1
                                                }
                                             
                                             
                                                ε
                                             
                                          
                                          +
                                          
                                             
                                                T
                                             
                                             
                                                ε
                                             
                                          
                                       
                                    
                                 
                                 =
                                 O
                                 
                                    
                                       
                                          
                                             
                                                T
                                                max
                                                {
                                                ln
                                                
                                                   
                                                      
                                                         
                                                            
                                                               opt
                                                            
                                                            
                                                               LB
                                                            
                                                         
                                                      
                                                   
                                                
                                                ,
                                                1
                                                }
                                             
                                             
                                                ε
                                             
                                          
                                       
                                    
                                 
                              
                            values for €, using the same argument as in Section 4.3.

For the double-sourcing block budget 
                              
                                 $
                              
                           , the analysis is similar. We get:
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                
                                                   1
                                                   +
                                                   ε
                                                
                                             
                                             log
                                             (
                                             opt
                                             )
                                          
                                       
                                    
                                    -
                                    
                                       
                                          
                                             
                                                
                                                
                                                   1
                                                   +
                                                   ε
                                                
                                             
                                             log
                                             (
                                             LB
                                             )
                                          
                                       
                                    
                                    +
                                    
                                       
                                          
                                             
                                                
                                                   LB
                                                
                                                
                                                   ε
                                                   ·
                                                   LB
                                                
                                             
                                          
                                       
                                    
                                    ⩽
                                    
                                       
                                       
                                          1
                                          +
                                          ε
                                       
                                    
                                    log
                                    (
                                    opt
                                    )
                                    -
                                    
                                       
                                       
                                          1
                                          +
                                          ε
                                       
                                    
                                    log
                                    (
                                    LB
                                    )
                                    +
                                    
                                       
                                          1
                                       
                                       
                                          ε
                                       
                                    
                                    +
                                    3
                                    =
                                    
                                       
                                       
                                          1
                                          +
                                          ε
                                       
                                    
                                    log
                                    
                                       
                                          
                                             
                                                
                                                   opt
                                                
                                                
                                                   LB
                                                
                                             
                                          
                                       
                                    
                                    +
                                    
                                       
                                          1
                                       
                                       
                                          ε
                                       
                                    
                                    +
                                    3
                                    ,
                                 
                              
                           so there are 
                              
                                 O
                                 
                                    
                                       
                                          
                                             
                                                max
                                                {
                                                ln
                                                
                                                   
                                                      
                                                         
                                                            
                                                               opt
                                                            
                                                            
                                                               LB
                                                            
                                                         
                                                      
                                                   
                                                
                                                ,
                                                1
                                                }
                                             
                                             
                                                ε
                                             
                                          
                                          +
                                          
                                             
                                                1
                                             
                                             
                                                ε
                                             
                                          
                                       
                                    
                                 
                                 =
                                 O
                                 
                                    
                                       
                                          
                                             
                                                max
                                                {
                                                ln
                                                
                                                   
                                                      
                                                         
                                                            
                                                               opt
                                                            
                                                            
                                                               LB
                                                            
                                                         
                                                      
                                                   
                                                
                                                ,
                                                1
                                                }
                                             
                                             
                                                ε
                                             
                                          
                                       
                                    
                                 
                              
                            values for $, using the same argument as in Section 4.4.

This gives the following running times:
                              
                                 •
                                 
                                    
                                       
                                          O
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               T
                                                            
                                                            
                                                               3
                                                            
                                                         
                                                         max
                                                         
                                                            
                                                               
                                                                  ln
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 opt
                                                                              
                                                                              
                                                                                 LB
                                                                              
                                                                           
                                                                        
                                                                     
                                                                  
                                                                  ,
                                                                  1
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         ε
                                                      
                                                   
                                                
                                             
                                          
                                       
                                     for the FPTAS for co-behaving costs and emissions plus the running time of the algorithm that provides the lower bound. The Lagrangian heuristic from Section 4.1 that we use, for instance, has a running time of 
                                       
                                          O
                                          (
                                          
                                             
                                                T
                                             
                                             
                                                4
                                             
                                          
                                          )
                                       
                                    , giving a total running time of 
                                       
                                          O
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               T
                                                            
                                                            
                                                               3
                                                            
                                                         
                                                         max
                                                         
                                                            
                                                               
                                                                  ln
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 opt
                                                                              
                                                                              
                                                                                 LB
                                                                              
                                                                           
                                                                        
                                                                     
                                                                  
                                                                  ,
                                                                  1
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         ε
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         T
                                                      
                                                      
                                                         4
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    . This can be reduced to 
                                       
                                          O
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               T
                                                            
                                                            
                                                               3
                                                            
                                                         
                                                         max
                                                         
                                                            
                                                               
                                                                  ln
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 opt
                                                                              
                                                                              
                                                                                 LB
                                                                              
                                                                           
                                                                        
                                                                     
                                                                  
                                                                  ,
                                                                  1
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         ε
                                                      
                                                   
                                                
                                             
                                          
                                       
                                     for fixed-plus-linear costs and emissions if an 
                                       
                                          O
                                          (
                                          
                                             
                                                (
                                                T
                                                ln
                                                T
                                                )
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                     implementation of the heuristic is used, i.e., one that is based on an 
                                       
                                          O
                                          (
                                          T
                                          ln
                                          T
                                          )
                                       
                                     algorithm for the classic lot-sizing problem, such as Wagelmans, Van Hoesel, and Kolen (1992).


                                    
                                       
                                          O
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               T
                                                            
                                                            
                                                               3
                                                            
                                                         
                                                         max
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        ln
                                                                     
                                                                     
                                                                        2
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 opt
                                                                              
                                                                              
                                                                                 LB
                                                                              
                                                                           
                                                                        
                                                                     
                                                                  
                                                                  ,
                                                                  1
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               ε
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                     for the FPTAS for general costs; again plus the running time of the algorithm that provides the lower bound.

It follows that the FPTAS for co-behaving costs and emissions needs 
                              
                                 O
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      T
                                                   
                                                   
                                                      2
                                                   
                                                
                                                max
                                                
                                                   
                                                      
                                                         ln
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        opt
                                                                     
                                                                     
                                                                        LB
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                         ,
                                                         1
                                                      
                                                   
                                                
                                             
                                             
                                                ε
                                             
                                          
                                       
                                    
                                 
                              
                            memory and the general FPTAS needs 
                              
                                 O
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      T
                                                   
                                                   
                                                      3
                                                   
                                                
                                                max
                                                
                                                   
                                                      
                                                         ln
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        opt
                                                                     
                                                                     
                                                                        LB
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                         ,
                                                         1
                                                      
                                                   
                                                
                                             
                                             
                                                ε
                                             
                                          
                                       
                                    
                                 
                              
                            memory.

The FPTASes that we developed have some nice theoretical properties regarding their running times and approximation qualities. However, we are also interested in their practical performance. Moreover, we would like to know how well the Lagrangian heuristic performs on a large number of test instances. Therefore, we have randomly generated 1800 problem instances. These instances are solved with all of the algorithms presented in this paper. More specifically, these are:
                           
                              •
                              the Lagrangian heuristic (‘Megiddo’) from Section 4.1;

the pseudo-polynomial algorithm for co-behaving costs and emissions (PP-CB) from Section 4.2, if the instance satisfies the conditions for co-behaviour in Theorem 3;

the FPTAS for co-behaving costs and emissions (FPTAS-CB) from Section 4.3, again only if the instance is co-behaving indeed;

the FPTAS for co-behaving costs and emissions that uses the lower bound generated by Megiddo (FPTAS-CB-LB), again only if the instance is co-behaving;

the general FPTAS (FPTAS-gen);

the general FPTAS that uses the Megiddo lower bound (FPTAS-gen-LB);

for comparison purposes, we included the cplex 12.4 solver. We used this solver on the ‘natural’ formulation, as defined in Eqs. (6)–(12), as well as on the shortest path reformulation. The shortest path reformulation, as introduced by Eppen and Martin (1987), is known to have a better linear programming relaxation.

For each of the FPTASes, three values of 
                           
                              ε
                           
                         were used: 0.10, 0.05 and 0.01. The FPTASes that use Megiddo’s lower bound (FPTAS-CB-LB and FPTAS-gen-LB) were executed even when the feasible solution found by Megiddo was within 
                           
                              (
                              1
                              +
                              ε
                              )
                           
                         from the lower bound. This was done in order to reduce the a posteriori gap, even though it was not strictly necessary.

The values of the problem parameters were chosen in the following way. Although the algorithms are suitable for more general concave functions, all cost and emissions functions were assumed to have a fixed-plus-linear structure. This is a common cost structure in the literature. Moreover, it allowed us to also solve the instances with ibm ilog cplex, so that we can compare our algorithms’ solutions with the optimal solution.

The time horizons that we considered were 25, 50 and 100 periods. Horizons as long as 100 period were considered, because the number of time periods in our model (T) may correspond to 
                           
                              m
                              ·
                              
                                 
                                    T
                                 
                                 
                                    ′
                                 
                              
                           
                         for instances with m production modes and 
                           
                              
                                 
                                    T
                                 
                                 
                                    ′
                                 
                              
                           
                         periods.

First, we generated instances that satisfy the co-behaviour conditions in Theorem 3. Demand was generated from a discrete uniform distribution with minimum 0 and maximum 200 (and thus mean 100). Both the set-up costs and emissions were drawn from three different discrete uniform distributions: DU(500, 1500), DU(2500, 7500) and DU(5000, 15,000) (with means 1000, 5000 and 10,000). 
                           
                              
                                 
                                    p
                                 
                                 
                                    t
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          p
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    t
                                 
                              
                              ,
                              
                                 
                                    h
                                 
                                 
                                    t
                                 
                              
                           
                         and 
                           
                              
                                 
                                    
                                       
                                          h
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    t
                                 
                              
                           
                         were all generated from DU(0, 20), but we only kept those 
                           
                              (
                              p
                              ,
                              
                                 
                                    p
                                 
                                 
                                    ˆ
                                 
                              
                              ,
                              h
                              ,
                              
                                 
                                    h
                                 
                                 
                                    ˆ
                                 
                              
                              )
                           
                         that satisfy the conditions in Theorem 3.

The second group of instances was generated from the same distributions, with the same parameters, but we only kept those 
                           
                              (
                              p
                              ,
                              
                                 
                                    p
                                 
                                 
                                    ˆ
                                 
                              
                              ,
                              h
                              ,
                              
                                 
                                    h
                                 
                                 
                                    ˆ
                                 
                              
                              )
                           
                         such that exactly 
                           
                              
                                 
                                    
                                       
                                          
                                             1
                                          
                                          
                                             2
                                          
                                       
                                       T
                                    
                                 
                              
                           
                         period pairs 
                           
                              (
                              t
                              ,
                              s
                              )
                           
                         are eligible for double-sourcing. That is, for 
                           
                              
                                 
                                    
                                       
                                          
                                             1
                                          
                                          
                                             2
                                          
                                       
                                       T
                                    
                                 
                              
                           
                         pairs the conditions in Theorem 3 were violated.

The third group of instances was different from the other data sets in the sense that periods always occurred in (consecutive) pairs, where the even periods have low production and set-up costs and high production and set-up emissions, and the odd periods have high costs and low emissions. To be precise, 
                           
                              
                                 
                                    p
                                 
                                 
                                    t
                                 
                              
                           
                         was drawn from DU(0, 9) for t even and from DU(11, 20) for t odd; 
                           
                              
                                 
                                    
                                       
                                          p
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    t
                                 
                              
                           
                         was drawn from DU(11, 20) for t even and from DU(0, 9) for t odd. The low set-up costs and emissions, 
                           
                              
                                 
                                    K
                                 
                                 
                                    t
                                 
                              
                           
                         and 
                           
                              
                                 
                                    
                                       
                                          K
                                       
                                       
                                          ^
                                       
                                    
                                 
                                 
                                    s
                                 
                              
                           
                        , for t even and s odd, were drawn from DU(500, 1500). The high set-up costs and emissions, for t odd and s even, were both drawn from DU(2500, 7500) and DU(5000, 10,000) . The holding costs and emissions between two periods within one pair were always zero. Between two pairs, they were drawn from DU(0, 20). Demand was zero in the first period of a pair, and in the second period generated from DU(0, 200). The numbers of periods we considered are 26, 50 and 100. Generating the data in this way corresponds to a problem with 
                           
                              
                                 
                                    1
                                 
                                 
                                    2
                                 
                              
                              T
                           
                         periods, but with two production modes, ‘cheap & dirty’ and ‘expensive & clean’. These instances show similarities with the instance that was used in the 
                           
                              NP
                           
                        -hardness proof (Theorem 1), so we expect that they are difficult to solve.

Ten instances were generated for every combination of the parameter settings that were described above, giving 600 data sets. Every instance thus generated was combined with three different values of the emission capacity. We let 
                           
                              
                                 
                                    C
                                 
                                 
                                    ^
                                 
                              
                              =
                              [
                              β
                              
                                 
                                    
                                       
                                          C
                                       
                                       
                                          ^
                                       
                                    
                                 
                                 
                                    min
                                 
                              
                              +
                              (
                              1
                              -
                              β
                              )
                              
                                 
                                    
                                       
                                          C
                                       
                                       
                                          ^
                                       
                                    
                                 
                                 
                                    max
                                 
                              
                              ]
                           
                        , where 
                           
                              β
                              =
                              0.25
                              ,
                              0.5
                              ,
                              0.75
                           
                        , 
                           
                              
                                 
                                    
                                       
                                          C
                                       
                                       
                                          ^
                                       
                                    
                                 
                                 
                                    min
                                 
                              
                           
                         is the level of emissions when emissions are minimised, ignoring costs, and 
                           
                              
                                 
                                    
                                       
                                          C
                                       
                                       
                                          ^
                                       
                                    
                                 
                                 
                                    max
                                 
                              
                           
                         is the level of emissions when costs are minimised, ignoring emissions. In total, this gave 
                           
                              600
                              ·
                              3
                              =
                              1800
                           
                         instances.

All algorithms were implemented in a Java program that was used to solve all instances on a Windows 7-based PC with an Intel Xeon X5667 processor (
                           
                              4
                              ×
                              3.06
                           
                         GHz) and 12GB RAM.

@&#RESULTS@&#

A summary of the results of the computational tests can be found in Table 1
                        . Tables D.2–D.8 in Appendix D.1 give more detailed results, for different values of the average set-up costs and emissions, or emission capacity. Four characteristics are given for each algorithm:
                           
                              •
                              the average solution time of the algorithm, where the computation time of Megiddo was included in the times of the FPTASes that used this lower bound;

the average a posteriori gap, the percentage difference between the algorithm’s solution and the lower bound that the algorithm found;

the average true gap, the percentage difference between the algorithm’s solution and the optimal value that was found by ibm ilog cplex (and PP-CB);

the percentage of instances for which the algorithm’s solution value was exactly equal to the optimal value.

Below, we discuss the most important findings.

The columns marked ‘co-bhv.’ in Table 1 give the results for the co-behaving instances, which satisfy the conditions in Theorem 3. More detailed results can be found in Tables D.2, D.3 and D.4 in Appendix D.1. We see that the heuristic (Megiddo) finds solutions that are very close to the optimum. For a horizon of 25 periods, it even finds the optimum itself in over 60% of the cases, and the true gap is less than a half percent on average; its a posteriori gap is 1.6% on average. It is remarkable to see that if the horizon becomes longer (50 or 100 periods), these gaps become even smaller.

The set-up emissions (
                           
                              
                                 
                                    K
                                 
                                 
                                    ^
                                 
                              
                           
                        ) and emission capacity (
                           
                              
                                 
                                    C
                                 
                                 
                                    ^
                                 
                              
                           
                        ) do not appear to have a big influence on the results, for any of our algorithms. For lower set-up costs (K), Megiddo’s gaps are smaller.

The FPTASes for co-behaving costs and emissions (FPTAS-CB) give solutions that are well within the specified precision in a very short amount of time. The average computation times of FPTAS-CB-LB range from 0.25 s, for 100 periods and 
                           
                              ε
                              =
                              0.01
                           
                        , down to only 1ms for 25 periods and 
                           
                              ε
                              =
                              0.1
                           
                         or 
                           
                              ε
                              =
                              0.05
                           
                        . FPTAS-CB-LB with 
                           
                              ε
                              =
                              0.05
                           
                         or 
                           
                              ε
                              =
                              0.1
                           
                         is faster than ibm ilog cplex, even on the shortest path formulation. For 25 and 50 periods, this also holds when 
                           
                              ε
                           
                         is 0.01. Of course, this comes at the expense of 
                           
                              ε
                           
                        -optimal solutions instead of the optimal solutions that were generated by ibm ilog cplex. Nonetheless, even when 
                           
                              ε
                              =
                              0.1
                           
                        , the optimum is found in over two-thirds of the instances, and the average true gaps are below 0.025%. For 
                           
                              ε
                              =
                              0.01
                           
                        , these are even below 0.001%.

Comparing the FPTAS-CBs with the general FPTASes, we see that the general FPTASes have a higher computation time, as could be expected. However, the increase appears to be less than of order 
                           
                              
                                 
                                    T
                                    ln
                                    (
                                    opt
                                    )
                                 
                                 
                                    ε
                                 
                              
                           
                        , which is what would be expected from the difference in time complexities (see Sections 4.3 and 4.4). This is because our implementation of the FPTAS-gen checks whether double-sourcing ‘makes sense’, and, because these data sets satisfy the conditions in Theorem 3, this is never the case. The solutions of FPTAS-gen are even better than those of FPTAS-CB, because a smaller epsilon 
                           
                              
                                 
                                    
                                       ε
                                       =
                                       
                                          
                                             1
                                             +
                                             δ
                                          
                                       
                                       -
                                       1
                                    
                                 
                              
                           
                         is used, which is unnecessary, because for co-behaving data, the solution never has double-sourcing.

The FPTASes that use the lower bound have a much lower computation time than the ones that do not, so using the lower bound really makes a difference. The reduction in computation time varies from about seven times faster than the (already fast) FPTAS-gen(0.1) for 
                           
                              T
                              =
                              25
                           
                        , up to over thirteen times faster than FPTAS-gen(0.01) for 
                           
                              T
                              =
                              25
                           
                         (0.013 vs. 0.18 s). The solutions of the FPTASes without lower bound have even smaller true gaps than those found by the FPTASes with lower bounds, since not using the lower bound results in using smaller intervals than necessary. The a posteriori gaps found by the FPTASes without lower bounds are larger than those found by the FPTASes with lower bounds, because the latter can compute the gap with respect to two lower bounds, 
                           
                              
                                 
                                    Δ
                                 
                                 
                                    k
                                    -
                                    T
                                    -
                                    1
                                 
                              
                           
                         (see Section 4.3) and the heuristic’s lower bound. Of course, the higher of the two is used. The a posteriori gaps of FPTAS-CB (without lower bound) are about two thirds less than is required by 
                           
                              ε
                           
                        , and those of FPTAS-gen are about one third less (e.g., an a posteriori gap of 0.67% when 
                           
                              ε
                              =
                              0.01
                           
                        ). Table 1 in this section, as well as Tables D.2–D.8 in Appendix D.1, all give the results that were obtained with the ‘roundmore’ function (see pages 16 and 21). We can compare these with the a posteriori gaps that were obtained by the algorithms that do not use this improved lower bound, as can be found in Tables D.9–D.15 in Appendix D.2. We see that in the latter case the a posteriori gaps of FPTAS-CB (without lower bound) are half of what is required by 
                           
                              ε
                           
                        , and those of FPTAS-gen are only one quarter less than required by 
                           
                              ε
                           
                         (e.g., an a posteriori gap of 0.75% when 
                           
                              ε
                              =
                              0.01
                           
                        ).

The pseudo-polynomial algorithm (PP-CB) is still reasonably fast, but not as fast as the FPTAS-CBs. Moreover, its computation times increase as the set-up costs increase, since this means that the optimal value increases as well, and its time complexity is dependent on this optimal value (see Section 4.2).


                        Ibm ilog cplex applied to the natural formulation is very sensitive to the size of the set-up costs. Only for smaller set-up costs, it is sometimes slightly faster than the shortest path formulation. Moreover, for 100 periods, we were very often not able to solve the instances at all, because of memory issues. The results for cplex-nat are therefore not included for 
                           
                              T
                              =
                              100
                           
                        , except for the instances with two modes. Cplex-nat performs relatively better on the instances with two modes, because the other instances can have higher set-up costs (see Section 5.1) and it is exactly for these high set-up costs that the computation time of cplex-nat is highest.

The results for the instances with 
                           
                              
                                 
                                    
                                       
                                          
                                             1
                                          
                                          
                                             2
                                          
                                       
                                       T
                                    
                                 
                              
                           
                         pairs that violate the co-behaviour property are shown in the columns marked ‘gen.’ in Table 1. More details can be found in Tables D.5–D.7 in Appendix D.1. In general, we see the same patterns as for the co-behaving instances.

Megiddo still gives good solutions in the same amount of time, although the solutions are not as good as in the co-behaving case. This is because the heuristic can only find solutions that satisfy the single-sourcing property, whereas these non-co-behaving instances can have an optimal solution with a double-sourcing block (see Theorem 6). Still, the average true gap is 1.2% for 25 periods, down to less than a half percent for 100 periods.

The results for the FPTASes are similar to what we have seen before, but the computation times have increased compared to the co-behaving case, because now, we also need to iterate over the double-sourcing block budgets $ (see Section 4.4) in the 
                           
                              
                                 
                                    
                                       
                                          
                                             1
                                          
                                          
                                             2
                                          
                                       
                                       T
                                    
                                 
                              
                           
                         period-pairs in which double-sourcing might be optimal. However, the solution times of FPTAS-gen-LB(0.1) are still shorter than cplex-SP. Moreover, the true gaps are still very close to zero for all FPTASes.

The columns marked ‘2 modes’ in Table 1 give the results for the instances that can be interpreted as having two production modes (cheap & dirty and expensive & clean). More details can be found in Table D.8 in Appendix D.1. Roughly the same patterns as before are shown. However, the gaps of the heuristic, and the computation times of the FPTASes are again larger. Of course, this comes as no surprise, because we specially designed these problem instances to be the hardest to solve for our algorithms. The highest average solution time is obtained by FPTAS-gen with 
                           
                              ε
                              =
                              0.01
                           
                        : less than seven minutes for 
                           
                              T
                              =
                              100
                           
                        . On the other hand, if the heuristic’s lower bound is used in the FPTAS, the average computation times are below 17 s, even for 
                           
                              ε
                              =
                              0.01
                           
                         and 
                           
                              T
                              =
                              100
                           
                        . If we take a higher epsilon (
                           
                              ε
                              =
                              0.1
                           
                        ), then the average solution time goes down to 0.47 s, while still obtaining solutions with an average true gap below 0.1%. Unfortunately, this is slightly slower than cplex-SP. However, for 
                           
                              T
                              =
                              25
                           
                         or 
                           
                              T
                              =
                              50
                           
                        , FPTAS-gen-LB(0.01) is faster than cplex-SP. Moreover, where cplex requires the cost and emission functions to fit in a linear model, our algorithms are able to handle more general concave cost and emission functions.

In this paper, we have considered a lot-sizing problem with a global emission constraint. Here, the emissions take the form of a second type of ‘costs’ on production, set-up and inventory decisions. Of course, these second costs can be any type of costs other than those in the objective function. We have shown that this problem is 
                        
                           NP
                        
                     -hard (in the weak sense) even if only production emits pollutants (linearly). From the 
                        
                           NP
                        
                     -hardness proof, we learned that our model also entails lot-sizing with emissions and multiple production modes. We have presented a Lagrangian heuristic (Megiddo), FPTASes and a pseudo-polynomial algorithm to solve the problem, and subjected these algorithms to a large number of computational tests. This has shown that Megiddo gives near-optimal solutions, and we recommend using its lower bound as input for the FPTASes. Moreover, we have seen that instances are easier to solve if the costs and emissions satisfy a co-behaviour property (see Theorem 3). This is also reflected by the time complexity of the FPTASes; for the co-behaving case, this is 
                        
                           O
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                T
                                             
                                             
                                                3
                                             
                                          
                                          max
                                          {
                                          ln
                                          (
                                          opt
                                          /
                                          LB
                                          )
                                          ,
                                          1
                                          }
                                       
                                       
                                          ε
                                       
                                    
                                 
                              
                           
                        
                     , whereas in the general case, it is 
                        
                           O
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                T
                                             
                                             
                                                3
                                             
                                          
                                          max
                                          {
                                          
                                             
                                                ln
                                             
                                             
                                                2
                                             
                                          
                                          (
                                          opt
                                          /
                                          LB
                                          )
                                          ,
                                          1
                                          }
                                       
                                       
                                          
                                             
                                                ε
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     . We have seen that, in practise, the FPTASes have a much smaller gap than the a priori imposed performance. The FPTASes that use Megiddo’s lower bound (FPTAS-CB-LB and FPTAS-gen-LB) are very fast, even compared to a standard solver such as ibm ilog cplex. In case the costs and emissions are co-behaving, they are even faster. We have seen that the instances that are the hardest to solve, are constructed in such a way that the degree of non-co-behaviour is very high. Instances with two production modes are the hardest in this regard. However, recall that our algorithms are able to solve instances with more general concave cost and emission functions.

Because we have carried out a large number of computational tests, special attention was paid to an efficient implementation of the FPTASes. We developed an improved rounding technique to reduce the a posteriori gap, and combined an FPTAS in the style of Woeginger (2000) with a lower bound, which turned out to lead to very good results. We expect that these techniques can be applied to more FPTASes of this type.

We think that it may be worthwhile to develop a Lagrangian heuristic for fixed-plus-linear costs and emissions, following Megiddo’s approach, based on an 
                        
                           O
                           (
                           T
                           ln
                           T
                           )
                        
                      algorithm for the classic lot-sizing problem, such as Wagelmans et al. (1992). Furthermore, we expect that the technique to construct a pseudo-polynomial algorithm and an FPTAS can be applied to more problems where one capacity constraint (on a ‘second objective function’) is added to a problem for which a polynomial time dynamic program exists. In our opinion, another interesting line of future research into lot-sizing with emission constraints involves extending the lot-sizing model to a production–distribution system with emissions. Another extension would be to incorporate a cap-and-trade mechanism like Hua et al. (2011) do in an EOQ setting.

@&#ACKNOWLEDGEMENTS@&#

Mathijn Retel Helmrich’s and Wilco van den Heuvel’s research was supported by the Netherlands Organisation for Scientific Research (NWO). Mathijn Retel Helmrich carried out the research for this article while he was a Ph.D. candidate at the Econometric Institute at Erasmus University Rotterdam.

Supplementary data associated with this article can be found, in the online version, at http://dx.doi.org/10.1016/j.ejor.2014.06.030.


                     
                        
                           
                        
                     
                  

@&#REFERENCES@&#

