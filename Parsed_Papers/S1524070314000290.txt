@&#MAIN-TITLE@&#Globally consistent rigid registration

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We propose a globally consistent method to deal with the loop closure problem.


                        
                        
                           
                           Parametric correspondence is introduced to enhance the accuracy.


                        
                        
                           
                           Transformations and correspondences are optimized simultaneously.


                        
                        
                           
                           Complicated sub-loops can be closed automatically.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Multiview registration

Consistent formulation

Loop closure problem

@&#ABSTRACT@&#


               
               
                  In this paper we present a novel approach to register multiple scans from a static object. We formulate the registration problem as an optimization of the maps from all other scans to one reference scan where any map between two scans can be represented by the composition of these maps. In this way, all loop closures can be automatically guaranteed as the maps among all scans are globally consistent. Furthermore, to avoid the incorrect correspondences between the points in the scan, we employ a parametric bi-directional approach that generates invertible transformations in pairwise overlapping regions. With the parameter information in use and the consistency taken into consideration, we are able to eliminate the drift that often occurred in multi-view registration process. Our approach is fully automatic and has performed better than existing approaches by various experimental results.
               
            

@&#INTRODUCTION@&#

Creating 3D models of real world objects using scanning techniques is an attractive task with a wide range of applications in computer graphics, geometry processing, and reverse engineering. Typically, multiple data sets are captured from different viewpoints and these sets have to be registered to obtain a complete acquired object. Hence surface registration procedure is essential for the reconstruction task, especially in systems allowing scanner to move freely to avoid the occlusions [1].

However, even registering two scanning sets from a static object, called rigid registration, is a challenging problem [1]. First, only subsets of the input scans overlap and their correspondence errors may lead to significant degradation in the result. Second, variations in the scans such as resolutions of data can affect the algorithm.

Registering multi-view scans is a more difficult problem [2]. Generally, sequential registration of two overlapping views is performed at a time. Then an integration step is adopted to ensure all views are combined. However, it leads to the well-known loop closure problem [3,4], where the registration errors accumulate and propagate, leading to visible misalignment at the scanning borders. To overcome this problem, global registration algorithms are proposed from a global point of view [5–8]. These methods address the problem of loop closure either by distributing the transformation errors into the other scans or by distributing the accumulated errors over the other scans via distorting them which jeopardizes the rigidity of the scanned object. There are two problems in these methods. First, identifying loop closure is a nontrivial task and incorrect loop closure detections can significantly break the consistency of the data [9]. Second, when a scan locates on multiple loops, it is not easy to distribute the accumulated errors in different loops over this scan.

In this paper, we propose a novel approach for global rigid registration of multi-view scan datasets. The registration between two scans is considered as a rigid transformation from one to the other. Choosing one scan as a reference scan, we regard all rigid transformations from the other scans to the reference, called basic transformations, as variables. Thus the rigid transformation between arbitrary two scans can be represented by the composite of these basic transformations. We formulate the registration as a global optimization on minimizing all registration errors among all overlapped scans. Thus all loop closures are implicitly guaranteed because the composite of all transformations from the sequential scans in any loop are automatically equal to identity. Therefore, our approach does not need to explicitly detect the loop closures.

Furthermore, the traditional point to point correspondences between overlapped scans are not suitable in our optimization. Instead, we consider the correspondences from points in one scan to the other scan as parameter variables. Thus our approach allows correspondences from points in one scan to the optimal positions in the other scan, which alleviates the drift problem caused by inconsistent variable settings and point to point correspondences in the registration.

The contributions of our approach for globally consistent rigid registration are summarized in the following:
                        
                           •
                           A global formulation is developed to resolve the globally consistent rigid registration problem.

Our approach guarantees all loop closures implicitly in a globally consistent manner.

The alignments among the scans may be more precise than previous methods as the points in one scan can correspond to their optimal positions in other scans.

@&#RELATED WORK@&#

For the task of constructing complete 3D models, both the pairwise and multiple view registration method is needed, since the overlapping information has to be gathered locally from successive scans while additional cares has to be taken globally to avoid the drift problem. Bernardini and Rushmeier [10] provides a comprehensive overview on the methods needed in this task, including commonly used pairwise and multiple view methods. Commonly used registration methods for range images are discussed by Salvi et al. [11] and Curless [12]. Kaick et al. [13] covers rigid registration from another viewing angle. The most popular pairwise method ICP and many of its variants are surveyed by Rusinkiewicz and Levoy [14]. Castellani and Bartoli [15] also discusses the ICP method and some of its extensions. An analysis on the convergence of different ICP algorithms is presented by Pottmann et al. [16]. Though we only deal with the rigid case, non-rigid alignment is sometimes also necessary in model construction for the calibration error of scanner parameters [17].

ICP is a typical pairwise method for aligning two point clouds [18,5]. Distinguished by the alignment metric they approximate, ICP approaches are mainly classified into two categories: the point-to-point approach and the point-to-plane approach [5]. Comparing with the slow convergence of point-to-point strategy, the point-to-plane formulation generates better performance due to a first-order approximation of the target surface by the tangent plane [2]. Note that higher order approximation can be achieved with our parameter based algorithm.

Many variants of the ICP class methods modify the standard algorithm on the selection, matching, weighting and rejecting of point pairs, and also the error metric and minimizing procedure used [14]. Non-linear optimization methods are also proposed by Gruen and Akca [19] and Fitzgibbon [20]. Practical experience illustrates that the appropriate point pair identification is the most important matter. Indeed, all the algorithms are going to perform well if proper pairs of correspondences are given right in the overlapping region. In the choosing of point pairs, rejecting point pairs that are too far apart, on the boundary and further than a given threshold are commonly used. Rejection of distance larger than some multiples of standard deviation of point distance [21] or inconsistency with neighboring pairs [22] is also practical for certain cases.

However, the case of different sample rates is usually difficult to handle. Though point-to-plane ICP displays a better performance, it’s still not a thorough solution since the change of distance metric does not help with the estimation of correspondences. Sample rate is an important issue. With the progress of the scanning technique, many new kind of devices are invented. The demand for registration of these naturally different data sources is increasing due to various applications and cooperations. We will show that the sample rate issue can be reasonably treated by our parametric based algorithm.

Another class is known as the voting methods [23–25]. Transforms between triplet of points in the source and target shape are computed and recorded as votes. The optimal alignment is chosen as the one got the most votes. Gelfand et al. [26] also propose a descriptor based method to register scans from arbitrary initial position.

The registration of multiple views is a more difficult problem. Direct application of pairwise methods always leads to the loop closure issue [2]. A global point of view is thus required to solve this problem. Generally the accumulated error is distributed over all scans in the loops [27–30]. An incremental approach is proposed by Chen and Medioni [5]. They register the first two views into a metaview, and remaining scans are incrementally merged into this metaview. Pulli [2] presented another incremental algorithm that minimizes the relative moving of neighboring scans under the assumption of a perfect pairwise initialization. An incrementally surface building method is also presented by Jin et al. [7], in which new scans can be registered to the surface model and reregister is allowed for already registered scans. Huber and Hebert [31] introduced a fully automatic method that allows for arbitrary initial states of data sets. A surface matching engine is used in the pairwise stage and a graph is constructed for the multi-view phase, which counts for the filtering of incorrect matches as well. Torsello et al. [32] also used a graph to diffuse transformations over adjacent views. Some approaches formulate the problem as an optimization on a manifold [33] or as an EM algorithm [34]. Other methods consider it as an analogy of the mechanical system [35,36].

Correspondence is an important issue in both registration and shape analysis. Parameterizing the mapping and optimizing the correspondences as variables, rather than a direct searching, may lead to more reasonable results as in Li et al. [37], where the parametric correspondences are used in pairwise non-rigid alignment. Differently, we focus on the loop closure problem on multiple view rigid registration. Parametrization of the mapping are also used by Kim et al. [38] for the evaluation of fuzzy correspondences. In shape correspondence problems, the optimization considering the entire population of shape instances are often used in global methods [39,40], which can produce more accurate results over pairwise methods. Similar strategy also appears in image processing. A joint optimization of functionals between images to ensure cycle-consistency is proposed by Wang et al. [41] for image co-segmentation. In our formulation, a global consistent optimization framework is used while a bi-directional parameter based pairwise correspondence is applied to enhance the accuracy of the registration result.

Our method solves the loop closure problem in an implicit way without identifying any loop closures. Furthermore, unlike previous methods which deform the scans to compensate the accumulate error in the loops, our method does not deform any scan in the registration which can preserve the rigidity of all scans well.

In constructing a complete 3D model, the global registration of multiple scans is mandatory. Pairwise methods may fail to get satisfactory results due to the accumulation of local deviations. However, it is inevitable to deal with the problem since the global structure of the whole model is eventually encoded in the pairwise overlapping regions. Researchers aim to find reasonable methods that effectively diffuse these local errors.

We observed that a serious inconsistent issue exists in the registration of loops. By taking the consistency into consideration, the accumulation of local deviations can be avoided by a proper formulation. Optimization of this formulation will automatically diffuse the errors and finally result in globally consistent registration.

The pairwise registration problem can be well solved by the ICP algorithm and its variants. However, problem arises when more scan views are added into the registration sequence. Consider the registration of 
                           
                              n
                              +
                              1
                           
                         surfaces 
                           
                              
                                 
                                    {
                                    
                                       
                                          S
                                       
                                       
                                          t
                                       
                                    
                                    }
                                 
                                 
                                    t
                                    =
                                    0
                                 
                                 
                                    n
                                 
                              
                           
                         which forms a loop. Denote 
                           
                              
                                 
                                    ψ
                                 
                                 
                                    t
                                 
                              
                           
                         the rigid transformation from 
                           
                              
                                 
                                    S
                                 
                                 
                                    t
                                 
                              
                           
                         to 
                           
                              
                                 
                                    S
                                 
                                 
                                    t
                                    +
                                    1
                                 
                              
                           
                        , i.e.,
                           
                              (1)
                              
                                 
                                    
                                       ψ
                                    
                                    
                                       t
                                    
                                 
                                 :
                                 
                                    
                                       S
                                    
                                    
                                       t
                                    
                                 
                                 →
                                 
                                    
                                       S
                                    
                                    
                                       t
                                       +
                                       1
                                    
                                 
                                 ,
                                 
                                 t
                                 =
                                 0
                                 ,
                                 1
                                 ,
                                 …
                                 ,
                                 n
                              
                           
                        with 
                           
                              
                                 
                                    S
                                 
                                 
                                    n
                                    +
                                    1
                                 
                              
                              =
                              
                                 
                                    S
                                 
                                 
                                    0
                                 
                              
                           
                        . Then intrinsically we ought to have the global constraint of consistency
                           
                              (2)
                              
                                 
                                    
                                       ψ
                                    
                                    
                                       n
                                    
                                 
                                 ∘
                                 
                                    
                                       ψ
                                    
                                    
                                       n
                                       -
                                       1
                                    
                                 
                                 ∘
                                 ⋯
                                 
                                    
                                       ψ
                                    
                                    
                                       1
                                    
                                 
                                 ∘
                                 
                                    
                                       ψ
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 I
                              
                           
                        which, however, cannot be satisfied through a simple aggregation of local pairwise registration.

To fulfill this constraint of consistency, a global approach is required to take all the scans into consideration at once, which can be quite difficult to compute. The difficulty comes from the redundancy and inconsistency that lies in the variable setting of the problem. In the registration of 
                           
                              n
                              +
                              1
                           
                         views mentioned above, we observe that when one scan is fixed, say 
                           
                              
                                 
                                    S
                                 
                                 
                                    0
                                 
                              
                           
                        , only n rigid transformations are indeed needed to accomplish the whole procedure: 
                           
                              
                                 
                                    ϕ
                                 
                                 
                                    t
                                 
                              
                           
                         that aligns 
                           
                              
                                 
                                    S
                                 
                                 
                                    t
                                 
                              
                           
                         to 
                           
                              
                                 
                                    S
                                 
                                 
                                    0
                                 
                              
                              ,
                              
                              t
                              =
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              n
                           
                        , respectively (see Fig. 1
                        ).

Those methods that treat overlapping regions separately cannot avoid the effect of seesaw action. The approach of [42] satisfied the consistent constraint by converting the global overlapping relationship into a star shaped network and matching each scan with all its overlaps. However, each scan 
                           
                              
                                 
                                    S
                                 
                                 
                                    r
                                 
                              
                           
                         is processed separately in the algorithm and the increment updating for the composite transformation of scan 
                           
                              
                                 
                                    S
                                 
                                 
                                    r
                                 
                              
                           
                         and its overlapping view 
                           
                              
                                 
                                    S
                                 
                                 
                                    t
                                 
                              
                           
                         is updated to scan 
                           
                              
                                 
                                    S
                                 
                                 
                                    r
                                 
                              
                           
                         only, thus it may lead to biased results.

When aligning two surfaces together, it would be desired that the resulting transformation is invertible, which means that the inverse transformation is obtained if the source and target surfaces are swapped. Usually without a bi-directional procedure, invertible transformations are not likely to be obtained and this is known as the direction issue. When sub ring is included in the connection due to complicated scanning routine, the network can be difficult to get well balanced. Lack of continuous representations of scans, the sample rate will have an impact too, since the error accumulates along the chain of transformations. Thus simultaneously updating and continuous approximations of all scans are needed to meet all the requirements.

Consider the global registration of a set of surfaces 
                           
                              
                                 
                                    {
                                    
                                       
                                          S
                                       
                                       
                                          t
                                       
                                    
                                    }
                                 
                                 
                                    t
                                    =
                                    0
                                 
                                 
                                    n
                                 
                              
                           
                        . We propose a consistent approach to set the variable system in the multi-view registration. From the analysis above, we know that only n rigid transformations are needed by fixing surface 
                           
                              
                                 
                                    S
                                 
                                 
                                    0
                                 
                              
                           
                        . Denote 
                           
                              
                                 
                                    ϕ
                                 
                                 
                                    t
                                 
                              
                           
                         the rigid transformation that aligns 
                           
                              
                                 
                                    S
                                 
                                 
                                    t
                                 
                              
                           
                         to 
                           
                              
                                 
                                    S
                                 
                                 
                                    0
                                 
                              
                           
                        . Obviously, n transformations are the most compact variables (i.e., unable to describe the system by less variables). And the completeness of this variable system can be illustrated as follows: any of the pairwise registration can be uniquely expressed by 
                           
                              Φ
                              =
                              
                                 
                                    {
                                    
                                       
                                          ϕ
                                       
                                       
                                          t
                                       
                                    
                                    }
                                 
                                 
                                    t
                                    =
                                    1
                                 
                                 
                                    n
                                 
                              
                           
                        . For example, a rigid transformation 
                           
                              
                                 
                                    ϕ
                                 
                                 
                                    r
                                    ,
                                    t
                                 
                              
                           
                         from 
                           
                              
                                 
                                    S
                                 
                                 
                                    r
                                 
                              
                           
                         to 
                           
                              
                                 
                                    S
                                 
                                 
                                    t
                                 
                              
                           
                         can be easily given as
                           
                              (3)
                              
                                 
                                    
                                       ϕ
                                    
                                    
                                       r
                                       ,
                                       t
                                    
                                 
                                 =
                                 
                                    
                                       ϕ
                                    
                                    
                                       t
                                    
                                    
                                       -
                                       1
                                    
                                 
                                 ∘
                                 
                                    
                                       ϕ
                                    
                                    
                                       r
                                    
                                 
                                 .
                              
                           
                        With this variable system setting, the multi-view registration problem can be expressed by all the inner sequence pairwise registration of surfaces that have an overlapping region with each other. Let 
                           
                              
                                 
                                    L
                                 
                                 
                                    (
                                    r
                                    ,
                                    t
                                    )
                                 
                              
                           
                         be the overlapping region of 
                           
                              
                                 
                                    S
                                 
                                 
                                    r
                                 
                              
                           
                         and 
                           
                              
                                 
                                    S
                                 
                                 
                                    t
                                 
                              
                           
                        . Then the consistent multi-view registration can be formulated as
                           
                              (4)
                              
                                 
                                    
                                       
                                          min
                                       
                                       
                                          Φ
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          (
                                          r
                                          ,
                                          t
                                          )
                                          
                                             
                                                |
                                             
                                             
                                                
                                                   
                                                      L
                                                   
                                                   
                                                      (
                                                      r
                                                      ,
                                                      t
                                                      )
                                                   
                                                
                                                ≠
                                                ∅
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          
                                             
                                                p
                                             
                                             
                                                i
                                             
                                             
                                                (
                                                r
                                                ,
                                                t
                                                )
                                             
                                          
                                          ∈
                                          
                                             
                                                S
                                             
                                             
                                                r
                                             
                                          
                                       
                                    
                                 
                                 d
                                 
                                    
                                       (
                                       
                                          
                                             ϕ
                                          
                                          
                                             r
                                             ,
                                             t
                                          
                                       
                                       (
                                       
                                          
                                             p
                                          
                                          
                                             i
                                          
                                          
                                             (
                                             r
                                             ,
                                             t
                                             )
                                          
                                       
                                       )
                                       ,
                                       
                                          
                                             S
                                          
                                          
                                             t
                                          
                                       
                                       )
                                    
                                    
                                       p
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    p
                                 
                                 
                                    i
                                 
                                 
                                    (
                                    r
                                    ,
                                    t
                                    )
                                 
                              
                           
                         is one of the source points in 
                           
                              
                                 
                                    L
                                 
                                 
                                    (
                                    r
                                    ,
                                    t
                                    )
                                 
                              
                           
                        , 
                           
                              d
                              (
                              p
                              ,
                              
                                 
                                    S
                                 
                                 
                                    t
                                 
                              
                              )
                              =
                              
                                 
                                    min
                                 
                                 
                                    q
                                    ∈
                                    
                                       
                                          S
                                       
                                       
                                          t
                                       
                                    
                                 
                              
                              ‖
                              p
                              -
                              q
                              
                                 
                                    ‖
                                 
                                 
                                    2
                                 
                              
                           
                        , 
                           
                              
                                 
                                    ϕ
                                 
                                 
                                    r
                                    ,
                                    t
                                 
                              
                              =
                              
                                 
                                    ϕ
                                 
                                 
                                    t
                                 
                                 
                                    -
                                    1
                                 
                              
                              ∘
                              
                                 
                                    ϕ
                                 
                                 
                                    r
                                 
                              
                           
                        , and 
                           
                              p
                              >
                              0
                           
                        . In our current implementation, we use 
                           
                              p
                              =
                              2
                           
                        . For a specific intention, e.g., excluding outliers in the robust registration, 
                           
                              0
                              <
                              p
                              ⩽
                              1
                           
                         can be adopted and our optimization framework still applies.

Though this may seem complicated, we note that it is essential to take all overlaps into consideration together to reasonably diffuse the local errors. To illustrate the consistency of resulting transformations, we suppose that there is a loop in the scans consisting of 
                           
                              
                                 
                                    S
                                 
                                 
                                    
                                       
                                          t
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                              ,
                              
                                 
                                    S
                                 
                                 
                                    
                                       
                                          t
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    S
                                 
                                 
                                    
                                       
                                          t
                                       
                                       
                                          m
                                       
                                    
                                 
                              
                           
                        . Then the composite transformation walking through the whole loop is
                           
                              (5)
                              
                                 (
                                 
                                    
                                       ϕ
                                    
                                    
                                       
                                          
                                             t
                                          
                                          
                                             1
                                          
                                       
                                    
                                    
                                       -
                                       1
                                    
                                 
                                 ∘
                                 
                                    
                                       ϕ
                                    
                                    
                                       
                                          
                                             t
                                          
                                          
                                             m
                                          
                                       
                                    
                                 
                                 )
                                 ∘
                                 (
                                 
                                    
                                       ϕ
                                    
                                    
                                       
                                          
                                             t
                                          
                                          
                                             m
                                          
                                       
                                    
                                    
                                       -
                                       1
                                    
                                 
                                 ∘
                                 
                                    
                                       ϕ
                                    
                                    
                                       
                                          
                                             t
                                          
                                          
                                             m
                                             -
                                             1
                                          
                                       
                                    
                                 
                                 )
                                 ∘
                                 ⋯
                                 ∘
                                 (
                                 
                                    
                                       ϕ
                                    
                                    
                                       
                                          
                                             t
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       -
                                       1
                                    
                                 
                                 ∘
                                 
                                    
                                       ϕ
                                    
                                    
                                       
                                          
                                             t
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 )
                                 =
                                 I
                              
                           
                        which means that the consistency constraint is automatically met. Since all the transformations are invertible, the consistency holds from any direction of the loop. Indeed the consistency holds for any loop in the scans, and of course we do not have to explicitly identify them beforehand. The formulation itself ensures the consistency for all loops already. The pairwise registration can be regarded as a special case of (4).

Usually a spanning tree can be constructed to find 
                           
                              
                                 
                                    S
                                 
                                 
                                    0
                                 
                              
                           
                        . In our experiment, the results are insensitive to the choice of 
                           
                              
                                 
                                    S
                                 
                                 
                                    0
                                 
                              
                           
                        . After a proper initialization is given, we optimize the transformations as variables rather than recalculate them by compositing relative transformations between adjacent patches. And all of the overlaps are taken into consideration. The choice of 
                           
                              
                                 
                                    S
                                 
                                 
                                    0
                                 
                              
                           
                         may has more influence on the rough align stage where pairwise registration methods are used. In practice, we choose the patch which has the most overlapping patches as 
                           
                              
                                 
                                    S
                                 
                                 
                                    0
                                 
                              
                           
                        .

In the registration of 
                           
                              n
                              +
                              1
                           
                         scans, the optimization problem (4) contains 
                           
                              6
                              n
                           
                         variables of rigid transformations and two sets of correspondences for each overlapping region. It is intuitive to optimize the correspondences together with the transformations by using an L-BFGS solver where the rotations are represented with Euler angles. However, in order to rejecting infeasible point-pairs per iteration, we still apply the classic two-stage approach that estimates the correspondences and then updates the transformations. This alternating strategy slows down the optimization procedure, but also brings in conveniences like the flexibility of rejecting point pairs and the close form solution for the updating of transformations. In the stage of correspondence optimization, we adopt an L-BFGS optimizer provided in [43].

It is apparently a huge task for optimizing all the rigid transformations 
                           
                              Φ
                              =
                              
                                 
                                    {
                                    
                                       
                                          ϕ
                                       
                                       
                                          t
                                       
                                    
                                    }
                                 
                                 
                                    t
                                    =
                                    1
                                 
                                 
                                    n
                                 
                              
                           
                         simultaneously. To reduce the complexity of this process and make full use of the close form solution in the pairwise registration, we first perform a splitting technique that updates one of the transformations each time to generate an initialization for the simultaneous updating. Suppose that scan 
                           
                              
                                 
                                    S
                                 
                                 
                                    r
                                 
                              
                           
                         is overlapping with several other scans 
                           
                              {
                              
                                 
                                    S
                                 
                                 
                                    t
                                 
                              
                              |
                              
                                 
                                    L
                                 
                                 
                                    (
                                    r
                                    ,
                                    t
                                    )
                                 
                              
                              
                              ≠
                              
                              ∅
                              }
                           
                        . Since a rigid transformation preserves the geometric distance, the problem reduces to
                           
                              (6)
                              
                                 
                                    
                                       
                                          min
                                       
                                       
                                          
                                             
                                                ϕ
                                             
                                             
                                                r
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       t
                                       
                                          
                                             |
                                          
                                          
                                             
                                                
                                                   L
                                                
                                                
                                                   (
                                                   r
                                                   ,
                                                   t
                                                   )
                                                
                                             
                                             ≠
                                             ∅
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      (
                                                      r
                                                      ,
                                                      t
                                                      )
                                                   
                                                
                                                ∈
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      r
                                                   
                                                
                                             
                                          
                                          d
                                          
                                             
                                                (
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      r
                                                   
                                                
                                                (
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      (
                                                      r
                                                      ,
                                                      t
                                                      )
                                                   
                                                
                                                )
                                                ,
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      t
                                                   
                                                
                                                (
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      t
                                                   
                                                
                                                )
                                                )
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                ∑
                                             
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      j
                                                   
                                                   
                                                      (
                                                      t
                                                      ,
                                                      r
                                                      )
                                                   
                                                
                                                ∈
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      t
                                                   
                                                
                                             
                                          
                                          d
                                          
                                             
                                                (
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      t
                                                   
                                                
                                                (
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      j
                                                   
                                                   
                                                      (
                                                      t
                                                      ,
                                                      r
                                                      )
                                                   
                                                
                                                )
                                                ,
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      r
                                                   
                                                
                                                (
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      r
                                                   
                                                
                                                )
                                                )
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                              
                           
                        when updating 
                           
                              
                                 
                                    ϕ
                                 
                                 
                                    r
                                 
                              
                           
                         with the others fixed. Each transformation is immediately applied to the data after its calculation, thus the convergence problem as pointed out in [2] can be avoided. This splitting formula (6) is actually the bi-directional registration of a scan to its overlapping surfaces, which will be fully discussed and analyzed in Section 4.

A possible effect of this sequential behavior is a deviated updating of the transformations. That is, when updating one of the transformations and fixing all the others, the updating meant to the two composed transformation of one overlapping region is applied to only one of them. However, this is not a problem in our formulation since we fix one of the scans and apply all the transformations as soon as they are calculated. Thus no seesaw-action will occur. And due to the consistent variable settings with no redundant transformations, this will not lead to an inconsistent result. Different from [2] where a totally incremental procedure is applied, a simultaneous updating of all the transformations will further refine the resulting transforms after a certain steps of splitting updating in our approach. The splitting updating avoids the local minima [2], and the simultaneous updating ensures the loop closure.

Another concern is the weighting between the scans. As we can see from (6), if one scan is overlapping with many other scans, all these terms related to this scan will be added to the objective function, which amounts to a larger weight associated with it than others. We consider this to be reasonable since the more overlaps a scan has, the more important it is to keep the steadiness of this scan, and a larger weight is just proper to fulfill this task.

The bi-directional registration of a scanning view to its overlapping surfaces is the key step in the optimization procedure of our consistent multi-view registration. We have observed that the bi-directional registration can achieve higher accuracy through establishing the parametric correspondences rather than the variants of closest point correspondences. In this section, we formulate the bi-directional registration based on parametric correspondences.

In registration models (4) and (6), the problem occurs that there is no close form for the distance measure 
                           
                              d
                              (
                              ϕ
                              (
                              p
                              )
                              ,
                              
                                 
                                    S
                                 
                                 
                                    t
                                 
                              
                              )
                           
                        . Such case is usually handled by an iterative procedure which successively approximates the formulation using a transformation 
                           
                              
                                 
                                    ϕ
                                 
                                 
                                    (
                                    k
                                    -
                                    1
                                    )
                                 
                              
                           
                         from the last step. Thus the classic registration methods, like ICP and its variants, separate the optimization into two main steps: estimating the correspondence and minimizing the distance measure. The estimation by ICP and its variants is a straightforward search on a discretization of the target surface, generating an approximation of distance measure from the sampled points. This approach is intuitive and practical in many cases. However, an existing flaw is that a discrete approximation will be greatly affected by causes, such as sample rate and occlusion which are not the intrinsic properties of surface. These negative factors are inevitable in practical applications, especially in the multi-view registration where the local deviations can accumulate to significant gaps.

Instead of the closest point correspondence, we propose a parametric based approach to improve the estimation of correspondence. The parametric correspondence 
                           
                              (
                              p
                              ,
                              q
                              (
                              u
                              )
                              )
                           
                         between source and target is established by the following model
                           
                              (7)
                              
                                 d
                                 (
                                 ϕ
                                 (
                                 p
                                 )
                                 ,
                                 
                                    
                                       S
                                    
                                    
                                       t
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       
                                          min
                                       
                                       
                                          u
                                       
                                    
                                 
                                 {
                                 ‖
                                 ϕ
                                 (
                                 p
                                 )
                                 -
                                 q
                                 (
                                 u
                                 )
                                 
                                    
                                       ‖
                                    
                                    
                                       2
                                    
                                 
                                 |
                                 q
                                 (
                                 u
                                 )
                                 ∈
                                 
                                    
                                       S
                                    
                                    
                                       t
                                    
                                 
                                 }
                              
                           
                        where 
                           
                              
                                 
                                    S
                                 
                                 
                                    t
                                 
                              
                           
                         is now considered as a continuous target surface and has 
                           
                              u
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    2
                                 
                              
                           
                         as its underlying parametrization.

For range scan data, additional information is the pixel domain which can serve as a natural parametrization of the scanning surface. With this continuous parameter domain in use, each point 
                           
                              q
                           
                         on the surface can be expressed by its parameter 
                           
                              u
                           
                         as 
                           
                              q
                              (
                              u
                              )
                           
                        . Furthermore, differential quantities of the surface at 
                           
                              q
                              (
                              u
                              )
                           
                        , e.g., tangent and normal, can be well estimated by the discrete sample points 
                           
                              
                                 
                                    q
                                 
                                 
                                    i
                                 
                              
                              =
                              q
                              (
                              
                                 
                                    u
                                 
                                 
                                    i
                                 
                              
                              )
                           
                         in a preassigned neighborhood. Given 
                           
                              q
                              (
                              
                                 
                                    u
                                 
                                 
                                    i
                                 
                              
                              )
                           
                         and the Taylor expansion of 
                           
                              q
                              (
                              u
                              )
                           
                         at 
                           
                              u
                           
                        , a least square system can be directly deduced. A local quadratic approximation can also give equivalent result. Thus we are able to optimize the correspondences by setting 
                           
                              {
                              u
                              }
                           
                         as variables.

Applying the parametric correspondence to the splitting formula in (6), we get an optimization model of the bi-directional registration as follows
                           
                              (8)
                              
                                 
                                    
                                       
                                          min
                                       
                                       
                                          
                                             
                                                ϕ
                                             
                                             
                                                r
                                             
                                          
                                          ,
                                          {
                                          u
                                          }
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          t
                                          
                                             
                                                |
                                             
                                             
                                                
                                                   
                                                      L
                                                   
                                                   
                                                      (
                                                      r
                                                      ,
                                                      t
                                                      )
                                                   
                                                
                                                ≠
                                                ∅
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         (
                                                         r
                                                         ,
                                                         t
                                                         )
                                                      
                                                   
                                                   ∈
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         r
                                                      
                                                   
                                                
                                             
                                          
                                          ‖
                                          
                                             
                                                ϕ
                                             
                                             
                                                r
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         (
                                                         r
                                                         ,
                                                         t
                                                         )
                                                      
                                                   
                                                
                                             
                                          
                                          -
                                          
                                             
                                                ϕ
                                             
                                             
                                                t
                                             
                                          
                                          
                                             
                                                
                                                   q
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  u
                                                               
                                                               
                                                                  i
                                                               
                                                               
                                                                  (
                                                                  r
                                                                  ,
                                                                  t
                                                                  )
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                ‖
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         j
                                                      
                                                      
                                                         (
                                                         t
                                                         ,
                                                         r
                                                         )
                                                      
                                                   
                                                   ∈
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                
                                             
                                          
                                          ‖
                                          
                                             
                                                ϕ
                                             
                                             
                                                t
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         j
                                                      
                                                      
                                                         (
                                                         t
                                                         ,
                                                         r
                                                         )
                                                      
                                                   
                                                
                                             
                                          
                                          -
                                          
                                             
                                                ϕ
                                             
                                             
                                                r
                                             
                                          
                                          
                                             
                                                
                                                   q
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  u
                                                               
                                                               
                                                                  j
                                                               
                                                               
                                                                  (
                                                                  t
                                                                  ,
                                                                  r
                                                                  )
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                ‖
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    q
                                 
                                 
                                    i
                                 
                                 
                                    (
                                    r
                                    ,
                                    t
                                    )
                                 
                              
                              =
                              q
                              (
                              
                                 
                                    u
                                 
                                 
                                    i
                                 
                                 
                                    (
                                    r
                                    ,
                                    t
                                    )
                                 
                              
                              )
                              ∈
                              
                                 
                                    S
                                 
                                 
                                    t
                                 
                              
                           
                         is the correspondence of 
                           
                              
                                 
                                    p
                                 
                                 
                                    i
                                 
                                 
                                    (
                                    r
                                    ,
                                    t
                                    )
                                 
                              
                           
                         and 
                           
                              
                                 
                                    q
                                 
                                 
                                    j
                                 
                                 
                                    (
                                    t
                                    ,
                                    r
                                    )
                                 
                              
                              =
                              q
                              (
                              
                                 
                                    u
                                 
                                 
                                    j
                                 
                                 
                                    (
                                    t
                                    ,
                                    r
                                    )
                                 
                              
                              )
                              ∈
                              
                                 
                                    S
                                 
                                 
                                    r
                                 
                              
                           
                         is the correspondence of 
                           
                              
                                 
                                    p
                                 
                                 
                                    j
                                 
                                 
                                    (
                                    t
                                    ,
                                    r
                                    )
                                 
                              
                           
                         (see in Fig. 2
                        ). A search of closest point is needed for the initialization of 
                           
                              {
                              
                                 
                                    u
                                 
                                 
                                    i
                                 
                                 
                                    (
                                    r
                                    ,
                                    t
                                    )
                                 
                              
                              ,
                              
                                 
                                    u
                                 
                                 
                                    j
                                 
                                 
                                    (
                                    t
                                    ,
                                    r
                                    )
                                 
                              
                              }
                           
                        , and the subsequent updating is automatically performed as variables in our optimization.

Although the correspondences are regarded as variables, the formulation still works under the ICP framework and many of the classic promotion strategies can be applied directly. Note that the bi-directional registration result under ICP is still directly affected by the discrete samples. Whereas in the parametric formulation, with the accurate correspondences found on source and target surfaces (see in Fig. 3
                        ), both directions perform as a more accurate registration. Thus, the accuracy and stability are greatly promoted.

By expressing the correspondences with continuous approximation parameters, we gain several good properties in the bi-directional registration, such as correspondence accuracy and distance orthogonality.

The resulting transformation obtained from our parameter-based bi-directional registration is nearly accurate. By accuracy, the solution of the bi-directional registration (8) well approximates the true transformation while it is insensitive to the sample rate of source and target surfaces. We owe this accuracy to the parametric expression which allows a continuous correspondence representation on the target surface. In other word, we are free to look for correspondences in an infinite space rather than constrained to its finite sampling.


                           Fig. 4
                            demonstrates the accuracy property via the registration of synthesized data. We generate two samples of a smooth surface at different sample rates and positions and then apply a small amplitude rigid transformation to one of them. A correct transformation is recovered through our parametric bi-directional registration. While classic searching strategies achieve bias results due to the correspondences are constrained to discrete samples.

Another feature is that, with the parametric correspondence, the orthogonal distance is implicitly held. From the parametric correspondence formulation (7), we can sense that the correspondence of a source point is indeed the foot-point on the target surface, but not necessarily the closest point in discrete samples. Thus the direction from the source point to its correspondence is highly coherent with the normal at the correspondence, as shown in Fig. 5
                           .

In Fig. 6
                           , we give the statistics for absolute cosine of angle between the normal at correspondence and the direction from source point to its correspondence, which is calculated from an intermediate iteration of the parametric bi-directional registration for the example shown in Fig. 4. Most of the absolute cosine values in our parametric correspondence are greater than 0.99 while only a small part of correspondence pairs in classic ICP reaching this threshold.

Thus, though our formulation takes the form of a point-to-point distance, the point-to-plane metric 
                              
                                 ‖
                                 
                                    
                                       n
                                    
                                    
                                       i
                                    
                                 
                                 ·
                                 (
                                 
                                    
                                       p
                                    
                                    
                                       i
                                    
                                 
                                 -
                                 
                                    
                                       q
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 ‖
                              
                            is already held for the coherence of the directions. This does not mean that the distance orthogonality is equivalent to the point-to-plane distance. In fact, the orthogonal distance provides a more accurate approximation of the geometry distance from a point to a surface. Both the discrete point-to-point and point-to-plane distance give a good approximation of the orthogonal distance only when the point is very close to the surface and a fairly dense sampling is provided. And with this point-to-point form, the method is less sensitive to initial state than the point-to-plane ICP algorithm.

In summary, accurate correspondence is the most important feature of our parameter-based bi-directional registration, which provides the way leading to a globally consistent registration of multiple views without drift problem.

@&#RESULTS AND DISCUSSION@&#

Our experiments are performed on Windows 7 OS with 2.80GHz*4 CPU (Intel i5-2300) and 8G RAM. All the data in our experiments are real scanning data, except the one used in the evaluation where a resampling is needed. We have tested our algorithm on various models. In each model, usually 5–10% correspondences in the overlapping regions are used for registration. The computing time various from several minutes to a dozen minutes for input data sets with dozen thousands to hundred thousands of vertices.

Our method applies directly to range data with a natural pixel domain. Given the calibrated parameters of the range scanner, the mapping from the pixel domain to 3D points is known. However, these parameters are not always available. As a matter of fact, the framework can be applied to any data with a parametric representation. Projecting the input scanning data onto a proper plane is adequate to serve as the parametrization. To suit the general case, all the results given in this paper use this projection as a simple parametrization instead of the calibrated mappings.

As a post-processing method, we are supposed to start from the result of some pairwise methods like ICP. However, to inspect the insensitiveness to the initial state of our method, the results presented here all start from a quite coarse initialization. The first row of Fig. 7
                         illustrates the registration of a part of the Happy Buddha model, where 15 scans are captured by a scanning path containing one loop. The result in the last column shows that all the patches are well aligned and no drift exists. Different colors indicate different patches in the result figures.

During the scanning process, complicated scanning paths are commonly used to get complete 3D models, for example the in-hand devices allow the user to acquire scans freely. Intersection of scanning loops can easily lead to complicated sub-loops, making the detection of the entire structure a difficult task and the global constraints hard to be totally consistent. Without the need of explicit constraint restriction, our approach deals with nested loops naturally.

The second row of Fig. 7 shows the experiment performed on 2 intersecting scanning loops. With the 2 intersections in the front and back of the path, 4 more sub loops arise. The drifts in all sub loops are eliminated. In the next two rows, the scanning paths consist of 3 intersecting circle loops. The last row shows the registration of a part of the model Neptune, which is scanned with complicated paths. Many sub loops exist in these scanning paths. The performances of our method on these examples are listed in Table 1
                           , together with some details of the models. Consistent results are obtained in all the experiments.


                           Fig. 8
                            displays the trend of objective values. We normalize the scans to put the values in one figure, for their original coordinates are in different order of magnitudes. Some jumps exist in the earlier stage because of the deletion of point pairs. After a certain steps of iteration when no point pairs need to be rejected, the optimization process becomes stable and is able to converge.

Apart from the well-known examples from The Stanford 3D Scanning Repository above, other data sets are also tested. Fig. 9
                            shows another example consists of 8 scans captured from a circled scanning path by the laser scanner Range 7. A naive parameter domain is obtained by projecting the data onto the x–y plane in their local frame. Starting from a coarse alignment, our method generates quite satisfactory results, which shows that the approach is applicative to different data types.

@&#EVALUATION@&#

The accuracy of our approach is evaluated in this section. A simple comparison of the registration results is shown in Fig. 10
                        , where the input is 12 scans simulated on a circular path. Simply chaining pairwise ICP leads to obvious drift at the end of the loop (left). The ELCH ([3], middle) and our approach (right) close the loop. And our method generates more visually satisfying result.

To evaluate the accuracy, we sample the model Stanford Bunny from a fixed viewpoint and rotate the model 45 degrees each time to get 8 scans. After each rotation, the visible vertices are recorded. Thus each point of the scans has a corresponding ground truth. To inspect the functionality of parameter correspondence, three different sample strategies are used: (1) sample all the visible points from the viewpoint; (2) random sample visible points with the same rate; (3) random sample visible points with different rates. We use the results of a pairwise ICP registration as the initialization to make a fair comparison. The scans are registered by ELCH, Pulli’s method [2] which was implemented in the software Scanalyze [44] and our method. Both the 
                           
                              
                                 
                                    l
                                 
                                 
                                    ∞
                                 
                              
                           
                         and average 
                           
                              
                                 
                                    l
                                 
                                 
                                    2
                                 
                              
                           
                         errors with respect to the original model are calculated. The results are shown in Fig. 11
                        .

The registration results are visually comparative. While error values in Table 2
                         show interesting tendency (each row corresponds to one sampling strategy respectively as stated above). First, our method results in smaller error in most cases. And from the last column we can see that the sample rate generates minor influence on our results. This is reasonable since the parameter helps to find the correct correspondences though they are not captured by the scanner.

There is an increase in the 
                           
                              
                                 
                                    l
                                 
                                 
                                    2
                                 
                              
                           
                         error of the ELCH in the first strategy. This is possible since the diffusion process distributes the accumulated error to previous scans. If the previous scans are already perfectly aligned, this distribution may cause a rise in the 
                           
                              
                                 
                                    l
                                 
                                 
                                    2
                                 
                              
                           
                         error. And in the first sample strategy where all vertices are sampled, ICP is competent to provide such a good initial state. Our approach generates comparative results with Pulli’s method [2]. However, when the sample rate is lower and different sample rates are used for the scans, both the 
                           
                              
                                 
                                    l
                                 
                                 
                                    ∞
                                 
                              
                           
                         and 
                           
                              
                                 
                                    l
                                 
                                 
                                    2
                                 
                              
                           
                         errors of Pulli’s method exhibits a more obvious increasing trend. Though the loop is very simple, the results show the advantage of parametric correspondence and insensitivity to sample rate of our method. A pointwise color-encoding of the registration errors is shown in Fig. 12
                        .

The time cost of both ELCH and Pulli’s method is smaller than ours. Given proper initialization, Pulli’s method can be an order of magnitude faster than our method for it applies incremental updating and directly searches for correspondences. ELCH is even faster because it simply distributes transforms to adjacent patches. We optimize all the transforms and correspondences together to obtain higher accuracy.

This experiment illustrates the accuracy of our method in a simple scanning path containing one single loop. Nevertheless, as previously stated, the strength of our method lies in complicated cases where numerous loops exists.

The consistent multi-view registration formulation provides a non-redundant variable system to gather local pairwise overlapping information and lead to a consistent result. As long as a pairwise approach provide an invertible transformation between the overlapping patches, it can be employed by this framework and generate consistent results.

We present a parametric based consistent framework that deals with the loop closure problem in multi-view registration. By gathering local overlapping information through a bi-directional parametric registration in each overlapping region that produces invertible transformations, drift-free results are finally obtained. Only pairwise overlapping information is needed and the consistency is ensured automatically by the consistent formulation.

A coarse registration step that provides an initial state is needed for our method, since we need the pairwise overlapping information. Both rough manual alignment and coarse registration methods are feasible as long as the right overlapping information is provided. In our experiments, the alignment method presented by Aiger et al. [45] generates quite preferable initial states in most cases.

A more efficient optimization of the framework is one of our future works. With all the correspondences as variables, the optimization procedure is slower than methods use direct searching strategy. GPU acceleration is to be considered in the optimization procedure.

Dealing with noisy data is also an important topic in registration. The ability to restrain outliers can be enhanced by sparse optimization theory. Bouaziz et al. [46] present an extension of the classic ICP with p-norm which can treat wild outliers effectively. In our framework, the p-norm 
                        
                           (
                           0
                           <
                           p
                           ⩽
                           1
                           )
                        
                      can be applied directly by defining different distance measures. Thus a robustness enhancement is possible.

Another future direction is the non-rigid registration. Since our method works well on rigid registration, generalization to piecewise rigid registration of articulated object is straightforward. With the parameter information in use, we believe the extension to non-rigid case can also bring in much benefit.

@&#ACKNOWLEDGMENTS@&#

We would like to thank the anonymous reviewers for their constructive and valuable comments. Thanks also go to Aim@Shape project and the Stanford Computer Graphics Laboratory for providing the models in the paper. The work is supported by the 973 Program 2011CB302400, the NSF of China (Nos. 11031007, 11171322, 61222206, 11371341), One Hundred Talent Project of the Chinese Academy of Sciences, and the Program for New Century Excellent Talents in University (No. NCET-11-0881).

@&#REFERENCES@&#

