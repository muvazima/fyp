@&#MAIN-TITLE@&#Max–min distance nonnegative matrix factorization

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A novel supervised nonnegative matrix factorization method is proposed.


                        
                        
                           
                           Within-class and between-class pairs are defined by class labels.


                        
                        
                           
                           The maximum within-class distance is minimized in NMF space.


                        
                        
                           
                           The minimum between-class distance is maximized in NMF space.


                        
                        
                           
                           Experiment results show its outperformance over other supervised NMF methods.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Data representation

Nonnegative matrix factorization

Supervised learning

Max–min distance analysis

@&#ABSTRACT@&#


               
               
                  Nonnegative Matrix Factorization (NMF) has been a popular representation method for pattern classification problems. It tries to decompose a nonnegative matrix of data samples as the product of a nonnegative basis matrix and a nonnegative coefficient matrix. The columns of the coefficient matrix can be used as new representations of these data samples. However, traditional NMF methods ignore class labels of the data samples. In this paper, we propose a novel supervised NMF algorithm to improve the discriminative ability of the new representation by using the class labels. Using the class labels, we separate all the data sample pairs into within-class pairs and between-class pairs. To improve the discriminative ability of the new NMF representations, we propose to minimize the maximum distance of the within-class pairs in the new NMF space, and meanwhile to maximize the minimum distance of the between-class pairs. With this criterion, we construct an objective function and optimize it with regard to basis and coefficient matrices, and slack variables alternatively, resulting in an iterative algorithm. The proposed algorithm is evaluated on three pattern classification problems and experiment results show that it outperforms the state-of-the-art supervised NMF methods.
               
            

@&#INTRODUCTION@&#

Nonnegative matrix factorization (NMF) has attracted much attention from both research and engineering communities (Eches & Guillaume, 2014; Lin, 2007; Malley, Braban, & Heal, 2014; Seung & Lee, 2001; Vidar & Alvindia, 2013; Wang, Almasri, & Gao, 2012; Wang, Bensmail, & Gao, 2013; Wang & Gao, 2014; Zheng, Zhang, Ng, Shiu, & Huang, 2011). Given a data matrix whose elements are all nonnegative, NMF tries to decompose it as the product of two nonnegative low-rank matrices. One matrix can be regarded as a basis matrix with its columns as basis vectors, and the other one as a linear combination coefficient matrix, so that the original data columns in the original matrix could be represented as the linear combination of the basis vectors. Because of the nonnegative constrains on both the factorization metrics, it only allows the additive linear combination, and thus a part-based representation could be achieved (Agarwal, Awan, & Roth, 2004; Cai, He, Han, & Huang, 2011; Hwang & Kang, 2013; Lemme, Reinhart, & Steil, 2012; Zhao, Li, Wu, Fu, & Liu, 2013). Since the original NMF approach was proposed by Lee and Seung (1999) and Seung and Lee (2001), due to its ability to learn the parts of the data set (Li, Hou, Zhang, & Cheng, 2001), it has been used as an effective data representation method in various problems, such as pattern recognition (Hoyer, 2004; Liu, Zheng, & You, 2006; Van Hamme, 2012; Zhu, 2008), computer vision (Guillamet, Vitri, & Schiele, 2003; Monga & Mihak, 2007; Shashua & Hazan, 2005), and bioinformatics (Gao & Church, 2005; Pascual-Montano, 2008; Tian, Liu, & Wu, 2013). The most popular application of NMF as a data representation tool is in pattern recognition, where the nonnegative feature vectors of the data samples are organized as a nonnegative matrix, and the columns of the coefficient matrix are used as the new low-dimensional representations.

In the pattern recognition problems, when NMF is applied on the data matrix, it is usually assumed that the class labels of the data samples are not available, making it an unsupervised problem (Mohammadiha, Smaragdis, & Leijon, 2013; Tsarev, Petrovskiy, & Mashechkin, 2011). Some typical applications include clustering of images and documents (Cai et al., 2011; Liu, Wu, Li, Cai, & Huang, 2012). However, in real world supervised or semi-supervised classification applications, class labels of training data samples are usually available, which is ignored by most existing NMF methods. If the class label information could be utilized during the representation procedure, the discriminative ability of the representation could be significantly improved (Gaujoux & Seoighe, 2012; Kitamura et al., 2013; Zhang, Xia, Yang, & Yang, 2007; Zhou & Schwenker, 2013). To this end, some supervised and semi-supervised NMF methods were proposed. For example, Wang and Jia (2004) proposed the Fisher nonnegative matrix factorization (FNMF) method to encode discrimination information for a classification problem by imposing Fisher constraints on the NMF algorithm. Lee, Yoo, and Choi (2010) proposed the semi-supervised nonnegative matrix factorization (SSNMF) by jointly incorporating the data matrix and the partial class label matrix into NMF. Most recently, Liu, Wu et al. (2012) proposed the constrained nonnegative matrix factorization (CNMF) by incorporating the label information as additional constraints.

In this paper, we propose a novel supervised NMF method, by exploring the class label information and using it to constrain the learning of coefficient vectors of the data samples. We consider pairs of data samples, and the class labels of the samples allow us to separate the pairs to two types—the within-class pair and the between-class pair. The within-class pair refers to a pair of samples with the same class label, while the between-class pair refers to a pair of samples with different class labels. To improve the discriminate ability of the coefficient vectors of the samples, we consider the distance between the coefficient vectors of each sample pairs, and try to minimize that of the within-class pairs, while maximize that of the between-class pairs. In this way, the coefficient vectors of data samples of the same class can be gathered, while that of different classes can be separated. One problem is how to assign different weights to different pairs in the objective function. To avoid this problem, we apply a strategy similar to max–min distance analysis (Bian & Tao, 2011). The maximum within-class pair coefficient vector distance is minimized, so that all the within-class pair coefficient vector distances can be minimized as well. Meanwhile the minimum between-class pair coefficient vector distance is maximized, so that all the between-class pair coefficient vector distances can be maximized as well. We construct a novel objective function for NMF to impose both the maximum within-class pair distance minimization and the minimum between-class pair distance maximization problems. By optimizing it with an alternative strategy, we develop an iterative algorithm. The proposed method is called Max–Min Distance NMF (MMDNMF).

The remaining parts of this paper are organized as follows: in Section  2, we introduce the novel NMF method. In Section  3, the experimental results are given to verify the effectiveness of the proposed method. The paper is concluded in Section  4.

@&#PROPOSED METHOD@&#

In this section, we first formulate the problem with an objective function, and then optimize it to obtain an iterative learning algorithm.

Supposing we have 
                           n
                         data samples in a training set 
                           X
                           =
                           
                              
                                 
                                    {
                                    
                                       
                                          
                                             x
                                          
                                       
                                       
                                          i
                                       
                                    
                                    }
                                 
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 n
                              
                           
                        , where 
                           
                              
                                 
                                    x
                                 
                              
                              
                                 i
                              
                           
                           ∈
                           
                              
                                 R
                              
                              
                                 +
                              
                              
                                 d
                              
                           
                         is the 
                           d
                        -dimensional nonnegative feature vector of the 
                           i
                        th sample, we organize the samples as a nonnegative matrix 
                           X
                           =
                           
                              [
                              
                                 
                                    
                                       x
                                    
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    
                                       x
                                    
                                 
                                 
                                    n
                                 
                              
                              ]
                           
                           ∈
                           
                              
                                 R
                              
                              
                                 +
                              
                              
                                 d
                                 ×
                                 n
                              
                           
                        . The 
                           i
                        th column of the matrix 
                           X
                         is the feature vector of the 
                           i
                        th sample. Their corresponding class label set is denoted as 
                           
                              
                                 
                                    {
                                    
                                       
                                          y
                                       
                                       
                                          i
                                       
                                    
                                    }
                                 
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 n
                              
                           
                        , where 
                           
                              
                                 y
                              
                              
                                 i
                              
                           
                           ∈
                           Y
                         is the class label of the 
                           i
                        th sample, and 
                           Y
                         is the class label space. NMF aims to find two low rank nonnegative matrices 
                           U
                           ∈
                           
                              
                                 R
                              
                              
                                 +
                              
                              
                                 d
                                 ×
                                 m
                              
                           
                         and 
                           V
                           ∈
                           
                              
                                 R
                              
                              
                                 +
                              
                              
                                 m
                                 ×
                                 n
                              
                           
                        , where 
                           m
                           ≤
                           d
                        , so that the product of them, 
                           U
                           V
                        , could approximate the original matrix, 
                           X
                        , as accurately as possible, 
                           
                              (1)
                              
                                 X
                                 ≈
                                 U
                                 V
                                 .
                              
                           
                         The 
                           m
                         columns of the matrix 
                           U
                         could be regarded as 
                           m
                         basis vectors, and each sample 
                           
                              
                                 
                                    x
                                 
                              
                              
                                 i
                              
                           
                         could be represented as the nonnegative linear combination of these basis vectors. The linear combination coefficient vector of 
                           
                              
                                 
                                    x
                                 
                              
                              
                                 i
                              
                           
                         is the 
                           i
                        th column vector 
                           
                              
                                 
                                    v
                                 
                              
                              
                                 i
                              
                           
                           ∈
                           
                              
                                 R
                              
                              
                                 +
                              
                              
                                 m
                              
                           
                         of 
                           V
                        . We can also regard 
                           
                              
                                 
                                    v
                                 
                              
                              
                                 i
                              
                           
                         as a new low-dimensional presentation vector of 
                           
                              
                                 
                                    x
                                 
                              
                              
                                 i
                              
                           
                         with regard to the basis matrix 
                           U
                        . To seek the optimal matrices 
                           U
                         and 
                           V
                        , we consider the following problems to construct our objective function:
                           
                              •
                              To reduce the approximation error between 
                                    X
                                  and 
                                    U
                                    V
                                 , the squared 
                                    
                                       
                                          ℓ
                                       
                                       
                                          2
                                       
                                    
                                  distance between them is usually minimized with regard to 
                                    U
                                  and 
                                    V
                                  as follows, 
                                    
                                       (2)
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         min
                                                      
                                                      
                                                         U
                                                         ,
                                                         V
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            ‖
                                                            X
                                                            −
                                                            U
                                                            V
                                                            ‖
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                     s.t.  
                                                
                                                
                                                   U
                                                   ≥
                                                   0
                                                   ,
                                                   
                                                   V
                                                   ≥
                                                   0
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              

We consider the training sample pairs in the training set, and separate them to two pair sets—the within-class pair set 
                                    W
                                  and the between-class pair set 
                                    B
                                 . The within-class pair set is defined as the set of sample pairs belonging to the same class, i.e., 
                                    W
                                    =
                                    
                                       {
                                       
                                          (
                                          i
                                          ,
                                          j
                                          )
                                       
                                       |
                                       
                                          
                                             y
                                          
                                          
                                             i
                                          
                                       
                                       =
                                       
                                          
                                             y
                                          
                                          
                                             j
                                          
                                       
                                       ,
                                       
                                          
                                             
                                                x
                                             
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             
                                                x
                                             
                                          
                                          
                                             j
                                          
                                       
                                       ∈
                                       X
                                       }
                                    
                                 . The between-class pair set is defined as the set of sample pairs belonging to different classes, i.e.,  
                                    B
                                    =
                                    
                                       {
                                       
                                          (
                                          i
                                          ,
                                          j
                                          )
                                       
                                       |
                                       
                                          
                                             y
                                          
                                          
                                             i
                                          
                                       
                                       ≠
                                       
                                          
                                             y
                                          
                                          
                                             j
                                          
                                       
                                       ,
                                       
                                          
                                             
                                                x
                                             
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             
                                                x
                                             
                                          
                                          
                                             j
                                          
                                       
                                       ∈
                                       X
                                       }
                                    
                                 . To compare the two samples of the 
                                    
                                       (
                                       i
                                       ,
                                       j
                                       )
                                    
                                 th pair in the new coefficient vector space, we use the squared 
                                    
                                       
                                          ℓ
                                       
                                       
                                          2
                                       
                                    
                                  norm distance between their coefficient vectors, 
                                    
                                       
                                          
                                             ‖
                                             
                                                
                                                   
                                                      v
                                                   
                                                
                                                
                                                   i
                                                
                                             
                                             −
                                             
                                                
                                                   
                                                      v
                                                   
                                                
                                                
                                                   j
                                                
                                             
                                             ‖
                                          
                                       
                                       
                                          2
                                       
                                       
                                          2
                                       
                                    
                                 . Apparently, to improve the discriminative ability of the new NMF presentation, the coefficient vector distances of within-class pairs should be minimized, while those of the between-class pairs should be maximized. Instead of considering all the pairs, we directly minimize the maximum coefficient vector distance of the within-class pairs, as follows, 
                                    
                                       (3)
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         min
                                                      
                                                      
                                                         V
                                                      
                                                   
                                                
                                                
                                                   
                                                      {
                                                      
                                                         
                                                            max
                                                         
                                                         
                                                            
                                                               (
                                                               i
                                                               ,
                                                               j
                                                               )
                                                            
                                                            ∈
                                                            W
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               ‖
                                                               
                                                                  
                                                                     
                                                                        v
                                                                     
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                               −
                                                               
                                                                  
                                                                     
                                                                        v
                                                                     
                                                                  
                                                                  
                                                                     j
                                                                  
                                                               
                                                               ‖
                                                            
                                                         
                                                         
                                                            2
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      }
                                                   
                                                
                                             
                                             
                                                
                                                   s.t.  
                                                
                                                
                                                   V
                                                   ≥
                                                   0
                                                   ,
                                                
                                             
                                          
                                       
                                    
                                  and thus we duly consider the aggregation of all within-class pairs. Meanwhile, we also maximize the minimum coefficient vector distance of the between-class pairs, as follows, 
                                    
                                       (4)
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         max
                                                      
                                                      
                                                         V
                                                      
                                                   
                                                
                                                
                                                   
                                                      {
                                                      
                                                         
                                                            min
                                                         
                                                         
                                                            
                                                               (
                                                               i
                                                               ,
                                                               j
                                                               )
                                                            
                                                            ∈
                                                            B
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               ‖
                                                               
                                                                  
                                                                     
                                                                        v
                                                                     
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                               −
                                                               
                                                                  
                                                                     
                                                                        v
                                                                     
                                                                  
                                                                  
                                                                     j
                                                                  
                                                               
                                                               ‖
                                                            
                                                         
                                                         
                                                            2
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      }
                                                   
                                                
                                             
                                             
                                                
                                                   s.t.
                                                
                                                
                                                   V
                                                   ≥
                                                   0
                                                
                                             
                                          
                                       
                                    
                                  and thus we consider the separation of all between-class pairs. In this way, the maximum within-class pair distance is minimized, so that all the within-class pair distances are also minimized. Similarly, the minimum between-class pair distance is maximized, so that all the between-class pair distances are also maximized.

To formulate our problem, we combine the problems in (2)–(4), and propose the novel optimization problem for NMF as 
                           
                              (5)
                              
                                 
                                    
                                       
                                          
                                             
                                                min
                                             
                                             
                                                U
                                                ,
                                                V
                                             
                                          
                                       
                                       
                                          
                                             {
                                             
                                                
                                                   
                                                      ‖
                                                      X
                                                      −
                                                      U
                                                      V
                                                      ‖
                                                   
                                                
                                                
                                                   2
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             a
                                             
                                                
                                                   max
                                                
                                                
                                                   
                                                      (
                                                      i
                                                      ,
                                                      j
                                                      )
                                                   
                                                   ∈
                                                   W
                                                
                                             
                                             
                                                
                                                   
                                                      ‖
                                                      
                                                         
                                                            
                                                               v
                                                            
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            
                                                               v
                                                            
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      ‖
                                                   
                                                
                                                
                                                   2
                                                
                                                
                                                   2
                                                
                                             
                                             −
                                             b
                                             
                                                
                                                   min
                                                
                                                
                                                   
                                                      (
                                                      i
                                                      ,
                                                      j
                                                      )
                                                   
                                                   ∈
                                                   B
                                                
                                             
                                             
                                                
                                                   
                                                      ‖
                                                      
                                                         
                                                            
                                                               v
                                                            
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            
                                                               v
                                                            
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      ‖
                                                   
                                                
                                                
                                                   2
                                                
                                                
                                                   2
                                                
                                             
                                             }
                                          
                                       
                                    
                                    
                                       
                                          s.t.
                                       
                                       
                                          U
                                          ≥
                                          0
                                          ,
                                          
                                          V
                                          ≥
                                          0
                                          ,
                                       
                                    
                                 
                              
                           
                         where 
                           a
                         and 
                           b
                         are tradeoff parameters, which can be chosen by cross validation.

Hereby, we also give a clear comparison between the proposed objective (5) and the objective of FNMF (Wang & Jia, 2004). The objective function of FNMF is composed of an approximation error term and a fisher term, as follows, 
                           
                              (6)
                              
                                 D
                                 
                                    (
                                    X
                                    ,
                                    U
                                    V
                                    )
                                 
                                 +
                                 a
                                 
                                    (
                                    
                                       
                                          S
                                       
                                       
                                          W
                                       
                                    
                                    −
                                    
                                       
                                          S
                                       
                                       
                                          B
                                       
                                    
                                    )
                                 
                              
                           
                         where 
                           D
                           
                              (
                              X
                              ,
                              U
                              V
                              )
                           
                         is the Kullback–Leibler divergence between 
                           X
                         and 
                           U
                           V
                        , which is used to measure the approximation error, and 
                           
                              
                                 S
                              
                              
                                 w
                              
                           
                         is the within-class scatter of the coefficient matrix 
                           V
                         and 
                           
                              
                                 S
                              
                              
                                 B
                              
                           
                         is the between-class scatter of 
                           V
                        . 
                           
                              
                                 S
                              
                              
                                 W
                              
                           
                         and 
                           
                              
                                 S
                              
                              
                                 B
                              
                           
                         are defined as 
                           
                              (7)
                              
                                 
                                    
                                       
                                          S
                                       
                                       
                                          W
                                       
                                    
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          C
                                       
                                    
                                    
                                       
                                          ∑
                                       
                                       
                                          y
                                          ∈
                                          Y
                                       
                                    
                                    
                                       (
                                       
                                          
                                             1
                                          
                                          
                                             
                                                
                                                   n
                                                
                                                
                                                   y
                                                
                                             
                                          
                                       
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             :
                                             
                                                
                                                   y
                                                
                                                
                                                   i
                                                
                                             
                                             =
                                             y
                                          
                                       
                                       
                                          
                                             
                                                ‖
                                                
                                                   
                                                      
                                                         v
                                                      
                                                   
                                                   
                                                      i
                                                   
                                                
                                                −
                                                
                                                   
                                                      
                                                         
                                                            
                                                               v
                                                            
                                                         
                                                         ¯
                                                      
                                                   
                                                   
                                                      y
                                                   
                                                
                                                ‖
                                             
                                          
                                          
                                             2
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          S
                                       
                                       
                                          B
                                       
                                    
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          C
                                          
                                             (
                                             C
                                             −
                                             1
                                             )
                                          
                                       
                                    
                                    
                                       
                                          ∑
                                       
                                       
                                          
                                             (
                                             y
                                             ,
                                             
                                                
                                                   y
                                                
                                                
                                                   ′
                                                
                                             
                                             )
                                          
                                          :
                                          y
                                          ,
                                          
                                             
                                                y
                                             
                                             
                                                ′
                                             
                                          
                                          ∈
                                          Y
                                       
                                    
                                    
                                       
                                          
                                             ‖
                                             
                                                
                                                   
                                                      
                                                         
                                                            v
                                                         
                                                      
                                                      ¯
                                                   
                                                
                                                
                                                   y
                                                
                                             
                                             −
                                             
                                                
                                                   
                                                      
                                                         
                                                            v
                                                         
                                                      
                                                      ¯
                                                   
                                                
                                                
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                             
                                             ‖
                                          
                                       
                                       
                                          2
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                 
                              
                           
                         where 
                           C
                         is the number of classes, 
                           
                              
                                 n
                              
                              
                                 y
                              
                           
                         is the number of data samples of the class 
                           y
                        , and 
                           
                              
                                 
                                    
                                       
                                          v
                                       
                                    
                                    ¯
                                 
                              
                              
                                 y
                              
                           
                           =
                           
                              
                                 ∑
                              
                              
                                 i
                                 :
                                 
                                    
                                       y
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 y
                              
                           
                           
                              
                                 1
                              
                              
                                 
                                    
                                       n
                                    
                                    
                                       y
                                    
                                 
                              
                           
                           
                              
                                 
                                    v
                                 
                              
                              
                                 i
                              
                           
                         is the mean coefficient vector of class 
                           y
                        . Comparing our objective function in (5) and the objective function of FNMF in (6), there are two main differences: 
                           
                              1.
                              Our objective function uses a squared 
                                    
                                       
                                          ℓ
                                       
                                       
                                          2
                                       
                                    
                                  norm distance to measure the approximation error of 
                                    X
                                  by 
                                    U
                                    V
                                 , while FNMF uses the Kullback–Leibler divergence. Both squared 
                                    
                                       
                                          ℓ
                                       
                                       
                                          2
                                       
                                    
                                  norm distance and Kullback–Leibler divergence are the most popular loss functions of NMF. There are some other loss functions which can be used to measure the approximation error, such as correntropy (Wang, Wang, & Gao, 2013) and earth mover’s distance (Sandler & Lindenbaum, 2011). However, the loss function is not the focus of this study and we leave it to the future work.

To use the class label information to improve the discriminative ability of the learned coefficient vectors, both FNMF and MMDNMF minimize the distances of coefficient vectors of within-class pair samples, while maximize the distances of coefficient vectors of between-class pair samples. However, MMDNMF minimizes the maximum distances of coefficient vectors of within-class pair samples of all classes, while FNMF minimizes all the coefficient vectors of within-class pair samples equally for each class. In this way, MMDNMF can guarantee that the within-class distances are minimized to an extremity, while FNMF cannot. Similarly, MMDNMF can maximize the between-class distances to an extremity while FNMF cannot. Thus compared to MMDNMF, FNMF does not optimally use the discriminative information.

We further explain this to make the benefits of the proposed method more clear. Given the class labels, we can define the between-class and within-class pairs easily. However, during the learning procedure, it is important to find which pair plays the most important role to explore the discriminative information. To this end, we can assign different weights to different pairs. FNMF actually uses the simplest way to this end by equally weighting these pairs, while MMDNMF tries to find the most critical pairs and assign them with the largest weights. This is the main reason that the proposed method benefits from the discriminative information more than FNMF. However, we should admit this also brings the main limitation to the proposed method, which is its sensitivity to outliers. Actually, if there is an extreme data sample in class 
                           y
                        , which is a real outlier for this class, it may play a dominant role in weighting the data pairs with regard to class 
                           y
                        . Thus it is necessary to detect outliers and ignore them, rather than using them as references for classification.

It should be noted that in (5), the maximization and minimization problem are coupled, making it difficult to optimize. To solve this problem, we introduce two nonnegative slack variables 
                           ε
                           ≥
                           0
                         and 
                           ζ
                           ≥
                           0
                         to represent the maximum coefficient vector distance between all within-class pairs, and the minimum coefficient vector distance between all between-class pairs respectively. In this way, (5) could be rewritten as 
                           
                              (8)
                              
                                 
                                    
                                       
                                          
                                             
                                                min
                                             
                                             
                                                U
                                                ,
                                                V
                                                ,
                                                ε
                                                ,
                                                ζ
                                             
                                          
                                       
                                       
                                          
                                             {
                                             
                                                
                                                   
                                                      ‖
                                                      X
                                                      −
                                                      U
                                                      V
                                                      ‖
                                                   
                                                
                                                
                                                   2
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             a
                                             ε
                                             −
                                             b
                                             ζ
                                             }
                                          
                                       
                                    
                                    
                                       
                                          s.t.
                                       
                                       
                                          
                                             
                                                
                                                   ‖
                                                   
                                                      
                                                         
                                                            v
                                                         
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         
                                                            v
                                                         
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   ‖
                                                
                                             
                                             
                                                2
                                             
                                             
                                                2
                                             
                                          
                                          ≤
                                          ε
                                          ,
                                          
                                          ∀
                                          
                                             (
                                             i
                                             ,
                                             j
                                             )
                                          
                                          ∈
                                          W
                                          ,
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   ‖
                                                   
                                                      
                                                         
                                                            v
                                                         
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         
                                                            v
                                                         
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   ‖
                                                
                                             
                                             
                                                2
                                             
                                             
                                                2
                                             
                                          
                                          ≥
                                          ζ
                                          ,
                                          
                                          ∀
                                          
                                             (
                                             i
                                             ,
                                             j
                                             )
                                          
                                          ∈
                                          B
                                          ,
                                       
                                    
                                    
                                       
                                       
                                          U
                                          ≥
                                          0
                                          ,
                                          
                                          V
                                          ≥
                                          0
                                          ,
                                          
                                          ε
                                          ≥
                                          0
                                          ,
                                          
                                          ζ
                                          ≥
                                          0
                                          .
                                       
                                    
                                 
                              
                           
                         In this problem, the two slack variables are also optimized with the basis matrix 
                           U
                         and the coefficient matrix 
                           V
                        .

To solve the problem introduced in (8), we come up with the Lagrange function as follows (Dang & Xu, 2001; Liu, Fan, & Pardalos, 2012; Stump et al., 2001), 
                           
                              (9)
                              
                                 L
                                 
                                    (
                                    U
                                    ,
                                    V
                                    ,
                                    ε
                                    ,
                                    ζ
                                    ,
                                    
                                       
                                          λ
                                       
                                       
                                          i
                                          j
                                       
                                    
                                    ,
                                    
                                       
                                          ξ
                                       
                                       
                                          i
                                          j
                                       
                                    
                                    ,
                                    Σ
                                    ,
                                    Υ
                                    ,
                                    ϕ
                                    ,
                                    φ
                                    )
                                 
                                 =
                                 
                                    
                                       
                                          ‖
                                          X
                                          −
                                          U
                                          V
                                          ‖
                                       
                                    
                                    
                                       2
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 a
                                 ε
                                 −
                                 b
                                 ζ
                                 +
                                 
                                    
                                       ∑
                                    
                                    
                                       
                                          (
                                          i
                                          ,
                                          j
                                          )
                                       
                                       ∈
                                       W
                                    
                                 
                                 
                                    
                                       λ
                                    
                                    
                                       i
                                       j
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             ‖
                                             
                                                
                                                   
                                                      v
                                                   
                                                
                                                
                                                   i
                                                
                                             
                                             −
                                             
                                                
                                                   
                                                      v
                                                   
                                                
                                                
                                                   j
                                                
                                             
                                             ‖
                                          
                                       
                                       
                                          2
                                       
                                       
                                          2
                                       
                                    
                                    −
                                    ε
                                    )
                                 
                                 −
                                 
                                    
                                       ∑
                                    
                                    
                                       
                                          (
                                          i
                                          ,
                                          j
                                          )
                                       
                                       ∈
                                       B
                                    
                                 
                                 
                                    
                                       ξ
                                    
                                    
                                       i
                                       j
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             ‖
                                             
                                                
                                                   
                                                      v
                                                   
                                                
                                                
                                                   i
                                                
                                             
                                             −
                                             
                                                
                                                   
                                                      v
                                                   
                                                
                                                
                                                   j
                                                
                                             
                                             ‖
                                          
                                       
                                       
                                          2
                                       
                                       
                                          2
                                       
                                    
                                    −
                                    ζ
                                    )
                                 
                                 −
                                 T
                                 r
                                 
                                    (
                                    Σ
                                    
                                       
                                          U
                                       
                                       
                                          ⊤
                                       
                                    
                                    )
                                 
                                 −
                                 T
                                 r
                                 
                                    (
                                    Υ
                                    
                                       
                                          V
                                       
                                       
                                          ⊤
                                       
                                    
                                    )
                                 
                                 −
                                 ϕ
                                 ε
                                 −
                                 φ
                                 ζ
                                 ,
                              
                           
                         where 
                           
                              
                                 λ
                              
                              
                                 i
                                 j
                              
                           
                           ≥
                           0
                         is the Lagrange multiplier for the constrain 
                           
                              
                                 
                                    ‖
                                    
                                       
                                          
                                             v
                                          
                                       
                                       
                                          i
                                       
                                    
                                    −
                                    
                                       
                                          
                                             v
                                          
                                       
                                       
                                          j
                                       
                                    
                                    ‖
                                 
                              
                              
                                 2
                              
                              
                                 2
                              
                           
                           ≤
                           ε
                           ,
                           
                              
                                 ξ
                              
                              
                                 i
                                 j
                              
                           
                           ≥
                           0
                         is the Lagrange multiplier for the constrain 
                           
                              
                                 
                                    ‖
                                    
                                       
                                          
                                             v
                                          
                                       
                                       
                                          i
                                       
                                    
                                    −
                                    
                                       
                                          
                                             v
                                          
                                       
                                       
                                          j
                                       
                                    
                                    ‖
                                 
                              
                              
                                 2
                              
                              
                                 2
                              
                           
                           ≥
                           ζ
                           ,
                           Σ
                           ∈
                           
                              
                                 R
                              
                              
                                 +
                              
                              
                                 d
                                 ×
                                 m
                              
                           
                         is the Lagrange multiplier matrix for 
                           U
                           ≥
                           0
                        , 
                           Υ
                           ∈
                           
                              
                                 R
                              
                              
                                 +
                              
                              
                                 m
                                 ×
                                 n
                              
                           
                         is the Lagrange multiplier matrix for 
                           V
                           ≥
                           0
                           ,
                           ϕ
                           ≥
                           0
                         is the Lagrange multiplier for 
                           ε
                           ≥
                           0
                        , and 
                           φ
                           ≥
                           0
                         is the Lagrange multiplier for 
                           ζ
                           ≥
                           0
                        . According to the duality theory of optimization (Dentcheva & Ruszczyski, 2004; Diewert, 1974; Wu, 2010), the optimal solution could be achieved by solving the following problem,
                           
                              (10)
                              
                                 
                                    
                                       
                                          
                                             
                                                max
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            λ
                                                         
                                                         
                                                            i
                                                            j
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            ξ
                                                         
                                                         
                                                            i
                                                            j
                                                         
                                                      
                                                      ,
                                                   
                                                   
                                                      Σ
                                                      ,
                                                      Υ
                                                      ,
                                                      ϕ
                                                      ,
                                                      φ
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                min
                                             
                                             
                                                U
                                                ,
                                                V
                                                ,
                                                ε
                                                ,
                                                ζ
                                             
                                          
                                       
                                       
                                          L
                                          
                                             (
                                             U
                                             ,
                                             V
                                             ,
                                             ε
                                             ,
                                             ζ
                                             ,
                                             
                                                
                                                   λ
                                                
                                                
                                                   i
                                                   j
                                                
                                             
                                             ,
                                             
                                                
                                                   ξ
                                                
                                                
                                                   i
                                                   j
                                                
                                             
                                             ,
                                             Σ
                                             ,
                                             Υ
                                             ,
                                             ϕ
                                             ,
                                             φ
                                             )
                                          
                                       
                                    
                                    
                                       
                                       
                                          s.t.
                                       
                                       
                                          
                                             
                                                λ
                                             
                                             
                                                i
                                                j
                                             
                                          
                                          ≥
                                          0
                                          ,
                                          
                                          ∀
                                          
                                             (
                                             i
                                             ,
                                             j
                                             )
                                          
                                          ∈
                                          W
                                          ,
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                                ξ
                                             
                                             
                                                i
                                                j
                                             
                                          
                                          ≥
                                          0
                                          ,
                                          
                                          ∀
                                          
                                             (
                                             i
                                             ,
                                             j
                                             )
                                          
                                          ∈
                                          B
                                          ,
                                       
                                    
                                    
                                       
                                       
                                       
                                          Σ
                                          ≥
                                          0
                                          ,
                                          
                                          Υ
                                          ≥
                                          0
                                          ,
                                          
                                          ϕ
                                          ≥
                                          0
                                          ,
                                          
                                          φ
                                          ≥
                                          0
                                          .
                                       
                                    
                                 
                              
                           
                         By substituting (9) to (10), we obtain the following problem, 
                           
                              (11)
                              
                                 
                                    
                                       
                                          
                                             
                                                max
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            λ
                                                         
                                                         
                                                            i
                                                            j
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            ξ
                                                         
                                                         
                                                            i
                                                            j
                                                         
                                                      
                                                      ,
                                                   
                                                   
                                                      Σ
                                                      ,
                                                      Υ
                                                      ,
                                                      ϕ
                                                      ,
                                                      φ
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                min
                                             
                                             
                                                U
                                                ,
                                                V
                                                ,
                                                ε
                                                ,
                                                ζ
                                             
                                          
                                       
                                       
                                          
                                             {
                                             
                                                
                                                   
                                                      ‖
                                                      X
                                                      −
                                                      U
                                                      V
                                                      ‖
                                                   
                                                
                                                
                                                   2
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             a
                                             ε
                                             −
                                             b
                                             ζ
                                             +
                                             
                                                
                                                   ∑
                                                
                                                
                                                   
                                                      (
                                                      i
                                                      ,
                                                      j
                                                      )
                                                   
                                                   ∈
                                                   W
                                                
                                             
                                             
                                                
                                                   λ
                                                
                                                
                                                   i
                                                   j
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             (
                                             
                                                
                                                   
                                                      ‖
                                                      
                                                         
                                                            
                                                               v
                                                            
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            
                                                               v
                                                            
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      ‖
                                                   
                                                
                                                
                                                   2
                                                
                                                
                                                   2
                                                
                                             
                                             −
                                             ε
                                             )
                                          
                                          −
                                          
                                             
                                                ∑
                                             
                                             
                                                
                                                   (
                                                   i
                                                   ,
                                                   j
                                                   )
                                                
                                                ∈
                                                B
                                             
                                          
                                          
                                             
                                                ξ
                                             
                                             
                                                i
                                                j
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   
                                                      ‖
                                                      
                                                         
                                                            
                                                               v
                                                            
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            
                                                               v
                                                            
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      ‖
                                                   
                                                
                                                
                                                   2
                                                
                                                
                                                   2
                                                
                                             
                                             −
                                             ζ
                                             )
                                          
                                       
                                       
                                       
                                          −
                                          
                                             T
                                             r
                                             
                                                (
                                                Σ
                                                
                                                   
                                                      U
                                                   
                                                   
                                                      ⊤
                                                   
                                                
                                                )
                                             
                                             −
                                             T
                                             r
                                             
                                                (
                                                Υ
                                                
                                                   
                                                      V
                                                   
                                                   
                                                      ⊤
                                                   
                                                
                                                )
                                             
                                             −
                                             ϕ
                                             ε
                                             −
                                             φ
                                             ζ
                                             }
                                          
                                       
                                    
                                    
                                       
                                       
                                          s.t.
                                       
                                       
                                          
                                             
                                                λ
                                             
                                             
                                                i
                                                j
                                             
                                          
                                          ≥
                                          0
                                          ,
                                          
                                          ∀
                                          
                                             (
                                             i
                                             ,
                                             j
                                             )
                                          
                                          ∈
                                          W
                                          ,
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                                ξ
                                             
                                             
                                                i
                                                j
                                             
                                          
                                          ≥
                                          0
                                          ,
                                          
                                          ∀
                                          
                                             (
                                             i
                                             ,
                                             j
                                             )
                                          
                                          ∈
                                          B
                                          ,
                                       
                                    
                                    
                                       
                                       
                                       
                                          Σ
                                          ≥
                                          0
                                          ,
                                          
                                          Υ
                                          ≥
                                          0
                                          ,
                                          
                                          ϕ
                                          ≥
                                          0
                                          ,
                                          
                                          φ
                                          ≥
                                          0
                                          .
                                       
                                    
                                 
                              
                           
                         This problem is difficult to optimize directly. Instead of solving it with regard to all the variables simultaneously, we adopt an alternate optimization strategy (Lootsma, 1994). The NMF factorization matrices 
                           U
                         and 
                           V
                        , slack variables 
                           ϵ
                         and 
                           ζ
                        , and the Lagrange multipliers 
                           
                              
                                 λ
                              
                              
                                 i
                                 j
                              
                           
                         and 
                           
                              
                                 ξ
                              
                              
                                 i
                                 j
                              
                           
                         are updated alternatively in an iterative algorithm. When some variables are optimized, others remain fixed.

By fixing other variables and removing the terms irrelevant to 
                              U
                            or 
                              V
                            and their Lagrange multipliers, the optimization problem in (11) is reduced to 
                              
                                 (12)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   max
                                                
                                                
                                                   Σ
                                                   ,
                                                   Υ
                                                
                                             
                                          
                                          
                                             
                                                
                                                   min
                                                
                                                
                                                   U
                                                   ,
                                                   V
                                                
                                             
                                          
                                          
                                             
                                                {
                                                
                                                   
                                                      
                                                         ‖
                                                         X
                                                         −
                                                         U
                                                         V
                                                         ‖
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                   
                                                      2
                                                   
                                                
                                                +
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      
                                                         (
                                                         i
                                                         ,
                                                         j
                                                         )
                                                      
                                                      ∈
                                                      W
                                                   
                                                
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      i
                                                      j
                                                   
                                                
                                                
                                                   
                                                      
                                                         ‖
                                                         
                                                            
                                                               
                                                                  v
                                                               
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         −
                                                         
                                                            
                                                               
                                                                  v
                                                               
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                         ‖
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                U
                                                V
                                             
                                             −
                                             
                                                
                                                   ∑
                                                
                                                
                                                   
                                                      (
                                                      i
                                                      ,
                                                      j
                                                      )
                                                   
                                                   ∈
                                                   B
                                                
                                             
                                             
                                                
                                                   ξ
                                                
                                                
                                                   i
                                                   j
                                                
                                             
                                             
                                                
                                                   
                                                      ‖
                                                      
                                                         
                                                            
                                                               v
                                                            
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            
                                                               v
                                                            
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      ‖
                                                   
                                                
                                                
                                                   2
                                                
                                                
                                                   2
                                                
                                             
                                             −
                                             T
                                             r
                                             
                                                (
                                                Σ
                                                
                                                   
                                                      U
                                                   
                                                   
                                                      ⊤
                                                   
                                                
                                                )
                                             
                                             −
                                             T
                                             r
                                             
                                                (
                                                Υ
                                                
                                                   
                                                      V
                                                   
                                                   
                                                      ⊤
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             =
                                             T
                                             r
                                             
                                                (
                                                X
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      ⊤
                                                   
                                                
                                                )
                                             
                                             −
                                             2
                                             T
                                             r
                                             
                                                (
                                                X
                                                
                                                   
                                                      V
                                                   
                                                   
                                                      ⊤
                                                   
                                                
                                                
                                                   
                                                      U
                                                   
                                                   
                                                      ⊤
                                                   
                                                
                                                )
                                             
                                             +
                                             T
                                             r
                                             
                                                (
                                                U
                                                V
                                                
                                                   
                                                      V
                                                   
                                                   
                                                      ⊤
                                                   
                                                
                                                
                                                   
                                                      U
                                                   
                                                   
                                                      ⊤
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                U
                                                V
                                             
                                             +
                                             2
                                             T
                                             r
                                             
                                                (
                                                V
                                                
                                                   (
                                                   D
                                                   −
                                                   Λ
                                                   )
                                                
                                                
                                                   
                                                      V
                                                   
                                                   
                                                      ⊤
                                                   
                                                
                                                )
                                             
                                             −
                                             2
                                             T
                                             r
                                             
                                                (
                                                V
                                                
                                                   (
                                                   E
                                                   −
                                                   Ξ
                                                   )
                                                
                                                
                                                   
                                                      V
                                                   
                                                   
                                                      ⊤
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                U
                                                V
                                             
                                             −
                                             
                                                T
                                                r
                                                
                                                   (
                                                   Σ
                                                   
                                                      
                                                         U
                                                      
                                                      
                                                         ⊤
                                                      
                                                   
                                                   )
                                                
                                                −
                                                T
                                                r
                                                
                                                   (
                                                   Υ
                                                   
                                                      
                                                         V
                                                      
                                                      
                                                         ⊤
                                                      
                                                   
                                                   )
                                                
                                                }
                                             
                                          
                                       
                                       
                                          
                                          
                                             s.t.
                                          
                                          
                                             Σ
                                             ≥
                                             0
                                             ,
                                             
                                             Υ
                                             ≥
                                             0
                                             .
                                          
                                       
                                    
                                 
                              
                            where 
                              Λ
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    +
                                 
                                 
                                    n
                                    ×
                                    n
                                 
                              
                            and 
                              Ξ
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    +
                                 
                                 
                                    n
                                    ×
                                    n
                                 
                              
                            with 
                              
                                 (13)
                                 
                                    
                                       
                                          Λ
                                       
                                       
                                          i
                                          j
                                       
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      i
                                                      j
                                                   
                                                
                                                ,
                                             
                                             
                                                if  
                                                
                                                   (
                                                   i
                                                   ,
                                                   j
                                                   )
                                                
                                                ∈
                                                W
                                             
                                          
                                          
                                             
                                                0
                                                ,
                                             
                                             
                                                otherwise,
                                             
                                          
                                       
                                    
                                    
                                    
                                       
                                          Ξ
                                       
                                       
                                          i
                                          j
                                       
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   
                                                      ξ
                                                   
                                                   
                                                      i
                                                      j
                                                   
                                                
                                                ,
                                             
                                             
                                                if  
                                                
                                                   (
                                                   i
                                                   ,
                                                   j
                                                   )
                                                
                                                ∈
                                                B
                                             
                                          
                                          
                                             
                                                0
                                                ,
                                             
                                             
                                                otherwise
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              D
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    +
                                 
                                 
                                    n
                                    ×
                                    n
                                 
                              
                            is a diagonal matrix whose entries are column sums of 
                              Λ
                              ,
                              
                                 
                                    D
                                 
                                 
                                    i
                                    i
                                 
                              
                              =
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    Λ
                                 
                                 
                                    i
                                    j
                                 
                              
                           , and 
                              E
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    +
                                 
                                 
                                    n
                                    ×
                                    n
                                 
                              
                            is a diagonal matrix whose entries are column sums of 
                              Ξ
                              ,
                              
                                 
                                    E
                                 
                                 
                                    i
                                    i
                                 
                              
                              =
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    Ξ
                                 
                                 
                                    i
                                    j
                                 
                              
                           . To solve this problem, we set the partial derivatives of the objective function in (12) with respect to 
                              U
                            and 
                              V
                            to zero, and we have 
                              
                                 (14)
                                 
                                    
                                       −
                                       2
                                       X
                                       
                                          
                                             V
                                          
                                          
                                             ⊤
                                          
                                       
                                       +
                                       2
                                       U
                                       V
                                       
                                          
                                             V
                                          
                                          
                                             ⊤
                                          
                                       
                                       −
                                       Σ
                                       =
                                       0
                                    
                                 
                                 
                                    
                                       −
                                       2
                                       
                                          
                                             U
                                          
                                          
                                             ⊤
                                          
                                       
                                       X
                                       +
                                       2
                                       
                                          
                                             U
                                          
                                          
                                             ⊤
                                          
                                       
                                       U
                                       V
                                       +
                                       2
                                       V
                                       
                                          (
                                          D
                                          −
                                          Λ
                                          )
                                       
                                       −
                                       2
                                       V
                                       
                                          (
                                          E
                                          −
                                          Ξ
                                          )
                                       
                                       −
                                       Υ
                                       =
                                       0
                                       .
                                    
                                 
                              
                            Using the KKT (Bach, Lanckriet, & Jordan, 2004) conditions 
                              
                                 [
                                 Σ
                                 ]
                              
                              ∘
                              
                                 [
                                 U
                                 ]
                              
                              =
                              0
                            and 
                              
                                 [
                                 Υ
                                 ]
                              
                              ∘
                              
                                 [
                                 V
                                 ]
                              
                              =
                              0
                           , where 
                              
                                 [
                                 
                                 ]
                              
                              ∘
                              
                                 [
                                 
                                 ]
                              
                            denotes the element-wise product between two matrices, we get the following equations for 
                              U
                            and 
                              V
                           : 
                              
                                 (15)
                                 
                                    
                                       −
                                       
                                          [
                                          X
                                          
                                             
                                                V
                                             
                                             
                                                ⊤
                                             
                                          
                                          ]
                                       
                                       ∘
                                       
                                          [
                                          U
                                          ]
                                       
                                       +
                                       
                                          [
                                          U
                                          V
                                          
                                             
                                                V
                                             
                                             
                                                ⊤
                                             
                                          
                                          ]
                                       
                                       ∘
                                       
                                          [
                                          U
                                          ]
                                       
                                       =
                                       0
                                    
                                 
                                 
                                    
                                       −
                                       
                                          [
                                          
                                             
                                                U
                                             
                                             
                                                ⊤
                                             
                                          
                                          X
                                          ]
                                       
                                       ∘
                                       
                                          [
                                          V
                                          ]
                                       
                                       +
                                       
                                          [
                                          
                                             
                                                U
                                             
                                             
                                                ⊤
                                             
                                          
                                          U
                                          V
                                          ]
                                       
                                       ∘
                                       
                                          [
                                          V
                                          ]
                                       
                                       +
                                       
                                          [
                                          V
                                          
                                             (
                                             D
                                             −
                                             Λ
                                             )
                                          
                                          ]
                                       
                                       ∘
                                       
                                          [
                                          V
                                          ]
                                       
                                       −
                                       
                                          [
                                          V
                                          
                                             (
                                             E
                                             −
                                             Ξ
                                             )
                                          
                                          ]
                                       
                                       ∘
                                       
                                          [
                                          V
                                          ]
                                       
                                       =
                                       0
                                    
                                 
                              
                            which lead to the following updating rules: 
                              
                                 (16)
                                 
                                    
                                       U
                                       ←
                                       
                                          
                                             
                                                [
                                                X
                                                
                                                   
                                                      V
                                                   
                                                   
                                                      ⊤
                                                   
                                                
                                                ]
                                             
                                          
                                          
                                             
                                                [
                                                U
                                                V
                                                
                                                   
                                                      V
                                                   
                                                   
                                                      ⊤
                                                   
                                                
                                                ]
                                             
                                          
                                       
                                       ∘
                                       
                                          [
                                          U
                                          ]
                                       
                                       ,
                                    
                                 
                                 
                                    
                                       V
                                       ←
                                       
                                          
                                             
                                                [
                                                
                                                   
                                                      U
                                                   
                                                   
                                                      ⊤
                                                   
                                                
                                                X
                                                +
                                                V
                                                Λ
                                                +
                                                V
                                                E
                                                ]
                                             
                                          
                                          
                                             
                                                [
                                                
                                                   
                                                      U
                                                   
                                                   
                                                      ⊤
                                                   
                                                
                                                U
                                                V
                                                +
                                                V
                                                D
                                                +
                                                V
                                                Ξ
                                                ]
                                             
                                          
                                       
                                       ∘
                                       
                                          [
                                          V
                                          ]
                                       
                                       ,
                                    
                                 
                              
                            where 
                              
                                 
                                    
                                       [
                                       
                                       ]
                                    
                                 
                                 
                                    
                                       [
                                       
                                       ]
                                    
                                 
                              
                            is the element-wise matrix division operator. Please note that the inverse of the current update term for 
                              U
                            and 
                              V
                            can also be used as 
                              U
                              ←
                              
                                 
                                    
                                       [
                                       U
                                       V
                                       
                                          
                                             V
                                          
                                          
                                             ⊤
                                          
                                       
                                       ]
                                    
                                 
                                 
                                    
                                       [
                                       X
                                       
                                          
                                             V
                                          
                                          
                                             ⊤
                                          
                                       
                                       ]
                                    
                                 
                              
                              ∘
                              
                                 [
                                 U
                                 ]
                              
                            and 
                              V
                              ←
                              
                                 
                                    
                                       [
                                       
                                          
                                             U
                                          
                                          
                                             ⊤
                                          
                                       
                                       U
                                       V
                                       +
                                       V
                                       D
                                       +
                                       V
                                       Ξ
                                       ]
                                    
                                 
                                 
                                    
                                       [
                                       
                                          
                                             U
                                          
                                          
                                             ⊤
                                          
                                       
                                       X
                                       +
                                       V
                                       Λ
                                       +
                                       V
                                       E
                                       ]
                                    
                                 
                              
                              ∘
                              
                                 [
                                 V
                                 ]
                              
                           . The inverse update rules are dual for (16), and the similar results can be obtained by using inverse update rules, as is shown in our previous study (Wang et al., 2013). Also, we note that the same update rule can be derived by dividing the negative part of the gradient to its positive part, as commonly used in NMF. However, the updating rules are not the focuses of this study and we use a simple way to update both 
                              U
                            and 
                              V
                           .

By removing terms irrelevant to 
                              ε
                            and 
                              ζ
                            and fixing all other variables, we have the following optimization problem with regard to only 
                              ε
                            and 
                              ζ
                           : 
                              
                                 (17)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   max
                                                
                                                
                                                   ϕ
                                                   ,
                                                   φ
                                                
                                             
                                          
                                          
                                             
                                                
                                                   min
                                                
                                                
                                                   ε
                                                   ,
                                                   ζ
                                                
                                             
                                          
                                          
                                             
                                                {
                                                a
                                                ε
                                                −
                                                b
                                                ζ
                                                −
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      
                                                         (
                                                         i
                                                         ,
                                                         j
                                                         )
                                                      
                                                      ∈
                                                      W
                                                   
                                                
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      i
                                                      j
                                                   
                                                
                                                ε
                                                +
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      
                                                         (
                                                         i
                                                         ,
                                                         j
                                                         )
                                                      
                                                      ∈
                                                      B
                                                   
                                                
                                                
                                                   
                                                      ξ
                                                   
                                                   
                                                      i
                                                      j
                                                   
                                                
                                                ζ
                                                −
                                                ϕ
                                                ε
                                                −
                                                φ
                                                ζ
                                                }
                                             
                                          
                                       
                                       
                                          
                                          
                                             s.t.
                                          
                                          
                                             ϕ
                                             ≥
                                             0
                                             ,
                                             
                                             φ
                                             ≥
                                             0
                                             .
                                          
                                       
                                    
                                 
                              
                            By setting the partial derivatives of the objective function in (17) with respect to 
                              ε
                            and 
                              ζ
                            to zero, we have 
                              
                                 (18)
                                 
                                    
                                       a
                                       −
                                       
                                          
                                             ∑
                                          
                                          
                                             
                                                (
                                                i
                                                ,
                                                j
                                                )
                                             
                                             ∈
                                             W
                                          
                                       
                                       
                                          
                                             λ
                                          
                                          
                                             i
                                             j
                                          
                                       
                                       −
                                       ϕ
                                       =
                                       0
                                    
                                 
                                 
                                    
                                       −
                                       b
                                       +
                                       
                                          
                                             ∑
                                          
                                          
                                             
                                                (
                                                i
                                                ,
                                                j
                                                )
                                             
                                             ∈
                                             B
                                          
                                       
                                       
                                          
                                             ξ
                                          
                                          
                                             i
                                             j
                                          
                                       
                                       −
                                       φ
                                       =
                                       0
                                       .
                                    
                                 
                              
                            Using the KKT conditions 
                              ϕ
                              ε
                              =
                              0
                            and 
                              φ
                              ζ
                              =
                              0
                           , we get the following equations for 
                              ε
                            and 
                              ζ
                           : 
                              
                                 (19)
                                 
                                    
                                       a
                                       ε
                                       −
                                       
                                          (
                                          
                                             
                                                ∑
                                             
                                             
                                                
                                                   (
                                                   i
                                                   ,
                                                   j
                                                   )
                                                
                                                ∈
                                                W
                                             
                                          
                                          
                                             
                                                λ
                                             
                                             
                                                i
                                                j
                                             
                                          
                                          )
                                       
                                       ε
                                       =
                                       0
                                       ,
                                    
                                 
                                 
                                    
                                       −
                                       b
                                       ζ
                                       +
                                       
                                          (
                                          
                                             
                                                ∑
                                             
                                             
                                                
                                                   (
                                                   i
                                                   ,
                                                   j
                                                   )
                                                
                                                ∈
                                                B
                                             
                                          
                                          
                                             
                                                ξ
                                             
                                             
                                                i
                                                j
                                             
                                          
                                          )
                                       
                                       ζ
                                       =
                                       0
                                       ,
                                    
                                 
                              
                            which lead to the following updating rules: 
                              
                                 (20)
                                 
                                    
                                       ε
                                       ←
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      
                                                         (
                                                         i
                                                         ,
                                                         j
                                                         )
                                                      
                                                      ∈
                                                      W
                                                   
                                                
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      i
                                                      j
                                                   
                                                
                                                )
                                             
                                          
                                          
                                             a
                                          
                                       
                                       ε
                                       ,
                                    
                                 
                                 
                                    
                                       ζ
                                       ←
                                       
                                          
                                             b
                                          
                                          
                                             
                                                (
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      
                                                         (
                                                         i
                                                         ,
                                                         j
                                                         )
                                                      
                                                      ∈
                                                      B
                                                   
                                                
                                                
                                                   
                                                      ξ
                                                   
                                                   
                                                      i
                                                      j
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       ζ
                                       .
                                    
                                 
                              
                           
                        

Based on (18), we have the following constrains for 
                              
                                 
                                    λ
                                 
                                 
                                    i
                                    j
                                 
                              
                            and 
                              
                                 
                                    ξ
                                 
                                 
                                    i
                                    j
                                 
                              
                           , 
                              
                                 (21)
                                 
                                    
                                       ϕ
                                       =
                                       a
                                       −
                                       
                                          
                                             ∑
                                          
                                          
                                             
                                                (
                                                i
                                                ,
                                                j
                                                )
                                             
                                             ∈
                                             W
                                          
                                       
                                       
                                          
                                             λ
                                          
                                          
                                             i
                                             j
                                          
                                       
                                       ≥
                                       0
                                       
                                       ⇒
                                       
                                       
                                          
                                             ∑
                                          
                                          
                                             
                                                (
                                                i
                                                ,
                                                j
                                                )
                                             
                                             ∈
                                             W
                                          
                                       
                                       
                                          
                                             λ
                                          
                                          
                                             i
                                             j
                                          
                                       
                                       ≤
                                       a
                                       ,
                                    
                                 
                                 
                                    
                                       φ
                                       =
                                       −
                                       b
                                       +
                                       
                                          
                                             ∑
                                          
                                          
                                             
                                                (
                                                i
                                                ,
                                                j
                                                )
                                             
                                             ∈
                                             B
                                          
                                       
                                       
                                          
                                             ξ
                                          
                                          
                                             i
                                             j
                                          
                                       
                                       ≥
                                       0
                                       
                                       ⇒
                                       
                                       
                                          
                                             ∑
                                          
                                          
                                             
                                                (
                                                i
                                                ,
                                                j
                                                )
                                             
                                             ∈
                                             B
                                          
                                       
                                       
                                          
                                             ξ
                                          
                                          
                                             i
                                             j
                                          
                                       
                                       ≥
                                       b
                                       .
                                    
                                 
                              
                            By considering these constraints, fixing other variables and removing terms irrelevant to 
                              
                                 
                                    λ
                                 
                                 
                                    i
                                    j
                                 
                              
                            and 
                              
                                 
                                    ξ
                                 
                                 
                                    i
                                    j
                                 
                              
                            from (10), we have the following problem with regard to 
                              
                                 
                                    λ
                                 
                                 
                                    i
                                    j
                                 
                              
                            and 
                              
                                 
                                    ξ
                                 
                                 
                                    i
                                    j
                                 
                              
                           ,
                              
                                 (22)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   max
                                                
                                                
                                                   
                                                      
                                                         λ
                                                      
                                                      
                                                         i
                                                         j
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         ξ
                                                      
                                                      
                                                         i
                                                         j
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                {
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      
                                                         (
                                                         i
                                                         ,
                                                         j
                                                         )
                                                      
                                                      ∈
                                                      W
                                                   
                                                
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      i
                                                      j
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            ‖
                                                            
                                                               
                                                                  
                                                                     v
                                                                  
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            −
                                                            
                                                               
                                                                  
                                                                     v
                                                                  
                                                               
                                                               
                                                                  j
                                                               
                                                            
                                                            ‖
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   −
                                                   ε
                                                   )
                                                
                                                −
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      
                                                         (
                                                         i
                                                         ,
                                                         j
                                                         )
                                                      
                                                      ∈
                                                      B
                                                   
                                                
                                                
                                                   
                                                      ξ
                                                   
                                                   
                                                      i
                                                      j
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            ‖
                                                            
                                                               
                                                                  
                                                                     v
                                                                  
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            −
                                                            
                                                               
                                                                  
                                                                     v
                                                                  
                                                               
                                                               
                                                                  j
                                                               
                                                            
                                                            ‖
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   −
                                                   ζ
                                                   )
                                                
                                                }
                                             
                                          
                                       
                                       
                                          
                                             s.t.
                                          
                                          
                                             
                                                
                                                   λ
                                                
                                                
                                                   i
                                                   j
                                                
                                             
                                             ≥
                                             0
                                             ,
                                             
                                             ∀
                                             
                                                (
                                                i
                                                ,
                                                j
                                                )
                                             
                                             ∈
                                             W
                                             ,
                                             
                                             
                                                
                                                   ξ
                                                
                                                
                                                   i
                                                   j
                                                
                                             
                                             ≥
                                             0
                                             ,
                                             
                                             ∀
                                             
                                                (
                                                i
                                                ,
                                                j
                                                )
                                             
                                             ∈
                                             B
                                             ,
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   
                                                      (
                                                      i
                                                      ,
                                                      j
                                                      )
                                                   
                                                   ∈
                                                   W
                                                
                                             
                                             
                                                
                                                   λ
                                                
                                                
                                                   i
                                                   j
                                                
                                             
                                             ≤
                                             a
                                             ,
                                             
                                             
                                                
                                                   ∑
                                                
                                                
                                                   
                                                      (
                                                      i
                                                      ,
                                                      j
                                                      )
                                                   
                                                   ∈
                                                   B
                                                
                                             
                                             
                                                
                                                   ξ
                                                
                                                
                                                   i
                                                   j
                                                
                                             
                                             ≥
                                             b
                                             .
                                          
                                       
                                    
                                 
                              
                            This problem can be solved as a linear programming (LP) problem.

With these optimization results, we can design an iterative algorithm for MMDNMF. It is summarized in Algorithm 1. It could be seen that in each iteration, the basis and coefficient matrices, slack variables and Lagrange multipliers are updated alternately, until 
                           T
                         iterations are reached. We should note that with regard to the order of the update rules in Algorithm 1, if we consider a possible good initialization, there is not any preference for the current order.


                        
                           
                              
                           
                        
                     

When a new test sample with its nonnegative feature vector 
                           
                              x
                           
                           ∈
                           
                              
                                 R
                              
                              
                                 +
                              
                              
                                 d
                              
                           
                         comes, we also use the basis matrix 
                           U
                         learned from the training set to represent and classify it. We first assume that it belongs to a class 
                           y
                           ∈
                           Y
                        . We denote the set of training samples of class 
                           y
                         as 
                           
                              
                                 X
                              
                              
                                 y
                              
                           
                           =
                           
                              {
                              
                                 
                                    
                                       x
                                    
                                 
                                 
                                    i
                                 
                              
                              |
                              
                                 
                                    y
                                 
                                 
                                    i
                                 
                              
                              =
                              y
                              ,
                              
                                 
                                    
                                       x
                                    
                                 
                                 
                                    i
                                 
                              
                              ∈
                              X
                              }
                           
                        , and the set training samples from other classes as 
                           
                              
                                 X
                              
                              
                                 
                                    
                                       y
                                    
                                    ¯
                                 
                              
                           
                           =
                           
                              {
                              
                                 
                                    
                                       x
                                    
                                 
                                 
                                    i
                                 
                              
                              |
                              
                                 
                                    y
                                 
                                 
                                    i
                                 
                              
                              ≠
                              y
                              ,
                              
                                 
                                    
                                       x
                                    
                                 
                                 
                                    i
                                 
                              
                              ∈
                              X
                              }
                           
                        . Then, to represent the test sample 
                           
                              x
                           
                        , we also try to approximate it as a nonnegative linear combination of the basis vectors in the basis matrix 
                           U
                        , and the coefficient vector 
                           
                              v
                           
                           ∈
                           
                              
                                 R
                              
                              
                                 m
                              
                           
                         could be used as the new representation. At the same time, to verify if the test sample 
                           
                              x
                           
                         really belongs to class 
                           y
                         or not, we also minimize the maximum distance between the test sample and the training samples in 
                           
                              
                                 X
                              
                              
                                 y
                              
                           
                        , meanwhile maximize the minimum distance between the test sample and the training samples in 
                           
                              
                                 X
                              
                              
                                 
                                    
                                       y
                                    
                                    ¯
                                 
                              
                           
                        . The problem is formulated as 
                           
                              (23)
                              
                                 
                                    
                                       
                                          
                                             
                                                ϵ
                                             
                                             
                                                y
                                             
                                          
                                          =
                                          
                                             
                                                min
                                             
                                             
                                                
                                                   v
                                                
                                             
                                          
                                       
                                       
                                          
                                             {
                                             
                                                
                                                   
                                                      ‖
                                                      
                                                         x
                                                      
                                                      −
                                                      U
                                                      
                                                         v
                                                      
                                                      ‖
                                                   
                                                
                                                
                                                   2
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             a
                                             
                                                
                                                   max
                                                
                                                
                                                   i
                                                   ∈
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         y
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ‖
                                                      
                                                         v
                                                      
                                                      −
                                                      
                                                         
                                                            
                                                               v
                                                            
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      ‖
                                                   
                                                
                                                
                                                   2
                                                
                                                
                                                   2
                                                
                                             
                                             −
                                             b
                                             
                                                
                                                   min
                                                
                                                
                                                   i
                                                   ∈
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         
                                                            
                                                               y
                                                            
                                                            ¯
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ‖
                                                      
                                                         v
                                                      
                                                      −
                                                      
                                                         
                                                            
                                                               v
                                                            
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      ‖
                                                   
                                                
                                                
                                                   2
                                                
                                                
                                                   2
                                                
                                             
                                             }
                                          
                                       
                                    
                                    
                                       
                                          s.t  
                                       
                                       
                                          
                                             v
                                          
                                          ≥
                                          0
                                          .
                                       
                                    
                                 
                              
                           
                         This problem is optimized using a similar strategy as in the training procedure. 
                           
                              
                                 ϵ
                              
                              
                                 y
                              
                           
                         is the optimization residues of assigning 
                           
                              x
                           
                         to class 
                           y
                        . Then the test sample is assigned to the class with the smallest residues: 
                           
                              (24)
                              
                                 
                                    
                                       y
                                    
                                    
                                       ∗
                                    
                                 
                                 =
                                 
                                    
                                       arg
                                       min
                                    
                                    
                                       y
                                       ∈
                                       Y
                                    
                                 
                                 
                                 
                                    
                                       ϵ
                                    
                                    
                                       y
                                    
                                 
                                 .
                              
                           
                        
                     

@&#EXPERIMENTS@&#

In this section, the proposed NMF algorithm is evaluated on two different pattern classification problems as the representation and classification method. Moreover, to illuminate the generated features, we also apply the proposed algorithm on a standard image data set.

Bacterial type IVB secreted effector proteins play a critical role in interactions between bacteria and host. Thus it is very important to predict the type IVB secreted effector proteins (Zou, Nan, & Hu, 2013). In this experiment, we evaluate the proposed algorithm as a feature representation method on the problem of type IV secreted effector prediction.

In this experiment we used a data set of proteins, and each protein is a data sample. The prediction problem is to determine whether a given protein is a bacterial type IVB secreted effector protein or a non-effector protein. Thus it is a binary classification problem. To conduct the experiment, we used a data set of 1433 protein samples. In this data set, there are 310 effector proteins and 1123 non-effector proteins. Most of these experiment-validated effector proteins were collected from the SecRet4 database (Zou, Nan, & Hu, 2013), while most non-effector proteins were collected from the study of Zou et al. (2013), Lifshitz et al. (2013) and UniProt (Schneider, Bairoch, Wu, & Apweiler, 2005). To extract the features from each protein sequence, four different types of distinctive features were calculated from primary protein sequences, including amino acid composition (AAC) (Chen, Chen, Zou, & Cai, 2009), dipeptide composition (DC) (Bhasin & Raghava, 2004), position specific scoring matrix (PSSM) composition (Ou, Chen, & Gromiha, 2010) and auto covariance transformation of PSSM (Liu, Geng, Zheng, Li, & Wang, 2012). These features were concatenated to form a feature vector for each protein. The dimensions of the feature vectors in this experiment are listed as follows: for each protein, we extracted a 20-dimensional vector to represent the AAC of 20 amino acids, a 400-dimensional vector to represent DC, a 400-dimensional composition feature vector to represent the original PSSM profiles, and a 200-dimensional feature vector to represent the auto covariance transformation of PSSM.

To conduct the experiment, we employed a ten-fold cross validation experiment protocol (Burman, 1989; Rojatkar, Chinchkhede, & Sarate, 2013; Wang & Qiao, 2014). The entire data set was split to ten folds randomly, and each of them was used as a test set in turn. The remaining nine folds were combined and used as a training set. The proposed learning algorithm was performed on the training set to learn a basis matrix 
                              U
                            and coefficient vectors of the training samples 
                              
                                 
                                    
                                       v
                                    
                                 
                                 
                                    i
                                 
                              
                              ,
                              i
                              =
                              1
                              ,
                              …
                              ,
                              n
                           . Then we used the learned basis matrix and coefficient vectors to represent and classify each test sample in the test set.

The experimental results were evaluated by the metrics of sensitivity, specificity (Altman & Bland, 1994; Chothe & Saxena, 2014), accuracy (Congalton, 1991; Xu, Hui, & Grannis, 2014), F1 score (Huang, Wang, & Abudureyimu, 2012; Prendiville, Pierce, & Buckley, 2010) and Matthew’s correlation coefficient (MCC). They are defined as follows, 
                              
                                 (25)
                                 
                                    
                                       sensitivity  
                                       =
                                       
                                          
                                             T
                                             P
                                          
                                          
                                             T
                                             P
                                             +
                                             F
                                             N
                                          
                                       
                                       ,
                                       
                                       specificity  
                                       =
                                       
                                          
                                             T
                                             N
                                          
                                          
                                             T
                                             N
                                             +
                                             F
                                             P
                                          
                                       
                                       ,
                                    
                                 
                                 
                                    
                                       accuracy  
                                       =
                                       
                                          
                                             T
                                             P
                                             +
                                             T
                                             N
                                          
                                          
                                             T
                                             P
                                             +
                                             F
                                             N
                                             +
                                             T
                                             N
                                             +
                                             F
                                             P
                                          
                                       
                                       ,
                                    
                                 
                                 
                                    
                                       F
                                       1
                                       =
                                       
                                          
                                             2
                                             ×
                                             T
                                             P
                                          
                                          
                                             2
                                             ×
                                             T
                                             P
                                             +
                                             F
                                             P
                                             +
                                             F
                                             N
                                          
                                       
                                       ,
                                    
                                 
                                 
                                    
                                       M
                                       C
                                       C
                                       =
                                       
                                          
                                             T
                                             P
                                             ×
                                             T
                                             N
                                             −
                                             F
                                             P
                                             ×
                                             F
                                             N
                                          
                                          
                                             
                                                
                                                   
                                                      (
                                                      T
                                                      P
                                                      +
                                                      F
                                                      P
                                                      )
                                                   
                                                   
                                                      (
                                                      T
                                                      P
                                                      +
                                                      F
                                                      N
                                                      )
                                                   
                                                   
                                                      (
                                                      T
                                                      N
                                                      +
                                                      F
                                                      P
                                                      )
                                                   
                                                   
                                                      (
                                                      T
                                                      N
                                                      +
                                                      F
                                                      N
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                       ,
                                    
                                 
                              
                            where 
                              T
                              P
                              ,
                              F
                              N
                              ,
                              T
                              N
                            and 
                              F
                              P
                            denote number of true positives, false negatives, true negatives and false positives respectively.

@&#RESULTS@&#

In this experiment, we compared the proposed MMDNMF method against several state-of-the-art supervised or semi-supervised NMF methods, including FNMF (Wang & Jia, 2004), SSNMF (Lee et al., 2010), and CNMF (Liu, Wu et al., 2012). These methods can also utilize class labels of samples effectively. SSNMF and CNMF are both semi-supervised NMF methods, but we used them as supervised methods by setting all the training samples as labeled samples. The parameters used for the state-of-the art methods in the experiments are given as follows: FNMF algorithm has two parameters, which are basis vector number and the weight of Fisher term of the objective function, SSNMF also has two parameters, including the number of basis vectors and the weight of term of class label prediction, and CNMF is parameter free. Since we applied the ten-fold cross validation to conduct the experiment, there were ten corresponding training sets, and these parameters were chosen by nine-fold cross validation within each training set, so that the parameter selection can be independent from the test set. For example, for the numbers of basis vectors of FNMF and SSNMF algorithms, we selected the optimal parameter values from a candidate parameter value pool containing values 3,5,10,20,50 and 100. Given a training set containing nine folds, we applied the algorithms with different parameter values from the pool on eight folds, and tested it on the remaining one fold. The procedure was repeated nine times using nine different folds as test fold, and the average accuracies were calculated. The parameter value which obtained the highest average accuracy was chosen. Please note that the chosen value of the same parameter may vary for different training sets. For example, for the FNMF algorithm, the basis vector numbers chosen by the ten training set are 5,10,20,100,10,50,5,10,20 and 10 respectively. The boxplots of various metrics of ten-fold cross validation are given in Fig. 1
                           . We can draw the following conclusions from this figure:
                              
                                 1.
                                 It could be easily seen that the proposed MMDNMF outperforms other NMF methods on various metrics, not only being measured by the median value, but also by the first and third quartiles. For example, with regard to the F1 score, only the median value of the F1 scores of MMDNMF is higher than 0.9, while those of all other methods are lower than 0.9. This is a strong evidence that applying max–min distance regularization to NMF can explore the class label information more effectively than other methods for the classification purpose.

It is also clear that the sensitivity of all methods is lower than their specificity, as shown in the first two subfigures of Fig. 1. It means that it is easier to classify a non-effector protein correctly than to classify an effector protein correctly. A possible reason is that there are much more non-effector proteins in the data set than the effector proteins.

Although there are some differences among CNMF, SSNMF and FNMF, the differences are not significant. A possible reason for this phenomenon is that all the three methods explore the discriminative information in a similar way, which weights the class labels of samples equally. For example, FNMF weights the between-class pairs and within-class pairs equally, CNMF forces the coefficient vectors of samples of the same class to be the same, while SSNMF weights the class label prediction errors of labeled samples equally. FNMF is slightly inferior to CNMF and SSNMF. It is based on the Fisher criterion, which also uses between-class and within-class distances metrics. However, unlike our MMDNMF which forces the minimum between-class distance to be maximized, and also forces the maximum within-class distance to be minimized, FNMF cannot guarantee that the coefficient vectors of samples can be discriminative enough. It indicates that the minimum between-class distance and the maximum within-class distance play critical roles in the representation problem. This conclusion is consistent to that of Bian and Tao (2011).

To put the obtained results into perspective, in this experiment, we also compared the results of the proposed MMDNMF to two state-of-the-art non-NMF-based classification approaches, nearest neighbor (NN) classifier and support vector machine (SVM). The boxplots of accuracies of ten-fold cross validation of MMDNMF, SVM and NN are given in Fig. 2
                           . From this figure, we can see that the proposed MMDNMF obtained the best results, SVM archived comparable performance, and NN did not obtain good classification results. This means the NMF-based classification methods have good capability for the considered pattern classification problem. A possible reason is that it not only has the capability of representing data, but also has the capability of classifying data. NMF-based classifier can represent the data in a part-based data space effectively and then find a good classification boundary easily.

Hyperspectral imaging is a remote sensing technology which allows detailed analysis of the earth surface (Harsanyi & Chang, 1994; Ji et al., 2014; Li, Zhang, Zhang, Huang, & Zhang, 2014; Villmann, Merenyi, & Hammer, 2003). Advanced imaging instruments producing high-dimensional images of hundreds of spectral bands is used by this technology. The classification of each pixel of a hyperspectral image is of great importance for target detection. In this experiment, the proposed algorithm was evaluated on the problem of hyperspectral image classification.

In this experiment, we used a popular hyperspectral image data set—the Indian Pine data set (Chang, Liu, Han, & Chen, 2014; Green et al., 1998; Mukherjee, Bhattacharya, Ghosh, & Arora, 2014). This data set was captured over the Indian test Pines site in Northwestern Indiana by the Airborne Visible/Infrared Imaging Spectrometer (AVIRIS) sensor. The image is of spatial dimension of 145×145 pixels, and its spatial resolution is 20 m per pixel. Each pixel is treated as a sample, and it has 220 spectral bands. Moreover, 20 bands contained atmospheric noise and water absorption, and were thus removed. The remaining 200 bands were used as features for each sample. There were 10366 labeled samples, which were classified into 16 classes. The number of samples of each class varies from 20 to 2468, which is shown in Fig. 3
                           .

To conduct the experiment, we also performed ten-fold cross validation on the 10366 labeled samples. The experimental results were evaluated by classification accuracy, which is defined as 
                              
                                 (26)
                                 
                                    accuracy  
                                    =
                                    
                                       
                                          Number of correctly classified test samples
                                       
                                       
                                          Number of test samples
                                       
                                    
                                    .
                                 
                              
                           
                        

@&#RESULTS@&#

The boxplots of the ten-fold cross validation on the Indian Pine data set are shown in Fig. 4
                           . From this figure, we can see that the proposed algorithm, MMDNMF, outperforms the three compared supervised NMF methods again. The median value of the accuracies of ten-fold cross validation of MMDNMD on this data set is higher than any other compared method. This is a strong evidence of the outperformance of the proposed method over other supervised NMF methods. The other three compared methods achieve similar performance, but they cannot match the performance of MMDNMF. The reason is as follows: MMDNMF regularizes the factorization of data to separate different classes to an extremity. The maximum within-class distance is minimized, and meanwhile the minimum between-class distance is maximized, bringing a large margin between different classes. Compared to MMDNMF, FNMF uses the Fisher rule to separate different classes. It does not push the separation to an extremity as MMDNMF does, thus it is inferior to MMDNMF. SSNMF tries to learn the class label directly, and it achieves a similar performance to FNMF. However, this cannot guarantee that the discriminative ability can be explored to an extremity. CNMF also explores the class labels of data samples by forcing the coefficient vectors of the data samples of the same class to a single same one. But it cannot separate the coefficient vectors of different classes effectively. Thus the performance of CNMF is slightly worse than other methods.

In this experiment, we compared the time costs of different algorithms as well. The running time for learning and test procedures of the compared algorithms are given in Fig. 5
                           . It could be observed that the proposed MMDNMF and SSMNF take more running time than the other algorithms for the learning procedure, due to their extra load to learn the maximum within-class distance and the minimum between-class distance in the coefficient vector space. Moreover, the test procedure also takes a little more time than other algorithms, because it compares the test sample to all the classes for the classification purpose.

To show the generated features of the proposed algorithm visually, we also add a standard image classification data set, Yale face database (Georghiades), to the experiment. This data set contains images of 15 people, with 11 grayscale face images for each of them. Thus there are 165 face images in this data set. For each person, the face images are of different facial expression or configuration: center-light, w/glasses, happy, left-light, w/no glasses, normal, right-light, sad, sleepy, surprised, and wink.

@&#RESULTS@&#

To perform the proposed MMDNMF algorithm, each image was resized to 32×32 pixels and then reshaped to a 1024 dimensional feature vector. We set the number of basis vectors to the number of people, which is 11. By applying the proposed algorithm to this database using ten-fold cross validation, we obtained a basis matrix and a coefficient matrix to represent the face images in the data set. We reshaped the basis vectors in the basis matrix to the size of 32×32 to show the generated features, which are given in Fig. 6
                           (a). To obtain the presented results, 100 iterations were needed by the proposed MMDNMF algorithm. From this figure, we can see that the learned basis images also have the patterns of face, and are very representative and discriminative for the classification of people in the data set. This indicates that using the criteria of maximizing the minimum between-class distance and minimizing the maximum within-class distance in the coefficient vector space can improve the discriminative ability of the learned representations, as is shown in Fig. 6(b).

Since the proposed MMFNMF is an iteration algorithm, the number of iterations has to be chosen such that the algorithm is converged. We also investigated the effect of the number of iterations. The curves of cost functions and accuracies against the number of iterations are shown in Fig. 7
                           . From this figure, we can see that when the iteration number is increased from 20 to 500, the cost function is reduced significantly and the classification is also improved significantly. When the iteration number is larger than 1000, both the cost function and the accuracy seem to be stable. This indicates that the algorithm may converge at an iteration number of 500–1000.

We are also interested in knowing if more iterations make the solution sparse. The learned coefficient matrices with iteration numbers of 20, 500, and 2000 are shown in Fig. 8
                           . From this figure, we can see that if the number of iterations is chosen to be small, e.g. 20, a dense coefficient matrix will emerge as shown in the first line of Fig. 8, whereas a large number of iterations will result in a sparse coefficient matrix, as shown in the last line of Fig. 8.

@&#CONCLUSION@&#

In this paper, we investigated how to use the class labels of the data samples to improve the discriminative ability of their NMF representations. To explore the class label information of the data samples, we consider the within-class sample pairs with the same class labels and the between-class sample pairs with different class labels. Apparently, in the NMF representation space, we need to minimize the distances between the within-class pairs, and also maximize the distances between the between-class pairs. Inspired by the max–min distance analysis (Bian & Tao, 2011), we also consider the extreme situation: we pick up the maximum within-class distance and then try to minimize it, so that all the within-class distances are also minimized, and we pick up the minimum between-class distance and then maximize it, so that all the between-class distances are maximized. In contrast to the max–min distance analysis, which only picks up the maximum between-class distance and minimize it, we consider both the between-class and within-class distances simultaneously. Experiments on three real world pattern classification problems showed its outperformance over the state-of-the-art supervised and semi-supervised NMF methods.

@&#ACKNOWLEDGMENT@&#

This study was supported by King Abdullah University of Science and Technology (KAUST), Saudi Arabia.

@&#REFERENCES@&#

