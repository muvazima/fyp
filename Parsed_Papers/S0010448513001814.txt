@&#MAIN-TITLE@&#Precise convex hull computation for freeform models using a hierarchical Gauss map and a Coons bounding volume hierarchy

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Present an interactive-speed algorithm for computing the precise convex hull of freeform geometric models.


                        
                        
                           
                           Employing two pre-built data structures, a hierarchical Gauss map and a Coons bounding volume hierarchy, we develop an efficient culling technique that can eliminate the majority of redundant surface patches.


                        
                        
                           
                           Construct the precise convex hull boundary using numerical methods.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Convex hulls

Freeform surfaces

Support distance

Upper envelope

Stereographic projection

Tritangent

Developable scroll

@&#ABSTRACT@&#


               Graphical abstract
               
                  
                     
                        
                           
                        
                     
                  
               
            

@&#INTRODUCTION@&#

Convex hull computation has a long history of development and it plays an important role in the design of many efficient geometric algorithms  [1]. Algorithms for convex objects are usually more efficient than for non-convex ones. Consequently, geometric tests on convex hulls are often applied beforehand to filter out simple cases where no further computation is needed for general non-convex objects. For example, the shape matching between two convex hulls is typically a necessary condition for the matching between two objects under comparison.

To the best of our knowledge, there is no previous interactive-speed algorithm for computing the convex hull of freeform geometric models. In this work, we present an efficient solution to this problem using two pre-built data structures: one for a hierarchy of bilinear surface approximations and the other for a hierarchy of unit normal bounds on the Gaussian sphere.

A simple way of characterizing the convex hull boundary is as a set of surface points which are extremal along each normal direction  [2–4]. The support distance function, mapping each surface point to the inner product of the position vector and the unit normal vector, is an equivalent way of characterizing the extremality condition. Using the upper envelope of the support distance functions, Kim et al.  [3] developed a real-time convex hull algorithm for planar freeform curves. We take a similar approach, but the main difference is in the hierarchical representations of the surface approximations and the Gaussian map.

The main contributions of this work can be summarized as follows: 
                        
                           –
                           A simple technique is introduced that constructs an approximate convex hull boundary as color-encoded images of the upper envelope using graphics rendering hardware.

An efficient interior culling algorithm is proposed that can eliminate the majority of redundant surface patches.

The implemented algorithm can compute the convex hull of freeform geometric models in an interactive speed.

@&#RELATED WORK@&#

Early convex hull algorithms considered only discrete objects such as points, lines, polygons, or polyhedra  [1]. Theoretical algorithms (with no implementation) have been designed for planar curves  [5–7]. Practical algorithms with full implementation were developed in  [2,8,4]. Elber et al.  [2] presented a robust implementation for planar freeform curves. Seong et al.  [4] extended the result to freeform space curves and surfaces. They reduced the convex hull computation to the problem of solving systems of polynomial equations. Nevertheless, it has been quite difficult to implement these algorithms for real-time performance.

Employing a 
                        
                           
                              G
                           
                           
                              1
                           
                        
                     -biarc approximation of planar curves  [9], Kim et al.  [3] introduced a real-time convex hull algorithm for planar freeform curves. The efficiency improvement is based on a pre-built BVH of 
                        
                           
                              G
                           
                           
                              1
                           
                        
                     -continuous arcs tightly fitting the given planar curves. Kim et al.  [10] introduced the CBVH for NURBS surfaces and also demonstrated real-time performance in collision detection and minimum distance computation among many NURBS surfaces. Using the CBVH, Kim et al.  [11] developed an interactive-speed algorithm for computing the Hausdorff distance between two NURBS surfaces. In the current work, we employ the CBVH for developing an interactive-speed convex hull algorithm for NURBS surfaces.

Sederberg et al.  [12,13] introduced the concepts of normal cone/pyramid and surface bounding cone/pyramid for the loop detection in surface–surface intersection. In this work, we employ these geometric concepts for an efficient elimination of redundant surface patches in the convex hull computation.

We first consider a simple technique for approximating the convex hull using graphics rendering and then move to an efficient algorithm for computing the precise convex hull.

Given a set of regular freeform surfaces 
                           
                              
                                 S
                              
                              
                                 i
                              
                           
                           
                              (
                              u
                              ,
                              v
                              )
                           
                           ,
                           0
                           ≤
                           u
                           ,
                           v
                           ≤
                           1
                           ,
                           i
                           =
                           1
                           ,
                           …
                           ,
                           K
                        , and their unit normal vectors 
                           
                              
                                 
                                    n
                                 
                              
                              
                                 i
                              
                           
                           
                              (
                              u
                              ,
                              v
                              )
                           
                        , we define the bivariate support distance functions using the inner product between the position vector and the unit normal vector: 
                           
                              
                                 
                                    
                                       f
                                    
                                    
                                       i
                                    
                                 
                                 
                                    (
                                    u
                                    ,
                                    v
                                    )
                                 
                                 =
                                 
                                    〈
                                    
                                       
                                          S
                                       
                                       
                                          i
                                       
                                    
                                    
                                       (
                                       u
                                       ,
                                       v
                                       )
                                    
                                    ,
                                    
                                       
                                          
                                             n
                                          
                                       
                                       
                                          i
                                       
                                    
                                    
                                       (
                                       u
                                       ,
                                       v
                                       )
                                    
                                    〉
                                 
                                 ,
                              
                           
                         for all 
                           0
                           ≤
                           u
                           ,
                           v
                           ≤
                           1
                         and 
                           i
                           =
                           1
                           ,
                           …
                           ,
                           K
                        . The upper envelope of these functions characterizes the convex hull boundary  [3], which can be parameterized by the unit normals 
                           
                              n
                           
                           ∈
                           
                              
                                 S
                              
                              
                                 2
                              
                           
                        : 
                           
                              
                                 U
                                 
                                    (
                                    
                                       n
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       max
                                    
                                    
                                       i
                                    
                                 
                                 
                                    {
                                    
                                       
                                          f
                                       
                                       
                                          i
                                       
                                    
                                    
                                       (
                                       u
                                       ,
                                       v
                                       )
                                    
                                    ∣
                                    
                                       
                                          
                                             n
                                          
                                       
                                       
                                          i
                                       
                                    
                                    
                                       (
                                       u
                                       ,
                                       v
                                       )
                                    
                                    =
                                    
                                       n
                                    
                                    }
                                 
                                 .
                              
                           
                        
                     

This is a mapping of each unit normal 
                           
                              n
                           
                         to the outermost surface point 
                           
                              
                                 S
                              
                              
                                 i
                              
                           
                           
                              (
                              u
                              ,
                              v
                              )
                           
                         that has the maximum support distance along the direction of 
                           
                              n
                           
                         and thus contributes to the convex hull boundary.

To represent the upper envelope as images, we can reparameterize the Gaussian sphere 
                           
                              
                                 S
                              
                              
                                 2
                              
                           
                         in rectangular coordinates by employing the stereographic projections of 
                           
                              
                                 S
                              
                              
                                 2
                              
                           
                         from the south/north pole 
                           
                              (
                              0
                              ,
                              0
                              ,
                              ∓
                              1
                              )
                           
                         to the 
                           x
                           y
                        -plane (
                           z
                           =
                           0
                        ): 
                           
                              
                                 
                                    (
                                    
                                       
                                          
                                             
                                                n
                                             
                                             
                                                ̄
                                             
                                          
                                       
                                       
                                          x
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             
                                                n
                                             
                                             
                                                ̄
                                             
                                          
                                       
                                       
                                          y
                                       
                                    
                                    ,
                                    0
                                    )
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          
                                             
                                                n
                                             
                                             
                                                x
                                             
                                          
                                       
                                       
                                          
                                             
                                                n
                                             
                                             
                                                z
                                             
                                          
                                          ±
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             
                                                n
                                             
                                             
                                                y
                                             
                                          
                                       
                                       
                                          
                                             
                                                n
                                             
                                             
                                                z
                                             
                                          
                                          ±
                                          1
                                       
                                    
                                    ,
                                    0
                                    )
                                 
                                 ,
                              
                           
                         for all 
                           
                              n
                           
                           =
                           
                              (
                              
                                 
                                    n
                                 
                                 
                                    x
                                 
                              
                              ,
                              
                                 
                                    n
                                 
                                 
                                    y
                                 
                              
                              ,
                              
                                 
                                    n
                                 
                                 
                                    z
                                 
                              
                              )
                           
                           ∈
                           
                              
                                 S
                              
                              
                                 2
                              
                           
                           ∖
                           
                              (
                              0
                              ,
                              0
                              ,
                              ∓
                              1
                              )
                           
                        . The upper envelope function 
                           U
                         is then locally parameterized as 
                           U
                           
                              (
                              
                                 
                                    
                                       
                                          n
                                       
                                       
                                          ̄
                                       
                                    
                                 
                                 
                                    x
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          n
                                       
                                       
                                          ̄
                                       
                                    
                                 
                                 
                                    y
                                 
                              
                              )
                           
                        .

For approximating the upper envelope 
                           U
                        , we generate a set of surface sample points 
                           
                              
                                 S
                              
                              
                                 i
                              
                           
                           
                              (
                              u
                              ,
                              v
                              )
                           
                         and compute the corresponding support distances 
                           
                              
                                 f
                              
                              
                                 i
                              
                           
                           
                              (
                              u
                              ,
                              v
                              )
                           
                        . The largest value 
                           
                              
                                 f
                              
                              
                                 i
                              
                           
                           
                              (
                              u
                              ,
                              v
                              )
                           
                         at the corresponding location 
                           
                              (
                              
                                 
                                    
                                       
                                          n
                                       
                                       
                                          ̄
                                       
                                    
                                 
                                 
                                    x
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          n
                                       
                                       
                                          ̄
                                       
                                    
                                 
                                 
                                    y
                                 
                              
                              )
                           
                         is then stored as the upper envelope 
                           U
                           
                              (
                              
                                 
                                    
                                       
                                          n
                                       
                                       
                                          ̄
                                       
                                    
                                 
                                 
                                    x
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          n
                                       
                                       
                                          ̄
                                       
                                    
                                 
                                 
                                    y
                                 
                              
                              )
                           
                         in the graphics rendering hardware depth buffer. At the same time, the corresponding surface identity 
                           
                              
                                 S
                              
                              
                                 i
                              
                           
                         and the parameter value 
                           
                              (
                              u
                              ,
                              v
                              )
                           
                         are stored in the frame buffer as an encoded color value. The color image in the frame buffer contains the surface patches that appear on the convex hull boundary and their connectivity with other surface patches sharing common tangent developable surfaces and common tritangent planes.


                        Fig. 1
                        (a)–(b) show the top and bottom views of four freeform surfaces. The upper envelope is generated as two rendered images of Fig. 1(c)–(d), each clipped to the square: 
                           −
                           1
                           ≤
                           
                              
                                 
                                    
                                       n
                                    
                                    
                                       ̄
                                    
                                 
                              
                              
                                 x
                              
                           
                           ,
                           
                              
                                 
                                    
                                       n
                                    
                                    
                                       ̄
                                    
                                 
                              
                              
                                 y
                              
                           
                           ≤
                           1
                        , from the stereographic projections from the south/north pole. In Fig. 1(d), the vertex in the upper left corner is outside the inscribed circle, which means that this vertex is the projection of a unit normal vector 
                           
                              (
                              
                                 
                                    n
                                 
                                 
                                    x
                                 
                              
                              ,
                              
                                 
                                    n
                                 
                                 
                                    y
                                 
                              
                              ,
                              
                                 
                                    n
                                 
                                 
                                    z
                                 
                              
                              )
                           
                           ∈
                           
                              
                                 S
                              
                              
                                 2
                              
                           
                        , in the upper hemisphere, 
                           
                              
                                 n
                              
                              
                                 z
                              
                           
                           >
                           0
                        . The projection of 
                           
                              (
                              
                                 
                                    n
                                 
                                 
                                    x
                                 
                              
                              ,
                              
                                 
                                    n
                                 
                                 
                                    y
                                 
                              
                              ,
                              
                                 
                                    n
                                 
                                 
                                    z
                                 
                              
                              )
                           
                         from the south pole is the upper right vertex of Fig. 1(c), which is contained in the inscribed circle.

By processing these images, we can extract curves that separate adjacent regions corresponding to different surface patches. Each point on a separating curve matches two corresponding surface patches and the surface locations that share the same tangent planes. Moving along the separating curve 
                           C
                           
                              (
                              t
                              )
                           
                         on the image, we can find a one-parameter family of bitangent planes, the envelope of which generates a tangent developable surface that touches the two surfaces simultaneously along two matching rail curves 
                           
                              
                                 S
                              
                              
                                 i
                              
                           
                           
                              (
                              u
                              
                                 (
                                 t
                                 )
                              
                              ,
                              v
                              
                                 (
                                 t
                                 )
                              
                              )
                           
                         and 
                           
                              
                                 S
                              
                              
                                 j
                              
                           
                           
                              (
                              α
                              
                                 (
                                 t
                                 )
                              
                              ,
                              β
                              
                                 (
                                 t
                                 )
                              
                              )
                           
                        . Note that developable surface is a special type of ruled surface where the Gaussian curvature vanishes at all surface points. In our case, each ruling line is generated by connecting the two corresponding surface points 
                           
                              
                                 S
                              
                              
                                 i
                              
                           
                           
                              (
                              u
                              
                                 (
                                 t
                                 )
                              
                              ,
                              v
                              
                                 (
                                 t
                                 )
                              
                              )
                           
                         and 
                           
                              
                                 S
                              
                              
                                 j
                              
                           
                           
                              (
                              α
                              
                                 (
                                 t
                                 )
                              
                              ,
                              β
                              
                                 (
                                 t
                                 )
                              
                              )
                           
                        .

On the two color images of the upper envelope 
                           U
                           
                              (
                              
                                 
                                    
                                       
                                          n
                                       
                                       
                                          ̄
                                       
                                    
                                 
                                 
                                    x
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          n
                                       
                                       
                                          ̄
                                       
                                    
                                 
                                 
                                    y
                                 
                              
                              )
                           
                        , there are some points where three (or more) different separating curves meet. In the majority of cases, only three separating curves meet at such a point, which corresponds to a tritangent plane that tangentially touches three different surfaces simultaneously. The meeting point may be connected to other meeting point by a separating curve. The topological structure of a convex hull boundary can be encoded in a planar graph consisting of these meeting points as vertices, their connecting curves as edges, and planar regions delineated by these curves as faces. From the network of all different components appearing on the convex hull boundary, we can generate a tritangent plane for each node, and a tangent developable surface for each edge, only to connect them in a correct topology to some convex surface patches that correspond to incident faces in the planar graph.

Though rather straightforward to implement, this algorithm generates only an approximation to the convex hull boundary of freeform geometric models due to the image resolution and the sampling density of surface points used in this approach. There is some possibility that we may miss a few important features from the convex hull computation, which can be quite critical in certain applications such as shape matching and recognition. Thus we need a more reliable solution, which is discussed below.

We now consider a precise convex hull computation for freeform surfaces. For this purpose, we employ the CBVH of Kim et al.  [10], which approximates freeform surfaces in a hierarchy of bilinear surfaces. Each bilinear surface is bounded by the convex hull of its four corners, which is a tetrahedron. By growing the tetrahedron by the amount of the surface approximation error (Fig. 2
                        (a)), we can generate a bounding volume that completely contains the surface patch (approximated by the bilinear surface). Each internal node of the CBVH contains such a grown tetrahedron. In this work, we also store a normal cone that completely contains the unit normals of the surface patch.

We build a separate spatial data structure for the hierarchy of recursive triangulation of the Gaussian sphere. Starting with a regular triangulation of the unit sphere, we recursively subdivide each spherical triangle into four triangles of equal size. As a result, we get a kind of quadtree on the unit sphere. Given a spherical triangle 
                           T
                         stored in an internal node of the tree, let 
                           
                              
                                 
                                    n
                                 
                              
                              
                                 T
                              
                           
                         denote the centroid and 
                           
                              
                                 
                                    n
                                 
                              
                              
                                 k
                              
                           
                           
                           
                              (
                              k
                              =
                              1
                              ,
                              2
                              ,
                              3
                              )
                           
                         denote the three corners of 
                           T
                        , all located on the Gaussian sphere.

We then find a surface point 
                           
                              
                                 
                                    p
                                 
                              
                              
                                 T
                              
                           
                         with the maximum support distance along the center direction 
                           
                              
                                 
                                    n
                                 
                              
                              
                                 T
                              
                           
                           ∈
                           
                              
                                 S
                              
                              
                                 2
                              
                           
                         of 
                           T
                        : 
                           
                              
                                 
                                    〈
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          T
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             n
                                          
                                       
                                       
                                          T
                                       
                                    
                                    〉
                                 
                                 =
                                 
                                    
                                       max
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       max
                                    
                                    
                                       0
                                       ≤
                                       u
                                       ,
                                       v
                                       ≤
                                       1
                                    
                                 
                                 
                                    〈
                                    
                                       
                                          S
                                       
                                       
                                          i
                                       
                                    
                                    
                                       (
                                       u
                                       ,
                                       v
                                       )
                                    
                                    ,
                                    
                                       
                                          
                                             n
                                          
                                       
                                       
                                          T
                                       
                                    
                                    〉
                                 
                                 .
                              
                           
                         Using the tetrahedral bounding volumes of CBVH, we can estimate tight upper and lower bounds for the maximum support distance. For a surface patch 
                           
                              
                                 S
                              
                              
                                 i
                              
                           
                           
                              (
                              u
                              ,
                              v
                              )
                           
                        , the maximum support distance can be bounded as follows: 
                           
                              
                                 
                                    
                                       max
                                    
                                    
                                       l
                                    
                                 
                                 
                                    〈
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          i
                                          ,
                                          l
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             n
                                          
                                       
                                       
                                          T
                                       
                                    
                                    〉
                                 
                                 ≤
                                 
                                    
                                       max
                                    
                                    
                                       0
                                       ≤
                                       u
                                       ,
                                       v
                                       ≤
                                       1
                                    
                                 
                                 
                                    〈
                                    
                                       
                                          S
                                       
                                       
                                          i
                                       
                                    
                                    
                                       (
                                       u
                                       ,
                                       v
                                       )
                                    
                                    ,
                                    
                                       
                                          
                                             n
                                          
                                       
                                       
                                          T
                                       
                                    
                                    〉
                                 
                                 ≤
                                 
                                    
                                       max
                                    
                                    
                                       l
                                    
                                 
                                 
                                    〈
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          i
                                          ,
                                          l
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             n
                                          
                                       
                                       
                                          T
                                       
                                    
                                    〉
                                 
                                 +
                                 
                                    
                                       ε
                                    
                                    
                                       i
                                    
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 
                                    p
                                 
                              
                              
                                 i
                                 ,
                                 l
                              
                           
                           
                           
                              (
                              l
                              =
                              1
                              ,
                              2
                              ,
                              3
                              ,
                              4
                              )
                           
                         are the four corners of the tetrahedron and 
                           
                              
                                 ε
                              
                              
                                 i
                              
                           
                         is the surface approximation error. We can eliminate all other surface patches 
                           
                              
                                 S
                              
                              
                                 j
                              
                           
                           
                              (
                              s
                              ,
                              t
                              )
                           
                         such that 
                           
                              
                                 
                                    
                                       max
                                    
                                    
                                       l
                                    
                                 
                                 
                                    〈
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          j
                                          ,
                                          l
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             n
                                          
                                       
                                       
                                          T
                                       
                                    
                                    〉
                                 
                                 +
                                 
                                    
                                       ε
                                    
                                    
                                       j
                                    
                                 
                                 <
                                 
                                    
                                       max
                                    
                                    
                                       l
                                    
                                 
                                 
                                    〈
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          i
                                          ,
                                          l
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             n
                                          
                                       
                                       
                                          T
                                       
                                    
                                    〉
                                 
                                 ,
                              
                           
                         as they have no chance to get the maximum support distance. For the remaining surface patches, the error 
                           
                              
                                 ε
                              
                              
                                 i
                              
                           
                         gets smaller as we move to the leaf levels of the CBVH.

For the surface point 
                           
                              
                                 
                                    p
                                 
                              
                              
                                 T
                              
                           
                         and all unit normals 
                           
                              n
                           
                           ∈
                           T
                           ⊂
                           
                              
                                 S
                              
                              
                                 2
                              
                           
                        , the union of all supporting planes at 
                           
                              
                                 
                                    p
                                 
                              
                              
                                 T
                              
                           
                         with outward normals 
                           
                              n
                           
                           ∈
                           T
                         generate a volume bounded by three supporting planes 
                           
                              
                                 L
                              
                              
                                 k
                              
                           
                         at 
                           
                              
                                 
                                    p
                                 
                              
                              
                                 T
                              
                           
                         with normals 
                           
                              
                                 
                                    n
                                 
                              
                              
                                 k
                              
                           
                           
                           
                              (
                              k
                              =
                              1
                              ,
                              2
                              ,
                              3
                              )
                           
                        . The complement of this volume consists of two infinite triangular pyramids with their common apex at 
                           
                              
                                 
                                    p
                                 
                              
                              
                                 T
                              
                           
                        . Each pyramid has three infinite triangular faces defined by the three planes 
                           
                              
                                 L
                              
                              
                                 k
                              
                           
                           
                           
                              (
                              k
                              =
                              1
                              ,
                              2
                              ,
                              3
                              )
                           
                         as shown in Fig. 2(c).

For the sake of an intuitive illustration, Fig. 2(b) shows a 2D version of these pyramids, where the shaded regions represent the union of all supporting lines at 
                           
                              
                                 
                                    p
                                 
                              
                              
                                 T
                              
                           
                         with normals 
                           
                              n
                           
                         in between 
                           
                              
                                 
                                    n
                                 
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 
                                    n
                                 
                              
                              
                                 2
                              
                           
                        . The outer infinite triangle (i.e., an infinite triangular pyramid in 3D) contains no point of the freeform model; otherwise, the point 
                           
                              
                                 
                                    p
                                 
                              
                              
                                 T
                              
                           
                         would not have been selected as the point of the maximum support distance along the direction 
                           
                              
                                 
                                    n
                                 
                              
                              
                                 T
                              
                           
                        . The inner infinite triangle may contain some parts of the geometric model, but none of these can be of maximum support distance along any of the normal directions 
                           
                              n
                           
                         between 
                           
                              
                                 
                                    n
                                 
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 
                                    n
                                 
                              
                              
                                 2
                              
                           
                        . As far as the normal directions between 
                           
                              
                                 
                                    n
                                 
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 
                                    n
                                 
                              
                              
                                 2
                              
                           
                         are concerned, the curve segment contained in the capsule-like bounding volume of Fig. 2 is redundant as it is completely contained in the inner infinite triangle. (Of course, this curve may contain some points which are extremal to normal directions other than those between 
                           
                              
                                 
                                    n
                                 
                              
                              
                                 1
                              
                           
                         and  
                           
                              
                                 
                                    n
                                 
                              
                              
                                 2
                              
                           
                        .)

Based on the above observation, in the partial convex hull construction regarding the normal directions of 
                           T
                           ⊂
                           
                              
                                 S
                              
                              
                                 2
                              
                           
                        , we can eliminate a surface patch 
                           
                              
                                 S
                              
                              
                                 i
                              
                           
                           
                              (
                              u
                              ,
                              v
                              )
                           
                         as redundant when the bounding volume for the surface patch is totally contained in the inner pyramid bounded by the three supporting planes 
                           
                              
                                 L
                              
                              
                                 k
                              
                           
                           
                           
                              (
                              k
                              =
                              1
                              ,
                              2
                              ,
                              3
                              )
                           
                        . The redundancy culling can be implemented very efficiently using the CBVH of freeform surfaces. It is easy to test the containment of a bounding volume in the infinite triangular pyramid.

If the surface patch 
                           
                              
                                 S
                              
                              
                                 i
                              
                           
                           
                              (
                              u
                              ,
                              v
                              )
                           
                         is not totally contained in the inner pyramid bounded by the three planes 
                           
                              
                                 L
                              
                              
                                 k
                              
                           
                           
                           
                              (
                              k
                              =
                              1
                              ,
                              2
                              ,
                              3
                              )
                           
                        , we go down to the next level of the CBVH, where smaller pieces of the surface patch 
                           
                              
                                 S
                              
                              
                                 i
                              
                           
                           
                              (
                              u
                              ,
                              v
                              )
                           
                         are stored, and we repeat the same culling test recursively for each piece of 
                           
                              
                                 S
                              
                              
                                 i
                              
                           
                           
                              (
                              u
                              ,
                              v
                              )
                           
                        . When the surface pieces become relatively small compared with the size of the spherical triangle 
                           T
                        , instead we go down to the next level of the spherical quadtree for the recursive triangulation of 
                           T
                        . The relative size of the surface patch against the size of 
                           T
                         is compared using the normal cone for the surface patch 
                           
                              
                                 S
                              
                              
                                 i
                              
                           
                           
                              (
                              u
                              ,
                              v
                              )
                           
                         which is also stored in the same node of the CBVH.

The recursive culling and subdivision proceeds until we reach the leaf level of the CBVH and also the leaf level of the quadtree of the recursive triangulation for the Gaussian sphere. At this final stage, the relative size of each surface patch is about the same as the spherical triangles at the leaf level of the Gaussian sphere quadtree. The situation is somewhat similar to the one shown in Fig. 1(c)–(d). But, instead of one surface point stored at each pixel, we usually have 3–5 adjacent surface patches corresponding to each spherical triangle 
                           T
                         at the leaf level. The union of these patches forms a connected surface area of 
                           
                              
                                 S
                              
                              
                                 i
                              
                           
                           
                              (
                              u
                              ,
                              v
                              )
                           
                        , but not necessarily a rectangular area, some part of which contributes to the convex hull boundary in the normal directions 
                           
                              n
                           
                           ∈
                           T
                        . There are also cases where several surface patches corresponding to 
                           T
                         form two different connected surface areas of 
                           
                              
                                 S
                              
                              
                                 i
                              
                           
                           
                              (
                              u
                              ,
                              v
                              )
                           
                         and 
                           
                              
                                 S
                              
                              
                                 j
                              
                           
                           
                              (
                              α
                              ,
                              β
                              )
                           
                         or even three or more connected surface areas 
                           
                              
                                 S
                              
                              
                                 i
                              
                           
                           
                              (
                              u
                              ,
                              v
                              )
                           
                           ,
                           
                              
                                 S
                              
                              
                                 j
                              
                           
                           
                              (
                              α
                              ,
                              β
                              )
                           
                           ,
                           
                              
                                 S
                              
                              
                                 k
                              
                           
                           
                              (
                              s
                              ,
                              t
                              )
                           
                           ,
                           …
                        , corresponding to the same spherical triangle 
                           T
                        . These cases correspond to the pixels located on the separating curves of Fig. 1(c)–(d), including those from which three separating curves branch out. By connecting the sequence of such leaf triangles 
                           T
                         in a correct topology, we may end up with a similar network of separating curves as in Fig. 1. But, instead of some surface points sampled along each of the discrete normal directions represented by the image pixels, we now have a complete superset of candidate surface patches and the corresponding normal directions, from which we can construct a precise convex hull boundary using numerical techniques to be discussed in the following subsections.

We first consider the non-degenerate case where three different surface areas 
                           
                              
                                 S
                              
                              
                                 i
                              
                           
                           
                              (
                              u
                              ,
                              v
                              )
                           
                           ,
                           
                              
                                 S
                              
                              
                                 j
                              
                           
                           
                              (
                              α
                              ,
                              β
                              )
                           
                           ,
                           
                              
                                 S
                              
                              
                                 k
                              
                           
                           
                              (
                              s
                              ,
                              t
                              )
                           
                         correspond to the same leaf triangle 
                           T
                        . Degenerate cases of more than three such areas can be handled by considering all different combinations of three such areas and check the redundancy of each computed tritangent plane (by checking whether there is some surface point located outside the tritangent plane). According to our experimental results, we can successfully detect the degenerate case of four-tangency on the convex hull boundary as coplanar tritangent triangles (see Fig. 3
                        (a)).

The precise location of a tritangent plane for three convex surface patches 
                           
                              
                                 S
                              
                              
                                 i
                              
                           
                           
                              (
                              u
                              ,
                              v
                              )
                           
                           ,
                           
                              
                                 S
                              
                              
                                 j
                              
                           
                           
                              (
                              α
                              ,
                              β
                              )
                           
                        , and 
                           
                              
                                 S
                              
                              
                                 k
                              
                           
                           
                              (
                              s
                              ,
                              t
                              )
                           
                         can be computed by solving the following system of six equations in six unknowns: 
                           
                              
                                 
                                    
                                       〈
                                       
                                          
                                             S
                                          
                                          
                                             i
                                          
                                       
                                       
                                          (
                                          u
                                          ,
                                          v
                                          )
                                       
                                       −
                                       
                                          
                                             S
                                          
                                          
                                             j
                                          
                                       
                                       
                                          (
                                          α
                                          ,
                                          β
                                          )
                                       
                                       ,
                                       
                                          
                                             N
                                          
                                          
                                             i
                                          
                                       
                                       
                                          (
                                          u
                                          ,
                                          v
                                          )
                                       
                                       〉
                                    
                                    =
                                    0
                                    ,
                                 
                              
                              
                                 
                                    
                                       〈
                                       
                                          
                                             S
                                          
                                          
                                             i
                                          
                                       
                                       
                                          (
                                          u
                                          ,
                                          v
                                          )
                                       
                                       −
                                       
                                          
                                             S
                                          
                                          
                                             j
                                          
                                       
                                       
                                          (
                                          α
                                          ,
                                          β
                                          )
                                       
                                       ,
                                       
                                          
                                             N
                                          
                                          
                                             j
                                          
                                       
                                       
                                          (
                                          α
                                          ,
                                          β
                                          )
                                       
                                       〉
                                    
                                    =
                                    0
                                    ,
                                 
                              
                              
                                 
                                    
                                       〈
                                       
                                          
                                             S
                                          
                                          
                                             j
                                          
                                       
                                       
                                          (
                                          α
                                          ,
                                          β
                                          )
                                       
                                       −
                                       
                                          
                                             S
                                          
                                          
                                             k
                                          
                                       
                                       
                                          (
                                          s
                                          ,
                                          t
                                          )
                                       
                                       ,
                                       
                                          
                                             N
                                          
                                          
                                             j
                                          
                                       
                                       
                                          (
                                          α
                                          ,
                                          β
                                          )
                                       
                                       〉
                                    
                                    =
                                    0
                                    ,
                                 
                              
                              
                                 
                                    
                                       〈
                                       
                                          
                                             S
                                          
                                          
                                             j
                                          
                                       
                                       
                                          (
                                          α
                                          ,
                                          β
                                          )
                                       
                                       −
                                       
                                          
                                             S
                                          
                                          
                                             k
                                          
                                       
                                       
                                          (
                                          s
                                          ,
                                          t
                                          )
                                       
                                       ,
                                       
                                          
                                             N
                                          
                                          
                                             k
                                          
                                       
                                       
                                          (
                                          s
                                          ,
                                          t
                                          )
                                       
                                       〉
                                    
                                    =
                                    0
                                    ,
                                 
                              
                              
                                 
                                    
                                       〈
                                       
                                          
                                             S
                                          
                                          
                                             i
                                          
                                       
                                       
                                          (
                                          u
                                          ,
                                          v
                                          )
                                       
                                       −
                                       
                                          
                                             S
                                          
                                          
                                             k
                                          
                                       
                                       
                                          (
                                          s
                                          ,
                                          t
                                          )
                                       
                                       ,
                                       
                                          
                                             N
                                          
                                          
                                             i
                                          
                                       
                                       
                                          (
                                          u
                                          ,
                                          v
                                          )
                                       
                                       〉
                                    
                                    =
                                    0
                                    ,
                                 
                              
                              
                                 
                                    
                                       〈
                                       
                                          
                                             S
                                          
                                          
                                             i
                                          
                                       
                                       
                                          (
                                          u
                                          ,
                                          v
                                          )
                                       
                                       −
                                       
                                          
                                             S
                                          
                                          
                                             k
                                          
                                       
                                       
                                          (
                                          s
                                          ,
                                          t
                                          )
                                       
                                       ,
                                       
                                          
                                             N
                                          
                                          
                                             k
                                          
                                       
                                       
                                          (
                                          s
                                          ,
                                          t
                                          )
                                       
                                       〉
                                    
                                    =
                                    0
                                    ,
                                 
                              
                           
                         where 
                           
                              
                                 N
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 N
                              
                              
                                 j
                              
                           
                        , and 
                           
                              
                                 N
                              
                              
                                 k
                              
                           
                         are the surface normals of 
                           
                              
                                 S
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 S
                              
                              
                                 j
                              
                           
                        , and 
                           
                              
                                 S
                              
                              
                                 k
                              
                           
                        , respectively.

For an efficient and robust computation of the tritangent plane, it is very important to start with a good initial approximate solution for the above system of equations. Given a leaf triangle 
                           T
                         with the centroid 
                           
                              
                                 
                                    n
                                 
                              
                              
                                 T
                              
                           
                           ∈
                           
                              
                                 S
                              
                              
                                 2
                              
                           
                         and a connected surface area 
                           
                              
                                 S
                              
                              
                                 i
                              
                           
                           
                              (
                              u
                              ,
                              v
                              )
                           
                         consisting of a few leaf patches of the CBVH, we consider the set of all corner points of the tiny leaf patches. We start with one such point 
                           
                              
                                 
                                    p
                                 
                              
                              
                                 i
                              
                           
                         of 
                           
                              
                                 S
                              
                              
                                 i
                              
                           
                           
                              (
                              u
                              ,
                              v
                              )
                           
                         which is of the maximum support distance along the direction 
                           
                              
                                 
                                    n
                                 
                              
                              
                                 T
                              
                           
                         among all such points of 
                           
                              
                                 S
                              
                              
                                 i
                              
                           
                           
                              (
                              u
                              ,
                              v
                              )
                           
                        , and similarly take a point 
                           
                              
                                 
                                    p
                                 
                              
                              
                                 j
                              
                           
                         of 
                           
                              
                                 S
                              
                              
                                 j
                              
                           
                           
                              (
                              α
                              ,
                              β
                              )
                           
                         and a point 
                           
                              
                                 
                                    p
                                 
                              
                              
                                 k
                              
                           
                         of 
                           
                              
                                 S
                              
                              
                                 k
                              
                           
                           
                              (
                              s
                              ,
                              t
                              )
                           
                        . The plane 
                           
                              
                                 L
                              
                              
                                 i
                                 j
                                 k
                              
                           
                         determined by the three points 
                           
                              
                                 
                                    p
                                 
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 
                                    p
                                 
                              
                              
                                 j
                              
                           
                        , 
                           
                              
                                 
                                    p
                                 
                              
                              
                                 k
                              
                           
                         may not support all the corner points of 
                           
                              
                                 S
                              
                              
                                 i
                              
                           
                           
                              (
                              u
                              ,
                              v
                              )
                           
                           ,
                           
                              
                                 S
                              
                              
                                 j
                              
                           
                           
                              (
                              α
                              ,
                              β
                              )
                           
                           ,
                           
                              
                                 S
                              
                              
                                 k
                              
                           
                           
                              (
                              s
                              ,
                              t
                              )
                           
                         in one side of the plane. By updating the candidate points 
                           
                              
                                 
                                    p
                                 
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 
                                    p
                                 
                              
                              
                                 j
                              
                           
                           ,
                           
                              
                                 
                                    p
                                 
                              
                              
                                 k
                              
                           
                         incrementally, we can find a plane 
                           
                              
                                 L
                              
                              
                                 i
                                 j
                                 k
                              
                           
                         that supports all corner points of the leaf patches in one side of the plane. The supporting points on the plane 
                           
                              
                                 L
                              
                              
                                 i
                                 j
                                 k
                              
                           
                         are used to get an initial solution for the numerical solution of the above system of equations. We can improve the numerical stability of this approach by taking more samples from the leaf surface patches of the CBVH. But there is an obvious trade-off between the stability and the efficiency of the algorithm, which is the main reason why we employ only the corner points of the leaf patches which are already available in the CBVH.

Once all tritangent planes are computed on the convex hull boundary, we can generate bitangent developable scrolls that branch out from the tritangent planes and connects to other tritangent locations. Between two surface patches 
                           
                              
                                 S
                              
                              
                                 i
                              
                           
                           
                              (
                              u
                              ,
                              v
                              )
                           
                         and 
                           
                              
                                 S
                              
                              
                                 j
                              
                           
                           
                              (
                              α
                              ,
                              β
                              )
                           
                        , the tangent developable scroll can be generated by numerically tracing the zero-set for the following system of three equations in four unknowns  [14,15]:
                           
                              
                                 
                                    
                                       〈
                                       
                                          
                                             N
                                          
                                          
                                             i
                                          
                                       
                                       
                                          (
                                          u
                                          ,
                                          v
                                          )
                                       
                                       ,
                                       
                                          
                                             ∂
                                             
                                                
                                                   S
                                                
                                                
                                                   j
                                                
                                             
                                          
                                          
                                             ∂
                                             α
                                          
                                       
                                       
                                          (
                                          α
                                          ,
                                          β
                                          )
                                       
                                       〉
                                    
                                    =
                                    0
                                    ,
                                 
                              
                              
                                 
                                    
                                       〈
                                       
                                          
                                             N
                                          
                                          
                                             i
                                          
                                       
                                       
                                          (
                                          u
                                          ,
                                          v
                                          )
                                       
                                       ,
                                       
                                          
                                             ∂
                                             
                                                
                                                   S
                                                
                                                
                                                   j
                                                
                                             
                                          
                                          
                                             ∂
                                             β
                                          
                                       
                                       
                                          (
                                          α
                                          ,
                                          β
                                          )
                                       
                                       〉
                                    
                                    =
                                    0
                                    ,
                                 
                              
                              
                                 
                                    
                                       〈
                                       
                                          
                                             N
                                          
                                          
                                             i
                                          
                                       
                                       
                                          (
                                          u
                                          ,
                                          v
                                          )
                                       
                                       ,
                                       
                                          
                                             S
                                          
                                          
                                             i
                                          
                                       
                                       
                                          (
                                          u
                                          ,
                                          v
                                          )
                                       
                                       −
                                       
                                          
                                             S
                                          
                                          
                                             j
                                          
                                       
                                       
                                          (
                                          α
                                          ,
                                          β
                                          )
                                       
                                       〉
                                    
                                    =
                                    0
                                    .
                                 
                              
                           
                        
                     

Since the number of equations is one less than the number of unknowns, the solution set is a one-dimensional zero-set 
                           
                              (
                              u
                              
                                 (
                                 t
                                 )
                              
                              ,
                              v
                              
                                 (
                                 t
                                 )
                              
                              ,
                              α
                              
                                 (
                                 t
                                 )
                              
                              ,
                              β
                              
                                 (
                                 t
                                 )
                              
                              )
                           
                         in the 
                           u
                           v
                           α
                           β
                        -space. The numerical tracing along the intersection curve among the three multivariate surfaces can be done in an efficient and robust manner using conventional techniques for intersecting freeform surfaces.

@&#EXPERIMENTAL RESULTS@&#

We have implemented our convex hull algorithm in C++ on an Intel Core i7 3.4 GHz PC with a 3.25 GB main memory and an NVIDIA GeForce GTX 680 GPU. To demonstrate the effectiveness of our approach, we have tested the algorithm for freeform models of non-trivial complexity.

The CBVH for each static freeform geometric model and a hierarchical Gaussian map are constructed in a pre-processing step. Nevertheless, the hierarchy of infinite pyramids for redundancy culling should be constructed on line as the extreme point 
                        
                           
                              
                                 p
                              
                           
                           
                              T
                           
                        
                      for each triangle 
                        T
                        ⊂
                        
                           
                              S
                           
                           
                              2
                           
                        
                      changes dynamically depending on the relative configuration among different freeform models even though they are non-deformable models. The redundancy culling tests against infinite pyramids are done in parallel using four CPUs.

In Fig. 3, we compute the convex hull for the union of two Utah teapots. Fig. 3(a) shows the result of convex hull computation for the case where one teapot (in red) is displaced from the other (in blue) under a pure translation. As the direction of translation is along a grazing angle of some sharp edges on the convex hull boundary of the Utah teapot, these edges generate parallelograms on the convex hull boundary of the two Utah teapots. Each parallelogram is shown with four coplanar tritangent triangles as each triangle is recognized as non-redundant. For the convex hull construction with a correct topology, we select only two of them for each parallelogram. Fig. 3(b)–(d) demonstrate the convex hull computation for three instances of one teapot (in red) under a pure rotation. Figs. 4 and 5
                     
                      show similar results for other models.


                     Fig. 6
                      shows a sequence of convex hull computations for the union of a stationary Utah teapot and a moving teapot under a continuous translation and rotation. In Fig. 6(b), the computation time increases as the two teapots start intersecting each other, reaches the peak at the overlap configuration of the two models, and then drops as the two models are separated. The Hausdorff distance between the two models is also given here as a quantitative measure for the degree of their overlap. Unfortunately, we have made no quantitative comparison with the previous work as the algorithm of Seong et al.  [4] is not stable enough to produce the convex hull for each of the 250 frames tested in Fig. 6.

@&#CONCLUSIONS@&#

In this paper, we have presented an interactive-speed algorithm for computing the convex hull of freeform surface models. We have reformulated the convex hull computation as a simple problem of constructing the upper envelope of support distance functions defined by the given surfaces. Using a CBVH for freeform surfaces and their normal cones and a hierarchical tessellation of the Gaussian sphere, we have shown that an efficient convex hull algorithm can be developed while greatly improving both the efficiency and robustness of the previous algorithm. In the future work, we plan to apply the convex hull algorithm to the dual of freeform surfaces and compute the kernel of freeform models  [16].

@&#ACKNOWLEDGMENTS@&#

The research leading to these results has received partial funding from the People Programme (Marie Curie Actions) of the European Union’s Seventh Framework Programme FP7/2007-2013/ under REA grant agreement PIAP-GA-2011-286426 and was supported in part by the E. and J. Bishop Research Fund, Technion, and also in part by NRF Research Grants (No. 2013R1A1A2010085).

@&#REFERENCES@&#

