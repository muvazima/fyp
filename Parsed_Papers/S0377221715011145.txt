@&#MAIN-TITLE@&#Electricity retail contracting under risk-aversion

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We develop a model of retail competition wherein the retailers are risk-averse.


                        
                        
                           
                           Entry into the retail market is endogenously determined within the model.


                        
                        
                           
                           We apply this model to a generation asset transfer policy from the NZEM.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

OR in energy

Game theory

Risk-aversion

Retail pricing

Electricity

@&#ABSTRACT@&#


               
               
                  Risk has always been a dominant part of financial decision making in any industry. Recently models, tools and computational techniques have been developed so that we can effectively incorporate risk in optimal decision policies. The focus of this paper is on electricity markets, where much of the inherent risk falls on the retail sector. We introduce a three-stage model of an electricity market where firms can choose to enter the retail market, then enter into retail contracts, and finally purchase electricity in a wholesale market to satisfy their contracts. We explicitly assume that firms are risk-averse in this model. We demonstrate how the behaviour of firms change with risk-aversion, and use the example of an asset-swap policy over a transmission network to demonstrate the importance of modeling risk-aversion in determining policy outcomes.
               
            

@&#INTRODUCTION@&#

Much of the classic literature on electricity markets is based on published models that assume firms act in a risk-neutral manner. Results such as the importance of long-term contracts in lowering spot market prices (Allaz & Vila, 1993; Carlton, 1979) and the efficiency of nodal pricing markets (Caramanis, 1982) were proved using this assumption. However risk is a dominant part of any financial decision making and if firms are risk-averse then many of the policy predictions based on risk-neutrality become suspect. For example, Neuhoff and De Vries (2004) show that generation investment is not necessarily efficient in equilibrium if consumers and investors are risk-averse.

Much of the risk inherent in electricity markets falls on the retail sector. Retailers typically form fixed price, variable volume (FPVV) contracts with their customers (residential and commercial consumers). This places the risk of supplying the electricity on the retailer, exposing them to a variety of sources of uncertainty through the wholesale market. Electricity wholesale markets (also known as spot markets) operate through optimal dispatch of generators to meet the demand at minimum cost while complying with transmission constraints (Schweppe, Caramanis, Tabors, & Bohn, 1988). Locational marginal prices of electricity are extracted from such optimization problems as the total cost to the system of meeting one more unit of demand at a location. As a result, the retail firms face price fluctuations from transmission or plant outages, fuel cost shocks, or direct risk from demand shocks.

In many markets, retailers vertically integrate or engage in contracts with generators to mitigate their spot price risk.
                        1
                     
                     
                        1
                        This can also provide a hedge for generators where fuel costs are uncertain.
                      Even prior to the prevalence of electricity markets, Hobbs (1995) investigated electric utility resource planning in an optimization setting, discussing competition, price responsive demand and uncertainty. More recently, Anderson and Hu (2008) consider the strategic incentives for retailers to offer forward contracts to generators in a risk-neutral setting, showing that retailers would be potentially willing to pay a premium for forward contracts, in order to reduce prices in the wholesale market. Oliveira, Ruiz, and Conejo (2013) also consider contracting, but from the perspective of market design. They consider the coordination of a supply chain with multiple generators and retailers under different market structures. The few papers that explicitly examine risk-averse firms usually focus on long-term contract formation by generators and avoid modeling the retail market, although Aïd, Chemla, Porchet, and Touzi (2011) model the retail sector, incorporating risk using a mean-variance approach. However, within these papers there is little discussion of transmission risk, which is arguably critical to pricing in nodal markets, and limited discussion of any kind of competition or entry into retail markets.

In this paper, we introduce a model of an electricity market where risk-averse gentailers and retailers act to maximize profit in a three-stage game. We explicitly model the formation of contract prices in the retail sector, allowing for strategic behaviour by firms. Furthermore, firms have the option of choosing whether or not to enter the retail market in the first place (including those firms who own generation), making vertical integration (or lack thereof) an endogenous outcome of the model. In order to model risk the firms maximize profit while minimizing conditional value-at-risk (CVaR).

The existing literature on risk-aversion in electricity markets can be crudely divided into three distinct strands. One is the modeling of the decisions of individual generators based upon input risks (such as water flows for hydro generators). This considers risk from the perspective of a single generator, and does not consider market outcomes of multiple risk-averse generators, so is not particularly relevant to our model. Another strand takes the point of view of large consumers faced with a risky series of electricity prices. In this strand, prices are taken as exogenous, not formed through competition between risk-averse firms. The final strand, most relevant to this paper, is the study of risk-aversion in the formation of long-term contracts. Examples include articles by Powell (1993) and Neuhoff and De Vries (2004). Both of these papers use the expected utility method to model risk-aversion, since concave utility functions are known to mimic risk-averse behaviour. On the other hand, Rocha and Kuhn (2012) develop a multistage stochastic mean-variance optimization model to optimize portfolios of electricity derivative contracts for a single firm. Baldursson and von der Fehr (2007) analyze the behaviour of risk-averse firms in both wholesale and retail markets simultaneously. They consider a model where risk-averse firms vertically integrate, finding that vertical integration impairs market performance by increasing the gap between contract and (expected) spot prices. Their measure of risk is mostly the constant relative risk-aversion (CRRA) measure commonly used by economists.
                        2
                     
                     
                        2
                        They use a more general formulation in their initial modeling.
                      Firms are price takers in the wholesale (spot) market, with either fixed retail prices, or retail prices that are linked to wholesale prices. (Retail prices are not determined by retail competition.) The goal of their paper is to see if long-term contracts can still enhance competition when risk-aversion is incorporated. CRRA has also been employed by Chronopoulos, Reyck, and Siddiqui (2014) in modeling entry and duopoly competition in a market setting where firms are risk averse against price uncertainty. Finally, Woo, Karimov, and Horowitz (2004) model how electricity distribution companies can purchase forward contracts in order to minimize expected future procurement costs, while constraining the Value at Risk (VaR) to be below a specified level.

CVaR has been previously employed to model generator behaviour in the operations research literature. Papers in this area include Carrion (2008) and Carrion, Gotzes, and Schultz (2009). Again, many of these papers model a single firm’s point of view, considering the best response of the firm given a perceived risk. However, recent papers by Ralph and Smeers (2011) and Philpott, Ferris, and Wets (2015) present Nash games under risk, giving examples of equilibria where risk is modeled using CVaR. We also compute Nash equilibria with risk-averse agents, specifically considering the equilibrium responses of multiple firms acting to maximize their profits, less conditional value-at-risk. We demonstrate that the behaviour of risk-neutral firms compared to risk-averse firms can be very different, with obvious consequences for policy decisions.

We begin by briefly presenting the concept of conditional value-at-risk and discussing how we employ it in the context of electricity markets. We then construct a model of an electricity market with three stages: entry, retail competition to form long-term retail contracts, followed by wholesale market-clearing to set the spot prices.
                        3
                     
                     
                        3
                        We assume a competitive equilibrium in the wholesale market.
                      We use this model first to present a simple example to illustrate the impact of risk-aversion on retail pricing and finally a general model formulation which we use to show how nodal price risk can cause generators to limit their retail obligations to nodes where they have their own generation capacity. We give examples that illustrate how risk-averse firms’ behaviour varies significantly from their risk-neutral counterparts, and finish with an extended policy example: a two-node stylised analysis of a generator asset-swap in the New Zealand Electricity Market, designed to reduce risk and thereby decrease retail prices.

When companies are making investment decisions or entering contracts they do not solely consider the expected benefit from the decisions. They also take into account the consequences if the return on the investment is lower than expected – behaviour which is known as risk-aversion. Companies are responsible to shareholders over both the short and long term, so they need to make decisions that seek to minimize their risk, while at the same time maximizing expected profit.

In the finance literature, mean-risk optimization is commonly used in portfolio optimization. This approach involves solving a bi-objective optimization problem and typically results in finding a set of Pareto optimal solutions, known as the efficient frontier. In such models risk is typically measured by the variance of the return or by using the downside-risk, as introduced by Markowitz (1959).

Although firms often use the concept of value-at-risk to measure their risk exposure, VaR has not been used much in equilibrium models due to its intractability. In particular, utility functions incorporating value-at-risk may not be convex (Artzner, Delbaen, Eber, & Heath, 1999). In order to formalize the concept of risk, Artzner et al. (1999) introduced coherent measures of risk. A coherent risk measure must comply with the following four axioms: sub-additivity; translation invariance; positive homogeneity; and monotonicity. Risk measures complying with these axioms exhibit key properties that are valuable for a risk-averse agent. For example, sub-additivity ensures that there is a risk-pooling effect: the sum of risks is greater than or equal to the risk of the sum. Critically, none of the above risk measures are coherent. The value-at-risk measure, for example, violates the sub-additivity property.

Here we use conditional value at risk (CVaR)
                        4
                     
                     
                        4
                        Also known as average value at risk, or expected shortfall.
                      that is a coherent risk measure. Recall that CVaR at level α of some random return z is simply the expected loss if one’s interest were restricted to the lowest 100α percent of returns. If returns z are continuously distributed with some distribution function F(z) and associated probability density function f(z) then CVaR
                        α
                     (z) can be written as:

                        
                           
                              
                                 
                                    
                                       CVaR
                                    
                                    α
                                 
                                 
                                    (
                                    z
                                    )
                                 
                                 =
                                 −
                                 
                                    1
                                    α
                                 
                                 
                                    ∫
                                    
                                       −
                                       ∞
                                    
                                    
                                       
                                          F
                                          
                                             −
                                             1
                                          
                                       
                                       
                                          (
                                          α
                                          )
                                       
                                    
                                 
                                 
                                    z
                                    f
                                    
                                       (
                                       z
                                       )
                                    
                                    d
                                    z
                                    .
                                 
                              
                           
                        
                     
                  


                     Rockafellar and Uryasev (2000) present a formulation of CVaR which enables the bottom 100α percent of outcomes to be computed through a linear program. Moreover, for profit functions that are concave in the decision variables, we have a convex optimization problem when we maximize a weighted combination of expected profit and risk. Below, θ is a parameter between 0 and 1 and changes the weightings on risk and return, z is a random variable which may be a function of some of the parameters.

                        
                           (1)
                           
                              
                                 max
                                 
                                 
                                    
                                       (
                                       1
                                       −
                                       θ
                                       )
                                    
                                    E
                                    
                                       [
                                       z
                                       ]
                                    
                                    −
                                    θ
                                    
                                       
                                          CVaR
                                       
                                       α
                                    
                                    
                                       (
                                       z
                                       )
                                    
                                    .
                                 
                              
                           
                        
                     
                  

In this paper, we use the above mean-risk formulation (with risk measured using CVaR) in our model of an electricity retail market with risk-averse firms. See Shapiro, Dentcheva, and Ruszczynski (2009) for further details as to how CVaR can be incorporated into a convex optimization problem. In Section 5 we present a mathematical program that utilizes the above objective function.

In this section we begin our exposition by outlining the model in the single node case. Assume that electricity is traded in a market with two stages. At the first stage, retailers offer electricity contracts for sale to consumers. These are fixed price, variable volume contracts, by which the retailer agrees to supply any quantity of electricity to the consumer at a fixed price. Each retailer sets a price for their contracts, and consumers choose which retailer will supply them. At the second stage, retailers must buy electricity in the wholesale market to satisfy their contractual obligations. Electricity is supplied by generators who make offers to sell electricity in the wholesale market. When the market clears, the electricity is generated and delivered to consumer. Retailers pay the wholesale price for the electricity consumed by their customers, generators receive the wholesale price for the quantity of electricity dispatched. Final consumers cannot buy electricity directly on the wholesale market.

Assume that there is a set of firms 
                        
                           F
                           g
                        
                      who own generation. Each firm 
                        
                           f
                           ∈
                           
                              F
                              g
                           
                        
                      owns a mix of two types of plant, hydro plants and thermal plants. The two types of plant differ by their short-run marginal cost functions.
                        5
                     
                     
                        5
                        We will specify exact cost functions later when we create our examples.
                      We also allow for another set of firms who do not own any generation, but may be interested in buying electricity in the wholesale market and on-selling it in the retail market. We call these firms ‘retailers’ and denote the set of such firms by 
                        
                           F
                           r
                        
                     .

Before the actual electricity market runs, there is a ‘zeroth’ stage at which each firm 
                        
                           f
                           ∈
                           
                              F
                              g
                           
                           ∪
                           
                              F
                              r
                           
                        
                      must decide whether or not to enter the retail market. We will assume that a firm will enter the retail market if its risk-adjusted profits minus the cost of entry are positive. Denote the set of generators who enter the retail market by 
                        
                           
                              E
                              g
                           
                           ⊆
                           
                              F
                              g
                           
                        
                     . Denote the set of pure retailers who enter the retail market by 
                        
                           
                              E
                              r
                           
                           ⊆
                           
                              F
                              r
                           
                        
                     . Let 
                        
                           E
                           =
                           
                              E
                              g
                           
                           ∪
                           
                              E
                              r
                           
                        
                      be the set of all firms who have entered the retail market.

Before we formally define the full game, we detail behaviour in the retail and wholesale markets.

The first stage of the electricity auction process is the formation of retail contracts, in what we term the Retail Market. We assume that retail contracts are formed according to take-it-or-leave-it fixed price offers. Every firm 
                           
                              f
                              ∈
                              E
                           
                         simultaneously offers a price pf
                         ≥ 0 at which they are willing to sell contracts. The contracts on offer are fixed-price, variable volume contracts , where, at the conclusion of stage 2 of our model, the retailer agrees to supply any amount of demand in real-time at a fixed price determined in stage 1.

On the demand side, we assume there is a continuum of consumers who each demand the same amount of electricity, adding up to a total demand of X megawatts. Each consumer must pick a firm with whom to enter into a fixed-price retail contract. If consumers could see all the prices, and had no other basis on which to choose a firm, then the Bertrand assumption would hold and all consumers would choose the firm with the lowest price. We do not make this assumption as we do not find it to be realistic.
                           6
                        
                        
                           6
                           In the New Zealand market, firms offer retail contracts at fixed prices. These prices are available at the PowerSwitch website. Note that there is considerable price dispersion amongst the offers, yet firms with high prices still have considerable market share. This throws doubt on whether Bertrand is a realistic assumption for retail electricity markets.
                         Rather, we assume that consumers have some type of preferences over which firm supplies them. These preferences might be formed from a consumer search model, or a spatial model, but in this paper we follow the partial equilibrium framework outlined in Vives (2001), the general concept of which can be captured by assuming a differentiated products demand function.

We will use a linear formulation similar to that found in Vives (2001), adjusted to assume that total consumer demand for electricity is inelastic and equal to X. Denote the retail market-share for firm f by ϕf
                        . Due to the inelasticity of demand, instead of considering the retail prices, we consider the price differences between each firm’s retail price and the price of an arbitrary firm (which, without loss of generality we will set to be firm k). We therefore define the price differences, δ, as follows:

                           
                              
                                 
                                    
                                       δ
                                       f
                                    
                                    =
                                    
                                       p
                                       f
                                    
                                    −
                                    
                                       p
                                       k
                                    
                                    ,
                                    
                                    ∀
                                    f
                                    ∈
                                    E
                                    .
                                 
                              
                           
                        
                     

Following Vives (2001), we define our consumer utility function to be

                           
                              
                                 
                                    U
                                    
                                       (
                                       ϕ
                                       )
                                    
                                    =
                                    
                                       1
                                       b
                                    
                                    
                                       ∑
                                       
                                          
                                             f
                                             ∈
                                             E
                                             ∖
                                          
                                          
                                             {
                                             k
                                             }
                                          
                                       
                                    
                                    
                                       ϕ
                                       f
                                    
                                    −
                                    
                                       1
                                       
                                          2
                                          b
                                       
                                    
                                    
                                       (
                                       2
                                       
                                          ∑
                                          
                                             
                                                f
                                                ∈
                                                E
                                                ∖
                                             
                                             
                                                {
                                                k
                                                }
                                             
                                          
                                       
                                       
                                          
                                             
                                                ϕ
                                                f
                                             
                                          
                                          2
                                       
                                       +
                                       
                                          ∑
                                          
                                             
                                                f
                                                ∈
                                                E
                                                ∖
                                             
                                             
                                                {
                                                k
                                                ,
                                                i
                                                }
                                             
                                             
                                                ,
                                                i
                                                ∈
                                                E
                                                ∖
                                             
                                             
                                                {
                                                k
                                                }
                                             
                                          
                                       
                                       
                                          
                                             ϕ
                                             f
                                          
                                          
                                             ϕ
                                             i
                                          
                                       
                                       )
                                    
                                    ,
                                 
                              
                           
                        where b reflects the willingness of consumers to switch.
                           7
                        
                        
                           7
                           If b is small, the cross-elasticity is low, meaning that firms cannot easily gain or lose customers through changing their prices, whereas if b is large, small price differences can lead to large numbers of consumers switching.
                         We seek to maximize utility, given the relative prices, δ, of the firms (while restricting the market-shares to be non-negative):

                           
                              
                                 
                                    
                                       
                                          max
                                       
                                       
                                          
                                             U
                                             
                                                (
                                                ϕ
                                                )
                                             
                                             −
                                             δ
                                             ·
                                             ϕ
                                          
                                       
                                    
                                    
                                       
                                          
                                       
                                       
                                          
                                       
                                    
                                    
                                       
                                          
                                             s
                                             
                                                .
                                                t
                                             
                                             .
                                          
                                       
                                       
                                          
                                             ϕ
                                             ≥
                                             0
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The restriction that the market-share of each firm must be non-negative makes this problem difficult to solve analytically. So, we will first consider the demand model without this restriction (
                           
                              D
                              ^
                           
                        ) and later, in Section 5, we show that we only need to consider 
                           
                              D
                              ^
                           
                         when forming Nash-equilibria.

Using first-order conditions, we find that maximum welfare occurs with

                           
                              
                                 
                                    
                                       δ
                                       f
                                    
                                    =
                                    
                                       1
                                       b
                                    
                                    
                                       [
                                       1
                                       −
                                       
                                          
                                             ϕ
                                             ^
                                          
                                          f
                                       
                                       −
                                       
                                          ∑
                                          
                                             
                                                i
                                                ∈
                                                E
                                                ∖
                                             
                                             
                                                {
                                                k
                                                }
                                             
                                          
                                       
                                       
                                          
                                             ϕ
                                             ^
                                          
                                          i
                                       
                                       ]
                                    
                                    
                                       ,
                                       
                                       ∀
                                       f
                                       ∈
                                       E
                                       ∖
                                    
                                    
                                       {
                                       k
                                       }
                                    
                                    ,
                                 
                              
                           
                        where 
                           
                              
                                 ϕ
                                 ^
                              
                              f
                           
                         is the market-share of firm f under this modified demand model. We now invert the system to find 
                           
                              ϕ
                              ^
                           
                         as a function of δ:

                           
                              
                                 
                                    
                                       
                                          ϕ
                                          ^
                                       
                                       f
                                    
                                    =
                                    
                                       1
                                       
                                          |
                                          E
                                          |
                                       
                                    
                                    
                                       [
                                       1
                                       −
                                       b
                                       
                                          ∑
                                          
                                             i
                                             ∈
                                             E
                                          
                                       
                                       
                                          (
                                          
                                             δ
                                             f
                                          
                                          −
                                          
                                             δ
                                             i
                                          
                                          )
                                       
                                       ]
                                    
                                    
                                       ,
                                       
                                       ∀
                                       f
                                       ∈
                                       E
                                       ∖
                                    
                                    
                                       {
                                       k
                                       }
                                    
                                    ,
                                 
                              
                           
                        where 
                           
                              |
                              E
                              |
                           
                         is the number of firms in set 
                           E
                        .

Finally, we eliminate δ, so that if every firm 
                           
                              i
                              ∈
                              E
                           
                         offers price pi
                        , then market share for firm 
                           
                              f
                              ∈
                              E
                           
                         is

                           
                              (2)
                              
                                 
                                    
                                       
                                          ϕ
                                          ^
                                       
                                       f
                                    
                                    =
                                    
                                       1
                                       
                                          |
                                          E
                                          |
                                       
                                    
                                    
                                       [
                                       1
                                       −
                                       b
                                       
                                          ∑
                                          
                                             
                                                i
                                                ∈
                                                E
                                                ∖
                                             
                                             
                                                {
                                                f
                                                }
                                             
                                          
                                       
                                       
                                          (
                                          
                                             p
                                             f
                                          
                                          −
                                          
                                             p
                                             i
                                          
                                          )
                                       
                                       ]
                                    
                                    .
                                 
                              
                           
                        
                     

Given an overall demand of X, we can compute the demand for an individual firm by multiplying the firm’s market share by X:

                           
                              (3)
                              
                                 
                                    
                                       
                                          x
                                          ^
                                       
                                       f
                                    
                                    =
                                    X
                                    
                                       
                                          ϕ
                                          ^
                                       
                                       f
                                    
                                    .
                                 
                              
                           
                        
                     

Note that in this model the overall demand is inelastic; however, for the individual firms, demand is lost or gained based on the switching propensity, b, and the price differences between firms.

The demand model (
                           
                              D
                              ^
                           
                        ) is only valid if prices are such that all firms have positive demand. If this condition is violated, some firms will have negative demand which is meaningless and arises because 
                           
                              D
                              ^
                           
                         does not include all the boundary conditions that are present in the full demand model. With an arbitrary number of firms offering arbitrary prices, the true demand model is very difficult to write as a closed-form expression, thus for computational reasons (and for ease of understanding) we express the full demand model as an algorithm.

If each firm 
                           
                              i
                              ∈
                              E
                           
                         chooses a price pi
                        , we can compute demand for firm f from the following algorithm.

                           
                              1.
                              Define 
                                    
                                       E
                                       ¯
                                    
                                  initially to be the set of firms who have entered the retail market, i.e. 
                                    
                                       
                                          E
                                          ¯
                                       
                                       =
                                       E
                                    
                                 .

For each firm 
                                    
                                       f
                                       ∈
                                       
                                          E
                                          ¯
                                       
                                       ,
                                    
                                  compute 
                                    
                                       
                                          
                                             ϕ
                                             f
                                          
                                          =
                                          
                                             1
                                             
                                                
                                                   |
                                                
                                                
                                                   E
                                                   ¯
                                                
                                                
                                                   |
                                                
                                             
                                          
                                          
                                             [
                                             1
                                             −
                                             b
                                             
                                                ∑
                                                
                                                   i
                                                   ∈
                                                   
                                                      E
                                                      ¯
                                                   
                                                   
                                                      ∖
                                                      
                                                         {
                                                         f
                                                         }
                                                      
                                                   
                                                
                                             
                                             
                                                (
                                                
                                                   p
                                                   f
                                                
                                                −
                                                
                                                   p
                                                   i
                                                
                                                )
                                             
                                             ]
                                          
                                       
                                    
                                 . For each firm 
                                    
                                       f
                                       ∈
                                       
                                          (
                                          
                                             F
                                             g
                                          
                                          ∪
                                          
                                             F
                                             r
                                          
                                          )
                                       
                                       
                                          ∖
                                       
                                       
                                          E
                                          ¯
                                       
                                       ,
                                    
                                  set 
                                    
                                       
                                          ϕ
                                          f
                                       
                                       =
                                       0
                                    
                                 .

If 
                                    
                                       
                                          ϕ
                                          f
                                       
                                       ≥
                                       0
                                       ,
                                       
                                       ∀
                                       f
                                       ∈
                                       
                                          E
                                          ¯
                                       
                                    
                                  then end.

Remove 
                                    
                                       arg
                                       
                                          max
                                          
                                             f
                                             ∈
                                             
                                                E
                                                ¯
                                             
                                          
                                       
                                       
                                          {
                                          
                                             p
                                             f
                                          
                                          }
                                       
                                    
                                  from 
                                    
                                       E
                                       ¯
                                    
                                 .
                                    8
                                 
                                 
                                    8
                                    Note that the firm removed must have negative market-share, since ϕf
                                        is a decreasing function of pf
                                       , and at least one firm has negative market-share.
                                 
                              

Go to step 2.

Below we present a theorem which states that any firm re-entering the market at the termination of the above algorithm would receive a negative market-share. This ensures that the solution computed from this algorithm is consistent with the assumptions.

                           Theorem 3.1
                           
                              Any firm who is not in the market at the end of the above algorithm would receive a negative market-share if they were to re-enter.
                           

According to the algorithm a firm will leave the market if its market-share is negative. Thus if a firm exits, it cannot immediately re-enter. Moreover, any firm that had exited previously must have a retail price higher than the most recent firm to exit.

Therefore, since the most recent firm to have exited would receive a negative demand if it were to re-enter, if any other firm were to re-enter it would also receive a negative market share (since its retail price is higher).□

In the retail market, firms only form contracts. No electricity is actually produced or supplied at this stage. Generation and delivery take place in the second stage of the market, typically known as the Wholesale Market. At the time the wholesale market is run, any uncertainty in the market (see below for more details) is resolved, so all parameters, including demand in particular, are known exactly before any offers are placed. The wholesale market is a standard nodal pricing market. Generators make offers to sell certain quantities of electricity at specified prices. Retailers submit how much demand they need to satisfy (since demand is inelastic, there is no reason for retailers to submit bids). The market will dispatch generators in such a way so as to satisfy demand at the lowest possible cost.

The focus of this paper is on the retail market, so for simplicity we assume that the wholesale market is perfectly competitive. This is a simple assumption about the offering behaviour of the firms, since the offers are set to the plants’ marginal costs.
                           9
                        
                        
                           9
                           Other offering behaviour can be modeled through supply function or Cournot equilibria, but since, in this paper, our main interest is in retail market behaviour, we have decided to assume competitive behaviour in the wholesale market.
                         Given these offers, a system operator solves an optimization problem, the economic dispatch problem (see Alvey, Goodwin, Ma, Streiffert, & Sun, 1998), to minimize the cost of satisfying the demand, yielding the optimal generation and nodal prices. These nodal prices are defined to be the marginal cost of an additional unit of demand at each node.

In this paper we consider two possible sources of uncertainty (although the model itself is not limited to just these two). One source arises from demand uncertainty from retail consumers. In this model, the parameter X in Eq. (3) may be a random variable drawn from a known distribution. This uncertainty is resolved after the retail market prices are set, but before the wholesale market clears. Another possible source of uncertainly (and therefore risk) is the cost of water to firms owning hydro generation. When water storage is low, the opportunity cost of using water is higher. However, future river flows and lake levels are unknown when prices are set in the retail market, so firms are uncertain about the value of storage. These parameters are realized before the wholesale market is cleared.

We define Ω to be the set of possible realizations of uncertainty. For a given ω ∈ Ω, we superscript any variables whose outcome depends upon the realization of uncertainty; e.g. 
                           
                              x
                              f
                              ω
                           
                         is the demand for electricity from firm f in state ω. Any uncertainty in the model is resolved between the first and second stages. That is, firms deciding whether to enter and then setting prices in the retail market do so without knowledge of the actual realization of the uncertain variables – they know only the distribution of the variables. However, all uncertainty is resolved before the wholesale market opens, so firms making offers at this stage do so with full information.

Each retailer in this model, vertically integrated with a generator or not, seeks to maximize (risk-adjusted) profit. Let 
                           E
                         be the set of retail market entrants; for a given outcome, ω ∈ Ω, in the wholesale market, the profit earned by a retailer is

                           
                              
                                 
                                    
                                       π
                                       f
                                       ω
                                    
                                    
                                       (
                                       E
                                       )
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   
                                                      (
                                                      
                                                         p
                                                         f
                                                      
                                                      −
                                                      
                                                         c
                                                         ω
                                                      
                                                      )
                                                   
                                                   
                                                      x
                                                      f
                                                      ω
                                                   
                                                   +
                                                   
                                                      P
                                                      f
                                                      ω
                                                   
                                                   ,
                                                
                                             
                                             
                                                
                                                   f
                                                   ∈
                                                   E
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      P
                                                      f
                                                      ω
                                                   
                                                   ,
                                                
                                             
                                             
                                                
                                                   
                                                      otherwise
                                                   
                                                   ,
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where cω
                         is the wholesale clearing price and 
                           
                              P
                              f
                              ω
                           
                         is the profit firm f makes in the wholesale market under realization ω ∈ Ω.

In the risk-neutral case, a firm will simply be interested in maximizing its expected profit in the retail plus wholesale markets. In the risk-averse case, the firm will instead maximize expected profit less a weighted measure of risk (in this case: CVaR), as we discussed in Section 2. Using θ ∈ [0, 1] as a weighting on risk and return, we define the following risk-adjusted profit function for a firm f
                        
                           
                              (4)
                              
                                 
                                    
                                       π
                                       f
                                    
                                    =
                                    
                                       (
                                       1
                                       −
                                       θ
                                       )
                                    
                                    
                                       E
                                       ω
                                    
                                    
                                       [
                                       
                                          π
                                          f
                                          ω
                                       
                                       ]
                                    
                                    −
                                    θ
                                    
                                       
                                          CVaR
                                       
                                       α
                                    
                                    
                                       (
                                       
                                          π
                                          f
                                          ω
                                       
                                       )
                                    
                                    .
                                 
                              
                           
                        
                     

In the retail market, firms simultaneously choose prices so as to maximize their risk-adjusted profit function. For a given set of firms, 
                           
                              E
                              ,
                           
                         having entered into the market, we denote the retail market game using demand model 
                           D
                         as 
                           
                              G
                              E
                           
                         (or 
                           
                              
                                 G
                                 ^
                              
                              E
                           
                         when demand model 
                           
                              D
                              ^
                           
                         is used).

Later when we introduce the full game, we will prove that under certain conditions, the equilibria arising from using the two different demand models 
                           D
                         and 
                           
                              D
                              ^
                           
                         are identical. We leave this discussion for Section 3.5. However, before we consider the full risk-averse model, we will present a theorem for the case where all firms are risk-neutral.

                           Theorem 3.2
                           
                              Given demand model
                              
                                 D
                               
                              and assuming the wholesale market is competitive, when firms are risk-neutral, all firms in the retail market choose identical prices for their retail sales, and each firm receives an equal market share. Furthermore, as the number of firms in the market increases, the equilibrium retail prices tend to the demand-weighted average wholesale prices.
                           

See appendix.□

With the above structure in place, we can formally define the full model. The structure is as follows. At stage 0, each firm 
                           
                              f
                              ∈
                              
                                 F
                                 g
                              
                              ∪
                              
                                 F
                                 r
                              
                           
                         simultaneously decides whether to enter the retail market or not. Some set 
                           
                              E
                              ⊆
                              
                                 F
                                 g
                              
                              ∪
                              
                                 F
                                 r
                              
                           
                         choose to enter. (Note that because we assume all retail-only firms are symmetric, our results will merely give the number of such firms entering at equilibrium, not which firms.) At stage 1, retail firms choose prices as described in Section 3.1 and realise retail contract demand accordingly, and at stage 2 generators make bids in the wholesale market as described in Section 3.2, which subsequently clears to realize the state-dependent wholesale price. Firms then realize profits from both the retail market and the wholesale market.

The full game comprising all three stages will be denoted 
                           G
                         if demand model 
                           D
                         is used (or 
                           
                              G
                              ^
                           
                         when 
                           
                              D
                              ^
                           
                         is used). In the appendix, we prove that, under certain conditions, the equilibria for games 
                           G
                         and 
                           
                              G
                              ^
                           
                         are identical.
                           10
                        
                        
                           10
                           See Lemma 7.6 and Theorem 7.7 for details.
                         Thus, for the remainder of this paper will restrict our interest to the game 
                           
                              G
                              ^
                           
                        .

Under the assumption that the consumers have no preference toward incumbents over new entrants we can once again use the demand functions given by Eq. (2); this equation is repeated below for convenience:

                           
                              (5)
                              
                                 
                                    
                                       
                                          ϕ
                                          ^
                                       
                                       f
                                    
                                    =
                                    
                                       1
                                       
                                          |
                                          E
                                          |
                                       
                                    
                                    
                                       [
                                       1
                                       −
                                       b
                                       
                                          ∑
                                          
                                             
                                                i
                                                ∈
                                                E
                                                ∖
                                             
                                             
                                                {
                                                f
                                                }
                                             
                                          
                                       
                                       
                                          (
                                          
                                             p
                                             f
                                          
                                          −
                                          
                                             p
                                             i
                                          
                                          )
                                       
                                       ]
                                    
                                    .
                                 
                              
                           
                        
                     

In this section, we will construct an example of retail competition at a single node, using the model introduced in Section 3. We will first examine the outcome of the retail competition stage if all firms are risk-neutral, and then compare this to the equilibrium when one or both firms are risk-averse. Finally, we will couple the first-stage entry model with the retail competition stage and investigate how risk-aversion affects the number of firms willing to enter the retail market.

Consider a market where the network has a single node, and suppose retail demand is equal to 150 megawatts and totally inelastic. In the market there are two firms, each with a retail base. Firm A owns a hydro plant with capacity 100 megawatts and cost h dollar per megawatt-hour and firm B owns a thermal plant with capacity 100 megawatts and cost 50 dollars per megawatt-hour. The hydro costs are uncertain when the retail prices are chosen, however, it is common knowledge that the hydro costs, h are distributed uniformly between 0 and 100. We set the cross-elasticity, b to be 
                           
                              1
                              75
                           
                         for all the examples in this section.

First, we solve for the optimal dispatch as a function of h. This gives the following dispatch quantities, qA
                        , qB
                         for each plant and clearing price, c.

                           
                              
                                 
                                    
                                       
                                          
                                             q
                                             A
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             {
                                             
                                                
                                                   
                                                      
                                                         100
                                                         ,
                                                      
                                                   
                                                   
                                                      
                                                         h
                                                         ≤
                                                         50
                                                         ,
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         50
                                                         ,
                                                      
                                                   
                                                   
                                                      
                                                         h
                                                         >
                                                         50
                                                         ,
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             q
                                             B
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             {
                                             
                                                
                                                   
                                                      
                                                         50
                                                         ,
                                                      
                                                   
                                                   
                                                      
                                                         h
                                                         ≤
                                                         50
                                                         ,
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         100
                                                         ,
                                                      
                                                   
                                                   
                                                      
                                                         h
                                                         >
                                                         50
                                                         ,
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          c
                                       
                                       
                                          =
                                       
                                       
                                          
                                             {
                                             
                                                
                                                   
                                                      
                                                         50
                                                         ,
                                                      
                                                   
                                                   
                                                      
                                                         h
                                                         ≤
                                                         50
                                                         ,
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         h
                                                         ,
                                                      
                                                   
                                                   
                                                      
                                                         h
                                                         >
                                                         50
                                                         .
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Now we can compute the expected profits for the firms as

                           
                              
                                 
                                    
                                       
                                          
                                             π
                                             A
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             E
                                             
                                                [
                                                
                                                   
                                                      q
                                                      A
                                                   
                                                   ×
                                                   
                                                      (
                                                      
                                                         c
                                                         −
                                                         h
                                                      
                                                      )
                                                   
                                                   +
                                                   
                                                      x
                                                      A
                                                   
                                                   
                                                      (
                                                      
                                                         p
                                                         A
                                                      
                                                      −
                                                      c
                                                      )
                                                   
                                                
                                                ]
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                
                                                   1
                                                   100
                                                
                                             
                                             
                                                [
                                                
                                                   ∫
                                                   0
                                                   50
                                                
                                                
                                                   100
                                                   
                                                      (
                                                      
                                                         50
                                                         −
                                                         h
                                                      
                                                      )
                                                   
                                                   d
                                                   h
                                                
                                                +
                                                
                                                   x
                                                   A
                                                
                                                
                                                   ∫
                                                   
                                                      0
                                                   
                                                   50
                                                
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            p
                                                            A
                                                         
                                                         −
                                                         50
                                                      
                                                      )
                                                   
                                                   d
                                                   h
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             +
                                             
                                             
                                                x
                                                A
                                             
                                             
                                                ∫
                                                
                                                   50
                                                
                                                100
                                             
                                             
                                                
                                                   (
                                                   
                                                      
                                                         p
                                                         A
                                                      
                                                      −
                                                      h
                                                   
                                                   )
                                                
                                                d
                                                h
                                             
                                             ]
                                          
                                       
                                    
                                    
                                       
                                       
                                          =
                                       
                                       
                                          
                                             1250
                                             +
                                             
                                                x
                                                A
                                             
                                             
                                                (
                                                
                                                   
                                                      p
                                                      A
                                                   
                                                   −
                                                   62.5
                                                
                                                )
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        Substituting in xA
                         (with 
                           
                              b
                              =
                              
                                 1
                                 75
                              
                           
                        ) and differentiating with respect to pA
                         gives

                           
                              
                                 
                                    
                                       
                                          
                                             
                                                ∂
                                                
                                                   π
                                                   A
                                                
                                             
                                             
                                                ∂
                                                
                                                   p
                                                   A
                                                
                                             
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             75
                                             −
                                             2
                                             
                                                p
                                                A
                                             
                                             +
                                             
                                                p
                                                B
                                             
                                             +
                                             62.5
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Similarly for firm B we find

                           
                              
                                 
                                    
                                       
                                          ∂
                                          
                                             π
                                             B
                                          
                                       
                                       
                                          ∂
                                          
                                             p
                                             B
                                          
                                       
                                    
                                    =
                                    75
                                    −
                                    2
                                    
                                       p
                                       B
                                    
                                    +
                                    
                                       p
                                       A
                                    
                                    +
                                    62.5
                                    .
                                 
                              
                           
                        
                     

Assuming an interior solution, these first order conditions yield equilibrium prices

                           
                              
                                 
                                    
                                       p
                                       A
                                       e
                                    
                                    =
                                    
                                       p
                                       B
                                       e
                                    
                                    =
                                    137.5
                                    
                                    dollars
                                    .
                                 
                              
                           
                        
                     

Observe that here, in spite of the different generation assets that the firms own, they set identical prices in the retail market and share the retail demand equally. This is consistent with the general result of Theorem 3.2.

In a risk-averse setting, the guarantee of symmetry we had from Theorem 3.2 is lost. This is because the outcome of the wholesale market cannot be merely treated as a constant in the risk-adjusted profit maximization problem. To examine the impact of this change, we extend the example introduced in Section 4.1 to incorporate risk using the CVaR measure.

For this example, we will define the CVaR risk level to be α= 0.1 for both firms, and examine the effect of varying θ on the behaviour of the firms. In order to compute the conditional value at risk, we need to rank the profit for each firm as a function of h for each retail price it may choose. The profit for a given h and pA
                         for firm A is

                           
                              
                                 
                                    
                                       π
                                       A
                                       h
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            p
                                                            A
                                                         
                                                         −
                                                         50
                                                      
                                                      )
                                                   
                                                   
                                                      (
                                                      
                                                         75
                                                         −
                                                         
                                                            p
                                                            A
                                                         
                                                         +
                                                         
                                                            p
                                                            B
                                                         
                                                      
                                                      )
                                                   
                                                   +
                                                   100
                                                   
                                                      (
                                                      
                                                         50
                                                         −
                                                         h
                                                      
                                                      )
                                                   
                                                   ,
                                                
                                             
                                             
                                                
                                                   h
                                                   ≤
                                                   50
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            p
                                                            A
                                                         
                                                         −
                                                         h
                                                      
                                                      )
                                                   
                                                   
                                                      (
                                                      
                                                         75
                                                         −
                                                         
                                                            p
                                                            A
                                                         
                                                         +
                                                         
                                                            p
                                                            B
                                                         
                                                      
                                                      )
                                                   
                                                   ,
                                                
                                             
                                             
                                                
                                                   h
                                                   >
                                                   50
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Note from the above equation that so long as the retail demand is positive, the profit of firm A is decreasing in h. The profit for a given h and pB
                         for firm B is

                           
                              
                                 
                                    
                                       π
                                       B
                                       h
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            p
                                                            B
                                                         
                                                         −
                                                         50
                                                      
                                                      )
                                                   
                                                   
                                                      (
                                                      
                                                         75
                                                         −
                                                         
                                                            p
                                                            B
                                                         
                                                         +
                                                         
                                                            p
                                                            A
                                                         
                                                      
                                                      )
                                                   
                                                   ,
                                                
                                             
                                             
                                                
                                                   h
                                                   ≤
                                                   50
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            p
                                                            B
                                                         
                                                         −
                                                         h
                                                      
                                                      )
                                                   
                                                   
                                                      (
                                                      
                                                         75
                                                         −
                                                         
                                                            p
                                                            B
                                                         
                                                         +
                                                         
                                                            p
                                                            A
                                                         
                                                      
                                                      )
                                                   
                                                   +
                                                   100
                                                   
                                                      (
                                                      
                                                         h
                                                         −
                                                         50
                                                      
                                                      )
                                                   
                                                   ,
                                                
                                             
                                             
                                                
                                                   h
                                                   >
                                                   50
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

From above we can see that firm B’s profit is invariant over h ∈ [0, 50], however for h > 50 we have

                           
                              
                                 
                                    
                                       
                                          ∂
                                          
                                             π
                                             B
                                             h
                                          
                                       
                                       
                                          ∂
                                          h
                                       
                                    
                                    =
                                    25
                                    +
                                    
                                       p
                                       B
                                    
                                    −
                                    
                                       p
                                       A
                                    
                                    ,
                                 
                              
                           
                        hence if 
                           
                              
                                 p
                                 A
                              
                              −
                              
                                 p
                                 B
                              
                              ≥
                              25
                           
                         then the profit is decreasing in h, whereas if 
                           
                              
                                 p
                                 A
                              
                              −
                              
                                 p
                                 B
                              
                              ≤
                              25
                           
                         the profit is increasing in h. It can be shown that the former case is not possible at equilibrium, hence at an equilibrium 
                           
                              
                                 p
                                 A
                              
                              −
                              
                                 p
                                 B
                              
                              ≤
                              25
                           
                        . We proceed by assuming this inequality is valid. We can write the risk-adjusted profit functions for both firms as follows

                           
                              
                                 
                                    
                                       
                                          
                                             π
                                             A
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                
                                                   1
                                                   −
                                                   
                                                      θ
                                                      A
                                                   
                                                
                                                100
                                             
                                             
                                                ∫
                                                0
                                                100
                                             
                                             
                                                
                                                   π
                                                   A
                                                
                                                
                                                   (
                                                   h
                                                   )
                                                
                                                d
                                                h
                                             
                                             +
                                             
                                                
                                                   θ
                                                   A
                                                
                                                10
                                             
                                             
                                                ∫
                                                
                                                   90
                                                
                                                100
                                             
                                             
                                                
                                                   π
                                                   A
                                                
                                                
                                                   (
                                                   h
                                                   )
                                                
                                                d
                                                h
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                (
                                                
                                                   1
                                                   −
                                                   
                                                      θ
                                                      A
                                                   
                                                
                                                )
                                             
                                             
                                                [
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            p
                                                            A
                                                         
                                                         −
                                                         62.5
                                                      
                                                      )
                                                   
                                                   
                                                      (
                                                      
                                                         75
                                                         +
                                                         
                                                            p
                                                            B
                                                         
                                                         −
                                                         
                                                            p
                                                            A
                                                         
                                                      
                                                      )
                                                   
                                                   +
                                                   1250
                                                
                                                ]
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             +
                                             
                                             
                                                θ
                                                A
                                             
                                             
                                                [
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            p
                                                            A
                                                         
                                                         −
                                                         95
                                                      
                                                      )
                                                   
                                                   
                                                      (
                                                      
                                                         75
                                                         +
                                                         
                                                            p
                                                            B
                                                         
                                                         −
                                                         
                                                            p
                                                            A
                                                         
                                                      
                                                      )
                                                   
                                                
                                                ]
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              
                                 
                                    
                                       
                                          
                                             π
                                             B
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                
                                                   1
                                                   −
                                                   
                                                      θ
                                                      B
                                                   
                                                
                                                100
                                             
                                             
                                                ∫
                                                0
                                                100
                                             
                                             
                                                
                                                   π
                                                   B
                                                
                                                
                                                   (
                                                   h
                                                   )
                                                
                                                d
                                                h
                                             
                                             +
                                             
                                                
                                                   θ
                                                   B
                                                
                                                10
                                             
                                             
                                                ∫
                                                0
                                                10
                                             
                                             
                                                
                                                   π
                                                   B
                                                
                                                
                                                   (
                                                   h
                                                   )
                                                
                                                d
                                                h
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                (
                                                
                                                   1
                                                   −
                                                   
                                                      θ
                                                      B
                                                   
                                                
                                                )
                                             
                                             
                                                [
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            p
                                                            B
                                                         
                                                         −
                                                         62.5
                                                      
                                                      )
                                                   
                                                   
                                                      (
                                                      
                                                         75
                                                         +
                                                         
                                                            p
                                                            A
                                                         
                                                         −
                                                         
                                                            p
                                                            B
                                                         
                                                      
                                                      )
                                                   
                                                   +
                                                   1250
                                                
                                                ]
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             +
                                             
                                             
                                                θ
                                                B
                                             
                                             
                                                [
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            p
                                                            B
                                                         
                                                         −
                                                         50
                                                      
                                                      )
                                                   
                                                   
                                                      (
                                                      
                                                         75
                                                         +
                                                         
                                                            p
                                                            A
                                                         
                                                         −
                                                         
                                                            p
                                                            B
                                                         
                                                      
                                                      )
                                                   
                                                
                                                ]
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

We can then solve for the equilibrium, from first order conditions, giving
                           11
                        
                        
                           11
                           Note that it is necessary to verify this equilibrium, by considering incentives for the players to deviate such that 
                                 
                                    
                                       p
                                       A
                                    
                                    −
                                    
                                       p
                                       B
                                    
                                    >
                                    25
                                 
                              . This analysis is available upon request from the authors.
                        
                        
                           
                              
                                 
                                    
                                       p
                                       A
                                       e
                                    
                                    =
                                    
                                       5
                                       6
                                    
                                    
                                       (
                                       
                                          165
                                          +
                                          26
                                          
                                             θ
                                             A
                                          
                                          −
                                          5
                                          
                                             θ
                                             B
                                          
                                       
                                       )
                                    
                                    ,
                                    
                                    
                                       p
                                       B
                                       e
                                    
                                    =
                                    
                                       5
                                       6
                                    
                                    
                                       (
                                       
                                          165
                                          +
                                          13
                                          
                                             θ
                                             A
                                          
                                          −
                                          10
                                          
                                             θ
                                             B
                                          
                                       
                                       )
                                    
                                    .
                                 
                              
                           
                        
                     

Note that if we set 
                           
                              
                                 θ
                                 A
                              
                              =
                              
                                 θ
                                 B
                              
                              =
                              0
                           
                         then we recover the risk-neutral equilibrium. Moreover, as firm A’s risk-aversion weighting is increased, the equilibrium prices of both players increase; whereas as firm B’s risk-aversion weighting is increased, the equilibrium prices of both players decrease. This result is due to the wholesale market positions of the firms, and the way risk-aversion tends to emphasize the worst-case scenarios.

Firm A, who owns hydro generation receives the least profit when hydro costs are high, thus a risk-averse firm emphasizes these occurrences and when optimizing in the retail market sees a higher risk-adjusted ‘average’ spot price. Conversely, firm B, who owns thermal generation receives the least profit when hydro costs are low, thus when determining its optimal retail price sees a lower risk-adjusted ‘average’ spot price. Furthermore, the effects of competition mean that the risk-aversion of one firm will affect the other’s optimal pricing strategy.

This example has illustrated how risk-aversion can affect the retail equilibrium prices. With risk-averse firms we have found an asymmetric equilibrium, whereas when firms are risk-neutral the equilibrium retail pricing strategic was symmetric.

We can extend the example introduced in Sections 4.1 and 4.2 to study when (and how many) firms would enter the market under various conditions.

Using this demand function (with 
                           
                              X
                              =
                              150
                           
                         and 
                           
                              b
                              =
                              
                                 1
                                 75
                              
                           
                        ), we can solve for the equilibrium retail prices as a function of the number of firms entering the market, for various levels of risk-aversion (θ). For the purposes of this example we will assume that the two firms owning generation assets will always participate in the retail market, and that all market participants share the same risk-aversion parameter. When firms are risk neutral, the equilibrium retail prices, as a function of numbers of retailers n ( ≥ 2) are the same for all agents, and are given by

                           
                              (6)
                              
                                 
                                    
                                       p
                                       A
                                       e
                                    
                                    =
                                    
                                       p
                                       B
                                       e
                                    
                                    =
                                    
                                       p
                                       C
                                       e
                                    
                                    =
                                    62.5
                                    +
                                    
                                       75
                                       
                                          n
                                          −
                                          1
                                       
                                    
                                    ,
                                 
                              
                           
                        where 
                           
                              
                                 p
                                 A
                                 e
                              
                              ,
                           
                        
                        
                           
                              p
                              B
                              e
                           
                         and 
                           
                              p
                              C
                              e
                           
                         are the equilibrium retail prices for the hydro firm, thermal firm, and unhedged retailers, respectively.

On the other hand, if firms are all risk averse, the equilibrium is given by:

                           
                              (7)
                              
                                 
                                    
                                       
                                          
                                             p
                                             A
                                             e
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                p
                                                C
                                                e
                                             
                                             =
                                             62.5
                                             +
                                             
                                                75
                                                
                                                   n
                                                   −
                                                   1
                                                
                                             
                                             +
                                             
                                                
                                                   26
                                                   n
                                                   −
                                                   31
                                                
                                                
                                                   2
                                                   n
                                                   −
                                                   1
                                                
                                             
                                             θ
                                             ,
                                          
                                       
                                    
                                    
                                       
                                          
                                             p
                                             B
                                             e
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             62.5
                                             +
                                             
                                                75
                                                
                                                   n
                                                   −
                                                   1
                                                
                                             
                                             +
                                             
                                                
                                                   8
                                                   n
                                                   −
                                                   13
                                                
                                                
                                                   2
                                                   n
                                                   −
                                                   1
                                                
                                             
                                             θ
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     


                        Eqs. (6) and (7) show that as the number of entrants into the retail market increases, the equilibrium prices for the firms tend towards the demand-weighted average wholesale price when firms are risk-neutral. However, risk-aversion leads to all retailers increasing their prices in equilibrium. We observe from the equilibrium that the firm with thermal generation increases its price less than other retailers; this is because it is not as concerned about high prices.

We will now determine how many unhedged retailers will wish to enter the market. In Fig. 1
                         we plot the risk-adjusted profits of the entering firms (those without generation assets) as functions of risk-aversion parameter θ. In this plot we have included a cost of entry; this dashed line is the line above which firms would have had incentive to enter the market. When the profit is below this line one firm (or more) would have not entered the market at equilibrium.

We can therefore see that for a cost of entry of 1,600 dollars per period, for θ ∈ [0, 0.317] one unhedged retailer will enter the market, whereas for θ ∈ (0.317, 1] no pure retailers enter, leaving just the two firms owning generation in the retail market. The expected profits for all firms, as a function of their risk-aversion parameter, θ (with the equilibrium number of firms entering the market) can be seen in Fig. 2
                        .

We can see that as firms become more risk-averse, fewer have incentive to enter the retail market, allowing the firms already in the market to charge higher prices and therefore make higher expected profits. However the firms’ expected profits may decline for high levels of risk-aversion, because of their focus on the worst-case scenarios. For low levels of risk-aversion, one unhedged retailer enters the market; this firm has incentive to increase its retail price as it becomes more risk-averse (since it is concerned with the possibility of high wholesale prices). This risk-aversion leads to higher expected profits for retailers. However, as the risk-aversion increases, this firm chooses not to enter, and the thermal owner, who benefits from higher prices, becomes more dominant. This leads to a situation where the hydro firm’s expected profit begins to decrease as the two firms become more risk-averse. This occurs because the thermal agent is able to capture a portion of the hydro’s retail market share, increasing the thermal firm’s profit, and decreasing the profit for the hydro firm.

@&#SUMMARY@&#

So far in the paper we have introduced a three-stage model of risk-averse retailers competing in an electricity market. In the

single-node examples that we have examined the uncertainty has been represented by through continuous distributions and the examples have been solved analytically. In the next section we will consider multiple-node transmission networks, and use Monte-Carlo sampling to create the possible scenarios. We will solve these problems numerically as complementarity problems.

Finally we extend the model introduced in Section 3 to accommodate networks. Assume the market now operates on a network with multiple nodes, 
                        
                           n
                           ∈
                           N
                        
                     . We denote by 
                        
                           
                              E
                              n
                           
                           ⊆
                           
                              F
                              g
                           
                           ∪
                           
                              F
                              r
                           
                        
                      the set of firms that have entered the retail market at node n. As before, there is uncertainty about future demand levels and nodal prices. The different scenarios are indexed by ω ∈ Ω.

In order to find the most efficient way to allocate electricity over a network, a dispatch model is required. This means that it is more difficult to model the uncertainty using continuous distribution functions. Thus we turn to discrete distribution functions instead, and employ computational methods to find equilibria for game 
                        
                           G
                           ^
                        
                     . We incorporate CVaR using a formulation from Rockafellar and Uryasev (2000). (See expression (1) and the appendix.)

The notation for this section extends the model of Section 3 with the addition of a subscript n where a parameter is specific to a node n. Where a parameter also refers to a particular firm, we adopt the convention that the node subscript comes first, followed by the firm subscript. The parameters and variables are amended as listed below.
Parameters:
                     
                        
                           •
                           
                              
                                 
                                    c
                                    n
                                    ω
                                 
                               is the wholesale price in scenario ω at node n;


                              
                                 
                                    X
                                    n
                                    ω
                                 
                               is the total retail demand in scenario ω at node n;


                              pnf
                               is the retail price offered by firm f at node n, and 
                                 
                                    p
                                    
                                       −
                                       i
                                    
                                 
                               is a matrix consisting of elements pnf
                              , excluding column i;


                              
                                 
                                    P
                                    f
                                    ω
                                 
                               is the wholesale profit for firm f in scenario ω;


                              ρ is the probability of scenario ω.
                                 12
                              
                              
                                 12
                                 In this paper, we have assumed all scenarios are equally likely, however this can be generalised.
                              
                           


                              ηf
                               is the α-quantile profit of firm f;


                              
                                 
                                    v
                                    f
                                    ω
                                 
                               is the positive deviation from the α-quantile profit of firm j;


                              
                                 
                                    w
                                    f
                                    ω
                                 
                               is the negative deviation from the α-quantile profit of firm j;


                              ϕnf
                               is the realised retail market-share for firm f at node n;


                              
                                 
                                    π
                                    f
                                    ω
                                 
                               is the profit for firm f in scenario ω;


                              pnf
                               is the retail price offered by firm f at node n.

Below we give a mathematical program that maximizes a single firm’s risk-adjusted expected profit as a function of its own retail prices, given the retail prices chosen by the other firms (assuming demand model 
                        
                           D
                           ^
                        
                     ). From a game-theoretic perspective, the solution to this mathematical program is the best-response of the firm.

                        
                           
                              
                                 
                                    
                                       
                                          
                                             Π
                                             f
                                          
                                          
                                             (
                                             
                                                p
                                                
                                                   −
                                                   f
                                                
                                             
                                             )
                                          
                                          =
                                          max
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                             
                                                ω
                                                ∈
                                                Ω
                                             
                                          
                                          
                                             ρ
                                             
                                                π
                                                f
                                                ω
                                             
                                          
                                          −
                                          
                                             θ
                                             α
                                          
                                          
                                             ∑
                                             
                                                ω
                                                ∈
                                                Ω
                                             
                                          
                                          
                                             ρ
                                             
                                                [
                                                
                                                   
                                                      (
                                                      
                                                         1
                                                         −
                                                         α
                                                      
                                                      )
                                                   
                                                   
                                                      w
                                                      f
                                                      ω
                                                   
                                                   +
                                                   α
                                                   
                                                      v
                                                      f
                                                      ω
                                                   
                                                
                                                ]
                                             
                                          
                                       
                                    
                                    
                                       
                                    
                                    
                                       
                                    
                                 
                                 
                                    
                                       
                                          s
                                          .t
                                          .
                                          
                                       
                                    
                                    
                                       
                                          
                                             π
                                             f
                                             ω
                                          
                                          =
                                          
                                             η
                                             f
                                          
                                          +
                                          
                                             v
                                             f
                                             ω
                                          
                                          −
                                          
                                             w
                                             f
                                             ω
                                          
                                       
                                    
                                    
                                       
                                          [
                                          
                                             λ
                                             f
                                             ω
                                          
                                          ]
                                       
                                    
                                    
                                       
                                          ∀
                                          ω
                                          ∈
                                          Ω
                                       
                                    
                                 
                                 
                                    
                                       
                                    
                                    
                                       
                                          
                                             π
                                             f
                                             ω
                                          
                                          =
                                          
                                             ∑
                                             
                                                n
                                                ∈
                                                N
                                             
                                          
                                          
                                             [
                                             
                                                
                                                   X
                                                   n
                                                   ω
                                                
                                                
                                                   ∑
                                                   
                                                      i
                                                      ∈
                                                      
                                                         E
                                                         n
                                                      
                                                      ∩
                                                      
                                                         {
                                                         f
                                                         }
                                                      
                                                   
                                                
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            p
                                                            
                                                               n
                                                               i
                                                            
                                                         
                                                         −
                                                         
                                                            c
                                                            n
                                                            ω
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      
                                                         ϕ
                                                         ^
                                                      
                                                      
                                                         n
                                                         i
                                                      
                                                   
                                                
                                             
                                             ]
                                          
                                          +
                                          
                                             P
                                             f
                                             ω
                                          
                                          
                                       
                                    
                                    
                                       
                                          [
                                          
                                             μ
                                             f
                                             ω
                                          
                                          ]
                                       
                                    
                                    
                                       
                                          ∀
                                          ω
                                          ∈
                                          Ω
                                       
                                    
                                 
                                 
                                    
                                       
                                    
                                    
                                       
                                          
                                             
                                                ϕ
                                                ^
                                             
                                             
                                                n
                                                f
                                             
                                          
                                          =
                                          
                                             1
                                             
                                                |
                                                
                                                   E
                                                   n
                                                
                                                |
                                             
                                          
                                          
                                             [
                                             
                                                1
                                                +
                                                b
                                                
                                                   ∑
                                                   
                                                      i
                                                      ∈
                                                      
                                                         E
                                                         n
                                                      
                                                      
                                                         ∖
                                                      
                                                      
                                                         {
                                                         f
                                                         }
                                                      
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         p
                                                         
                                                            n
                                                            i
                                                         
                                                      
                                                      −
                                                      
                                                         p
                                                         
                                                            n
                                                            f
                                                         
                                                      
                                                   
                                                   )
                                                
                                             
                                             ]
                                          
                                       
                                    
                                    
                                       
                                          
                                             [
                                             
                                                ν
                                                
                                                   n
                                                   f
                                                
                                             
                                             ]
                                          
                                          
                                       
                                    
                                    
                                       
                                          ∀
                                          n
                                          ∈
                                          N
                                       
                                    
                                 
                                 
                                    
                                       
                                    
                                    
                                       
                                          
                                             w
                                             f
                                             ω
                                          
                                          ,
                                          
                                             v
                                             f
                                             ω
                                          
                                          ≥
                                          0
                                       
                                    
                                    
                                       
                                    
                                    
                                       
                                          ∀
                                          ω
                                          ∈
                                          Ω
                                          .
                                       
                                    
                                 
                              
                           
                        
                     The above problem, 
                        
                           
                              P
                              f
                           
                           
                              (
                              
                                 p
                                 
                                    −
                                    f
                                 
                              
                              )
                           
                           ,
                        
                      can be shown to be equivalent to a convex optimization problem (see Lemma 7.1 in the appendix). Therefore the solution to 
                        
                           
                              P
                              f
                           
                           
                              (
                              
                                 p
                                 
                                    −
                                    f
                                 
                              
                              )
                           
                        
                      is the solution to the system of KKTs for 
                        
                           
                              P
                              f
                           
                           
                              (
                              
                                 p
                                 
                                    −
                                    f
                                 
                              
                              )
                           
                           ,
                        
                      given below (and these are valid for each firm 
                        
                           f
                           ∈
                           E
                        
                     ).

                        
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             π
                                             f
                                             ω
                                          
                                          =
                                          
                                             η
                                             f
                                          
                                          +
                                          
                                             v
                                             f
                                             ω
                                          
                                          −
                                          
                                             w
                                             f
                                             ω
                                          
                                       
                                    
                                    
                                    
                                       
                                          ∀
                                          ω
                                          ∈
                                          Ω
                                          ,
                                          
                                          ∀
                                          f
                                          ∈
                                          F
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                             ∑
                                             
                                                n
                                                ∈
                                                N
                                             
                                          
                                          
                                             [
                                             
                                                
                                                   X
                                                   n
                                                   ω
                                                
                                                
                                                   ∑
                                                   
                                                      i
                                                      ∈
                                                      
                                                         E
                                                         n
                                                      
                                                      ∩
                                                      
                                                         {
                                                         f
                                                         }
                                                      
                                                   
                                                
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            p
                                                            
                                                               n
                                                               i
                                                            
                                                         
                                                         
                                                         −
                                                         
                                                         
                                                            c
                                                            n
                                                            ω
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      
                                                         ϕ
                                                         ^
                                                      
                                                      
                                                         n
                                                         i
                                                      
                                                   
                                                
                                             
                                             ]
                                          
                                          
                                          +
                                          
                                          
                                             P
                                             f
                                             ω
                                          
                                          
                                          −
                                          
                                          
                                             π
                                             f
                                             ω
                                          
                                          
                                          =
                                          
                                          0
                                          
                                       
                                    
                                    
                                    
                                       
                                          ∀
                                          ω
                                          ∈
                                          Ω
                                          ,
                                          
                                          ∀
                                          f
                                          ∈
                                          F
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                             
                                                ϕ
                                                ^
                                             
                                             
                                                n
                                                f
                                             
                                          
                                          =
                                          
                                             1
                                             
                                                |
                                                
                                                   E
                                                   n
                                                
                                                |
                                             
                                          
                                          
                                             [
                                             
                                                1
                                                +
                                                b
                                                
                                                   ∑
                                                   
                                                      i
                                                      ∈
                                                      
                                                         E
                                                         n
                                                      
                                                      
                                                         ∖
                                                      
                                                      
                                                         {
                                                         f
                                                         }
                                                      
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         p
                                                         
                                                            n
                                                            i
                                                         
                                                      
                                                      −
                                                      
                                                         p
                                                         
                                                            n
                                                            f
                                                         
                                                      
                                                   
                                                   )
                                                
                                             
                                             ]
                                          
                                       
                                    
                                    
                                    
                                       
                                          ∀
                                          f
                                          ∈
                                          
                                             E
                                             n
                                          
                                          ,
                                          
                                          ∀
                                          n
                                          ∈
                                          N
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          −
                                          ρ
                                          +
                                          
                                             λ
                                             f
                                             ω
                                          
                                          +
                                          
                                             μ
                                             f
                                             ω
                                          
                                          =
                                          0
                                       
                                    
                                    
                                    
                                       
                                          ∀
                                          ω
                                          ∈
                                          Ω
                                          ,
                                          
                                          ∀
                                          f
                                          ∈
                                          F
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          −
                                          
                                             ∑
                                             
                                                ω
                                                ∈
                                                Ω
                                             
                                          
                                          
                                             λ
                                             f
                                             ω
                                          
                                          =
                                          0
                                       
                                    
                                    
                                    
                                       
                                          ∀
                                          f
                                          ∈
                                          F
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          −
                                          
                                             ∑
                                             
                                                ω
                                                ∈
                                                Ω
                                             
                                          
                                          
                                             
                                                X
                                                ω
                                             
                                             
                                                
                                                   ϕ
                                                   ^
                                                
                                                
                                                   n
                                                   f
                                                
                                             
                                             
                                                μ
                                                f
                                                ω
                                             
                                             +
                                             b
                                             
                                                
                                                   
                                                      |
                                                      
                                                         E
                                                         n
                                                      
                                                      |
                                                   
                                                   −
                                                   1
                                                
                                                
                                                   |
                                                   
                                                      E
                                                      n
                                                   
                                                   |
                                                
                                             
                                          
                                          
                                             ν
                                             
                                                n
                                                f
                                             
                                          
                                          =
                                          0
                                       
                                    
                                    
                                    
                                       
                                          ∀
                                          f
                                          ∈
                                          
                                             E
                                             n
                                          
                                          ,
                                          
                                          ∀
                                          n
                                          ∈
                                          N
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                             ν
                                             
                                                n
                                                f
                                             
                                          
                                          −
                                          
                                             ∑
                                             
                                                ω
                                                ∈
                                                Ω
                                             
                                          
                                          
                                             [
                                             
                                                X
                                                n
                                                ω
                                             
                                             
                                                ∑
                                                
                                                   i
                                                   ∈
                                                   
                                                      E
                                                      n
                                                   
                                                   ∩
                                                   
                                                      {
                                                      f
                                                      }
                                                   
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      p
                                                      
                                                         n
                                                         i
                                                      
                                                   
                                                   −
                                                   
                                                      c
                                                      n
                                                      ω
                                                   
                                                
                                                )
                                             
                                             
                                                μ
                                                f
                                                ω
                                             
                                             ]
                                          
                                          =
                                          0
                                       
                                    
                                    
                                    
                                       
                                          ∀
                                          f
                                          ∈
                                          
                                             E
                                             n
                                          
                                          ,
                                          
                                          ∀
                                          n
                                          ∈
                                          N
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          0
                                          ≤
                                          
                                             v
                                             f
                                             ω
                                          
                                          
                                          
                                          ⊥
                                          
                                          
                                          θ
                                          ρ
                                          −
                                          
                                             λ
                                             f
                                             ω
                                          
                                          ≥
                                          0
                                       
                                    
                                    
                                    
                                       
                                          ∀
                                          ω
                                          ∈
                                          Ω
                                          ,
                                          
                                          ∀
                                          f
                                          ∈
                                          F
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          0
                                          ≤
                                          
                                             w
                                             f
                                             ω
                                          
                                          
                                          
                                          ⊥
                                          
                                          
                                          θ
                                          
                                             
                                                1
                                                −
                                                α
                                             
                                             α
                                          
                                          ρ
                                          +
                                          
                                             λ
                                             f
                                             ω
                                          
                                          ≥
                                          0
                                       
                                    
                                    
                                    
                                       
                                          ∀
                                          ω
                                          ∈
                                          Ω
                                          ,
                                          
                                          ∀
                                          f
                                          ∈
                                          F
                                          .
                                       
                                    
                                 
                              
                           
                        
                     This system of equations is known as a mixed complementarity problem (MCP), which can be solved in GAMS using the PATH solver (Ferris & Munson, 2000). Since each firm is solving a convex optimization problem, any solution to the above MCP provides an equilibrium for 
                        
                           
                              G
                              ^
                           
                           E
                        
                     .

In the appendix we prove that the equilibrium solution we find from the MCP above, is indeed an equilibrium for the game 
                        
                           G
                           E
                        
                     .

In October 2010, the New Zealand Government reorganized the New Zealand Electricity Market. One of the changes implemented was an ‘asset transfer’, in which one of the state-owned firms purchased generation assets from another; this sale took place in June 2011. One of the key aims of this asset transfer was to improve competition in the retail electricity market. All major firms in New Zealand are vertically integrated, owning both generation assets and a portfolio of retail consumers. Despite the existence of five large retailers nationally, many areas of the country are served by no more than two retailers, a fact believed to be due to nodal price risk in the wholesale market. The goal of the asset swap was to give more of the vertically integrated firms a geographically diverse portfolio of generation assets, thus giving those firms the confidence to enter into various retail markets around the country.
                        13
                     
                     
                        13
                        See the discussion document from the Electricity Technical Advisory Group (2009) for more background on the asset swap. This report stated that this reallocation should improve competition in the retail market, by incentivizing gentailers (firms with both generation and retail arms) to enter into new markets; thereby driving prices down for consumers.
                     
                  

Nodal price risk is believed to be a serious problem in the New Zealand market. New Zealand is dominated by hydro generation, however, there is limited water storage, so the availability of hydro generation is dependent on the weather. In so called ‘dry years’, river inflows fall and hydro plants must cut back on generation to conserve water. The resulting constriction of supply can cause wholesale prices to rise up to 1000 percent above average. Firms who rely on hydro generation to satisfy their retail contractions must then buy expensive electricity on the wholesale market and sell at loss in their retail market (since the latter is contractually fixed). This is one source of risk. The other source of risk is due to geographical location. New Zealand has two main islands. The South Island contains excess generation, the North Island conversely has most of the load. If the inter-island cable fails, prices will then diverge sharply between the two islands. Thus a firm without assets in one island will be unlikely to build a retail base in that island, as they will be exposed to wholesale price fluctuations when the inter-island cable is out of service. The asset swap implemented in 2010 is expected to reduce both sources of risk, but formal analysis has been limited to the effect on the wholesale market (Downward, Young, & Zakeri, 2011).

We can use the model presented in this paper to analyze the impact of such an asset swap on the retail market. In particular, we can look at such questions as whether an asset swap causes more retail competition, including new entrants to each market (North and South). We investigate two types of asset swap. One is a physical asset swap, as described above, where two firms swap ownership of physical assets. The other is a virtual asset swap, where the two firms enter a long-term contract to ‘swap’ electricity at two nodes. The virtual asset swap was another recommendation from the 2009 Electricity Technical Advisory Group.

In this example, we will present a two-node network (North and South) with three firms (A,B and C). Prior to any swapping of assets, firm A has two thermal plants in the North, firm B has one thermal plant in the North and one hydro plant in the South and firm C two hydro plants in the South. The asset swap that we consider will consist of firms A and C swapping a thermal in the North and a hydro in the South. These allocations are depicted in Fig. 3.
                         We will also compare this physical swap with a virtual swap, where a financial contract is established, which trades North power for South power between firms A and C. Ignoring any fixed payments, this contract, for x megawatts of power, gives the following payments to the firms (or costs, if negative). For firm A the payment is: 
                           
                              
                                 (
                                 
                                    p
                                    S
                                 
                                 −
                                 
                                    p
                                    N
                                 
                                 )
                              
                              x
                           
                        ; and for firm C the payment is 
                           
                              
                                 (
                                 
                                    p
                                    N
                                 
                                 −
                                 
                                    p
                                    S
                                 
                                 )
                              
                              x
                              ,
                           
                         where pN
                         and pS
                         are the spot prices for North and South power, respectively. This model has been designed based on the New Zealand market, albeit, in a stylized manner.

The production cost of each of the thermal plants is

                           
                              
                                 
                                    
                                       c
                                       T
                                    
                                    
                                       (
                                       q
                                       )
                                    
                                    =
                                    50
                                    q
                                    +
                                    0.05
                                    
                                       q
                                       2
                                    
                                    ,
                                 
                              
                           
                        and for the hydro it is

                           
                              
                                 
                                    
                                       c
                                       H
                                    
                                    
                                       (
                                       q
                                       )
                                    
                                    =
                                    10
                                    q
                                    +
                                    h
                                    
                                       q
                                       2
                                    
                                    ,
                                 
                              
                           
                        where h is a random variable representing water scarcity. For the upcoming examples, h is normally distributed, with mean 0.3 and standard deviation 0.1. (h is restricted to be non-negative, so any negative value of h are replaced by 0.)

The demand in the North is 
                           
                              
                                 d
                                 N
                              
                              =
                              2000
                           
                         megawatts, the demand in the South is 
                           
                              
                                 d
                                 S
                              
                              =
                              1000
                           
                         megawatts, and the nominal capacity of the transmission line is 250 megawatts, with a 5 percent chance of an outage.
                           14
                        
                        
                           14
                           Note that the probability of an outage is independent of h.
                         Given these parameters, using Monte Carlo simulation to generate 1000 scenarios, we solve the dispatch problem (assuming competitive offering behaviour) and record the nodal prices and firm profits. The distributions of nodal price differences and firm profits are shown in Figs. 4 and 5
                         below.

Given which players are in the market, using the formulation detailed in Section 5, we can compute the equilibrium prices for the three firms. For simplicity, we will assume that firms A and B are initially in the retail market in the North and firms B and C are in the retail market in the South and that none of these firms wish to exit (one could think of this as the firms having a high exit cost).

Equilibrium computations here are performed numerically (due to the presence of a dispatch problem), thus we need to set the risk-aversion parameters and the cross-elasticity of the demand, in advance. We set the risk-aversion parameters for all three firms to be identical: 
                           
                              α
                              =
                              0.1
                              ,
                           
                         and 
                           
                              θ
                              =
                              0.5
                           
                         – this means that the firms are maximizing the expected profit less the conditional expectation of the lowest 10 percent of profits with equal weightings on each term. The cross-elasticity of the demand at both nodes is 
                           
                              b
                              =
                              
                                 1
                                 200
                              
                           
                        .

We are interested in determining how the equilibrium pricing changes once a physical or virtual asset swap takes place. To do this we first compute the equilibrium pricing for each of the swap scenarios, assuming the firms in each market are the same as the status quo described above. In Table 1
                        
                         we present the equilibrium pricing before and after the physical asset swap, as well as two virtual swaps. This shows that if the physical asset swap is carried out and no new entrants enter the market then the overall costs to the retail customers increases, whereas with the virtual swaps there is no change to the equilibrium retail pricing. As the firms are less well hedged (i.e. they have less generation where their customers are located), their risk-aversion entices them to increase their prices, thereby reducing their customer base.

Now we will consider the situation where there is full entry (i.e. all three firms are offering retail contracts at both nodes). In Table 2 we show the equilibrium prices and consumer costs for the same four cases, with the ‘before swap’ case serving as a counter-factual for comparative purposes. Once again, we see that the physical asset swap leads to higher overall retail costs, however this time the virtual swaps have decreased prices and lead to lower overall costs for retail consumers. The reasons for these effects are subtle. In the case of the physical swap, since all three firms have a single thermal unit in the North and single hydro in the South, none of the firms are particularly well hedged. The prices have increased because before the swap, there was one well hedged firm at each node, and this firm could offer a lower price than the others, leading to higher competition and lower equilibrium pricing. The situation with the virtual swap is different, there is no physical swap, however there is a contract traded between the firms. Prices in the South drop, because Firm A effectively receives power in the South without bearing the physical risk associated with high water values.

Finally, we consider the full game. In the first stage firms A and B decide whether or not to enter the retail market at the South and North nodes, respectively. Once the entrants are fixed, the equilibrium retail prices can be computed.

In Fig. 6
                         below, we plot the equilibrium cost to retail customers as a function of the cost of entry into the retail markets. On the right side of the figure the cost of entry is large, here under all four scenarios there is no (additional) entry into the retail market. This case was shown in Table 1. On the left side of the figure the cost of entry is small, here under all for scenarios there is entry from both firms A and C into the South and North, respectively, as shown in Table 2. For the moderate entry costs there is a third case, where Firm A enters the South, but firm C does not enter the North.

From Fig. 6 we can see that the physical asset swap leads to higher consumer costs for much of the range of entry costs. The only times it reduces the overall costs is when the swap entices entry into the North retail market by firm C, who prior to the swap would have preferred to have not entered (cost of entry:  17,200 dollars –  23,000 dollars).
                           15
                        
                        
                           15
                           Note that these entry costs are of the right order of magnitude. For an existing retailer to enter another retail market, the main costs that they would face would be advertising costs.
                        
                     

The virtual swaps not only reduce consumer costs for a particular set of entrants, it also leads to firm A entering into the South, even with large entry costs (although there is little change to the incentives for firm C to enter the North).

To summarise, if the cost of entry is large, the best way to entice entry into the market is by way of a virtual swap. Virtual assets are also the best way to reduce prices when cost of entry is low. The only time the physical swap improves welfare is to entice firm C to enter the retail market in the North, when there is a moderate cost of entry.

@&#CONCLUSIONS@&#

This paper has presented a collection of analytic and numerical models of retail competition as two-stage games, to try to understand the entry and pricing incentives of electricity retailers which are risk averse.

We first observe that with risk-neutral firms and a competitive wholesale market, retailers will reach a symmetric equilibrium. We then examined how their behaviour may change under risk-aversion using a simple one-node example with two firms. We find that risk-aversion does not always mean that a premium is passed onto consumers, in fact, retail prices may drop as a firm becomes more risk-averse (this effect is dependent upon the particular circumstances of the retailers).

Following the proposed restructuring of asset ownership in the NZEM, we have constructed a model that encompasses both the retail and wholesale electricity markets, allowing us to compute equilibria under varying levels of risk-aversion; this is presented in Section 5, where we extended the model to allow for networks with multiple nodes. In this setting we examined the effects of asset swapping (both physical and virtual) on retail competition. We found, for the NZEM motivated example that we considered, that if the firms in the retail market are fixed then the physical asset swap lead to increased overall consumer costs. However, virtual swaps lead to lower (or equal) consumer prices. In the case where firms can enter the market, the previous results were reproduced when the cost of entry was either low or high. However for a small interval of entry costs between 17,200 dollars and 23,000 dollars, firm C (previously only in the South), would enter the North retail market, leading to higher competition and lower prices after a physical swap (whereas firm A would enter the retail markets at both nodes regardless whether or not an asset swap takes place). These results show that careful analysis of firms’ aversion to risk is important when predicting the outcome of policy decisions.

Finally, in order to enhance the model further, in future work we could examine how timing of entry decisions affected the equilibrium, and overall competitiveness of the retail market.

@&#ACKNOWLEDGMENTS@&#

This work has been supported by the Faculty of Engineering and the Energy Centre at the University of Auckland. We thank the editor and anonymous referees for the comments and suggestions provided during the refereeing process.

Proof of Theorem 3.2.

                        Proof
                        Risk-neutral firms aim to maximize their expected profit. Given a set of firms in the retail market 
                              
                                 E
                                 ,
                              
                            the expected profit function for firm 
                              
                                 f
                                 ∈
                                 E
                              
                            is given by

                              
                                 
                                    
                                       
                                          π
                                          f
                                       
                                       =
                                       
                                          E
                                          ω
                                       
                                       
                                          [
                                          
                                             
                                                (
                                                
                                                   
                                                      p
                                                      f
                                                   
                                                   −
                                                   
                                                      c
                                                      ω
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   X
                                                   ω
                                                
                                                
                                                   |
                                                   E
                                                   |
                                                
                                             
                                             
                                                (
                                                
                                                   1
                                                   −
                                                   b
                                                   
                                                      ∑
                                                      
                                                         
                                                            i
                                                            ∈
                                                            E
                                                            ∖
                                                         
                                                         
                                                            {
                                                            f
                                                            }
                                                         
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            p
                                                            f
                                                         
                                                         −
                                                         
                                                            p
                                                            i
                                                         
                                                      
                                                      )
                                                   
                                                
                                                )
                                             
                                             +
                                             
                                                P
                                                f
                                                ω
                                             
                                          
                                          ]
                                       
                                       .
                                    
                                 
                              
                           
                        

This corresponds to Eq. 4 where 
                              
                                 θ
                                 =
                                 0
                              
                           . Recall that 
                              
                                 P
                                 f
                                 ω
                              
                            is firm f’s profit from the wholesale market and cω
                            is the clearing price in the wholesale market, for the realization of uncertainty ω ∈ Ω.

Now we wish to compute the Nash equilibrium for the retail game
                              16
                           
                           
                              16
                              We will demonstrate that there is only one equilibrium as part of the construction.
                           ; that is a point where no firm can alter its strategy to unilaterally improve its expected profit. Since each player has a smooth, concave profit function, we can find the maximum profit from the first order condition. Differentiating the expected profit function with respect to pf
                           , we get

                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∂
                                                   
                                                      π
                                                      f
                                                   
                                                
                                                
                                                   ∂
                                                   
                                                      p
                                                      f
                                                   
                                                
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   1
                                                   
                                                      |
                                                      E
                                                      |
                                                   
                                                
                                                
                                                   E
                                                   ω
                                                
                                                
                                                   [
                                                   
                                                      X
                                                      ω
                                                   
                                                   ]
                                                
                                                +
                                                
                                                   b
                                                   
                                                      |
                                                      E
                                                      |
                                                   
                                                
                                                
                                                   E
                                                   ω
                                                
                                                
                                                   [
                                                   
                                                      X
                                                      ω
                                                   
                                                   ]
                                                
                                                
                                                   ∑
                                                   
                                                      
                                                         i
                                                         ∈
                                                         E
                                                         ∖
                                                      
                                                      
                                                         {
                                                         f
                                                         }
                                                      
                                                   
                                                
                                                
                                                   p
                                                   i
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                −
                                                
                                                
                                                   
                                                      b
                                                      
                                                         (
                                                         
                                                            
                                                               |
                                                               E
                                                               |
                                                            
                                                            −
                                                            1
                                                         
                                                         )
                                                      
                                                   
                                                   
                                                      |
                                                      E
                                                      |
                                                   
                                                
                                                
                                                   (
                                                   2
                                                   
                                                      p
                                                      f
                                                   
                                                   
                                                      E
                                                      ω
                                                   
                                                   
                                                      [
                                                      
                                                         X
                                                         ω
                                                      
                                                      ]
                                                   
                                                   −
                                                   
                                                      E
                                                      ω
                                                   
                                                   
                                                      [
                                                      
                                                         
                                                            c
                                                            ω
                                                         
                                                         
                                                            X
                                                            ω
                                                         
                                                      
                                                      ]
                                                   
                                                   )
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

Solving for price 
                              
                                 p
                                 f
                                 *
                              
                            yields

                              
                                 (8)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∂
                                                   
                                                      π
                                                      f
                                                   
                                                
                                                
                                                   ∂
                                                   
                                                      p
                                                      f
                                                   
                                                
                                             
                                             |
                                          
                                          
                                             
                                                p
                                                f
                                             
                                             =
                                             
                                                p
                                                f
                                                *
                                             
                                          
                                       
                                       =
                                       0
                                       ⇒
                                       
                                          p
                                          f
                                          *
                                       
                                       =
                                       
                                          
                                             1
                                             +
                                             b
                                             
                                                ∑
                                                
                                                   
                                                      i
                                                      ∈
                                                      E
                                                      ∖
                                                   
                                                   
                                                      {
                                                      f
                                                      }
                                                   
                                                
                                             
                                             
                                                p
                                                i
                                             
                                             +
                                             b
                                             
                                                (
                                                
                                                   
                                                      |
                                                      E
                                                      |
                                                   
                                                   −
                                                   1
                                                
                                                )
                                             
                                             
                                                
                                                   
                                                      E
                                                      ω
                                                   
                                                   
                                                      [
                                                      
                                                         
                                                            c
                                                            ω
                                                         
                                                         
                                                            X
                                                            ω
                                                         
                                                      
                                                      ]
                                                   
                                                
                                                
                                                   
                                                      E
                                                      ω
                                                   
                                                   
                                                      [
                                                      
                                                         X
                                                         ω
                                                      
                                                      ]
                                                   
                                                
                                             
                                          
                                          
                                             2
                                             b
                                             
                                                (
                                                
                                                   
                                                      |
                                                      E
                                                      |
                                                   
                                                   −
                                                   1
                                                
                                                )
                                             
                                          
                                       
                                       .
                                    
                                 
                              
                           
                        

At the equilibrium point, the above equation must be satisfied for all firms simultaneously. To solve for this point we first sum the above equation for all 
                              
                                 f
                                 ∈
                                 E
                                 ,
                              
                            yielding

                              
                                 
                                    
                                       
                                          ∑
                                          
                                             f
                                             ∈
                                             E
                                          
                                       
                                       
                                          p
                                          f
                                          *
                                       
                                       =
                                       
                                          
                                             
                                                |
                                                E
                                                |
                                             
                                             +
                                             b
                                             
                                                (
                                                
                                                   |
                                                   E
                                                   |
                                                   −
                                                   1
                                                
                                                )
                                             
                                             
                                                ∑
                                                
                                                   f
                                                   ∈
                                                   E
                                                
                                             
                                             
                                                p
                                                f
                                                *
                                             
                                             +
                                             b
                                             
                                                |
                                                E
                                                |
                                             
                                             
                                                (
                                                
                                                   |
                                                   E
                                                   |
                                                   −
                                                   1
                                                
                                                )
                                             
                                             
                                                
                                                   
                                                      E
                                                      ω
                                                   
                                                   
                                                      [
                                                      
                                                         
                                                            c
                                                            ω
                                                         
                                                         
                                                            X
                                                            ω
                                                         
                                                      
                                                      ]
                                                   
                                                
                                                
                                                   
                                                      E
                                                      ω
                                                   
                                                   
                                                      [
                                                      
                                                         X
                                                         ω
                                                      
                                                      ]
                                                   
                                                
                                             
                                          
                                          
                                             2
                                             b
                                             (
                                             
                                                |
                                                E
                                                |
                                                −
                                                1
                                             
                                             )
                                          
                                       
                                       ,
                                    
                                 
                              
                           which can be rearranged to give

                              
                                 
                                    
                                       
                                          ∑
                                          
                                             f
                                             ∈
                                             E
                                          
                                       
                                       
                                          p
                                          f
                                          *
                                       
                                       =
                                       
                                          
                                             |
                                             E
                                             |
                                          
                                          
                                             b
                                             
                                                (
                                                
                                                   
                                                      |
                                                      E
                                                      |
                                                   
                                                   −
                                                   1
                                                
                                                )
                                             
                                          
                                       
                                       +
                                       
                                          |
                                          E
                                          |
                                       
                                       
                                          
                                             
                                                E
                                                ω
                                             
                                             
                                                [
                                                
                                                   
                                                      c
                                                      ω
                                                   
                                                   
                                                      X
                                                      ω
                                                   
                                                
                                                ]
                                             
                                          
                                          
                                             
                                                E
                                                ω
                                             
                                             
                                                [
                                                
                                                   X
                                                   ω
                                                
                                                ]
                                             
                                          
                                       
                                       .
                                    
                                 
                              
                           Finally we substitute the above expression into Eq. (8) to find the equilibrium price for firm f:

                              
                                 
                                    
                                       
                                          p
                                          f
                                          e
                                       
                                       =
                                       
                                          1
                                          
                                             b
                                             
                                                (
                                                
                                                   
                                                      |
                                                      E
                                                      |
                                                   
                                                   −
                                                   1
                                                
                                                )
                                             
                                          
                                       
                                       +
                                       
                                          
                                             
                                                E
                                                ω
                                             
                                             
                                                [
                                                
                                                   
                                                      c
                                                      ω
                                                   
                                                   
                                                      X
                                                      ω
                                                   
                                                
                                                ]
                                             
                                          
                                          
                                             
                                                E
                                                ω
                                             
                                             
                                                [
                                                
                                                   X
                                                   ω
                                                
                                                ]
                                             
                                          
                                       
                                       .
                                    
                                 
                              
                           For scenario ω the retail demand that each firm f gets is

                              
                                 
                                    
                                       
                                          x
                                          f
                                          *
                                       
                                       =
                                       
                                          
                                             X
                                             ω
                                          
                                          
                                             |
                                             E
                                             |
                                          
                                       
                                       .
                                    
                                 
                              
                           
                        

In other words, we find that the firms all choose identical prices for their retail sales, and each firm gets an equal market share. This is because the profit from the wholesale market is not affected by the decisions made in the retail market, and is merely a (uncertain) constant term in the profit function. Therefore, all firms entering the retail market act symmetrically, even though some may own profitable generation. In a risk-neutral setting, the expected value of this wholesale profit can be separated from the retail profit, so it plays no part in the optimization problem. On the surface this may seem peculiar, but optimizing expected profits cannot distinguish between opportunity costs and actual costs, so all firms have the same incentives.

Also note that as the number of firms in the market increases, the equilibrium retail prices tend toward demand-weighted average wholesale prices (since we have a competitive wholesale market, these prices are based on generation costs). This can be observed from the following limit

                              
                                 
                                    
                                       
                                          lim
                                          
                                             n
                                             →
                                             ∞
                                          
                                       
                                       
                                          p
                                          f
                                       
                                       =
                                       
                                          lim
                                          
                                             
                                                |
                                                E
                                                |
                                             
                                             →
                                             ∞
                                          
                                       
                                       
                                          [
                                          
                                             
                                                1
                                                
                                                   b
                                                   
                                                      (
                                                      
                                                         
                                                            |
                                                            E
                                                            |
                                                         
                                                         −
                                                         1
                                                      
                                                      )
                                                   
                                                
                                             
                                             +
                                             
                                                
                                                   
                                                      E
                                                      ω
                                                   
                                                   
                                                      [
                                                      
                                                         c
                                                         ω
                                                      
                                                      
                                                         X
                                                         ω
                                                      
                                                      ]
                                                   
                                                
                                                
                                                   
                                                      E
                                                      ω
                                                   
                                                   
                                                      [
                                                      
                                                         X
                                                         ω
                                                      
                                                      ]
                                                   
                                                
                                             
                                          
                                          ]
                                       
                                       =
                                       
                                          
                                             
                                                E
                                                ω
                                             
                                             
                                                [
                                                
                                                   c
                                                   ω
                                                
                                                
                                                   X
                                                   ω
                                                
                                                ]
                                             
                                          
                                          
                                             
                                                E
                                                ω
                                             
                                             
                                                [
                                                
                                                   X
                                                   ω
                                                
                                                ]
                                             
                                          
                                       
                                       .
                                    
                                 
                              
                           
                           □


                           The optimal solution (both primal and dual) to
                           
                              
                                 
                                    P
                                    f
                                 
                                 
                                    (
                                    
                                       p
                                       
                                          −
                                          f
                                       
                                    
                                    )
                                 
                              
                            
                           is equivalent to solution to the following convex mathematical program, for θ ∈ [0, 1).
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      Π
                                                      ^
                                                   
                                                   f
                                                
                                                
                                                   (
                                                   
                                                      p
                                                      
                                                         −
                                                         f
                                                      
                                                   
                                                   )
                                                
                                                =
                                                max
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      ω
                                                      ∈
                                                      Ω
                                                   
                                                
                                                
                                                   ρ
                                                   
                                                      π
                                                      f
                                                      ω
                                                   
                                                
                                                −
                                                
                                                   θ
                                                   α
                                                
                                                
                                                   ∑
                                                   
                                                      ω
                                                      ∈
                                                      Ω
                                                   
                                                
                                                
                                                   ρ
                                                   
                                                      [
                                                      
                                                         
                                                            (
                                                            
                                                               1
                                                               −
                                                               α
                                                            
                                                            )
                                                         
                                                         
                                                            w
                                                            f
                                                            ω
                                                         
                                                         +
                                                         α
                                                         
                                                            v
                                                            f
                                                            ω
                                                         
                                                      
                                                      ]
                                                   
                                                
                                             
                                          
                                          
                                             
                                          
                                          
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   s
                                                   .
                                                   t
                                                   .
                                                
                                                
                                             
                                          
                                          
                                             
                                                
                                                   π
                                                   f
                                                   ω
                                                
                                                =
                                                
                                                   η
                                                   f
                                                
                                                +
                                                
                                                   v
                                                   f
                                                   ω
                                                
                                                −
                                                
                                                   w
                                                   f
                                                   ω
                                                
                                             
                                          
                                          
                                             
                                                [
                                                
                                                   λ
                                                   f
                                                   ω
                                                
                                                ]
                                             
                                          
                                          
                                             
                                                ∀
                                                ω
                                                ∈
                                                Ω
                                             
                                          
                                       
                                       
                                          
                                             
                                          
                                          
                                             
                                                
                                                   π
                                                   f
                                                   ω
                                                
                                                ≤
                                                
                                                   ∑
                                                   
                                                      n
                                                      ∈
                                                      N
                                                   
                                                
                                                
                                                   [
                                                   
                                                      
                                                         X
                                                         n
                                                         ω
                                                      
                                                      
                                                         ∑
                                                         
                                                            i
                                                            ∈
                                                            
                                                               E
                                                               n
                                                            
                                                            ∩
                                                            
                                                               {
                                                               f
                                                               }
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            (
                                                            
                                                               
                                                                  p
                                                                  
                                                                     n
                                                                     i
                                                                  
                                                               
                                                               −
                                                               
                                                                  c
                                                                  n
                                                                  ω
                                                               
                                                            
                                                            )
                                                         
                                                         
                                                            
                                                               ϕ
                                                               ^
                                                            
                                                            
                                                               n
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                   ]
                                                
                                                +
                                                
                                                   P
                                                   f
                                                   ω
                                                
                                                
                                             
                                          
                                          
                                             
                                                [
                                                
                                                   μ
                                                   f
                                                   ω
                                                
                                                ]
                                             
                                          
                                          
                                             
                                                ∀
                                                ω
                                                ∈
                                                Ω
                                             
                                          
                                       
                                       
                                          
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      ϕ
                                                      ^
                                                   
                                                   
                                                      n
                                                      f
                                                   
                                                
                                                =
                                                
                                                   1
                                                   
                                                      |
                                                      
                                                         E
                                                         n
                                                      
                                                      |
                                                   
                                                
                                                
                                                   [
                                                   
                                                      1
                                                      +
                                                      b
                                                      
                                                         ∑
                                                         
                                                            i
                                                            ∈
                                                            
                                                               E
                                                               n
                                                            
                                                            
                                                               ∖
                                                            
                                                            
                                                               {
                                                               f
                                                               }
                                                            
                                                         
                                                      
                                                      
                                                         (
                                                         
                                                            
                                                               p
                                                               
                                                                  n
                                                                  i
                                                               
                                                            
                                                            −
                                                            
                                                               p
                                                               
                                                                  n
                                                                  f
                                                               
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                   ]
                                                
                                             
                                          
                                          
                                             
                                                
                                                   [
                                                   
                                                      ν
                                                      
                                                         n
                                                         f
                                                      
                                                   
                                                   ]
                                                
                                                
                                             
                                          
                                          
                                             
                                                ∀
                                                n
                                                ∈
                                                N
                                             
                                          
                                       
                                       
                                          
                                             
                                          
                                          
                                             
                                                
                                                   w
                                                   f
                                                   ω
                                                
                                                ,
                                                
                                                   v
                                                   f
                                                   ω
                                                
                                                ≥
                                                0
                                             
                                          
                                          
                                             
                                          
                                          
                                             
                                                ∀
                                                ω
                                                ∈
                                                Ω
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

First, observe that the mathematical program presented in the statement of the lemma is a convex relaxation of 
                              
                                 
                                    P
                                    f
                                 
                                 
                                    (
                                    
                                       p
                                       
                                          −
                                          f
                                       
                                    
                                    )
                                 
                              
                           . The only non-linearity in the formulation is in the inequality constraining the profit, and with a simple substitution for 
                              
                                 ϕ
                                 ^
                              
                            this can be shown to be a convex quadratic inequality.

Now we will present the KKT conditions of the above problem.

                              
                                 
                                    
                                       
                                          
                                          
                                             
                                                
                                                   π
                                                   f
                                                   ω
                                                
                                                =
                                                
                                                   η
                                                   f
                                                
                                                +
                                                
                                                   v
                                                   f
                                                   ω
                                                
                                                −
                                                
                                                   w
                                                   f
                                                   ω
                                                
                                             
                                          
                                          
                                          
                                             
                                                ∀
                                                ω
                                                ∈
                                                Ω
                                                ,
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                0
                                                ≤
                                                
                                                   μ
                                                   f
                                                   ω
                                                
                                                
                                                
                                                ⊥
                                                
                                                
                                                
                                                   ∑
                                                   
                                                      n
                                                      ∈
                                                      N
                                                   
                                                
                                                
                                                   [
                                                   
                                                      
                                                         X
                                                         n
                                                         ω
                                                      
                                                      
                                                         ∑
                                                         
                                                            i
                                                            ∈
                                                            
                                                               E
                                                               n
                                                            
                                                            ∩
                                                            
                                                               {
                                                               f
                                                               }
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            (
                                                            
                                                               
                                                                  p
                                                                  
                                                                     n
                                                                     i
                                                                  
                                                               
                                                               −
                                                               
                                                                  c
                                                                  n
                                                                  ω
                                                               
                                                            
                                                            )
                                                         
                                                         
                                                            
                                                               ϕ
                                                               ^
                                                            
                                                            
                                                               n
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                   ]
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                +
                                                
                                                   P
                                                   f
                                                   ω
                                                
                                                −
                                                
                                                   π
                                                   f
                                                   ω
                                                
                                                ≥
                                                0
                                                
                                             
                                          
                                          
                                          
                                             
                                                ∀
                                                ω
                                                ∈
                                                Ω
                                                ,
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                   
                                                      ϕ
                                                      ^
                                                   
                                                   
                                                      n
                                                      f
                                                   
                                                
                                                =
                                                
                                                   1
                                                   
                                                      |
                                                      
                                                         E
                                                         n
                                                      
                                                      |
                                                   
                                                
                                                
                                                   [
                                                   
                                                      1
                                                      +
                                                      b
                                                      
                                                         ∑
                                                         
                                                            i
                                                            ∈
                                                            
                                                               E
                                                               n
                                                            
                                                            
                                                               ∖
                                                            
                                                            
                                                               {
                                                               f
                                                               }
                                                            
                                                         
                                                      
                                                      
                                                         (
                                                         
                                                            
                                                               p
                                                               
                                                                  n
                                                                  i
                                                               
                                                            
                                                            −
                                                            
                                                               p
                                                               
                                                                  n
                                                                  f
                                                               
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                   ]
                                                
                                             
                                          
                                          
                                          
                                             
                                                ∀
                                                n
                                                ∈
                                                N
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                −
                                                ρ
                                                +
                                                
                                                   λ
                                                   f
                                                   ω
                                                
                                                +
                                                
                                                   μ
                                                   f
                                                   ω
                                                
                                                =
                                                0
                                             
                                          
                                          
                                          
                                             
                                                ∀
                                                ω
                                                ∈
                                                Ω
                                                ,
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                −
                                                
                                                   ∑
                                                   
                                                      ω
                                                      ∈
                                                      Ω
                                                   
                                                
                                                
                                                   λ
                                                   f
                                                   ω
                                                
                                                =
                                                0
                                             
                                          
                                          
                                          
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                −
                                                
                                                   ∑
                                                   
                                                      ω
                                                      ∈
                                                      Ω
                                                   
                                                
                                                
                                                   
                                                      X
                                                      ω
                                                   
                                                   
                                                      
                                                         ϕ
                                                         ^
                                                      
                                                      
                                                         n
                                                         f
                                                      
                                                   
                                                   
                                                      μ
                                                      f
                                                      ω
                                                   
                                                   +
                                                   b
                                                   
                                                      
                                                         
                                                            |
                                                            
                                                               E
                                                               n
                                                            
                                                            |
                                                         
                                                         −
                                                         1
                                                      
                                                      
                                                         |
                                                         
                                                            E
                                                            n
                                                         
                                                         |
                                                      
                                                   
                                                
                                                
                                                   ν
                                                   
                                                      n
                                                      f
                                                   
                                                
                                                =
                                                0
                                             
                                          
                                          
                                          
                                             
                                                ∀
                                                n
                                                ∈
                                                N
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                   ν
                                                   
                                                      n
                                                      f
                                                   
                                                
                                                −
                                                
                                                   ∑
                                                   
                                                      ω
                                                      ∈
                                                      Ω
                                                   
                                                
                                                
                                                   [
                                                   
                                                      X
                                                      n
                                                      ω
                                                   
                                                   
                                                      ∑
                                                      
                                                         i
                                                         ∈
                                                         
                                                            E
                                                            n
                                                         
                                                         ∩
                                                         
                                                            {
                                                            f
                                                            }
                                                         
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            p
                                                            
                                                               n
                                                               i
                                                            
                                                         
                                                         −
                                                         
                                                            c
                                                            n
                                                            ω
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      μ
                                                      f
                                                      ω
                                                   
                                                   ]
                                                
                                                =
                                                0
                                             
                                          
                                          
                                          
                                             
                                                ∀
                                                n
                                                ∈
                                                N
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                0
                                                ≤
                                                
                                                   v
                                                   f
                                                   ω
                                                
                                                
                                                
                                                ⊥
                                                
                                                
                                                θ
                                                ρ
                                                −
                                                
                                                   λ
                                                   f
                                                   ω
                                                
                                                ≥
                                                0
                                             
                                          
                                          
                                          
                                             
                                                ∀
                                                ω
                                                ∈
                                                Ω
                                                ,
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                0
                                                ≤
                                                
                                                   w
                                                   f
                                                   ω
                                                
                                                
                                                
                                                ⊥
                                                
                                                
                                                θ
                                                
                                                   
                                                      1
                                                      −
                                                      α
                                                   
                                                   α
                                                
                                                ρ
                                                +
                                                
                                                   λ
                                                   f
                                                   ω
                                                
                                                ≥
                                                0
                                             
                                          
                                          
                                          
                                             
                                                ∀
                                                ω
                                                ∈
                                                Ω
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

To prove the statement of the lemma we will simply show that 
                              
                                 μ
                                 f
                                 ω
                              
                            is strictly positive at the optimal solution, and hence from the orthogonality constraint the inequality constraint must be binding. Hence, since this problem is a relaxation of the actual problem the optimal solutions must coincide. Consider the following two constraints from the KKT conditions, above:

                              
                                 
                                    
                                       θ
                                       ρ
                                       −
                                       
                                          λ
                                          f
                                          ω
                                       
                                       ≥
                                       0
                                       ,
                                       
                                       ∀
                                       ω
                                       ∈
                                       Ω
                                       ,
                                    
                                 
                              
                           
                           
                              
                                 
                                    
                                       −
                                       ρ
                                       +
                                       
                                          λ
                                          f
                                          ω
                                       
                                       +
                                       
                                          μ
                                          f
                                          ω
                                       
                                       ,
                                       
                                       ∀
                                       ω
                                       ∈
                                       Ω
                                       .
                                    
                                 
                              
                           Eliminating 
                              
                                 λ
                                 f
                                 ω
                              
                            gives:

                              
                                 
                                    
                                       
                                          (
                                          θ
                                          −
                                          1
                                          )
                                       
                                       ρ
                                       +
                                       
                                          μ
                                          f
                                          ω
                                       
                                       ≥
                                       0
                                       .
                                    
                                 
                              
                           Since ρ is strictly positive and 
                              
                                 (
                                 θ
                                 −
                                 1
                                 )
                              
                            is strictly negative, 
                              
                                 μ
                                 f
                                 ω
                              
                            must be strictly positive. This ensures that the profit inequality constraint is binding and thus the optimal solution for 
                              
                                 
                                    P
                                    f
                                 
                                 
                                    (
                                    
                                       p
                                       
                                          −
                                          f
                                       
                                    
                                    )
                                 
                              
                            is identical to the relaxation.□

The following lemmas demonstrate that under certain conditions the equilibrium for 
                        
                           
                              G
                              ^
                           
                           E
                        
                      is also an equilibrium for 
                        
                           
                              G
                              E
                           
                           ,
                        
                      and vice versa. In order to show this we first must prove that the demand model 
                        D
                      yields continuous concave market shares. Then we can show that if there is no incentive to deviate from an equilibrium for one demand function, nor is there incentive to deviate for the other demand function.

                        Lemma 7.2
                        
                           Suppose that we have a vector of retail prices p, and for a firm
                           
                              
                                 f
                                 ∈
                                 
                                    E
                                    ¯
                                 
                                 ,
                              
                            
                           under demand model
                           
                              
                                 D
                                 ,
                              
                            
                           we obtain
                           
                              
                                 
                                    ϕ
                                    f
                                 
                                 =
                                 0
                              
                           
                           . If firm f is removed from
                           
                              
                                 
                                    E
                                    ¯
                                 
                                 ,
                              
                            
                           then ϕj remains unchanged for all
                           
                              
                                 j
                                 ∈
                                 
                                    E
                                    ¯
                                 
                                 
                                    ∖
                                 
                                 
                                    {
                                    f
                                    }
                                 
                              
                           
                           .
                        

First, we know that the demand of firm f is 0, i.e. 
                              
                                 
                                    ϕ
                                    f
                                 
                                 =
                                 0
                                 ,
                              
                            therefore

                              
                                 (9)
                                 
                                    
                                       
                                          
                                          
                                          
                                             
                                                
                                                   1
                                                   
                                                      |
                                                      
                                                         E
                                                         ¯
                                                      
                                                      |
                                                   
                                                
                                                
                                                   [
                                                   
                                                      1
                                                      −
                                                      b
                                                      
                                                         ∑
                                                         
                                                            i
                                                            ∈
                                                            
                                                               E
                                                               ¯
                                                            
                                                            
                                                               ∖
                                                            
                                                            
                                                               {
                                                               f
                                                               }
                                                            
                                                         
                                                      
                                                      
                                                         (
                                                         
                                                            
                                                               p
                                                               f
                                                            
                                                            −
                                                            
                                                               p
                                                               i
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                   ]
                                                
                                                =
                                                0
                                             
                                          
                                       
                                       
                                          
                                          
                                             ⇔
                                          
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      i
                                                      ∈
                                                      
                                                         E
                                                         ¯
                                                      
                                                      
                                                         ∖
                                                      
                                                      
                                                         {
                                                         f
                                                         }
                                                      
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         p
                                                         f
                                                      
                                                      −
                                                      
                                                         p
                                                         i
                                                      
                                                   
                                                   )
                                                
                                                =
                                                
                                                   1
                                                   b
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             ⇔
                                          
                                          
                                             
                                                
                                                   |
                                                   
                                                      E
                                                      ¯
                                                   
                                                   −
                                                   1
                                                   |
                                                
                                                
                                                   p
                                                   f
                                                
                                                −
                                                
                                                   ∑
                                                   
                                                      i
                                                      ∈
                                                      
                                                         E
                                                         ¯
                                                      
                                                      
                                                         ∖
                                                      
                                                      
                                                         {
                                                         f
                                                         }
                                                      
                                                   
                                                
                                                
                                                   p
                                                   i
                                                
                                                =
                                                
                                                   1
                                                   b
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             ⇔
                                          
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      i
                                                      ∈
                                                      
                                                         E
                                                         ¯
                                                      
                                                      
                                                         ∖
                                                      
                                                      
                                                         {
                                                         f
                                                         }
                                                      
                                                   
                                                
                                                
                                                   p
                                                   i
                                                
                                                =
                                                
                                                   (
                                                   
                                                      |
                                                      
                                                         E
                                                         ¯
                                                      
                                                      |
                                                   
                                                   −
                                                   1
                                                   )
                                                
                                                
                                                   p
                                                   f
                                                
                                                −
                                                
                                                   1
                                                   b
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (10)
                                 
                                    
                                       
                                          
                                          
                                             ⇔
                                          
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      i
                                                      ∈
                                                      
                                                         E
                                                         ¯
                                                      
                                                   
                                                
                                                
                                                   p
                                                   i
                                                
                                                =
                                                
                                                   |
                                                   
                                                      E
                                                      ¯
                                                   
                                                   |
                                                
                                                
                                                   p
                                                   f
                                                
                                                −
                                                
                                                   1
                                                   b
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

Without loss of generality we will consider the demand of firm 
                              
                                 
                                    j
                                    ∈
                                    E
                                    ∖
                                 
                                 
                                    {
                                    f
                                    }
                                 
                                 ,
                              
                            at the point where firm f is removed from the market. With firm f in the market, we have:

                              
                                 
                                    
                                       
                                          ϕ
                                          j
                                       
                                       =
                                       
                                          1
                                          
                                             |
                                             
                                                E
                                                ¯
                                             
                                             |
                                          
                                       
                                       
                                          [
                                          
                                             1
                                             −
                                             b
                                             
                                                ∑
                                                
                                                   i
                                                   ∈
                                                   
                                                      E
                                                      ¯
                                                   
                                                   
                                                      ∖
                                                   
                                                   
                                                      {
                                                      j
                                                      }
                                                   
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      p
                                                      j
                                                   
                                                   −
                                                   
                                                      p
                                                      i
                                                   
                                                
                                                )
                                             
                                          
                                          ]
                                       
                                       ,
                                    
                                 
                              
                           which can be rewritten as:

                              
                                 
                                    
                                       
                                          ϕ
                                          j
                                       
                                       =
                                       
                                          1
                                          
                                             |
                                             
                                                E
                                                ¯
                                             
                                             |
                                          
                                       
                                       
                                          [
                                          
                                             1
                                             −
                                             b
                                             
                                                (
                                                
                                                   
                                                      |
                                                      
                                                         E
                                                         ¯
                                                      
                                                      |
                                                   
                                                   
                                                      p
                                                      j
                                                   
                                                   −
                                                   
                                                      ∑
                                                      
                                                         i
                                                         ∈
                                                         
                                                            E
                                                            ¯
                                                         
                                                      
                                                   
                                                   
                                                      p
                                                      i
                                                   
                                                
                                                )
                                             
                                          
                                          ]
                                       
                                       .
                                    
                                 
                              
                           Substituting Eq. (10) into the above expression gives:

                              
                                 
                                    
                                       
                                          ϕ
                                          j
                                       
                                       =
                                       −
                                       b
                                       
                                          (
                                          
                                             
                                                p
                                                j
                                             
                                             −
                                             
                                                p
                                                f
                                             
                                          
                                          )
                                       
                                       .
                                    
                                 
                              
                           Whereas, without firm f in the market, we have:

                              
                                 
                                    
                                       
                                          ϕ
                                          j
                                       
                                       =
                                       
                                          1
                                          
                                             
                                                |
                                                
                                                   E
                                                   ¯
                                                
                                                |
                                             
                                             −
                                             1
                                          
                                       
                                       
                                          [
                                          
                                             1
                                             −
                                             b
                                             
                                                ∑
                                                
                                                   i
                                                   ∈
                                                   
                                                      E
                                                      ¯
                                                   
                                                   
                                                      ∖
                                                   
                                                   
                                                      {
                                                      j
                                                      ∪
                                                      f
                                                      }
                                                   
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      p
                                                      j
                                                   
                                                   −
                                                   
                                                      p
                                                      i
                                                   
                                                
                                                )
                                             
                                          
                                          ]
                                       
                                       ,
                                    
                                 
                              
                           which can be rewritten as:

                              
                                 
                                    
                                       
                                          ϕ
                                          j
                                       
                                       =
                                       
                                          1
                                          
                                             
                                                |
                                                
                                                   E
                                                   ¯
                                                
                                                |
                                             
                                             −
                                             1
                                          
                                       
                                       
                                          [
                                          
                                             1
                                             −
                                             b
                                             
                                                (
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            |
                                                            
                                                               E
                                                               ¯
                                                            
                                                            |
                                                         
                                                         −
                                                         1
                                                      
                                                      )
                                                   
                                                   
                                                      p
                                                      j
                                                   
                                                   −
                                                   
                                                      ∑
                                                      
                                                         i
                                                         ∈
                                                         
                                                            E
                                                            ¯
                                                         
                                                         
                                                            ∖
                                                         
                                                         
                                                            {
                                                            f
                                                            }
                                                         
                                                      
                                                   
                                                   
                                                      p
                                                      i
                                                   
                                                
                                                )
                                             
                                          
                                          ]
                                       
                                       .
                                    
                                 
                              
                           Substituting Eq. (9) into the above expression gives:

                              
                                 
                                    
                                       
                                          ϕ
                                          j
                                       
                                       =
                                       −
                                       b
                                       
                                          (
                                          
                                             
                                                p
                                                j
                                             
                                             −
                                             
                                                p
                                                f
                                             
                                          
                                          )
                                       
                                       .
                                    
                                 
                              
                           Therefore, if a firm in 
                              
                                 E
                                 ¯
                              
                            has zero market share then removing that firm from the market does not affect the market shares of the other firms.□


                           Suppose we have an arbitrary, but fixed vector of retail prices p, then under demand model
                           
                              
                                 D
                                 ,
                              
                            
                           ϕf is a concave function of pf, for ϕf
                            > 0.
                        

First note from Lemma 7.2, the market-share of all firms j, ϕj
                           , from 
                              D
                            must be continuous functions of pf
                           , for each firm 
                              
                                 f
                                 ∈
                                 E
                              
                           .

Starting from any vector p such that ϕf
                            > 0 for all 
                              
                                 f
                                 ∈
                                 E
                                 ,
                              
                            observe from the equation defining the retailers’ market-share under demand model 
                              D
                            (repeated below) that decreasing pf
                            will cause the demand of all firms, j in 
                              
                                 
                                    E
                                    ¯
                                 
                                 
                                    ∖
                                 
                                 
                                    {
                                    f
                                    }
                                 
                              
                            to decrease:

                              
                                 
                                    
                                       
                                          ϕ
                                          j
                                       
                                       =
                                       
                                          1
                                          
                                             |
                                             
                                                E
                                                ¯
                                             
                                             |
                                          
                                       
                                       
                                          [
                                          1
                                          −
                                          b
                                          
                                             ∑
                                             
                                                i
                                                ∈
                                                
                                                   E
                                                   ¯
                                                
                                                
                                                   ∖
                                                
                                                
                                                   {
                                                   j
                                                   }
                                                
                                             
                                          
                                          
                                             (
                                             
                                                p
                                                j
                                             
                                             −
                                             
                                                p
                                                i
                                             
                                             )
                                          
                                          ]
                                       
                                       .
                                    
                                 
                              
                           The derivative with respect to pf
                            is:

                              
                                 
                                    
                                       
                                          
                                             ∂
                                             
                                                ϕ
                                                j
                                             
                                          
                                          
                                             ∂
                                             
                                                p
                                                f
                                             
                                          
                                       
                                       =
                                       
                                          b
                                          
                                             |
                                             
                                                E
                                                ¯
                                             
                                             |
                                          
                                       
                                       ,
                                    
                                 
                              
                           which is positive, hence a decrease in pf
                            causes a decrease in ϕj
                            for all 
                              
                                 
                                    j
                                    ∈
                                    E
                                    ∖
                                 
                                 
                                    {
                                    f
                                    }
                                 
                              
                           .

Thus, decreasing pf
                            will lead to fewer firms in the market, since, under demand model 
                              
                                 D
                                 ,
                              
                            once xj
                            becomes negative, firm j will be removed from 
                              
                                 E
                                 ¯
                              
                           .

Hence we can now examine the shape of ϕf
                            as a function of pf
                           . First, for a fixed 
                              
                                 E
                                 ¯
                              
                            we will compute the derivative of ϕf
                            with respect to pf
                           :

                              
                                 (11)
                                 
                                    
                                       
                                          
                                             ∂
                                             
                                                ϕ
                                                f
                                             
                                          
                                          
                                             ∂
                                             
                                                p
                                                f
                                             
                                          
                                       
                                       =
                                       −
                                       b
                                       
                                          
                                             
                                                |
                                                
                                                   E
                                                   ¯
                                                
                                                |
                                             
                                             −
                                             1
                                          
                                          
                                             |
                                             
                                                E
                                                ¯
                                             
                                             |
                                          
                                       
                                       .
                                    
                                 
                              
                           
                        

Note that this is negative, therefore, while the number of firms in the market is unchanged, ϕf
                            is a decreasing function of pf
                           . However, from above we know that as pf
                            is decreased the number of firms in set 
                              
                                 E
                                 ¯
                              
                            monotonically decreases. From Eq. (11), we can see that the gradient increases (becomes less negative) as 
                              
                                 |
                                 
                                    E
                                    ¯
                                 
                                 |
                              
                            decreases, hence ϕf
                            is a concave function over this range of pf
                           .□


                           Consider the modified risk-adjusted profit maximization problem for firm f, 
                              
                                 
                                    
                                       P
                                       ˜
                                    
                                    f
                                 
                                 
                                    (
                                    
                                       p
                                       
                                          −
                                          f
                                       
                                    
                                    ,
                                    ϵ
                                    )
                                 
                                 ,
                              
                            
                           below (where ϵ is a vector with components ϵ
                              n
                           
                           ):
                           
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         Π
                                                         ˜
                                                      
                                                      f
                                                   
                                                   
                                                      (
                                                      
                                                         p
                                                         
                                                            −
                                                            f
                                                         
                                                      
                                                      ,
                                                      ϵ
                                                      )
                                                   
                                                   =
                                                   max
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                      
                                                         ω
                                                         ∈
                                                         Ω
                                                      
                                                   
                                                   
                                                      ρ
                                                      
                                                         π
                                                         f
                                                         ω
                                                      
                                                   
                                                   −
                                                   
                                                      θ
                                                      α
                                                   
                                                   
                                                      ∑
                                                      
                                                         ω
                                                         ∈
                                                         Ω
                                                      
                                                   
                                                   
                                                      ρ
                                                      
                                                         [
                                                         
                                                            
                                                               (
                                                               
                                                                  1
                                                                  −
                                                                  α
                                                               
                                                               )
                                                            
                                                            
                                                               w
                                                               f
                                                               ω
                                                            
                                                            +
                                                            α
                                                            
                                                               v
                                                               f
                                                               ω
                                                            
                                                         
                                                         ]
                                                      
                                                   
                                                
                                             
                                             
                                                
                                             
                                             
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      s
                                                      .
                                                      t
                                                      .
                                                   
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      π
                                                      f
                                                      ω
                                                   
                                                   =
                                                   
                                                      η
                                                      f
                                                   
                                                   +
                                                   
                                                      v
                                                      f
                                                      ω
                                                   
                                                   −
                                                   
                                                      w
                                                      f
                                                      ω
                                                   
                                                
                                             
                                             
                                                
                                                   [
                                                   
                                                      λ
                                                      f
                                                      ω
                                                   
                                                   ]
                                                
                                             
                                             
                                                
                                                   ∀
                                                   ω
                                                   ∈
                                                   Ω
                                                
                                             
                                          
                                          
                                             
                                                
                                             
                                             
                                                
                                                   
                                                      π
                                                      f
                                                      ω
                                                   
                                                   ≤
                                                   
                                                      ∑
                                                      
                                                         n
                                                         ∈
                                                         N
                                                      
                                                   
                                                   
                                                      [
                                                      
                                                         
                                                            X
                                                            n
                                                            ω
                                                         
                                                         
                                                            ∑
                                                            
                                                               i
                                                               ∈
                                                               
                                                                  E
                                                                  n
                                                               
                                                               ∩
                                                               
                                                                  {
                                                                  f
                                                                  }
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               (
                                                               
                                                                  
                                                                     p
                                                                     
                                                                        n
                                                                        i
                                                                     
                                                                  
                                                                  −
                                                                  
                                                                     c
                                                                     n
                                                                     ω
                                                                  
                                                               
                                                               )
                                                            
                                                            
                                                               
                                                                  ϕ
                                                                  ^
                                                               
                                                               
                                                                  n
                                                                  i
                                                               
                                                            
                                                         
                                                      
                                                      ]
                                                   
                                                   +
                                                   
                                                      P
                                                      f
                                                      ω
                                                   
                                                   
                                                
                                             
                                             
                                                
                                                   [
                                                   
                                                      μ
                                                      f
                                                      ω
                                                   
                                                   ]
                                                
                                             
                                             
                                                
                                                   ∀
                                                   ω
                                                   ∈
                                                   Ω
                                                
                                             
                                          
                                          
                                             
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         ϕ
                                                         ^
                                                      
                                                      
                                                         n
                                                         f
                                                      
                                                   
                                                   =
                                                   
                                                      1
                                                      
                                                         |
                                                         
                                                            E
                                                            n
                                                         
                                                         |
                                                      
                                                   
                                                   
                                                      [
                                                      
                                                         1
                                                         +
                                                         b
                                                         
                                                            ∑
                                                            
                                                               i
                                                               ∈
                                                               
                                                                  E
                                                                  n
                                                               
                                                               
                                                                  ∖
                                                               
                                                               
                                                                  {
                                                                  f
                                                                  }
                                                               
                                                            
                                                         
                                                         
                                                            (
                                                            
                                                               
                                                                  p
                                                                  
                                                                     n
                                                                     i
                                                                  
                                                               
                                                               −
                                                               
                                                                  p
                                                                  
                                                                     n
                                                                     f
                                                                  
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                      ]
                                                   
                                                   −
                                                   
                                                      ϵ
                                                      n
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      [
                                                      
                                                         ν
                                                         
                                                            n
                                                            f
                                                         
                                                      
                                                      ]
                                                   
                                                   
                                                
                                             
                                             
                                                
                                                   ∀
                                                   n
                                                   ∈
                                                   N
                                                
                                             
                                          
                                          
                                             
                                                
                                             
                                             
                                                
                                                   
                                                      w
                                                      f
                                                      ω
                                                   
                                                   ,
                                                   
                                                      v
                                                      f
                                                      ω
                                                   
                                                   ≥
                                                   0
                                                
                                             
                                             
                                                
                                             
                                             
                                                
                                                   ∀
                                                   ω
                                                   ∈
                                                   Ω
                                                
                                             
                                          
                                          
                                             
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         ϕ
                                                         ^
                                                      
                                                      
                                                         n
                                                         f
                                                      
                                                   
                                                   ≥
                                                   0
                                                
                                             
                                             
                                                
                                             
                                             
                                                
                                                   ∀
                                                   n
                                                   ∈
                                                   N
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                           Suppose we have some
                           
                              
                                 p
                                 
                                    −
                                    f
                                 
                              
                            
                           such that
                           
                              
                                 
                                    ϕ
                                    
                                       n
                                       f
                                    
                                 
                                 >
                                 0
                                 ,
                                 
                                 ∀
                                 f
                                 ∈
                                 
                                    E
                                    n
                                 
                                 ,
                                 
                                 ∀
                                 n
                              
                            
                           at the optimal solution to
                           
                              
                                 
                                    P
                                    f
                                 
                                 
                                    (
                                    
                                       p
                                       
                                          −
                                          f
                                       
                                    
                                    )
                                 
                              
                           
                           . Then given a vector ϵ ≥ 0, we have
                           
                              
                                 
                                    
                                       Π
                                       ˜
                                    
                                    f
                                 
                                 
                                    (
                                    
                                       p
                                       
                                          −
                                          f
                                       
                                    
                                    ,
                                    ϵ
                                    )
                                 
                                 ≤
                                 
                                    Π
                                    f
                                 
                                 
                                    (
                                    
                                       p
                                       
                                          −
                                          f
                                       
                                    
                                    )
                                 
                              
                           
                           .
                        

We will prove this in two parts: first we will show that 
                              
                                 
                                    Π
                                    f
                                 
                                 
                                    (
                                    
                                       p
                                       
                                          −
                                          f
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       Π
                                       ˜
                                    
                                    f
                                 
                                 
                                    (
                                    
                                       p
                                       
                                          −
                                          f
                                       
                                    
                                    ,
                                    0
                                    )
                                 
                              
                           ; and then that 
                              
                                 
                                    
                                       Π
                                       ˜
                                    
                                    f
                                 
                                 
                                    (
                                    
                                       p
                                       
                                          −
                                          f
                                       
                                    
                                    ,
                                    ϵ
                                    )
                                 
                                 ≤
                                 
                                    
                                       Π
                                       ˜
                                    
                                    f
                                 
                                 
                                    (
                                    
                                       p
                                       
                                          −
                                          f
                                       
                                    
                                    ,
                                    0
                                    )
                                 
                                 ,
                              
                            for all ϵ ≥ 0.

Note that there are three differences between 
                              
                                 
                                    P
                                    f
                                 
                                 
                                    (
                                    
                                       p
                                       
                                          −
                                          f
                                       
                                    
                                    )
                                 
                              
                            and 
                              
                                 
                                    
                                       P
                                       ˜
                                    
                                    f
                                 
                                 
                                    (
                                    
                                       p
                                       
                                          −
                                          f
                                       
                                    
                                    ,
                                    ϵ
                                    )
                                 
                              
                           :

                              
                                 •
                                 the second constraint is now an inequality;

ϵ appears in the third constraint; and

a non-negativity constraint on 
                                       
                                          
                                             ϕ
                                             ^
                                          
                                          
                                             n
                                             f
                                          
                                       
                                     has been added.

Since at the optimal solution to 
                              
                                 
                                    P
                                    f
                                 
                                 
                                    (
                                    
                                       p
                                       
                                          −
                                          f
                                       
                                    
                                    )
                                 
                              
                            we have (from the statement of the lemma) that 
                              
                                 
                                    
                                       ϕ
                                       ^
                                    
                                    
                                       n
                                       f
                                    
                                 
                                 >
                                 0
                                 ,
                              
                            the addition of the non-negativity constraint does not change the optimal solution. Moreover, the third constraint in 
                              
                                 
                                    P
                                    f
                                 
                                 
                                    (
                                    
                                       p
                                       
                                          −
                                          f
                                       
                                    
                                    )
                                 
                              
                            and 
                              
                                 
                                    
                                       P
                                       ˜
                                    
                                    f
                                 
                                 
                                    (
                                    
                                       p
                                       
                                          −
                                          f
                                       
                                    
                                    ,
                                    0
                                    )
                                 
                              
                            are identical since 
                              
                                 ϵ
                                 =
                                 0
                              
                           . The final concern is whether changing the second constraint to an inequality may lead to a different optimal solution. Through the KKT conditions
                              17
                           
                           
                              17
                              Since the above mathematical program is convex, the KKT conditions are both necessary and sufficient for optimality.
                            we will show that the second constraint is always binding at the optimal solution to 
                              
                                 
                                    
                                       P
                                       ˜
                                    
                                    f
                                 
                                 
                                    (
                                    
                                       p
                                       
                                          −
                                          f
                                       
                                    
                                    ,
                                    0
                                    )
                                 
                              
                            and thus that solution must be the same as the optimal solution to 
                              
                                 
                                    P
                                    f
                                 
                                 
                                    (
                                    
                                       p
                                       
                                          −
                                          f
                                       
                                    
                                    )
                                 
                              
                           .

We present the KKT conditions below:

                              
                                 (12)
                                 
                                    
                                       
                                          π
                                          f
                                          ω
                                       
                                       =
                                       
                                          η
                                          f
                                       
                                       +
                                       
                                          v
                                          f
                                          ω
                                       
                                       −
                                       
                                          w
                                          f
                                          ω
                                       
                                       
                                       ∀
                                       ω
                                       ∈
                                       Ω
                                    
                                 
                              
                           
                           
                              
                                 (13)
                                 
                                    
                                       
                                          
                                          
                                          
                                             
                                                0
                                                ≤
                                                
                                                   μ
                                                   f
                                                   ω
                                                
                                                
                                                
                                                ⊥
                                                
                                                
                                                
                                                   ∑
                                                   
                                                      n
                                                      ∈
                                                      N
                                                   
                                                
                                                
                                                   [
                                                   
                                                      
                                                         X
                                                         n
                                                         ω
                                                      
                                                      
                                                         ∑
                                                         
                                                            i
                                                            ∈
                                                            
                                                               E
                                                               n
                                                            
                                                            ∩
                                                            
                                                               {
                                                               f
                                                               }
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            (
                                                            
                                                               
                                                                  p
                                                                  
                                                                     n
                                                                     i
                                                                  
                                                               
                                                               −
                                                               
                                                                  c
                                                                  n
                                                                  ω
                                                               
                                                            
                                                            )
                                                         
                                                         
                                                            
                                                               ϕ
                                                               ^
                                                            
                                                            
                                                               n
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                   ]
                                                
                                                +
                                                
                                                   P
                                                   f
                                                   ω
                                                
                                                −
                                                
                                                   π
                                                   f
                                                   ω
                                                
                                                ≥
                                                0
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                
                                                ∀
                                                
                                                ω
                                                ∈
                                                Ω
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (14)
                                 
                                    
                                       
                                          
                                             ϕ
                                             ^
                                          
                                          
                                             n
                                             f
                                          
                                       
                                       =
                                       
                                          1
                                          
                                             |
                                             
                                                E
                                                n
                                             
                                             |
                                          
                                       
                                       
                                          [
                                          
                                             1
                                             +
                                             b
                                             
                                                ∑
                                                
                                                   i
                                                   ∈
                                                   
                                                      E
                                                      n
                                                   
                                                   
                                                      ∖
                                                   
                                                   
                                                      {
                                                      f
                                                      }
                                                   
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      p
                                                      
                                                         n
                                                         i
                                                      
                                                   
                                                   −
                                                   
                                                      p
                                                      
                                                         n
                                                         f
                                                      
                                                   
                                                
                                                )
                                             
                                          
                                          ]
                                       
                                       −
                                       
                                          ϵ
                                          n
                                       
                                       
                                       ∀
                                       n
                                       ∈
                                       N
                                    
                                 
                              
                           
                           
                              
                                 (15)
                                 
                                    
                                       −
                                       ρ
                                       +
                                       
                                          λ
                                          f
                                          ω
                                       
                                       +
                                       
                                          μ
                                          f
                                          ω
                                       
                                       =
                                       0
                                       
                                       ∀
                                       ω
                                       ∈
                                       Ω
                                    
                                 
                              
                           
                           
                              
                                 (16)
                                 
                                    
                                       
                                          
                                          
                                             
                                                −
                                                
                                                   ∑
                                                   
                                                      ω
                                                      ∈
                                                      Ω
                                                   
                                                
                                                
                                                   λ
                                                   f
                                                   ω
                                                
                                                =
                                                0
                                             
                                          
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (17)
                                 
                                    
                                       0
                                       ≤
                                       
                                          v
                                          f
                                          ω
                                       
                                       
                                       
                                       ⊥
                                       
                                       
                                       θ
                                       ρ
                                       −
                                       
                                          λ
                                          f
                                          ω
                                       
                                       ≥
                                       0
                                       
                                       ∀
                                       ω
                                       ∈
                                       Ω
                                    
                                 
                              
                           
                           
                              
                                 (18)
                                 
                                    
                                       0
                                       ≤
                                       
                                          w
                                          f
                                          ω
                                       
                                       
                                       
                                       ⊥
                                       
                                       
                                       θ
                                       
                                          
                                             1
                                             −
                                             α
                                          
                                          α
                                       
                                       ρ
                                       +
                                       
                                          λ
                                          f
                                          ω
                                       
                                       ≥
                                       0
                                       
                                       ∀
                                       ω
                                       ∈
                                       Ω
                                    
                                 
                              
                           
                           
                              
                                 (19)
                                 
                                    
                                       −
                                       
                                          ∑
                                          
                                             ω
                                             ∈
                                             Ω
                                          
                                       
                                       
                                          
                                             X
                                             ω
                                          
                                          
                                             
                                                ϕ
                                                ^
                                             
                                             
                                                n
                                                f
                                             
                                          
                                          
                                             μ
                                             f
                                             ω
                                          
                                          +
                                          b
                                          
                                             
                                                
                                                   |
                                                   
                                                      E
                                                      n
                                                   
                                                   |
                                                
                                                −
                                                1
                                             
                                             
                                                |
                                                
                                                   E
                                                   n
                                                
                                                |
                                             
                                          
                                       
                                       
                                          ν
                                          
                                             n
                                             f
                                          
                                       
                                       =
                                       0
                                       
                                       ∀
                                       n
                                       ∈
                                       N
                                    
                                 
                              
                           
                           
                              
                                 (20)
                                 
                                    
                                       
                                          
                                             
                                                0
                                                ≤
                                                
                                                   
                                                      ϕ
                                                      ^
                                                   
                                                   
                                                      n
                                                      f
                                                   
                                                
                                                
                                                
                                                
                                                ⊥
                                                
                                                
                                                
                                                   ν
                                                   
                                                      n
                                                      f
                                                   
                                                
                                                −
                                                
                                                   ∑
                                                   
                                                      ω
                                                      ∈
                                                      Ω
                                                   
                                                
                                                
                                                   [
                                                   
                                                      X
                                                      n
                                                      ω
                                                   
                                                   
                                                      ∑
                                                      
                                                         i
                                                         ∈
                                                         
                                                            E
                                                            n
                                                         
                                                         ∩
                                                         
                                                            {
                                                            f
                                                            }
                                                         
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            p
                                                            
                                                               n
                                                               i
                                                            
                                                         
                                                         −
                                                         
                                                            c
                                                            n
                                                            ω
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      μ
                                                      f
                                                      ω
                                                   
                                                   ]
                                                
                                                ≥
                                                0
                                                
                                                ∀
                                                n
                                                ∈
                                                N
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

First, consider right-hand inequalities of constraints (17) and (18). These can be rearranged to give the following upper and lower bounds on 
                              
                                 λ
                                 f
                                 ω
                              
                           :

                              
                                 
                                    
                                       −
                                       θ
                                       
                                          
                                             1
                                             −
                                             α
                                          
                                          α
                                       
                                       ρ
                                       ≤
                                       
                                          λ
                                          f
                                          ω
                                       
                                       ≤
                                       θ
                                       ρ
                                       .
                                    
                                 
                              
                           From above and Eq. (15), we can therefore find bounds on 
                              
                                 μ
                                 f
                                 ω
                              
                           :

                              
                                 
                                    
                                       ρ
                                       
                                          (
                                          
                                             1
                                             −
                                             θ
                                          
                                          )
                                       
                                       ≤
                                       
                                          μ
                                          f
                                          ω
                                       
                                       ≤
                                       ρ
                                       
                                          (
                                          
                                             1
                                             +
                                             θ
                                             
                                                
                                                   1
                                                   −
                                                   α
                                                
                                                α
                                             
                                          
                                          )
                                       
                                       .
                                    
                                 
                              
                           Since θ < 1, we can see that 
                              
                                 
                                    μ
                                    f
                                    ω
                                 
                                 >
                                 0
                                 ,
                                 
                                 ∀
                                 ω
                                 ∈
                                 Ω
                              
                           . From the orthogonality condition (13) we therefore must have the second constraint binding at the optimal solution. Hence, since the optimal solutions are identical we must have

                              
                                 
                                    
                                       
                                          Π
                                          f
                                       
                                       
                                          (
                                          
                                             p
                                             
                                                −
                                                f
                                             
                                          
                                          )
                                       
                                       =
                                       
                                          
                                             Π
                                             ˜
                                          
                                          f
                                       
                                       
                                          (
                                          
                                             p
                                             
                                                −
                                                f
                                             
                                          
                                          ,
                                          0
                                          )
                                       
                                       .
                                    
                                 
                              
                           
                        

Now let us turn our attention to the second part of the lemma. We wish to prove, for any ϵ ≥ 0, that 
                              
                                 
                                    
                                       Π
                                       ˜
                                    
                                    f
                                 
                                 
                                    (
                                    
                                       p
                                       
                                          −
                                          f
                                       
                                    
                                    ,
                                    ϵ
                                    )
                                 
                                 ≤
                                 
                                    
                                       Π
                                       ˜
                                    
                                    f
                                 
                                 
                                    (
                                    
                                       p
                                       
                                          −
                                          f
                                       
                                    
                                    ,
                                    0
                                    )
                                 
                              
                           
                        

From the result above that 
                              
                                 
                                    μ
                                    f
                                    ω
                                 
                                 >
                                 0
                              
                            and Eq. (19) we can deduce the sign of νnf
                           :

                              
                                 
                                    
                                       
                                          ν
                                          
                                             n
                                             f
                                          
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   |
                                                   
                                                      E
                                                      n
                                                   
                                                   |
                                                
                                                
                                                   b
                                                   
                                                      (
                                                      
                                                         
                                                            |
                                                            
                                                               E
                                                               n
                                                            
                                                            |
                                                         
                                                         −
                                                         1
                                                      
                                                      )
                                                   
                                                
                                             
                                             ︷
                                          
                                          
                                             ≥
                                             0
                                          
                                       
                                       
                                          ϕ
                                          
                                             n
                                             f
                                          
                                       
                                       
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      ω
                                                      ∈
                                                      Ω
                                                   
                                                
                                                
                                                   
                                                      X
                                                      ω
                                                   
                                                   
                                                      μ
                                                      f
                                                      ω
                                                   
                                                
                                             
                                             ︷
                                          
                                          
                                             ≥
                                             0
                                          
                                       
                                       ,
                                    
                                 
                              
                           thus, so long as ϕnf
                            ≥ 0, we have νnf
                            ≥ 0. This means that the rate of change of the optimal value function with respect to any component of ϵ is negative. Moreover, this is true for any ϵ ≥ 0, hence we must have 
                              
                                 
                                    Π
                                    ˜
                                 
                                 
                                    (
                                    
                                       p
                                       
                                          −
                                          f
                                       
                                    
                                    ,
                                    ϵ
                                    )
                                 
                                 ≤
                                 
                                    Π
                                    ˜
                                 
                                 
                                    (
                                    
                                       p
                                       
                                          −
                                          f
                                       
                                    
                                    ,
                                    0
                                    )
                                 
                              
                           .

Combining this result with the one from the first part of the proof, we have:

                              
                                 
                                    
                                       
                                          
                                             Π
                                             ˜
                                          
                                          f
                                       
                                       
                                          (
                                          
                                             p
                                             
                                                −
                                                f
                                             
                                          
                                          ,
                                          ϵ
                                          )
                                       
                                       ≤
                                       
                                          Π
                                          f
                                       
                                       
                                          (
                                          
                                             p
                                             
                                                −
                                                f
                                             
                                          
                                          )
                                       
                                       ,
                                       
                                       ∀
                                       ϵ
                                       ≥
                                       0
                                       ,
                                    
                                 
                              
                           as required.□

Note that Lemma 7.4 implies that any decrease in the (individual) nodal market-share (while keeping the prices fixed) will yield a lower profit compared to the optimal profit given the vector of current prices.

                        Lemma 7.5
                        
                           Given an arbitrary but fixed set of entrants
                           
                              E
                            
                           (
                           
                              
                                 E
                                 n
                              
                            
                           for each node
                           
                              
                                 n
                                 ∈
                                 N
                              
                           
                           ), any equilibrium, ψ, for
                           
                              
                                 
                                    G
                                    ^
                                 
                                 E
                              
                            
                           that has positive demand for all firms is also an equilibrium for
                           
                              
                                 G
                                 E
                              
                           
                           .
                        

First recall that ψ is an equilibrium for 
                              
                                 
                                    G
                                    ^
                                 
                                 E
                              
                            if and only if no firm has incentive to deviate. We now consider the strategy set ψ under game 
                              
                                 G
                                 E
                              
                           . For ψ to not be an equilibrium for 
                              
                                 
                                    G
                                    E
                                 
                                 ,
                              
                            this means at least one firm has incentive to deviate from ψ. Clearly this deviation (to strategy 
                              
                                 ψ
                                 ^
                              
                           ) must result in 
                              
                                 
                                    ϕ
                                    
                                       n
                                       f
                                    
                                 
                                 =
                                 0
                              
                            under game 
                              
                                 G
                                 E
                              
                            and ϕnf
                            < 0 under game 
                              
                                 
                                    G
                                    ^
                                 
                                 E
                              
                            for at least one firm f and node n. We will analyze the following two cases:

                              
                                 1.
                                 either f, the deviating firm, causes negative demand (under 
                                       
                                          
                                             G
                                             ^
                                          
                                          E
                                       
                                    ) for itself (and possibly other firms),

or, firm f’s deviation causes another firm to have negative demand (under 
                                       
                                          
                                             G
                                             ^
                                          
                                          E
                                       
                                    ).

We will show that both cases lead to a contradiction. Under case 1, 
                              
                                 ψ
                                 ^
                              
                            leads to a nodal market-share of 0 under 
                              
                                 G
                                 E
                              
                           . Such a strategy gives a retail profit of 0 at node n for all scenarios. The total risk-adjusted profit in 
                              
                                 G
                                 E
                              
                            would be the same if the firm were to choose a price, pnf
                           , such that 
                              
                                 
                                    ϕ
                                    
                                       n
                                       f
                                    
                                 
                                 =
                                 0
                              
                            in 
                              
                                 
                                    G
                                    ^
                                 
                                 E
                              
                           ; since this was a feasible choice for the firm in 
                              
                                 
                                    
                                       G
                                       ^
                                    
                                    E
                                 
                                 ,
                              
                            this can not be a profitable deviation.

To show a contradiction for case 2, we must first understand the nature of a firm’s market-share as a function of its retail price under 
                              
                                 G
                                 E
                              
                           . Recall from Lemma 7.3 that, in 
                              
                                 
                                    G
                                    E
                                 
                                 ,
                              
                            firm f’s market-share at any node n as a function of its retail price is concave (so long as ϕnf
                            > 0), and observe from Eq. (2) that the market share in 
                              
                                 D
                                 ^
                              
                            is a linear function of prices. Moreover, when 
                              
                                 
                                    ϕ
                                    
                                       n
                                       i
                                    
                                 
                                 >
                                 0
                                 ,
                                 
                                 ∀
                                 i
                                 ∈
                                 
                                    E
                                    n
                                 
                                 ,
                                 
                                 ∀
                                 n
                                 ∈
                                 N
                                 ,
                              
                            the market share from both 
                              
                                 G
                                 E
                              
                            and 
                              
                                 
                                    G
                                    ^
                                 
                                 E
                              
                            are identical. Therefore, for a given retail price, pnf
                           , the market share for firm f computed from 
                              D
                            must be less than or equal to the market share from 
                              
                                 D
                                 ^
                              
                           .

Thus, suppose we compute the optimal solution to firm f’s best response problem, assuming demand model 
                              D
                            and this gave optimal prices, 
                              
                                 
                                    p
                                    
                                       n
                                       f
                                    
                                    *
                                 
                                 ,
                              
                            and retail market-shares of 
                              
                                 ϕ
                                 
                                    n
                                    f
                                 
                                 *
                              
                           . Now set 
                              
                                 
                                    ϵ
                                    n
                                    *
                                 
                                 =
                                 
                                    
                                       ϕ
                                       ^
                                    
                                    
                                       n
                                       f
                                    
                                 
                                 
                                    (
                                    
                                       p
                                       
                                          n
                                          f
                                       
                                       *
                                    
                                    )
                                 
                                 −
                                 
                                    ϕ
                                    
                                       n
                                       f
                                    
                                    *
                                 
                              
                            (which must be non-negative due the concavity of ϕnf
                           ); it is clear that for 
                              
                                 
                                    P
                                    ˜
                                 
                                 
                                    (
                                    
                                       p
                                       
                                          −
                                          f
                                       
                                    
                                    ,
                                    
                                       ϵ
                                       *
                                    
                                    )
                                 
                                 ,
                              
                           
                           
                              
                                 p
                                 
                                    n
                                    f
                                 
                                 *
                              
                            gives market-shares 
                              
                                 
                                    ϕ
                                    
                                       n
                                       f
                                    
                                 
                                 
                                    (
                                    
                                       p
                                       
                                          n
                                          f
                                       
                                       *
                                    
                                    )
                                 
                                 −
                                 
                                    ϵ
                                    n
                                    *
                                 
                                 =
                                 
                                    ϕ
                                    
                                       n
                                       f
                                    
                                    *
                                 
                              
                            (thus the deviation profit is equal to 
                              
                                 
                                    Π
                                    ˜
                                 
                                 
                                    (
                                    
                                       p
                                       
                                          −
                                          f
                                       
                                    
                                    ,
                                    
                                       ϵ
                                       *
                                    
                                    )
                                 
                              
                           ). However, from Lemma 7.4 we know that 
                              
                                 
                                    Π
                                    ˜
                                 
                                 
                                    (
                                    
                                       p
                                       
                                          −
                                          f
                                       
                                    
                                    ,
                                    
                                       ϵ
                                       *
                                    
                                    )
                                 
                                 ≤
                                 Π
                                 
                                    (
                                    
                                       p
                                       
                                          −
                                          f
                                       
                                    
                                    )
                                 
                              
                           . Thus there can be no profitable deviation.

The two possible deviation cases, considered above, have been shown to not give incentive for the deviation. Hence, since there are no other possible deviation strategies, ψ is an equilibrium for 
                              
                                 G
                                 E
                              
                           .□


                           Any equilibrium, ψ, to the game
                           
                              
                                 G
                                 E
                              
                            
                           which has positive demand for all firms is also an equilibrium to the game
                           
                              
                                 
                                    G
                                    ^
                                 
                                 E
                              
                           
                           .
                        

First observe that in the game 
                              
                                 
                                    
                                       G
                                       ^
                                    
                                    E
                                 
                                 ,
                              
                            each firm has a convex optimization problem. Moreover, note that demand models 
                              D
                            and 
                              
                                 D
                                 ^
                              
                            yield identical retail demands where ϕ > 0. Hence any interior global optimal for a firm’s profit maximization under demand model 
                              D
                            must also be the global optimal under 
                              
                                 D
                                 ^
                              
                           . Since the equilibrium, ψ, for the game 
                              
                                 G
                                 E
                              
                            is such that ϕnf
                            > 0 for all firms and nodes, and each firm is at a global optimal strategy, such a point must be an equilibrium for the game 
                              
                                 
                                    G
                                    ^
                                 
                                 E
                              
                           .□


                           If there exists no equilibrium for the game
                           
                              
                                 
                                    G
                                    ^
                                 
                                 E
                              
                            
                           with
                           
                              
                                 
                                    
                                       ϕ
                                       ^
                                    
                                    
                                       n
                                       f
                                    
                                 
                                 >
                                 0
                              
                            
                           for all firms f at all nodes n, then there exists no equilibrium for the game
                           
                              
                                 G
                                 E
                              
                            
                           with ϕnf
                            > 0. Thus, if an equilibrium exists for
                           
                              
                                 
                                    G
                                    E
                                 
                                 ,
                              
                            
                           then there must be at least one firm which receives no demand, and hence would have been better off not entering the retail market in the first stage (assuming a positive cost of entry).
                        

From Lemma 7.6 we know that any equilibrium for 
                              
                                 G
                                 E
                              
                            with ϕnf
                            > 0 is also an equilibrium for 
                              
                                 
                                    
                                       G
                                       ^
                                    
                                    E
                                 
                                 ,
                              
                            thus if no such equilibrium exists for 
                              
                                 
                                    G
                                    ^
                                 
                                 E
                              
                            then the same is true for 
                              
                                 G
                                 E
                              
                           . Therefore, if an equilibrium for 
                              
                                 G
                                 E
                              
                            does exist, at least one firm will receive a market share of 0 at some node n. In this case, with a positive cost of entry, any such firm would be able to improve its total profit by exiting the retail market at node n.□

The above lemmas and theorem show that if we compute an equilibrium for 
                        
                           
                              G
                              ^
                           
                           E
                        
                      with positive demand for all firms and nodes then this is a valid equilibrium for 
                        
                           G
                           E
                        
                     . Conversely, if we find that there is some firm with a negative market share at a node, then some firm would achieve a higher payoff by not entering the market in the first stage (meaning that this sub-game would not be on the equilibrium path).

@&#REFERENCES@&#

