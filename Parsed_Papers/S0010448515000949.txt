@&#MAIN-TITLE@&#Isogeometric segmentation: Construction of auxiliary curves

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A method is proposed for splitting a trimmed surface into two with a curve.


                        
                        
                           
                           The curve is required to have specified endpoints and tangents at the endpoints.


                        
                        
                           
                           The splitting is central to an algorithm for isogeometric segmentation of 3D models.


                        
                        
                           
                           The curve optimizes a penalty function that measures the quality of the shapes.


                        
                        
                           
                           We study regularity properties and methods for computing the penalty function.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Isogeometric segmentation

Isogeometric analysis

Trimmed surface splitting problem

Domain splitting problem

@&#ABSTRACT@&#


               
               
                  In the context of segmenting a boundary represented solid into topological hexahedra suitable for isogeometric analysis, it is often necessary to split an existing face by constructing auxiliary curves. We consider solids represented as a collection of trimmed spline surfaces, and design a curve which can split the domain of a trimmed surface into two pieces satisfying the following criteria: the curve must not intersect the boundary of the original domain, it must not intersect itself, the two resulting pieces should have good shape, and the endpoints and the tangents of the curve at the endpoints must be equal to specified values.
               
            

@&#INTRODUCTION@&#

Motivated by the problem of segmenting a solid into pieces suitable for isogeometric analysis (see  [1]), we develop a method for segmenting a trimmed surface by constructing a cutting curve. We consider a boundary represented solid to be a collection of trimmed NURBS surfaces, together with incidence information. A trimmed surface consists of (i) a tensor product NURBS map 
                        
                           
                              
                                 [
                                 0
                                 ,
                                 1
                                 ]
                              
                           
                           
                              2
                           
                        
                        →
                        
                           
                              R
                           
                           
                              3
                           
                        
                      defining the master surface; (ii) a trimmed domain, a subset of 
                        
                           
                              
                                 [
                                 0
                                 ,
                                 1
                                 ]
                              
                           
                           
                              2
                           
                        
                      which itself is represented by a collection of NURBS curves defining its boundary. The surface itself is the image of the restriction of the master spline to the trimmed domain.

In  [2,3] we initiated the development of a method for isogeometric segmentation, that is, the segmentation of a contractible boundary represented solid into boundary represented topological hexahedra (sufficiently smooth images of cubes). In order to be suitable for isogeometric analysis, the number of topological hexahedra in the segmentation should be small and it should be possible to convert each of them into a volumetric spline with no singularities and ideally not too much distortion. (Conversion of boundary represented topological hexahedra into volumetric splines can be done, using, for example, the method of  [4].) The idea of the method of  [2,3] is as follows:
                        
                           •
                           Search the edge graph of the solid (the graph formed by the edges shared by trimmed surfaces) for a cutting loop: a closed curve in the boundary of the solid which can be used as the boundary of a surface that splits the solid into two simpler solids (see Fig. 3). If multiple cutting loops are found, choose the best one according to a combination of combinatorial and geometric criteria.

By recursively splitting the solid into simpler pieces, we end up with a collection of base solids (topological hexahedra, tetrahedra and prisms) which have predefined segmentations into topological hexahedra.

Our problem is to split a planar domain in two, using a spline curve with the following properties: (i) end points and tangents are specified, (ii) the curve is reasonably regular, and (iii) the curve cuts a simply connected domain into two pieces with good shape.

An example, of somewhat exaggerated difficulty, is given in Fig. 1
                     . A domain is shown together with the required tangent vectors at the endpoints. A curve is shown which splits the domain into two pieces and meets the endpoints in the specified directions.

For a complicated domain, it may be easy to split the domain into 2 or more pieces with simple cuts that ignore the endpoint requirements. For example, the snake in Fig. 1 might be cut into any number of pieces with straight or nearly straight lines transversal to the snake’s body. Alternatively, the domain might be approximated by a quad mesh. These approaches are more appropriate than ours for segmenting a 2D object without restrictions. However, in order to realize the cutting loop that is central to the 3D segmentation algorithm outlined above, we must construct a curve that meets the specified end points with specified tangents.

The basic idea of our procedure is as follows. We define a cost function on the space of curves, which consists of a measurement of how close the curve comes to intersecting the domain, how close it comes to intersecting itself and a regularity term. An initial curve is found for this optimization problem by first finding a piecewise linear curve inside the domain satisfying the endpoint conditions, refining it and using the vertices as control points for a degree 2 B-spline.

It is important that the resulting curves are non-self-intersecting. In this sense, our problem is related to the problem of self-intersection elimination in curves and surfaces, studied in  [5–7]. Also related is the problem of threading a spline through a 2D or 3D channel  [8].

Several other approaches to the solution are possible. We might treat the problem as a path planning problem with obstacles (for overviews of this large topic in robotic control, see for example  [9] and  [10, Part IV]). Path planning using curves of piecewise constant curvature is studied in  [11,12] among other papers. Curves with continuous piecewise linear curvature were proposed in  [13] for interpolating between postures, and used in  [14] to produce a local path planner (these are not polynomial splines). Path planning with B-splines is studied in e.g.,  [15–18]. Our problem differs from path planning problems in several ways. The constructed curve must have endpoints on the boundary of the domain, and elsewhere must not intersect the boundary. The curve cuts the domain into two pieces, and it is the shape of these pieces that is important. Path planning methods are not designed to produce a well shaped splitting of the domain. Many path planning methods seek a curve in a configuration space. Our curves do not represent the trajectory of a rigid body. Also, simplicity of the resulting B-spline curve (in terms of the degree and number of knots) is important.

We considered the following approach to splitting the domain: map the domain to a convex shape (say, a circle) using mean value coordinates (MVC) or harmonic functions. It is easy to produce a B-spline curve connecting points on the boundary, and, by sampling the curve and using a predictor–corrector method, we can construct its preimage in the original domain. This approach is plausible but in our experience, several difficulties arise from this approach: (i) the outcome is a sampled curve, and a fitting step must be included to convert the samples into a B-spline. It is difficult to tell how many samples are needed to ensure that the fitted B-spline stays within the domain; (ii) using the boundary element method to compute MVC or harmonic functions is numerically challenging near the boundary of the domain; (iii) the quality of the result is dependent on how the curve is chosen in the convex domain, and it is not clear how to make a good choice.

Another approach we considered is to fit a spline curve to a polygonal path which is found using a pathfinding method that stays away from the domain boundary 
                        ∂
                        Ω
                      as follows: draw a line segment beginning at one of the end points in the initial specified direction, and ending at the first intersection point 
                        y
                      that the line has with 
                        ∂
                        Ω
                     . This divides the domain into two pieces. Discard the piece which does not contain the other endpoint. The first half of the line segment is included in the polygonal path, the midpoint of the line segment is set as the new starting point, and a new initial direction is chosen which is parallel to the tangent direction of 
                        ∂
                        Ω
                      at 
                        y
                     . Repeat the procedure until there is a line segment directly to the remaining endpoint. This procedure produces a curve fairly quickly but in certain scenarios can result in unnecessarily thin shapes as shown in Fig. 2
                     .

In Section  2 we give precise statements of our assumptions and goals and describe our construction method. Section  3 describes our method for constructing an initial curve. In Section  4 we formulate the optimization problem which we use to find a suitable splitting curve, and outline our strategy for solving the optimization problem. Section  5 provides examples of varying difficulty, and in Section  6 we summarize how our work fits in to the isogeometric segmentation problem and describe the outlook and future work. Appendices A and B prove regularity properties of the penalty functions, and in Appendix C we provide a method for efficiently computing them.

For context, we briefly outline the strategy described in  [2,3] for segmenting a solid. For our purposes, a solid is represented by a collection of trimmed surfaces, together with incidence information. We assume that the solid is contractible and that the edges form a simple, 3-vertex-connected edge graph. The edges of the graph are incidences between two faces. An auxiliary edge can be constructed between any two vertices that are on the same face but not on the same edge. A cutting loop is a cycle consisting of existing edges and auxiliary edges. The cutting loop can be used to split the edge graph into two, and the cutting loop is valid if it can be used as the boundary of a surface which splits the solid into two pieces, each satisfying the original assumptions. A valid cutting loop always exists, with the provision that under some circumstances, additional auxiliary vertices may need to be added to the graph. Repeatedly splitting the solid into two simpler pieces using cutting loops, we eventually arrive at a collection of base solids which have predefined segmentations into topological hexahedra. Examples of a single step of the solid segmentation method are shown in 
                        Figs. 2 and 3. In each of these examples, two existing edges and two newly created auxiliary edges are used to form a cutting loop.

There are geometric conditions on the validity of a cutting loop which place constraints on the sequence of edges. Once these constraints are known, the search for a good cutting loop becomes a combinatorial problem. However, once the loop is chosen, each auxiliary edge needs to be realized geometrically. In other words, for each auxiliary edge in the cutting loop, we need to solve the following problem. 
                           Problem 1
                           Trimmed Surface Splitting Problem


                           Find a spline curve of the trimmed domain, so that the trimmed surface is split into two new trimmed surfaces with reasonably good shapes.

Due to the geometric conditions for a valid cutting loop, a solution to the trimmed surface splitting problem must be able to handle specified tangent directions at the endpoints.

We now focus on the domain splitting problem, the part of the trimmed surface splitting problem that does not take consideration of the way the surface is embedded.

Consider a simply connected domain 
                           Ω
                           ⊂
                           
                              
                                 R
                              
                              
                                 2
                              
                           
                         with connected interior. We restrict our consideration to the case where the boundary 
                           ∂
                           Ω
                         of 
                           Ω
                         is formed by spline curves  [20]. Suppose two points 
                           
                              A
                           
                         and 
                           
                              B
                           
                         on the boundary of 
                           Ω
                         are given, along with two nonzero vectors 
                           
                              α
                           
                         and 
                           
                              β
                           
                         that point from 
                           
                              A
                           
                         and 
                           
                              B
                           
                         to the domain interior respectively. Without losing generality, we assume that the boundary 
                           ∂
                           Ω
                         consists of two spline curves 
                           
                              b
                           
                           
                              (
                              v
                              )
                           
                         and 
                           
                              
                                 
                                    b
                                 
                              
                              
                                 ˜
                              
                           
                           
                              (
                              v
                              )
                           
                           ,
                           
                           v
                           ∈
                           
                              [
                              0
                              ,
                              1
                              ]
                           
                        , so that 
                           
                              b
                           
                           
                              (
                              0
                              )
                           
                           ≡
                           
                              
                                 
                                    b
                                 
                              
                              
                                 ˜
                              
                           
                           
                              (
                              0
                              )
                           
                           ≡
                           
                              A
                           
                           ,
                           
                              b
                           
                           
                              (
                              1
                              )
                           
                           ≡
                           
                              
                                 
                                    b
                                 
                              
                              
                                 ˜
                              
                           
                           
                              (
                              1
                              )
                           
                           ≡
                           
                              B
                           
                        . The notations are illustrated in Fig. 4
                        .

Additionally, we narrow our consideration to the situation specified by the following assumptions. 
                           
                              (A-1)
                              The two curves 
                                    
                                       b
                                    
                                    
                                       (
                                       v
                                       )
                                    
                                  and 
                                    
                                       
                                          
                                             b
                                          
                                       
                                       
                                          ˜
                                       
                                    
                                    
                                       (
                                       v
                                       )
                                    
                                  have non-vanishing tangents at their end points.

Domain 
                                    Ω
                                  has non-zero interior angles at 
                                    
                                       A
                                    
                                  and 
                                    
                                       B
                                    
                                 ; the prescribed velocity direction 
                                    
                                       α
                                    
                                  is not tangent to any of the boundary curves at 
                                    
                                       A
                                    
                                 ; likewise, 
                                    
                                       β
                                    
                                  is not tangent to any of the boundary curves at 
                                    
                                       B
                                    
                                 .

Throughout the remainder of the paper, we shall often associate discussions with the curve 
                           
                              b
                           
                           
                              (
                              v
                              )
                           
                         while referring to 
                           
                              
                                 
                                    b
                                 
                              
                              
                                 ˜
                              
                           
                           
                              (
                              v
                              )
                           
                         as a similar case. Assume that the curve 
                           
                              b
                           
                           
                              (
                              v
                              )
                           
                         is of the form 
                           
                              b
                           
                           
                              (
                              v
                              )
                           
                           =
                           
                              
                                 ∑
                              
                              
                                 j
                                 =
                                 1
                              
                              
                                 n
                              
                           
                           
                              
                                 
                                    b
                                 
                              
                              
                                 j
                              
                           
                           
                              
                                 N
                              
                              
                                 j
                              
                           
                           
                              (
                              v
                              )
                           
                        , where 
                           
                              
                                 N
                              
                              
                                 j
                              
                           
                         are B-splines of degree 
                           q
                         and associated with an open knot vector 
                           V
                           =
                           
                              {
                              0
                              ,
                              …
                              ,
                              0
                              =
                              
                                 
                                    v
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    v
                                 
                                 
                                    2
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    v
                                 
                                 
                                    n
                                    −
                                    1
                                 
                              
                              ,
                              
                                 
                                    v
                                 
                                 
                                    n
                                 
                              
                              =
                              1
                              ,
                              …
                              ,
                              1
                              }
                           
                         (the first knot and the last knot are repeated 
                           q
                           +
                           1
                         times), and 
                           
                              
                                 
                                    b
                                 
                              
                              
                                 j
                              
                           
                           ∈
                           
                              
                                 R
                              
                              
                                 2
                              
                           
                         are associated control points.

Consider a spline curve 
                           
                              c
                           
                           
                              (
                              u
                              )
                           
                         of the form 
                           
                              (1)
                              
                                 
                                    c
                                 
                                 
                                    (
                                    u
                                    )
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       m
                                    
                                 
                                 
                                    
                                       
                                          c
                                       
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       M
                                    
                                    
                                       i
                                    
                                 
                                 
                                    (
                                    u
                                    )
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 M
                              
                              
                                 i
                              
                           
                         are B-splines of a degree 
                           p
                         and associated with an open knot vector 
                           
                              (2)
                              
                                 U
                                 =
                                 
                                    {
                                    0
                                    ,
                                    …
                                    ,
                                    0
                                    =
                                    
                                       
                                          u
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          u
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          u
                                       
                                       
                                          m
                                          −
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          u
                                       
                                       
                                          m
                                       
                                    
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    1
                                    }
                                 
                              
                           
                         (again, the first and the last knots are repeated 
                           p
                           +
                           1
                         times), and 
                           
                              
                                 
                                    c
                                 
                              
                              
                                 i
                              
                           
                           ∈
                           
                              
                                 R
                              
                              
                                 2
                              
                           
                         are control points. The following definition will facilitate our discussions in the remainder of the paper. 
                           Definition 1
                           A continuous spline curve 
                                 
                                    c
                                 
                                 
                                    (
                                    u
                                    )
                                 
                                 ,
                                 u
                                 ∈
                                 
                                    [
                                    0
                                    ,
                                    1
                                    ]
                                 
                              , is said to be a splitting curve of the domain 
                                 Ω
                               if it satisfies the following conditions. 
                                 
                                    (C-1)
                                    The curve 
                                          
                                             c
                                          
                                        starts at 
                                          
                                             A
                                          
                                        tangentially to 
                                          
                                             α
                                          
                                        and ends at 
                                          
                                             B
                                          
                                        tangentially to 
                                          
                                             β
                                          
                                       . That is, 
                                          
                                             (3)
                                             
                                                
                                                   
                                                      
                                                         
                                                            c
                                                         
                                                         
                                                            (
                                                            0
                                                            )
                                                         
                                                         =
                                                         
                                                            A
                                                         
                                                         ,
                                                         
                                                         
                                                            c
                                                         
                                                         
                                                            (
                                                            1
                                                            )
                                                         
                                                         =
                                                         
                                                            B
                                                         
                                                         ,
                                                      
                                                   
                                                   
                                                      
                                                         det
                                                         
                                                            [
                                                            
                                                               
                                                                  
                                                                     c
                                                                  
                                                               
                                                               
                                                                  ′
                                                               
                                                            
                                                            
                                                               (
                                                               0
                                                               )
                                                            
                                                            ,
                                                            
                                                               α
                                                            
                                                            ]
                                                         
                                                         =
                                                         0
                                                         ,
                                                         
                                                         det
                                                         
                                                            [
                                                            
                                                               
                                                                  
                                                                     c
                                                                  
                                                               
                                                               
                                                                  ′
                                                               
                                                            
                                                            
                                                               (
                                                               1
                                                               )
                                                            
                                                            ,
                                                            
                                                               β
                                                            
                                                            ]
                                                         
                                                         =
                                                         0
                                                         .
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    

We divide this condition into the following 3 sub-conditions. 
                                          
                                             (i)
                                             
                                                
                                                   
                                                      c
                                                   
                                                 is simple over 
                                                   
                                                      [
                                                      0
                                                      ,
                                                      1
                                                      ]
                                                   
                                                , i.e., 
                                                   
                                                      c
                                                   
                                                   
                                                      (
                                                      u
                                                      )
                                                   
                                                   ≠
                                                   
                                                      c
                                                   
                                                   
                                                      (
                                                      v
                                                      )
                                                   
                                                 for all 
                                                   u
                                                   ≠
                                                   v
                                                .


                                                
                                                   
                                                      
                                                         
                                                            c
                                                         
                                                      
                                                      
                                                         +
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   
                                                      (
                                                      u
                                                      )
                                                   
                                                   ≠
                                                   0
                                                 for 
                                                   0
                                                   ≤
                                                   u
                                                   <
                                                   1
                                                , and 
                                                   
                                                      
                                                         
                                                            c
                                                         
                                                      
                                                      
                                                         −
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   
                                                      (
                                                      u
                                                      )
                                                   
                                                   ≠
                                                   0
                                                 for all 
                                                   0
                                                   <
                                                   u
                                                   ≤
                                                   1
                                                .

For all 
                                                   0
                                                   <
                                                   u
                                                   <
                                                   1
                                                 and 
                                                   β
                                                   >
                                                   0
                                                   ,
                                                   
                                                      
                                                         
                                                            c
                                                         
                                                      
                                                      
                                                         +
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   
                                                      (
                                                      u
                                                      )
                                                   
                                                   ≠
                                                   −
                                                   β
                                                   
                                                      
                                                         
                                                            c
                                                         
                                                      
                                                      
                                                         −
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   
                                                      (
                                                      u
                                                      )
                                                   
                                                .

The curve 
                                          
                                             c
                                          
                                          
                                             (
                                             u
                                             )
                                          
                                        is contained in the interior of the domain 
                                          Ω
                                        except its two end points. That is, 
                                          
                                             {
                                             
                                                c
                                             
                                             
                                                (
                                                u
                                                )
                                             
                                             ,
                                             
                                             0
                                             <
                                             u
                                             <
                                             1
                                             }
                                          
                                          ⊂
                                          
                                             int
                                          
                                          
                                             (
                                             Ω
                                             )
                                          
                                       .

It immediately follows from the definition that a splitting curve of a simply connected domain decomposes the domain into two new simply connected domains.

We can now state our domain splitting problem, which differs from the trimmed surface splitting problem by not considering the embedding in 
                           
                              
                                 R
                              
                              
                                 3
                              
                           
                        . 
                           Problem 2
                           Domain Splitting Problem


                           Find a splitting spline curve 
                                 
                                    c
                                 
                                 
                                    (
                                    u
                                    )
                                 
                                 ,
                                 u
                                 ∈
                                 
                                    [
                                    0
                                    ,
                                    1
                                    ]
                                 
                              , of the domain 
                                 Ω
                               such that it has few control points and it splits 
                                 Ω
                               into two new simply connected domains with reasonably good shapes.

In Problems 1 and 2, a curve with “good shape” would stay far away from intersecting itself or the domain boundary, and would also be quite regular. Thus the measurement of the quality of shape is based on a combination of penalty functions, which we define in Section  4.

We solve this problem using the algorithm outlined in the next section.

Consider the domain 
                           Ω
                         and the domain splitting problem stated in Section  2.2. Our algorithm for numerically solving this problem is outlined below.


                        Curve initialization. First, we construct a splitting piecewise-linear curve 
                           
                              γ
                           
                           
                              (
                              u
                              )
                           
                         of 
                           Ω
                        , i.e., a curve that fulfils Conditions (C1-3). Additionally, it is useful to require the curve to satisfy that (a tighter condition than Condition (C2)): the distance from any one point on the curve to a point on the domain boundary is bounded from below by a given tolerance, except at the two ending segments where the curve meets the domain boundary. The splitting curve is not yet required to satisfy the geometric criterion that it should subdivide 
                           Ω
                         into two new domains with good shapes. The purpose of this step is to provide an initial curve, that is a splitting curve, to more sophisticated procedures in the later step of the algorithm. This step is detailed in Section  3.


                        Curve optimization. Based on the splitting piecewise-linear curve obtained from the last step, we construct a splitting spline curve of higher polynomial degree using a two-stage optimization strategy as follows. 
                           
                              •
                              
                                 Stage 1: find a splitting piecewise-linear curve that minimizes a penalty function which approaches infinity when the curve tends to violate Conditions (C2-3). We use a suitable refinement of the piecewise-linear curve 
                                    
                                       γ
                                    
                                    
                                       (
                                       u
                                       )
                                    
                                  obtained in the last step as the initial curve for the optimization.


                                 Stage 2: find a splitting spline curve of degree 
                                    p
                                    ≥
                                    2
                                  that minimizes the mentioned penalty function. A sufficiently refined spline fitting to the curve obtained from Stage 1 is used as the initial curve for the optimization.

We note that the optimization of Stage 1 is less expensive than that of Stage 2 as the spline curve under optimization is only of degree 1. Stage 1 helps to provide a good feasible initial solution for the optimization of Stage 2. That is, Stage 1 can result in a curve that is closer to a local minimum than a spline fitting to the initial curve from Step 1. The precise description of this step shall be presented in Section  4. The algorithm outline is illustrated in Fig. 5
                        .

We describe our method for constructing a splitting piecewise linear path of the domain 
                        Ω
                     . We construct a polygon 
                        P
                      interior to 
                        Ω
                      and use a Delaunay triangulation and Dijkstra’s algorithm to produce a path.

A polygon is computed such that it is contained in 
                        Ω
                     , contains 
                        
                           A
                        
                      and 
                        
                           B
                        
                      and its interior contains 
                        
                           A
                        
                        +
                        t
                        
                           α
                        
                      and 
                        
                           B
                        
                        +
                        t
                        
                           β
                        
                      for all sufficiently small 
                        t
                     .

(i) Find all the corners and inflection points of 
                        ∂
                        Ω
                     , and break it up into segments of three types: where the curvature is positive, zero, or negative. Segments of 
                        ∂
                        Ω
                      where the curvature is zero can be copied directly into 
                        P
                     . Segments where the curvature is positive can be discretized as follows: evaluate the segment of the curve at uniformly spaced parameters, and construct a polygonal path between the resulting points. Segments where the curvature is negative can be discretized as follows: evaluate the curve segment and its derivatives at uniformly spaced parameters, then construct a polygonal path such that the path’s endpoints and tangents coincide with the curve segment’s endpoints and tangents, and the path is tangent to the curve at the evaluated points.

(ii) Refine 
                        P
                      as necessary. Refining in the positively or negatively curved segments simply involves adding more parameter values and recomputing the polygons. The segments with zero curvature do not need to be refined. There are two ways in which refinement can be necessary. The segments containing 
                        
                           A
                        
                      or 
                        
                           B
                        
                      may need to be refined, to ensure that the polygon angles around 
                        
                           A
                        
                      and 
                        
                           B
                        
                      contain the directions 
                        
                           α
                        
                      and 
                        
                           β
                        
                     ; refinement may also be required to eliminate self-intersection of 
                        P
                     . If two segments of 
                        P
                      intersect each other, they are both refined. As the boundary 
                        ∂
                        Ω
                      does not intersect itself, a sufficiently (locally) refined polygon 
                        P
                      will not have intersecting non-neighboring edges.

Once the polygon 
                        P
                      is constructed, we compute a triangulation (we use a constrained Delaunay triangulation). A graph 
                        G
                      is formed, whose vertices are (i) midpoints of the edges of the Delaunay triangulation that are not edges of 
                        P
                     ; and (ii) the points 
                        
                           
                              
                                 A
                              
                           
                           
                              1
                           
                        
                        =
                        
                           A
                        
                        +
                        
                           
                              
                                 
                                    t
                                 
                                 
                                    1
                                 
                              
                           
                           
                              2
                           
                        
                        
                           α
                        
                      and 
                        
                           
                              
                                 B
                              
                           
                           
                              1
                           
                        
                        =
                        
                           B
                        
                        +
                        
                           
                              
                                 
                                    t
                                 
                                 
                                    2
                                 
                              
                           
                           
                              2
                           
                        
                        
                           β
                        
                     , where 
                        
                           
                              t
                           
                           
                              1
                           
                        
                      and 
                        
                           
                              t
                           
                           
                              2
                           
                        
                      are chosen small enough that 
                        
                           
                              
                                 A
                              
                           
                           
                              1
                           
                        
                      and 
                        
                           
                              
                                 B
                              
                           
                           
                              1
                           
                        
                      are inside the domain.

Two vertices of the graph 
                        G
                      have an edge between them if the line segment between them does not intersect the polygon 
                        P
                     . Note that there always exists an edge between two nodes which are in the same triangle of the triangulation. Since 
                        ∂
                        Ω
                      has no self-intersections, there must be a sequence of triangles in the triangulation, starting from the triangle containing 
                        
                           
                              
                                 A
                              
                           
                           
                              1
                           
                        
                      and ending with the triangle containing 
                        
                           
                              
                                 B
                              
                           
                           
                              1
                           
                        
                     , such that each consecutive pair of triangles in the path shares an edge. Therefore, there must exist a path in 
                        G
                      from 
                        
                           
                              
                                 A
                              
                           
                           
                              1
                           
                        
                      to 
                        
                           
                              
                                 B
                              
                           
                           
                              1
                           
                        
                     .

Assign to each edge of 
                        G
                      a cost equal to its Euclidean length. Dijkstra’s algorithm (see for example  [10, Section 2.2.2]) finds a path of minimal total cost between two vertices in 
                        G
                     , where the total cost of a path is the sum of the costs of all edges in that path. Thus, Dijkstra’s algorithm produces a path of minimal total length from 
                        
                           
                              
                                 A
                              
                           
                           
                              1
                           
                        
                      to 
                        
                           
                              
                                 B
                              
                           
                           
                              1
                           
                        
                      in 
                        G
                     . (Before applying Dijkstra’s algorithm, we can remove those edges from 
                        G
                      which are too close to the domain boundary and do not contain 
                        
                           
                              
                                 A
                              
                           
                           
                              1
                           
                        
                      or 
                        
                           
                              
                                 B
                              
                           
                           
                              1
                           
                        
                     . This improves the initial state for the next step of the algorithm, but may in rare circumstances prevent the existence of a path.)

The line segments from 
                        
                           A
                        
                      to 
                        
                           
                              
                                 A
                              
                           
                           
                              1
                           
                        
                      and from 
                        
                           
                              
                                 B
                              
                           
                           
                              1
                           
                        
                      to 
                        
                           B
                        
                      are added to form a path from 
                        
                           A
                        
                      to 
                        
                           B
                        
                     . If necessary, self-intersections of the resulting path are eliminated by cutting off the loops. The path is treated as a linear spline with evenly spaced knot points. The initial curve constructed in this way satisfies the condition (C1-3).

A splitting spline curve can be obtained as a sufficiently refined spline fitting of a splitting piecewise-linear curve produced by the approach discussed in Section  3. However, the two new domains split from the original domain 
                        Ω
                      by such a spline curve may not have good shapes. See, for example, Fig. 6
                     . This section will propose an optimization framework which helps to find a splitting spline curve such that the two corresponding split domains have relatively good shapes. The optimization is based on minimization of a penalty function that tends to infinity when the curve tends to violate Conditions (C2-3).

We note that using penalty functions is a fundamental method for numerically solving constrained optimization in general  [21], or for particular applications such as for solving discrete HJB equations  [22].

In order to represent the constructions of the penalty functions, we shall address each of the treatments of Conditions (C3) and (C2) separately, and formulate the optimization problem afterward.

Throughout the remainder of the paper, if there is a continuous function 
                        f
                        
                           (
                           u
                           ,
                           v
                           )
                        
                      that has a finite or infinite limit at some point 
                        
                           (
                           
                              
                                 u
                              
                              
                                 0
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 0
                              
                           
                           )
                        
                      when 
                        
                           (
                           u
                           ,
                           v
                           )
                        
                      tends to 
                        
                           (
                           
                              
                                 u
                              
                              
                                 0
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 0
                              
                           
                           )
                        
                     , we will write 
                        f
                        
                           (
                           
                              
                                 u
                              
                              
                                 0
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 0
                              
                           
                           )
                        
                      to mean the limit of the function at the point 
                        
                           (
                           
                              
                                 u
                              
                              
                                 0
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 0
                              
                           
                           )
                        
                     .

In order to treat Condition (C3), we consider the inverse of the squared distance between two points 
                           
                              c
                           
                           
                              (
                              u
                              )
                           
                         and 
                           
                              b
                           
                           
                              (
                              v
                              )
                           
                        : 
                           
                              (4)
                              
                                 
                                    
                                       I
                                    
                                    
                                       
                                          b
                                       
                                    
                                 
                                 
                                    (
                                    u
                                    ,
                                    v
                                    )
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       
                                          
                                             
                                                ‖
                                                
                                                   c
                                                
                                                
                                                   (
                                                   u
                                                   )
                                                
                                                −
                                                
                                                   b
                                                
                                                
                                                   (
                                                   v
                                                   )
                                                
                                                ‖
                                             
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                         where 
                           
                              ‖
                              ⋅
                              ‖
                           
                         denotes the Euclidean norm in 
                           
                              
                                 R
                              
                              
                                 2
                              
                           
                        . The function can be viewed as a penalty function as it penalizes the curve 
                           
                              c
                           
                           
                              (
                              u
                              )
                           
                         from intersecting the boundary curve 
                           
                              b
                           
                           
                              (
                              v
                              )
                           
                         from the point of view of minimization. This is the curve-to-boundary penalty function. However, because of Condition (C1), the function 
                           
                              
                                 I
                              
                              
                                 
                                    b
                                 
                              
                           
                           
                              (
                              u
                              ,
                              v
                              )
                           
                         is unbounded in any neighborhood of one of the two corner points 
                           
                              (
                              0
                              ,
                              0
                              )
                           
                         and 
                           
                              (
                              1
                              ,
                              1
                              )
                           
                         of the unit square. As a result, the function is not Riemann integrable over the unit square. Even in the sense of improper integrals, the integral of the function over the unit square does not converge either, see Lemma 1(ii). By the following theorem, it is possible to construct a multiplier function 
                           
                              
                                 r
                              
                              
                                 
                                    b
                                 
                              
                           
                           
                              (
                              u
                              ,
                              v
                              )
                           
                         so that the new function 
                           
                              
                                 r
                              
                              
                                 
                                    b
                                 
                              
                           
                           
                              (
                              u
                              ,
                              v
                              )
                           
                           
                           
                              
                                 I
                              
                              
                                 
                                    b
                                 
                              
                           
                           
                              (
                              u
                              ,
                              v
                              )
                           
                         is Riemann integrable over the unit square and it preserves penalizing properties of the original function. 
                           Theorem 1
                           
                              Consider the two spline curves 
                              
                                 
                                    c
                                 
                                 
                                    (
                                    u
                                    )
                                 
                                 ,
                                 
                                 0
                                 ≤
                                 u
                                 ≤
                                 1
                              
                              , and 
                              
                                 
                                    b
                                 
                                 
                                    (
                                    v
                                    )
                                 
                                 ,
                                 
                                 0
                                 ≤
                                 v
                                 ≤
                                 1
                               
                              defined in Section   2.2
                              , with 
                              
                                 c
                                 
                                    (
                                    0
                                    )
                                 
                                 =
                                 b
                                 
                                    (
                                    0
                                    )
                                 
                               
                              and 
                              
                                 c
                                 
                                    (
                                    1
                                    )
                                 
                                 =
                                 b
                                 
                                    (
                                    1
                                    )
                                 
                              
                              . Assume that
                              
                                 
                                    1.
                                    
                                       
                                          p
                                          ≥
                                          1
                                          ,
                                          
                                          q
                                          ≥
                                          1
                                       
                                       , recalling that 
                                       
                                          p
                                        
                                       and 
                                       
                                          q
                                        
                                       are spline degrees of 
                                       
                                          
                                             c
                                          
                                          
                                             (
                                             u
                                             )
                                          
                                        
                                       and 
                                       
                                          
                                             b
                                          
                                          
                                             (
                                             v
                                             )
                                          
                                        
                                       respectively;
                                    


                                       
                                          
                                             
                                                
                                                   c
                                                
                                             
                                             
                                                +
                                             
                                             
                                                ′
                                             
                                          
                                          
                                             (
                                             0
                                             )
                                          
                                          ≠
                                          0
                                        
                                       and 
                                       
                                          
                                             
                                                
                                                   c
                                                
                                             
                                             
                                                −
                                             
                                             
                                                ′
                                             
                                          
                                          
                                             (
                                             1
                                             )
                                          
                                          ≠
                                          0
                                       
                                       .
                                    


                                       
                                          
                                             
                                                
                                                   c
                                                
                                             
                                             
                                                +
                                             
                                             
                                                ′
                                             
                                          
                                          
                                             (
                                             0
                                             )
                                          
                                          ≠
                                          
                                             
                                                β
                                             
                                             
                                                0
                                             
                                          
                                          
                                             
                                                
                                                   b
                                                
                                             
                                             
                                                +
                                             
                                             
                                                ′
                                             
                                          
                                          
                                             (
                                             0
                                             )
                                          
                                        
                                       and 
                                       
                                          
                                             
                                                
                                                   c
                                                
                                             
                                             
                                                −
                                             
                                             
                                                ′
                                             
                                          
                                          
                                             (
                                             1
                                             )
                                          
                                          ≠
                                          
                                             
                                                β
                                             
                                             
                                                1
                                             
                                             
                                                ′
                                             
                                          
                                          
                                             
                                                
                                                   b
                                                
                                             
                                             
                                                −
                                             
                                             
                                                ′
                                             
                                          
                                          
                                             (
                                             1
                                             )
                                          
                                        
                                       for all 
                                       
                                          
                                             
                                                β
                                             
                                             
                                                0
                                             
                                          
                                          >
                                          0
                                        
                                       and 
                                       
                                          
                                             
                                                β
                                             
                                             
                                                1
                                             
                                          
                                          >
                                          0
                                       
                                       .
                                    


                                       if 
                                       
                                          
                                             c
                                          
                                          
                                             (
                                             u
                                             )
                                          
                                        
                                       intersects 
                                       
                                          
                                             b
                                          
                                          
                                             (
                                             v
                                             )
                                          
                                        
                                       only at 
                                       
                                          u
                                          =
                                          0
                                        
                                       and 
                                       
                                          u
                                          =
                                          1
                                       
                                       , then 
                                       
                                          
                                             
                                                
                                                   
                                                      I
                                                   
                                                   
                                                      ̂
                                                   
                                                
                                             
                                             
                                                
                                                   b
                                                
                                             
                                          
                                        
                                       is Riemann integrable over the unit square;
                                    


                                       
                                          
                                             
                                                
                                                   
                                                      I
                                                   
                                                   
                                                      ̂
                                                   
                                                
                                             
                                             
                                                
                                                   b
                                                
                                             
                                          
                                        
                                       equals 
                                       
                                          C
                                          
                                          
                                             
                                                I
                                             
                                             
                                                
                                                   b
                                                
                                             
                                          
                                       
                                       , for some 
                                       
                                          C
                                          >
                                          0
                                       
                                       , everywhere in 
                                       
                                          
                                             
                                                
                                                   [
                                                   0
                                                   ,
                                                   1
                                                   ]
                                                
                                             
                                             
                                                2
                                             
                                          
                                        
                                       except in 
                                       
                                          
                                             [
                                             
                                                
                                                   u
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   u
                                                
                                                
                                                   2
                                                
                                             
                                             ]
                                          
                                          ×
                                          
                                             [
                                             
                                                
                                                   v
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   v
                                                
                                                
                                                   2
                                                
                                             
                                             ]
                                          
                                          ∪
                                          
                                             [
                                             
                                                
                                                   u
                                                
                                                
                                                   n
                                                   −
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   u
                                                
                                                
                                                   n
                                                
                                             
                                             ]
                                          
                                          ×
                                          
                                             [
                                             
                                                
                                                   v
                                                
                                                
                                                   n
                                                   −
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   v
                                                
                                                
                                                   n
                                                
                                             
                                             ]
                                          
                                        
                                       (where 
                                       
                                          
                                             
                                                u
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                u
                                             
                                             
                                                n
                                             
                                          
                                        
                                       are the knots of 
                                       
                                          
                                             c
                                          
                                        
                                       and 
                                       
                                          
                                             
                                                v
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                v
                                             
                                             
                                                n
                                             
                                          
                                        
                                       are the knots of 
                                       
                                          
                                             b
                                          
                                        
                                       );
                                    


                                       if 
                                       
                                          
                                             c
                                          
                                          
                                             (
                                             u
                                             )
                                          
                                        
                                       intersects 
                                       
                                          
                                             b
                                          
                                          
                                             (
                                             v
                                             )
                                          
                                        
                                       at a third point 
                                       
                                          
                                             (
                                             
                                                
                                                   u
                                                
                                                
                                                   ∗
                                                
                                             
                                             ,
                                             
                                                
                                                   v
                                                
                                                
                                                   ∗
                                                
                                             
                                             )
                                          
                                       
                                       , i.e., 
                                       
                                          0
                                          <
                                          
                                             
                                                u
                                             
                                             
                                                ∗
                                             
                                          
                                          <
                                          1
                                       
                                       , then 
                                       
                                          
                                             
                                                ∬
                                             
                                             
                                                
                                                   
                                                      
                                                         [
                                                         0
                                                         ,
                                                         1
                                                         ]
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      I
                                                   
                                                   
                                                      ̂
                                                   
                                                
                                             
                                             
                                                
                                                   b
                                                
                                             
                                          
                                          
                                             (
                                             u
                                             ,
                                             v
                                             )
                                          
                                          
                                          
                                             d
                                          
                                          u
                                          
                                          
                                             d
                                          
                                          v
                                          =
                                          +
                                          ∞
                                       
                                       .
                                    

We present the proof for the theorem in Appendix A. The multiplier function has the following form 
                           
                              (6)
                              
                                 
                                    
                                       r
                                    
                                    
                                       
                                          b
                                       
                                    
                                 
                                 =
                                 
                                    
                                       w
                                    
                                    
                                       0
                                    
                                 
                                 
                                 
                                    
                                       α
                                    
                                    
                                       0
                                    
                                 
                                 
                                 
                                    
                                       f
                                    
                                    
                                       0
                                    
                                 
                                 +
                                 
                                    
                                       w
                                    
                                    
                                       τ
                                    
                                 
                                 
                                 
                                    
                                       α
                                    
                                    
                                       τ
                                    
                                 
                                 
                                 
                                    
                                       1
                                    
                                    
                                       
                                          
                                             
                                                [
                                                0
                                                ,
                                                1
                                                ]
                                             
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       w
                                    
                                    
                                       1
                                    
                                 
                                 
                                 
                                    
                                       α
                                    
                                    
                                       1
                                    
                                 
                                 
                                 
                                    
                                       f
                                    
                                    
                                       1
                                    
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 α
                              
                              
                                 0
                              
                           
                           ,
                           
                              
                                 α
                              
                              
                                 τ
                              
                           
                        , and 
                           
                              
                                 α
                              
                              
                                 1
                              
                           
                         are some positive constants; 
                           
                              
                                 w
                              
                              
                                 0
                              
                           
                           ,
                           
                              
                                 w
                              
                              
                                 τ
                              
                           
                        , and 
                           
                              
                                 w
                              
                              
                                 1
                              
                           
                         are piecewise rational functions given by (A.9) that only depend on the knot vectors 
                           U
                         and 
                           V
                        ; 
                           
                              
                                 f
                              
                              
                                 0
                              
                           
                         and 
                           
                              
                                 f
                              
                              
                                 1
                              
                           
                         are polynomials given by (A.5) that are quadratic functions of the coordinates of the control points of 
                           
                              c
                           
                           
                              (
                              u
                              )
                           
                        . The function 
                           
                              
                                 1
                              
                              
                                 
                                    
                                       
                                          [
                                          0
                                          ,
                                          1
                                          ]
                                       
                                    
                                    
                                       2
                                    
                                 
                              
                           
                         is the constant 1 function on the domain. The construction depends on the curves having at least one internal knot.

Similar to the treatment of Condition (C3) discussed above, we consider the following penalty function which is related to the inverse of the squared distance between two points 
                           
                              c
                           
                           
                              (
                              u
                              )
                           
                         and 
                           
                              c
                           
                           
                              (
                              v
                              )
                           
                         of the splitting curve: 
                           
                              (7)
                              
                                 J
                                 
                                    (
                                    u
                                    ,
                                    v
                                    )
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                (
                                                u
                                                −
                                                v
                                                )
                                             
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                ‖
                                                
                                                   c
                                                
                                                
                                                   (
                                                   u
                                                   )
                                                
                                                −
                                                
                                                   c
                                                
                                                
                                                   (
                                                   v
                                                   )
                                                
                                                ‖
                                             
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 .
                              
                           
                         We refer to this function as a curve-to-itself penalty function. It turns out that it is much easier to handle this function compared to the curve-to-boundary penalty function. This will be shown by the following theorem. 
                           Theorem 2
                           
                              Let 
                              
                                 
                                    c
                                 
                                 
                                    (
                                    u
                                    )
                                 
                                 ,
                                 
                                 0
                                 ≤
                                 u
                                 ≤
                                 1
                              
                              , be a spline curve of degree 
                              
                                 p
                                 ≥
                                 1
                               
                              and associated with a knot vector 
                              
                                 U
                               
                              given by   (2)
                              . Assume that 
                              
                                 
                                    c
                                 
                               
                              fulfils Condition  (C-2). Then we have the following conclusions.
                              
                                 
                                    (i)
                                    
                                       
                                          J
                                          
                                             (
                                             u
                                             ,
                                             v
                                             )
                                          
                                        
                                       is continuous over 
                                       
                                          
                                             
                                                
                                                   [
                                                   0
                                                   ,
                                                   1
                                                   ]
                                                
                                             
                                             
                                                2
                                             
                                          
                                        
                                       if and only if 
                                       
                                          
                                             c
                                          
                                        
                                       is differentiable over 
                                       
                                          
                                             [
                                             0
                                             ,
                                             1
                                             ]
                                          
                                       
                                       .
                                    


                                       
                                          J
                                          
                                             (
                                             u
                                             ,
                                             v
                                             )
                                          
                                        
                                       is Riemann integrable over 
                                       
                                          
                                             
                                                
                                                   [
                                                   0
                                                   ,
                                                   1
                                                   ]
                                                
                                             
                                             
                                                2
                                             
                                          
                                        
                                       (even if 
                                       
                                          
                                             c
                                          
                                        
                                       is not differentiable).
                                    


                                       If 
                                       
                                          
                                             c
                                          
                                        
                                       violates Condition  (C-2)/(i)  or  (C-2)/(ii), and all zeros of 
                                       
                                          
                                             
                                                
                                                   c
                                                
                                             
                                             
                                                ′
                                             
                                          
                                        
                                       are isolated, then
                                    


                                       
                                          
                                             
                                                ∬
                                             
                                             
                                                
                                                   
                                                      
                                                         [
                                                         0
                                                         ,
                                                         1
                                                         ]
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          J
                                          
                                             (
                                             u
                                             ,
                                             v
                                             )
                                          
                                          
                                          
                                             d
                                          
                                          u
                                          
                                             d
                                          
                                          v
                                          =
                                          +
                                          ∞
                                       
                                       .
                                    

The proof is provided in Appendix B.

The uses of the penalty functions can be summarized in the following optimization formulation. 
                           
                              
                                 (8a)
                                 
                                    
                                       
                                          
                                             minimize
                                          
                                       
                                       
                                          
                                             
                                                
                                                   c
                                                
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                
                                                   c
                                                
                                             
                                             
                                                m
                                             
                                          
                                       
                                    
                                    
                                    
                                       
                                          
                                             
                                                ω
                                             
                                             
                                                e
                                             
                                          
                                       
                                       
                                          
                                             
                                                ω
                                             
                                             
                                                e
                                                0
                                             
                                          
                                       
                                    
                                    
                                    
                                       
                                          ∫
                                       
                                       
                                          0
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          
                                             ‖
                                             
                                                
                                                   
                                                      r
                                                   
                                                
                                                
                                                   ″
                                                
                                             
                                             
                                                (
                                                u
                                                )
                                             
                                             ‖
                                          
                                       
                                       
                                          2
                                       
                                    
                                    
                                    
                                       d
                                    
                                    u
                                    +
                                    
                                       
                                          ∬
                                       
                                       
                                          
                                             
                                                
                                                   [
                                                   0
                                                   ,
                                                   1
                                                   ]
                                                
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    
                                       (
                                       
                                          
                                             ω
                                          
                                          
                                             b
                                          
                                       
                                       
                                       
                                          
                                             
                                                
                                                   I
                                                
                                                
                                                   ̂
                                                
                                             
                                          
                                          
                                             
                                                b
                                             
                                          
                                       
                                       
                                          (
                                          u
                                          ,
                                          v
                                          )
                                       
                                       +
                                       
                                          
                                             ω
                                          
                                          
                                             b
                                          
                                       
                                       
                                       
                                          
                                             
                                                
                                                   I
                                                
                                                
                                                   ̂
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      b
                                                   
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                       
                                       
                                          (
                                          u
                                          ,
                                          v
                                          )
                                       
                                       +
                                       
                                          
                                             ω
                                          
                                          
                                             c
                                          
                                       
                                       
                                       J
                                       
                                          (
                                          u
                                          ,
                                          v
                                          )
                                       
                                       )
                                    
                                    
                                    
                                       d
                                    
                                    u
                                    
                                    
                                       d
                                    
                                    v
                                 
                              
                              
                                 (8b)
                                 
                                    such that  
                                    
                                       c
                                    
                                    
                                       (
                                       0
                                       )
                                    
                                    =
                                    
                                       A
                                    
                                    ,
                                    
                                    
                                       c
                                    
                                    
                                       (
                                       1
                                       )
                                    
                                    =
                                    
                                       B
                                    
                                 
                              
                              
                                 (8c)
                                 
                                    det
                                    
                                       [
                                       
                                          
                                             
                                                c
                                             
                                          
                                          
                                             ′
                                          
                                       
                                       
                                          (
                                          0
                                          )
                                       
                                       ,
                                       
                                          α
                                       
                                       ]
                                    
                                    =
                                    0
                                    ,
                                    
                                    det
                                    
                                       [
                                       
                                          
                                             
                                                c
                                             
                                          
                                          
                                             ′
                                          
                                       
                                       
                                          (
                                          1
                                          )
                                       
                                       ,
                                       
                                          β
                                       
                                       ]
                                    
                                    =
                                    0
                                 
                              
                              
                                 (8d)
                                 
                                    
                                       {
                                       
                                          c
                                       
                                       
                                          (
                                          u
                                          )
                                       
                                       ,
                                       
                                       0
                                       <
                                       u
                                       <
                                       1
                                       }
                                    
                                    ⊂
                                    
                                       int
                                    
                                    
                                       (
                                       Ω
                                       )
                                    
                                    .
                                 
                              
                           
                         The first term in (8a) is related to one of the standard regularity conditions for a curve. The curve 
                           
                              r
                           
                           
                              (
                              u
                              )
                           
                         is chosen as follows: if 
                           p
                           >
                           1
                           ,
                           
                              r
                           
                           
                              (
                              u
                              )
                           
                           ≡
                           
                              c
                           
                           
                              (
                              u
                              )
                           
                        ; if 
                           p
                           =
                           1
                           ,
                           
                              r
                           
                           
                              (
                              u
                              )
                           
                         is a quadratic spline curve with a uniform and open knot vector where its control points are inherited from those of 
                           
                              c
                           
                           
                              (
                              u
                              )
                           
                        . The indirect imposition of regularization on 
                           
                              c
                           
                         when 
                           p
                           =
                           1
                         is related to the two-stage optimization introduced in Section  2.3. This is to make Stage 1 capable of providing a better initial solution to Stage 2.

In Eqs. (8), 
                           
                              
                                 ω
                              
                              
                                 e
                              
                           
                         is the weighting parameter associated with the regularity term. We use 
                           
                              
                                 ω
                              
                              
                                 e
                                 0
                              
                           
                           >
                           0
                         as a reference value for 
                           
                              
                                 ω
                              
                              
                                 e
                              
                           
                        . In this work, we define 
                           
                              
                                 ω
                              
                              
                                 e
                                 0
                              
                           
                         as 
                           max
                           
                              (
                              ε
                              ,
                              
                                 
                                    ∫
                                 
                                 
                                    0
                                 
                                 
                                    1
                                 
                              
                              
                                 
                                    
                                       ‖
                                       
                                          
                                             
                                                r
                                             
                                          
                                          
                                             0
                                          
                                          
                                             ″
                                          
                                       
                                       
                                          (
                                          u
                                          )
                                       
                                       ‖
                                    
                                 
                                 
                                    2
                                 
                              
                              )
                           
                         where 
                           ε
                           =
                           1
                           
                              
                                 0
                              
                              
                                 −
                                 6
                              
                           
                        , and 
                           
                              
                                 
                                    r
                                 
                              
                              
                                 0
                              
                           
                         is the initial value of 
                           
                              r
                           
                         in the optimization. The coefficient 
                           
                              
                                 ω
                              
                              
                                 b
                              
                           
                         is the weighting for the penalty function of the curve to the boundary, and 
                           
                              
                                 ω
                              
                              
                                 c
                              
                           
                         is the weighting for the penalty function of the curve to itself. The linear constraints (8b) and (8c) are to make sure the resulting curve satisfies Condition (C1).

We note that if the domain boundary consists of more than two spline curves, the extension is straightforward (as long as the domain is still simply connected), as several spline curves can be converted into a single spline curve. However, in order to lessen the effect of the discrepancy between the speed of different parametrized boundary curves, we use a weighted average where we weight the integral with respect to each boundary curve according to its length. More sophisticated approaches can be employed, such as reparameterizing the combined single curve into a unit-speed curve, however we observe that the averaging according to curve lengths can produce sufficiently satisfactory results in practice.

Numerical approaches for solving the optimization problem (8) shall be addressed in Section  5.1. Our approach to computing the penalty functions depends on methods presented in Appendix C.

We apply standard nonlinear optimization methods to compute a B-spline curve of degree 2 or more solving Eq. (8). It is necessary to find a feasible solution to use as an initial point. Our approach is to choose as an initial control polygon a solution of Eq. (8) among a space of linear B-splines.

Our approach to solving Eq. (8) can be summarized as follows: 
                           
                              •
                              Use a pathfinding algorithm to choose a knot vector and initial curve for the first optimization stage (Section  3).

First optimization stage: solve Eq. (8) in the space of linear splines with the given knot vector.

Second optimization stage: solve Eq. (8) in the space of splines with desired degree and the given knot vector. To choose the initial spline, we treat the solution of the previous optimization stage as a control polygon. To ensure that the initial spline satisfies the conditions, we detect polynomial pieces of the spline where the conditions fail, and refine those pieces by adding control points along the corresponding segments of the control polygon.

The requirement that the initial curve for the first stage is a splitting curve ensures the stability of the optimization. Since this initial curve has uniformly spaced knots, the result for 
                           p
                           =
                           1
                         should be a control polygon with edges of approximately equal length. This enables the spline approximation with 
                           p
                           =
                           2
                         in the second stage to have speed that is not far from uniform.

In order to solve the optimization problem (8), we have used the following numerical optimization approaches. 
                           
                              •
                              
                                 Gradient descent. We use a backtracking inexact line-search (see  [21, Chapter 3]) where, in addition to the Armijo condition, we check if a point is visible. This approach works stably but is rather slow.


                                 Broyden–Fletcher–Goldfarb–Shanno (BFGS)-based quasi-Newton method. (See  [21, Chapter 8].) This method often has faster convergence. Again, apart from checking if a point satisfies the Wolfe condition, we have to check the feasibility of the point.

For the examples below, we use Gauss quadrature to compute the penalty functions. In each dimension we use 10 Gaussian points distributed along each knot interval. In this way we obtain high accuracy so that the quadrature error does not influence the resulting curves. We have not studied whether it suffices to use less Gaussian points. The values of the B-spline basis functions at the Gaussian points are precomputed to reduce the computation time.

In order to make the optimization problem (8) invariant to scaling, the following coefficients have to be defined: (i) the coefficient for the curve-to-boundary penalty function, (ii) the coefficient for the curve-to-itself penalty function, and (iii) the reference energy for the regularity term. Thanks to the way the penalty functions are defined, varying the coefficients has a predictable effect on every shape. This is demonstrated in Figs. 7 and 8
                        
                         where we show that varying the coefficient for the curve-to-boundary penalty affects the distance of the curve to the boundary in a similar way in 4 different examples. We also find out that the weighting parameters (30, 0.1, 1) can produce good results.

In Fig. 9
                        , we show other examples of the maze-shaped domains. This, in turn, shows the robustness of our approach.

In order to demonstrate the current work’s connection to the segmentation problem, we show in Fig. 10
                         a decomposition of a mechanical part into topological hexahedra. The mechanical part and the cutting loops used for the segmentations are intentionally made complicated so that the example can best show the connection and the robustness of our approach.

The results of this paper form an important step in the segmentation of a boundary represented solid into topological hexahedra. The segmentation procedure described in  [2,3] requires the construction of auxiliary edges which are used as part of a cutting loop to segment a solid into two pieces. Geometric conditions on the valid cutting loops can dictate boundary conditions for the new auxiliary edges. This paper provides a construction of edges which can split a face into two pieces while satisfying these boundary conditions. The method has been demonstrated to work even on quite complicated domains. In Fig. 2 we show how our method can help to avoid badly shaped topological hexahedra in a segmentation by comparing the result of our method against an older approach we used.

Our method focuses on splitting the (2D) domain of a (3D) trimmed surface. Since a trimmed surface is defined by its domain and an embedding, a splitting of the 2D domain implies a splitting of the 3D surface. As a result, no more constraints are required to ensure that the generated curve lies within the surface. However, for highly distorted surfaces, the distortion could be taken into account in the penalty function to improve the resulting curves. We have not considered this yet.

Once a cutting loop has been chosen and its auxiliary edges have been constructed, the next step is the construction of a cutting surface having the given loop as its boundary. This problem can be seen as a higher dimensional version of the problem studied in this paper, and, besides being more computationally expensive, comes with additional difficulties including the choice of an appropriate trimmed domain for the surface. The cutting surface problem is the topic of ongoing work.

@&#ACKNOWLEDGMENTS@&#

This research was supported by the EC through the FP7 projects INSIST (GA 289361) and EXAMPLE (GA no. 324240).


                     Lemma 1 aids the proof of Theorems 1 and 2. 
                        Lemma 1
                        
                           Let 
                           
                              
                                 c
                              
                              
                                 (
                                 u
                                 )
                              
                              ,
                              
                                 b
                              
                              
                                 (
                                 v
                                 )
                              
                              :
                              
                                 [
                                 0
                                 ,
                                 ϵ
                                 ]
                              
                              →
                              
                                 
                                    R
                                 
                                 
                                    n
                                 
                              
                            
                           be spline curves of degree  1  or higher. Assume 
                           
                              
                                 c
                              
                              
                                 (
                                 0
                                 )
                              
                              =
                              
                                 b
                              
                              
                                 (
                                 0
                                 )
                              
                            
                           and 
                           
                              
                                 
                                    
                                       c
                                    
                                 
                                 
                                    +
                                 
                                 
                                    ′
                                 
                              
                              
                                 (
                                 0
                                 )
                              
                              ≠
                              0
                              ≠
                              
                                 
                                    
                                       b
                                    
                                 
                                 
                                    +
                                 
                                 
                                    ′
                                 
                              
                              
                                 (
                                 0
                                 )
                              
                           
                           . Then:
                           
                              
                                 (i)
                                 
                                    if 
                                    
                                       
                                          
                                             
                                                c
                                             
                                          
                                          
                                             +
                                          
                                          
                                             ′
                                          
                                       
                                       
                                          (
                                          0
                                          )
                                       
                                       ≠
                                       β
                                       
                                          
                                             
                                                b
                                             
                                          
                                          
                                             +
                                          
                                          
                                             ′
                                          
                                       
                                       
                                          (
                                          0
                                          )
                                       
                                     
                                    for any 
                                    
                                       β
                                       >
                                       0
                                    
                                    then
                                    
                                       
                                          (A.1)
                                          
                                             
                                                
                                                   u
                                                   +
                                                   v
                                                
                                                
                                                   
                                                      ‖
                                                      
                                                         
                                                            
                                                               c
                                                            
                                                         
                                                         
                                                            +
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                      
                                                         (
                                                         0
                                                         )
                                                      
                                                      u
                                                      −
                                                      
                                                         
                                                            
                                                               b
                                                            
                                                         
                                                         
                                                            +
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                      
                                                         (
                                                         0
                                                         )
                                                      
                                                      v
                                                      ‖
                                                   
                                                
                                             
                                          
                                       
                                    
                                    is bounded for 
                                    
                                       u
                                       ,
                                       v
                                       ≥
                                       0
                                     
                                    with 
                                    
                                       
                                          (
                                          u
                                          ,
                                          v
                                          )
                                       
                                       ≠
                                       
                                          (
                                          0
                                          ,
                                          0
                                          )
                                       
                                    
                                    , and
                                    
                                       
                                          (A.2)
                                          
                                             
                                                
                                                   lim
                                                
                                                
                                                   
                                                      (
                                                      u
                                                      ,
                                                      v
                                                      )
                                                   
                                                   →
                                                   
                                                      (
                                                      
                                                         
                                                            0
                                                         
                                                         
                                                            +
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            0
                                                         
                                                         
                                                            +
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ‖
                                                      
                                                         c
                                                      
                                                      
                                                         (
                                                         u
                                                         )
                                                      
                                                      −
                                                      
                                                         b
                                                      
                                                      
                                                         (
                                                         v
                                                         )
                                                      
                                                      ‖
                                                   
                                                
                                                
                                                   
                                                      ‖
                                                      
                                                         
                                                            
                                                               c
                                                            
                                                         
                                                         
                                                            +
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                      
                                                         (
                                                         0
                                                         )
                                                      
                                                      u
                                                      −
                                                      
                                                         
                                                            
                                                               b
                                                            
                                                         
                                                         
                                                            +
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                      
                                                         (
                                                         0
                                                         )
                                                      
                                                      v
                                                      ‖
                                                   
                                                
                                             
                                             =
                                             1
                                             ;
                                          
                                       
                                    
                                 


                                    
                                       
                                          (A.3)
                                          
                                             
                                                
                                                   ∬
                                                
                                                
                                                   
                                                      
                                                         
                                                            [
                                                            0
                                                            ,
                                                            ϵ
                                                            ]
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   1
                                                
                                                
                                                   
                                                      
                                                         
                                                            ‖
                                                            
                                                               c
                                                            
                                                            
                                                               (
                                                               u
                                                               )
                                                            
                                                            −
                                                            
                                                               b
                                                            
                                                            
                                                               (
                                                               v
                                                               )
                                                            
                                                            ‖
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             
                                                d
                                             
                                             u
                                             
                                             
                                                d
                                             
                                             v
                                          
                                       
                                    
                                    is divergent in the sense of improper integrals.
                                 


                     
                        Proof
                        Since 
                              
                                 c
                              
                              
                                 (
                                 u
                                 )
                              
                              ,
                              
                                 b
                              
                              
                                 (
                                 v
                                 )
                              
                            are splines of degree at least 1, 
                              
                                 (A.4)
                                 
                                    
                                       
                                          c
                                       
                                       
                                          (
                                          u
                                          )
                                       
                                       =
                                       
                                          c
                                       
                                       
                                          (
                                          0
                                          )
                                       
                                       +
                                       
                                          
                                             
                                                c
                                             
                                          
                                          
                                             +
                                          
                                          
                                             ′
                                          
                                       
                                       
                                          (
                                          0
                                          )
                                       
                                       u
                                       +
                                       o
                                       
                                          (
                                          u
                                          )
                                       
                                       
                                       as  
                                       u
                                       →
                                       
                                          
                                             0
                                          
                                          
                                             +
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          b
                                       
                                       
                                          (
                                          v
                                          )
                                       
                                       =
                                       
                                          b
                                       
                                       
                                          (
                                          0
                                          )
                                       
                                       +
                                       
                                          
                                             
                                                b
                                             
                                          
                                          
                                             +
                                          
                                          
                                             ′
                                          
                                       
                                       
                                          (
                                          0
                                          )
                                       
                                       v
                                       +
                                       o
                                       
                                          (
                                          v
                                          )
                                       
                                       
                                       as  
                                       v
                                       →
                                       
                                          
                                             0
                                          
                                          
                                             +
                                          
                                       
                                       .
                                    
                                 
                              
                            (i) For 
                              u
                              ,
                              v
                              ≥
                              0
                            and 
                              
                                 (
                                 u
                                 ,
                                 v
                                 )
                              
                              ≠
                              
                                 (
                                 0
                                 ,
                                 0
                                 )
                              
                           , we have 
                              
                                 ‖
                                 
                                    
                                       
                                          c
                                       
                                    
                                    
                                       +
                                    
                                    
                                       ′
                                    
                                 
                                 
                                    (
                                    0
                                    )
                                 
                                 u
                                 −
                                 
                                    
                                       
                                          b
                                       
                                    
                                    
                                       +
                                    
                                    
                                       ′
                                    
                                 
                                 
                                    (
                                    0
                                    )
                                 
                                 v
                                 ‖
                              
                              ≥
                              G
                              
                                 (
                                 u
                                 +
                                 v
                                 )
                              
                           , where 
                              G
                              =
                              
                                 
                                    min
                                 
                                 
                                    u
                                    ≥
                                    0
                                    ,
                                    v
                                    ≥
                                    0
                                    ,
                                    u
                                    +
                                    v
                                    =
                                    1
                                 
                              
                              
                                 ‖
                                 
                                    
                                       
                                          c
                                       
                                    
                                    
                                       +
                                    
                                    
                                       ′
                                    
                                 
                                 
                                    (
                                    0
                                    )
                                 
                                 u
                                 −
                                 
                                    
                                       
                                          b
                                       
                                    
                                    
                                       +
                                    
                                    
                                       ′
                                    
                                 
                                 
                                    (
                                    0
                                    )
                                 
                                 v
                                 ‖
                              
                           , which exists by compactness of the set 
                              
                                 {
                                 
                                    (
                                    u
                                    ,
                                    v
                                    )
                                 
                                 ,
                                 u
                                 ≥
                                 0
                                 ,
                                 v
                                 ≥
                                 0
                                 ,
                                 u
                                 +
                                 v
                                 =
                                 1
                                 }
                              
                            and is positive by the assumption of part (i) of the lemma. Therefore (A.1) is bounded. So by Eq. (A.4) and the triangle inequality, as 
                              
                                 (
                                 u
                                 ,
                                 v
                                 )
                              
                              →
                              
                                 (
                                 
                                    
                                       0
                                    
                                    
                                       +
                                    
                                 
                                 ,
                                 
                                    
                                       0
                                    
                                    
                                       +
                                    
                                 
                                 )
                              
                           , 
                              
                                 
                                    
                                       
                                          
                                             ‖
                                             
                                                c
                                             
                                             
                                                (
                                                u
                                                )
                                             
                                             −
                                             
                                                b
                                             
                                             
                                                (
                                                v
                                                )
                                             
                                             ‖
                                          
                                       
                                       
                                          
                                             ‖
                                             
                                                
                                                   
                                                      c
                                                   
                                                
                                                
                                                   +
                                                
                                                
                                                   ′
                                                
                                             
                                             
                                                (
                                                0
                                                )
                                             
                                             u
                                             −
                                             
                                                
                                                   
                                                      b
                                                   
                                                
                                                
                                                   +
                                                
                                                
                                                   ′
                                                
                                             
                                             
                                                (
                                                0
                                                )
                                             
                                             v
                                             ‖
                                          
                                       
                                    
                                    =
                                    1
                                    +
                                    
                                       
                                          o
                                          
                                             (
                                             u
                                             )
                                          
                                          +
                                          o
                                          
                                             (
                                             v
                                             )
                                          
                                       
                                       
                                          G
                                          
                                             (
                                             u
                                             +
                                             v
                                             )
                                          
                                       
                                    
                                    =
                                    1
                                    +
                                    o
                                    
                                       (
                                       1
                                       )
                                    
                                 
                              
                            and Eq. (A.2) follows.

(ii) By Eq. (A.4) there are 
                              M
                              >
                              0
                            and 
                              
                                 
                                    ϵ
                                 
                                 
                                    1
                                 
                              
                            with 
                              0
                              <
                              
                                 
                                    ϵ
                                 
                                 
                                    1
                                 
                              
                              <
                              ϵ
                            such that 
                              
                                 
                                    
                                       ‖
                                       
                                          c
                                       
                                       
                                          (
                                          u
                                          )
                                       
                                       −
                                       
                                          b
                                       
                                       
                                          (
                                          v
                                          )
                                       
                                       ‖
                                    
                                 
                                 
                                    2
                                 
                              
                              <
                              M
                              
                                 (
                                 
                                    
                                       u
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       v
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                            for all 
                              0
                              <
                              u
                              ,
                              v
                              <
                              
                                 
                                    ϵ
                                 
                                 
                                    1
                                 
                              
                           . Thus 
                              
                                 
                                    ∬
                                 
                                 
                                    
                                       
                                          
                                             [
                                             0
                                             ,
                                             ϵ
                                             ]
                                          
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              
                                 
                                    1
                                 
                                 
                                    
                                       
                                          
                                             ‖
                                             
                                                c
                                             
                                             
                                                (
                                                u
                                                )
                                             
                                             −
                                             
                                                b
                                             
                                             
                                                (
                                                v
                                                )
                                             
                                             ‖
                                          
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              
                                 d
                              
                              u
                              
                                 d
                              
                              v
                            diverges.□

By transforming the domain, Lemma 1 can be applied to two splines 
                        
                           c
                        
                        ,
                        
                           b
                        
                      such that 
                        
                           c
                        
                        
                           (
                           
                              
                                 u
                              
                              
                                 ̄
                              
                           
                           )
                        
                        =
                        
                           b
                        
                        
                           (
                           
                              
                                 v
                              
                              
                                 ̄
                              
                           
                           )
                        
                      for arbitrary 
                        
                           
                              u
                           
                           
                              ̄
                           
                        
                        ,
                        
                           
                              v
                           
                           
                              ̄
                           
                        
                      in their domains and even to any of the four quadrants around 
                        
                           (
                           
                              
                                 u
                              
                              
                                 ̄
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 ̄
                              
                           
                           )
                        
                     , to see the behavior of the function in any of the four limits 
                        
                           (
                           
                              
                                 
                                    
                                       u
                                    
                                    
                                       ̄
                                    
                                 
                              
                              
                                 ±
                              
                           
                           ,
                           
                              
                                 
                                    
                                       v
                                    
                                    
                                       ̄
                                    
                                 
                              
                              
                                 ±
                              
                           
                           )
                        
                     . In two cases, the sign of 
                        β
                      in the condition of Lemma 1(i) must be reversed.

As a consequence of Lemma 1, the following two functions can be used to eliminate the two singular points 
                        
                           (
                           0
                           ,
                           0
                           )
                        
                      and 
                        
                           (
                           1
                           ,
                           1
                           )
                        
                      for the curve-to-boundary function: 
                        
                           
                              
                                 
                                    
                                       f
                                    
                                    
                                       0
                                    
                                 
                                 
                                    (
                                    u
                                    ,
                                    v
                                    )
                                 
                                 =
                                 
                                    
                                       
                                          ‖
                                          
                                             
                                                
                                                   c
                                                
                                             
                                             
                                                +
                                             
                                             
                                                ′
                                             
                                          
                                          
                                             (
                                             0
                                             )
                                          
                                          u
                                          −
                                          
                                             
                                                
                                                   b
                                                
                                             
                                             
                                                +
                                             
                                             
                                                ′
                                             
                                          
                                          
                                             (
                                             0
                                             )
                                          
                                          v
                                          ‖
                                       
                                    
                                    
                                       2
                                    
                                 
                              
                           
                           
                              (A.5)
                              
                                 
                                    
                                       f
                                    
                                    
                                       1
                                    
                                 
                                 
                                    (
                                    u
                                    ,
                                    v
                                    )
                                 
                                 =
                                 
                                    
                                       
                                          ‖
                                          
                                             
                                                
                                                   c
                                                
                                             
                                             
                                                −
                                             
                                             
                                                ′
                                             
                                          
                                          
                                             (
                                             1
                                             )
                                          
                                          
                                             (
                                             u
                                             −
                                             1
                                             )
                                          
                                          −
                                          
                                             
                                                
                                                   b
                                                
                                             
                                             
                                                −
                                             
                                             
                                                ′
                                             
                                          
                                          
                                             (
                                             1
                                             )
                                          
                                          
                                             (
                                             v
                                             −
                                             1
                                             )
                                          
                                          ‖
                                       
                                    
                                    
                                       2
                                    
                                 
                                 .
                              
                           
                        
                     
                  

In order to obtain a multiplier function 
                        
                           
                              r
                           
                           
                              
                                 b
                              
                           
                        
                        
                           (
                           u
                           ,
                           v
                           )
                        
                      as mentioned in Section  4.1, we will define weighting functions 
                        
                           
                              w
                           
                           
                              0
                           
                        
                        ,
                        
                           
                              w
                           
                           
                              τ
                           
                        
                     , and 
                        
                           
                              w
                           
                           
                              1
                           
                        
                      associated with the three functions: 
                        
                           
                              f
                           
                           
                              0
                           
                        
                     , the indicator function 
                        
                           
                              1
                           
                           
                              
                                 
                                    
                                       [
                                       0
                                       ,
                                       1
                                       ]
                                    
                                 
                                 
                                    2
                                 
                              
                           
                        
                     , and 
                        
                           
                              f
                           
                           
                              1
                           
                        
                      so that 
                        
                           (W1)
                           
                              
                                 
                                    
                                       w
                                    
                                    
                                       0
                                    
                                 
                                 
                                 
                                    
                                       f
                                    
                                    
                                       0
                                    
                                 
                               and 
                                 
                                    
                                       w
                                    
                                    
                                       1
                                    
                                 
                                 
                                 
                                    
                                       f
                                    
                                    
                                       1
                                    
                                 
                               are supported over a neighborhood of the corner points (0, 0) and (1, 1) respectively;


                              
                                 
                                    
                                       w
                                    
                                    
                                       0
                                       ,
                                       1
                                    
                                 
                               isolates the two corner points (0, 0) and (1, 1) from the support of 
                                 
                                    
                                       1
                                    
                                    
                                       
                                          
                                             
                                                [
                                                0
                                                ,
                                                1
                                                ]
                                             
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                              ;

the three weighting functions form a set of coefficients of a convex interpolation, i.e., they are non-negative and form a partition of unity.

The grid lines corresponding to the knots 
                        
                           
                              u
                           
                           
                              i
                           
                        
                      of the knot vector 
                        
                           
                              U
                           
                           
                              p
                           
                        
                      and the the knots 
                        
                           
                              v
                           
                           
                              j
                           
                        
                      of the knot vector 
                        
                           
                              V
                           
                           
                              q
                           
                        
                      partition the unit square into rectangular boxes 
                        
                           [
                           
                              
                                 u
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 u
                              
                              
                                 i
                                 +
                                 1
                              
                           
                           ]
                        
                        ×
                        
                           [
                           
                              
                                 v
                              
                              
                                 j
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 j
                                 +
                                 1
                              
                           
                           ]
                        
                        ,
                        i
                        =
                        1
                        ,
                        …
                        ,
                        m
                        −
                        1
                        ,
                        j
                        =
                        1
                        ,
                        …
                        ,
                        n
                        −
                        1
                     . Let 
                        
                           
                              D
                           
                           
                              0
                           
                        
                        =
                        
                           [
                           
                              
                                 u
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 u
                              
                              
                                 2
                              
                           
                           ]
                        
                        ×
                        
                           [
                           
                              
                                 v
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 2
                              
                           
                           ]
                        
                      and 
                        
                           
                              D
                           
                           
                              1
                           
                        
                        =
                        
                           [
                           
                              
                                 u
                              
                              
                                 m
                                 −
                                 1
                              
                           
                           ,
                           
                              
                                 u
                              
                              
                                 m
                              
                           
                           ]
                        
                        ×
                        
                           [
                           
                              
                                 v
                              
                              
                                 n
                                 −
                                 1
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 n
                              
                           
                           ]
                        
                      be the boxes that contain the two corner points 
                        
                           (
                           0
                           ,
                           0
                           )
                        
                      and 
                        
                           (
                           1
                           ,
                           1
                           )
                        
                      respectively as illustrated in Fig. A.11
                     (a).

First, we define the following auxiliary functions: 
                        
                           
                              (A.6)
                              
                                 
                                    
                                       
                                          
                                             w
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                    
                                       0
                                    
                                 
                                 
                                    (
                                    u
                                    ,
                                    v
                                    )
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       
                                          
                                             D
                                          
                                          
                                             0
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          (
                                          
                                             
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      2
                                                   
                                                
                                                −
                                                u
                                             
                                             
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      2
                                                   
                                                
                                                −
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                          )
                                       
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             0
                                          
                                       
                                    
                                 
                                 
                                 
                                    
                                       
                                          (
                                          
                                             
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      2
                                                   
                                                
                                                −
                                                v
                                             
                                             
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      2
                                                   
                                                
                                                −
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                          )
                                       
                                    
                                    
                                       
                                          
                                             q
                                          
                                          
                                             0
                                          
                                       
                                    
                                 
                              
                           
                           
                              (A.7)
                              
                                 
                                    
                                       
                                          
                                             w
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 
                                    (
                                    u
                                    ,
                                    v
                                    )
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       
                                          
                                             D
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          (
                                          
                                             
                                                u
                                                −
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      m
                                                      −
                                                      1
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      m
                                                   
                                                
                                                −
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      m
                                                      −
                                                      1
                                                   
                                                
                                             
                                          
                                          )
                                       
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 
                                 
                                    
                                       
                                          (
                                          
                                             
                                                v
                                                −
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      n
                                                      −
                                                      1
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      n
                                                   
                                                
                                                −
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      n
                                                      −
                                                      1
                                                   
                                                
                                             
                                          
                                          )
                                       
                                    
                                    
                                       
                                          
                                             q
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                              
                           
                        
                      where 
                        
                           
                              p
                           
                           
                              0
                           
                        
                        ,
                        
                           
                              q
                           
                           
                              0
                           
                        
                        ,
                        
                           
                              p
                           
                           
                              1
                           
                        
                     , and 
                        
                           
                              q
                           
                           
                              1
                           
                        
                      are positive integers. Note that 
                        
                           
                              w
                           
                           
                              0
                              ,
                              0
                           
                        
                      is the bivariate Bernstein polynomial of degrees 
                        
                           (
                           
                              
                                 p
                              
                              
                                 0
                              
                           
                           ,
                           
                              
                                 q
                              
                              
                                 0
                              
                           
                           )
                        
                      over 
                        
                           
                              D
                           
                           
                              0
                           
                        
                      which does not vanish at the lower left corner of 
                        
                           
                              D
                           
                           
                              0
                           
                        
                     . Similarly, 
                        
                           
                              w
                           
                           
                              1
                           
                        
                      is the bivariate Bernstein polynomial of degrees 
                        
                           (
                           
                              
                                 p
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 q
                              
                              
                                 1
                              
                           
                           )
                        
                      over 
                        
                           
                              D
                           
                           
                              1
                           
                        
                      which does not vanish at the upper right corner of 
                        
                           
                              D
                           
                           
                              1
                           
                        
                     . See Fig. A.11(c)(e).

In order to construct the weighting function 
                        
                           
                              w
                           
                           
                              τ
                           
                        
                     , subdivide 
                        
                           
                              D
                           
                           
                              0
                           
                        
                      into four new boxes by inserting line segments 
                        
                           {
                           
                              (
                              
                                 
                                    
                                       
                                          u
                                       
                                       
                                          ˜
                                       
                                    
                                 
                                 
                                    0
                                 
                              
                              ,
                              v
                              )
                           
                           ∣
                           
                              
                                 v
                              
                              
                                 1
                              
                           
                           ≤
                           v
                           ≤
                           
                              
                                 v
                              
                              
                                 2
                              
                           
                           }
                        
                      and 
                        
                           {
                           
                              (
                              u
                              ,
                              
                                 
                                    
                                       
                                          v
                                       
                                       
                                          ˜
                                       
                                    
                                 
                                 
                                    0
                                 
                              
                              )
                           
                           ∣
                           
                              
                                 u
                              
                              
                                 1
                              
                           
                           ≤
                           u
                           ≤
                           
                              
                                 u
                              
                              
                                 2
                              
                           
                           }
                        
                     ; and subdivide 
                        
                           
                              D
                           
                           
                              1
                           
                        
                      by inserting line segments 
                        
                           {
                           
                              (
                              
                                 
                                    
                                       
                                          u
                                       
                                       
                                          ˜
                                       
                                    
                                 
                                 
                                    1
                                 
                              
                              ,
                              v
                              )
                           
                           ∣
                           
                              
                                 v
                              
                              
                                 n
                                 −
                                 1
                              
                           
                           ≤
                           v
                           ≤
                           
                              
                                 v
                              
                              
                                 m
                              
                           
                           }
                        
                      and 
                        
                           {
                           
                              (
                              u
                              ,
                              
                                 
                                    
                                       
                                          v
                                       
                                       
                                          ˜
                                       
                                    
                                 
                                 
                                    1
                                 
                              
                              )
                           
                           ∣
                           
                              
                                 u
                              
                              
                                 m
                                 −
                                 1
                              
                           
                           ≤
                           u
                           ≤
                           
                              
                                 u
                              
                              
                                 m
                              
                           
                           }
                        
                     ; see Fig. A.11(a). Letting 
                        
                           
                              h
                           
                           
                              p
                           
                        
                        
                           (
                           x
                           ,
                           a
                           ,
                           b
                           )
                        
                        =
                        1
                        −
                        max
                        
                           
                              
                                 (
                                 
                                    
                                       x
                                       −
                                       a
                                    
                                    
                                       b
                                       −
                                       a
                                    
                                 
                                 ,
                                 0
                                 )
                              
                           
                           
                              p
                           
                        
                     , define another auxiliary function 
                        
                           
                              
                                 
                                    w
                                 
                                 
                                    ̂
                                 
                              
                           
                           
                              τ
                           
                        
                     : 
                        
                           (A.8)
                           
                              
                                 
                                    
                                       
                                          w
                                       
                                       
                                          ̂
                                       
                                    
                                 
                                 
                                    τ
                                 
                              
                              
                                 (
                                 u
                                 ,
                                 v
                                 )
                              
                              =
                              
                                 
                                    1
                                 
                                 
                                    
                                       
                                          
                                             [
                                             0
                                             ,
                                             1
                                             ]
                                          
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              −
                              
                                 
                                    1
                                 
                                 
                                    
                                       
                                          D
                                       
                                       
                                          0
                                       
                                    
                                 
                              
                              
                                 
                                    h
                                 
                                 
                                    
                                       
                                          p
                                       
                                       
                                          τ
                                       
                                    
                                 
                              
                              
                                 (
                                 u
                                 ,
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 
                                    
                                       u
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                              
                                 
                                    h
                                 
                                 
                                    
                                       
                                          q
                                       
                                       
                                          τ
                                       
                                    
                                 
                              
                              
                                 (
                                 v
                                 ,
                                 
                                    
                                       
                                          
                                             v
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                              −
                              
                                 
                                    1
                                 
                                 
                                    
                                       
                                          D
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                              
                                 
                                    h
                                 
                                 
                                    
                                       
                                          p
                                       
                                       
                                          τ
                                       
                                    
                                 
                              
                              
                                 (
                                 u
                                 ,
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       u
                                    
                                    
                                       m
                                       −
                                       1
                                    
                                 
                                 )
                              
                              
                                 
                                    h
                                 
                                 
                                    
                                       
                                          q
                                       
                                       
                                          τ
                                       
                                    
                                 
                              
                              
                                 (
                                 v
                                 ,
                                 
                                    
                                       
                                          
                                             v
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       n
                                       −
                                       1
                                    
                                 
                                 )
                              
                              .
                           
                        
                     
                     Fig. A.11(d) gives an illustration for the function. The weighting functions can now be defined: 
                        
                           (A.9)
                           
                              
                                 
                                    w
                                 
                                 
                                    •
                                 
                              
                              
                                 (
                                 u
                                 ,
                                 v
                                 )
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                w
                                             
                                             
                                                ̂
                                             
                                          
                                       
                                       
                                          •
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                w
                                             
                                             
                                                ̂
                                             
                                          
                                       
                                       
                                          0
                                       
                                    
                                    
                                       (
                                       u
                                       ,
                                       v
                                       )
                                    
                                    +
                                    
                                       
                                          
                                             
                                                w
                                             
                                             
                                                ̂
                                             
                                          
                                       
                                       
                                          τ
                                       
                                    
                                    
                                       (
                                       u
                                       ,
                                       v
                                       )
                                    
                                    +
                                    
                                       
                                          
                                             
                                                w
                                             
                                             
                                                ̂
                                             
                                          
                                       
                                       
                                          1
                                       
                                    
                                    
                                       (
                                       u
                                       ,
                                       v
                                       )
                                    
                                 
                              
                              ,
                           
                        
                      where 
                        •
                      stands for one of the symbols 0, 1, and 
                        τ
                     . It is straightforward that the weighting functions defined in (A.9) satisfy the conditions (W1-3).

We can now define a multiplier function as follows. 
                        
                           (A.10)
                           
                              
                                 
                                    r
                                 
                                 
                                    
                                       b
                                    
                                 
                              
                              =
                              
                                 
                                    w
                                 
                                 
                                    0
                                 
                              
                              
                              
                                 
                                    α
                                 
                                 
                                    0
                                 
                              
                              
                              
                                 
                                    f
                                 
                                 
                                    0
                                 
                              
                              +
                              
                                 
                                    w
                                 
                                 
                                    τ
                                 
                              
                              
                              
                                 
                                    α
                                 
                                 
                                    τ
                                 
                              
                              
                              
                                 
                                    1
                                 
                                 
                                    
                                       
                                          
                                             [
                                             0
                                             ,
                                             1
                                             ]
                                          
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              +
                              
                                 
                                    w
                                 
                                 
                                    1
                                 
                              
                              
                              
                                 
                                    α
                                 
                                 
                                    1
                                 
                              
                              
                              
                                 
                                    f
                                 
                                 
                                    1
                                 
                              
                              ,
                           
                        
                      where 
                        
                           
                              α
                           
                           
                              0
                           
                        
                        ,
                        
                           
                              α
                           
                           
                              τ
                           
                        
                     , and 
                        
                           
                              α
                           
                           
                              1
                           
                        
                      are some positive constants. We use 
                        
                           
                              α
                           
                           
                              0
                           
                        
                      and 
                        
                           
                              α
                           
                           
                              1
                           
                        
                      to control the scaling of the two functions 
                        
                           
                              f
                           
                           
                              0
                           
                        
                      and 
                        
                           
                              f
                           
                           
                              1
                           
                        
                     ; we used 
                        
                           
                              α
                           
                           
                              0
                           
                        
                        =
                        
                           
                              α
                           
                           
                              1
                           
                        
                        =
                        1
                        
                           
                              0
                           
                           
                              −
                              3
                           
                        
                     . Meanwhile, 
                        
                           
                              α
                           
                           
                              τ
                           
                        
                      helps to make the optimization problem invariant under similarities. For this purpose, we define 
                        
                           
                              α
                           
                           
                              τ
                           
                        
                      as the inverse of the integral of the corresponding curve-to-boundary function associated with the initial curve for the optimization problem (8). We are now ready to prove Theorem 1. 
                        Proof of Theorem 1
                        First, we note that as the weighting functions and 
                              
                                 
                                    f
                                 
                                 
                                    0
                                 
                              
                              ,
                              
                                 
                                    f
                                 
                                 
                                    1
                                 
                              
                            are piecewise rational functions continuous over 
                              
                                 
                                    
                                       [
                                       0
                                       ,
                                       1
                                       ]
                                    
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                              
                                 
                                    r
                                 
                                 
                                    
                                       b
                                    
                                 
                              
                              
                                 (
                                 u
                                 ,
                                 v
                                 )
                              
                            must be a piecewise rational function continuous over 
                              
                                 
                                    
                                       [
                                       0
                                       ,
                                       1
                                       ]
                                    
                                 
                                 
                                    2
                                 
                              
                           . 
                              
                                 (i)
                                 By Assumptions (A-1), (A-2), Hypotheses 1–3 of this theorem, Lemma 1(i) and Eq. (5), 
                                       
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   
                                                      
                                                         α
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   lim
                                                
                                                
                                                   
                                                      (
                                                      u
                                                      ,
                                                      v
                                                      )
                                                   
                                                   →
                                                   
                                                      (
                                                      
                                                         
                                                            0
                                                         
                                                         
                                                            +
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            0
                                                         
                                                         
                                                            +
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         ̂
                                                      
                                                   
                                                
                                                
                                                   
                                                      b
                                                   
                                                
                                             
                                             
                                                (
                                                u
                                                ,
                                                v
                                                )
                                             
                                             =
                                             
                                                
                                                   1
                                                
                                                
                                                   
                                                      
                                                         α
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   lim
                                                
                                                
                                                   
                                                      (
                                                      u
                                                      ,
                                                      v
                                                      )
                                                   
                                                   →
                                                   
                                                      (
                                                      
                                                         
                                                            1
                                                         
                                                         
                                                            −
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            1
                                                         
                                                         
                                                            −
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         ̂
                                                      
                                                   
                                                
                                                
                                                   
                                                      b
                                                   
                                                
                                             
                                             
                                                (
                                                u
                                                ,
                                                v
                                                )
                                             
                                             =
                                             1
                                             .
                                          
                                       
                                     As we define 
                                       
                                          
                                             
                                                
                                                   I
                                                
                                                
                                                   ̂
                                                
                                             
                                          
                                          
                                             
                                                b
                                             
                                          
                                       
                                       
                                          (
                                          0
                                          ,
                                          0
                                          )
                                       
                                       =
                                       
                                          
                                             α
                                          
                                          
                                             0
                                          
                                       
                                     and 
                                       
                                          
                                             
                                                
                                                   I
                                                
                                                
                                                   ̂
                                                
                                             
                                          
                                          
                                             
                                                b
                                             
                                          
                                       
                                       
                                          (
                                          1
                                          ,
                                          1
                                          )
                                       
                                       =
                                       
                                          
                                             α
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             
                                                
                                                   I
                                                
                                                
                                                   ̂
                                                
                                             
                                          
                                          
                                             
                                                b
                                             
                                          
                                       
                                     is bounded and continuous, and therefore Riemann integrable over 
                                       
                                          
                                             
                                                [
                                                0
                                                ,
                                                1
                                                ]
                                             
                                          
                                          
                                             2
                                          
                                       
                                    .

Eqs. (A.6)–(A.9) directly imply that 
                                       
                                          
                                             w
                                          
                                          
                                             τ
                                          
                                       
                                       ≡
                                       1
                                     and 
                                       
                                          
                                             w
                                          
                                          
                                             0
                                          
                                       
                                       ≡
                                       
                                          
                                             w
                                          
                                          
                                             1
                                          
                                       
                                       ≡
                                       0
                                     over 
                                       
                                          
                                             
                                                [
                                                0
                                                ,
                                                1
                                                ]
                                             
                                          
                                          
                                             2
                                          
                                       
                                       ∖
                                       
                                          (
                                          
                                             
                                                D
                                             
                                             
                                                0
                                             
                                          
                                          ∪
                                          
                                             
                                                D
                                             
                                             
                                                1
                                             
                                          
                                          )
                                       
                                    . Therefore, 
                                       
                                          
                                             
                                                
                                                   I
                                                
                                                
                                                   ̂
                                                
                                             
                                          
                                          
                                             
                                                b
                                             
                                          
                                       
                                       ≡
                                       
                                          
                                             α
                                          
                                          
                                             τ
                                          
                                       
                                       
                                          
                                             I
                                          
                                          
                                             
                                                b
                                             
                                          
                                       
                                     over 
                                       
                                          
                                             
                                                [
                                                0
                                                ,
                                                1
                                                ]
                                             
                                          
                                          
                                             2
                                          
                                       
                                       ∖
                                       
                                          (
                                          
                                             
                                                D
                                             
                                             
                                                0
                                             
                                          
                                          ∪
                                          
                                             
                                                D
                                             
                                             
                                                1
                                             
                                          
                                          )
                                       
                                    .


                                    Lemma 1(ii) directly implies this conclusion for 
                                       
                                          (
                                          
                                             
                                                u
                                             
                                             
                                                ∗
                                             
                                          
                                          ,
                                          
                                             
                                                v
                                             
                                             
                                                ∗
                                             
                                          
                                          )
                                       
                                       ∈
                                       
                                          
                                             
                                                [
                                                0
                                                ,
                                                1
                                                ]
                                             
                                          
                                          
                                             2
                                          
                                       
                                       ∖
                                       
                                          (
                                          
                                             
                                                D
                                             
                                             
                                                0
                                             
                                          
                                          ∪
                                          
                                             
                                                D
                                             
                                             
                                                1
                                             
                                          
                                          )
                                       
                                    . Consider the case where 
                                       
                                          (
                                          
                                             
                                                u
                                             
                                             
                                                ∗
                                             
                                          
                                          ,
                                          
                                             
                                                v
                                             
                                             
                                                ∗
                                             
                                          
                                          )
                                       
                                       ∈
                                       
                                          
                                             D
                                          
                                          
                                             0
                                          
                                       
                                    , the case where 
                                       
                                          (
                                          
                                             
                                                u
                                             
                                             
                                                ∗
                                             
                                          
                                          ,
                                          
                                             
                                                v
                                             
                                             
                                                ∗
                                             
                                          
                                          )
                                       
                                       ∈
                                       
                                          
                                             D
                                          
                                          
                                             1
                                          
                                       
                                     is similar. Hypothesis 3 then implies that either 
                                       p
                                       >
                                       1
                                     or 
                                       q
                                       >
                                       1
                                    . On the other hand, Assumptions (A-1), (A-2), and Hypotheses 1–3 imply that 
                                       
                                          
                                             f
                                          
                                          
                                             0
                                          
                                       
                                     only vanishes at 
                                       
                                          (
                                          0
                                          ,
                                          0
                                          )
                                       
                                    . Thus, 
                                       
                                          
                                             f
                                          
                                          
                                             0
                                          
                                       
                                       
                                          (
                                          
                                             
                                                u
                                             
                                             
                                                ∗
                                             
                                          
                                          ,
                                          
                                             
                                                v
                                             
                                             
                                                ∗
                                             
                                          
                                          )
                                       
                                       ≠
                                       0
                                    . Consequently, in the limiting process when 
                                       
                                          (
                                          u
                                          ,
                                          v
                                          )
                                       
                                       →
                                       
                                          (
                                          
                                             
                                                u
                                             
                                             
                                                ∗
                                             
                                          
                                          ,
                                          
                                             
                                                v
                                             
                                             
                                                ∗
                                             
                                          
                                          )
                                       
                                       ,
                                       
                                          
                                             
                                                
                                                   I
                                                
                                                
                                                   ̂
                                                
                                             
                                          
                                          
                                             
                                                b
                                             
                                          
                                       
                                       
                                          (
                                          u
                                          ,
                                          v
                                          )
                                       
                                     is equivalent to 
                                       
                                          
                                             I
                                          
                                          
                                             
                                                b
                                             
                                          
                                       
                                       
                                          (
                                          u
                                          ,
                                          v
                                          )
                                       
                                    .
                                       1
                                    
                                    
                                       1
                                       This is not true, if Hypothesis (iii) is disregarded and 
                                             p
                                             =
                                             q
                                             =
                                             1
                                          .
                                     Therefore, Lemma 1(ii) again leads to the conclusion.□


                     
                        Proof of Theorem 2
                        Partition the unit square into the sets 
                              
                                 
                                    B
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                              =
                              
                                 [
                                 
                                    
                                       u
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       u
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                 
                                 ]
                              
                              
                                 ×
                              
                              
                                 [
                                 
                                    
                                       u
                                    
                                    
                                       j
                                    
                                 
                                 ,
                                 
                                    
                                       u
                                    
                                    
                                       j
                                       +
                                       1
                                    
                                 
                                 ]
                              
                              ,
                              
                              1
                              ≤
                              i
                              ≤
                              m
                              −
                              1
                              ,
                              1
                              ≤
                              j
                              ≤
                              n
                              −
                              1
                           . From Eq. (7) and Lemma 1(i), 
                              
                                 
                                    (B.1)
                                    
                                       
                                          
                                             lim
                                          
                                          
                                             
                                                (
                                                u
                                                ,
                                                v
                                                )
                                             
                                             →
                                             
                                                (
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      −
                                                   
                                                
                                                ,
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      +
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       
                                          
                                             J
                                             
                                                (
                                                u
                                                ,
                                                v
                                                )
                                             
                                          
                                          
                                             g
                                             
                                                (
                                                u
                                                ,
                                                v
                                                )
                                             
                                          
                                       
                                       =
                                       1
                                       =
                                       
                                          
                                             lim
                                          
                                          
                                             
                                                (
                                                u
                                                ,
                                                v
                                                )
                                             
                                             →
                                             
                                                (
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      +
                                                   
                                                
                                                ,
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      −
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       
                                          
                                             J
                                             
                                                (
                                                u
                                                ,
                                                v
                                                )
                                             
                                          
                                          
                                             g
                                             
                                                (
                                                u
                                                ,
                                                v
                                                )
                                             
                                          
                                       
                                       ,
                                    
                                 
                                 
                                    
                                       where  
                                       g
                                       
                                          (
                                          u
                                          ,
                                          v
                                          )
                                       
                                       ≔
                                       
                                          
                                             
                                                
                                                   
                                                      (
                                                      u
                                                      −
                                                      v
                                                      )
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      ‖
                                                      
                                                         
                                                            
                                                               c
                                                            
                                                         
                                                         
                                                            −
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                      
                                                         (
                                                         
                                                            
                                                               u
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         )
                                                      
                                                      
                                                         (
                                                         u
                                                         −
                                                         
                                                            
                                                               u
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         )
                                                      
                                                      −
                                                      
                                                         
                                                            
                                                               c
                                                            
                                                         
                                                         
                                                            +
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                      
                                                         (
                                                         
                                                            
                                                               u
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         )
                                                      
                                                      
                                                         (
                                                         v
                                                         −
                                                         
                                                            
                                                               u
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         )
                                                      
                                                      ‖
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       .
                                    
                                 
                              
                            (i) By Condition (C-2), 
                              J
                            is continuous at any 
                              
                                 (
                                 u
                                 ,
                                 v
                                 )
                              
                            where 
                              u
                              ≠
                              v
                           . For 
                              
                                 (
                                 u
                                 ,
                                 v
                                 )
                              
                              ∈
                              
                                 
                                    B
                                 
                                 
                                    i
                                    ,
                                    i
                                 
                              
                            which includes the case 
                              u
                              =
                              v
                           , 
                              
                                 (B.2)
                                 
                                    
                                       c
                                    
                                    
                                       (
                                       u
                                       )
                                    
                                    −
                                    
                                       c
                                    
                                    
                                       (
                                       v
                                       )
                                    
                                    =
                                    
                                       (
                                       u
                                       −
                                       v
                                       )
                                    
                                    
                                       (
                                       
                                          
                                             
                                                c
                                             
                                          
                                          
                                             ′
                                          
                                       
                                       
                                          (
                                          v
                                          )
                                       
                                       +
                                       
                                          (
                                          u
                                          −
                                          v
                                          )
                                       
                                       
                                          
                                             
                                                P
                                             
                                          
                                          
                                             i
                                          
                                       
                                       
                                          (
                                          u
                                          ,
                                          v
                                          )
                                       
                                       )
                                    
                                    ,
                                 
                              
                            for a vector-valued polynomial 
                              
                                 
                                    
                                       P
                                    
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 u
                                 ,
                                 v
                                 )
                              
                           . Condition (C-2) implies 
                              
                                 ‖
                                 
                                    
                                       
                                          c
                                       
                                    
                                    
                                       ′
                                    
                                 
                                 
                                    (
                                    
                                       
                                          u
                                       
                                       
                                          ∗
                                       
                                    
                                    )
                                 
                                 ‖
                              
                              >
                              0
                            for all 
                              
                                 
                                    u
                                 
                                 
                                    ∗
                                 
                              
                              ∈
                              
                                 [
                                 
                                    
                                       u
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       u
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                 
                                 ]
                              
                              ,
                              1
                              <
                              i
                              <
                              m
                           , and with Eqs. (7), (B.2) this implies that 
                              J
                            is continuous at every 
                              
                                 (
                                 u
                                 ,
                                 u
                                 )
                              
                            where 
                              u
                              ≠
                              
                                 
                                    u
                                 
                                 
                                    i
                                 
                              
                              ,
                              1
                              <
                              i
                              <
                              m
                           . Therefore we only need to consider discontinuities of 
                              J
                            at 
                              
                                 (
                                 
                                    
                                       u
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       u
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                              ,
                              
                              1
                              <
                              i
                              <
                              m
                           . We divide the proof of (i) into two parts.


                           Sufficient condition. Assume 
                              
                                 c
                              
                            is differentiable at each 
                              
                                 (
                                 
                                    
                                       u
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       u
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                           . Then 
                              
                                 
                                    c
                                 
                                 
                                    −
                                 
                                 
                                    ′
                                 
                              
                              
                                 (
                                 
                                    
                                       u
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                              =
                              
                                 
                                    c
                                 
                                 
                                    +
                                 
                                 
                                    ′
                                 
                              
                              
                                 (
                                 
                                    
                                       u
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                           , and Eqs. (B.1), (B.2) can be used to show that the four limits of 
                              J
                            at 
                              
                                 (
                                 
                                    
                                       u
                                    
                                    
                                       i
                                    
                                    
                                       ±
                                    
                                 
                                 ,
                                 
                                    
                                       u
                                    
                                    
                                       i
                                    
                                    
                                       ±
                                    
                                 
                                 )
                              
                            are equal. Thus 
                              J
                            is continuous at each 
                              
                                 (
                                 
                                    
                                       u
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       u
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                            and, we conclude, over the whole unit square.


                           Necessary condition. If 
                              
                                 c
                              
                            is not differentiable at some 
                              
                                 
                                    u
                                 
                                 
                                    i
                                 
                              
                              ,
                              1
                              <
                              i
                              <
                              m
                           , so that 
                              
                                 
                                    
                                       c
                                    
                                 
                                 
                                    +
                                 
                                 
                                    ′
                                 
                              
                              
                                 (
                                 
                                    
                                       u
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                              ≠
                              
                                 
                                    
                                       c
                                    
                                 
                                 
                                    −
                                 
                                 
                                    ′
                                 
                              
                              
                                 (
                                 
                                    
                                       u
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                           , then for 
                              α
                              >
                              0
                              ,
                              
                              β
                              >
                              0
                            such that 
                              α
                              +
                              β
                              =
                              1
                           , we see from (B.1) that 
                              
                                 
                                    lim
                                 
                                 
                                    n
                                    →
                                    ∞
                                 
                              
                              J
                              
                                 (
                                 
                                    
                                       u
                                    
                                    
                                       i
                                    
                                 
                                 −
                                 
                                    
                                       α
                                    
                                    
                                       n
                                    
                                 
                                 ,
                                 
                                    
                                       u
                                    
                                    
                                       i
                                    
                                 
                                 +
                                 
                                    
                                       β
                                    
                                    
                                       n
                                    
                                 
                                 )
                              
                            is not independent of 
                              α
                            and 
                              β
                           . Therefore 
                              J
                            is not continuous at 
                              
                                 (
                                 
                                    
                                       u
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       u
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                           .

(ii) By Lemma 1(i) and condition C-2/(ii), 
                              g
                              
                                 (
                                 u
                                 ,
                                 v
                                 )
                              
                            is bounded on the sets 
                              
                                 {
                                 
                                    (
                                    u
                                    ,
                                    v
                                    )
                                 
                                 :
                                 u
                                 <
                                 
                                    
                                       u
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 v
                                 >
                                 
                                    
                                       u
                                    
                                    
                                       i
                                    
                                 
                                 }
                              
                            and 
                              
                                 {
                                 
                                    (
                                    u
                                    ,
                                    v
                                    )
                                 
                                 :
                                 u
                                 >
                                 
                                    
                                       u
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 v
                                 <
                                 
                                    
                                       u
                                    
                                    
                                       i
                                    
                                 
                                 }
                              
                           . By (B.1), 
                              J
                              
                                 (
                                 u
                                 ,
                                 v
                                 )
                              
                            is bounded on the interiors of 
                              
                                 
                                    B
                                 
                                 
                                    i
                                    −
                                    1
                                    ,
                                    i
                                 
                              
                            and 
                              
                                 
                                    B
                                 
                                 
                                    i
                                    ,
                                    i
                                    −
                                    1
                                 
                              
                           . By Eq. (B.2), 
                              J
                              
                                 (
                                 u
                                 ,
                                 v
                                 )
                              
                            is bounded on the interiors of each 
                              
                                 
                                    B
                                 
                                 
                                    i
                                    ,
                                    i
                                 
                              
                           . Thus 
                              J
                            is almost everywhere continuous and bounded, and therefore Riemann integrable.

(iii) We treat the violations of the conditions separately:

(C-1)/(i): Suppose 
                              u
                              ,
                              v
                            are such that 
                              u
                              ≠
                              v
                            and 
                              
                                 c
                              
                              
                                 (
                                 u
                                 )
                              
                              =
                              
                                 c
                              
                              
                                 (
                                 v
                                 )
                              
                           . Apply Lemma 1/(ii) to the two curves formed by restricting 
                              
                                 c
                              
                            to neighborhoods of 
                              u
                            and 
                              v
                           .

(C-1)/(ii): Since 
                              
                                 c
                              
                            is a spline, either all zeros of 
                              
                                 
                                    
                                       c
                                    
                                 
                                 
                                    ′
                                 
                              
                            are isolated or 
                              
                                 
                                    
                                       c
                                    
                                 
                                 
                                    ′
                                 
                              
                            is zero on a knot interval. If 
                              
                                 
                                    
                                       c
                                    
                                 
                                 
                                    ′
                                 
                              
                            is zero on an interval 
                              
                                 (
                                 
                                    
                                       u
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       u
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                 
                                 )
                              
                            then 
                              
                                 c
                              
                            is constant on the interval and 
                              J
                            is undefined on 
                              
                                 
                                    B
                                 
                                 
                                    i
                                    ,
                                    i
                                 
                              
                           . Thus the integral is undefined.

If there is isolated 
                              
                                 
                                    u
                                 
                                 
                                    ∗
                                 
                              
                            such that 
                              
                                 
                                    
                                       c
                                    
                                 
                                 
                                    +
                                 
                                 
                                    ′
                                 
                              
                              
                                 (
                                 
                                    
                                       u
                                    
                                    
                                       ∗
                                    
                                 
                                 )
                              
                              =
                              0
                           , then, applying Eqs. (7), (B.2), 
                              J
                              
                                 (
                                 u
                                 ,
                                 v
                                 )
                              
                              =
                              
                                 
                                    
                                       ‖
                                       O
                                       
                                          (
                                          u
                                          −
                                          
                                             
                                                u
                                             
                                             
                                                ∗
                                             
                                          
                                          )
                                       
                                       +
                                       O
                                       
                                          (
                                          v
                                          −
                                          
                                             
                                                u
                                             
                                             
                                                ∗
                                             
                                          
                                          )
                                       
                                       ‖
                                    
                                 
                                 
                                    −
                                    2
                                 
                              
                            as 
                              
                                 (
                                 u
                                 ,
                                 v
                                 )
                              
                              →
                              
                                 (
                                 
                                    
                                       u
                                    
                                    
                                       ∗
                                       +
                                    
                                 
                                 ,
                                 
                                    
                                       u
                                    
                                    
                                       ∗
                                       +
                                    
                                 
                                 )
                              
                           . Therefore there exist 
                              ϵ
                              ,
                              C
                              >
                              0
                            such that 
                              J
                              
                                 (
                                 u
                                 ,
                                 v
                                 )
                              
                              >
                              
                                 
                                    
                                       (
                                       C
                                       
                                          (
                                          
                                             (
                                             u
                                             −
                                             
                                                
                                                   u
                                                
                                                
                                                   ∗
                                                
                                             
                                             )
                                          
                                          +
                                          
                                             (
                                             v
                                             −
                                             
                                                
                                                   u
                                                
                                                
                                                   ∗
                                                
                                             
                                             )
                                          
                                          )
                                       
                                       )
                                    
                                 
                                 
                                    −
                                    2
                                 
                              
                            for all 
                              u
                              ,
                              v
                              ∈
                              
                                 (
                                 
                                    
                                       u
                                    
                                    
                                       ∗
                                    
                                 
                                 ,
                                 
                                    
                                       u
                                    
                                    
                                       ∗
                                    
                                 
                                 +
                                 ϵ
                                 )
                              
                           , so the integral diverges.□

Before discussing our approach for computing the regularized penalty functions, we will introduce several kinds of bivariate spline functions which help to make the computation more efficient.


                     Representation of the difference between two points of one spline curve. In order to compute the denominator of the curve-to-itself penalty function 
                        J
                        
                           (
                           u
                           ,
                           v
                           )
                        
                      given by (7) in a diagonal box 
                        
                           
                              B
                           
                           
                              i
                              ,
                              i
                           
                        
                        =
                        
                           [
                           
                              
                                 u
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 u
                              
                              
                                 i
                                 +
                                 1
                              
                           
                           ]
                        
                        ×
                        
                           [
                           
                              
                                 u
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 u
                              
                              
                                 i
                                 +
                                 1
                              
                           
                           ]
                        
                     , we let 
                        
                           Q
                        
                        :
                        
                           
                              B
                           
                           
                              i
                              ,
                              i
                           
                        
                        →
                        
                           
                              R
                           
                           
                              2
                           
                        
                      be the vector-valued polynomial satisfying 
                        
                           (C.1)
                           
                              
                                 c
                              
                              
                                 (
                                 u
                                 )
                              
                              −
                              
                                 c
                              
                              
                                 (
                                 v
                                 )
                              
                              =
                              
                                 (
                                 u
                                 −
                                 v
                                 )
                              
                              
                                 Q
                              
                              
                                 (
                                 u
                                 ,
                                 v
                                 )
                              
                              .
                           
                        
                      It is obvious that 
                        
                           Q
                        
                        
                           (
                           u
                           ,
                           v
                           )
                        
                      is a bivariate spline of degree 
                        p
                        −
                        1
                      in both 
                        u
                      and 
                        v
                     . Pekerman et al.  [5] derived explicitly the control points of its spline representation for the case where 
                        
                           c
                        
                        
                           (
                           u
                           )
                        
                      is a Bézier curve. For this case, 
                        
                           Q
                        
                        
                           (
                           u
                           ,
                           v
                           )
                        
                      is a Bézier surface described by 
                        
                           
                              
                                 (
                                 m
                                 −
                                 1
                                 )
                              
                           
                           
                              2
                           
                        
                      control points and 
                        
                           
                              
                                 (
                                 m
                                 −
                                 1
                                 )
                              
                           
                           
                              2
                           
                        
                      basis functions. Extending to the case of a general spline curve requires either implicit representation of the control points of the spline surface 
                        
                           Q
                        
                        
                           (
                           u
                           ,
                           v
                           )
                        
                      or breaking the curve into Bézier segments. In the remainder of the section, we will represent the spline surface 
                        
                           Q
                        
                        
                           (
                           u
                           ,
                           v
                           )
                        
                      in terms of just 
                        m
                      control points and 
                        m
                      functions, and the control points are the same as those of the curve.

Let 
                        D
                        =
                        
                           
                              ⋃
                           
                           
                              j
                           
                        
                        
                           (
                           
                              [
                              
                                 
                                    u
                                 
                                 
                                    j
                                 
                              
                              ,
                              
                                 
                                    u
                                 
                                 
                                    j
                                    +
                                    1
                                 
                              
                              )
                           
                           ×
                           
                              [
                              
                                 
                                    u
                                 
                                 
                                    j
                                 
                              
                              ,
                              
                                 
                                    u
                                 
                                 
                                    j
                                    +
                                    1
                                 
                              
                              )
                           
                           )
                        
                     , the union of the diagonal semi-open boxes associated with the knot vector 
                        U
                      given by (2). Consider B-splines 
                        
                           
                              N
                           
                           
                              i
                              ,
                              p
                              ,
                              U
                           
                        
                      of degree 
                        p
                      associated with 
                        U
                     . We assume that 
                        p
                        ≥
                        1
                     . Define 
                        
                           (C.2)
                           
                              
                                 
                                    Q
                                 
                                 
                                    i
                                    ,
                                    p
                                 
                              
                              
                                 (
                                 u
                                 ,
                                 v
                                 )
                              
                              =
                              
                                 
                                    
                                       
                                          N
                                       
                                       
                                          i
                                          ,
                                          p
                                          ,
                                          U
                                       
                                    
                                    
                                       (
                                       u
                                       )
                                    
                                    −
                                    
                                       
                                          N
                                       
                                       
                                          i
                                          ,
                                          p
                                          ,
                                          U
                                       
                                    
                                    
                                       (
                                       v
                                       )
                                    
                                 
                                 
                                    u
                                    −
                                    v
                                 
                              
                              .
                           
                        
                     
                     
                        
                           
                              Q
                           
                           
                              i
                              ,
                              p
                           
                        
                      is well defined because of the fundamental polynomial remainder theorem. Further, as 
                        
                           
                              ∑
                           
                           
                              i
                              =
                              1
                           
                           
                              m
                           
                        
                        
                           
                              Q
                           
                           
                              i
                              ,
                              p
                           
                        
                        ≡
                        0
                     , the functions 
                        
                           
                              Q
                           
                           
                              i
                              ,
                              p
                           
                        
                      are not linearly independent.
                        2
                     
                     
                        2
                        In fact, if all inner knots have multiplicity less than 
                              p
                              +
                              1
                           , the dimension of the linear space spanned by 
                              
                                 
                                    Q
                                 
                                 
                                    i
                                    ,
                                    p
                                 
                              
                              ,
                              
                              1
                              ≤
                              i
                              ≤
                              m
                           , are 
                              m
                              −
                              1
                           . We leave the proof as an exercise for readers.
                      The following proposition shows that these functions form a spanning set of the space of functions 
                        
                           Q
                        
                        
                           (
                           u
                           ,
                           v
                           )
                        
                      given by (C.1). 
                        Proposition 1
                        
                           For 
                           
                              p
                              ≥
                              1
                           
                           , the functions 
                           
                              
                                 
                                    Q
                                 
                                 
                                    i
                                    ,
                                    p
                                 
                              
                            
                           defined by   (C.2)   have the following properties.
                           
                              
                                 (i)
                                 
                                    For any spline curve 
                                    
                                       
                                          c
                                       
                                       
                                          (
                                          u
                                          )
                                       
                                     
                                    of the form
                                    (1)
                                    , the following identity holds for all 
                                    
                                       
                                          (
                                          u
                                          ,
                                          v
                                          )
                                       
                                       ∈
                                       D
                                    
                                    :
                                    
                                       
                                          (C.3)
                                          
                                             
                                                c
                                             
                                             
                                                (
                                                u
                                                )
                                             
                                             −
                                             
                                                c
                                             
                                             
                                                (
                                                v
                                                )
                                             
                                             =
                                             
                                                (
                                                u
                                                −
                                                v
                                                )
                                             
                                             
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                
                                                   m
                                                
                                             
                                             
                                                
                                                   
                                                      c
                                                   
                                                
                                                
                                                   i
                                                
                                             
                                             
                                             
                                                
                                                   Q
                                                
                                                
                                                   i
                                                   ,
                                                   p
                                                
                                             
                                             
                                                (
                                                u
                                                ,
                                                v
                                                )
                                             
                                             .
                                          
                                       
                                    
                                 


                                    They can be computed recursively as below:
                                    
                                       
                                          (C.4)
                                          
                                             
                                                
                                                   Q
                                                
                                                
                                                   i
                                                   ,
                                                   p
                                                
                                             
                                             
                                                (
                                                u
                                                ,
                                                v
                                                )
                                             
                                             =
                                             
                                                (
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      i
                                                   
                                                
                                                v
                                                +
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      i
                                                   
                                                
                                                )
                                             
                                             
                                             
                                                
                                                   Q
                                                
                                                
                                                   i
                                                   ,
                                                   p
                                                   −
                                                   1
                                                
                                             
                                             
                                                (
                                                u
                                                ,
                                                v
                                                )
                                             
                                             +
                                             
                                                (
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      i
                                                   
                                                
                                                v
                                                +
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      i
                                                   
                                                
                                                )
                                             
                                             
                                             
                                                
                                                   Q
                                                
                                                
                                                   i
                                                   +
                                                   1
                                                   ,
                                                   p
                                                   −
                                                   1
                                                
                                             
                                             
                                                (
                                                u
                                                ,
                                                v
                                                )
                                             
                                             +
                                             
                                                
                                                   a
                                                
                                                
                                                   i
                                                
                                             
                                             
                                             
                                                
                                                   N
                                                
                                                
                                                   i
                                                   ,
                                                   p
                                                   −
                                                   1
                                                   ,
                                                   U
                                                
                                             
                                             
                                                (
                                                u
                                                )
                                             
                                             +
                                             
                                                
                                                   c
                                                
                                                
                                                   i
                                                
                                             
                                             
                                             
                                                
                                                   N
                                                
                                                
                                                   i
                                                   +
                                                   1
                                                   ,
                                                   p
                                                   −
                                                   1
                                                   ,
                                                   U
                                                
                                             
                                             
                                                (
                                                u
                                                )
                                             
                                             ,
                                          
                                       
                                    
                                    for all 
                                    
                                       
                                          (
                                          u
                                          ,
                                          v
                                          )
                                       
                                       ∈
                                       D
                                    
                                    , where
                                    
                                       
                                          (C.5)
                                          
                                             
                                                (
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ,
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      i
                                                   
                                                
                                                )
                                             
                                             =
                                             
                                                
                                                   
                                                      (
                                                      1
                                                      ,
                                                      −
                                                      
                                                         
                                                            u
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      )
                                                   
                                                
                                                
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         i
                                                         +
                                                         p
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                             
                                             ,
                                             
                                             
                                                (
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ,
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      i
                                                   
                                                
                                                )
                                             
                                             =
                                             
                                                
                                                   
                                                      (
                                                      −
                                                      1
                                                      ,
                                                      
                                                         
                                                            u
                                                         
                                                         
                                                            i
                                                            +
                                                            p
                                                            +
                                                            1
                                                         
                                                      
                                                      )
                                                   
                                                
                                                
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         i
                                                         +
                                                         p
                                                         +
                                                         1
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         i
                                                         +
                                                         1
                                                      
                                                   
                                                
                                             
                                             .
                                          
                                       
                                    
                                    In
                                    (C.4)
                                    , we assume that 
                                    
                                       
                                          
                                             Q
                                          
                                          
                                             i
                                             ,
                                             0
                                          
                                       
                                       ≡
                                       0
                                     
                                    and with the standard convention that a fraction equals  0  if its denominator equals  0.
                                 


                                    
                                       
                                          
                                             Q
                                          
                                          
                                             i
                                             ,
                                             p
                                          
                                       
                                       
                                          (
                                          u
                                          ,
                                          u
                                          )
                                       
                                     
                                    is the derivative of 
                                    
                                       
                                          
                                             N
                                          
                                          
                                             i
                                             ,
                                             p
                                             ,
                                             U
                                          
                                       
                                       
                                          (
                                          u
                                          )
                                       
                                    
                                    .
                                 


                     
                        Proof
                        (i) can be derived directly from (C.1) and (C.3).

(ii) Eq. (C.4) can be derived from Eq. (C.2) and the recursive evaluation of B-splines 
                              
                                 
                                    N
                                 
                                 
                                    i
                                    ,
                                    p
                                    ,
                                    U
                                 
                              
                           , 
                              
                                 
                                    
                                       
                                          N
                                       
                                       
                                          i
                                          ,
                                          p
                                          ,
                                          U
                                       
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                    =
                                    
                                       (
                                       
                                          
                                             a
                                          
                                          
                                             i
                                          
                                       
                                       t
                                       +
                                       
                                          
                                             b
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                    
                                       
                                          N
                                       
                                       
                                          i
                                          ,
                                          p
                                          −
                                          1
                                          ,
                                          U
                                       
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                    +
                                    
                                       (
                                       
                                          
                                             c
                                          
                                          
                                             i
                                          
                                       
                                       t
                                       +
                                       
                                          
                                             d
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                    
                                       
                                          N
                                       
                                       
                                          i
                                          +
                                          1
                                          ,
                                          p
                                          −
                                          1
                                          ,
                                          U
                                       
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                    .
                                 
                              
                            (iii) The following Taylor expansion of 
                              
                                 
                                    N
                                 
                                 
                                    i
                                    ,
                                    p
                                    ,
                                    U
                                 
                              
                            proves (iii): 
                              
                                 
                                    
                                       
                                          N
                                       
                                       
                                          i
                                          ,
                                          p
                                          ,
                                          U
                                       
                                    
                                    
                                       (
                                       u
                                       )
                                    
                                    =
                                    
                                       
                                          N
                                       
                                       
                                          i
                                          ,
                                          p
                                          ,
                                          U
                                       
                                    
                                    
                                       (
                                       v
                                       )
                                    
                                    +
                                    
                                       
                                          N
                                       
                                       
                                          i
                                          ,
                                          p
                                          ,
                                          U
                                       
                                       
                                          ′
                                       
                                    
                                    
                                       (
                                       v
                                       )
                                    
                                    
                                       (
                                       u
                                       −
                                       v
                                       )
                                    
                                    +
                                    o
                                    
                                       
                                          
                                             (
                                             u
                                             −
                                             v
                                             )
                                          
                                       
                                       
                                          2
                                       
                                    
                                    .
                                 
                              
                           
                           □


                     Representation of Taylor-like expansion coefficients of a spline curve. A one-sided Taylor expansion of 
                        
                           c
                        
                      around 
                        
                           
                              u
                           
                           
                              ̄
                           
                        
                        ,
                        
                           
                              u
                           
                           
                              i
                           
                        
                        ≤
                        
                           
                              u
                           
                           
                              ̄
                           
                        
                        <
                        
                           
                              u
                           
                           
                              i
                              +
                              1
                           
                        
                     , can be written as below for all 
                        u
                        ∈
                        
                           [
                           
                              
                                 u
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 u
                              
                              
                                 i
                                 +
                                 1
                              
                           
                           ]
                        
                     
                     
                        
                           
                              (C.6)
                              
                                 
                                    c
                                 
                                 
                                    (
                                    u
                                    )
                                 
                                 =
                                 
                                    c
                                 
                                 
                                    (
                                    
                                       
                                          u
                                       
                                       
                                          ̄
                                       
                                    
                                    )
                                 
                                 +
                                 
                                    
                                       
                                          c
                                       
                                    
                                    
                                       +
                                    
                                    
                                       ′
                                    
                                 
                                 
                                    (
                                    
                                       
                                          u
                                       
                                       
                                          ̄
                                       
                                    
                                    )
                                 
                                 
                                    (
                                    u
                                    −
                                    
                                       
                                          u
                                       
                                       
                                          ̄
                                       
                                    
                                    )
                                 
                                 +
                                 
                                    
                                       
                                          
                                             
                                                c
                                             
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                    
                                       +
                                    
                                 
                                 
                                    (
                                    u
                                    ,
                                    
                                       
                                          u
                                       
                                       
                                          ̄
                                       
                                    
                                    )
                                 
                                 
                                    
                                       
                                          (
                                          u
                                          −
                                          
                                             
                                                u
                                             
                                             
                                                ̄
                                             
                                          
                                          )
                                       
                                    
                                    
                                       2
                                    
                                 
                                 ,
                              
                           
                           
                              (C.7)
                              
                                 where  
                                 
                                    
                                       
                                          
                                             
                                                c
                                             
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                    
                                       +
                                    
                                 
                                 
                                    (
                                    u
                                    ,
                                    
                                       
                                          u
                                       
                                       
                                          ̄
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       =
                                       2
                                    
                                    
                                       p
                                    
                                 
                                 
                                    
                                       1
                                    
                                    
                                       k
                                       !
                                    
                                 
                                 
                                    
                                       
                                          c
                                       
                                    
                                    
                                       +
                                    
                                    
                                       
                                          (
                                          k
                                          )
                                       
                                    
                                 
                                 
                                    (
                                    
                                       
                                          u
                                       
                                       
                                          ̄
                                       
                                    
                                    )
                                 
                                 
                                    
                                       
                                          (
                                          u
                                          −
                                          
                                             
                                                u
                                             
                                             
                                                ̄
                                             
                                          
                                          )
                                       
                                    
                                    
                                       k
                                       −
                                       2
                                    
                                 
                                 ,
                              
                           
                        
                      and 
                        
                           
                              
                                 c
                              
                           
                           
                              +
                           
                           
                              
                                 (
                                 k
                                 )
                              
                           
                        
                      denotes a right-sided derivative of order 
                        k
                      of 
                        
                           c
                        
                     . We shall see in (C.13) that the representation (C.6) allows for stable computations for the penalty functions.

Eq. (C.7) provides a direct approach for computing the term. However, this approach is not preferable. Similar to the evaluation of the quantity 
                        
                           c
                        
                        
                           (
                           u
                           )
                        
                        −
                        
                           c
                        
                        
                           (
                           v
                           )
                        
                      in Proposition 1, we introduce the following spline functions that also allow for a computation of the term as a linear combination of only 
                        m
                      functions.

We assume 
                        p
                        ≥
                        2
                     . Define the following spline functions: 
                        
                           (C.8)
                           
                              
                                 
                                    H
                                 
                                 
                                    i
                                    ,
                                    p
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          Q
                                       
                                       
                                          i
                                          ,
                                          p
                                       
                                    
                                    
                                       (
                                       u
                                       ,
                                       v
                                       )
                                    
                                    −
                                    
                                       
                                          Q
                                       
                                       
                                          i
                                          ,
                                          p
                                       
                                    
                                    
                                       (
                                       v
                                       ,
                                       v
                                       )
                                    
                                 
                                 
                                    u
                                    −
                                    v
                                 
                              
                              .
                           
                        
                      Similar to the definition of 
                        
                           
                              Q
                           
                           
                              i
                              ,
                              p
                           
                        
                      given by (C.2), this definition is also well-defined. Also, the set of 
                        
                           
                              H
                           
                           
                              i
                              ,
                              p
                           
                        
                      is not linearly independent as the sum of all these functions vanishes. However, different from 
                        
                           
                              Q
                           
                           
                              i
                              ,
                              p
                           
                        
                        ,
                        
                           
                              H
                           
                           
                              i
                              ,
                              p
                           
                        
                      is not symmetric in its variables. That is, 
                        
                           
                              H
                           
                           
                              i
                              ,
                              p
                           
                        
                        
                           (
                           u
                           ,
                           v
                           )
                        
                      is in general different from 
                        
                           
                              H
                           
                           
                              i
                              ,
                              p
                           
                        
                        
                           (
                           v
                           ,
                           u
                           )
                        
                     . The following proposition provides a recursive formula for the evaluation of these spline functions. 
                        Proposition 2
                        
                           For 
                           
                              p
                              ≥
                              2
                           
                           , the functions 
                           
                              
                                 
                                    H
                                 
                                 
                                    i
                                    ,
                                    p
                                 
                              
                            
                           defined by   (C.8)   have the following properties.
                           
                              
                                 (i)
                                 
                                    For any spline curve 
                                    
                                       
                                          c
                                       
                                       
                                          (
                                          u
                                          )
                                       
                                     
                                    given by
                                    (1)
                                    , we have the following identity:
                                    
                                       
                                          (C.9)
                                          
                                             
                                                c
                                             
                                             
                                                (
                                                u
                                                )
                                             
                                             =
                                             
                                                c
                                             
                                             
                                                (
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      ̄
                                                   
                                                
                                                )
                                             
                                             +
                                             
                                                
                                                   
                                                      c
                                                   
                                                
                                                
                                                   +
                                                
                                                
                                                   ′
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      ̄
                                                   
                                                
                                                )
                                             
                                             
                                                (
                                                u
                                                −
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      ̄
                                                   
                                                
                                                )
                                             
                                             +
                                             
                                                (
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   
                                                      m
                                                   
                                                
                                                
                                                   
                                                      
                                                         c
                                                      
                                                   
                                                   
                                                      i
                                                   
                                                
                                                
                                                
                                                   
                                                      H
                                                   
                                                   
                                                      i
                                                      ,
                                                      p
                                                   
                                                
                                                
                                                   (
                                                   u
                                                   ,
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         ̄
                                                      
                                                   
                                                   )
                                                
                                                )
                                             
                                             
                                                
                                                   
                                                      (
                                                      u
                                                      −
                                                      
                                                         
                                                            u
                                                         
                                                         
                                                            ̄
                                                         
                                                      
                                                      )
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                             ,
                                             
                                             ∀
                                             u
                                             ∈
                                             
                                                [
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ,
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      i
                                                      +
                                                      1
                                                   
                                                
                                                )
                                             
                                             .
                                          
                                       
                                    
                                 


                                    
                                       
                                          
                                             H
                                          
                                          
                                             i
                                             ,
                                             p
                                          
                                       
                                     
                                    can be computed recursively as follows
                                    
                                       
                                          (C.10)
                                          
                                             
                                                
                                                   H
                                                
                                                
                                                   i
                                                   ,
                                                   p
                                                
                                             
                                             
                                                (
                                                u
                                                ,
                                                v
                                                )
                                             
                                             =
                                             
                                                (
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      i
                                                   
                                                
                                                v
                                                +
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      i
                                                   
                                                
                                                )
                                             
                                             
                                             
                                                
                                                   H
                                                
                                                
                                                   i
                                                   ,
                                                   p
                                                   −
                                                   1
                                                
                                             
                                             
                                                (
                                                u
                                                ,
                                                v
                                                )
                                             
                                             +
                                             
                                                (
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      i
                                                   
                                                
                                                v
                                                +
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      i
                                                   
                                                
                                                )
                                             
                                             
                                             
                                                
                                                   H
                                                
                                                
                                                   i
                                                   +
                                                   1
                                                   ,
                                                   p
                                                   −
                                                   1
                                                
                                             
                                             
                                                (
                                                u
                                                ,
                                                v
                                                )
                                             
                                             +
                                             
                                                
                                                   a
                                                
                                                
                                                   i
                                                
                                             
                                             
                                             
                                                
                                                   Q
                                                
                                                
                                                   i
                                                   ,
                                                   p
                                                   −
                                                   1
                                                
                                             
                                             
                                                (
                                                u
                                                )
                                             
                                             +
                                             
                                                
                                                   c
                                                
                                                
                                                   i
                                                
                                             
                                             
                                             
                                                
                                                   Q
                                                
                                                
                                                   i
                                                   +
                                                   1
                                                   ,
                                                   p
                                                   −
                                                   1
                                                
                                             
                                             
                                                (
                                                u
                                                )
                                             
                                             ,
                                          
                                       
                                    
                                    for all 
                                    
                                       
                                          (
                                          u
                                          ,
                                          v
                                          )
                                       
                                       ∈
                                       D
                                    
                                    , where 
                                    
                                       
                                          
                                             a
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             b
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             c
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             d
                                          
                                          
                                             i
                                          
                                       
                                     
                                    are given by
                                    (C.5)   and where we assume that 
                                    
                                       
                                          
                                             H
                                          
                                          
                                             i
                                             ,
                                             1
                                          
                                       
                                       ≡
                                       0
                                    
                                    .
                                 


                     
                        Proof
                        The proof is similar to that of Proposition 1.□


                     Evaluation of the regularized penalty functions. With the introduction of the spline functions 
                        
                           
                              Q
                           
                           
                              i
                              ,
                              p
                           
                        
                     , and 
                        
                           
                              H
                           
                           
                              i
                              ,
                              p
                           
                        
                     , together with Eqs. (C.3), and (C.9), the computation of the penalty functions 
                        
                           
                              I
                           
                           
                              ̂
                           
                        
                      and 
                        J
                      are ready, except that we have to compute the two functions in the neighborhoods of a point at which one of the two functions has the form 0/0. At such a point, we will convert each function into a form in polar coordinate that is no longer a 0/0 form. As both of the penalty functions can be derived from the following asymptotically 0/0 function 
                        
                           (C.11)
                           
                              R
                              
                                 (
                                 u
                                 ,
                                 v
                                 )
                              
                              =
                              
                                 
                                    
                                       ‖
                                       
                                          c
                                       
                                       
                                          (
                                          u
                                          )
                                       
                                       −
                                       
                                          b
                                       
                                       
                                          (
                                          v
                                          )
                                       
                                       ‖
                                    
                                 
                                 
                                    
                                       ‖
                                       
                                          
                                             
                                                c
                                             
                                          
                                          
                                             +
                                          
                                          
                                             ′
                                          
                                       
                                       
                                          (
                                          0
                                          )
                                       
                                       u
                                       −
                                       
                                          
                                             
                                                b
                                             
                                          
                                          
                                             +
                                          
                                          
                                             ′
                                          
                                       
                                       
                                          (
                                          0
                                          )
                                       
                                       v
                                       ‖
                                    
                                 
                              
                              =
                              
                                 
                                    
                                       ‖
                                       
                                          c
                                       
                                       
                                          (
                                          u
                                          )
                                       
                                       −
                                       
                                          b
                                       
                                       
                                          (
                                          v
                                          )
                                       
                                       ‖
                                    
                                 
                                 
                                    
                                       
                                          f
                                       
                                       
                                          0
                                       
                                    
                                 
                              
                           
                        
                      that appears in (A.2) in Lemma 1, it suffices to consider this function alone. Similar to (C.6), Taylor-like expansions for 
                        
                           c
                        
                        
                           (
                           u
                           )
                        
                      near 
                        u
                        =
                        0
                      and 
                        
                           b
                        
                        
                           (
                           v
                           )
                        
                      near 
                        v
                        =
                        0
                      read 
                        
                           (C.12)
                           
                              
                                 
                                    c
                                 
                                 
                                    (
                                    u
                                    )
                                 
                                 =
                                 
                                    c
                                 
                                 
                                    (
                                    0
                                    )
                                 
                                 +
                                 
                                    
                                       
                                          c
                                       
                                    
                                    
                                       +
                                    
                                    
                                       ′
                                    
                                 
                                 
                                    (
                                    0
                                    )
                                 
                                 u
                                 +
                                 
                                    
                                       
                                          
                                             
                                                c
                                             
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                    
                                       +
                                    
                                 
                                 
                                    (
                                    0
                                    )
                                 
                                 
                                    
                                       u
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                 ∀
                                 u
                                 ∈
                                 
                                    [
                                    0
                                    ,
                                    ϵ
                                    )
                                 
                              
                           
                           
                              
                                 
                                    b
                                 
                                 
                                    (
                                    v
                                    )
                                 
                                 =
                                 
                                    b
                                 
                                 
                                    (
                                    0
                                    )
                                 
                                 +
                                 
                                    
                                       
                                          b
                                       
                                    
                                    
                                       +
                                    
                                    
                                       ′
                                    
                                 
                                 
                                    (
                                    0
                                    )
                                 
                                 v
                                 +
                                 
                                    
                                       
                                          
                                             
                                                b
                                             
                                          
                                          
                                             ̂
                                          
                                       
                                    
                                    
                                       +
                                    
                                 
                                 
                                    (
                                    0
                                    )
                                 
                                 
                                    
                                       v
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                 ∀
                                 v
                                 ∈
                                 
                                    [
                                    0
                                    ,
                                    ϵ
                                    )
                                 
                              
                           
                        
                      where 
                        
                           
                              
                                 c
                              
                           
                           
                              ̂
                           
                        
                        ,
                        
                           
                              
                                 b
                              
                           
                           
                              ̂
                           
                        
                     , defined analogously to (C.7), can be calculated using the approach stated in Proposition 2. We perform the change of variables 
                        u
                        =
                        r
                        
                        cos
                        ϕ
                        ,
                        
                        v
                        =
                        r
                        
                        sin
                        ϕ
                     . As we consider 
                        0
                        <
                        u
                        ,
                        v
                        <
                        ϵ
                     , we assume that 
                        0
                        <
                        ϕ
                        <
                        π
                        /
                        2
                     . In the form of new variables, dividing both numerator and denominator of 
                        
                           
                              R
                           
                           
                              2
                           
                        
                        
                           (
                           r
                           cos
                           ϕ
                           ,
                           r
                           sin
                           ϕ
                           )
                        
                      by the common term 
                        r
                      we have 
                        
                           (C.13)
                           
                              
                                 
                                    R
                                 
                                 
                                    2
                                 
                              
                              
                                 (
                                 r
                                 cos
                                 ϕ
                                 ,
                                 r
                                 sin
                                 ϕ
                                 )
                              
                              =
                              1
                              +
                              2
                              r
                              
                              
                                 
                                    
                                       〈
                                       
                                          
                                             
                                                
                                                   
                                                      f
                                                   
                                                
                                                
                                                   ̃
                                                
                                             
                                          
                                          
                                             0
                                          
                                       
                                       ,
                                       
                                          
                                             
                                                R
                                             
                                          
                                          
                                             ˜
                                          
                                       
                                       〉
                                    
                                 
                                 
                                    
                                       
                                          
                                             ‖
                                             
                                                
                                                   
                                                      
                                                         
                                                            f
                                                         
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   0
                                                
                                             
                                             ‖
                                          
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              +
                              
                                 
                                    r
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    
                                       〈
                                       
                                          
                                             
                                                R
                                             
                                          
                                          
                                             ˜
                                          
                                       
                                       ,
                                       
                                          
                                             
                                                R
                                             
                                          
                                          
                                             ˜
                                          
                                       
                                       〉
                                    
                                 
                                 
                                    
                                       
                                          
                                             ‖
                                             
                                                
                                                   
                                                      
                                                         
                                                            f
                                                         
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   0
                                                
                                             
                                             ‖
                                          
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                           
                        
                      where 
                        
                           
                              
                                 
                                    
                                       f
                                    
                                 
                                 
                                    ̃
                                 
                              
                           
                           
                              0
                           
                        
                        
                           (
                           r
                           ,
                           ϕ
                           )
                        
                        =
                        
                           
                              
                                 c
                              
                           
                           
                              +
                           
                           
                              ′
                           
                        
                        
                           (
                           0
                           )
                        
                        cos
                        ϕ
                        −
                        
                           
                              
                                 b
                              
                           
                           
                              +
                           
                           
                              ′
                           
                        
                        
                           (
                           0
                           )
                        
                        sin
                        ϕ
                      and 
                        
                           
                              
                                 R
                              
                           
                           
                              ̃
                           
                        
                        
                           (
                           r
                           ,
                           ϕ
                           )
                        
                        =
                        
                           
                              
                                 
                                    
                                       c
                                    
                                 
                                 
                                    ̂
                                 
                              
                           
                           
                              +
                           
                        
                        
                           (
                           0
                           )
                        
                        
                           
                              cos
                           
                           
                              2
                           
                        
                        ϕ
                        −
                        
                           
                              
                                 
                                    
                                       b
                                    
                                 
                                 
                                    ̂
                                 
                              
                           
                           
                              +
                           
                        
                        
                           (
                           0
                           )
                        
                        
                           
                              sin
                           
                           
                              2
                           
                        
                        ϕ
                     . Because of Lemma 1(i), 
                        
                           
                              
                                 ‖
                                 
                                    
                                       
                                          
                                             
                                                f
                                             
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       0
                                    
                                 
                                 
                                    (
                                    r
                                    ,
                                    ϕ
                                    )
                                 
                                 ‖
                              
                           
                           
                              2
                           
                        
                      is bounded away from zero. Thus, the penalty functions can be evaluated using (C.13) and the spline functions 
                        
                           
                              H
                           
                           
                              i
                              ,
                              p
                           
                        
                      analyzed in Proposition 2.

@&#REFERENCES@&#

