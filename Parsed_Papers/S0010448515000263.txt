@&#MAIN-TITLE@&#Support slimming for single material based additive manufacturing

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Optimize the shape of a designed model into a ‘self-supported’ state for AM.


                        
                        
                           
                           Global shape of a model is preserved by minimizing the energy of rigidity.


                        
                        
                           
                           A closed-form solution for minimal rotation to drive the optimization.


                        
                        
                           
                           Tackle the shape optimization problem for reducing supporting structures.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Geometric algorithm

Shape optimization

Design tool

Additive manufacturing

@&#ABSTRACT@&#


               Graphical abstract
               
                  
                     
                        
                           
                        
                     
                  
               
            

@&#INTRODUCTION@&#

AM has emerged as one of the most important methods for realizing the fast fabrication of freeform solids.Stereolithography Apparatus  (SLA) and Fused Deposition Modeling (FDM) are two widely used approaches in AM because they achieve a very good balance between the cost and the quality. Both SLA and FDM fabricate models in a layer-by-layer manner, where supporting structures (also simply called support) need to be added during the manufacturing process. Specifically, the manufacturing material cannot be deposited on a layer where there is insufficient material on the previous layer. For example, the overhangs with a large hanging area can easily collapse under gravity. The problem is solved by adding supports to the originally designed models (Fig. 1
                     ). Recent developments in AM allow us to generate the supporting structures automatically (e.g.,  [1,2]).

When the support is fabricated by a dissolvable material which is different from the one used to print the designed model, the support can be removed automatically by a post-process (Ref.  [4]). However, for those manufacturing techniques with a single material (e.g., SLA and the low-cost FDM machines), the supporting structure poses many problems to users. Firstly, the volume of the support could be large compared to the designed model, which leads to a significant waste of materials, energy and time—our study shows that up to 63.6% of the manufacturing time in FDM could be spent on the fabrication of the support. Although the increase of fabrication time in the Mask-Image Projection based Stereolithography Apparatus (MIP-SLA)  [5] is not significant, because it is proportional only to the number of layers, another problem caused by the supports in single-material AM is common. This is the difficulty in removing the supports automatically. When the support is fabricated in the same material as the design model, it is linked to the model by many thin columns. After fabrication, the support is separated from the main object by being torn away at the top of the columns. This step is always performed manually. More seriously, the surface of the main object is easily damaged by the visual artifacts which are left on its surface (see Fig. 2
                         for an example). Note that although the process of drop-on-powder based AM and Selective Laser Sintering (SLS) is self-supported by the powders, a large group of machines using FDM and SLA suffer from the problem of support.

In the literature of design-for-manufacturing, many applications allow the shape of a model to be adjusted before finalizing the design so that a better manufacturability can be achieved. After designing a shape with the help of modern geometric modeling techniques, designers start to take the ‘self-supportness’ into consideration when they wish to fabricate the physical model by single-material AM. In many cases, designers manually change the shape of a design and then verify the self-supportness by applying the support generation tools. Such a trial-and-error process is tedious and can take up much time and effort. Little research attention has been paid in the literature to the automation of this procedure. In this work, we provide a support slimming optimizer in the design pipeline to help designers to generate better self-supported intermediate models as references for finalizing their designs. A new design pipeline after integrating our shape optimizer is shown in Fig. 3
                        .

We propose a novel shape optimization approach to optimize the shape of a designed model 
                           M
                         into a ‘self-supported’ state for AM (see Fig. 1). The optimizer is formulated on a volumetric mesh 
                           T
                         enclosing 
                           M
                         (Section  3.1). The global shape of 
                           M
                         is preserved by minimizing the energy of rigidity defined on 
                           T
                         (Section  3.2). The benefit of taking the computation on 
                           T
                         is twofold. Firstly, the computation is more efficient and easier to converge when the mesh density of 
                           T
                         is coarser than 
                           M
                        . Secondly, geometric details on 
                           M
                         can be preserved during the optimization. The procedure of optimization is driven by reorienting the tetrahedra with ‘facing-down’ surface facets. Being a major technical contribution of this work, a closed-form solution is derived from the analysis on the Gauss sphere to determine the minimal rotations (Section  4). This work provides a tool (with error control) for manipulating the shape of a designed model to reduce the usage of supporting structures. Our optimizer can be integrated into the design pipeline to relieve the designers from carrying out tedious work (Fig. 3). To the best of our knowledge, this paper is the first one which tackles the shape optimization problem so as to reduce the usage of supporting structures in AM.

@&#RELATED WORKS@&#

Shape and topology optimization techniques have been widely employed in a variety of engineering applications (Ref.  [6,7]). Recently, these techniques have been used in AM applications. For instance, the issue of a model balance for AM has been tackled by Prévost et al. [8] by carving and shape deformation. This approach is followed by a work in  [9] to optimize the moment of inertia for designing a spinnable object. Telea and Jalba  [10] investigated the printability of a model by voxel representation, where regions, bridges, spike and holes which are too thin can be automatically detected. A physically based stress-relief algorithm has been presented in  [11] to automatically detect and modify the areas with high stress by hollowing, thickening and inserting struts to reinforce the strength of the models. Wang et al. [12] tried to generate a skin-frame structure to minimize the volume of manufacturing material and the number of struts. Zhou et al.  [13] have developed a method for determining the worst-load distribution for a shape that will cause high local stress or large deformations so that the shape can be enhanced at those weak regions. Umetani and Schmidt  [14] have proposed a method to determine an optimal printing direction to maximize the mechanical strength of a model fabricated by AM. Lu et al. recently solved a strength-to-weight problem in [15] to relieve the interior stress inside a printed model by introducing optimal honeycomb-cells structures. Although many optimization issues relating to AM have been investigated, how to optimize the shape to reduce the supporting structures is still an open problem which needs to be studied.

The determination of the parting direction for a mold is a typical orientation optimization problem, and it is one that has been studied for decades. Chen  [16] presented an algorithm to determine the parting direction by finding the minimum volume bounding box through fuzzy representation selection. Priyadarshi and Gupta proposed an algorithm in [17] to find the feasible parting directions through the visibility of facets by graphics hardware acceleration. The graphics accelerated hardware was also employed in  [18] to help speed up the search of the feasible mold parting directions. Li et al. proposed a parting line generation algorithm for mesh models in [19]. All these approaches can be regarded as ‘rigid’ orientation optimization techniques that do not change the shape of the models. Our work deforms both the shape and the pose of an input model to slim down its supporting structure for single-material AM.

In the literature, many geometric modeling and processing problems are formulated under the framework of optimization. A good survey can be found in the book by Botsch et al.  [20]. Because the shape optimization taken in this paper is based on a local/global deformation strategy, we review only the related techniques below. Some recent approaches solve the deformation problem based on the as-rigid-as-possible (ARAP) consideration  [21,22], where they preserve the rigidity of every element in the local step and then globally blend the elements together by solving a least-square problem. The position constraints of handles can be enforced by fixing the corresponding variables in the global step. The local/global optimization is also employed in  [23] for solving the mesh parameterization problem. Recently, Kwok and Wang [24] presented an optimization framework for the design automation of human-centric products by solving a mixed-integer ARAP optimization problem. The procedure of local/global ARAP deformation employed in this paper is driven by a novel reorientation scheme to solve the problem of support slimming.

The mission of our optimizer is to deform the input model 
                        M
                      to a shape 
                        
                           
                              M
                           
                           
                              ′
                           
                        
                      by which the supporting structures are reduced and local details are preserved. To achieve this goal, a volumetric mesh 
                        T
                      is employed as the computation domain so that the geometry details can be preserved. The demands placed on the slimming down supports are formulated as reducing the ‘facing-down’ surface facets on 
                        T
                      while minimizing its deformation (see the flowchart shown in Fig. 4
                     ).

To preserve the geometry details on the given model 
                           M
                        , we constructed a tetrahedral mesh 
                           T
                         enclosing 
                           M
                         as the computation domain. Every vertex on 
                           M
                         is encoded with the positions of the tetrahedral vertices on 
                           T
                         by the barycentric coordinate. As a result, when 
                           T
                         is deformed into a new shape, a deformed shape of 
                           M
                         (i.e.,  
                           
                              
                                 M
                              
                              
                                 ′
                              
                           
                        ) can be obtained by applying the barycentric coordinate. When the volumetric mesh 
                           T
                         is coarser than 
                           M
                        , the geometry details on 
                           M
                         can be preserved in the deformation. There are many methods described in the literature for generating a surface mesh to enclose an input surface mesh (e.g.,  [25,26]). After that, the tetrahedral mesh 
                           T
                         can be generated from the enclosing surface mesh  [27].

For a tetrahedral mesh 
                           
                              
                                 C
                              
                              
                                 T
                              
                           
                           =
                           
                              (
                              V
                              ;
                              E
                              ;
                              F
                              ;
                              T
                              )
                           
                        , 
                           V
                           =
                           
                              {
                              
                                 
                                    v
                                 
                                 
                                    i
                                 
                              
                              }
                           
                        , 
                           E
                           =
                           
                              {
                              
                                 
                                    e
                                 
                                 
                                    i
                                    j
                                 
                              
                              }
                           
                        , 
                           F
                           =
                           
                              {
                              
                                 
                                    f
                                 
                                 
                                    i
                                    j
                                    k
                                 
                              
                              }
                           
                        , 
                           T
                           =
                           
                              {
                              
                                 
                                    t
                                 
                                 
                                    i
                                    j
                                    k
                                    l
                                 
                              
                              }
                           
                         are used to denote the sets of vertices, edges, facets and tetrahedrals, respectively. 
                           
                              
                                 
                                    v
                                 
                              
                              
                                 i
                              
                           
                           ∈
                           
                              
                                 
                                    ℜ
                                 
                              
                              
                                 3
                              
                           
                         gives the position of each vertex 
                           
                              
                                 v
                              
                              
                                 i
                              
                           
                        , and 
                           
                              
                                 
                                    
                                       
                                          n
                                       
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 j
                              
                           
                         denotes the normal of a face 
                           
                              
                                 f
                              
                              
                                 j
                              
                           
                        . The faces that are located at the boundary of 
                           T
                         are called surface faces, and the tetrahedra that have at least one surface face are named as surface tetrahedra. The sets of surface faces and tetrahedra are represented by 
                           
                              
                                 F
                              
                              
                                 s
                              
                           
                         and 
                           
                              
                                 T
                              
                              
                                 s
                              
                           
                        . Moreover, all values from the original model are represented with a superscript ‘o’, and those computed from the current status are denoted with a superscript ‘c’.


                        Printing Direction: It is the fabrication direction along which the model is printed layer by layer—denoted by 
                           
                              
                                 
                                    
                                       
                                          d
                                       
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 p
                              
                           
                        . Without the loss of generality, in the rest of this paper we assume that 
                           
                              
                                 
                                    
                                       
                                          d
                                       
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 p
                              
                           
                         is a unit vector.


                        Maximal Self-Supported Angle: An overhanging region that can be printed without adding support is called self-supported. The angle between the region’s tangent plane and the printing direction is called the self-supported angle 
                           α
                        . When different manufacturing materials are used, the AM processes are equipped with different maximal self-supported angles. We define a self-supporting coefficient 
                           τ
                         in our formulation in accordance with the maximal self-supported angle 
                           
                              
                                 α
                              
                              
                                 
                                    max
                                 
                              
                           
                         as 
                           τ
                           =
                           sin
                           
                              (
                              
                                 
                                    α
                                 
                                 
                                    
                                       max
                                    
                                 
                              
                              )
                           
                        .


                        Fixed Region: During the shape optimization, a region of the model is selected to be fixed to serve as the boundary conditions (see the yellow region in Fig. 5
                         as an example). Tetrahedral vertices (both the boundary and the interior ones) in this region are fixed. Users are free to define the parts to be fixed in our approach. Usually, the bottom of a model is selected as the fixed region.


                        Safe Face: The surface face on 
                           
                              
                                 C
                              
                              
                                 T
                              
                           
                         whose normal 
                           
                              
                                 
                                    n
                                 
                              
                              
                                 ˆ
                              
                           
                         satisfies 
                           
                              (1)
                              
                                 
                                    
                                       
                                          n
                                       
                                    
                                    
                                       ˆ
                                    
                                 
                                 ⋅
                                 
                                    
                                       
                                          
                                             
                                                d
                                             
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       p
                                    
                                 
                                 ≥
                                 −
                                 τ
                                 .
                              
                           
                         See the green faces in Fig. 5 for an example. These faces are termed the self-supported faces, and the above inequality on the normals of faces is termed the self-supporting condition.


                        Risky Face: The surface face with 
                           
                              
                                 
                                    n
                                 
                              
                              
                                 ˆ
                              
                           
                           ⋅
                           
                              
                                 
                                    
                                       
                                          d
                                       
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 p
                              
                           
                           <
                           −
                           τ
                        . For example, the orange regions in Fig. 5 are formed by risky faces.

Note that a surface tetrahedron containing no risky face is called a safe tetrahedron. On the other aspect, if one of the surface tetrahedron’s faces is risky, the tetrahedron is also defined as a risky tetrahedron.

The goal of slimming down the support in AM can be interpreted as deforming the given model into a new shape so that it has fewer risky faces. Because the volumetric mesh 
                           
                              
                                 C
                              
                              
                                 T
                              
                           
                         is used as the domain of computation, we convert the problem into the requirement of turning risky faces into safe ones while minimizing the deformation.


                        Deformation Energy: For each tetrahedron 
                           t
                           ∈
                           T
                         with four vertices 
                           
                              
                                 
                                    v
                                 
                              
                              
                                 1
                              
                           
                        , 
                           
                              
                                 
                                    v
                                 
                              
                              
                                 2
                              
                           
                        , 
                           
                              
                                 
                                    v
                                 
                              
                              
                                 3
                              
                           
                         and 
                           
                              
                                 
                                    v
                                 
                              
                              
                                 4
                              
                           
                        , we construct a local frame in 
                           t
                         as
                           
                              (2)
                              
                                 
                                    
                                       
                                          V
                                       
                                    
                                    
                                       t
                                    
                                 
                                 =
                                 
                                    [
                                    
                                       
                                          
                                             v
                                          
                                       
                                       
                                          1
                                       
                                    
                                    −
                                    
                                       
                                          
                                             v
                                          
                                       
                                       
                                          4
                                       
                                    
                                    
                                    
                                       
                                          
                                             v
                                          
                                       
                                       
                                          2
                                       
                                    
                                    −
                                    
                                       
                                          
                                             v
                                          
                                       
                                       
                                          4
                                       
                                    
                                    
                                    
                                       
                                          
                                             v
                                          
                                       
                                       
                                          3
                                       
                                    
                                    −
                                    
                                       
                                          
                                             v
                                          
                                       
                                       
                                          4
                                       
                                    
                                    ]
                                 
                              
                           
                         with 
                           
                              
                                 
                                    v
                                 
                              
                              
                                 4
                              
                           
                         being an interior vertex on the volumetric mesh. This selection of local origin is based on the heuristic that an interior vertex is connected with more tetrahedra. Making it static (as origin) in a local rotation will have less influence on the neighboring tetrahedra. With the help of 
                           
                              
                                 
                                    V
                                 
                              
                              
                                 t
                              
                           
                        , the as-rigid-as-possible (ARAP) energy of a deformed tetrahedral mesh can be defined as 
                           
                              (3)
                              
                                 E
                                 
                                    (
                                    
                                       
                                          C
                                       
                                       
                                          T
                                       
                                       
                                          n
                                          e
                                          w
                                       
                                    
                                    ,
                                    
                                       
                                          C
                                       
                                       
                                          T
                                       
                                       
                                          o
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       t
                                       ∈
                                       T
                                    
                                 
                                 
                                    
                                       w
                                    
                                    
                                       t
                                    
                                 
                                 
                                    
                                       
                                          ‖
                                          
                                             
                                                
                                                   V
                                                
                                             
                                             
                                                t
                                             
                                             
                                                n
                                                e
                                                w
                                             
                                          
                                          −
                                          
                                             
                                                
                                                   L
                                                
                                             
                                             
                                                t
                                             
                                          
                                          
                                             
                                                
                                                   V
                                                
                                             
                                             
                                                t
                                             
                                             
                                                o
                                             
                                          
                                          ‖
                                       
                                    
                                    
                                       F
                                    
                                    
                                       2
                                    
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 
                                    ‖
                                    ⋅
                                    ‖
                                 
                              
                              
                                 F
                              
                           
                         is the Frobenius norm, 
                           
                              
                                 
                                    L
                                 
                              
                              
                                 t
                              
                           
                         is a rigid transformation matrix of the tetrahedron 
                           t
                        , and 
                           
                              
                                 w
                              
                              
                                 t
                              
                           
                         is 
                           t
                        ’s volume that serves as the weight. In the prior work of ARAP deformation, position handles are applied to move some vertices so that an updated shape can be obtained by minimizing the above ARAP energy. The optimization is actually in a least-square form when 
                           
                              
                                 
                                    L
                                 
                              
                              
                                 t
                              
                           
                        s are the constant matrices determined in the local step. Here, we formulate the ARAP energy as Eq. (3) instead of 
                           ∑
                           
                              
                                 w
                              
                              
                                 t
                              
                           
                           
                              
                                 
                                    ‖
                                    
                                       
                                          
                                             L
                                          
                                       
                                       
                                          t
                                       
                                    
                                    
                                       
                                          
                                             V
                                          
                                       
                                       
                                          t
                                       
                                       
                                          n
                                          e
                                          w
                                       
                                    
                                    −
                                    
                                       
                                          
                                             V
                                          
                                       
                                       
                                          t
                                       
                                       
                                          o
                                       
                                    
                                    ‖
                                 
                              
                              
                                 F
                              
                              
                                 2
                              
                           
                        . As a result, the factorization of a linear system can be reused in the subsequent iterations of optimization.


                        Rigid Transformation: The local step for obtaining 
                           
                              
                                 
                                    L
                                 
                              
                              
                                 t
                              
                           
                         plays a very important role in our formulation. 
                           
                              •
                              In the prior ARAP work, the rigid transformation from the original shape 
                                    
                                       
                                          
                                             V
                                          
                                       
                                       
                                          t
                                       
                                       
                                          o
                                       
                                    
                                  of a tetrahedron 
                                    t
                                  to its current shape 
                                    
                                       
                                          
                                             V
                                          
                                       
                                       
                                          t
                                       
                                       
                                          c
                                       
                                    
                                  is determined by using a “signed version” of the singular value decomposition (SVD) on the affine transformation matrix 
                                    
                                       Q
                                    
                                    =
                                    
                                       
                                          
                                             V
                                          
                                       
                                       
                                          t
                                       
                                       
                                          c
                                       
                                    
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   
                                                      V
                                                   
                                                
                                                
                                                   t
                                                
                                                
                                                   o
                                                
                                             
                                             )
                                          
                                       
                                       
                                          −
                                          1
                                       
                                    
                                  (Ref.  [22]). That is, 
                                    
                                       Q
                                    
                                    =
                                    
                                       U
                                    
                                    Σ
                                    
                                       
                                          
                                             W
                                          
                                       
                                       
                                          T
                                       
                                    
                                 , where 
                                    Σ
                                  is a diagonal matrix with all elements being positive. 
                                    Σ
                                  defines the scaling factors in three orthogonal directions in 
                                    
                                       Q
                                    
                                 . As a result, 
                                    
                                       Q
                                    
                                  can be turned into a rigid transformation 
                                    
                                       M
                                    
                                    =
                                    
                                       U
                                    
                                    
                                       
                                          
                                             W
                                          
                                       
                                       
                                          T
                                       
                                    
                                 .

Applying 
                                    
                                       M
                                    
                                  to a tetrahedron 
                                    t
                                  will transform it to an orientation that best approximates to the current shape of 
                                    t
                                 . A transformed surface tetrahedron may contain some risky faces, and these need to be turned into safe ones by applying an additional rotation 
                                    
                                       R
                                    
                                 . Basically, an ideal rotation turns all risky faces on a tetrahedron into safe ones while conducting a rotation with a minimal rotational angle. The method for solving this problem will be presented in Section  4. Specifically, after determining a minimal rotation angle 
                                    θ
                                  and its corresponding rotation axis 
                                    
                                       
                                          
                                             r
                                          
                                       
                                       
                                          ˆ
                                       
                                    
                                 , 
                                    
                                       R
                                    
                                    
                                       (
                                       
                                          
                                             
                                                r
                                             
                                          
                                          
                                             ˆ
                                          
                                       
                                       ,
                                       θ
                                       )
                                    
                                  can be obtained  [28]. For those safe tetrahedra and the interior tetrahedra, 
                                    
                                       R
                                    
                                    
                                       (
                                       
                                          
                                             
                                                r
                                             
                                          
                                          
                                             ˆ
                                          
                                       
                                       ,
                                       θ
                                       )
                                    
                                    =
                                    
                                       I
                                    
                                 .


                        Procedure of Optimization: We iteratively apply the local and then the global steps on the volumetric mesh 
                           
                              
                                 C
                              
                              
                                 T
                              
                           
                         to reduce the number of risky faces. 
                           
                              •
                              Step (1): For each tetrahedron, the rigid transformation 
                                    
                                       M
                                    
                                  between its current position/shape and the given position/shape is computed.

Step (2): For each risky tetrahedron, a minimal rotation 
                                    
                                       R
                                    
                                    
                                       (
                                       
                                          
                                             
                                                r
                                             
                                          
                                          
                                             ˆ
                                          
                                       
                                       ,
                                       θ
                                       )
                                    
                                  is computed to convert it into a safe one (see Section  4). As a result, 
                                    
                                       
                                          
                                             L
                                          
                                       
                                       
                                          t
                                       
                                    
                                  is obtained for all tetrahedra.

Step (3): A least-square solution for the new position/shape of the volumetric mesh is obtained by minimizing the deformation energy (Eq. (3)).

Step (4): Go back to step (1) until the terminal condition is reached.

Served as the core of our shape optimization approach, the computation of minimal rotation is formulated in a closed-form in this section.


                     Problem Definition: Given a tetrahedron 
                        t
                        ∈
                        
                           
                              T
                           
                           
                              s
                           
                        
                      with four faces 
                        
                           {
                           
                              
                                 f
                              
                              
                                 i
                              
                           
                           }
                        
                        
                        
                           (
                           i
                           =
                           1
                           ,
                           …
                           ,
                           4
                           )
                        
                      and their corresponding normals as 
                        
                           {
                           
                              
                                 
                                    
                                       
                                          n
                                       
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 i
                              
                           
                           }
                        
                     , the minimal rotation is defined as 
                        
                           (4)
                           
                              
                                 
                                    
                                    
                                       arg
                                       
                                          
                                             min
                                          
                                          
                                             
                                                
                                                   
                                                      r
                                                   
                                                
                                                
                                                   ˆ
                                                
                                             
                                             ,
                                             θ
                                          
                                       
                                       
                                          
                                             
                                                ‖
                                                
                                                   R
                                                
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            r
                                                         
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                   ,
                                                   θ
                                                   )
                                                
                                                −
                                                
                                                   I
                                                
                                                ‖
                                             
                                          
                                          
                                             g
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 
                                    
                                       s
                                       .
                                       t
                                       .
                                       ,
                                    
                                    
                                       ∀
                                       
                                          
                                             f
                                          
                                          
                                             i
                                          
                                       
                                       ∈
                                       
                                          
                                             F
                                          
                                          
                                             s
                                          
                                       
                                       ,
                                       
                                       
                                          (
                                          
                                             R
                                          
                                          
                                             (
                                             
                                                
                                                   
                                                      r
                                                   
                                                
                                                
                                                   ˆ
                                                
                                             
                                             ,
                                             θ
                                             )
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         n
                                                      
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                i
                                             
                                          
                                          )
                                       
                                       ⋅
                                       
                                          
                                             
                                                
                                                   
                                                      d
                                                   
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             p
                                          
                                       
                                       ≥
                                       −
                                       τ
                                    
                                 
                              
                           
                        
                      where 
                        
                           
                              
                                 ‖
                                 ⋅
                                 ‖
                              
                           
                           
                              g
                           
                        
                      is a general matrix norm to measure how significantly 
                        
                           R
                        
                        
                           (
                           
                              
                                 
                                    r
                                 
                              
                              
                                 ˆ
                              
                           
                           ,
                           θ
                           )
                        
                      deviates from 
                        
                           I
                        
                     .

Directly solving this problem by constrained nonlinear optimization is tedious and time-consuming. The problem is a pure rotation issue. Therefore, we analyze it on the Gauss sphere to find a compact solution.

For a risky tetrahedron in 
                           
                              
                                 R
                              
                              
                                 3
                              
                           
                        , the unit normal vectors of its four faces can be considered as four points on the Gauss sphere 
                           
                              
                                 S
                              
                              
                                 2
                              
                           
                        . Meanwhile, the unit vector 
                           
                              
                                 
                                    
                                       
                                          d
                                       
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 p
                              
                           
                         of the printing direction is also mapped to a point on 
                           
                              
                                 S
                              
                              
                                 2
                              
                           
                        . Without a loss of generality, 
                           
                              
                                 
                                    
                                       
                                          d
                                       
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 p
                              
                           
                         is assumed to be the top point of the Gauss sphere (i.e.,  
                           
                              
                                 
                                    
                                       
                                          d
                                       
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 p
                              
                           
                           =
                           
                              (
                              0
                              ,
                              0
                              ,
                              1
                              )
                           
                        ). Now the condition of self-supporting for a surface face (Eq. (1)) can be interpreted as that the normal 
                           
                              
                                 
                                    n
                                 
                              
                              
                                 ˆ
                              
                           
                         must be located at the half-space 
                           
                              
                                 H
                              
                              
                                 p
                              
                           
                         above/on the plane 
                           z
                           =
                           −
                           τ
                        . As illustrated in Fig. 6
                        (a), a risky tetrahedron may have a few surface faces that are not self-supported. When this situation occurs, we can apply a rotation on the normal vectors to move them into the safe region (i.e., inside 
                           
                              
                                 H
                              
                              
                                 p
                              
                           
                        ). The rotation is actually 
                           
                              R
                           
                           
                              (
                              
                                 
                                    
                                       r
                                    
                                 
                                 
                                    ˆ
                                 
                              
                              ,
                              θ
                              )
                           
                         used in Eq. (4), where a minimal rotation angle 
                           θ
                         is demanded.

When there is more than one risky face on a tetrahedron, determining a minimal rotation to move all points (corresponding to the normals on risky faces) into the feasible region 
                           
                              
                                 H
                              
                              
                                 p
                              
                           
                         is not straightforward—see Fig. 6(a). To solve this problem, a dual representation of 
                           
                              
                                 H
                              
                              
                                 p
                              
                           
                         is defined as follows.


                        Dual-Feasible-Region (DFR): The self-supporting condition for a surface face with normal 
                           
                              
                                 
                                    n
                                 
                              
                              
                                 ˆ
                              
                           
                         (i.e., Eq. (1)) can be considered as requesting 
                           
                              
                                 
                                    
                                       
                                          d
                                       
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 p
                              
                           
                         to be located at the same side of 
                           
                              
                                 
                                    n
                                 
                              
                              
                                 ˆ
                              
                           
                         with reference to the plane: 
                           x
                           
                              
                                 
                                    
                                       
                                          n
                                       
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 x
                              
                           
                           +
                           y
                           
                              
                                 
                                    
                                       
                                          n
                                       
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 y
                              
                           
                           +
                           z
                           
                              
                                 
                                    
                                       
                                          n
                                       
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 z
                              
                           
                           +
                           τ
                           =
                           0
                        . Therefore, a DFR of 
                           
                              
                                 
                                    
                                       
                                          d
                                       
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 p
                              
                           
                         for 
                           
                              
                                 
                                    n
                                 
                              
                              
                                 ˆ
                              
                           
                         can be defined by the half-space 
                           
                              (5)
                              
                                 
                                    
                                       H
                                    
                                    
                                       
                                          
                                             
                                                n
                                             
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                 
                                 =
                                 
                                    {
                                    
                                       p
                                    
                                    
                                    |
                                    
                                    ∀
                                    
                                       p
                                    
                                    ∈
                                    
                                       
                                          S
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    
                                       p
                                    
                                    ⋅
                                    
                                       
                                          
                                             n
                                          
                                       
                                       
                                          ˆ
                                       
                                    
                                    +
                                    τ
                                    ≥
                                    0
                                    }
                                 
                                 .
                              
                           
                         Thus, the self-supporting condition becomes 
                           
                              
                                 
                                    
                                       
                                          d
                                       
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 p
                              
                           
                           ∈
                           
                              
                                 H
                              
                              
                                 
                                    
                                       
                                          n
                                       
                                    
                                    
                                       ˆ
                                    
                                 
                              
                           
                        .


                        Inverse Rotation: Rotating 
                           
                              
                                 
                                    n
                                 
                              
                              
                                 ˆ
                              
                           
                         by 
                           θ
                         around the axis 
                           
                              
                                 
                                    r
                                 
                              
                              
                                 ˆ
                              
                           
                         is equivalent to inversely rotating
                           
                              
                                 
                                    
                                       
                                          d
                                       
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 p
                              
                           
                         with the angle 
                           
                              (
                              −
                              θ
                              )
                           
                         around the same axis. As a result, the minimal angle can be determined by rotating 
                           
                              
                                 
                                    
                                       
                                          d
                                       
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 p
                              
                           
                         into the DFR of 
                           
                              
                                 
                                    n
                                 
                              
                              
                                 ˆ
                              
                           
                        . Specifically, for a surface tetrahedron 
                           t
                         with 
                           m
                         surface faces (
                           m
                           >
                           1
                        ), we can inversely rotate 
                           
                              
                                 
                                    
                                       
                                          d
                                       
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 p
                              
                           
                         into the common area defined by the DFRs of these faces—that is 
                           
                              
                                 H
                              
                              
                                 t
                              
                           
                           =
                           
                              
                                 H
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                n
                                             
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                              
                           
                           ∩
                           ⋯
                           ∩
                           
                              
                                 H
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                n
                                             
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       m
                                    
                                 
                              
                           
                         (see Fig. 6(b)).

Methods for determining the minimal angle (by inverse rotation) in different configurations are presented below. Cases of tetrahedra with one and two surface faces are discussed. We found only a very few cases with three surface faces in our tests. For such cases, the configuration space on the Gauss sphere is divided into eight regions. This makes the closed-form formulation of minimal rotation very tedious. To have an easy-to-implement approach, a tetrahedron 
                           t
                         with more than two surface faces is split into four tetrahedra by inserting a new vertex at the middle of 
                           t
                        , and this will not affect 
                           t
                        ’s neighboring tetrahedra.

For the case of a tetrahedron 
                           t
                         with only one surface face 
                           f
                         whose normal is 
                           
                              
                                 
                                    n
                                 
                              
                              
                                 ˆ
                              
                           
                        , if the self-supporting condition (Eq. (1)) is not satisfied on 
                           f
                        , the point 
                           
                              
                                 
                                    
                                       
                                          d
                                       
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 p
                              
                           
                         must fall outside the feasible region 
                           
                              
                                 H
                              
                              
                                 
                                    
                                       
                                          n
                                       
                                    
                                    
                                       ˆ
                                    
                                 
                              
                           
                        . The minimal inverse rotation that moves 
                           
                              
                                 
                                    
                                       
                                          d
                                       
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 p
                              
                           
                         back into 
                           
                              
                                 H
                              
                              
                                 
                                    
                                       
                                          n
                                       
                                    
                                    
                                       ˆ
                                    
                                 
                              
                           
                         can be determined by projecting 
                           
                              
                                 
                                    
                                       
                                          d
                                       
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 p
                              
                           
                         onto the plane of 
                           
                              
                                 H
                              
                              
                                 
                                    
                                       
                                          n
                                       
                                    
                                    
                                       ˆ
                                    
                                 
                              
                           
                         and then normalizing it to the unit vector 
                           
                              
                                 
                                    
                                       
                                          d
                                       
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 p
                              
                              
                                 ′
                              
                           
                        . Here 
                           
                              
                                 
                                    
                                       
                                          d
                                       
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 p
                              
                              
                                 ′
                              
                           
                         is the closest point to 
                           
                              
                                 
                                    
                                       
                                          d
                                       
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 p
                              
                           
                         in 
                           
                              
                                 H
                              
                              
                                 
                                    
                                       
                                          n
                                       
                                    
                                    
                                       ˆ
                                    
                                 
                              
                           
                        . Thus, the minimal rotation axis is 
                           
                              r
                           
                           =
                           
                              
                                 
                                    
                                       
                                          d
                                       
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 p
                              
                              
                                 ′
                              
                           
                           ×
                           
                              
                                 
                                    
                                       
                                          d
                                       
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 p
                              
                           
                         and the rotation angle 
                           θ
                           =
                           arccos
                           
                              (
                              
                                 
                                    
                                       
                                          
                                             d
                                          
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    p
                                 
                              
                              ⋅
                              
                                 
                                    
                                       
                                          
                                             d
                                          
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    p
                                 
                                 
                                    ′
                                 
                              
                              )
                           
                        . (See Fig. 7
                        .)

For the case that a tetrahedron 
                           t
                         has two surface faces 
                           
                              
                                 f
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 f
                              
                              
                                 2
                              
                           
                         (with 
                           
                              
                                 
                                    
                                       
                                          n
                                       
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 
                                    
                                       
                                          n
                                       
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 2
                              
                           
                         as their normals respectively), we present a closed-form solution of the minimal rotation below. Again, the analysis is performed with the help of the DFRs and the inverse rotation. Specifically, the Gauss sphere is decomposed into five regions with respect to 
                           
                              
                                 H
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                n
                                             
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                              
                           
                         and 
                           
                              
                                 H
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                n
                                             
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                              
                           
                        , where different regions lead to different configurations of minimal rotation. The yellow part is the feasible region 
                           
                              
                                 H
                              
                              
                                 t
                              
                           
                        . The boundaries of the configuration regions are formed by five planes (see the illustration in Fig. 8
                        ). Two planes, 
                           
                              
                                 
                                    P
                                 
                              
                              
                                 ⊥
                                 
                                    
                                       
                                          
                                             
                                                n
                                             
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                              
                           
                         and 
                           
                              
                                 
                                    P
                                 
                              
                              
                                 ⊥
                                 
                                    
                                       
                                          
                                             
                                                n
                                             
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                              
                           
                         passing through the corner points of 
                           
                              
                                 H
                              
                              
                                 t
                              
                           
                         are perpendicular to 
                           
                              
                                 
                                    P
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                n
                                             
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                              
                           
                         and 
                           
                              
                                 
                                    P
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                n
                                             
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                              
                           
                         respectively. The plane 
                           
                              
                                 
                                    P
                                 
                              
                              
                                 A
                                 C
                              
                           
                         passing through the origin is perpendicular to the vector 
                           
                              
                                 
                                    ca
                                 
                              
                              
                                 ˆ
                              
                           
                        , which splits the region into two halves. Equations of the five planes help to define five half-spaces, as follows: 
                           
                              (6)
                              
                                 
                                    
                                       
                                          
                                             
                                                H
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               n
                                                            
                                                         
                                                         
                                                            ˆ
                                                         
                                                      
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                          =
                                          
                                             {
                                             
                                                p
                                             
                                             
                                             |
                                             
                                             ∀
                                             
                                                p
                                             
                                             ∈
                                             
                                                
                                                   S
                                                
                                                
                                                   2
                                                
                                             
                                             ,
                                             
                                                
                                                   
                                                      
                                                         
                                                            n
                                                         
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                
                                                
                                                   1
                                                
                                             
                                             ⋅
                                             
                                                p
                                             
                                             +
                                             τ
                                             ≥
                                             0
                                             }
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                H
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               n
                                                            
                                                         
                                                         
                                                            ˆ
                                                         
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          =
                                          
                                             {
                                             
                                                p
                                             
                                             
                                             |
                                             
                                             ∀
                                             
                                                p
                                             
                                             ∈
                                             
                                                
                                                   S
                                                
                                                
                                                   2
                                                
                                             
                                             ,
                                             
                                                
                                                   
                                                      
                                                         
                                                            n
                                                         
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                             ⋅
                                             
                                                p
                                             
                                             +
                                             τ
                                             ≥
                                             0
                                             }
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                H
                                             
                                             
                                                A
                                                C
                                             
                                          
                                          =
                                          
                                             {
                                             
                                                p
                                             
                                             
                                             |
                                             
                                             ∀
                                             
                                                p
                                             
                                             ∈
                                             
                                                
                                                   S
                                                
                                                
                                                   2
                                                
                                             
                                             ,
                                             
                                                
                                                   
                                                      ca
                                                   
                                                
                                                
                                                   ˆ
                                                
                                             
                                             ⋅
                                             
                                                p
                                             
                                             ≥
                                             0
                                             }
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                H
                                             
                                             
                                                ⊥
                                                
                                                   
                                                      
                                                         
                                                            
                                                               n
                                                            
                                                         
                                                         
                                                            ˆ
                                                         
                                                      
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                          =
                                          
                                             {
                                             
                                                p
                                             
                                             
                                             |
                                             
                                             ∀
                                             
                                                p
                                             
                                             ∈
                                             
                                                
                                                   S
                                                
                                                
                                                   2
                                                
                                             
                                             ,
                                             
                                                (
                                                
                                                   
                                                      
                                                         ca
                                                      
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                                ×
                                                
                                                   
                                                      
                                                         
                                                            
                                                               n
                                                            
                                                         
                                                         
                                                            ˆ
                                                         
                                                      
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                             
                                             ⋅
                                             
                                                p
                                             
                                             +
                                             d
                                             ≥
                                             0
                                             }
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                H
                                             
                                             
                                                ⊥
                                                
                                                   
                                                      
                                                         
                                                            
                                                               n
                                                            
                                                         
                                                         
                                                            ˆ
                                                         
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          =
                                          
                                             {
                                             
                                                p
                                             
                                             
                                             |
                                             
                                             ∀
                                             
                                                p
                                             
                                             ∈
                                             
                                                
                                                   S
                                                
                                                
                                                   2
                                                
                                             
                                             ,
                                             
                                                (
                                                
                                                   
                                                      
                                                         
                                                            
                                                               n
                                                            
                                                         
                                                         
                                                            ˆ
                                                         
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                                ×
                                                
                                                   
                                                      
                                                         ca
                                                      
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                                )
                                             
                                             ⋅
                                             
                                                p
                                             
                                             +
                                             d
                                             ≥
                                             0
                                             }
                                          
                                       
                                    
                                 
                              
                           
                         where 
                           
                              
                                 
                                    ca
                                 
                              
                              
                                 ˆ
                              
                           
                           =
                           
                              (
                              
                                 
                                    
                                       
                                          
                                             n
                                          
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    1
                                 
                              
                              ×
                              
                                 
                                    
                                       
                                          
                                             n
                                          
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                              )
                           
                           /
                           
                              ‖
                              
                                 
                                    
                                       
                                          
                                             n
                                          
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    1
                                 
                              
                              ×
                              
                                 
                                    
                                       
                                          
                                             n
                                          
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                              ‖
                           
                         and 
                           d
                           =
                           τ
                           
                              ‖
                              
                                 
                                    
                                       
                                          
                                             n
                                          
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    1
                                 
                              
                              ×
                              
                                 
                                    
                                       
                                          
                                             n
                                          
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                              ‖
                           
                           /
                           
                              (
                              1
                              +
                              
                                 
                                    
                                       
                                          
                                             n
                                          
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    1
                                 
                              
                              ⋅
                              
                                 
                                    
                                       
                                          
                                             n
                                          
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                              )
                           
                        .


                        Configuration I: When 
                           
                              
                                 
                                    
                                       
                                          d
                                       
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 p
                              
                           
                           ∈
                           
                              
                                 
                                    
                                       H
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      n
                                                   
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                              
                              ¯
                           
                           ∩
                           
                              
                                 H
                              
                              
                                 ⊥
                                 
                                    
                                       
                                          
                                             
                                                n
                                             
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                              
                           
                        , the minimal inverse rotation moves 
                           
                              
                                 
                                    
                                       
                                          d
                                       
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 p
                              
                           
                         onto the arc 
                           
                              
                                 A
                                 D
                                 C
                              
                              
                                 ̂
                              
                           
                         (see the blue region in Fig. 9
                        (a)). Here, 
                           
                              
                                 H
                              
                              ¯
                           
                         denotes a complementary set of 
                           H
                        . To realize that, we project 
                           
                              
                                 
                                    
                                       
                                          d
                                       
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 p
                              
                           
                         onto the plane 
                           
                              
                                 
                                    P
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                n
                                             
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       1
                                    
                                 
                              
                           
                         and normalize it to a unit vector 
                           
                              
                                 
                                    
                                       
                                          d
                                       
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 p
                              
                              
                                 ′
                              
                           
                        . As a result, the rotation axis for turning risky faces safe is 
                           
                              r
                           
                           =
                           
                              
                                 
                                    
                                       
                                          d
                                       
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 p
                              
                              
                                 ′
                              
                           
                           ×
                           
                              
                                 
                                    
                                       
                                          d
                                       
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 p
                              
                           
                         with the angle 
                           θ
                           =
                           arccos
                           
                              (
                              
                                 
                                    
                                       
                                          
                                             d
                                          
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    p
                                 
                                 
                                    ′
                                 
                              
                              ⋅
                              
                                 
                                    
                                       
                                          
                                             d
                                          
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    p
                                 
                              
                              )
                           
                        . Note that, in all the configurations below, 
                           
                              r
                           
                         and 
                           θ
                         can be determined in the same way after obtaining 
                           
                              
                                 
                                    
                                       
                                          d
                                       
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 p
                              
                              
                                 ′
                              
                           
                        .


                        Configuration II: This configuration occurs when 
                           
                              
                                 
                                    
                                       
                                          d
                                       
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 p
                              
                           
                           ∈
                           
                              
                                 
                                    
                                       H
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      n
                                                   
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                              
                              ¯
                           
                           ∩
                           
                              
                                 H
                              
                              
                                 ⊥
                                 
                                    
                                       
                                          
                                             
                                                n
                                             
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                              
                           
                         (i.e., falling in the green region shown in Fig. 9(b)). We then project 
                           
                              
                                 
                                    
                                       
                                          d
                                       
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 p
                              
                           
                         onto the plane 
                           
                              
                                 
                                    P
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                n
                                             
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                              
                           
                         and normalize it to 
                           
                              
                                 
                                    
                                       
                                          d
                                       
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 p
                              
                              
                                 ′
                              
                           
                        , which actually moves 
                           
                              
                                 
                                    
                                       
                                          d
                                       
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 p
                              
                           
                         onto the arc 
                           
                              
                                 A
                                 B
                                 C
                              
                              
                                 ̂
                              
                           
                        .


                        Configuration III: The respective region of this configuration is 
                           
                              
                                 H
                              
                              
                                 A
                                 C
                              
                           
                           ∩
                           
                              
                                 
                                    
                                       H
                                    
                                    
                                       ⊥
                                       
                                          
                                             
                                                
                                                   
                                                      n
                                                   
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                              
                              ¯
                           
                           ∩
                           
                              
                                 
                                    
                                       H
                                    
                                    
                                       ⊥
                                       
                                          
                                             
                                                
                                                   
                                                      n
                                                   
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                              
                              ¯
                           
                         (the red region shown in Fig. 9(c)). If 
                           
                              
                                 
                                    
                                       
                                          d
                                       
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 p
                              
                           
                         falls in this configuration, the closest point in the feasible region 
                           
                              
                                 H
                              
                              
                                 t
                              
                           
                         is the point 
                           A
                        . The position of 
                           A
                         can be computed by the planes. We then assign the position of 
                           A
                         to 
                           
                              
                                 
                                    
                                       
                                          d
                                       
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 p
                              
                              
                                 ′
                              
                           
                        .


                        Configuration IV: This is 
                           
                              
                                 
                                    
                                       
                                          d
                                       
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 p
                              
                           
                           ∈
                           
                              
                                 
                                    
                                       H
                                    
                                    
                                       A
                                       C
                                    
                                 
                              
                              ¯
                           
                           ∩
                           
                              
                                 
                                    
                                       H
                                    
                                    
                                       ⊥
                                       
                                          
                                             
                                                
                                                   
                                                      n
                                                   
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                              
                              ¯
                           
                           ∩
                           
                              
                                 
                                    
                                       H
                                    
                                    
                                       ⊥
                                       
                                          
                                             
                                                
                                                   
                                                      n
                                                   
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                              
                              ¯
                           
                         (the purple region in Fig. 9(d)). In 
                           
                              
                                 H
                              
                              
                                 t
                              
                           
                        , the closest point to 
                           
                              
                                 
                                    
                                       
                                          d
                                       
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 p
                              
                           
                         is point 
                           C
                        . Thus, its position is assigned as 
                           
                              
                                 
                                    
                                       
                                          d
                                       
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 p
                              
                              
                                 ′
                              
                           
                         to compute the minimal rotation along the axis 
                           
                              r
                           
                           =
                           
                              
                                 
                                    
                                       
                                          d
                                       
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 p
                              
                              
                                 ′
                              
                           
                           ×
                           
                              
                                 
                                    
                                       
                                          d
                                       
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 p
                              
                           
                         with the angle 
                           θ
                           =
                           arccos
                           
                              (
                              
                                 
                                    
                                       
                                          
                                             d
                                          
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    p
                                 
                                 
                                    ′
                                 
                              
                              ⋅
                              
                                 
                                    
                                       
                                          
                                             d
                                          
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    p
                                 
                              
                              )
                           
                        .

By the configuration analysis above, we solve the problem of minimal rotation in a closed-form instead of non-linear optimization. Meanwhile, the global step is a pre-factorized least-square problem. As a result, each iteration of the optimization procedure can be evaluated very efficiently.

@&#RESULTS AND DISCUSSION@&#

The approach proposed in this paper has been implemented by C++ together with the Eigen library  [29] as the numerical solver. All the tests below are taken on an Intel Core i7-3770 3.40 GHz computer with 8 GB RAM. Our current implementation does not use the multi-core acceleration. The approach has been tested with several models, and all the results are encouraging.

@&#EXPERIMENTAL RESULTS@&#

Our first example is the Dino model which was shown in Fig. 1. In this optimization, we set the maximal self-supported angle 
                           
                              
                                 α
                              
                              
                                 
                                    max
                                 
                              
                           
                           =
                           0
                        . As a result of shape optimization, the Dino ‘raises up’ its head and arms. Local details of the bone structures are well-preserved. The original and optimized models have been tested on two different types of AM machines–the MIP-SLA and the Fortus 360mc FDM–where the supporting structures for MIP-SLA are generated by the region subtraction method  [2] and the support for FDM is generated by the software delivered together with the Fortus machine. The second example is the Armadillo model. Fig. 10
                         shows the result of shape optimization on this example, where Armadillo ‘raises up’ its arms and ‘pulls down’ its tail. Quantitative measurements of these two examples are given in Table 1
                         for the purpose of comparison.

In both MIP-SLA and FDM, the material usage for the support has been greatly reduced. Because the fabrication time of FDM is proportional to the total materials usage, slimming down the support will significantly improve the efficiency of the fabrication as well. Note that this will benefit not only the FDM printing with single material but also the advanced FDM using dissolvable material in supports. The time of fabrication in MIP-SLA depends on the number of total layers of a model. Therefore, slimming down the support will not speed up the MIP-SLA printing. However, another important aspect of MIP-SLA benefited by this work is the surface quality of finished model. The supporting structures and the main model are linked by a few anchor points (AP). After removing the supports in a post-process, in place of the APs some artifacts usually appear (Fig. 2). The number of APs on the optimized Dino is reduced from 61 to 18, and the number of APs on the optimized Armadillo model is reduced to 
                           1
                           /
                           16
                         of the original input with 32 APs. Three more examples are shown in Fig. 11
                        .

We also study the performance and the convergency of the shape optimization algorithm. The statistics about the computation of different models are given in Table 2
                        , where the total time of 100 iterations is reported. Note that the majority of the time is spent on the local steps for computing SVD and minimal rotation. The equation system of the global blending step needs only to be factorized in the first step, and the factorization can be reused in the subsequent steps where the substitution can be computed very efficiently. To further investigate the convergency of our shape optimization algorithm, we track the number of risky faces during the computation. As shown in Fig. 12
                        , the number of risky faces keeps dropping in all the examples (although this may not be monotonically).

It is obvious that having more vertices on the volumetric mesh leads to longer computing time. On the other hand, a volumetric mesh with too coarse a resolution will give a large shape approximation error. Therefore, we usually employ a mesh with less than 
                           5
                           k
                         vertices, and this results in a good trade-off between speed and quality.

Our optimization approach provides a basic tool for realizing the more interesting applications. Two examples, (1) support slimming with shape control and (2) searching for the optimal printing direction, are presented in this section.


                        Shape Control in Optimization
                     

In many cases, the designers may not wish to change the shape of a model too much during the optimization for support slimming. This can be realized by adding a penalty factor 
                           β
                        , which is an angle between 
                           
                              
                                 0
                              
                              
                                 ∘
                              
                           
                         and 
                           9
                           
                              
                                 0
                              
                              
                                 ∘
                              
                           
                        . Specifically, 
                           
                              
                                 
                                    L
                                 
                              
                              
                                 t
                              
                           
                           =
                           
                              R
                           
                           
                              (
                              
                                 
                                    
                                       r
                                    
                                 
                                 
                                    ˆ
                                 
                              
                              ,
                              
                                 
                                    θ
                                 
                                 
                                    ′
                                 
                              
                              )
                           
                           
                              M
                           
                         is employed in the shape optimization as the transformation, where 
                           
                              (7)
                              
                                 
                                    
                                       θ
                                    
                                    
                                       ′
                                    
                                 
                                 =
                                 max
                                 
                                    (
                                    θ
                                    −
                                    β
                                    ,
                                    0
                                    )
                                 
                                 .
                              
                           
                         As a result, when a large 
                           β
                         is employed, many of the risky faces will not be rotated (in the cases that 
                           θ
                         determined by the local minimal rotation is less than 
                           β
                        ). As shown in Fig. 13
                        , different values of 
                           β
                         result in different degrees of deformations in the shape optimization for support slimming. In practice, the penalty factor is used together with two metrics for shape deviation: 
                           
                              •
                              
                                 Maximal Node Deviation Ratio (MNDR): This metric evaluates the maximal displacement at the vertices of the input mesh model 
                                    M
                                  with respect to the diagonal length of 
                                    M
                                 ’s bounding box.


                                 Average Node Deviation Ratio (ANDR): This measures the average displacement at all the vertices of 
                                    M
                                  with respect to the diagonal length of 
                                    M
                                 ’s bounding box.


                        Searching for Optimal Printing Direction
                     

The printing direction is usually chosen empirically by users in accordance with the features on an input model or simply assigned in the bottom-up direction. However, for some models such as the running Armadillo model shown in Fig. 14
                        , it is not easy to find a heuristic printing direction. Our approach can be employed in the inner loop as a tool to search for an optimal printing direction. Here the optimal printing direction is defined as a direction that leads to the minimal number of anchor points (APs) linking supports to the main model (Ref.  [2]). That means we wish to introduce minimal damage during the post-process to remove the supports. We iteratively rotate the input model along the 
                           x
                        - and 
                           y
                        -axes with a constant angle. For each new orientation, we apply the optimization approach followed by the support generation algorithm, on the result of which the number of APs is counted. Among all the discretely spanned orientations, the one with the minimal AP is finally chosen as an optimal printing direction (see Fig. 14 for an example).

Although our approach can successfully optimize the shape of given models to slim down the supporting structure, it also has some limitations. First of all, our optimizer is based on the assumption that the shape of the original model can be changed. For some applications in which the original model cannot be deformed, our optimizer is not able to help. Secondly, because we set the goal of optimization only at slimming down the supporting structure, the model cannot be converted into a fully self-supported shape. On the other aspect, self-supportiveness usually needs to be considered at the very beginning of the design process. One of the related works can be found in  [30]. Thirdly, our support slimming work does not consider the surface damaged on the safe faces by adding supports for the risky faces exactly above them. Lastly, the volumetric meshes which are coarser than the input mesh models are used as the computational domain in our approach to preserve the geometric details. On the downside, this also neglects the overhangs inside a safe tetrahedron. We will consider these factors by investigating a method for computing the minimal rotation in more complex configurations. Specifically, multiple faces on the input mesh 
                           M
                         inside a tetrahedron will be employed to construct the DFR on the Gauss sphere. We will study this in our future work.

The success of shape optimization on a coarser volumetric mesh 
                           
                              
                                 C
                              
                              
                                 T
                              
                           
                         relies on the error between mesh surface of the given model and the boundary of 
                           
                              
                                 C
                              
                              
                                 T
                              
                           
                        ; the smaller the better. When a very coarse mesh is employed, the ‘optimized’ shape computed from the volumetric mesh may have more risky faces before computation. We prevent such cases by checking the number of risky faces after each iteration, and always store the best result among the past steps of iteration. How to generate a volumetric mesh bounding the input model more tightly has been beyond the scope of this paper. We consider it to be a work which needs to be taken in the future.

Because the computational domain of our optimization framework is a coarse volumetric mesh, local/global self-intersection may be introduced into the volumetric mesh. A post-processing step needs to be applied to remove self-intersections in such cases (e.g.,  [31]).

In our current formulation, one interior vertex (i.e.,  
                           
                              
                                 
                                    v
                                 
                              
                              
                                 4
                              
                           
                        ) is chosen as the origin of local rotation based on a heuristic consideration. The effectiveness of selecting different origins of local rotation can be released by using the mean-subtraction strategy in global blending (Ref.  [32]). However, in all of our tests, the current implementation converges well when we use one of the interior vertices as the origin of local rotation.

@&#CONCLUSION@&#

This paper presents a method for optimizing the shape of a designed model to be fabricated by layer-based AM. When only a single material can be used during the fabrication, two widely used types of AM machines, FDM and SLA, both suffer from the problems caused by the additionally inserted supporting structures. We develop an optimization approach based on a local minimal rotation and a global blending. A closed-form formulation is derived in the local step to determine the minimal rotations in different configurations. The computation of global blending can be offloaded to a factorization of the normal equation system that can be reused in the subsequent iterations. As a result, the optimization can be conducted very efficiently. Experimental tests shown at the end of the paper have verified the effectiveness of this approach. The optimized models can serve as useful references for designers when self-supportness is an important factor to be considered.

@&#ACKNOWLEDGMENTS@&#

The research work reported in this paper was supported by the Hong Kong Innovative Technology Fund (ITS/247/11 and ITS/060/13). Ka-chun Chan built the machine for the mask-image-projection based SLA, Yuen-shan Leung implemented the support generation algorithm, and the cage-generation program was provided by Chuhua Xian. The authors would like to acknowledge their contribution in this work.

@&#REFERENCES@&#

