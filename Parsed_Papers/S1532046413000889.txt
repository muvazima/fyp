@&#MAIN-TITLE@&#An ontology-based similarity measure for biomedical data – Application to radiology reports

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We examine an ontology-enhanced vector cosine similarity measure using is-a relationships.


                        
                        
                           
                           The similarity measure was tested on two classification problems using 2150 production radiology reports.


                        
                        
                           
                           The semantic information increases the intra-class similarity over the inter-class similarity.


                        
                        
                           
                           Leave-one-out classification accuracy with k-NN shows steady performance as k increases.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Natural Language Processing

Radiology information systems

Semantics

Systematized Nomenclature of Medicine

Document similarity comparison

Radiology informatics

Semantic similarity

@&#ABSTRACT@&#


               
               
                  Background
                  Determining similarity between two individual concepts or two sets of concepts extracted from a free text document is important for various aspects of biomedicine, for instance, to find prior clinical reports for a patient that are relevant to the current clinical context. Using simple concept matching techniques, such as lexicon based comparisons, is typically not sufficient to determine an accurate measure of similarity.
               
               
                  Methods
                  In this study, we tested an enhancement to the standard document vector cosine similarity model in which ontological parent–child (is-a) relationships are exploited. For a given concept, we define a semantic vector consisting of all parent concepts and their corresponding weights as determined by the shortest distance between the concept and parent after accounting for all possible paths. Similarity between the two concepts is then determined by taking the cosine angle between the two corresponding vectors. To test the improvement over the non-semantic document vector cosine similarity model, we measured the similarity between groups of reports arising from similar clinical contexts, including anatomy and imaging procedure. We further applied the similarity metrics within a k-nearest-neighbor (k-NN) algorithm to classify reports based on their anatomical and procedure based groups. 2150 production CT radiology reports (952 abdomen reports and 1128 neuro reports) were used in testing with SNOMED CT, restricted to Body structure, Clinical finding and Procedure branches, as the reference ontology.
               
               
                  Results
                  The semantic algorithm preferentially increased the intra-class similarity over the inter-class similarity, with a 0.07 and 0.08 mean increase in the neuro–neuro and abdomen–abdomen pairs versus a 0.04 mean increase in the neuro–abdomen pairs. Using leave-one-out cross-validation in which each document was iteratively used as a test sample while excluding it from the training data, the k-NN based classification accuracy was shown in all cases to be consistently higher with the semantics based measure compared with the non-semantic case. Moreover, the accuracy remained steady even as k value was increased – for the two anatomy related classes accuracy for k
                     =41 was 93.1% with semantics compared to 86.7% without semantics. Similarly, for the eight imaging procedures related classes, accuracy (for k
                     =41) with semantics was 63.8% compared to 60.2% without semantics. At the same k, accuracy improved significantly to 82.8% and 77.4% respectively when procedures were logically grouped together into four classes (such as ignoring contrast information in the imaging procedure description). Similar results were seen at other k-values.
               
               
                  Conclusions
                  The addition of semantic context into the document vector space model improves the ability of the cosine similarity to differentiate between radiology reports of different anatomical and image procedure-based classes. This effect can be leveraged for document classification tasks, which suggests its potential applicability for biomedical information retrieval.
               
            

@&#INTRODUCTION@&#

Despite on-going efforts to capture data in a unified manner, much of the data in the medical domain still remains as unstructured free textual content; as seen for instance in office notes, radiology or pathology reports. Healthcare is rapidly moving towards electronic medical records providing access to digital documents and it is becoming increasingly advantageous to be able to compare individual clinical documents with each other in order to facilitate clinical tasks such as retrieval of prior reports, document classification and ranking, improved search, mining of related reports to extract recommendation information, consistency checking during data entry and clinical decision support functionalities.

A number of approaches have previously been proposed to measure similarity between documents, typically using statistical, data mining and machine learning techniques in conjunction with domain corpora. However, many classical techniques do not take semantic relationships into consideration; for example, a neoplasm is an abnormal mass of tissue commonly referred to as a tumor, and a hemangioma is a benign neoplasm. These concepts are semantically related since they refer to the same conceptual medical idea of tumor, but do not share any commonality from a lexical point of view. To address some of these limitations, there has been a growing trend in recent years, especially for biomedical data, towards approaches using concepts defined in an ontology to define the notion of semantic similarity as the similarity between concepts representing documents to be compared. This semantic comparison between documents goes beyond the lexical level and takes advantage of the relationships between concepts provided by the ontology.

Much of the semantic similarity related work outside the biomedical domain has been carried out using general purpose knowledge sources such as SemCor which is a sense-tagged corpora [1] and WordNet which is a large lexical knowledgebase consisting of over 150,000 English words along with semantic relations [2]. However, research has shown that such general purpose knowledge sources perform poorly on biomedical data since coverage of specialized concepts is rather limited [3]. The biomedical community has addressed this knowledge gap by developing specialized controlled terminologies containing biomedical terms such as International Classification of Diseases (ICD) to capture information such as diseases, abnormal findings, signs and symptoms, and Medical Subject Headings (MeSH) for indexing journal articles and books in the life sciences. Ontologies represent another type of knowledge source where medical terms are organized around concepts and relationships between these concepts where multiple terms can be associated with the same biomedical concept. For instance, Systematized Nomenclature of Medicine – Clinical Terms (SNOMED CT) captures diseases, findings, procedures, microorganisms and substances (among others) which also contains synonyms and a wide range of relations between concepts. Unified Medical Language System (UMLS) on the other hand aggregates concepts from different terminologies and ontologies to unify the coding of the many systems for its use in biomedical information systems and services.

Various methodologies have been proposed to-date to determine similarity between concepts. These various methods fall broadly into two categories – knowledge-based approaches and corpora-based approaches [4]. The knowledge-based approaches may use techniques such as rule-based heuristics with custom knowledge dictionaries, but typically attempt to exploit the hierarchical structure of an ontology, are machine processable and the domain knowledge is modelled explicitly via concepts and semantic relationships between them allowing various inferences to be made about this knowledge. These approaches typically determine the distance between two concepts of interest using techniques like edge counting, shortest path, ontological depth and Lowest Common Subsumer (or a combination of these). Similarity is then determined to be equal to inverse of distance in its simplest form, or some other mathematical function based on ontological distance. On the other hand, corpora-based approaches, also loosely referred to as information content based approaches, use a (large) corpus of domain-specific text to determine the information value of a concept. This is determined by calculating the frequency of each concept in the corpus – less frequent concepts are seen as more informative than common ones. See reviews by Pedersen et al. [5] and Batet et al. [6] for a more detailed discussion on various semantic similarity measures.

@&#RELATED WORK@&#

There are a number of related efforts to add semantic similarity to document comparisons. Corley and Mihalcea [7] proposed a corpus and knowledge-based approach for measuring semantic similarity of text which uses word-to-word similarity to determine a text-to-text semantic similarity metric by pairing up those words that are found to be most similar to each other, and weighting their similarity with the corresponding specificity score. Specificity of a word is determined using the inverse document frequency (IDF) according to a large corpus. Mihalcea et al. [4] successfully used these algorithms to identify if two text segments are paraphrases of each other. The SemKPSearch tool [8] is a more recent application of these algorithms where the tool attempts to extend search and browsing capability over a document collection to increase the number of related results returned for a keyphrase query. Vaidurya is another search engine that supports multiple-ontology, concept-based, context-sensitive search of clinical practice guidelines to improve performance on free text search retrieval [9]. Another similar system, but with a focus on medical documents, is the XOntoRank system [10] which provides SNOMED aware keyword search of XML documents.

Pivovarov and Elhadad [11] combine ontological and corpus based approaches by proposing a hybrid scheme where similarity is determined using context vectors by combining information from usage patterns (based on IDF) in clinical notes of patients with chronic kidney disease and from SNOMED ontological knowledge; however, the note-based similarity measure is not readily generalizable and is dependent on the annotated corpus and heuristics. Melton et al. [12] explored the use of five similarity measures to determine inter-patient similarity. A database of patient electronic charts consisting of discharge summaries, operative notes, radiology and pathology reports, diagnoses and other information was made available to experts to manually assess which patient documents where similar. The authors concluded that ontology principles and information content provide useful information for similarity metrics but currently fall short of expert performance indicating that still there is no gold-standard to determine document similarity.

The most commonly used measure to determine similarity between documents is perhaps the ‘bag-of-words’ or ‘bag-of-concepts’ approach coupled with the document vector space model which served as the baseline comparison similarity model in this work. Again, one key drawback of this approach is that it does not take ontology-based semantics into consideration. As a result, two documents that are contextually related may still have a zero similarity unless they had specific words in common. To address this limitation Ganesan et al. [13] proposed a Generalized Vector Space Model based on a Lowest Common Subsumer/Ancestor technique which uses hierarchical domain structure in order to produce more intuitive similarity scores. Other recent approaches are also extensions of the document vector space model, with the main difference between different algorithms being the way the document vectors are populated, how the weights are calculated and how the final similarity is computed.

Much of the prior research has focused primarily on determining similarity between individual concepts. In practice, especially in the medical domain, it is useful to compare different clinical documents where a single document is described using multiple clinical concepts. Therefore, in this paper we describe and apply a document similarity measure based on the semantic distance between sets of concepts instead of individual concepts. These algorithms are tested in the context of document-to-document similarity in radiology reports and the use of these similarity measures in classification of radiology reports into anatomy and procedure-based groups. We conclude with a discussion on how this work can be used in routine clinical tasks and possible future directions.

@&#METHODOLOGY@&#

The notion of semantic similarity is used in this study to overcome the limitations of direct concept matching which requires the exact same concepts to be present in the two documents being compared. Consider an example where the concept glioma is extracted from the first document and the concept neoplasm is extracted from the second document. A direct comparison (based on string description or a unique concept identifier) would indicate that there is no relation between these two documents as there are no common concepts between the documents. In fact, glioma is a specialized form of neoplasm that starts in the brain or spine. Therefore, there is a need to take into account the semantic relationships existing between these concepts to calculate a broader similarity metric the same way a human medical expert would intuitively determine that the two concepts/documents are related based on his/her background knowledge of existing relationships between clinical concepts.

In this study, we take advantage of the is-a relations linking concepts in a reference ontology (e.g., glioma is-a neoplasm). The number of these links (edges) is understood as the degree of semantic similarity between the concepts of interest [6]. Typically, semantic similarity is defined inversely proportional to the distance between concepts – i.e., the further apart two concepts are in the hierarchical representation, the lower the similarity score will be. Mathematically, semantic similarity is loosely defined as [5,6]:
                           
                              (1)
                              
                                 Similarity
                                 (
                                 C
                                 1
                                 ,
                                 C
                                 2
                                 )
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       d
                                    
                                 
                              
                           
                        where d is the number of nodes in the shortest path between concept nodes (inclusive of) C1 and C2. Alternative definitions of inter-concept similarity have been proposed in [14–17], but all preserve the basic property that increasing distance within the ontology is concomitant with a decrease in semantic similarity.

The goal of the present work is to determine the similarity between two clinical documents where each document typically contains multiple clinical concepts. In the classical bag of concepts vector space model, documents are represented by vectors in an N-dimensional space where N represents the total possible number of concepts. In the simplest case, the vector is binary, with a 1 representing the presence of a concept in a document and 0 representing the absence of that concept. Further variations introduce differential weighting of each dimension. A standard approach to comparing document similarities using the vector space model is to compute the cosine between the two vectors representing the two documents under comparison. Clearly, this requires an exact match of concepts to have any non-orthogonal component, and does not take into account the fact that the dimensions may be connected semantically.

To address this limitation, we adapt the approach by Madylova and Oguducu [18] to extend the standard vector space model to generate a semantic vector as follows. Again, each document is represented by an N-dimensional vector where N is equal to the number of concepts in the hierarchy or ontology. For each concept extracted from a document (referred to here as a seed-concept), the corresponding dimension is given a value of 1, indicating that it was found directly in the document. At this stage, the semantic algorithm is identical to the classical vector space model.

To take advantage of the knowledge represented in the ontology in terms of is-a relationships, we next ‘augment’ the description of the vector by populating the vector with non-zero weights for the dimensions corresponding to ancestors (or superclasses) of seed concepts. The weight for each ancestor is defined using one of the concept-to-concept weighting approaches to approximate the relatedness between the seed concept and its ancestor. In our implementation, we use Eq. (1) to set the minimum distance between the ancestor and any seed concept in the document. In this way, the vectors arising from any two concepts will have a non-orthogonal component that is proportional to the depth of their lowest common ancestor.

After constructing the semantic document vectors in this way, we define the semantic similarity measure as the usual cosine between a pair of semantic document vectors A and B:
                           
                              (2)
                              
                                 Similarity
                                 (
                                 A
                                 ,
                                 B
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             n
                                          
                                       
                                       
                                          
                                             A
                                          
                                          
                                             i
                                          
                                       
                                       ×
                                       
                                          
                                             B
                                          
                                          
                                             i
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                
                                                   n
                                                
                                             
                                             
                                                
                                                   (
                                                   
                                                      
                                                         A
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       ×
                                       
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                
                                                   n
                                                
                                             
                                             
                                                
                                                   (
                                                   
                                                      
                                                         B
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where n represents the union of all concepts in documents A and B.

The description of how it is implemented can be illustrated by using a fragment of the SNOMED CT ontology (Fig. 1
                        ).

If we look at Neoplastic Disease in Fig. 1, the shortest distance matrix based on the is-a relationships is shown in Table 1
                        .

Using a simple weighing measure where the weight is equal to 1/(1+shortest distance), we get the weight matrix for Neoplastic Disease as shown in Table 2
                        .

Similarly, if a document contains multiple concepts (seed-concepts) such as Neoplasm and Hemangioma, the weight matrix would look as that shown in Table 3
                        .

Once the weight matrix for each seed-concept in a document is computed we can complete the semantic vector for the document by taking the maximum weight for a given superclass. For instance, Table 4
                         shows the semantic vectors for the two weight matrices shown in Tables 2 and 3 (each row corresponds to the non-zero weights of one semantic vector).

Now the overall similarity between D1 and D2 (represented by the semantic vectors) can be calculated using Eq. (2):
                           
                              (3)
                              
                                 Similarity
                                 =
                                 
                                    
                                       (
                                       0.2
                                       ×
                                       0.25
                                       )
                                       +
                                       (
                                       0.25
                                       ×
                                       0.33
                                       )
                                       +
                                       (
                                       0.33
                                       ×
                                       0.5
                                       )
                                       +
                                       (
                                       0.5
                                       ×
                                       1
                                       )
                                       +
                                       (
                                       1
                                       ×
                                       1
                                       )
                                    
                                    
                                       
                                          
                                             
                                                
                                                   0.2
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             
                                                
                                                   0.25
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             
                                                
                                                   0.33
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             
                                                
                                                   0.5
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             
                                                
                                                   1
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       ×
                                       
                                          
                                             
                                                
                                                   0.25
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             
                                                
                                                   0.33
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             
                                                
                                                   0.5
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             
                                                
                                                   1
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             
                                                
                                                   1
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        which is equal to 0.4240. As expected, this similarity is medium since the two documents are somewhat similar. Table 5
                         shows similarity values that have been computed for several simple document examples containing one or two concepts from the SNOMED CT fragment (Fig. 1) and illustrates how the computed similarity value is indicative of the closeness of the semantic content for the two compared documents. Critically, in all of these examples, the standard vector space representations of these document pairs would all be orthogonal and result in a similarity of zero.

To validate our approach of using semantic vectors for document comparison, we extracted production radiology reports from the University of Chicago Medicine. All electronic protected health information (ePHI) were removed from the dataset using a purpose built software tool per HIPAA regulations. This retrospective research study was reviewed as Exempt by the University of Chicago Institutional Research Board. The dataset contained 15,895 radiology reports for 8707 patients. This was narrowed to CT as the most common 3D imaging modality in the database, and further restricted to abdominal and neurological (neuro) imaging reports, as these represent the two most common CT study types by anatomic location. Finally, the reports were first limited to one report per patient to avoid obvious similarity between reports from the same patient. After this filtering, the dataset consisted of 952 CT abdomen and 1128 CT neuro studies.

The algorithm described conceptually in Section 2.2 was implemented as follows:
                           
                              1.
                              We used a Microsoft SQL Server 2012 database to store a copy of UMLS (version 2011AB_UMLS) which also contains SNOMED CT concepts. Using the MRCONSO and MRHIER tables in UMLS, the atomic AUI codes for all the nodes along all the paths to the root (referred to as ‘contexts’ in UMLS) for a given SNOMED concept (the “seed” concept) can be determined. This defines the set of is-a paths back to the root for each concept (“paths-to-root”). There may be more than one path-to-root.

For each path-to-root, every concept along the path can be assigned a unique distance back to the seed concept: this is defined as the number of edges to the seed. These distances are then used to assign weights to all concepts along the path. Specifically, the weight of each concept is inversely related to the number of edges between the seed concept and the concept to be weighted along the path-to-root.

Step 2 is then repeated for each different path-to-root for a given seed concept. In the event that a concept appears in different paths-to-root (for example, for high level concepts), then the final weight assigned is always the maximum of the possible weights from the different paths-to-root that contain that concept (i.e., the shortest path between the seed concept and a given ancestor).

Steps 2 and 3 are repeated for each seed concept to create the semantic vector representation of the document which in turn can be used to compute document similarity, as described in Section 2.2. As in Step 3, the maximum weight is assigned for each concept in the case that it appears in multiple paths-to-root.

Radiology reports typically contain several sections. Although the sections are not standardized across all institutions, the reports typically contain the sections Clinical Information to represent patient’s presenting conditions and clinical history, Technique to include the scanning technique used, Comparison to mention a relevant prior study that was used for comparison, Findings to mention the status of various findings that have been identified and Impressions section to discuss the interpretation of findings. For the work presented herein, we focus on the impression section only because it contains diagnosis related information as well as interpretation of current findings and represents a relevant summary of the patient’s current situation. Furthermore, radiologists often use pre-defined macros and templates for reporting findings which could introduce an artificial degree of similarity.

Reports were first pre-processed to identify the individual report sections by text searches for known variations in section title, spacing, and punctuation. The impression sections were then processed with the publicly available NCBO Annotator web service [19] to extract SNOMED codes. The results were restricted to three SNOMED branches – Body structure, Clinical finding and Procedure as these were believed to be most informative of the broader patient condition while minimizing incorrect extractions. NCBO Annotator web service related techniques and subsequent similarity algorithms were implemented in C# .NET.

Tests were performed to quantify the difference in measured similarity between the proposed semantic similarity model described in Section 2.2 and the classical bag-of-concept document vector space model. The hypothesis was that the similarity in all cases will be greater in the intra-anatomy (abdomen–abdomen and neuro–neuro) pairs than the inter-anatomy (abdomen–neuro) pairs. We further hypothesize that this difference will be increased with the semantic enhancements. The non-normality of the data was confirmed via the Lilliefors test for normality, and subsequent paired analyses were performed using the Wilcoxon signed rank test for zero median of differences between the with-semantics and without-semantics datasets.

This two-class similarity comparison was then extended to multiple classes by further subdividing the two anatomy classes based on the specific imaging procedure that was performed. This was then limited to the eight most common procedures and again pairwise descriptive statistics computed.

The algorithms were further evaluated in a document classification task. A k-nearest-neighbor (k-NN) classifier implemented in Matlab (Mathworks, Inc., Natick, MA) was used in which the semantic and non-semantic similarity measures were used to determine the nearest neighbors. The k-NN algorithm was chosen as it explicitly encapsulates the similarity metric. A leave-one out validation framework was used with both the two-class (anatomy) and multi-class (imaging procedure) scenarios. In the multi-class scenario, the CT abdomen and neuro reports were again subdivided based on the specific imaging procedure that was performed, limited to the eight most common procedures. In the leave-one-out cross-validation framework, we iteratively select each individual document for classification. When classifying each document (the “test document”), that test document is excluded from the set of potential neighbors (the “training documents”). The k-NN algorithm then proceeds as usual, comparing the vector of the test document against the remaining training documents and computes a classification based on the k nearest neighbors. In subsequent iterations, the previous test document is returned to the training document set, the next test document is selected and removed from the training set, and the process continues as above. Iterations proceed such that every report serves as a test report exactly once in the process.

@&#RESULTS@&#

After excluding reports where no concepts were extracted either due to limited report content or limitations in the concept extraction algorithms, there were 1,781,328 pairwise report combinations. Tables 6 and 7
                        
                         respectively show the similarity measure for both mean and median in the two cases, with and without semantics, as well as the similarity measure difference (last column). The reports represented 1670 unique SNOMED concepts (3865 concepts when semantics were introduced).

Adding semantics increases similarity across all classes, as seen in Tables 6 and 7, but the effect is more prominent for the intra-class case.

These results reflect the very large number of zero-similarity pairs in the non-semantic case, which represent 77%, 86%, and 79% of the neuro–neuro, neuro–abdomen, and abdomen–abdomen pairs, respectively. Because of this, we next investigated the impact of adding semantics, focusing only on those report pairs in which the similarity was non-zero in both with and without-semantics instances. Tables 8 and 9
                        
                         respectively show the similarity value for both mean and median in the two cases as well as the similarity difference (last column).


                        Tables 8 and 9 illustrate that the intra class similarity is higher with semantics. Fig. 2
                         shows how the distribution of the similarity increases or decreases due to the addition of semantics for the non-zero similarity pairs.

Our second scenario explores the effect of the proposed semantic similarity enhancement in a more complex classification task where the classes are defined based on the imaging procedure associated with each report. Table 10
                         shows the eight most frequent procedures that were associated with the reports in our database where each procedure was present at least 76 times.


                        Figs. 3 and 4
                        
                         show the mean similarity scores between the classes of reports defined in Table 10. The procedures were manually placed into rows and columns to generally group related anatomies and reflect a natural anatomical order. Procedure frequencies are given in the parentheses. A Wilcoxon signed-rank test was used to test the null hypothesis that the difference between the with-semantics and without-semantics similarity scores for individual report pairs was drawn from a distribution with zero median. In all exam code pairings, the null hypothesis was rejected with a p
                        <0.0001, indicating that the difference between the similarities with-semantics and without-semantics was significant.

As an example, Fig. 3 indicates that the average similarity between CT HEAD WO and CT NECK SOFT TISSUE W reports is 0.12 (with semantics). The color coding is scaled linearly within a row, with the highest column represented in dark gray and the lowest column in white. In this representation, the diagonal represents the intra-class similarity while the block diagonal areas reflect anatomical similarity between adjacent rows and columns.

We determined the classification performance accuracy for the two anatomy related classes (abdomen and neuro) as well as the eight procedure related classes for increasing k values. The classification performance accuracy is shown in Fig. 5
                        .

In the non-semantic case, in all k
                        >1 it was observed that there were insufficient training cases to satisfy the required k-value. For example, at k
                        =11, there were 39 instances in the leave-one-out iterations where a specific test report did not have at least 11 other reports to compare with that had non-zero similarity. At k
                        =39, the number of test reports for which insufficient nearest neighbors could be computed increased to 605 reports. This arose from ties or report pairs with zero-similarity (see next section for how ties are handled).

The accuracy is significantly reduced in the eight-class problem as compared with the two-class problem. As a baseline, a classification scheme where each report is classified as belonging to the most frequent class in the database (i.e., the CT HEAD WO class), would yield about 32% accuracy.

Note that this is the overall accuracy, aggregated over all eight classes. To examine the types of classification error, a confusion matrix is shown in Fig. 6
                        . A single representative k-value is shown (k
                        =13), but similar trends are seen for other k-values as well. The agreement between the k-NN classification and the ground truth classification was quantified using Cohen’s kappa coefficient. In the with-semantics case illustrated in Fig. 6, the agreement was found to be 0.57 (95% confidence interval 0.53–0.60). For the without-semantics case illustrated in Fig. 7
                        , the corresponding kappa value was 0.52 (0.49–0.55).

One way to further investigate this observation is to aggregate procedures from similar anatomies into the same class, thus producing four ‘aggregated classes’ – i.e., the head exams, the soft tissue neck exams, the abdomen/pelvis exams, and the chest/abdomen/pelvis exams. This effectively creates a sub-division of anatomy below the original neuro versus abdomen split. Classification performance accuracy increased substantially when procedures were aggregated; for example, at k
                        =39, the eight-class accuracy with semantics was 0.64 compared with 0.60 without semantics. When reduced to four classes, the accuracy increased to 0.83 and 0.78, respectively. The confusion matrices for the aggregated classes are shown in Figs. 8 and 9
                        
                        . The corresponding kappa value and 95% confidence intervals were 0.76 (0.73–0.79) with semantics and 0.72 (0.69–0.74) without semantics.

For a two-class problem, a simple way to avoid voting ties is to use an odd value for k. Another type of tie can occur (similarity ties) when the current report has the same similarity measure with two different reports. Some of the commonly used tie-breaking techniques are random tie-breaking and using the nearest neighbor amongst the tied groups.

In some cases in the non-semantic algorithm, it was observed that there were insufficient training reports to satisfy the k-NN algorithm. This was possible despite the large training database because of two factors: (a) reports that had zero similarity with a test case and (b) large numbers of reports with identical similarities to the test case. In the case of identical non-zero similarities, the k-NN implementation in this study includes all the reports with the same similarity. That is, reports are accumulated into the k-NN voting block until k unique non-zero similarity values are found or all reports with non-zero similarity are included. When the two factors are coupled, the consequence may be that every report with a non-zero similarity is considered. This occurred only in the non-semantic case.

To understand how including semantics avoids this situation, Fig. 10
                         illustrates how reports were utilized to classify a given test report (leave-one-out framework). This is done for the two-class problem with 2080 reports for several values of k using a 2080×2080 matrix. In the visualizations, each horizontal row is a test report, and each vertical column is one of the possible similar reports. A white mark is added if the similar report (column) was used in classifying this particular test report (row) at a given k-value. Thus, the diagonal is always empty (the test report is left out), and rows that are heavily filled expose that more reports than the required k reports were used, because of the ties).

The vertical stripes that can be seen in Fig. 10 represent reports that “show up often” in the k-NN calculation, i.e. reports that are similar to many of other reports (or for dark vertical stripes, reports that are not similar to any other reports and hence do not participate in the voting). The upper left quadrant contains test ABDOMEN reports being matched with similar ABDOMEN reports and likewise the lower right quadrant for NEURO reports. The upper right and lower left represent mismatches, where ABDOMEN reports are judged similar to NEURO and vice versa. The block diagonal structure that is apparent in the higher k-values is because of the grouping of reports by procedure type into adjacent columns and rows.

The two quadrants corresponding to the ABDOMEN–NEURO (upper-right) and NEURO–ABDOMEN (lower-left) show that many more reports from the other class are used in the voting scheme for the without-semantics case than the with-semantics case, in line with our expectations based on the observation that the semantic information preferentially improves the similarity of intra-class compared to inter-class pairs. As the value of k is increased, many more reports are used in the without-semantic case; for example for k
                        =3, the two quadrants are fairly empty in both cases for with and without-semantics, but at k
                        =11 or 21, the two quadrants show striking differences. The main reason for this is the large presence of ties in the without-semantics case, which is due to the fact that a large number of reports contain fewer concepts and thereby increases the chance of similarity ties. The consequence of having so many ties is to “force” the voting mechanism to use more reports and increase the chance to get voting reports from other classes, in turn decreasing accuracy.

@&#DISCUSSION@&#

The analysis of the anatomy-based similarity pairs confirms our initial hypothesis that in all cases, the intra-class similarity (i.e., neuro–neuro or abdomen–abdomen) is higher than inter-class similarity (i.e., neuro–abdomen).

The first effect of transitioning from the non-semantic to the semantic similarity metric is the removal of large number of zero-similarity document pairs. This is because of the strict requirement of the classical vector space model that exactly the same concepts must be found in two reports to have non-orthogonal vectors. This requirement is relaxed in the semantic case, hence the number of zero-similarity pairs is significantly reduced. At minimum, any two concepts will share at least one ancestor (the root ancestor of the ontology), and any two anatomy concepts or finding concepts are likely to share even more ancestors. This suppresses the zero-similarity pairs but also causes a general shift towards high similarity values, as observed in Tables 6 and 7.

The second effect is that, even excluding zero-similarity pairs, the addition of semantics preferentially increases the intra-class similarity, as seen in Tables 8 and 9 and Fig. 2. The measured increase was 0.07–0.08 in the abdomen–abdomen and neuro–neuro pairs but only 0.04 for the abdomen–neuro pairs. Thus, in addition to the generalized increase in similarity due to the introduction of common ancestors for all concepts, there is a context-specific increase which can be leveraged for similarity-related tasks, such as document classification. Since the core assumption is that reports are, in general, more similar to other reports of the same anatomy, this result suggests that the calculation of similarity with added semantics better reflects the measure of relatedness expected from reports of the same class.

These two effects of the semantic enhancement contributed to a measureable improvement in accuracy on the document classification task, wherein at all but one k-value (k
                        =3 for the 8-class problem), the semantic similarity metric yielded a higher accuracy than the non-semantic metric. In the metric space defined by the described semantic similarity function, radiology reports arising from similar acquisitions tend to cluster together. While this effect would need to be validated on classifiers which do not explicitly operate in the same metric space, the underlying intuition motivating the semantic model suggests that indeed a similar effect would be seen with other classifiers.

It was further observed that by using the k-NN classifier, the accuracy of the algorithm remained steady even as k was increased – for the two-class problem, accuracy for k
                        =41 was 93.1% with semantics compared to 86.7% without semantics. Similarly, for the eight-class problem (classes defined by the imaging procedure), the accuracy (for k
                        =41) with semantics was 63.8% compared to 60.2% without semantics. This again is related to the nature of the k-NN which explicitly uses prior training instances in the voting process. Here, too, the tie-breaking and zero-pair removal effect of the semantic algorithm serves in effectively increasing the amount of useable data for the algorithm. The effect is seen in the improved accuracy and also illustrated visually in Fig. 10.

Exploring the 8-class error rate in more detail, the confusion matrices suggest that most errors are due to confusion between procedures of the same anatomy but differing in use of contrast agent or adult versus pediatric head. Indeed, it was observed that the accuracy substantially improved when procedures were grouped based on anatomy. This is consistent with the previous finding that the similarity metric is able to preferentially group together reports on the same anatomy. The results of this study, however, suggest that unlike in the case of anatomy, there was insufficient extraction of contrast-enhancement specific concepts to separate reports on those bases. This is not surprising given the typical separation of specific factual observations (such as contrast enhancement) into the findings section and interpretations and diagnoses into the impression section. It may be expected that different disease profiles would be reported in the impression for different types of procedures, such as those with and without contrast, but this had a small effect, if any, in the classification of the current data set. Again, however, it was observed that for most k-values, the accuracy was greater for the semantic algorithm as compared with the non-semantic algorithm.

In a study [20] that compared three different semantic similarity-metrics (which rely on expert opinion, ontologies only, and information content) with four metrics applied to SNOMED CT, the investigators found that the metric based only on the ontology structure correlated the most with expert opinion, and was preferred to information-content-based metrics. This observation has been confirmed by a more recent study [21] which concluded that knowledge based measures significantly and meaningfully outperform corpus based methods. Our proposed method is based only on the ontology structure, and it would be interesting to compare our results against expert opinion as well as other corpus, data-driven based techniques.

Our approach is most closely related to those proposed by Thiagarajan et al. [22] and, as described in Section 2, the method of Madylova and Oguducu [18]; however, our work is different in its intent since we used the extended vector space model to apply it to a domain specific, real-world problem using production data. Thiagarajan et al. introduce the concept of ‘Set Spreading’ which is very similar to the present research but differs in the way the final computation of similarity is addressed. They augment the feature vector by traversing the ontology, with the option to weight individual concepts. In our approach, the cosine similarity uses the semantically augmented vectors, while they repeatedly compute the cosine similarity as the vectors are augmented through set spreading, and then average all similarity values together.

The methodology presented herein has several limitations; notably:
                           
                              1.
                              The results given are valid only for the specific ontology, its concept relationship and its structure, and for a given document domain. For this research, we chose SNOMED CT as the reference ontology, as it has been shown to have 88% coverage for core clinical concepts [23], and full coverage (100%) for critical imaging findings [24]. Therefore the impact of having an incomplete medical knowledge represented in the ontology is limited in this instance, although the structure of the ontology may have affected the similarity computation.

For this work we used the shortest distance (i.e., the highest weight) between a given seed concept and an ancestor after considering all is-a relationship based paths-to-root. Relationships other than is-a may also be important (e.g., part-of relationships) but are not reflected in the current model. Moreover, the assumption of a simple inverse relationship between similarity and distance between concepts in an ontology may be subject to further validation and improvement.

The goal of our current work was to use an extended vector-space model in a domain specific manner. Therefore, we compared our results using the standard vector-space model as the baseline. This clearly shows the importance of adding semantics, but we have not directly compared differences between our similarity measure and other semantics based similarity measures to determine performance accuracy.

Our results are based on data from one academic institution for selected anatomies/procedures and it is possible that the similarity results are not generalizable across institutions for all anatomies/procedures. Despite the limitations, we believe that the reasonably large dataset we used was representative of the usefulness of computing semantic similarity between clinical documents.

For classification purposes we used the type of study as the ground truth as opposed to a more clinically meaningful standard of similarity validated by a human expert. For example, a relatively higher similarity score may be appropriate between two neuro CT studies showing a left-sided lacunar bleeding compared to another pair with a low score for the same study type but with completely different findings. Using a manually obtained, more subjective ground truth would arguably be stronger, although the study type was part of the production dataset determined during actual clinical practice, and represented a higher level categorization of reports. Designing and evaluating a more clinically relevant study should be considered as a way to enhance the methodology.

For our current work, we have used a 1 or 0 to indicate the presence or absence of a concept. We did not account for the fact that a given term may appear multiple times within the same document. Concept weighting through tf-idf, mutual information or the like, was not used in this study. This was done deliberately to focus on the effect of adding semantics to the document vector-space model without other confounding factors. It is possible that adding concept weighting may significantly improve the accuracy of the classification. Methods for frequency-based weighting in the non-semantic case are well defined; however, several considerations will need to be taken into account before term frequencies can be integrated into the semantic case. In particular, appropriate frequency weighting along the semantic path would require further analysis. If inappropriately selected, a concept such as ‘Disease’ will be common across all the disease terms due to its position in the SNOMED hierarchy possibly resulting in an artificial degree of similarity and may make it difficult to isolate the relative influence of the semantic-path based similarity versus the frequency weighting scheme. Adding frequency weighting in the semantic case is clearly a next step for further research.

This study used the NCBO Annotator web service to map report text to SNOMED CT. Alternative approaches are also possible, including other natural language processing algorithms or services such as MetaMap [25]. As there is no conclusive evidence to indicate that one is necessarily better than the other, we performed a preliminary test of the NCBO Annotator mapped terms by manually inspecting the results for 30 reports. Based on the accuracy of this small test, we proceeded with NCBO Annotator, with the understanding that the specific results would vary if different concept extraction algorithms were used.

A primary focus of this research was to determine similarity between documents which often contain multiple concepts. Most of the documents in the clinical domain are still written and stored as free-text and therefore document comparison techniques have an important role in algorithms for supporting routine clinical workflow. Having a means to determine similarity between two documents can have several real-world implications, for instance, querying for relevant documents using narrative text. Furthermore, a radiologist may need to see all relevant prior reports related to a particular clinical episode and this can be quite tedious and time consuming when a patient has many prior free-text reports. Similarly, it might be important to classify reports into different procedures, such as might be relevant when cataloguing old exams for retrospective analysis independent of a potentially dynamic or error-prone manual naming scheme.

@&#CONCLUSIONS@&#

In this paper we presented a semantic vector based approach to determine similarity between two given documents using SNOMED CT as the reference ontology. Our evaluation shows that semantic based approach increases the similarity of documents describing the same anatomies. When applied to a document classification task based on imaging procedure or sub-anatomy, the semantic algorithm improves classification accuracy compared to a non-semantic approach.

Determining similarity between two documents is an important research area given the many implications for routine activities, for instance, in clinical workflow. Despite numerous propositions to calculate similarity, currently there is no gold standard measure for determining similarity so we have taken a task-based approach to verify the hypothesized improvements in document similarity from the addition of semantics.

@&#ACKNOWLEDGMENTS@&#

The authors would like to thank Dr. Paul Chang and his staff at the University of Chicago Medicine for motivating the current work, facilitating the data collection, and for valuable discussions. We further thank Merlijn Sevenster for preparing the database of radiology reports utilized in this work.

@&#REFERENCES@&#

