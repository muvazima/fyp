@&#MAIN-TITLE@&#Features for stochastic approximation based foreground detection

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Features for foreground detection algorithms are evaluated.


                        
                        
                           
                           The foreground is modeled with a full covariance Gaussian.


                        
                        
                           
                           The background is modeled with a uniform distribution.


                        
                        
                           
                           The model accommodates for any number of pixel features.


                        
                        
                           
                           Extensive comparisons are carried out with well known competing approaches.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Background modeling

Foreground detection

Probabilistic mixture model

Background features

Pareto front

@&#ABSTRACT@&#


               
               
                  Foreground detection algorithms have sometimes relied on rather ad hoc procedures, even when probabilistic mixture models are defined. Moreover, the fact that the input features have different variances and that they are not independent from each other is often neglected, which hampers performance. Here we aim to obtain a background model which is not tied to any particular choice of features, and that accounts for the variability and the dependences among features. It is based on the stochastic approximation framework. A possible set of features is presented, and their suitability for this problem is assessed. Finally, the proposed procedure is compared with several state-of-the-art alternatives, with satisfactory results.
               
            

@&#INTRODUCTION@&#

The proliferation of video vigilance systems has given rise to an ever increasing need of preprocessing, analyzing, indexing and searching over huge quantities of video data. These tasks cannot be efficiently carried out by humans, since the volume of data to be processed is too large for their capabilities. Hence, activity analysis intelligent systems are an emergent research field with multiple applications, both in the private and public sectors [36].

Under a modular view of computer vision systems, the separation of moving objects from the background is one of the earliest stages. This is an essential part of any surveillance system, since its performance deeply influences the higher level stages which carry out the object detection. Consequently, much effort has been devoted to this complex problem, which includes challenges such as dynamic backgrounds, shadows, objects which integrate into the background, sudden illumination changes, color similarity (camouflage) and many others [4].

Most approaches are based on building a model of the background which is based on some statistics obtained from the previous video frames. We might classify most of them into four classes: median based, kernel density estimation based, subspace based, and probabilistic mixture based [15]. The first class computes the median of the pixel values over the last frames in order to obtain a robust estimation of the background image. These approaches exhibit a good resilience against noise and artifacts [8], but they are also computationally expensive if the frame window is large, a problem which can be alleviated by fast methods to approximate the median [29,33]. The second kind of approaches estimates the probability density function (pdf) of the pixel values, but it does not assume any particular probability distribution for them, i.e. non parametric methods are used. Gaussian kernels are commonly chosen for this purpose [9,14]; the fundamental parameters to be tuned in this case are the number of kernels and their bandwidth. There is also a need to reduce the inherent computational load of kernel density estimation, which can be done by dropping irrelevant features. Subspace based methods try to find a subspace of the space of all possible images where the background of the scene lies, so that departures from that subspace can be detected as foreground objects [31,46,44,42]. Finally, the fourth group of methods assumes that the pixel values follow certain probability distribution, usually a mixture of Gaussians, and then it tries to estimate its parameters; this means that they are parametric methods. They tend to have less memory and time requirements than non parametric ones, since the number of parameters is relatively small. This is one of the causes of their popularity [45,40,51,17], along with the possibility to introduce specific mechanisms to tackle the above mentioned challenges [4].

Even though there is a large number of background subtraction algorithms based on probabilistic mixtures, a majority of them stick to a set of simplifications which can reduce their performance. On one hand, most proposals use the RGB pixel values as inputs [34]. On the other hand, some well established and frequently used background modeling algorithms use the same variance for all the input variables [17,41,51], although there is no fundamental reason not to use the full covariance matrix. In other words, the use of full covariances is an option which exists in theory but is very rarely implemented in practice. A spherical covariance matrix might not be the optimal choice because the variance of the input variables can be different, which means that those models do not adapt to the specific dispersion of each variable. For example, the variabilities of median filtered features are expected to be much lower than those of non median filtered features. Also, features based on edge information (high pass filters) tend to vary more than features based on low pass filters. Moreover, the above mentioned models do not consider the covariances among the variables, so they treat them as if they were independent, which is not the case. For example, the red, green and blue color components of a pixel will typically grow or diminish together as the lighting increases or decreases, respectively. This means that RGB color components are strongly correlated. Another example is edge features in the horizontal and vertical directions, since textured objects will have high values of the features in both directions, while homogeneous objects will have low values of the features in both directions.

Our aim here is to develop a method which overcomes the limitations we have just outlined, along with a set of relevant features that yields adequate results. Our proposal defines a probabilistic model which handles any number of pixel features. It also accounts for the correlations among the features, so that a more realistic model is obtained.

The structure of this paper is as follows. First of all, a review of previous work about probabilistic background models and feature selection is done in Section 2. Then the proposed probabilistic mixture model and the corresponding learning algorithm are considered in Section 3. The set of pixel features that we have chosen are defined and studied in Section 4. Section 5 is devoted to the experimental results, with comparisons with state-of-the-art approaches. Finally, Sections 6 and 7 deal with the discussion of the most relevant characteristics of our proposal and the conclusions, respectively.

@&#RELATED WORK@&#

As outlined above, the design of a realistic mixture model for foreground detection can be decomposed into two decisions: the choice of the probability model for each mixture component and the selection of the number and kind of input features. Next a review of previous literature on these two topics is carried out, with indications of possible enhancements.

Most methods rely on the assumption that all the variables have the same variance, and that all of them are independent. This translates to Gaussian mixture components with spherical covariance matrices, i.e. matrices of the form 
                        
                           
                              
                                 σ
                              
                              
                                 2
                              
                           
                           I
                        
                     , where 
                        
                           
                              
                                 σ
                              
                              
                                 2
                              
                           
                        
                      is the common variance and 
                        
                           I
                        
                      is the identity matrix. It has long been known that the assumption of a spherical covariance matrix does not conform to real scenes. In [12] it is found that the estimation of the mean vector is reliable, but the covariance matrix does not conform to a spherical model. The distribution of values for a background pixel in the standard RGB space conforms to a cylinder rather than a sphere, which renders the spherical model unrealistic [19,5]. The cylindrical model is proposed to overcome this problem. Under this model the major axis of the cylinder extends to the black point, and the position along this axis corresponds to luminance. The distance of a point to the major axis determines the radius of the cylinder, which is called the color distortion. The cylindrical model has the disadvantage that it is not associated to any probability density, since it only defines a distance measure of how close a color is to the model. Hence it is not possible to assign a probability that a pixel belongs to the background, and consequently the amount of learning of the background model of a pixel cannot be adapted to the likelihood that the observed color corresponds to the background, which affects the learning process negatively. On the other hand, a Gaussian with a full covariance matrix can model an elongated shape with any position, thickness and orientation, and it produces the probability that a pixel belongs to the background, so it is a viable alternative to fit the data.

A commonly used alternative is to use several spherical Gaussians for the background [40,49,6], rather than one [45]. Comparative studies show that more than one spherical Gaussians perform better than a single spherical Gaussian [11]. Nevertheless, a mixture of spherical Gaussians can only give a rough approximation of an elongated cluster of data unless the number of Gaussians grows considerably, because the points which are midway between the mean vectors of two successive Gaussian components have a lower probability density than those closer to a mean vector. Again, a Gaussian with a full covariance matrix does not have this problem, since the probability density is smooth through the elongated cluster. This is confirmed by the study in [3], which points out that a single Gaussian with a full covariance matrix outperforms a model with multiple spherical Gaussians in some situations. It is reported that this is because the covariances are able to adapt to background instabilities.

Last but not the least Gaussian mixture components cannot model the foreground adequately unless a large amount of them is used. This is because incoming foreground objects can have any aspect, so any mixture component used to model the foreground should have a substantially flat profile, i.e. no prominent modes. However, most algorithms neglect this fact and assign a small number of spherical Gaussians to the foreground [18,6]. This leads to very large variances in the foreground Gaussians as they try to adapt to heterogeneous foreground input samples. Moreover, a large part of the probability mass of these Gaussians could be out of the support of the real input distribution, since the Gaussians must adapt to the input samples which lie near the borders of the support. That is, they are modeling regions where no inputs can exist. Of course this is also true for the Gaussians assigned to the background, but in this case the effect is not so serious because the background samples are expected to be more concentrated, so that the spread of the Gaussians is smaller and little probability mass is out of the support of the real input. On the other hand, the assignment of a Gaussian to the background or the foreground is a difficult problem on its own. This situation calls for an uninformative prior for the foreground, i.e. a single flat mixture component such as a uniform distribution [35,13], which is the approach that we advocate here.

The second fundamental decision to be made when a foreground detection algorithm is developed deals with the set of input features. The most straightforward option is to use the raw RGB information from the camera, and it is chosen by many proposals. It has the advantage of its speed and ease of implementation, but it is widely acknowledged that it suffers from limitations due to illumination changes, among other artifacts. Separation of luminance and chrominance can help to reduce these undesirable effects, as done in [45], where the YUV color space is employed. The Y channel conveys the luminance information, while U and V channels carry chrominance. A further development is to remove the luminance information completely, which is commonly done by dividing the RGB values by their sum to yield the normalized RGB set of features [38,28,2,9]. This attains certain resilience to illumination changes, but the differing optical characteristics of objects imply that normalized RGB data are still subject to variation when lights are switched on or off. A way to remove the dependence from color and lighting is to use texture features [48,16], although they are not useful for scenes which contain objects or background with little or no texture.

Combinations of features of different kinds have proved to perform adequately in many situations. Spectral, spatial and temporal features are combined under a Bayesian classification framework in [21]. It is also possible to choose the features by means of a boosting algorithm [32], although a warmup period with no foreground objects is required. It is worth noting that these works have fundamental differences with our approach, since [21] estimates the background and foreground probabilities by multivariate histograms, while [32] considers kernel density estimators with spherical Gaussians, which has the disadvantages that have been explained above.

In principle, any foreground detection algorithm which is based on a probabilistic mixture which includes spherical Gaussians could be adapted to accommodate full covariance matrices with any number of variables. However, each algorithm makes its own simplifying assumptions which do not hold for full covariance matrices. Hence, each of them would have to be reformulated from scratch. Consequently, we restrict our attention here to the adaptation of our earlier model [24], which was oriented to the RGB color space, in order to accommodate for any number and kind of pixel features.

In this section we present a probabilistic mixture model for the foreground detection problem. As mentioned in Section 2, it is an improvement of the model [24]. The new model is defined in Section 3.1, and the learning algorithm is detailed in Section 3.2. It is necessary to employ specific procedures to manage quantization noise (Section 3.3) and sudden background changes (Section 3.4). The initialization is outlined in Section 3.5. Finally, the implementation of the model is detailed in Section 3.6.

We propose to use the stochastic approximation framework to train a mixture which models the distribution of pixel feature values 
                           
                              t
                              
                                 
                                    
                                       x
                                    
                                 
                              
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    D
                                 
                              
                           
                         at frame coordinates 
                           
                              x
                              =
                              
                                 
                                    
                                       j
                                       ,
                                       k
                                    
                                 
                              
                           
                        , where D is the number of pixel features of interest. There is one Gaussian component for the background and one uniform component for the foreground. This leads to the following probabilistic model for the distribution of feature values at any given position, where we drop the position coordinates 
                           
                              x
                           
                         for the sake of simplicity:
                           
                              (1)
                              
                                 p
                                 
                                    
                                       
                                          t
                                       
                                    
                                 
                                 =
                                 
                                    
                                       π
                                    
                                    
                                       Back
                                    
                                 
                                 p
                                 
                                    
                                       
                                          t
                                          |
                                          Back
                                       
                                    
                                 
                                 +
                                 
                                    
                                       π
                                    
                                    
                                       Fore
                                    
                                 
                                 p
                                 
                                    
                                       
                                          t
                                          |
                                          Fore
                                       
                                    
                                 
                                 =
                                 
                                    
                                       π
                                    
                                    
                                       Back
                                    
                                 
                                 K
                                 
                                    
                                       
                                          t
                                          |
                                          
                                             
                                                μ
                                             
                                             
                                                Back
                                             
                                          
                                          ,
                                          
                                             
                                                C
                                             
                                             
                                                Back
                                             
                                          
                                          +
                                          Ψ
                                       
                                    
                                 
                                 +
                                 
                                    
                                       π
                                    
                                    
                                       Fore
                                    
                                 
                                 U
                                 
                                    
                                       
                                          t
                                       
                                    
                                 
                              
                           
                        We have:
                           
                              (2)
                              
                                 K
                                 
                                    
                                       
                                          t
                                          |
                                          μ
                                          ,
                                          Σ
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             2
                                             π
                                          
                                       
                                    
                                    
                                       -
                                       D
                                       /
                                       2
                                    
                                 
                                 det
                                 
                                    
                                       
                                          
                                             Σ
                                          
                                       
                                    
                                    
                                       -
                                       1
                                       /
                                       2
                                    
                                 
                                 exp
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      t
                                                      -
                                                      μ
                                                   
                                                
                                             
                                             
                                                T
                                             
                                          
                                          
                                             
                                                Σ
                                             
                                             
                                                -
                                                1
                                             
                                          
                                          
                                             
                                                
                                                   t
                                                   -
                                                   μ
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (3)
                              
                                 U
                                 
                                    
                                       
                                          t
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   1
                                                   /
                                                   Vol
                                                   
                                                      
                                                         
                                                            H
                                                         
                                                      
                                                   
                                                
                                                
                                                   iff
                                                   
                                                   t
                                                   ∈
                                                   H
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                                   iff
                                                   
                                                   t
                                                   
                                                   ∉
                                                   
                                                   H
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (4)
                              
                                 
                                    
                                       μ
                                    
                                    
                                       Back
                                    
                                 
                                 =
                                 E
                                 
                                    
                                       
                                          t
                                          |
                                          Back
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (5)
                              
                                 
                                    
                                       μ
                                    
                                    
                                       Fore
                                    
                                 
                                 =
                                 E
                                 
                                    
                                       
                                          t
                                          |
                                          Fore
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (6)
                              
                                 
                                    
                                       C
                                    
                                    
                                       Back
                                    
                                 
                                 =
                                 E
                                 
                                    
                                       
                                          
                                             
                                                
                                                   t
                                                   -
                                                   
                                                      
                                                         μ
                                                      
                                                      
                                                         Back
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      t
                                                      -
                                                      
                                                         
                                                            μ
                                                         
                                                         
                                                            Back
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                T
                                             
                                          
                                          |
                                          Back
                                       
                                    
                                 
                              
                           
                        where H is the support of the uniform pdf, 
                           
                              Vol
                              
                                 
                                    
                                       H
                                    
                                 
                              
                           
                         is the D-dimensional volume of H, and 
                           
                              Ψ
                           
                         is a constant diagonal matrix which accounts for the quantization and compression noise (see Section 3.3). Let us note 
                           
                              
                                 
                                    d
                                 
                                 
                                    h
                                 
                              
                              ,
                              
                                 
                                    e
                                 
                                 
                                    h
                                 
                              
                           
                         the minimum and maximum values of pixel feature 
                           
                              h
                              ∈
                              
                                 
                                    
                                       1
                                       ,
                                       2
                                       ,
                                       …
                                       ,
                                       D
                                    
                                 
                              
                           
                        , respectively. Then we have:
                           
                              (7)
                              
                                 H
                                 =
                                 
                                    
                                       
                                          
                                             
                                                d
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                e
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                 
                                 ×
                                 
                                    
                                       
                                          
                                             
                                                d
                                             
                                             
                                                2
                                             
                                          
                                          ,
                                          
                                             
                                                e
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                                 ×
                                 …
                                 ×
                                 
                                    
                                       
                                          
                                             
                                                d
                                             
                                             
                                                D
                                             
                                          
                                          ,
                                          
                                             
                                                e
                                             
                                             
                                                D
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (8)
                              
                                 Vol
                                 
                                    
                                       
                                          H
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∏
                                       
                                       
                                          h
                                          =
                                          1
                                       
                                       
                                          D
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                d
                                             
                                             
                                                h
                                             
                                          
                                          -
                                          
                                             
                                                e
                                             
                                             
                                                h
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

It must be highlighted that 
                           
                              
                                 
                                    μ
                                 
                                 
                                    Fore
                                 
                              
                           
                         is not used to compute the probability densities in any way. It is only needed when a sudden background change is detected, as explained in Section 3.4.

The Gaussian component 
                           
                              K
                              
                                 
                                    
                                       t
                                       |
                                       μ
                                       ,
                                       Σ
                                    
                                 
                              
                           
                         is able to capture a wide range of dynamic backgrounds because 
                           
                              
                                 
                                    C
                                 
                                 
                                    Back
                                 
                              
                           
                         (and hence 
                           
                              
                                 
                                    C
                                 
                                 
                                    Back
                                 
                              
                              +
                              Ψ
                           
                        ) are not restricted to be diagonal matrices. On the other hand, the uniform component 
                           
                              U
                              
                                 
                                    
                                       t
                                    
                                 
                              
                           
                         is able to model foreground objects of any kind equally well.

The class probabilities of the observed value 
                           
                              
                                 
                                    t
                                 
                                 
                                    n
                                 
                              
                           
                         of a pixel at time step n are given by:
                           
                              (9)
                              
                                 ∀
                                 i
                                 ∈
                                 
                                    
                                       
                                          Back
                                          ,
                                          Fore
                                       
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       R
                                    
                                    
                                       ni
                                    
                                 
                                 =
                                 P
                                 
                                    
                                       
                                          i
                                          |
                                          
                                             
                                                t
                                             
                                             
                                                n
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             π
                                          
                                          
                                             i
                                          
                                       
                                       p
                                       
                                          
                                             
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      n
                                                   
                                                
                                                |
                                                i
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             π
                                          
                                          
                                             Back
                                          
                                       
                                       p
                                       
                                          
                                             
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      n
                                                   
                                                
                                                |
                                                Back
                                             
                                          
                                       
                                       +
                                       
                                          
                                             π
                                          
                                          
                                             Fore
                                          
                                       
                                       p
                                       
                                          
                                             
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      n
                                                   
                                                
                                                |
                                                Fore
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

That is, 
                           
                              
                                 
                                    R
                                 
                                 
                                    n
                                    ,
                                    Back
                                 
                              
                           
                         and 
                           
                              
                                 
                                    R
                                 
                                 
                                    n
                                    ,
                                    Fore
                                 
                              
                           
                         are the posterior probabilities that the pixel belongs to the background or the foreground, respectively.

Under the Bayesian framework, a pixel is declared to belong to the foreground at time step n if and only if 
                           
                              
                                 
                                    R
                                 
                                 
                                    n
                                    ,
                                    Fore
                                 
                              
                              >
                              
                                 
                                    R
                                 
                                 
                                    n
                                    ,
                                    Back
                                 
                              
                           
                        . However, it is sometimes advantageous to introduce a probability threshold 
                           
                              ρ
                              ∈
                              
                                 
                                    
                                       0
                                       ,
                                       1
                                    
                                 
                              
                           
                         so that it is decided that a pixel belongs to the foreground when the following condition holds:
                           
                              (10)
                              
                                 
                                    
                                       R
                                    
                                    
                                       n
                                       ,
                                       Fore
                                    
                                 
                                 >
                                 ρ
                              
                           
                        
                     

Unless otherwise noticed we will make Bayesian decisions, i.e. 
                           
                              ρ
                              =
                              0.5
                           
                        .

Several previous approaches to the background modeling problem have used algorithms which can be related to the stochastic approximation framework. For example, the parameter update scheme of the adaptive Gaussian mixture model in [40,18,30] can be seen as a stochastic approximation learning algorithm for a mixture of Gaussians. From the theoretical point of view this is because stochastic approximation applied to a mixture of Gaussians is a recursive (online) method for the maximization of the likelihood [50], which has led to the algorithm in [51]. This framework can also be applied to probabilistic self-organizing maps, as demonstrated in [25].

When applied to the probabilistic model given in the previous section, the Robbins-Monro stochastic approximation algorithm yields the following update equations at time step n for an observed pixel value 
                           
                              
                                 
                                    t
                                 
                                 
                                    n
                                 
                              
                           
                         (see [24] for details):
                           
                              (11)
                              
                                 ∀
                                 i
                                 ∈
                                 
                                    
                                       
                                          Back
                                          ,
                                          Fore
                                       
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       π
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       
                                          n
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          1
                                          -
                                          ∊
                                       
                                    
                                 
                                 
                                    
                                       π
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       
                                          n
                                          -
                                          1
                                       
                                    
                                 
                                 +
                                 ∊
                                 
                                    
                                       R
                                    
                                    
                                       ni
                                    
                                 
                              
                           
                        
                        
                           
                              (12)
                              
                                 ∀
                                 i
                                 ∈
                                 
                                    
                                       
                                          Back
                                          ,
                                          Fore
                                       
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       m
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       
                                          n
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          1
                                          -
                                          ∊
                                       
                                    
                                 
                                 
                                    
                                       m
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       
                                          n
                                          -
                                          1
                                       
                                    
                                 
                                 +
                                 ∊
                                 
                                    
                                       R
                                    
                                    
                                       ni
                                    
                                 
                                 
                                    
                                       t
                                    
                                    
                                       n
                                    
                                 
                              
                           
                        
                        
                           
                              (13)
                              
                                 ∀
                                 i
                                 ∈
                                 
                                    
                                       
                                          Back
                                          ,
                                          Fore
                                       
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       μ
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       
                                          n
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             m
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             
                                                n
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             π
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             
                                                n
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (14)
                              
                                 
                                    
                                       M
                                    
                                    
                                       Back
                                    
                                 
                                 
                                    
                                       
                                          n
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          1
                                          -
                                          ∊
                                       
                                    
                                 
                                 
                                    
                                       M
                                    
                                    
                                       Back
                                    
                                 
                                 
                                    
                                       
                                          n
                                          -
                                          1
                                       
                                    
                                 
                                 +
                                 ∊
                                 
                                    
                                       R
                                    
                                    
                                       n
                                       ,
                                       Back
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                t
                                             
                                             
                                                n
                                             
                                          
                                          -
                                          
                                             
                                                μ
                                             
                                             
                                                Back
                                             
                                          
                                          
                                             
                                                
                                                   n
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   t
                                                
                                                
                                                   n
                                                
                                             
                                             -
                                             
                                                
                                                   μ
                                                
                                                
                                                   Back
                                                
                                             
                                             
                                                
                                                   
                                                      n
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       T
                                    
                                 
                              
                           
                        
                        
                           
                              (15)
                              
                                 
                                    
                                       C
                                    
                                    
                                       Back
                                    
                                 
                                 
                                    
                                       
                                          n
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             M
                                          
                                          
                                             Back
                                          
                                       
                                       
                                          
                                             
                                                n
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             π
                                          
                                          
                                             Back
                                          
                                       
                                       
                                          
                                             
                                                n
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              ∊
                           
                         is a constant step size, which we have set to 
                           
                              ∊
                              =
                              0.01
                           
                         in all the experiments. The step size is constant (and not decaying) because the system is time varying, as considered in Section 3.2 of [20]. The larger 
                           
                              ∊
                           
                        , the bigger the modifications of the model parameters. Eq. (11) is used to update the a priori probabilities 
                           
                              
                                 
                                    π
                                 
                                 
                                    i
                                 
                              
                           
                         of the foreground and background classes, depending on their posterior probabilities according to the observed data. The mean vectors 
                           
                              
                                 
                                    μ
                                 
                                 
                                    i
                                 
                              
                           
                         are modified through (13), where 
                           
                              
                                 
                                    m
                                 
                                 
                                    i
                                 
                              
                           
                         are auxiliary variables which store a weighted averages of the observed data with the posterior probabilities being the weights (12). Finally, the covariance matrix of the background class 
                           
                              
                                 
                                    C
                                 
                                 
                                    Back
                                 
                              
                           
                         is learned by (15), with 
                           
                              
                                 
                                    M
                                 
                                 
                                    Back
                                 
                              
                           
                         playing the role of an auxiliary variable which stores a weighted average where the weights are the posterior probabilities (14).

The diagonal noise matrix 
                           
                              Ψ
                           
                         models the effects of pixel quantization and compression, which are sources of background noise. This is estimated separately from 
                           
                              
                                 
                                    C
                                 
                                 
                                    Back
                                 
                              
                           
                         because these effects appear and disappear suddenly from one frame to the next, so that they cannot be captured adequately by the stochastic approximation learning algorithm. Stochastic approximation filters out these abrupt changes and does not learn from them. In contrast to this, the elements of 
                           
                              
                                 
                                    C
                                 
                                 
                                    Back
                                 
                              
                           
                         model the variability of the pixel data which is due to the true background color signal, which changes smoothly through time. This smooth variation can be learned by stochastic approximation, i.e. it is not filtered out by the update equations of Section 3.2. In other words, 
                           
                              
                                 
                                    C
                                 
                                 
                                    Back
                                 
                              
                           
                         models the low frequency component of the background color signal while 
                           
                              Ψ
                           
                         models the high frequency component. Hence, 
                           
                              Ψ
                           
                         and 
                           
                              
                                 
                                    C
                                 
                                 
                                    Back
                                 
                              
                           
                         model two fundamentally different processes, both of which affect the observed color data.

We assume that the quantization and compression effects are approximately equal for all the pixels, so that an offline estimation of a global and constant value of 
                           
                              Ψ
                           
                         is carried out. The matrix is given by
                           
                              (16)
                              
                                 Ψ
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                                
                                                   0
                                                
                                                
                                                   …
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         2
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                                
                                                   …
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   …
                                                
                                                
                                                   …
                                                
                                                
                                                   …
                                                
                                                
                                                   …
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                                   0
                                                
                                                
                                                   …
                                                
                                                
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         D
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The noise parameters may be estimated by comparing the original, uncompressed pixels 
                           
                              τ
                              
                                 
                                    
                                       x
                                    
                                 
                              
                           
                         with the observed (compressed) pixels 
                           
                              t
                              
                                 
                                    
                                       x
                                    
                                 
                              
                           
                         for a selection of videos:
                           
                              (17)
                              
                                 ∀
                                 i
                                 ∈
                                 
                                    
                                       
                                          1
                                          ,
                                          …
                                          ,
                                          D
                                       
                                    
                                 
                                 
                                 
                                    
                                       σ
                                    
                                    
                                       i
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 E
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            τ
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               x
                                                            
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            t
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               x
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where the expectation is computed by averaging over all the pixels in the video selection. Please note that this estimation is carried out offline (that is, 
                           
                              Ψ
                           
                         is a constant throughout the online learning). In practice, it is often found that the original values 
                           
                              τ
                              
                                 
                                    
                                       x
                                    
                                 
                              
                           
                         cannot be obtained because the video is available in compressed format only. This problem is solved by estimating the original values by application of a rotationally symmetric Gaussian low pass filter of size 
                           
                              3
                              ×
                              3
                           
                         pixels with standard deviation 
                           
                              0.5
                           
                        . The filtered values are taken as estimations 
                           
                              
                                 
                                    
                                       
                                          τ
                                       
                                       
                                          ^
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                           
                         of the original values 
                           
                              
                                 
                                    τ
                                 
                                 
                                    i
                                 
                              
                           
                        :
                           
                              (18)
                              
                                 ∀
                                 i
                                 ∈
                                 
                                    
                                       
                                          1
                                          ,
                                          …
                                          ,
                                          D
                                       
                                    
                                 
                                 
                                 
                                    
                                       σ
                                    
                                    
                                       i
                                    
                                    
                                       2
                                    
                                 
                                 ≈
                                 E
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  τ
                                                               
                                                               
                                                                  ^
                                                               
                                                            
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               x
                                                            
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            t
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               x
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where the expectation is computed by averaging over all the pixels in the first frame of the video.

Sometimes an object integrates into the background, for example when a car is parked. This produces a sudden change in the background distributions of many pixels, i.e. those which are inside the arriving object. The same effect happens when an object which was a part of the background departs. We must take care of these events separately [21]. As pointed out by Kushner & Yin in Section 3.2 of [20], stochastic approximation of time varying systems is only advisable when the rate of change of the estimated parameters is slow. Hence, these sudden changes must be managed in a different procedure which detects these situations that the stochastic approximation framework is unable to model.

The detection procedure needs a previous offline study. Let 
                           
                              χ
                           
                         be the ground truth for a particular pixel:
                           
                              (19)
                              
                                 χ
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   1
                                                   
                                                   
                                                
                                                
                                                   iff
                                                   
                                                   the
                                                   
                                                   pixel
                                                   
                                                   belongs
                                                   
                                                   to
                                                   
                                                   the
                                                   
                                                   foreground
                                                
                                             
                                             
                                                
                                                   0
                                                   
                                                   
                                                
                                                
                                                   iff
                                                   
                                                   the
                                                   
                                                   pixel
                                                   
                                                   belongs
                                                   
                                                   to
                                                   
                                                   the
                                                   
                                                   background
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Then, let 
                           
                              
                                 
                                    χ
                                 
                                 
                                    ∼
                                 
                              
                           
                         be the estimation of 
                           
                              χ
                           
                         carried out by the basic algorithm, i.e. without sudden background change detection. That is, 
                           
                              
                                 
                                    χ
                                 
                                 
                                    ∼
                                 
                              
                              =
                              1
                           
                         iff the pixel is classified as foreground by the basic algorithm, and 
                           
                              
                                 
                                    χ
                                 
                                 
                                    ∼
                                 
                              
                              =
                              0
                           
                         otherwise.

The basic algorithm works correctly if and only if 
                           
                              
                                 
                                    χ
                                 
                                 
                                    ∼
                                 
                              
                              =
                              χ
                           
                        . We define three disjoint random events: undetected background change (Change), correct foreground detection (Good) and other situations that we are not interested in (Other):
                           
                              (20)
                              
                                 Change
                                 ≡
                                 
                                    
                                       
                                          
                                             
                                                χ
                                             
                                             
                                                ∼
                                             
                                          
                                          =
                                          1
                                       
                                    
                                 
                                 ∧
                                 
                                    
                                       
                                          χ
                                          =
                                          0
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (21)
                              
                                 Good
                                 ≡
                                 
                                    
                                       
                                          
                                             
                                                χ
                                             
                                             
                                                ∼
                                             
                                          
                                          =
                                          1
                                       
                                    
                                 
                                 ∧
                                 
                                    
                                       
                                          χ
                                          =
                                          1
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (22)
                              
                                 Other
                                 ≡
                                 
                                    
                                       χ
                                    
                                    
                                       ∼
                                    
                                 
                                 =
                                 0
                              
                           
                        
                     

At frame n, the number of frames 
                           
                              z
                              
                                 
                                    
                                       n
                                    
                                 
                              
                           
                         that the pixel has been continuously classified as foreground is defined as follows:
                           
                              (23)
                              
                                 z
                                 
                                    
                                       
                                          n
                                       
                                    
                                 
                                 =
                                 
                                    max
                                 
                                 
                                    
                                       
                                          N
                                          
                                          |
                                          
                                          
                                             
                                                χ
                                             
                                             
                                                ∼
                                             
                                          
                                          
                                             
                                                
                                                   n
                                                
                                             
                                          
                                          =
                                          
                                             
                                                χ
                                             
                                             
                                                ∼
                                             
                                          
                                          
                                             
                                                
                                                   n
                                                   -
                                                   1
                                                
                                             
                                          
                                          =
                                          ⋯
                                          =
                                          
                                             
                                                χ
                                             
                                             
                                                ∼
                                             
                                          
                                          
                                             
                                                
                                                   n
                                                   -
                                                   N
                                                
                                             
                                          
                                          =
                                          1
                                       
                                    
                                 
                              
                           
                        
                     

Please note that 
                           
                              z
                              
                                 
                                    
                                       n
                                    
                                 
                              
                           
                         is readily computed by a running counter which is incremented each frame that 
                           
                              
                                 
                                    χ
                                 
                                 
                                    ∼
                                 
                              
                              =
                              1
                           
                         and reset to zero each time that 
                           
                              
                                 
                                    χ
                                 
                                 
                                    ∼
                                 
                              
                              =
                              0
                           
                        . The offline task consists in estimating the probabilities 
                           
                              P
                              
                                 
                                    
                                       Good
                                       
                                       |
                                       
                                       z
                                       ,
                                       
                                          
                                             χ
                                          
                                          
                                             ∼
                                          
                                       
                                       =
                                       1
                                    
                                 
                              
                           
                         and 
                           
                              P
                              
                                 
                                    
                                       Change
                                       
                                       |
                                       
                                       z
                                       ,
                                       
                                          
                                             χ
                                          
                                          
                                             ∼
                                          
                                       
                                       =
                                       1
                                    
                                 
                              
                           
                        . This is accomplished by counting the number of times that Change and Good are verified for a certain value of z, where we take as input samples the values of 
                           
                              z
                              
                                 
                                    
                                       n
                                    
                                 
                              
                           
                         for all frames n and all pixels such that 
                           
                              
                                 
                                    χ
                                 
                                 
                                    ∼
                                 
                              
                              =
                              1
                           
                        . These pixel counts are noisy functions of z that are smoothed by kernel regression before estimating the probabilities.

Then we compute a threshold Z:
                           
                              (24)
                              
                                 Z
                                 =
                                 
                                    min
                                 
                                 
                                    
                                       
                                          z
                                          
                                          |
                                          
                                          P
                                          
                                             
                                                
                                                   Change
                                                   |
                                                   z
                                                   ,
                                                   
                                                      
                                                         χ
                                                      
                                                      
                                                         ∼
                                                      
                                                   
                                                   =
                                                   1
                                                
                                             
                                          
                                          >
                                          
                                             
                                                1
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The computation of Z finishes the offline study. We have found by studying several videos that 
                           
                              Z
                              =
                              250
                           
                         is a good compromise between the adaptation to sudden changes and the stability of the background model, so we have used that value in all the experiments.

When the online system is operating, in each pixel we maintain a running counter of the number of frames z. If we have at frame n that a pixel is classified as foreground and 
                           
                              z
                              
                                 
                                    
                                       n
                                    
                                 
                              
                              ⩾
                              Z
                           
                        , then that pixel must be reset. The pixel reset procedure involves setting 
                           
                              
                                 
                                    C
                                 
                                 
                                    Back
                                 
                              
                              =
                              0
                           
                        , which corresponds to setting 
                           
                              Σ
                              =
                              Ψ
                           
                         as the covariance matrix for the Gaussian mixture component in (2). Please note that it is 
                           
                              Σ
                           
                         and not 
                           
                              
                                 
                                    C
                                 
                                 
                                    Back
                                 
                              
                           
                         the matrix that must be invertible, and 
                           
                              Ψ
                           
                         is never zero, so the matrix inversion in (2) is always possible. Additionally, we swap 
                           
                              
                                 
                                    μ
                                 
                                 
                                    Back
                                 
                              
                           
                         with 
                           
                              
                                 
                                    μ
                                 
                                 
                                    Fore
                                 
                              
                           
                        , and 
                           
                              
                                 
                                    m
                                 
                                 
                                    Back
                                 
                              
                           
                         with 
                           
                              
                                 
                                    m
                                 
                                 
                                    Fore
                                 
                              
                           
                        .

Here we outline the initialization procedure to be carried out at the beginning of the execution of the method. The first L frames of the analyzed video sequence are used for this purpose, with 
                           
                              L
                              =
                              100
                           
                         in our experiments. The background model of every pixel is set up according to the L pixel value samples obtained from those first frames. Hence we have:
                           
                              (25)
                              
                                 ∀
                                 i
                                 ∈
                                 
                                    
                                       
                                          Back
                                          ,
                                          Fore
                                       
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       π
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       
                                          0
                                       
                                    
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                              
                           
                        
                        
                           
                              (26)
                              
                                 
                                    
                                       m
                                    
                                    
                                       Back
                                    
                                 
                                 
                                    
                                       
                                          0
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             π
                                          
                                          
                                             Back
                                          
                                       
                                       
                                          
                                             
                                                0
                                             
                                          
                                       
                                    
                                    
                                       L
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          L
                                       
                                    
                                 
                                 
                                    
                                       t
                                    
                                    
                                       j
                                    
                                 
                              
                           
                        
                        
                           
                              (27)
                              
                                 
                                    
                                       μ
                                    
                                    
                                       Back
                                    
                                 
                                 
                                    
                                       
                                          0
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             m
                                          
                                          
                                             Back
                                          
                                       
                                       
                                          
                                             
                                                0
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             π
                                          
                                          
                                             Back
                                          
                                       
                                       
                                          
                                             
                                                0
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (28)
                              
                                 
                                    
                                       M
                                    
                                    
                                       Back
                                    
                                 
                                 
                                    
                                       
                                          0
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             π
                                          
                                          
                                             Back
                                          
                                       
                                       
                                          
                                             
                                                0
                                             
                                          
                                       
                                    
                                    
                                       L
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          L
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                t
                                             
                                             
                                                j
                                             
                                          
                                          -
                                          
                                             
                                                μ
                                             
                                             
                                                Back
                                             
                                          
                                          
                                             
                                                
                                                   0
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   t
                                                
                                                
                                                   j
                                                
                                             
                                             -
                                             
                                                
                                                   μ
                                                
                                                
                                                   Back
                                                
                                             
                                             
                                                
                                                   
                                                      0
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       T
                                    
                                 
                              
                           
                        
                        
                           
                              (29)
                              
                                 
                                    
                                       C
                                    
                                    
                                       Back
                                    
                                 
                                 
                                    
                                       
                                          0
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             M
                                          
                                          
                                             Back
                                          
                                       
                                       
                                          
                                             
                                                0
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             π
                                          
                                          
                                             Back
                                          
                                       
                                       
                                          
                                             
                                                0
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

On the other hand, the initialization of 
                           
                              
                                 
                                    μ
                                 
                                 
                                    Fore
                                 
                              
                           
                         is not critical, since its value is not used for the first Z frames at least. We might start with the point at the center of H:
                           
                              (30)
                              
                                 
                                    
                                       μ
                                    
                                    
                                       Fore
                                    
                                 
                                 
                                    
                                       
                                          0
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            d
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            e
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                
                                             
                                             ,
                                             …
                                             ,
                                             
                                                
                                                   1
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            d
                                                         
                                                         
                                                            D
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            e
                                                         
                                                         
                                                            D
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       T
                                    
                                 
                              
                           
                        
                        
                           
                              (31)
                              
                                 
                                    
                                       m
                                    
                                    
                                       Fore
                                    
                                 
                                 
                                    
                                       
                                          0
                                       
                                    
                                 
                                 =
                                 
                                    
                                       π
                                    
                                    
                                       Fore
                                    
                                 
                                 
                                    
                                       
                                          0
                                       
                                    
                                 
                                 
                                    
                                       μ
                                    
                                    
                                       Fore
                                    
                                 
                                 
                                    
                                       
                                          0
                                       
                                    
                                 
                              
                           
                        
                     

Finally, the running counter is initialized with 
                           
                              z
                              
                                 
                                    
                                       0
                                    
                                 
                              
                              =
                              0
                           
                        .

@&#IMPLEMENTATION@&#

In this section the details of the implementation of the proposed method are discussed. From now on we will name it Multiple Feature Background Model (MFBM). Since the number of features D is not restricted, a fast and numerically stable implementation is of paramount importance to the practical applicability of the procedure.

The slowest part of the method is Eq. (2), i.e. the computation of the Gaussian probability density. It is 
                           
                              O
                              
                                 
                                    
                                       
                                          
                                             D
                                          
                                          
                                             3
                                          
                                       
                                    
                                 
                              
                           
                         due to the inversion of the covariance matrix 
                           
                              Σ
                           
                         and the computation of its determinant. The other equations are 
                           
                              O
                              
                                 
                                    
                                       
                                          
                                             D
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                              
                           
                         or lower. Moreover, matrix inversion is prone to numerical errors. Therefore, all efforts must be devoted to tune the implementation of (2).

The first step is to compute the Cholesky decomposition of 
                           
                              Σ
                           
                        , which is always possible because 
                           
                              Σ
                           
                         is known to be positive definite:
                           
                              (32)
                              
                                 Σ
                                 =
                                 
                                    
                                       LL
                                    
                                    
                                       T
                                    
                                 
                              
                           
                        where 
                           
                              L
                           
                         is a lower triangular matrix of size 
                           
                              D
                              ×
                              D
                           
                        . Then we note:
                           
                              (33)
                              
                                 y
                                 =
                                 
                                    
                                       L
                                    
                                    
                                       -
                                       1
                                    
                                 
                                 
                                    
                                       
                                          t
                                          -
                                          μ
                                       
                                    
                                 
                              
                           
                        which allows to obtain 
                           
                              y
                           
                         as the solution of a lower triangular linear system of equations:
                           
                              (34)
                              
                                 Ly
                                 =
                                 t
                                 -
                                 μ
                              
                           
                        
                     

Then we get:
                           
                              (35)
                              
                                 
                                    
                                       
                                          
                                             t
                                             -
                                             μ
                                          
                                       
                                    
                                    
                                       T
                                    
                                 
                                 
                                    
                                       Σ
                                    
                                    
                                       -
                                       1
                                    
                                 
                                 
                                    
                                       
                                          t
                                          -
                                          μ
                                       
                                    
                                 
                                 =
                                 
                                    
                                       y
                                    
                                    
                                       T
                                    
                                 
                                 y
                              
                           
                        so that the squared Mahalanobis distance in (2) is obtained without computing 
                           
                              
                                 
                                    Σ
                                 
                                 
                                    -
                                    1
                                 
                              
                           
                         explicitly. The described procedure is faster and more accurate than the explicit computation of 
                           
                              
                                 
                                    Σ
                                 
                                 
                                    -
                                    1
                                 
                              
                           
                        .

The final step is the computation of the determinant of 
                           
                              Σ
                           
                        :
                           
                              (36)
                              
                                 det
                                 
                                    
                                       
                                          Σ
                                       
                                    
                                 
                                 =
                                 det
                                 
                                    
                                       
                                          L
                                       
                                    
                                 
                                 det
                                 
                                    
                                       
                                          
                                             
                                                L
                                             
                                             
                                                T
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             det
                                             
                                                
                                                   
                                                      L
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                              
                           
                        where 
                           
                              det
                              
                                 
                                    
                                       L
                                    
                                 
                              
                           
                         is obtained as the product of the elements of the diagonal of 
                           
                              L
                           
                        . Again, this is a fast and accurate way to compute 
                           
                              det
                              
                                 
                                    
                                       Σ
                                    
                                 
                              
                           
                        .

Now we present the set of background features we have considered (Section 4.1). Some of them are well known, while others are novel. We have adjusted all of them so that their range of values is the interval 
                        
                           
                              
                                 
                                    0
                                    ,
                                    1
                                 
                              
                           
                        
                     . Section 4.2 studies the properties of the features, which have guided their choice. The last part of this section tests the detection performance of the features over three benchmark videos in order to check their suitability for foreground object detection (Section 4.3).

The first three features are the red, green and blue channels of the input frame. We note them as 
                           
                              
                                 
                                    F
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    F
                                 
                                 
                                    2
                                 
                              
                           
                         and 
                           
                              
                                 
                                    F
                                 
                                 
                                    3
                                 
                              
                           
                        , respectively, where 
                           
                              
                                 
                                    F
                                 
                                 
                                    i
                                 
                              
                           
                         are matrices of size 
                           
                              N
                              ×
                              M
                           
                        , i.e. the size of the input frames. Here we assume that the pixel values are real numbers in the interval 
                           
                              
                                 
                                    
                                       0
                                       ,
                                       1
                                    
                                 
                              
                           
                        .

As explained in Section 2, the normalized RGB channels are frequently used due to their robustness with respect to illumination changes [38,28,2,9]. They are obtained as follows:
                           
                              (37)
                              
                                 ∀
                                 i
                                 ∈
                                 
                                    
                                       
                                          4
                                          ,
                                          5
                                          ,
                                          6
                                       
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       F
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       F
                                    
                                    
                                       i
                                       -
                                       3
                                    
                                 
                                 ø
                                 G
                              
                           
                        
                        
                           
                              (38)
                              
                                 G
                                 =
                                 
                                    
                                       F
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       F
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       F
                                    
                                    
                                       3
                                    
                                 
                              
                           
                        where 
                           
                              ø
                           
                         stands for the elementwise division operator and 
                           
                              G
                           
                         is the sum of the three original channels. In case that some elements of 
                           
                              G
                           
                         are zero, we define the result of the division to be zero for these elements.

Next we consider the six Haar-like features of size 
                           
                              9
                              ×
                              9
                           
                         pixels considered in [14], which are weak features that convey texture information [43]:
                           
                              (39)
                              
                                 ∀
                                 i
                                 ∈
                                 
                                    
                                       
                                          7
                                          ,
                                          …
                                          12
                                       
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       F
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       3
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                             ,
                                             k
                                             =
                                             1
                                          
                                          
                                             9
                                          
                                       
                                       
                                          
                                             h
                                          
                                          
                                             i
                                             -
                                             6
                                             ,
                                             j
                                             ,
                                             k
                                          
                                       
                                    
                                 
                                 G
                                 ∗
                                 
                                    
                                       H
                                    
                                    
                                       i
                                       -
                                       6
                                    
                                 
                              
                           
                        where 
                           
                              ∗
                           
                         stands for the convolution operator. The six filters 
                           
                              
                                 
                                    H
                                 
                                 
                                    ·
                                 
                              
                           
                         are defined as follows:
                           
                              (40)
                              
                                 
                                    
                                       H
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         9
                                                         ,
                                                         3
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         0
                                                      
                                                      
                                                         9
                                                         ,
                                                         3
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         9
                                                         ,
                                                         3
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (41)
                              
                                 
                                    
                                       H
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       H
                                    
                                    
                                       1
                                    
                                    
                                       T
                                    
                                 
                              
                           
                        
                        
                           
                              (42)
                              
                                 
                                    
                                       H
                                    
                                    
                                       3
                                    
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   2
                                                   ·
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         4
                                                         ,
                                                         4
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         1
                                                         ,
                                                         1
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         0
                                                      
                                                      
                                                         4
                                                         ,
                                                         4
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         1
                                                         ,
                                                         1
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         1
                                                         ,
                                                         1
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         1
                                                         ,
                                                         1
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         0
                                                      
                                                      
                                                         4
                                                         ,
                                                         4
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         1
                                                         ,
                                                         1
                                                      
                                                   
                                                
                                                
                                                   2
                                                   ·
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         4
                                                         ,
                                                         4
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (43)
                              
                                 
                                    
                                       H
                                    
                                    
                                       4
                                    
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   2
                                                   ·
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         9
                                                         ,
                                                         4
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         9
                                                         ,
                                                         1
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         0
                                                      
                                                      
                                                         9
                                                         ,
                                                         4
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (44)
                              
                                 
                                    
                                       H
                                    
                                    
                                       5
                                    
                                 
                                 =
                                 
                                    
                                       H
                                    
                                    
                                       4
                                    
                                    
                                       T
                                    
                                 
                              
                           
                        
                        
                           
                              (45)
                              
                                 
                                    
                                       H
                                    
                                    
                                       6
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   1
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   1
                                                
                                                
                                                   0
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   1
                                                
                                                
                                                   1
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                                 ⊗
                                 
                                    
                                       1
                                    
                                    
                                       3
                                       ,
                                       3
                                    
                                 
                              
                           
                        where 
                           
                              ⊗
                           
                         stands for Kronecker product, 
                           
                              
                                 
                                    0
                                 
                                 
                                    m
                                    ,
                                    n
                                 
                              
                           
                         stands for a matrix of zeros of size 
                           
                              m
                              ×
                              n
                           
                        , and 
                           
                              
                                 
                                    1
                                 
                                 
                                    m
                                    ,
                                    n
                                 
                              
                           
                         stands for a matrix of ones of size 
                           
                              m
                              ×
                              n
                           
                        .

Gradient features are also useful because they are less affected by illumination changes, while they provide local texture information [21]. We estimate the gradient components with Sobel operator, and then we scale and translate them to lie in the interval 
                           
                              
                                 
                                    
                                       0
                                       ,
                                       1
                                    
                                 
                              
                           
                        . As mentioned before, the background model is not affected by these transformations:
                           
                              (46)
                              
                                 
                                    
                                       F
                                    
                                    
                                       13
                                    
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       1
                                    
                                    
                                       M
                                       ,
                                       N
                                    
                                 
                                 +
                                 
                                    
                                       1
                                    
                                    
                                       3
                                       ·
                                       8
                                    
                                 
                                 G
                                 ∗
                                 
                                    
                                       
                                          
                                             
                                                
                                                   -
                                                   1
                                                
                                                
                                                   0
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   -
                                                   2
                                                
                                                
                                                   0
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   -
                                                   1
                                                
                                                
                                                   0
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (47)
                              
                                 
                                    
                                       F
                                    
                                    
                                       14
                                    
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       1
                                    
                                    
                                       M
                                       ,
                                       N
                                    
                                 
                                 +
                                 
                                    
                                       1
                                    
                                    
                                       3
                                       ·
                                       8
                                    
                                 
                                 G
                                 ∗
                                 
                                    
                                       
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   2
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                                   0
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   -
                                                   1
                                                
                                                
                                                   -
                                                   2
                                                
                                                
                                                   -
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Next we introduce two features which consider both color information and a pixel adjacent to the pixel at hand, as a local indication of color texture. The first one is the red channel of the current pixel, normalized with the current pixel and the pixel immediately to the left of the current one:
                           
                              (48)
                              
                                 
                                    
                                       F
                                    
                                    
                                       15
                                    
                                 
                                 =
                                 
                                    
                                       F
                                    
                                    
                                       1
                                    
                                 
                                 ø
                                 
                                    
                                       
                                          G
                                          +
                                          
                                             
                                                GU
                                             
                                             
                                                n
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    U
                                 
                                 
                                    h
                                 
                              
                           
                         is the 
                           
                              h
                              ×
                              h
                           
                         upper shift matrix:
                           
                              (49)
                              
                                 ∀
                                 j
                                 ,
                                 k
                                 ∈
                                 
                                    
                                       
                                          1
                                          ,
                                          …
                                          h
                                       
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       U
                                    
                                    
                                       j
                                       ,
                                       k
                                    
                                 
                                 =
                                 I
                                 
                                    
                                       
                                          j
                                          +
                                          1
                                          =
                                          k
                                       
                                    
                                 
                              
                           
                        with 
                           
                              I
                           
                         standing for the indicator function.

The second one is the green channel of the pixel immediately to the lower right of the current one, normalized with the current pixel:
                           
                              (50)
                              
                                 
                                    
                                       F
                                    
                                    
                                       16
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                U
                                             
                                             
                                                m
                                             
                                          
                                          
                                             
                                                F
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                Q
                                             
                                             
                                                n
                                             
                                          
                                       
                                    
                                 
                                 ø
                                 G
                              
                           
                        where 
                           
                              
                                 
                                    Q
                                 
                                 
                                    h
                                 
                              
                           
                         is the 
                           
                              h
                              ×
                              h
                           
                         lower shift matrix:
                           
                              (51)
                              
                                 ∀
                                 j
                                 ,
                                 k
                                 ∈
                                 
                                    
                                       
                                          1
                                          ,
                                          …
                                          h
                                       
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       Q
                                    
                                    
                                       j
                                       ,
                                       k
                                    
                                 
                                 =
                                 I
                                 
                                    
                                       
                                          j
                                          =
                                          k
                                          +
                                          1
                                       
                                    
                                 
                              
                           
                        
                     

In order to include some robust features, we add versions of features 1 to 6 processed with the bidimensional median filter of window size 
                           
                              5
                              ×
                              5
                           
                         pixels, that we note 
                           
                              
                                 
                                    median
                                 
                                 
                                    5
                                    ,
                                    5
                                 
                              
                              
                                 
                                    
                                       ·
                                    
                                 
                              
                           
                        . The filter size has been chosen as a balance between the robustness (which needs larger sizes) and the precision of the object detection (which calls for a smaller size). This way we have:
                           
                              (52)
                              
                                 ∀
                                 i
                                 ∈
                                 
                                    
                                       
                                          17
                                          ,
                                          …
                                          ,
                                          22
                                       
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       F
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       median
                                    
                                    
                                       5
                                       ,
                                       5
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                F
                                             
                                             
                                                i
                                                -
                                                16
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Finally, we use two small filters of size 
                           
                              3
                              ×
                              3
                           
                         pixels to extract the texture information from the close vicinity of the pixel at hand:
                           
                              (53)
                              
                                 
                                    
                                       F
                                    
                                    
                                       23
                                    
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       3
                                       ·
                                       6
                                    
                                 
                                 G
                                 ∗
                                 
                                    
                                       
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   0
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   1
                                                
                                                
                                                   0
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   1
                                                
                                                
                                                   0
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (54)
                              
                                 
                                    
                                       F
                                    
                                    
                                       24
                                    
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       3
                                       ·
                                       8
                                    
                                 
                                 G
                                 ∗
                                 
                                    
                                       
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   1
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   1
                                                
                                                
                                                   0
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   1
                                                
                                                
                                                   1
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

This completes a set of 24 features. Features 15 to 22 are novel, while the others are more or less known in previous literature. Given a set of selected features 
                           
                              F
                              ⊂
                              
                                 
                                    
                                       1
                                       ,
                                       …
                                       ,
                                       24
                                    
                                 
                              
                           
                        , the input pattern for the pixel at frame coordinates 
                           
                              
                                 
                                    
                                       j
                                       ,
                                       k
                                    
                                 
                              
                           
                         is given by:
                           
                              (55)
                              
                                 
                                    
                                       t
                                    
                                    
                                       j
                                       ,
                                       k
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   F
                                                
                                                
                                                   i
                                                   ,
                                                   j
                                                   ,
                                                   k
                                                
                                             
                                          
                                       
                                    
                                    
                                       i
                                       ∈
                                       F
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    t
                                 
                                 
                                    j
                                    ,
                                    k
                                 
                              
                              ∈
                              
                                 
                                    
                                       
                                          0
                                          ,
                                          1
                                       
                                    
                                 
                                 
                                    D
                                 
                              
                           
                         because we have added the necessary scalings and translations in the previous feature definitions (37)–(54).

Next the properties of the above presented features that have guided their choice are studied. As mentioned in Section 4.1, one of the most typical difficulties encountered by foreground detection algorithms is that of illumination changes. In addition to this, quantization and compression artifacts are noise sources that can hamper the detection performance. In this section, a theoretical study of the robustness of the considered features with respect to these inconveniences is carried out. Furthermore, the size of the local pixel neighborhood which affects the value of a feature is also investigated.

To a first approximation, an illumination change can be expressed as a linear transform which scales the three RGB channels in the same way, so that the RGB features after an illumination change are given by:
                           
                              (56)
                              
                                 ∀
                                 i
                                 ∈
                                 
                                    
                                       
                                          1
                                          ,
                                          2
                                          ,
                                          3
                                       
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       
                                          
                                             F
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 λ
                                 
                                    
                                       F
                                    
                                    
                                       i
                                    
                                 
                              
                           
                        where 
                           
                              λ
                           
                         is the scaling factor. This implies that features 1 to 3 are affected by illumination changes, which is undesirable. On the other hand the normalized features, i.e. those where the RGB values are divided by the sum of the three RGB values, satisfy that
                           
                              (57)
                              
                                 ∀
                                 i
                                 ∈
                                 
                                    
                                       
                                          4
                                          ,
                                          5
                                          ,
                                          6
                                          ,
                                          15
                                          ,
                                          16
                                       
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       
                                          
                                             F
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       F
                                    
                                    
                                       i
                                    
                                 
                              
                           
                        which means that features 4, 5, 6, 15 and 16 are invariant to illumination variations to a first approximation. The Haar-like, gradient and small texture filter features behave the same way as the RGB features:
                           
                              (58)
                              
                                 ∀
                                 i
                                 ∈
                                 
                                    
                                       
                                          7
                                          ,
                                          …
                                          ,
                                          14
                                          ,
                                          23
                                          ,
                                          24
                                       
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       
                                          
                                             F
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 λ
                                 
                                    
                                       F
                                    
                                    
                                       i
                                    
                                 
                              
                           
                        where the translation of the gradient features (13 and 14) to make them lie in the interval 
                           
                              
                                 
                                    
                                       0
                                       ,
                                       1
                                    
                                 
                              
                           
                         is not affected by the 
                           
                              λ
                           
                         factor. The median filtered features (17 to 22) inherit the behavior of their original features (1 to 6).

Robustness under quantization and compression artifacts means that the value of a feature is not affected when a small fraction of pixels is corrupted by these noise sources. Out of the 24 chosen features, this desirable property is satisfied only by those that are based on robust statistics, i.e. the median filter based features (17 to 22). For the rest of the features, even a single corrupted pixel affects the final output.

Finally we study the radius of the local pixel neighborhood which contains all the pixels which affect the value of the feature at a given position. This is important because a large neighborhood means that the feature is less sensitive to small details, which can be beneficial if these details are irrelevant, but can also be a problem if these details correspond to portions of the foreground objects to be detected. The best radius will depend on the noise level, the size of the objects to be detected, and the robustness of the features. Feature 1 to 6 depend on the current pixel only, so the radius is zero. The Haar like features (7 to 12) are defined over 
                           
                              9
                              ×
                              9
                           
                         windows, so their radius is 4. The gradient and small texture features (13, 14, 23 and 24) are defined over 
                           
                              3
                              ×
                              3
                           
                         windows, so their radius is 1. The normalized texture features (15 and 16) also have radius 1 because they depend on the current pixel and on an adjacent one. Finally, the median filter features (17 to 22) have radius 2, because the filter window has size 
                           
                              5
                              ×
                              5
                           
                        .


                        Table 1
                         summarizes the properties of the studied features. The ‘Yes’ entries correspond to desirable characteristics of the features, while it can be observed that we have chosen a wide range of radii so as to cover many possible situations.

Next we measure the detection performance of the selected features. We have used the standard benchmark sequences Campus, Fountain and Video4. The Campus and Fountain sequences created by Li et al. [21] are available in their website.
                           1
                           
                              http://perception.i2r.a-star.edu.sg/bk_model/bk_index.html.
                        
                        
                           1
                         The Video4 sequence was created for an international competition on background/foreground segmentation, and it is also publicly available.
                           2
                           
                              http://mmc36.informatik.uni-augsburg.de/VSSN06_OSAC.
                        
                        
                           2
                        
                     

We have selected six quantitative performance measures to compare the segmentation methods we have considered. First of all, the accuracy of a method is obtained as follows (higher is better):
                           
                              (59)
                              
                                 AC
                                 =
                                 
                                    
                                       card
                                       
                                          
                                             
                                                A
                                                ∩
                                                B
                                             
                                          
                                       
                                    
                                    
                                       card
                                       
                                          
                                             
                                                A
                                                ∪
                                                B
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where ‘card’ stands for the number of elements of a set, A is the set of all pixels which belong to the foreground, and B is the set of all pixels which are classified as foreground by the analyzed method:
                           
                              (60)
                              
                                 A
                                 =
                                 
                                    
                                       
                                          t
                                          
                                          |
                                          
                                          χ
                                          
                                             
                                                
                                                   t
                                                
                                             
                                          
                                          =
                                          1
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (61)
                              
                                 B
                                 =
                                 
                                    
                                       
                                          t
                                          
                                          |
                                          
                                          
                                             
                                                χ
                                             
                                             
                                                ∼
                                             
                                          
                                          
                                             
                                                
                                                   t
                                                
                                             
                                          
                                          =
                                          1
                                       
                                    
                                 
                              
                           
                        
                     

On the other hand, the proportions of false negatives and false positives (lower is better) are given by:
                           
                              (62)
                              
                                 FN
                                 =
                                 
                                    
                                       card
                                       
                                          
                                             
                                                A
                                                ∩
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      ‾
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       card
                                       
                                          
                                             
                                                A
                                                ∪
                                                B
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (63)
                              
                                 FP
                                 =
                                 
                                    
                                       card
                                       
                                          
                                             
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      ‾
                                                   
                                                
                                                ∩
                                                B
                                             
                                          
                                       
                                    
                                    
                                       card
                                       
                                          
                                             
                                                A
                                                ∪
                                                B
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

From set theory we know that:
                           
                              (64)
                              
                                 AC
                                 ,
                                 
                                 FN
                                 ,
                                 
                                 FP
                                 ∈
                                 
                                    
                                       
                                          0
                                          ,
                                          1
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (65)
                              
                                 AC
                                 +
                                 FN
                                 +
                                 FP
                                 =
                                 1
                              
                           
                        
                     

The optimal performance would be achieved for 
                           
                              AC
                              =
                              1
                              ,
                              
                              FN
                              =
                              0
                              ,
                              
                              FP
                              =
                              0
                           
                        . On the other hand, the worst possible performance corresponds to 
                           
                              AC
                              =
                              0
                              ,
                              
                              FN
                              +
                              FP
                              =
                              1
                           
                        .

The precision and recall measures can be computed as follows (higher is better):
                           
                              (66)
                              
                                 PR
                                 =
                                 
                                    
                                       card
                                       
                                          
                                             
                                                A
                                                ∩
                                                B
                                             
                                          
                                       
                                    
                                    
                                       card
                                       
                                          
                                             
                                                B
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (67)
                              
                                 RC
                                 =
                                 
                                    
                                       card
                                       
                                          
                                             
                                                A
                                                ∩
                                                B
                                             
                                          
                                       
                                    
                                    
                                       card
                                       
                                          
                                             
                                                A
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (68)
                              
                                 PR
                                 ,
                                 
                                 RC
                                 ∈
                                 
                                    
                                       
                                          0
                                          ,
                                          1
                                       
                                    
                                 
                              
                           
                        
                     

Often there is a tradeoff between precision and recall, i.e. we can make one of them grow as desired at the expense of diminishing the other.

Finally, the F-measure combines precision and recall into an overall performance measure:
                           
                              (69)
                              
                                 FM
                                 =
                                 
                                    
                                       2
                                       ·
                                       PR
                                       ·
                                       RC
                                    
                                    
                                       PR
                                       +
                                       RC
                                    
                                 
                              
                           
                        
                     

The performance measures defined above are calculated for each sequence by averaging the yields obtained in each frame. However, we can also define these measures considering the complete sequence, where A is the sum of all the pixels corresponding to the foreground throughout the sequence and B the sum of the pixels considered as foreground for the method. We denote as F-measure’ the measure computed in this way.

We have made tests with all possible combinations of pairs of features and triples of features from those described in Section 4.1, and we have computed the six performance measures defined above, averaged over the three mentioned videos. It has been found that in general the best performance results are obtained by combining features from this set: 
                           
                              
                                 
                                    
                                       1
                                       ,
                                       
                                       2
                                       ,
                                       …
                                       ,
                                       
                                       6
                                       ,
                                       
                                       17
                                       ,
                                       
                                       18
                                       ,
                                       …
                                       ,
                                       
                                       24
                                    
                                 
                              
                           
                        . So, we have used this reduced set of 14 features to carry out tests with combinations of 4 and 5 features. Please note that it would have been unfeasible to carry out tests with all the combinations of 4 and 5 features from the original set of 24 features.

We must take into account that there are two pairs of measures which constitute tradeoffs: false positives versus false negatives and precision versus recall. In order to identify easily the best performing combinations of features under this multiobjective optimization context, we consider the Pareto front concept [22,1,23,37]. In particular, we compute the Pareto front of the set of tested combinations of i features, for 
                           
                              i
                              ∈
                              
                                 
                                    
                                       2
                                       ,
                                       3
                                       ,
                                       4
                                       ,
                                       5
                                    
                                 
                              
                           
                         and for each of the following pairs of measures: 
                           
                              
                                 
                                    
                                       FN
                                       ,
                                       
                                       FP
                                    
                                 
                              
                           
                        ; 
                           
                              
                                 
                                    
                                       PR
                                       ,
                                       
                                       RC
                                    
                                 
                              
                           
                        ; and 
                           
                              
                                 
                                    
                                       AC
                                       ,
                                       
                                       FM
                                    
                                 
                              
                           
                        . A combination of i features belongs to the Pareto front of the set of combinations of i features for a pair of performance measures if and only if there is no other combination of i features that is better in both performance measures. The configurations (combinations of features) which belong to a Pareto front are the most outstanding ones.


                        Figs. 1–6
                        
                        
                        
                        
                        
                         depict the obtained results. Each data point in the plots corresponds to the average performance measures obtained by a particular set of features, computed over the three benchmark videos mentioned above. We have marked the classic RGB features with a large black spot, i.e. the result for the set of features 
                           
                              
                                 
                                    
                                       1
                                       ,
                                       
                                       2
                                       ,
                                       
                                       3
                                    
                                 
                              
                           
                        . Several conclusions can be drawn from them:
                           
                              •
                              The standard RGB features yield rather poor results in all respects. Most of the other combinations outperform this one.

The accuracy and the F-measure are strongly correlated (Fig. 5), and they can be regarded as global performance measures. On the other hand, there are tradeoffs among false positives versus false negatives and precision versus recall (Figs. 1–4), as mentioned before.

In general the performance improves as we add more features, but the improvement is progressively smaller (see Figs. 2, 4 and 6). Hence, we reach a point where it is not worthwhile to increase the computational complexity to gain little performance.

For the false positives versus false negatives and precision versus recall plots (Figs. 1–4), the majority of the configurations are close to the Pareto fronts, with a minority of clearly bad ones. On the other hand, the accuracy versus F-measure plots are more discriminant (Figs. 5 and 6).

We have chosen 10 configurations which yield outstanding results, from those which belong to the Pareto fronts and those which give high values of AC and FM. They are listed on Table 2
                        , along with their performance measures. From this table we can extract more useful information:
                           
                              •
                              All the configurations contain a majority of median filtered features (features 17 to 22). This means that median filtering is particularly effective at removing background noise.

Among the median filtered features, those which appear the most often are features 20 to 22, i.e. the median filtered, normalized RGB channels. So, the resilience against illumination changes of normalization also improves the discrimination between background and foreground.

Haar-like filters, gradient filters and color textures do not appear. Hence, they are non optimal for probabilistic mixture background modeling.

Now that we have studied the comparative performance of the 24 considered features, we are ready to compare our method with state-of-the-art proposals, which we do on Section 5.

@&#EXPERIMENTAL RESULTS@&#

In this section we are going to show the performance of our proposal against different state-of-the-art video segmentation methods.
                        3
                        The source code and several demos of our proposal are available at http://www.lcc.uma.es/%7Eezeqlr/backfeat/backfeat.html.
                     
                     
                        3
                      For this study, we have tested several video sequences with various situations and a large number of configurations for each method. First of all, the competing methods and the tested sequences are described (Sections 5.1 and 5.2, respectively). Then the effect of using full covariance matrices in our proposal is assessed (Section 5.3). Section 5.4 is devoted to discuss the parameter choices for the tested approaches. Qualitative and quantitative results over standard benchmark videos are given in Sections 5.5 and 5.6, respectively. Finally two additional sets of experiments are reported, namely the Receiver Operating Characteristic (ROC) curves corresponding to different sets of features for our proposal (Section 5.7); and a comparison of the tested approaches for videos recorded under difficult conditions (Section 5.8).

@&#METHODS@&#

Our method analyzes the scene pixel by pixel, so we have chosen five reference methods that are of this kind, i.e. the so-called pixel-level methods. The oldest we tested is Pfinder, proposed in [45], that we call WrenGA. It features a single Gaussian. We also analyze three Mixture of Gaussians approaches: GrimsonGMM, GMMV1 and GMMV2. GrimsonGMM is described in [40], while GMMV1 and GMMV2 are developed in [18,49] respectively. To complete the study we tested a fuzzy approach to a self-organizing background subtraction (SOBS) algorithm [26] named FASOM. In order to test these methods we have considered the implementation from version 1.3.0 of the BGS library, accessible from its website.
                           4
                           
                              https://github.com/andrewssobral/bgslibrary.
                        
                        
                           4
                         This library is written in C++ language and uses the free OpenCV Computer Vision library.
                           5
                           
                              http://opencv.org/.
                        
                        
                           5
                         We must also highlight that the GMMV1 and GMMV2 are the current standard methods for the OpenCV library.

To prove our proposed method we have used an implementation in Matlab, in which we use MEX files for those more time-demanding parts and Matlab scripts for the rest.

In our aim to make a comparison as fair as possible, it has not been used any post-processing in any of the methods tested. All the experiments reported on this paper have been carried out on a 64-bit Personal Computer with a quad core 3.10GHz CPU, 6GB RAM and standard hardware. The implementation of our method does not use any GPU resources, so it does not require any specific graphics hardware.

In video surveillance it is usual to find problematic situations as abrupt lighting changes, static or moving backgrounds, and foreground object’s pixel features which may be subsumed by the modeled background. For this reason we have selected six standard videos with outdoor and indoor video sequences which exemplify these situations (Sections 5.5, 5.6, 5.7). We have also tested our proposal over four additional videos showing especially challenging situations (Section 5.8).

First of all the standard videos are described. Three videos have been taken from the dataset developed by Li et al. [21] available in his website
                           6
                           
                              http://perception.i2r.a-star.edu.sg/bk_model/bk_index.html.
                        
                        
                           6
                        : an indoor video named moving curtain (MR) and an outdoor video named water surface (WS), whose main characteristic is that the background is constantly moving. Another test video is lobby (LB) whose peculiarity is the sudden changes of illumination.

A video featuring a 3D object moving through a real background scene has been added to the benchmarks. This kind of videos has the advantage that getting the ground truth is simple because, as the 3D object has been added by computer, we easily know which pixels belong to the 3D object in the sequence. The video named Video2 (V2) is an example of this and was created by the International Conference VSSN’06, on the occasion of an algorithm competition in Foreground/Background Segmentation.
                           7
                           
                              http://mmc36.informatik.uni-augsburg.de/VSSN06_OSAC.
                        
                        
                           7
                        
                     

We have also selected other videos used in the literature, such as a video from CAVIAR dataset.
                           8
                           
                              http://homepages.inf.ed.ac.uk/rbf/CAVIARDATA1/.
                        
                        
                           8
                         But only a sequence has been used due to the difficulty with getting the ground truth: one shop corridor (OS). And we have completed the experiments with an outdoor sequence named level crossing (LC).
                           9
                           
                              http://www.cs.cmu.edu/∼yaser/.
                        
                        
                           9
                        
                     

The set of additional sequences has been chosen from two other well known datasets: ChangeDetection.net
                           10
                           
                              http://www.changedetection.net/.
                        
                        
                           10
                         and the BMC 2012 benchmark.
                           11
                           
                              http://bmc.univ-bpclermont.fr/.
                        
                        
                           11
                         The first two sequences with adverse weather conditions named blizzard (BL) and snowFall (SF) are from ChangeDetection.net. The sequence named tunnel (TL) featuring heterogeneous lighting and the sequence named windy day (WD) showing a traffic camera with fast moving cars are available in BMC 2012 benchmark. As mentioned earlier, due to their special characteristics these videos are studied separately in Section 5.8.

As previously pointed out, our method uses the full covariance matrix. To assess its performance against a diagonal covariance matrix we have compared both alternatives. The results can be seen in Figs. 7–12
                        
                        
                        
                        
                        
                         which show the average performance of the studied configurations (see Section 5.4) both the full covariance matrix and the diagonal covariance matrix. The use of a full covariance matrix achieved fewer FP without significantly increasing FN (Fig. 8). In terms of PR and RC, the full covariance matrix is able to improve PR without worsening RC (Fig. 10). Based on AC versus F-measure results, the best performance is achieved by using the full covariance matrix (Fig. 12). It is also worth noting that the worst configurations with the full matrix attain results similar to those of the best configurations that use a diagonal covariance matrix (Fig. 11). These results support the use of a full covariance matrix in our model (Section 3). However, it must be taken into account that any distribution can be approximated to the desired degree of accuracy with a large enough number of diagonal Gaussian mixture components.

The set of test parameters are shown in Table 3
                        . For the proposed algorithm we have tuned the step size 
                           
                              ε
                           
                         and the set of features 
                           
                              F
                           
                        , using 5 and 10 different values respectively, so we tested a total of 50 different configurations. For competitors we tested different values of all parameters that could be tuned according to the BGS implementation we have used. We tried the values recommended in the articles corresponding to these methods, we also included those configurations which are used by default in BGS implementations and we have made an additional selection of parameters that performed well but were not among those which have been mentioned before. We tested a large range of values for those parameters whose values affect most significantly the result. For example, we have considered more than 300 different configurations for the FASOM method, due to its large number of adjustable parameters.

The evaluation procedure has involved testing in each method all configurations discussed above for the six benchmark videos. The average performance of these configurations over the sequences is shown in Figs. 13–18
                        
                        
                        
                        
                        
                        , using the measures explained in Section 4.3. Each point in these plots indicates the average value obtained from a configuration for the six test videos.

In Figs. 19–22
                        
                        
                        
                         we show some qualitative results of the studied methods. Rows correspond to different frames of a benchmark video. The first and the second column are the original frame and the foreground mask (ground truth), respectively. Remaining columns are, in order, the results of applying methods MFBM, FASOM, GMMV2, GMMV1, GrimsonGMM and WrenGA to the frames. We use the setting that performed best according to F-measure for each of these sequences; see Table 6 for details.

There are some common problems that usually affect segmentation methods, for example camouflage and cast shadow. The camouflage problem seems to affect our method to a lesser degree than the other methods. This situation occurs when a method is not able to distinguish nearby pixels of the same color, some belonging to the background and others to the foreground, segmenting them wrongly. This can be seen in varying degrees in all the videos (Figs. 19–22), but particularly clearly in videos MR and LB (rows 2 and 3 of Figs. 20 and 21). However it must be said that there are particularly difficult situations where our method also fails to segment the foreground correctly due to the camouflage, just as the competitor methods do, e.g. video OS (row 4, Fig. 22).

Cast shadow problems occur when a method erroneously incorporates shadows into the foreground. Good examples of this problem can be found in the frames of MR (Fig. 20), some frames of LB (Fig. 21, second and third row) and in particular the OS sequence (rows 4 and 5, Fig. 22). In these cases we see that GMMV1 method virtually avoids these undesirable effects, but at the expense of a large number of false negatives, something that can be noticed in Fig. 14. WrenGA is also a robust method in this regard and it has many false negatives too, but it is not so remarkable as the case of GMMV1.

Another common problem is to confuse a moving background as part of the foreground. WS sequence (Fig. 19, rows 1 and 2) shows an exterior frame with this situation in which our method successfully finds the foreground, and at the same time it correctly segments the moving background. On the other hand, methods like GMMV2, WrenGA and less evidently FASOM, fail to segment the background. Furthermore, GrimsomGMM and GMMV1 do not have this problem, but they suffer from other troubles that make the result worse than that of our method.

As discussed before, the LB video (Fig. 21) is an interesting example of sudden illumination changes that occur in real applications. FASOM, WrenGA and MFBM show similar behavior with respect to a sudden change in lighting (Fig. 21, row 1). However our method is better in the frames after lighting changes (rows 2 and 3 of Fig. 21), showing little effect of camouflage and no occurrence of cast shadow. The same sequence is also interesting for other competing methods, as they react correctly to abrupt changes of illumination but, in the following frames, GMMV1 is unable to detect objects in the foreground, while GMMV2 and GrimsonGMM have important cast shadow problems.

The previous section has allowed us to assess the performance of the different testing methods in a visual way. In order to show clearly the advantages of our proposal, we present Tables 4 and 5
                        
                        , where we list the mean and standard deviation calculated over the results obtained for the different configurations described in Section 5.4. As we see FASOM and GMMV2 are, among the competitors, the best performing methods behind our proposal, and they even surpass it in MR and LB sequences. However, in the case of MR the mean values of both methods are very close together. Also, it is worth noting the good average results obtained by WrenGA in video OS. To get a clearer picture, we can use Tables 6 and 7
                        
                        . They show the best configurations according to F-measure and to accuracy respectively; these values are calculated by averaging over all frames. So we can affirm that, considering the overall set of tested configurations, there is at least one MFBM configuration that is the best in the six benchmark sequences studied according to accuracy, and the same applies to F-measure except in the case of LB sequence, where it is slightly outperformed by GMMV2. These results are confirmed by the global data listed in Tables 4 and 5.

It must be pointed out that the evaluated frames have been those containing foreground objects. The reason for doing so is that the accuracy measure is reliable only when there are foreground objects in the frame. Please note that if no foreground pixels occur, then the most likely situation is 
                           
                              FP
                              =
                              1
                              ,
                              FN
                              =
                              0
                              ,
                              AC
                              =
                              0
                           
                        , and this outcome does not correctly assess the performance of a method. In other words, the measurement accuracy is based primarily on how well a method detects the foreground and not the background.

In Table 8
                         we can see which is FPS performance of each method for every sequence. Real time requirements are fulfilled if a method is over 15 fps. It can be observed that all the methods verify this condition for all the tested sequences. Our method is the slowest one due to the processing of more features, but there is room to accelerate it, since our implementation does not use GPU hardware. Among the other methods, the FASOM is the worst of them in this respect because it uses more complex structures such as self-organizing maps.

In order to compare the different features it is useful to use Receiver Operating Characteristic (ROC) curves. The performance for varying values of the probability threshold 
                           
                              ρ
                           
                         (see Eq. (10)) is shown in terms of TPR (True Positive Rate) vs FPR (False Positive Rate). TPR is equivalent to Recall and FPR is defined as follows:
                           
                              (70)
                              
                                 FPR
                                 =
                                 
                                    
                                       card
                                       
                                          
                                             
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      ‾
                                                   
                                                
                                                ∩
                                                B
                                             
                                          
                                       
                                    
                                    
                                       card
                                       
                                          
                                             
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      ‾
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     


                        Fig. 23
                         shows the ROC curves of five of the best features, the closer to the point 
                           
                              (
                              0
                              ,
                              1
                              )
                           
                        , the better performance. As wee see feature set 
                           
                              
                                 
                                    
                                       3
                                       ,
                                       20
                                       ,
                                       21
                                       ,
                                       22
                                    
                                 
                              
                           
                        is the best choice; it is even better than using five features. The other feature sets get a similar performance; as the number of used features increases, the performance gets slightly better.

In this section a selection of videos recorded under difficult conditions are included in order to have a broader view of the performance of our proposal. For this purpose we use a set of additional videos which exemplify some of these situations, such as snow, fog, wind, poor lighting, fast moving objects and jitter camera.

These tests have been conducted using a single configuration for each method, namely those with better average performance in the six standard sequences studied previously (see Fig. 18). The only exception is FASOM in BL and SF where we use directly the results provided by the authors of the method. Table 9
                         details which parameters are used in each method. For BL and SF a prespecified value of 
                           
                              
                                 
                                    σ
                                 
                                 
                                    2
                                 
                              
                              =
                              
                                 
                                    10
                                 
                                 
                                    -
                                    4
                                 
                              
                           
                         had to be used instead of the quantization noise estimation procedure of Section 3.3. This was because the video compression works in a different way for these sequences with very little contrast.


                        Fig. 24
                         illustrates the output of each method in the videos chosen from ChangeDetection.net. As we see on the first row this sequence is prone to camouflage problems, but our proposal detects all the objects in the scene with less FN than the competitors. The second row presents a situation where WrenGA and GMMV2 get good results but MFBM is better than WrenGA in terms of FN and better than GMMV2 in terms of FP. Rows 3 and 4 (SF sequence) show situations where it is snowing or it has snowed recently. This causes false positive alarms in GMMV2, GrimsonGMM, WrenGA and lesser extent in MFBM. However MFBM gets less false negatives than FASOM and GMMV1 which appear to be robust against the snow, so again our proposal is the best choice.

On the other hand Fig. 25
                         shows the results from the BMC benchmark. TL lighting causes several shadow cast problems. As we see MFBM is the best performing method in this respect. Only GMMV1 is able to attain a similar performance in the first row but it fails in the second one. The WD sequence (third and fourth rows) is difficult due to several factors: the background is very dynamic due to wind and the movement of the clouds, the clouds cast shadows on the road and the camera shakes (jitter effects). These issues cause that in general terms all methods get a very large number of false positives. The only exception is GMMV1 but its problem is just the opposite, it makes too many false negatives. Thus our method offers an interesting alternative because it produces a small number of false negatives and less false positives than most competitors.

In order to get a more accurate picture of the performance of each method, Table 10
                         shows the performance of each method over the difficult condition sequences. The results of all the compared methods are poor with respect to those reported in Section 5. As mentioned before, this is due to the extreme conditions recorded in the studied sequences, which produce noise and compression artifacts. As seen our proposal is the best alternative in BL and SF sequences. MFBM is also the best alternative in TL but GMMV1 gets similar results. In the WD video GMMV1 is the best method and our proposal gets the third best results. Therefore our proposal is a good performing method in these sequences. GMMV1 performs well in the last two sequences but it provides very poor results in BL and SF, while our method is only behind in the last sequence but is the best in the other three.

Additionally we have included Tables 11 and 12
                        
                        . Table 11 shows the F-measure’ achieved by our proposal over the whole BadWeather category using the configuration 
                           
                              ε
                              =
                              0.005
                              ,
                              
                              F
                              =
                              
                                 
                                    
                                       4
                                       ,
                                       19
                                       ,
                                       20
                                       ,
                                       21
                                    
                                 
                              
                           
                         which optimizes the performance in terms of F-measure’ (see Section 4.3 for the definition of F-measure’). This table also shows the results of three of the competitors that are published in the ChangeDetection.net website. Please note that we use F-measure’ rather than the usual F-measure because this website uses F-measure’. As we see MFBM achieves the best average result for the entire category. Specifically our proposal is the best alternative in two of the four videos and it also obtains competitive results in the rest. On the other hand Table 12 compares our proposal using the configuration 
                           
                              ε
                              =
                              0.005
                           
                        , 
                           
                              F
                              =
                              
                                 
                                    
                                       4
                                       ,
                                       19
                                       ,
                                       20
                                       ,
                                       21
                                    
                                 
                              
                           
                         with other proposals published in the Special Section on Background Models Comparison of CVIU Journal (May 2014). As we see our proposal is the best method in TL and a competitive alternative in WD. The methods considered for this purpose are the following:
                           
                              •
                              SAM [7]: They propose a self-adaptative Gaussian mixture model which performs pixel level and frame level processes that dynamically adapt to illumination changes.

VC [10]: This paper presents the so called Visual Cortex model which is a biologically-inspired proposal.

3dSOBS+ [27]: It is a biologically inspired method that uses a neural background model automatically generated by a self-organizing method.

Spampinato [39]: They propose a method to model background and foreground based on color and texture features.

SLDP and StSIC [47]: This paper defines the SLDP and StSIC models, which are statistical and local feature-based approaches.

@&#DISCUSSION@&#

From the study of our proposal that we have carried out in the preceding sections, we can discuss some important points:
                        
                           •
                           Some features which have been reported to be adequate for kernel density estimation based foreground detection, such as Haar-like filters [14], are not well suited for our probabilistic mixture based approach. Haar-like filters are weak features, so one can use a large amount of them to build a strong classifier; but in our case we need few features with the best possible discriminative power.

The detection performance of probabilistic mixture models increases as we add more relevant features, but the improvement diminishes until we reach a point where inserting more features is useless. From our experiments we have found that our proposal reaches that point at 
                                 
                                    D
                                    =
                                    5
                                 
                               features.

Normalized color channels and median filtered features yield particularly good results. This comes from their resilience against illumination changes (for normalized features) and their ability to filter the background noise (for median filtered features). Moreover, the positive effects are maximized in normalized median filtered features.

State-of-the-art background modeling approaches are outperformed by our method. It is possible that these competing methods could be improved by adapting them to use any number and kind of features, as our proposal does.

The search for relevant features for probabilistic mixture background models is an open field of research. It should be aimed to highly informative features which do not require much computation time.

Next the main novelties with respect to our previous proposal [24] are listed:
                        
                           •
                           The new model supports any number and kind of pixel features (Section 3.1).

The uniform mixture component which models the foreground objects has been modified in order to suit features with any range of possible values, see (7), (8).

A probability threshold 
                                 
                                    ρ
                                 
                               has been introduced in this version to allow the user to tune the specificity and sensitivity of the foreground detection.

The implementation of the method has been reworked completely because the implementation of [24] does not scale to more than 3 features. In particular, the Cholesky decomposition of the covariance matrix is used to compute the determinant of the covariance matrix and the Mahalanobis distance of the observed pixel feature vector (Section 3.6). This procedure is both fast and numerically stable because the inverse of the covariance matrix is never computed explicitly.

@&#CONCLUSIONS@&#

A new model for the detection of foreground objects has been proposed. It is able to manage any number and kind of pixel features. We have also proposed a set of relevant features according to several properties. It has been found that normalized and median filtered pixel values outperform the standard RGB color channels. On the other hand, some features which have been reported to work well with kernel density estimation approaches are not suited for our method. The performance of our approach has been compared with state-of-the-art alternatives over a set of benchmark videos, with favorable results. We foresee that these alternative methods could be enhanced by modifying them to accept any number and kind of pixel features.

@&#ACKNOWLEDGMENTS@&#

This work is partially supported by the Ministry of Economy and Competitiveness of Spain under Grant TIN2011-24141, project name Detection of anomalous activities in video sequences by self-organizing neural systems. It is also partially supported by the Autonomous Government of Andalusia (Spain) under Projects TIC-6213, project name Development of Self-Organizing Neural Networks for Information Technologies; and TIC-657, project name Self-organizing systems and robust estimators for video surveillance. All of them include funds from the European Regional Development Fund (ERDF). The authors thankfully acknowledge the computer resources, technical expertise and assistance provided by the SCBI (Supercomputing and Bioinformatics) center of the University of Malaga.

@&#REFERENCES@&#

