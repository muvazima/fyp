@&#MAIN-TITLE@&#Automated learning of factor analysis with complete and incomplete data

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We propose a novel algorithm for learning factor analysis with complete and incomplete data.


                        
                        
                           
                           The algorithm is able to determine the number of factors in an automated manner.


                        
                        
                           
                           The algorithm is as effective as the previous two-stage procedure.


                        
                        
                           
                           However, the algorithm is much more computationally efficient.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Factor analysis

Model selection

Maximum likelihood

Incomplete data

CM

EM

@&#ABSTRACT@&#


               
               
                  In the application of the popular maximum likelihood method to factor analysis, the number of factors is commonly determined through a two-stage procedure, in which stage 1 performs parameter estimation for a set of candidate models and then stage 2 chooses the best according to certain model selection criterion. Usually, to obtain satisfactory performance, a large set of candidates is used and this procedure suffers a heavy computational burden. To overcome this problem, a novel one-stage algorithm is proposed in which parameter estimation and model selection are integrated in a single algorithm. This is obtained by maximizing the criterion with respect to model parameters and the number of factors jointly, rather than separately. The proposed algorithm is then extended to accommodate incomplete data. Experiments on a number of complete/incomplete synthetic and real data reveal that the proposed algorithm is as effective as the existing two-stage procedure while being much more computationally efficient, particularly for incomplete data.
               
            

@&#INTRODUCTION@&#

Factor analysis (FA) is a commonly used multivariate analysis technique that identifies the common characteristics among a set of variables. The parameter estimation can be easily performed by means of the maximum likelihood (ML) method via the popular expectation maximization (EM)-like algorithm (Dempster et al., 1977; Meng and Rubin, 1993; Meng and van Dyk, 1997). In addition, in density modeling for high-dimensional data, the covariance structure of FA offers significant advantages over full/diagonal/scalar covariance, because of its capability of providing an appropriate trade-off between overfitting full covariance and underfitting diagonal/scalar covariance (Tipping and Bishop, 1999).

To find the trade-off, namely to determine the number of factors 
                        q
                     , a two-stage procedure is commonly adopted, where stage 1 performs parameter estimation for a set of candidate models and stage 2 chooses the best according to a model selection criterion. The most popular criteria for this purpose are Akaike’s information criterion (AIC) (Akaike, 1987) and the Bayesian information criterion (BIC) (Schwarz, 1978). Obviously, this two-stage procedure has to enumerate all candidate models over the set of 
                        
                           {
                           q
                           }
                        
                     . Usually, to achieve satisfactory performance, a large set of values of 
                        q
                      is used and thus this procedure can be very time consuming.

To overcome this problem, we propose in this paper a novel one-stage algorithm, in which we do not use a criterion to choose one from a set of candidate models; rather, we integrate the determination of the number of factors into parameter estimation and thus this one-stage algorithm is able to significantly alleviate the computational burden suffered by the two-stage procedure. We call our algorithm the automated learning algorithm of FA (AFA, in short). Specifically, the AFA consists of two conditional maximization (CM)-steps: CM-step 1 maximizes the model selection criterion with respect to (w.r.t.) the number of factors and factor loadings jointly while keeping uniqueness fixed; CM-step 2 maximizes the criterion w.r.t. uniqueness while keeping factor loadings fixed.

In the presence of missing data, Song and Belin (2008) have shown that the AIC and BIC can still be used to determine the number of factors reliably. However, the implementation has to be drawn on the two-stage procedure and, as will be seen in Section  5, its computational burden is typically much heavier than that in the complete data case, due to the inclusion of more missing information. Therefore, we further extend the AFA to accommodate incomplete data by means of the standard methodology in Little and Rubin (1987) and obtain an automated learning algorithm of FA with incomplete data.

Note that the likelihood ratio test (LRT) is also another popular choice for determining the number of factors (Lawley and Maxwell, 1971). However, to the best of our knowledge, there does not exist a corresponding ‘automated’ version of the LRT just like the AFA for the criterion-based FA in this paper. Thus, the LRT must be run many times for different values of 
                        q
                      while the criterion-based FA now can be run only once with the AFA.

The remainder of this paper is organized as follows. In Section  2, we review the conditional maximization (CM) algorithm for fitting FA (Zhao et al., 2008; Yu and Zhao, 2013). Based on this, we propose the AFA for complete data in Section  3 and extend it to accommodate incomplete data in Section  4. We conduct an empirical study to compare the AFA with the existing two-stage procedure in Section  5. We end the paper with some concluding remarks in Section  6.

Suppose that the 
                           d
                        -dimensional data vector 
                           
                              x
                           
                         follows a 
                           q
                        -factor model: 
                           
                              (1)
                              
                                 
                                    {
                                    
                                       
                                          
                                             
                                                x
                                             
                                             =
                                             
                                                A
                                             
                                             
                                                y
                                             
                                             +
                                             
                                                μ
                                             
                                             +
                                             
                                                ϵ
                                             
                                             ,
                                          
                                       
                                       
                                          
                                             
                                                y
                                             
                                             ∼
                                             N
                                             
                                                (
                                                
                                                   0
                                                
                                                ,
                                                
                                                   I
                                                
                                                )
                                             
                                             ,
                                             
                                             
                                                ϵ
                                             
                                             ∼
                                             N
                                             
                                                (
                                                
                                                   0
                                                
                                                ,
                                                
                                                   Ψ
                                                
                                                )
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                         where 
                           
                              μ
                           
                         is a 
                           d
                        -dimensional mean vector, 
                           
                              A
                           
                         is a 
                           d
                           ×
                           q
                         factor loading matrix, 
                           
                              y
                           
                         is a 
                           q
                        -dimensional latent factor vector, 
                           
                              Ψ
                           
                           =
                           diag
                           
                              {
                              
                                 
                                    ψ
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    ψ
                                 
                                 
                                    2
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    ψ
                                 
                                 
                                    d
                                 
                              
                              }
                           
                         is a positive diagonal matrix, 
                           
                              
                                 ψ
                              
                              
                                 i
                              
                           
                         is the so-called uniqueness of variable 
                           i
                         in 
                           
                              x
                           
                         and 
                           
                              I
                           
                         denotes an identity matrix of suitable dimension.

If 
                           
                              A
                           
                         in (1) is replaced by 
                           
                              A
                           
                           
                              R
                           
                         and 
                           
                              y
                           
                         by 
                           
                              
                                 
                                    R
                                 
                              
                              
                                 ′
                              
                           
                           
                              y
                           
                        , where 
                           
                              R
                           
                         is an orthogonal matrix, the FA model is invariant and hence the estimate of 
                           
                              A
                           
                         can only be determined up to a rotation, from which we have that the number of free parameters in the FA model is 
                           D
                           
                              (
                              q
                              )
                           
                           =
                           d
                           
                              (
                              q
                              +
                              2
                              )
                           
                           −
                           q
                           
                              (
                              q
                              −
                              1
                              )
                           
                           /
                           2
                         (Lawley and Maxwell, 1971).

Under model (1), 
                           
                              (2)
                              
                                 
                                    x
                                 
                                 ∼
                                 N
                                 
                                    (
                                    
                                       μ
                                    
                                    ,
                                    
                                       Σ
                                    
                                    )
                                 
                                 ,
                              
                           
                         where 
                           
                              Σ
                           
                           =
                           
                              A
                           
                           
                              
                                 
                                    A
                                 
                              
                              
                                 ′
                              
                           
                           +
                           
                              Ψ
                           
                        . To avoid over-parameterization, the number of degrees of freedom in 
                           
                              Σ
                           
                           ,
                           d
                           
                              (
                              q
                              +
                              1
                              )
                           
                           −
                           q
                           
                              (
                              q
                              −
                              1
                              )
                           
                           /
                           2
                        , should not exceed that of a full 
                           d
                           ×
                           d
                         covariance matrix, 
                           d
                           
                              (
                              d
                              +
                              1
                              )
                           
                           /
                           2
                         (Beal, 2003), which yields 
                           
                              (3)
                              
                                 
                                    
                                       q
                                    
                                    
                                       
                                          max
                                       
                                    
                                 
                                 ≤
                                 d
                                 +
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 
                                    (
                                    1
                                    −
                                    
                                       
                                          1
                                          +
                                          8
                                          d
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                         Given a set of i.i.d. observations 
                           
                              X
                           
                           =
                           
                              
                                 
                                    {
                                    
                                       
                                          
                                             x
                                          
                                       
                                       
                                          n
                                       
                                    
                                    }
                                 
                              
                              
                                 n
                                 =
                                 1
                              
                              
                                 N
                              
                           
                        , let 
                           
                              (4)
                              
                                 
                                    
                                       
                                          x
                                       
                                    
                                    
                                       ̄
                                    
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       N
                                    
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       N
                                    
                                 
                                 
                                    
                                       
                                          x
                                       
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                 and
                                 
                                 
                                    S
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       N
                                    
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       N
                                    
                                 
                                 ,
                                 
                                 
                                    (
                                    
                                       
                                          
                                             x
                                          
                                       
                                       
                                          i
                                       
                                    
                                    −
                                    
                                       
                                          
                                             x
                                          
                                       
                                       
                                          ̄
                                       
                                    
                                    )
                                 
                                 
                                    
                                       
                                          (
                                          
                                             
                                                
                                                   x
                                                
                                             
                                             
                                                i
                                             
                                          
                                          −
                                          
                                             
                                                
                                                   x
                                                
                                             
                                             
                                                ̄
                                             
                                          
                                          )
                                       
                                    
                                    
                                       ′
                                    
                                 
                              
                           
                         be the sample mean vector and sample covariance matrix of 
                           
                              x
                           
                        , respectively. The global maximum likelihood estimator (MLE) of 
                           
                              μ
                           
                         is trivially the sample mean 
                           
                              
                                 
                                    x
                                 
                              
                              
                                 ̄
                              
                           
                         and thus the MLE of 
                           
                              θ
                           
                           =
                           
                              (
                              
                                 A
                              
                              ,
                              
                                 Ψ
                              
                              )
                           
                         can be obtained by maximizing the log likelihood 
                           
                              (5)
                              
                                 L
                                 
                                    (
                                    
                                       θ
                                    
                                    )
                                 
                                 =
                                 −
                                 
                                    
                                       N
                                    
                                    
                                       2
                                    
                                 
                                 
                                    {
                                    log
                                    
                                       |
                                       
                                          Σ
                                       
                                       |
                                    
                                    +
                                    tr
                                    
                                       (
                                       
                                          
                                             
                                                Σ
                                             
                                          
                                          
                                             −
                                             1
                                          
                                       
                                       
                                          S
                                       
                                       )
                                    
                                    }
                                 
                                 .
                              
                           
                         There exist many algorithms to maximize 
                           L
                        . For example, the expectation maximization (EM) (Rubin and Thayer, 1982), the quasi Newton–Raphson algorithm (Jöreskog, 1967), the expectation CM either (ECME) algorithm (Liu and Rubin, 1998), the parameter-expanded EM (PX-EM) (Liu, 1994), etc. Since these algorithms have to either include latent factors as missing data that yield slow convergence or resort to numerical optimization methods that lack the simplicity and stability of EM, Zhao et al. (2008) propose a conditional maximization (CM) algorithm that does not involve numerical optimization and latent factors and their empirical results show that CM enjoys substantially faster convergence than EM and ECME. More importantly, it is a building block of our proposed automated learning algorithm for FA. A brief review of the CM algorithm is given in Section  2.2. For completeness, the EM and PX-EM are also briefly reviewed in Sections  2.3 and 2.4, respectively.

Let 
                           
                              Ψ
                           
                           =
                           
                              diag
                           
                           
                              (
                              
                                 
                                    ψ
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    ψ
                                 
                                 
                                    2
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    ψ
                                 
                                 
                                    d
                                 
                              
                              )
                           
                           ,
                           
                              
                                 
                                    Ψ
                                 
                              
                              
                                 i
                              
                           
                           ≜
                           
                              diag
                           
                           
                              (
                              
                                 
                                    
                                       
                                          ψ
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    
                                       
                                          ψ
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    i
                                    −
                                    1
                                 
                              
                              ,
                              
                                 
                                    ψ
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    ψ
                                 
                                 
                                    i
                                    +
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    ψ
                                 
                                 
                                    d
                                 
                              
                              )
                           
                        . Given an initial 
                           
                              Ψ
                           
                        , the CM algorithm alternates the following two steps until convergence of 
                           L
                         is met. 
                           
                              •
                              
                                 CM-step  1: Given 
                                    
                                       Ψ
                                    
                                 , maximizing 
                                    L
                                    
                                       (
                                       
                                          A
                                       
                                       )
                                    
                                  in (5) w.r.t. 
                                    
                                       A
                                    
                                  yields 
                                    
                                       
                                          
                                             A
                                          
                                       
                                       
                                          ̃
                                       
                                    
                                 .


                                 CM-step  2: Given 
                                    
                                       
                                          
                                             A
                                          
                                       
                                       
                                          ̃
                                       
                                    
                                  and 
                                    
                                       
                                          
                                             Ψ
                                          
                                       
                                       
                                          i
                                       
                                    
                                 , maximizing 
                                    L
                                    
                                       (
                                       
                                          
                                             ψ
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                  in (5) w.r.t. 
                                    
                                       
                                          ψ
                                       
                                       
                                          i
                                       
                                    
                                  yields 
                                    
                                       
                                          
                                             
                                                ψ
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                 , sequentially for 
                                    i
                                    =
                                    1
                                    ,
                                    2
                                    ,
                                    …
                                    ,
                                    d
                                 .

Let the normalized sample covariance matrix be 
                              
                                 (6)
                                 
                                    
                                       
                                          
                                             S
                                          
                                       
                                       
                                          ̄
                                       
                                    
                                    =
                                    
                                       
                                          
                                             Ψ
                                          
                                       
                                       
                                          −
                                          1
                                          /
                                          2
                                       
                                    
                                    
                                       S
                                    
                                    
                                       
                                          
                                             Ψ
                                          
                                       
                                       
                                          −
                                          1
                                          /
                                          2
                                       
                                    
                                    ,
                                 
                              
                            where 
                              
                                 S
                              
                            is given in (4), and 
                              
                                 (
                                 
                                    
                                       λ
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          u
                                       
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                            be its eigenvalue–eigenvector pairs of 
                              
                                 
                                    
                                       S
                                    
                                 
                                 
                                    ̄
                                 
                              
                            sorted in the order 
                              
                                 
                                    λ
                                 
                                 
                                    1
                                 
                              
                              ≥
                              
                                 
                                    λ
                                 
                                 
                                    2
                                 
                              
                              ≥
                              ⋯
                              ≥
                              
                                 
                                    λ
                                 
                                 
                                    d
                                 
                              
                           . Given 
                              
                                 Ψ
                              
                              ,
                              
                                 
                                    
                                       A
                                    
                                 
                                 
                                    ̃
                                 
                              
                            is obtained by 
                              
                                 (7)
                                 
                                    
                                       
                                          
                                             A
                                          
                                       
                                       
                                          ̃
                                       
                                    
                                    =
                                    
                                       
                                          
                                             Ψ
                                          
                                       
                                       
                                          1
                                          /
                                          2
                                       
                                    
                                    
                                       
                                          
                                             U
                                          
                                       
                                       
                                          
                                             
                                                q
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   
                                                      Λ
                                                   
                                                
                                                
                                                   
                                                      
                                                         q
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                             
                                             −
                                             
                                                I
                                             
                                             )
                                          
                                       
                                       
                                          1
                                          /
                                          2
                                       
                                    
                                    
                                       R
                                    
                                    ,
                                 
                              
                            where, if 
                              
                                 
                                    λ
                                 
                                 
                                    q
                                 
                              
                              >
                              1
                              ,
                              
                                 
                                    q
                                 
                                 
                                    ′
                                 
                              
                              =
                              q
                           ; otherwise, 
                              
                                 
                                    q
                                 
                                 
                                    ′
                                 
                              
                            is the unique integer satisfying 
                              
                                 
                                    λ
                                 
                                 
                                    
                                       
                                          q
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                              >
                              1
                              ≥
                              
                                 
                                    λ
                                 
                                 
                                    
                                       
                                          q
                                       
                                       
                                          ′
                                       
                                    
                                    +
                                    1
                                 
                              
                           , 
                              
                                 
                                    
                                       Λ
                                    
                                 
                                 
                                    
                                       
                                          q
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                              =
                              diag
                              
                                 (
                                 
                                    
                                       λ
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       λ
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       λ
                                    
                                    
                                       
                                          
                                             q
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 )
                              
                              ,
                              
                                 
                                    
                                       U
                                    
                                 
                                 
                                    
                                       
                                          q
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                              =
                              
                                 (
                                 
                                    
                                       
                                          u
                                       
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          u
                                       
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       
                                          u
                                       
                                    
                                    
                                       
                                          
                                             q
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 )
                              
                            and 
                              
                                 R
                              
                            is an orthogonal matrix satisfying 
                              
                                 R
                              
                              
                                 
                                    
                                       R
                                    
                                 
                                 
                                    ′
                                 
                              
                              =
                              
                                 I
                              
                           .

By the FA model assumption that 
                              
                                 Ψ
                              
                            is positive, we can pick an arbitrary very small number 
                              η
                              >
                              0
                            and assume 
                              
                                 
                                    
                                       
                                          ψ
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              ≥
                              η
                           . Let 
                              
                                 
                                    
                                       A
                                    
                                 
                                 
                                    ̄
                                 
                              
                              =
                              
                                 
                                    
                                       Ψ
                                    
                                 
                                 
                                    −
                                    1
                                    /
                                    2
                                 
                              
                              
                                 A
                              
                              ,
                              
                                 
                                    
                                       e
                                    
                                 
                                 
                                    i
                                 
                              
                            be the 
                              i
                           th column of the 
                              d
                              ×
                              d
                            identity matrix, 
                              
                                 (8)
                                 
                                    
                                       
                                          
                                             B
                                          
                                       
                                       
                                          i
                                       
                                    
                                    =
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          i
                                          −
                                          1
                                       
                                    
                                    
                                       
                                          
                                             
                                                ω
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          k
                                       
                                    
                                    
                                    
                                       
                                          
                                             e
                                          
                                       
                                       
                                          k
                                       
                                    
                                    
                                       
                                          
                                             e
                                          
                                       
                                       
                                          k
                                       
                                       
                                          ′
                                       
                                    
                                    +
                                    
                                       I
                                    
                                    +
                                    
                                       
                                          
                                             A
                                          
                                       
                                       
                                          ̄
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   A
                                                
                                             
                                             
                                                ̄
                                             
                                          
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                 
                              
                           
                           
                              
                                 
                                    
                                       b
                                    
                                 
                                 
                                    k
                                 
                              
                            be the 
                              k
                           -th column vector of 
                              
                                 
                                    
                                       B
                                    
                                 
                                 
                                    i
                                 
                                 
                                    −
                                    1
                                 
                              
                            and 
                              
                                 
                                    b
                                 
                                 
                                    k
                                    k
                                 
                              
                            stand for the 
                              k
                              k
                           -th element of 
                              
                                 
                                    
                                       B
                                    
                                 
                                 
                                    i
                                 
                                 
                                    −
                                    1
                                 
                              
                           . Then 
                              
                                 
                                    
                                       
                                          ψ
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                            is obtained by 
                              
                                 (9)
                                 
                                    
                                       
                                          
                                             
                                                ψ
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                    =
                                    max
                                    
                                       {
                                       
                                          [
                                          
                                             
                                                b
                                             
                                             
                                                i
                                                i
                                             
                                             
                                                −
                                                2
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   
                                                      b
                                                   
                                                
                                                
                                                   i
                                                
                                                
                                                   ′
                                                
                                             
                                             
                                                
                                                   
                                                      S
                                                   
                                                
                                                
                                                   ̄
                                                
                                             
                                             
                                                
                                                   
                                                      b
                                                   
                                                
                                                
                                                   i
                                                
                                             
                                             −
                                             
                                                
                                                   b
                                                
                                                
                                                   i
                                                   i
                                                
                                             
                                             )
                                          
                                          +
                                          1
                                          ]
                                       
                                       
                                          
                                             ψ
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       η
                                       }
                                    
                                    ,
                                 
                              
                            and the required 
                              
                                 
                                    
                                       
                                          ω
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                            in (8) is given by 
                              
                                 (10)
                                 
                                    
                                       
                                          
                                             
                                                ω
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                ψ
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                    /
                                    
                                       
                                          ψ
                                       
                                       
                                          i
                                       
                                    
                                    −
                                    1
                                    .
                                 
                              
                            By (9), 
                              
                                 
                                    
                                       
                                          ψ
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    k
                                 
                              
                              ≥
                              η
                           , and by (10), 
                              
                                 
                                    
                                       
                                          ω
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    k
                                 
                              
                              >
                              −
                              1
                              ,
                              k
                              =
                              1
                              ,
                              …
                              ,
                              i
                              −
                              1
                           , thus 
                              
                                 
                                    
                                       B
                                    
                                 
                                 
                                    i
                                 
                              
                            in (8) is invertible and 
                              
                                 
                                    
                                       
                                          ψ
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                            in (9) can always be computed. The implementation using (8) and (9) directly as provided in Zhao et al. (2008) costs 
                              
                                 
                                    d
                                 
                                 
                                    2
                                 
                              
                              q
                              +
                              3
                              
                                 
                                    d
                                 
                                 
                                    3
                                 
                              
                           . Recently, Yu and Zhao (2013) proposed a novel implementation that enjoys the lower cost 
                              
                                 
                                    d
                                 
                                 
                                    2
                                 
                              
                              q
                              +
                              2
                              
                                 
                                    d
                                 
                                 
                                    3
                                 
                              
                              /
                              3
                           . We simply give its detailed pseudocode in Algorithm 1 and interested readers can refer to Yu and Zhao (2013) for details.


                           
                              
                                 
                              
                           
                        

The expectation maximization (EM) algorithm (Dempster et al., 1977) is a well known iterative procedure for finding the ML estimate. Each iteration of EM consists of an E-step to obtain the expected complete data log likelihood, i.e., the so-called 
                           Q
                         function, and a M-step to maximize 
                           Q
                         w.r.t. 
                           
                              θ
                           
                        .

From (1), the probability density of 
                           
                              
                                 
                                    y
                                 
                              
                              
                                 n
                              
                           
                         given 
                           
                              
                                 
                                    x
                                 
                              
                              
                                 n
                              
                           
                         is given by 
                           
                              (11)
                              
                                 
                                    
                                       
                                          y
                                       
                                    
                                    
                                       n
                                    
                                 
                                 |
                                 
                                    
                                       
                                          x
                                       
                                    
                                    
                                       n
                                    
                                 
                                 ∼
                                 N
                                 
                                    (
                                    
                                       
                                          
                                             M
                                          
                                       
                                       
                                          1
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    
                                       
                                          
                                             A
                                          
                                       
                                       
                                          ′
                                       
                                    
                                    
                                       
                                          
                                             Ψ
                                          
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                x
                                             
                                          
                                          
                                             n
                                          
                                       
                                       −
                                       
                                          μ
                                       
                                       )
                                    
                                    ,
                                    
                                       
                                          
                                             M
                                          
                                       
                                       
                                          1
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    )
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 
                                    M
                                 
                              
                              
                                 1
                              
                           
                           =
                           
                              I
                           
                           +
                           
                              
                                 
                                    A
                                 
                              
                              
                                 ′
                              
                           
                           
                              
                                 
                                    Ψ
                                 
                              
                              
                                 −
                                 1
                              
                           
                           
                              A
                           
                        . By (11), we obtain 
                           
                              
                                 (12)
                                 
                                    E
                                    
                                       [
                                       
                                          
                                             
                                                y
                                             
                                          
                                          
                                             n
                                          
                                       
                                       |
                                       
                                          
                                             
                                                x
                                             
                                          
                                          
                                             n
                                          
                                       
                                       ]
                                    
                                    =
                                    
                                       
                                          
                                             M
                                          
                                       
                                       
                                          1
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    
                                       
                                          
                                             A
                                          
                                       
                                       
                                          ′
                                       
                                    
                                    
                                       
                                          
                                             Ψ
                                          
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                x
                                             
                                          
                                          
                                             n
                                          
                                       
                                       −
                                       
                                          μ
                                       
                                       )
                                    
                                    ,
                                    
                                    and
                                 
                              
                              
                                 (13)
                                 
                                    E
                                    
                                       [
                                       
                                          
                                             
                                                y
                                             
                                          
                                          
                                             n
                                          
                                       
                                       
                                          
                                             
                                                y
                                             
                                          
                                          
                                             n
                                          
                                          
                                             ′
                                          
                                       
                                       |
                                       
                                          
                                             
                                                x
                                             
                                          
                                          
                                             n
                                          
                                       
                                       ]
                                    
                                    =
                                    
                                       
                                          
                                             M
                                          
                                       
                                       
                                          1
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    +
                                    E
                                    
                                       [
                                       
                                          
                                             
                                                y
                                             
                                          
                                          
                                             n
                                          
                                       
                                       |
                                       
                                          
                                             
                                                x
                                             
                                          
                                          
                                             n
                                          
                                       
                                       ]
                                    
                                    E
                                    
                                       
                                          
                                             [
                                             
                                                
                                                   
                                                      y
                                                   
                                                
                                                
                                                   n
                                                
                                             
                                             |
                                             
                                                
                                                   
                                                      x
                                                   
                                                
                                                
                                                   n
                                                
                                             
                                             ]
                                          
                                       
                                       
                                          ′
                                       
                                    
                                    .
                                 
                              
                           
                        
                     

In the EM for FA, the set of latent factors 
                           
                              Y
                           
                           =
                           
                              
                                 
                                    {
                                    
                                       
                                          
                                             y
                                          
                                       
                                       
                                          n
                                       
                                    
                                    }
                                 
                              
                              
                                 n
                                 =
                                 1
                              
                              
                                 N
                              
                           
                         is treated as missing data, the augmented complete data is 
                           
                              (
                              
                                 X
                              
                              ,
                              
                                 Y
                              
                              )
                           
                         and hence the complete data log likelihood is 
                           
                              
                                 
                                    
                                       L
                                    
                                    
                                       1
                                       c
                                    
                                 
                                 
                                    (
                                    
                                       X
                                    
                                    ,
                                    
                                       Y
                                    
                                    |
                                    
                                       θ
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       n
                                       =
                                       1
                                    
                                    
                                       N
                                    
                                 
                                 log
                                 
                                    {
                                    p
                                    
                                       (
                                       
                                          
                                             
                                                x
                                             
                                          
                                          
                                             n
                                          
                                       
                                       |
                                       
                                          
                                             
                                                y
                                             
                                          
                                          
                                             n
                                          
                                       
                                       ,
                                       
                                          θ
                                       
                                       )
                                    
                                    p
                                    
                                       (
                                       
                                          
                                             
                                                y
                                             
                                          
                                          
                                             n
                                          
                                       
                                       )
                                    
                                    }
                                 
                                 ,
                              
                           
                         where 
                           
                              θ
                           
                           =
                           
                              (
                              
                                 A
                              
                              ,
                              
                                 Ψ
                              
                              )
                           
                         and the parameter 
                           
                              μ
                           
                         has been replaced by its MLE 
                           
                              
                                 
                                    x
                                 
                              
                              
                                 ̄
                              
                           
                        . 
                           
                              •
                              
                                 E-step: Given 
                                    
                                       θ
                                    
                                 , compute the expected 
                                    
                                       
                                          L
                                       
                                       
                                          1
                                          c
                                       
                                    
                                  w.r.t. the posterior distribution 
                                    p
                                    
                                       (
                                       
                                          
                                             
                                                y
                                             
                                          
                                          
                                             n
                                          
                                       
                                       |
                                       
                                          
                                             
                                                x
                                             
                                          
                                          
                                             n
                                          
                                       
                                       ,
                                       
                                          θ
                                       
                                       )
                                    
                                 
                                 
                                    
                                       (14)
                                       
                                          
                                             
                                                Q
                                             
                                             
                                                1
                                             
                                          
                                          
                                             (
                                             
                                                θ
                                             
                                             )
                                          
                                          =
                                          −
                                          
                                             
                                                N
                                             
                                             
                                                2
                                             
                                          
                                          log
                                          
                                             |
                                             
                                                Ψ
                                             
                                             |
                                          
                                          −
                                          
                                             
                                                1
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                ∑
                                             
                                             
                                                n
                                                =
                                                1
                                             
                                             
                                                N
                                             
                                          
                                          
                                             {
                                             E
                                             
                                                [
                                                
                                                   
                                                      
                                                         y
                                                      
                                                   
                                                   
                                                      n
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                
                                                   
                                                      
                                                         y
                                                      
                                                   
                                                   
                                                      n
                                                   
                                                
                                                |
                                                
                                                   
                                                      
                                                         x
                                                      
                                                   
                                                   
                                                      n
                                                   
                                                
                                                ]
                                             
                                             +
                                             E
                                             
                                                [
                                                
                                                   
                                                      
                                                         (
                                                         
                                                            
                                                               
                                                                  x
                                                               
                                                            
                                                            
                                                               n
                                                            
                                                         
                                                         −
                                                         
                                                            A
                                                         
                                                         
                                                            
                                                               
                                                                  y
                                                               
                                                            
                                                            
                                                               n
                                                            
                                                         
                                                         −
                                                         
                                                            
                                                               
                                                                  x
                                                               
                                                            
                                                            
                                                               ̄
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                
                                                   
                                                      
                                                         Ψ
                                                      
                                                   
                                                   
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            x
                                                         
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                   −
                                                   
                                                      A
                                                   
                                                   
                                                      
                                                         
                                                            y
                                                         
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         
                                                            x
                                                         
                                                      
                                                      
                                                         ̄
                                                      
                                                   
                                                   )
                                                
                                                |
                                                
                                                   
                                                      
                                                         x
                                                      
                                                   
                                                   
                                                      n
                                                   
                                                
                                                ]
                                             
                                             }
                                          
                                          ,
                                       
                                    
                                  where the required expectations are given by (12) and (13).


                                 M-step: Maximizing 
                                    
                                       
                                          Q
                                       
                                       
                                          1
                                       
                                    
                                  w.r.t. 
                                    
                                       θ
                                    
                                  yields 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      A
                                                   
                                                
                                                
                                                   ̃
                                                
                                             
                                             =
                                             
                                                
                                                   ∑
                                                
                                                
                                                   n
                                                   =
                                                   1
                                                
                                                
                                                   N
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      
                                                         x
                                                      
                                                   
                                                   
                                                      n
                                                   
                                                
                                                −
                                                
                                                   
                                                      
                                                         x
                                                      
                                                   
                                                   
                                                      ̄
                                                   
                                                
                                                )
                                             
                                             E
                                             
                                                
                                                   
                                                      [
                                                      
                                                         
                                                            
                                                               y
                                                            
                                                         
                                                         
                                                            n
                                                         
                                                      
                                                      |
                                                      
                                                         
                                                            
                                                               x
                                                            
                                                         
                                                         
                                                            n
                                                         
                                                      
                                                      ]
                                                   
                                                
                                                
                                                   ′
                                                
                                             
                                             
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            n
                                                            =
                                                            1
                                                         
                                                         
                                                            N
                                                         
                                                      
                                                      E
                                                      
                                                         [
                                                         
                                                            
                                                               
                                                                  y
                                                               
                                                            
                                                            
                                                               n
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  y
                                                               
                                                            
                                                            
                                                               n
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                         |
                                                         
                                                            
                                                               
                                                                  x
                                                               
                                                            
                                                            
                                                               n
                                                            
                                                         
                                                         ]
                                                      
                                                      )
                                                   
                                                
                                                
                                                   −
                                                   1
                                                
                                             
                                             ,
                                             =
                                             
                                                S
                                             
                                             
                                                
                                                   
                                                      Ψ
                                                   
                                                
                                                
                                                   −
                                                   1
                                                
                                             
                                             
                                                A
                                             
                                             
                                                
                                                   
                                                      M
                                                   
                                                
                                                
                                                   1
                                                
                                                
                                                   −
                                                   1
                                                
                                             
                                             
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            
                                                               M
                                                            
                                                         
                                                         
                                                            1
                                                         
                                                         
                                                            −
                                                            1
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               A
                                                            
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               Ψ
                                                            
                                                         
                                                         
                                                            −
                                                            1
                                                         
                                                      
                                                      
                                                         S
                                                      
                                                      
                                                         
                                                            
                                                               Ψ
                                                            
                                                         
                                                         
                                                            −
                                                            1
                                                         
                                                      
                                                      
                                                         A
                                                      
                                                      
                                                         
                                                            
                                                               M
                                                            
                                                         
                                                         
                                                            1
                                                         
                                                         
                                                            −
                                                            1
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            
                                                               M
                                                            
                                                         
                                                         
                                                            1
                                                         
                                                         
                                                            −
                                                            1
                                                         
                                                      
                                                      )
                                                   
                                                
                                                
                                                   −
                                                   1
                                                
                                             
                                             ,
                                             
                                             and
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      Ψ
                                                   
                                                
                                                
                                                   ̃
                                                
                                             
                                             =
                                             
                                                
                                                   1
                                                
                                                
                                                   N
                                                
                                             
                                             diag
                                             
                                                {
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      n
                                                      =
                                                      1
                                                   
                                                   
                                                      N
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            x
                                                         
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         
                                                            x
                                                         
                                                      
                                                      
                                                         ̄
                                                      
                                                   
                                                   )
                                                
                                                
                                                   
                                                      
                                                         (
                                                         
                                                            
                                                               
                                                                  x
                                                               
                                                            
                                                            
                                                               n
                                                            
                                                         
                                                         −
                                                         
                                                            
                                                               
                                                                  x
                                                               
                                                            
                                                            
                                                               ̄
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                −
                                                
                                                   
                                                      
                                                         A
                                                      
                                                   
                                                   
                                                      ̃
                                                   
                                                
                                                E
                                                
                                                   [
                                                   
                                                      
                                                         
                                                            y
                                                         
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                   |
                                                   
                                                      
                                                         
                                                            x
                                                         
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                   ]
                                                
                                                
                                                   
                                                      
                                                         (
                                                         
                                                            
                                                               
                                                                  x
                                                               
                                                            
                                                            
                                                               n
                                                            
                                                         
                                                         −
                                                         
                                                            
                                                               
                                                                  x
                                                               
                                                            
                                                            
                                                               ̄
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                }
                                             
                                             ,
                                             =
                                             diag
                                             
                                                {
                                                
                                                   S
                                                
                                                −
                                                
                                                   
                                                      
                                                         A
                                                      
                                                   
                                                   
                                                      ̃
                                                   
                                                
                                                
                                                   
                                                      
                                                         M
                                                      
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   
                                                      
                                                         A
                                                      
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                
                                                   
                                                      
                                                         Ψ
                                                      
                                                   
                                                   
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   S
                                                
                                                }
                                             
                                             ,
                                          
                                       
                                    
                                  where 
                                    
                                       S
                                    
                                  is given by (4).

The parameter-expanded EM (PX-EM) algorithm (Liu et al., 1998) is a covariance adjustment technique for accelerating the standard EM by means of parameter expansion. In the PX-EM for FA, an auxiliary covariance matrix 
                           
                              V
                           
                         is introduced and it is assumed that 
                           
                              
                                 
                                    y
                                 
                              
                              
                                 n
                              
                           
                           ∼
                           N
                           
                              (
                              
                                 0
                              
                              ,
                              
                                 V
                              
                              )
                           
                        . Thus the parameter is expanded to 
                           
                              θ
                           
                           =
                           
                              (
                              
                                 A
                              
                              ,
                              
                                 Ψ
                              
                              ,
                              
                                 V
                              
                              )
                           
                        . The probability density of 
                           
                              
                                 
                                    y
                                 
                              
                              
                                 n
                              
                           
                         given 
                           
                              
                                 
                                    x
                                 
                              
                              
                                 n
                              
                           
                         is now given by 
                           
                              (15)
                              
                                 
                                    
                                       
                                          y
                                       
                                    
                                    
                                       n
                                    
                                 
                                 |
                                 
                                    
                                       
                                          x
                                       
                                    
                                    
                                       n
                                    
                                 
                                 ∼
                                 N
                                 
                                    (
                                    
                                       
                                          
                                             M
                                          
                                       
                                       
                                          2
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    
                                       
                                          
                                             A
                                          
                                       
                                       
                                          ′
                                       
                                    
                                    
                                       
                                          
                                             Ψ
                                          
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                x
                                             
                                          
                                          
                                             n
                                          
                                       
                                       −
                                       
                                          μ
                                       
                                       )
                                    
                                    ,
                                    
                                       
                                          
                                             M
                                          
                                       
                                       
                                          2
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    )
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 
                                    M
                                 
                              
                              
                                 2
                              
                           
                           =
                           
                              
                                 
                                    V
                                 
                              
                              
                                 −
                                 1
                              
                           
                           +
                           
                              
                                 
                                    A
                                 
                              
                              
                                 ′
                              
                           
                           
                              
                                 
                                    Ψ
                                 
                              
                              
                                 −
                                 1
                              
                           
                           
                              A
                           
                        . By (15), we obtain 
                           
                              
                                 (16)
                                 
                                    E
                                    
                                       [
                                       
                                          
                                             
                                                y
                                             
                                          
                                          
                                             n
                                          
                                       
                                       |
                                       
                                          
                                             
                                                x
                                             
                                          
                                          
                                             n
                                          
                                       
                                       ]
                                    
                                    =
                                    
                                       
                                          
                                             M
                                          
                                       
                                       
                                          2
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    
                                       
                                          
                                             A
                                          
                                       
                                       
                                          ′
                                       
                                    
                                    
                                       
                                          
                                             Ψ
                                          
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                x
                                             
                                          
                                          
                                             n
                                          
                                       
                                       −
                                       
                                          μ
                                       
                                       )
                                    
                                    ,
                                    
                                    and
                                 
                              
                              
                                 (17)
                                 
                                    E
                                    
                                       [
                                       
                                          
                                             
                                                y
                                             
                                          
                                          
                                             n
                                          
                                       
                                       
                                          
                                             
                                                y
                                             
                                          
                                          
                                             n
                                          
                                          
                                             ′
                                          
                                       
                                       |
                                       
                                          
                                             
                                                x
                                             
                                          
                                          
                                             n
                                          
                                       
                                       ]
                                    
                                    =
                                    
                                       
                                          
                                             M
                                          
                                       
                                       
                                          2
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    +
                                    E
                                    
                                       [
                                       
                                          
                                             
                                                y
                                             
                                          
                                          
                                             n
                                          
                                       
                                       |
                                       
                                          
                                             
                                                x
                                             
                                          
                                          
                                             n
                                          
                                       
                                       ]
                                    
                                    E
                                    
                                       
                                          
                                             [
                                             
                                                
                                                   
                                                      y
                                                   
                                                
                                                
                                                   n
                                                
                                             
                                             |
                                             
                                                
                                                   
                                                      x
                                                   
                                                
                                                
                                                   n
                                                
                                             
                                             ]
                                          
                                       
                                       
                                          ′
                                       
                                    
                                    .
                                 
                              
                           
                         Similarly to that in the EM for FA, the complete data log likelihood of 
                           
                              (
                              
                                 X
                              
                              ,
                              
                                 Y
                              
                              )
                           
                         is 
                           
                              
                                 
                                    
                                       L
                                    
                                    
                                       2
                                       c
                                    
                                 
                                 
                                    (
                                    
                                       X
                                    
                                    ,
                                    
                                       Y
                                    
                                    |
                                    
                                       θ
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       n
                                       =
                                       1
                                    
                                    
                                       N
                                    
                                 
                                 log
                                 
                                    {
                                    p
                                    
                                       (
                                       
                                          
                                             
                                                x
                                             
                                          
                                          
                                             n
                                          
                                       
                                       |
                                       
                                          
                                             
                                                y
                                             
                                          
                                          
                                             n
                                          
                                       
                                       ,
                                       
                                          θ
                                       
                                       )
                                    
                                    p
                                    
                                       (
                                       
                                          
                                             
                                                y
                                             
                                          
                                          
                                             n
                                          
                                       
                                       )
                                    
                                    }
                                 
                                 ,
                              
                           
                         where 
                           
                              θ
                           
                           =
                           
                              (
                              
                                 A
                              
                              ,
                              
                                 Ψ
                              
                              ,
                              
                                 V
                              
                              )
                           
                        . Each iteration of PX-EM consists of a PXE step and a PXM-step. 
                           
                              •
                              
                                 PXE-step: Given 
                                    
                                       θ
                                    
                                 , compute the expected 
                                    
                                       
                                          L
                                       
                                       
                                          2
                                          c
                                       
                                    
                                  w.r.t. the posterior distribution 
                                    p
                                    
                                       (
                                       
                                          
                                             
                                                y
                                             
                                          
                                          
                                             n
                                          
                                       
                                       |
                                       
                                          
                                             
                                                x
                                             
                                          
                                          
                                             n
                                          
                                       
                                       ,
                                       
                                          θ
                                       
                                       )
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                Q
                                             
                                             
                                                2
                                             
                                          
                                          
                                             (
                                             
                                                θ
                                             
                                             )
                                          
                                          =
                                          −
                                          
                                             
                                                N
                                             
                                             
                                                2
                                             
                                          
                                          
                                             (
                                             log
                                             
                                                |
                                                
                                                   Ψ
                                                
                                                |
                                             
                                             +
                                             log
                                             
                                                |
                                                
                                                   V
                                                
                                                |
                                             
                                             )
                                          
                                          −
                                          
                                             
                                                1
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                ∑
                                             
                                             
                                                n
                                                =
                                                1
                                             
                                             
                                                N
                                             
                                          
                                          
                                             {
                                             E
                                             
                                                [
                                                
                                                   
                                                      
                                                         y
                                                      
                                                   
                                                   
                                                      n
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                
                                                   
                                                      
                                                         V
                                                      
                                                   
                                                   
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   
                                                      
                                                         y
                                                      
                                                   
                                                   
                                                      n
                                                   
                                                
                                                |
                                                
                                                   
                                                      
                                                         x
                                                      
                                                   
                                                   
                                                      n
                                                   
                                                
                                                ]
                                             
                                             +
                                             E
                                             
                                                [
                                                
                                                   
                                                      
                                                         (
                                                         
                                                            
                                                               
                                                                  x
                                                               
                                                            
                                                            
                                                               n
                                                            
                                                         
                                                         −
                                                         
                                                            A
                                                         
                                                         
                                                            
                                                               
                                                                  y
                                                               
                                                            
                                                            
                                                               n
                                                            
                                                         
                                                         −
                                                         
                                                            
                                                               
                                                                  x
                                                               
                                                            
                                                            
                                                               ̄
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                
                                                   
                                                      
                                                         Ψ
                                                      
                                                   
                                                   
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            x
                                                         
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                   −
                                                   
                                                      A
                                                   
                                                   
                                                      
                                                         
                                                            y
                                                         
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         
                                                            x
                                                         
                                                      
                                                      
                                                         ̄
                                                      
                                                   
                                                   )
                                                
                                                |
                                                
                                                   
                                                      
                                                         x
                                                      
                                                   
                                                   
                                                      n
                                                   
                                                
                                                ]
                                             
                                             }
                                          
                                          ,
                                       
                                    
                                  where the required expectations are given by (16) and (17).


                                 PXM-step: Maximizing 
                                    
                                       
                                          Q
                                       
                                       
                                          2
                                       
                                    
                                  w.r.t. 
                                    
                                       θ
                                    
                                  yields 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      V
                                                   
                                                
                                                
                                                   ˜
                                                
                                             
                                             =
                                             
                                                
                                                   1
                                                
                                                
                                                   N
                                                
                                             
                                             E
                                             
                                                [
                                                
                                                   
                                                      
                                                         y
                                                      
                                                   
                                                   
                                                      n
                                                   
                                                
                                                
                                                   
                                                      
                                                         y
                                                      
                                                   
                                                   
                                                      n
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                |
                                                
                                                   
                                                      
                                                         x
                                                      
                                                   
                                                   
                                                      n
                                                   
                                                
                                                ]
                                             
                                             =
                                             
                                                
                                                   
                                                      M
                                                   
                                                
                                                
                                                   2
                                                
                                                
                                                   −
                                                   1
                                                
                                             
                                             
                                                
                                                   
                                                      A
                                                   
                                                
                                                
                                                   ′
                                                
                                             
                                             
                                                
                                                   
                                                      Ψ
                                                   
                                                
                                                
                                                   −
                                                   1
                                                
                                             
                                             
                                                S
                                             
                                             
                                                
                                                   
                                                      Ψ
                                                   
                                                
                                                
                                                   −
                                                   1
                                                
                                             
                                             
                                                A
                                             
                                             
                                                
                                                   
                                                      M
                                                   
                                                
                                                
                                                   2
                                                
                                                
                                                   −
                                                   1
                                                
                                             
                                             +
                                             
                                                
                                                   
                                                      M
                                                   
                                                
                                                
                                                   2
                                                
                                                
                                                   −
                                                   1
                                                
                                             
                                             ,
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      A
                                                   
                                                
                                                
                                                   ̃
                                                
                                             
                                             =
                                             
                                                
                                                   1
                                                
                                                
                                                   N
                                                
                                             
                                             
                                                
                                                   ∑
                                                
                                                
                                                   n
                                                   =
                                                   1
                                                
                                                
                                                   N
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      
                                                         x
                                                      
                                                   
                                                   
                                                      n
                                                   
                                                
                                                −
                                                
                                                   
                                                      
                                                         x
                                                      
                                                   
                                                   
                                                      ̄
                                                   
                                                
                                                )
                                             
                                             E
                                             
                                                
                                                   
                                                      [
                                                      
                                                         
                                                            
                                                               y
                                                            
                                                         
                                                         
                                                            n
                                                         
                                                      
                                                      |
                                                      
                                                         
                                                            
                                                               x
                                                            
                                                         
                                                         
                                                            n
                                                         
                                                      
                                                      ]
                                                   
                                                
                                                
                                                   ′
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            V
                                                         
                                                      
                                                      
                                                         ˜
                                                      
                                                   
                                                
                                                
                                                   −
                                                   1
                                                
                                             
                                             =
                                             
                                                S
                                             
                                             
                                                
                                                   
                                                      Ψ
                                                   
                                                
                                                
                                                   −
                                                   1
                                                
                                             
                                             
                                                A
                                             
                                             
                                                
                                                   
                                                      M
                                                   
                                                
                                                
                                                   2
                                                
                                                
                                                   −
                                                   1
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            V
                                                         
                                                      
                                                      
                                                         ˜
                                                      
                                                   
                                                
                                                
                                                   −
                                                   1
                                                
                                             
                                             ,
                                             
                                             and
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      Ψ
                                                   
                                                
                                                
                                                   ̃
                                                
                                             
                                             =
                                             
                                                
                                                   1
                                                
                                                
                                                   N
                                                
                                             
                                             diag
                                             
                                                {
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      n
                                                      =
                                                      1
                                                   
                                                   
                                                      N
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            x
                                                         
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         
                                                            x
                                                         
                                                      
                                                      
                                                         ̄
                                                      
                                                   
                                                   )
                                                
                                                
                                                   
                                                      
                                                         (
                                                         
                                                            
                                                               
                                                                  x
                                                               
                                                            
                                                            
                                                               n
                                                            
                                                         
                                                         −
                                                         
                                                            
                                                               
                                                                  x
                                                               
                                                            
                                                            
                                                               ̄
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                −
                                                
                                                   
                                                      
                                                         A
                                                      
                                                   
                                                   
                                                      ̃
                                                   
                                                
                                                E
                                                
                                                   [
                                                   
                                                      
                                                         
                                                            y
                                                         
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                   |
                                                   
                                                      
                                                         
                                                            x
                                                         
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                   ]
                                                
                                                
                                                   
                                                      
                                                         (
                                                         
                                                            
                                                               
                                                                  x
                                                               
                                                            
                                                            
                                                               n
                                                            
                                                         
                                                         −
                                                         
                                                            
                                                               
                                                                  x
                                                               
                                                            
                                                            
                                                               ̄
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                }
                                             
                                             ,
                                             =
                                             diag
                                             
                                                {
                                                
                                                   S
                                                
                                                −
                                                
                                                   
                                                      
                                                         A
                                                      
                                                   
                                                   
                                                      ̃
                                                   
                                                
                                                
                                                   
                                                      
                                                         M
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                   
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   
                                                      
                                                         A
                                                      
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                
                                                   
                                                      
                                                         Ψ
                                                      
                                                   
                                                   
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   S
                                                
                                                }
                                             
                                             ,
                                          
                                       
                                    
                                  where 
                                    
                                       S
                                    
                                  is given by (4). After convergence of the PX-EM is met, the expanded parameters can be reduced by setting 
                                    
                                       
                                          
                                             Ψ
                                          
                                       
                                       
                                          ̃
                                       
                                    
                                    =
                                    
                                       
                                          
                                             Ψ
                                          
                                       
                                       
                                          ̃
                                       
                                    
                                  and 
                                    
                                       
                                          
                                             A
                                          
                                       
                                       
                                          ̃
                                       
                                    
                                    =
                                    
                                       
                                          
                                             A
                                          
                                       
                                       
                                          ̃
                                       
                                    
                                    chol
                                    
                                       (
                                       
                                          
                                             
                                                V
                                             
                                          
                                          
                                             ˜
                                          
                                       
                                       )
                                    
                                 , where 
                                    chol
                                    
                                       (
                                       ⋅
                                       )
                                    
                                  denotes the Cholesky decomposition.


                        Table 1
                         lists the computation costs of EM and CM in each iteration given in Zhao et al. (2008). For comparison, the cost of PX-EM is also included. Since PX-EM and EM have similar updating formulae, they have similar per-iteration complexities. It can be observed from Table 1 that CM has the heaviest per-iteration complexity. However, when using the two-stage procedure to choose the number of factors, the candidate value of 
                           q
                         could be large and the per-iteration cost with PX-EM and EM could also be heavy.

In Section  3.1, we first review the previous two-stage procedure. In Section  3.2, we propose a novel one-stage algorithm for FA with complete data.

Due to the reason that the log likelihood 
                           L
                         under the FA model is a nondecreasing function of the number of factors 
                           q
                        , it cannot be adopted as a model complexity criterion. Several model selection criteria have been proposed to deal with this problem via a two-stage procedure, as described below.

Given a range of values of 
                           q
                         from 
                           
                              
                                 q
                              
                              
                                 
                                    min
                                 
                              
                           
                         to 
                           
                              
                                 q
                              
                              
                                 
                                    max
                                 
                              
                           
                        , which is assumed to include the optimal one, the two-stage procedure typically first obtains the ML estimates 
                           
                              
                                 
                                    θ
                                 
                              
                              
                                 ˆ
                              
                           
                           
                              (
                              q
                              )
                           
                         for each model 
                           q
                         and then employs a model selection criterion 
                           
                              
                                 L
                              
                              
                                 ∗
                              
                           
                           
                              (
                              q
                              ,
                              
                                 
                                    
                                       θ
                                    
                                 
                                 
                                    ˆ
                                 
                              
                              
                                 (
                                 q
                                 )
                              
                              )
                           
                         to choose the value 
                           
                              
                                 
                                    
                                       q
                                    
                                    
                                       ˆ
                                    
                                 
                                 =
                                 
                                    
                                       arg max
                                    
                                    
                                       q
                                    
                                 
                                 
                                    {
                                    
                                       
                                          L
                                       
                                       
                                          ∗
                                       
                                    
                                    
                                       (
                                       q
                                       ,
                                       
                                          
                                             
                                                θ
                                             
                                          
                                          
                                             ˆ
                                          
                                       
                                       
                                          (
                                          q
                                          )
                                       
                                       )
                                    
                                    }
                                 
                                 .
                              
                           
                         The criterion often takes the form 
                           
                              (18)
                              
                                 
                                    
                                       L
                                    
                                    
                                       ∗
                                    
                                 
                                 
                                    (
                                    q
                                    ,
                                    
                                       
                                          
                                             θ
                                          
                                       
                                       
                                          ˆ
                                       
                                    
                                    
                                       (
                                       q
                                       )
                                    
                                    )
                                 
                                 =
                                 L
                                 
                                    (
                                    
                                       X
                                    
                                    |
                                    
                                       
                                          
                                             θ
                                          
                                       
                                       
                                          ˆ
                                       
                                    
                                    
                                       (
                                       q
                                       )
                                    
                                    )
                                 
                                 −
                                 
                                    
                                       D
                                       
                                          (
                                          q
                                          )
                                       
                                    
                                    
                                       2
                                    
                                 
                                 C
                                 
                                    (
                                    N
                                    )
                                 
                                 ,
                              
                           
                         where 
                           D
                           
                              (
                              q
                              )
                           
                           =
                           d
                           
                              (
                              q
                              +
                              2
                              )
                           
                           −
                           q
                           
                              (
                              q
                              −
                              1
                              )
                           
                           /
                           2
                         is the number of free parameters in a 
                           q
                        -factor model as detailed in Section  2.1, and 
                           C
                           
                              (
                              N
                              )
                           
                           D
                           
                              (
                              q
                              )
                           
                           /
                           2
                         is a penalty term that penalizes the higher values of 
                           q
                        . Many criteria differ in 
                           C
                           
                              (
                              N
                              )
                           
                         only. For example, Akaike’s information criterion (AIC) (Akaike, 1987) takes 
                           C
                           
                              (
                              N
                              )
                           
                           =
                           2
                         while the Bayesian information criterion (BIC) (Schwarz, 1978) uses 
                           C
                           
                              (
                              N
                              )
                           
                           =
                           log
                           N
                        .

Such a two-stage procedure using the AIC/BIC is widely used for the FA model with complete data to determine the number of factors. However, this procedure has to enumerate all candidate models over the set of 
                           
                              {
                              q
                              }
                           
                        . Usually, to achieve satisfactory performance, a large set of candidate values of 
                           q
                         is used and the computational burden of this procedure can be heavy. For example, for the 50-dimensional data used in Section  5, by (3) we obtain the maximum 
                           
                              
                                 q
                              
                              
                                 
                                    max
                                 
                              
                           
                           =
                           40
                        , which means that, in principle, we have to enumerate a total of 40 FA models with different numbers of factors.

To overcome the problem suffered by the two-stage procedure, we develop a one-stage algorithm that integrates parameter estimation and model selection in a single algorithm, which we call the automated learning algorithm of FA (AFA). Specifically, the AFA consists of the following two CM-steps. 
                           
                              •
                              
                                 CM-step  1: Given 
                                    
                                       Ψ
                                    
                                 , maximizing 
                                    
                                       
                                          L
                                       
                                       
                                          ∗
                                       
                                    
                                    
                                       (
                                       
                                          A
                                       
                                       ,
                                       q
                                       )
                                    
                                  in (18) w.r.t. 
                                    
                                       A
                                    
                                  and 
                                    q
                                  yields 
                                    
                                       
                                          
                                             A
                                          
                                       
                                       
                                          ̃
                                       
                                    
                                  and 
                                    
                                       
                                          q
                                       
                                       
                                          ̃
                                       
                                    
                                 .


                                 CM-step  2: Given 
                                    
                                       
                                          
                                             A
                                          
                                       
                                       
                                          ̃
                                       
                                    
                                  and 
                                    
                                       
                                          
                                             Ψ
                                          
                                       
                                       
                                          i
                                       
                                    
                                 , maximizing 
                                    
                                       
                                          L
                                       
                                       
                                          ∗
                                       
                                    
                                    
                                       (
                                       
                                          
                                             ψ
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                  in (18) w.r.t. 
                                    
                                       
                                          ψ
                                       
                                       
                                          i
                                       
                                    
                                  yields 
                                    
                                       
                                          
                                             
                                                ψ
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                 , sequentially for 
                                    i
                                    =
                                    1
                                    ,
                                    2
                                    ,
                                    …
                                    ,
                                    d
                                 .

Substituting (7) into (5), we obtain (Zhao et al., 2008) 
                           
                              (19)
                              
                                 −
                                 
                                    
                                       2
                                    
                                    
                                       N
                                    
                                 
                                 ⋅
                                 L
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       
                                          
                                             q
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 
                                    (
                                    log
                                    
                                       
                                          λ
                                       
                                       
                                          i
                                       
                                    
                                    −
                                    
                                       
                                          λ
                                       
                                       
                                          i
                                       
                                    
                                    +
                                    1
                                    )
                                 
                                 +
                                 log
                                 
                                    |
                                    
                                       Ψ
                                    
                                    |
                                 
                                 +
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       d
                                    
                                 
                                 
                                    
                                       λ
                                    
                                    
                                       i
                                    
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 λ
                              
                              
                                 1
                              
                           
                           ≥
                           
                              
                                 λ
                              
                              
                                 2
                              
                           
                           ≥
                           ⋯
                           ≥
                           
                              
                                 λ
                              
                              
                                 d
                              
                           
                         are the eigenvalues of matrix 
                           
                              
                                 
                                    S
                                 
                              
                              
                                 ̄
                              
                           
                         defined in Section  2.2. Given 
                           
                              Ψ
                           
                           ,
                           log
                           
                              |
                              
                                 Ψ
                              
                              |
                           
                           +
                           
                              
                                 ∑
                              
                              
                                 j
                                 =
                                 1
                              
                              
                                 d
                              
                           
                           
                              
                                 λ
                              
                              
                                 j
                              
                           
                         is obviously a constant. Substituting (19) into (18) to compute 
                           
                              
                                 L
                              
                              
                                 ∗
                              
                           
                        , dropping the terms irrelevant to 
                           q
                        , we obtain 
                           
                              (20)
                              
                                 
                                    
                                       q
                                    
                                    
                                       ̃
                                    
                                 
                                 =
                                 
                                    
                                       arg min
                                    
                                    
                                       q
                                    
                                 
                                 
                                    {
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          q
                                       
                                    
                                    
                                       (
                                       log
                                       
                                          
                                             λ
                                          
                                          
                                             i
                                          
                                       
                                       −
                                       
                                          
                                             λ
                                          
                                          
                                             i
                                          
                                       
                                       +
                                       1
                                       )
                                    
                                    +
                                    D
                                    
                                       (
                                       q
                                       )
                                    
                                    
                                       
                                          C
                                          
                                             (
                                             N
                                             )
                                          
                                       
                                       
                                          N
                                       
                                    
                                    }
                                 
                                 .
                              
                           
                         Once 
                           
                              
                                 q
                              
                              
                                 ̃
                              
                           
                         has been obtained by (20), we can easily obtain 
                           
                              
                                 
                                    A
                                 
                              
                              
                                 ̃
                              
                           
                         by (7) using the existing eigendecomposition of 
                           
                              
                                 
                                    S
                                 
                              
                              
                                 ̄
                              
                           
                        . For clarity, the detailed pseudocode of the whole automated leaning algorithm is given in Algorithm 2.


                        
                           
                              
                           
                        
                     

Clearly, unlike the two-stage procedure, the AFA is free from exhaustive enumeration. The computational cost of the AFA looks roughly equivalent to that of a single run of CM for a fixed 
                           q
                        . Thus, the more candidate values of 
                           q
                         are used in the two-stage procedure, the more advantageous the AFA is. As will be seen in Section  5.1, the AFA is much more efficient than the two-stage procedure by EM/PX-EM.

In this section, we shall extend the AFA to accommodate incomplete data. Similarly to  Song and Belin (2008), we assume that incomplete data satisfy the missing at random (MAR) mechanism defined in Little and Rubin (1987), such that we can make use of the standard methodology detailed there to deal with incomplete data.

Let 
                           
                              
                                 
                                    x
                                 
                              
                              
                                 o
                              
                           
                         and 
                           
                              
                                 
                                    x
                                 
                              
                              
                                 m
                              
                           
                         be the observed and missing parts of 
                           
                              x
                           
                           =
                           
                              (
                              
                                 
                                    
                                       x
                                    
                                 
                                 
                                    o
                                 
                              
                              ;
                              
                                 
                                    
                                       x
                                    
                                 
                                 
                                    m
                                 
                              
                              )
                           
                         and 
                           
                              
                                 I
                              
                              
                                 o
                              
                           
                         and 
                           
                              
                                 I
                              
                              
                                 m
                              
                           
                         denote their corresponding sets of indices in 
                           
                              x
                           
                        , respectively. Alternatively, we could also introduce two additional permutation matrices to extract 
                           
                              
                                 
                                    x
                                 
                              
                              
                                 o
                              
                           
                         and 
                           
                              
                                 
                                    x
                                 
                              
                              
                                 m
                              
                           
                         from 
                           
                              x
                           
                         as done in Lin et al. (2006, 2009). From (2), we have the following well known normal results: 
                           
                              
                                 
                                    
                                       
                                          
                                             x
                                          
                                       
                                       
                                          o
                                       
                                    
                                    ∼
                                    N
                                    
                                       (
                                       
                                          
                                             
                                                μ
                                             
                                          
                                          
                                             o
                                          
                                       
                                       ,
                                       
                                          
                                             
                                                Σ
                                             
                                          
                                          
                                             o
                                             o
                                          
                                       
                                       )
                                    
                                    ,
                                    
                                    and
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             x
                                          
                                       
                                       
                                          m
                                       
                                    
                                    |
                                    
                                       
                                          
                                             x
                                          
                                       
                                       
                                          o
                                       
                                    
                                    ∼
                                    N
                                    
                                       (
                                       
                                          
                                             
                                                μ
                                             
                                          
                                          
                                             m
                                             ⋅
                                             o
                                          
                                       
                                       ,
                                       
                                          
                                             
                                                Σ
                                             
                                          
                                          
                                             m
                                             m
                                             ⋅
                                             o
                                          
                                       
                                       )
                                    
                                    ,
                                 
                              
                           
                         where, according to the indices in 
                           
                              
                                 I
                              
                              
                                 o
                              
                           
                         and 
                           
                              
                                 I
                              
                              
                                 m
                              
                           
                           ,
                           
                              
                                 
                                    μ
                                 
                              
                              
                                 o
                              
                           
                         and 
                           
                              
                                 
                                    μ
                                 
                              
                              
                                 m
                              
                           
                         denote the corresponding subvectors of 
                           
                              μ
                           
                           ,
                           
                              
                                 
                                    Σ
                                 
                              
                              
                                 o
                                 o
                              
                           
                           ,
                           
                              
                                 
                                    Σ
                                 
                              
                              
                                 m
                                 o
                              
                           
                           =
                           
                              
                                 
                                    
                                       
                                          Σ
                                       
                                    
                                    
                                       o
                                       m
                                    
                                 
                              
                              
                                 ′
                              
                           
                         and 
                           
                              
                                 
                                    Σ
                                 
                              
                              
                                 m
                                 m
                              
                           
                         denote the corresponding submatrices of 
                           
                              Σ
                           
                        , 
                           
                              
                                 (21)
                                 
                                    
                                       
                                          
                                             μ
                                          
                                       
                                       
                                          m
                                          ⋅
                                          o
                                       
                                    
                                    =
                                    E
                                    
                                       (
                                       
                                          
                                             
                                                x
                                             
                                          
                                          
                                             m
                                          
                                       
                                       |
                                       
                                          
                                             
                                                x
                                             
                                          
                                          
                                             o
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       
                                          
                                             μ
                                          
                                       
                                       
                                          m
                                       
                                    
                                    −
                                    
                                       
                                          
                                             Σ
                                          
                                       
                                       
                                          m
                                          o
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   Σ
                                                
                                             
                                             
                                                o
                                                o
                                             
                                          
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                x
                                             
                                          
                                          
                                             o
                                          
                                       
                                       −
                                       
                                          
                                             
                                                μ
                                             
                                          
                                          
                                             o
                                          
                                       
                                       )
                                    
                                    ,
                                    
                                    and
                                 
                              
                              
                                 (22)
                                 
                                    
                                       
                                          
                                             Σ
                                          
                                       
                                       
                                          m
                                          m
                                          ⋅
                                          o
                                       
                                    
                                    =
                                    cov
                                    
                                       (
                                       
                                          
                                             
                                                x
                                             
                                          
                                          
                                             m
                                          
                                       
                                       |
                                       
                                          
                                             
                                                x
                                             
                                          
                                          
                                             o
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       
                                          
                                             Σ
                                          
                                       
                                       
                                          m
                                          m
                                       
                                    
                                    −
                                    
                                       
                                          
                                             Σ
                                          
                                       
                                       
                                          m
                                          o
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   Σ
                                                
                                             
                                             
                                                o
                                                o
                                             
                                          
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    
                                       
                                          
                                             Σ
                                          
                                       
                                       
                                          o
                                          m
                                       
                                    
                                    .
                                 
                              
                           
                        
                        
                           
                              
                                 
                                    μ
                                 
                              
                              
                                 m
                                 ⋅
                                 o
                              
                           
                         and 
                           
                              
                                 
                                    Σ
                                 
                              
                              
                                 m
                                 m
                                 ⋅
                                 o
                              
                           
                         can be calculated directly by (21) and (22), respectively. Actually, they can be obtained in a more efficient manner via the Sweep operator (SWP) or reverse SWP (RSWP) (see,e.g.,  Little and Rubin, 1987; Lange, 1999) as follows: 
                           
                              
                                 SWP
                                 
                                    [
                                    
                                       
                                          I
                                       
                                       
                                          o
                                       
                                    
                                    ]
                                 
                                 
                                    Σ
                                 
                                 =
                                 RSWP
                                 
                                    [
                                    
                                       
                                          I
                                       
                                       
                                          m
                                       
                                    
                                    ]
                                 
                                 
                                    
                                       
                                          Σ
                                       
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          
                                             −
                                             
                                                
                                                   
                                                      
                                                         
                                                            Σ
                                                         
                                                      
                                                      
                                                         o
                                                         o
                                                      
                                                   
                                                
                                                
                                                   −
                                                   1
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            Σ
                                                         
                                                      
                                                      
                                                         o
                                                         o
                                                      
                                                   
                                                
                                                
                                                   −
                                                   1
                                                
                                             
                                             
                                                
                                                   
                                                      Σ
                                                   
                                                
                                                
                                                   o
                                                   m
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      Σ
                                                   
                                                
                                                
                                                   m
                                                   o
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            Σ
                                                         
                                                      
                                                      
                                                         o
                                                         o
                                                      
                                                   
                                                
                                                
                                                   −
                                                   1
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      Σ
                                                   
                                                
                                                
                                                   m
                                                   m
                                                   ⋅
                                                   o
                                                
                                             
                                          
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                         For the FA model, we have the following relations (Zhao et al., 2008): 
                           
                              
                                 (23)
                                 
                                    
                                       
                                          
                                             Σ
                                          
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    =
                                    
                                       
                                          
                                             Ψ
                                          
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    −
                                    
                                       
                                          
                                             Ψ
                                          
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    
                                       A
                                    
                                    
                                       
                                          
                                             (
                                             
                                                I
                                             
                                             +
                                             
                                                
                                                   
                                                      A
                                                   
                                                
                                                
                                                   ′
                                                
                                             
                                             
                                                
                                                   
                                                      Ψ
                                                   
                                                
                                                
                                                   −
                                                   1
                                                
                                             
                                             
                                                A
                                             
                                             )
                                          
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    
                                       
                                          
                                             A
                                          
                                       
                                       
                                          ′
                                       
                                    
                                    
                                       
                                          
                                             Ψ
                                          
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    ,
                                    
                                    and
                                 
                              
                              
                                 (24)
                                 
                                    
                                       |
                                       
                                          Σ
                                       
                                       |
                                    
                                    =
                                    
                                       |
                                       
                                          Ψ
                                       
                                       |
                                    
                                    
                                    
                                       |
                                       
                                          I
                                       
                                       +
                                       
                                          
                                             
                                                A
                                             
                                          
                                          
                                             ′
                                          
                                       
                                       
                                          
                                             
                                                Ψ
                                             
                                          
                                          
                                             −
                                             1
                                          
                                       
                                       
                                          A
                                       
                                       |
                                    
                                    .
                                 
                              
                           
                         When the missing portion of 
                           
                              x
                           
                         is not large (say, less than 50%), we prefer RSWP since the inverse of 
                           
                              Σ
                           
                         can be efficiently calculated by (23) and RSWP requires a smaller number of sweeps than SWP. In addition, dividing 
                           
                              |
                              
                                 Σ
                              
                              |
                           
                         from (24) by the product of the diagonal elements just after each is swept yields 
                           
                              |
                              
                                 
                                    
                                       Σ
                                    
                                 
                                 
                                    o
                                    o
                                 
                              
                              |
                           
                         as a by-product, which is useful for evaluating the observed data log likelihood (25). When the missing portion of 
                           
                              x
                           
                         is large (say, more than 50%), we choose SWP. In this case, 
                           
                              |
                              
                                 
                                    
                                       Σ
                                    
                                 
                                 
                                    o
                                    o
                                 
                              
                              |
                           
                         is the product of the diagonal elements just before each is swept.

Up to a constant term, the observed log likelihood of 
                           
                              θ
                           
                           =
                           
                              (
                              
                                 μ
                              
                              ,
                              
                                 A
                              
                              ,
                              
                                 Ψ
                              
                              )
                           
                         for incomplete data 
                           
                              
                                 
                                    X
                                 
                              
                              
                                 
                                    obs
                                 
                              
                           
                           =
                           
                              
                                 
                                    {
                                    
                                       
                                          
                                             x
                                          
                                       
                                       
                                          n
                                       
                                       
                                          o
                                       
                                    
                                    }
                                 
                              
                              
                                 n
                                 =
                                 1
                              
                              
                                 N
                              
                           
                         is 
                           
                              (25)
                              
                                 
                                    
                                       L
                                    
                                    
                                       o
                                    
                                 
                                 
                                    (
                                    
                                       θ
                                    
                                    ∣
                                    
                                       
                                          
                                             X
                                          
                                       
                                       
                                          
                                             obs
                                          
                                       
                                    
                                    )
                                 
                                 =
                                 −
                                 
                                    
                                       ∑
                                    
                                    
                                       n
                                       =
                                       1
                                    
                                    
                                       N
                                    
                                 
                                 
                                    {
                                    log
                                    
                                       |
                                       
                                          
                                             
                                                Σ
                                             
                                          
                                          
                                             n
                                          
                                          
                                             o
                                             o
                                          
                                       
                                       |
                                    
                                    +
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   
                                                      x
                                                   
                                                
                                                
                                                   n
                                                
                                                
                                                   o
                                                
                                             
                                             −
                                             
                                                
                                                   
                                                      μ
                                                   
                                                
                                                
                                                   n
                                                
                                                
                                                   o
                                                
                                             
                                             )
                                          
                                       
                                       
                                          ′
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   Σ
                                                
                                             
                                             
                                                n
                                             
                                             
                                                o
                                                o
                                             
                                          
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                x
                                             
                                          
                                          
                                             n
                                          
                                          
                                             o
                                          
                                       
                                       −
                                       
                                          
                                             
                                                μ
                                             
                                          
                                          
                                             n
                                          
                                          
                                             o
                                          
                                       
                                       )
                                    
                                    }
                                 
                                 .
                              
                           
                         Let 
                           
                              X
                           
                           =
                           
                              (
                              
                                 
                                    
                                       X
                                    
                                 
                                 
                                    
                                       obs
                                    
                                 
                              
                              ,
                              
                                 
                                    
                                       X
                                    
                                 
                                 
                                    
                                       mis
                                    
                                 
                              
                              )
                           
                         be the complete data, where 
                           
                              
                                 
                                    X
                                 
                              
                              
                                 
                                    mis
                                 
                              
                           
                           =
                           
                              
                                 
                                    {
                                    
                                       
                                          
                                             x
                                          
                                       
                                       
                                          n
                                       
                                       
                                          m
                                       
                                    
                                    }
                                 
                              
                              
                                 n
                                 =
                                 1
                              
                              
                                 N
                              
                           
                        . Apart from a constant term, the complete data log likelihood of 
                           
                              θ
                           
                         for complete data 
                           
                              X
                           
                         is 
                           
                              
                                 
                                    
                                       L
                                    
                                    
                                       c
                                    
                                 
                                 
                                    (
                                    
                                       θ
                                    
                                    
                                    |
                                    
                                       X
                                    
                                    )
                                 
                                 =
                                 −
                                 
                                    
                                       ∑
                                    
                                    
                                       n
                                       =
                                       1
                                    
                                    
                                       N
                                    
                                 
                                 
                                    {
                                    log
                                    
                                       |
                                       
                                          Σ
                                       
                                       |
                                    
                                    +
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   
                                                      x
                                                   
                                                
                                                
                                                   n
                                                
                                             
                                             −
                                             
                                                μ
                                             
                                             )
                                          
                                       
                                       
                                          ′
                                       
                                    
                                    
                                       
                                          
                                             Σ
                                          
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                x
                                             
                                          
                                          
                                             n
                                          
                                       
                                       −
                                       
                                          μ
                                       
                                       )
                                    
                                    }
                                 
                                 .
                              
                           
                         To choose 
                           q
                         for incomplete data, Song and Belin (2008) suggest using the penalized observed data log likelihood 
                           
                              (26)
                              
                                 
                                    
                                       L
                                    
                                    
                                       o
                                    
                                    
                                       ∗
                                    
                                 
                                 
                                    (
                                    q
                                    ,
                                    
                                       
                                          
                                             θ
                                          
                                       
                                       
                                          ˆ
                                       
                                    
                                    
                                       (
                                       q
                                       )
                                    
                                    )
                                 
                                 =
                                 L
                                 
                                    (
                                    
                                       
                                          
                                             X
                                          
                                       
                                       
                                          o
                                       
                                    
                                    |
                                    
                                       
                                          
                                             θ
                                          
                                       
                                       
                                          ˆ
                                       
                                    
                                    
                                       (
                                       q
                                       )
                                    
                                    )
                                 
                                 −
                                 
                                    
                                       D
                                       
                                          (
                                          q
                                          )
                                       
                                    
                                    
                                       2
                                    
                                 
                                 C
                                 
                                    (
                                    N
                                    )
                                 
                                 .
                              
                           
                         Correspondingly, the penalized complete data log likelihood is 
                           
                              
                                 L
                              
                              
                                 c
                              
                              
                                 ∗
                              
                           
                           =
                           
                              
                                 L
                              
                              
                                 c
                              
                           
                           −
                           D
                           
                              (
                              q
                              )
                           
                           C
                           
                              (
                              N
                              )
                           
                           /
                           2
                        . Maximization of (26) can be achieved though the following three CM-steps. 
                           
                              •
                              
                                 CML-step  1: Given 
                                    
                                       (
                                       
                                          A
                                       
                                       ,
                                       
                                          Ψ
                                       
                                       )
                                    
                                 , maximizing 
                                    
                                       
                                          L
                                       
                                       
                                          o
                                       
                                       
                                          ∗
                                       
                                    
                                  in (26) w.r.t. 
                                    
                                       μ
                                    
                                  yields 
                                    
                                       
                                          
                                             μ
                                          
                                       
                                       
                                          ̃
                                       
                                    
                                 .


                                 E-step: Given 
                                    
                                       
                                          
                                             X
                                          
                                       
                                       
                                          o
                                       
                                    
                                  and 
                                    
                                       (
                                       
                                          
                                             
                                                μ
                                             
                                          
                                          
                                             ̃
                                          
                                       
                                       ,
                                       
                                          A
                                       
                                       ,
                                       
                                          Ψ
                                       
                                       )
                                    
                                 , compute the expected 
                                    
                                       
                                          L
                                       
                                       
                                          c
                                       
                                       
                                          ∗
                                       
                                    
                                  to obtain the 
                                    
                                       
                                          Q
                                       
                                       
                                          ∗
                                       
                                    
                                  function.


                                 CMQ-step  2: Given 
                                    
                                       (
                                       
                                          
                                             
                                                μ
                                             
                                          
                                          
                                             ̃
                                          
                                       
                                       ,
                                       
                                          Ψ
                                       
                                       )
                                    
                                 , maximizing 
                                    
                                       
                                          Q
                                       
                                       
                                          ∗
                                       
                                    
                                  w.r.t. 
                                    
                                       A
                                    
                                  and 
                                    q
                                  yields 
                                    
                                       
                                          
                                             A
                                          
                                       
                                       
                                          ̃
                                       
                                    
                                  and 
                                    
                                       
                                          q
                                       
                                       
                                          ̃
                                       
                                    
                                 .


                                 CMQ-step  3: Given 
                                    
                                       (
                                       
                                          
                                             
                                                μ
                                             
                                          
                                          
                                             ̃
                                          
                                       
                                       ,
                                       
                                          
                                             
                                                A
                                             
                                          
                                          
                                             ̃
                                          
                                       
                                       )
                                    
                                 , maximizing 
                                    
                                       
                                          Q
                                       
                                       
                                          ∗
                                       
                                    
                                  w.r.t. 
                                    
                                       Ψ
                                    
                                  yields 
                                    
                                       
                                          
                                             Ψ
                                          
                                       
                                       
                                          ̃
                                       
                                    
                                 .


                        
                           
                              
                           
                        
                     

Like the complete data case, the AFA with incomplete data does not require exhaustive enumeration. As will be seen in Section  5.2, the advantage of the AFA with incomplete data over the two-stage procedure by EM/PX-EM is much more substantial than that in the complete data case.

@&#EXPERIMENTS@&#

In this section, we use complete and incomplete data to examine the performance of the AFA and the two-stage procedure implemented by PX-EM as suggested in Song and Belin (2008). For comparison, the implementation by EM is also included. Since our focus in this paper is not to compare different criteria, we simply take the BIC as the model selection criterion in all our experiments. All computations are carried out by Matlab 8.0, which is run in the win64 environment of a desktop PC with CPU: Intel 2.93 GHz and RAM: 16 GB. The Matlab code of the AFA is available from http://www.ynufe.edu.cn/pub/tsxy/jhzhao/pub/code/afa.rar.

For all methods, we set 
                        η
                        =
                        0.005
                     . For EM, PX-EM and CM, we use the same initialization 
                        
                           (
                           
                              
                                 
                                    A
                                 
                              
                              
                                 
                                    (
                                    0
                                    )
                                 
                              
                           
                           ,
                           
                              
                                 
                                    Ψ
                                 
                              
                              
                                 
                                    (
                                    0
                                    )
                                 
                              
                           
                           )
                        
                      by performing PCA on 
                        
                           S
                        
                      given in (4), which is suggested as a good starting value for EM in Zhao et al. (2008). In the case of incomplete data, we use mean imputation (Little and Rubin, 1987) to fill the missing values and get 
                        
                           S
                        
                     . Unless otherwise stated, we initialize the AFA with 
                        q
                        =
                        1
                      and its corresponding PCA starting value. All algorithms are stopped when the relative change in the actual data log likelihood is smaller than a threshold 
                        
                           tol
                        
                      (Figueiredo and Jain, 2002) or the number of iterations exceeds the maximum 5000. Unless otherwise stated, we set 
                        
                           tol
                        
                        =
                        1
                        
                           
                              0
                           
                           
                              −
                              6
                           
                        
                      for EM, PX-EM and CM and use a stricter threshold 
                        
                           tol
                        
                        =
                        1
                        
                           
                              0
                           
                           
                              −
                              8
                           
                        
                      for the AFA due to its efficiency.

In this experiment, we use complete synthetic data to investigate the performance of different methods. With data dimensionality 
                           d
                           =
                           50
                        , number of factors 
                           
                              
                                 q
                              
                              
                                 s
                              
                           
                           =
                           15
                         and sample size 
                           N
                           =
                           10
                           d
                        , we use the following two data settings. 
                           
                              •
                              
                                 Normal noise: The data are generated from the FA model (1) parameterized by 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      Ψ
                                                   
                                                
                                                
                                                   1
                                                
                                             
                                             =
                                             diag
                                             
                                                {
                                                0.51
                                                :
                                                0.03
                                                :
                                                2
                                                }
                                             
                                             ;
                                             
                                             
                                                
                                                   
                                                      μ
                                                   
                                                
                                                
                                                   1
                                                
                                             
                                             =
                                             
                                                
                                                   
                                                      (
                                                      0
                                                      ,
                                                      0
                                                      ,
                                                      …
                                                      ,
                                                      0
                                                      )
                                                   
                                                
                                                
                                                   ′
                                                
                                             
                                             ;
                                             
                                             
                                                B
                                             
                                             =
                                             rand
                                             
                                                (
                                                d
                                                ,
                                                d
                                                )
                                             
                                             ,
                                          
                                       
                                       
                                          
                                             
                                                B
                                             
                                             =
                                             
                                                
                                                   
                                                      B
                                                   
                                                
                                                
                                                   ′
                                                
                                             
                                             
                                                B
                                             
                                             ,
                                             
                                             
                                                
                                                   
                                                      U
                                                   
                                                
                                                
                                                   
                                                      
                                                         q
                                                      
                                                      
                                                         s
                                                      
                                                   
                                                
                                             
                                             =
                                             eig
                                             
                                                (
                                                
                                                   B
                                                
                                                ,
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      s
                                                   
                                                
                                                )
                                             
                                             ,
                                             
                                             
                                                L
                                             
                                             =
                                             diag
                                             
                                                {
                                                3
                                                :
                                                0.5
                                                :
                                                10
                                                }
                                             
                                             ,
                                             
                                             
                                                
                                                   
                                                      A
                                                   
                                                
                                                
                                                   1
                                                
                                             
                                             =
                                             
                                                
                                                   
                                                      U
                                                   
                                                
                                                
                                                   
                                                      
                                                         q
                                                      
                                                      
                                                         s
                                                      
                                                   
                                                
                                             
                                             
                                                L
                                             
                                             ,
                                          
                                       
                                    
                                  where 
                                    rand
                                    
                                       (
                                       d
                                       ,
                                       d
                                       )
                                    
                                  is a 
                                    d
                                    ×
                                    d
                                  matrix containing random numbers drawn from the standard uniform distribution, 
                                    eig
                                    
                                       (
                                       
                                          B
                                       
                                       ,
                                       
                                          
                                             q
                                          
                                          
                                             s
                                          
                                       
                                       )
                                    
                                  returns a 
                                    d
                                    ×
                                    
                                       
                                          q
                                       
                                       
                                          s
                                       
                                    
                                  matrix whose columns consist of the top 
                                    
                                       
                                          q
                                       
                                       
                                          s
                                       
                                    
                                  eigenvectors of 
                                    
                                       B
                                    
                                 , and 
                                    
                                       [
                                       a
                                       :
                                       c
                                       :
                                       b
                                       ]
                                    
                                  denotes the vector 
                                    
                                       [
                                       a
                                       ,
                                       a
                                       +
                                       c
                                       ,
                                       …
                                       ,
                                       a
                                       +
                                       m
                                       c
                                       ]
                                    
                                  with 
                                    m
                                  being the nearest integer of 
                                    
                                       (
                                       b
                                       −
                                       a
                                       )
                                    
                                    /
                                    c
                                  towards minus infinity.


                                 High noise: The data are generated from the FA model (1) parameterized by 
                                    
                                       
                                          
                                             
                                                
                                                   μ
                                                
                                             
                                             
                                                2
                                             
                                          
                                          =
                                          
                                             
                                                
                                                   μ
                                                
                                             
                                             
                                                1
                                             
                                          
                                          ;
                                          
                                          
                                             
                                                
                                                   A
                                                
                                             
                                             
                                                2
                                             
                                          
                                          =
                                          
                                             
                                                
                                                   A
                                                
                                             
                                             
                                                1
                                             
                                          
                                          ;
                                          
                                          
                                             
                                                
                                                   Ψ
                                                
                                             
                                             
                                                2
                                             
                                          
                                          =
                                          
                                             
                                                
                                                   Ψ
                                                
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          
                                          except that
                                          
                                          
                                             
                                                
                                                   Ψ
                                                
                                             
                                             
                                                
                                                   
                                                      2
                                                   
                                                   
                                                      20
                                                      ,
                                                      20
                                                   
                                                
                                             
                                          
                                          =
                                          20
                                          ,
                                          
                                          
                                             
                                                
                                                   Ψ
                                                
                                             
                                             
                                                
                                                   
                                                      2
                                                   
                                                   
                                                      40
                                                      ,
                                                      40
                                                   
                                                
                                             
                                          
                                          =
                                          40
                                          .
                                       
                                    
                                 
                              

In this experiment, we investigate the convergence by EM, PX-EM and CM under different noise cases. For illustration purposes, we set 
                              
                                 tol
                              
                              =
                              1
                              
                                 
                                    0
                                 
                                 
                                    −
                                    8
                                 
                              
                            for normal noise data and 
                              
                                 tol
                              
                              =
                              1
                              
                                 
                                    0
                                 
                                 
                                    −
                                    10
                                 
                              
                            for high noise data. We fit the normal noise data with a 10-factor FA model and the high noise data with a 15-factor FA model. Fig. 1
                            shows the evolvements of their log likelihood values of 
                              L
                            versus number of iterations and the CPU time used in the cases of normal and high noise. The following can be seen from Fig. 1. 
                              
                                 (i)
                                 The convergence of CM is different from those of EM and PX-EM. In the case of normal noise, CM requires a much smaller number of iterations but more CPU time to converge due to its much higher per-iteration complexity as shown in Table 1; however, in the case of high noise, CM can be faster than EM and PX-EM no matter whether judged by CPU time or number of iterations.

Compared with CM, the convergence of PX-EM is similar to that of EM in general.

In this experiment, we examine the sensitivity of the AFA to the initialization of 
                              q
                           . To this end, we use three different values of 
                              q
                           , namely 
                              q
                              =
                              1
                              ,
                              q
                              =
                              10
                            and 
                              q
                              =
                              25
                           , and their corresponding PCA starting values. Fig. 2
                            shows the evolvement of the BIC values 
                              
                                 
                                    L
                                 
                                 
                                    ∗
                                 
                              
                            versus number of iterations and the CPU time used, and the evolvement of the 
                              q
                            values versus number of iterations. The following can be seen from Fig. 2. 
                              
                                 (i)
                                 Although different 
                                       q
                                     values yield different convergence curves, they end up with similar BIC values and output the correct solution (
                                       q
                                       =
                                       15
                                    ). 
                                       q
                                       =
                                       25
                                     converges the fastest in the normal noise case but the slowest in the high noise case.

By comparing Fig. 1(b) with Fig. 2(b) and Fig. 1(d) with Fig. 2(e), the time by the AFA with 
                                       q
                                       =
                                       1
                                    , which not only implements parameter estimation but also model selection, is generally comparable with or less than those by EM, PX-EM and CM, each of which implements parameter estimation for a single factor model only.

In this experiment, we compare the AFA with the two-stage procedures by EM and PX-EM. To save time for the two-stage procedures, we set 
                              
                                 
                                    q
                                 
                                 
                                    
                                       min
                                    
                                 
                              
                              =
                              1
                            and 
                              
                                 
                                    q
                                 
                                 
                                    
                                       max
                                    
                                 
                              
                              =
                              25
                           , though in principle the maximum by (3) should be 40. In addition, we have found that 
                              
                                 tol
                              
                              =
                              1
                              
                                 
                                    0
                                 
                                 
                                    −
                                    6
                                 
                              
                            is too loose for EM and PX-EM to get satisfactory results in the case of high noise, which is similar to the case shown in Fig. 1(c), and thus we also set 
                              
                                 tol
                              
                              =
                              1
                              
                                 
                                    0
                                 
                                 
                                    −
                                    8
                                 
                              
                            for them. To reduce variability, we generate 100 datasets. Fig. 3
                            shows the boxplots over 100 replications of the CPU time and the difference between the final BIC value by the AFA and those by EM and PX-EM. Table 2
                            summarizes the results. The main observations from Fig. 3 and Table 2 are as follows. 
                              
                                 (i)
                                 The AFA converges stably in terms of CPU time and yields a strictly larger BIC value in every replication.

In the case of normal noise, both the AFA and the two-stage procedure are 100% successful in determining the number of factors, but the AFA requires about 24 times less CPU time than the two-stage procedure by PX-EM.

In the case of high noise, the AFA is still 100% correct but EM and PX-EM suffer one and two failures, respectively, since they are trapped into poor local maxima or too early to be stopped. Moreover, the computational advantage of the AFA over the two-stage procedure by EM and PX-EM is more substantial than that in the case of normal noise.

In this section, we use incomplete synthetic data with normal noise to investigate the performance of different methods. Missing values are created by deleting randomly the observed values in the data detailed in Section  5.1 under two missing rate settings: 5% and 30%.

To obtain some insight into the convergence by EM, PX-EM and CM on incomplete data, we fit the data with a 15-factor FA model. For illustration purposes, we set 
                              
                                 tol
                              
                              =
                              1
                              
                                 
                                    0
                                 
                                 
                                    −
                                    10
                                 
                              
                           . Fig. 4
                            shows the evolvements of their log likelihood values of 
                              L
                            versus number of iterations and the CPU time used under 5% and 30% missing rates. The following can be seen from Fig. 4. 
                              
                                 (i)
                                 Unlike the complete data case shown in Fig. 1, Fig. 4(a) looks like Fig. 4(b) and Fig. 4(c) like Fig. 4(d). For incomplete data, the computational cost in each iteration tends to be dominated by the E-step that computes the expected complete data log likelihood and the different computational costs among the maximization steps in EM, PX-EM and CM as shown in Table 1 tend to be minor. Therefore, in the case of incomplete data, the number of iterations required to converge is a key factor in determining the CPU time. This is the reason why these two kinds of plots look similar, in particular, under the larger missing rate 30% (as shown in Fig. 4(c) and (d)).

Compared with EM and PX-EM, CM requires a much smaller number of iterations to converge and thus takes much less CPU time, due to the reason given in (i),

The convergence of PX-EM is similar to that of EM in general.

In this experiment, we examine the sensitivity of the AFA to the initialization of 
                              q
                            on incomplete data. As in Section  5.1.2, we use three different values of 
                              q
                           , namely 
                              q
                              =
                              1
                              ,
                              q
                              =
                              10
                            and 
                              q
                              =
                              25
                           . Fig. 5
                            shows the evolvements of BIC values 
                              
                                 
                                    L
                                 
                                 
                                    ∗
                                 
                              
                            versus number of iterations and the CPU time used, and the evolvement of 
                              q
                            values versus number of iterations. The following can be seen from Fig. 5. 
                              
                                 (i)
                                 Although different 
                                       q
                                     values yield slightly different convergence curves, they end up with similar BIC values and output the correct solution (
                                       q
                                       =
                                       15
                                    ). In addition, there is little difference among these different values of 
                                       q
                                     in terms of number of iterations and CPU time.

By comparing Fig. 4(b) with Fig. 5(b) (resp. Fig. 4(d) with Fig. 5(e)), the time by the AFA with 
                                       q
                                       =
                                       1
                                    , which not only implements parameter estimation but also model selection, is less than those by EM, PX-EM and CM, each of which implements parameter estimation for a single 
                                       q
                                       =
                                       10
                                     only.

In this experiment, we compare the AFA with the two-stage procedures by EM and PX-EM on incomplete data. As done in Section  5.1.3, we set 
                              
                                 
                                    q
                                 
                                 
                                    
                                       min
                                    
                                 
                              
                              =
                              1
                            and 
                              
                                 
                                    q
                                 
                                 
                                    
                                       max
                                    
                                 
                              
                              =
                              25
                           . Table 3
                            summarizes the results over 100 replications.


                           Fig. 6
                            shows the boxplots over 100 replications of the CPU time and the difference between the final BIC value by the AFA and those by EM and PX-EM. Table 3 summarizes the results. The main observations from Fig. 6 and Table 3 are as follows. 
                              
                                 (i)
                                 The AFA converges stably in terms of CPU time. Moreover, the AFA yields a strictly larger BIC value in every replication as it uses a stricter convergence criterion.

Both the AFA and the two-stage procedure are 100% successful in determining the number of factors, but the AFA takes about 180 (resp. 120) times less CPU time than the two-stage procedures by EM and PX-EM under 5% (resp. 30%) missing rate.

In this experiment, we use a real dataset to further compare the performance of the AFA with the two-stage procedure. This dataset contains 235 observations, collected from a survey to evaluate cereals (Lattin et al., 2003) by 116 cereal consumers on 12 popular cereal brands and 25 attributes. Song and Belin (2008) have analyzed this dataset with the two-stage procedure by PX-EM in both complete and incomplete cases. The incomplete case is obtained by treating 5% of the values as missing data. They have obtained a 4-factor FA model in both cases.

Following Song and Belin (2008), we also create an incomplete dataset with 5% missing from the complete dataset. We run the AFA in both complete and incomplete cases. For comparison, the results of the two-stage procedure by EM and PX-EM are also included in Table 4
                        . It can be seen that, no matter under which case, both the AFA and the two-stage procedure choose four factors. This is consistent with the result obtained in Song and Belin (2008). More importantly, the AFA achieves a better BIC value than the two-stage procedure but in a much shorter time. This observation is consistent with those obtained in Section  5.

We have developed a method for learning the factor analysis (FA) model with complete and incomplete data which is capable of determining the number of factors in an automated manner. The novelty is that we seamlessly incorporate model selection and parameter estimation in a single algorithm, instead of using a model selection criterion to choose one from a set of candidate models as done in the commonly used two-stage procedure. Experiments with complete and incomplete data reveal that the AFA and the two-stage procedure are equally effective in learning the FA model but the AFA is much more efficient, particularly for incomplete data.

The BIC is well known for its consistency in choosing the correct number of factors. This means that the performance of the BIC mainly depends on the sample size. In our simulations, our sample size is 500, which is a moderately large sample size, and thus the BIC performs satisfactorily in choosing the true model. We also note that the penalty term of the BIC for incomplete data is the same as that for complete data and thus ignores the amount of missing information inherent in incomplete data. It would be worthwhile to develop an improved BIC that can take such information into account.

In addition, it would be interesting to investigate how to extend the proposed AFA or its idea for automated learning of FA-related models with complete and incomplete data, including mixtures of factor analyzers (MFA) (Zhao and Yu, 2008), 
                        t
                     -distributed MFA (McLachlan et al., 2007; Wang and Lin, 2013), mixtures of common FA (MCFA) (Baek and McLachlan, 2011; Montanari and Viroli, 2010; Wang, 2013), 
                        t
                     -distributed MCFA (Baek et al., 2010), etc.

@&#ACKNOWLEDGMENTS@&#

The authors would like to thank the three anonymous reviewers for their valuable comments and suggestions that improved this paper. This work was supported partly by the Natural Science Foundation of China under projects 11361071 and 11161053.

@&#REFERENCES@&#

