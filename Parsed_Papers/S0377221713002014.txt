@&#MAIN-TITLE@&#The single item uncapacitated lot-sizing problem with time-dependent batch sizes: NP-hard and polynomial cases

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We study the lot sizing problem with time-dependent batch sizes.


                        
                        
                           
                           We prove that the problem is NP-hard if one of the cost parameters is time-varying.


                        
                        
                           
                           The problem is polynomial for stationary cost parameters and null holding cost.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Inventory

Uncapacitated lot sizing

Batch delivery

Stepwise cost

Polynomial time algorithm

Complexity

@&#ABSTRACT@&#


               
               
                  This paper considers the uncapacitated lot sizing problem with batch delivery, focusing on the general case of time-dependent batch sizes. We study the complexity of the problem, depending on the other cost parameters, namely the setup cost, the fixed cost per batch, the unit procurement cost and the unit holding cost. We establish that if any one of the cost parameters is allowed to be time-dependent, the problem is NP-hard. On the contrary, if all the cost parameters are stationary, and assuming no unit holding cost, we show that the problem is polynomially solvable in time O(T
                     3), where T denotes the number of periods of the horizon. We also show that, in the case of divisible batch sizes, the problem with time varying setup costs, a stationary fixed cost per batch and no unit procurement nor holding cost can be solved in time O(T
                     3 logT).
               
            

@&#INTRODUCTION@&#

We consider in this article the single item uncapacitated lot-sizing problem where the quantities ordered are delivered by batch (typically truck or container) from an external supplier. The same problem can be seen as a single machine with an unlimited capacity, producing a single item per batch of a certain size. In the remaining of the paper this problem is called UBLS for uncapacitated batch lot sizing. Like in the classical lot sizing problem, ordering a positive amount incurs a fixed cost f
                     
                        t
                     , also called setup cost, for ordering in period t, plus a procurement cost p
                     
                        t
                      per unit ordered, and a holding cost h
                     
                        t
                      per unit of product in stock between period t and t
                     +1. In this paper, we adopt an FTL (Full Truck Load) cost structure, where, in addition to the classical cost structure above, a fixed cost k
                     
                        t
                      is paid for each batch used in period t. Observe that this model differs from other batch models where a solution is constrained to use only full batches. We do allow in our model incomplete batches, also called fractional batches, but the same fixed cost k
                     
                        t
                      is paid in period t whatever the number of units actually in a batch. We denote by B
                     
                        t
                      the size of the batch in period t. Demands are known over a planning horizon of T periods and are to be satisfied without backlogging. Note that the demands and the batch sizes are both considered integer in the whole paper. The overall procurement cost q
                     
                        t
                     (x) for an amount x of products ordered in period t is thus given by:
                        
                           
                              q
                              (
                              0
                              )
                              =
                              0
                              
                              and
                              
                              
                                 
                                    q
                                 
                                 
                                    t
                                 
                              
                              (
                              x
                              )
                              =
                              
                                 
                                    f
                                 
                                 
                                    t
                                 
                              
                              +
                              
                                 
                                    p
                                 
                                 
                                    t
                                 
                              
                              x
                              +
                              ⌈
                              x
                              /
                              
                                 
                                    B
                                 
                                 
                                    t
                                 
                              
                              ⌉
                              
                                 
                                    k
                                 
                                 
                                    t
                                 
                              
                              
                              for
                              
                              x
                              >
                              0
                           
                        
                     A formulation of the problem is given below, where x
                     
                        t
                      represents the amount of products ordered in period t and s
                     
                        t
                      the stock level at the end of the period t. Without loss of generality we assume no initial inventory, that is s
                     0
                     =0.
                        
                           
                              (
                              UBLS
                              )
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   min
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         t
                                                         =
                                                         1
                                                      
                                                      
                                                         T
                                                      
                                                   
                                                
                                                (
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      t
                                                   
                                                
                                                (
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      t
                                                   
                                                
                                                )
                                                +
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      t
                                                   
                                                
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      t
                                                   
                                                
                                                )
                                             
                                          
                                          
                                             
                                                s
                                                .
                                                t
                                                .
                                             
                                             
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      t
                                                      -
                                                      1
                                                   
                                                
                                                +
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      t
                                                   
                                                
                                                =
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      t
                                                   
                                                
                                                +
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      t
                                                   
                                                
                                                
                                                ∀
                                                t
                                                =
                                                1
                                                ,
                                                …
                                                ,
                                                T
                                             
                                          
                                          
                                             
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      t
                                                   
                                                
                                                ,
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      t
                                                   
                                                
                                                ∈
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      +
                                                   
                                                
                                                
                                                ∀
                                                t
                                                =
                                                1
                                                ,
                                                …
                                                ,
                                                T
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     The first constraint is the classical flow conservation. Notice that this formulation is non-linear due to the procurement cost q
                     
                        t
                     (x).

The contribution of this article is to classify the complexity of the UBLS problem with time-dependent batch sizes according to the different cost parameters, and to better identify the frontier between polynomially solvable and NP-hard problems. To the best of our knowledge, while the case of a stationary batch size has been studied in the literature (see Section 2), the case of time-dependent batch sizes is mainly unexplored. Our results show that this problem is NP-hard if none but one of the cost parameters (setup, fixed cost per batch, unit procurement or unit holding costs) is allowed to be time-dependent. Moreover, the NP-hardness results hold under very stringent conditions, that is even if almost all the other cost parameters are null. On the opposite, when all cost parameters are stationary, we establish that the UBLS problem with time-dependent batch sizes can be solved in O(T
                     3) time complexity, assuming no holding cost. Fig. 1
                      gives a synthetic representation of our results and the corresponding sections where they appear.

For ease of the reading, in the remaining of the paper the notation (f
                     
                        t
                     /k
                     
                        t
                     /p
                     
                        t
                     /h
                     
                        t
                     ) is used to designate the assumptions adopted on the cost parameters (setup cost/fixed cost per batch/unit procurement cost/unit holding cost). The field for a parameter α will take either the value ‘−’ if α is null, ‘α’ if it is assumed stationary and ‘α
                     
                        t
                     ’ if it is allowed to be time-dependent. For example, the rightmost problem in Fig. 1 is designated by (f
                     
                        t
                     /k/−/−) in our notation, corresponding to UBLS instances with time-dependent setup costs, stationary fixed cost per batch and no unit procurement nor holding cost.

This paper is organized as follows. We start by presenting in Section 2 some relevant papers studying lot sizing problems, unbounded or capacitated, with batch deliveries. All these papers restrict to a stationary batch size. Section 3 gives some insights of the difficulty of the UBLS problem with time-dependent batch sizes and time-dependent cost parameters. The NP-hardness of the problem is formally proven in the succeeding sections considering in its turn each cost parameter as the only time-varying parameter together with the batch sizes. More precisely, Section 4 is devoted to the subproblem (−/k
                     
                        t
                     /−/−), Section 5 considers both (−/k/p
                     
                        t
                     /−) and (−/k/−/h
                     
                        t
                     ), that is time-varying unit costs. In Section 6 we study the case (f
                     
                        t
                     /k/−/−) with time-dependent setup costs, and propose an 
                        
                           O
                           (
                           T
                           
                              
                                 ∑
                              
                              
                                 t
                              
                           
                           
                              
                                 B
                              
                              
                                 t
                              
                           
                           )
                        
                      pseudo-polynomial time algorithm. This section establishes also that this special case becomes polynomially solvable if the batch sizes are divisible (i.e. for any periods u and v, either B
                     
                        u
                     ∣B
                     
                        v
                      or B
                     
                        v
                     ∣B
                     
                        u
                      holds). Finally, in Section 7, we consider the case (f/k/−/−) of stationary cost parameters and null holding cost, and we propose an O(T
                     3) time algorithm. We then discuss some open problems and some possible extensions of this work in Section 8.

@&#LITERATURE REVIEW@&#

The UBLS problem is well-studied in the literature, but as far as we know all the papers restrict to the case of a stationary batch size. Depending on the authors, the procurement cost considered in this paper is also called a stepwise cost or multiple setup cost. To the best of our knowledge, the first study considering a stepwise cost (but without setup cost) is due to Lippman (1969). The author proposes an 
                        
                           O
                        
                     (T
                     5) algorithm for the single-item UBLS problem for the case (−/k
                     
                        t
                     /p
                     
                        t
                     /h
                     
                        t
                     ) without backlogging. For the same problem, Pochet and Wolsey (1993) improve the result of Lippman by proposing an 
                        
                           O
                           (
                           
                              
                                 T
                              
                              
                                 2
                              
                           
                           min
                           (
                           T
                           ,
                           B
                           )
                           )
                        
                      time algorithm. Lee (1989) studies a similar structure, with a non null setup cost but assuming stationary cost parameters: in our notation (f/k/p/h). The author proposes an 
                        
                           O
                           (
                           
                              
                                 T
                              
                              
                                 4
                              
                           
                           )
                        
                      time algorithm. Li et al. (2004) consider the more general problem both with time-dependent cost parameters (f
                     
                        t
                     /k
                     
                        t
                     /p
                     
                        t
                     /h
                     
                        t
                     ) and with backlogging, and propose an 
                        
                           O
                           (
                           
                              
                                 T
                              
                              
                                 3
                              
                           
                           log
                           T
                        
                     ) time algorithm. Table 1
                      gives an overview of these different results. Recall that all of them assume a stationary batch size.

The capacitated lot-sizing problem (CLSP) with batch delivery has also been studied in the literature. Recently (Van Vyve, 2007) proposes an 
                        
                           O
                           (
                           
                              
                                 T
                              
                              
                                 3
                              
                           
                           )
                        
                      algorithm for a general case with time-dependent costs, (−/k
                     
                        t
                     /p
                     
                        t
                     /h
                     
                        t
                     ), time-dependent production capacity and allowing backlog. The time complexity of the algorithm reduces to 
                        
                           O
                           (
                           
                              
                                 T
                              
                              
                                 2
                              
                           
                           log
                           (
                           T
                           )
                           )
                        
                      in the case without backlogging. However, the author assumes null setup cost and a stationary batch size. Another paper on the CLSP with batch delivery is due to Akbalik and Rapine (2012). The authors study the constant capacitated CLSP with stationary batch sizes and propose polynomial time algorithms for two cases: an 
                        
                           O
                           (
                           
                              
                                 T
                              
                              
                                 4
                              
                           
                           )
                        
                      algorithm for the case with production capacity being a multiple of the batch size and an 
                        
                           O
                           (
                           
                              
                                 T
                              
                              
                                 6
                              
                           
                           )
                        
                      algorithm for the case of an arbitrary fixed capacity.

As a conclusion, when restricted to stationary batch sizes, stepwise costs appear not to alter the complexity status of the lot-sizing problem. That is, both the uncapacitated and capacitated lot-sizing problems remain polynomial, even when backlog is allowed. In contrast, we establish in this paper that problem UBLS with time-dependent batch sizes is NP-hard, as soon as all but one cost parameters are stationary.

To our knowledge, no dominance property has been proposed in the literature for the most general version of UBLS with the cost parameters being all time-dependent, in our notations (f
                     
                        t
                     /k
                     
                        t
                     /p
                     
                        t
                     /h
                     
                        t
                     ). Among the classical dominance properties in lot-sizing, the ZIO property is certainly the most common, see the seminal paper from Wagner and Whitin (1958). Recall that a policy is ZIO (Zero Inventory ordering) if it orders only if its current stock level is null. We show with a simple illustrative example (see Fig. 2
                     ) that the ZIO property is not dominant with time-dependent batch sizes. The example also demonstrates that we can not restrict to plannings where the entering stock level of an ordering period is bounded by its batch size. That is, the quantity stored at the beginning of a period where an order takes place may exceed the current batch size, and in fact any batch size, in any optimal planning. The instance consists of 2 periods with no demand at the first period and a demand of 12 units at the second period. The batch sizes are respectively 5 and 2, the fixed costs per batch are respectively 3 and 2, the other costs are null. The only optimal planning consists in producing two full batches in the first period (which represents 10 units) and one full batch in the second period (which represents 2 units), leading to a total cost of 8. Notice that the optimal policy orders in the second period while we have 10 units on hand, which is larger than the maximal batch size of the instance. We can easily modify the example by introducing unit procurement costs and decreasing the demand by one unit, such that the optimal policy orders a fractional batch in the second period.

Observe that the UBLS problem allows to have a null batch size in some periods. It means that ordering in these periods is simply not possible. We can remove these periods to obtain an equivalent instance where all the batch sizes are positive. Indeed, since backlogging is not allowed, the demand of a period t with a null batch size is necessarily ordered in a previous period. Proceeding backward from the end of the time horizon, we can delete each period with a null batch size from the instance and shift its demand to the preceding period. This procedure is a simple scan of the periods and can be achieved in linear time. This is summarized in the following remark:
                        Remark 1
                        Any instance of the UBLS problem can be transformed in linear time O(T) into an equivalent instance with only positive batch sizes.

In the literature, some papers propose heuristics and exact approaches for more general lot-sizing problems, assuming for instance piecewise concave procurement costs. In particular, the pseudo-polynomial time dynamic programming algorithm proposed by Shaw and Wagelmans (1998) for piecewise linear procurement costs and general holding costs can be adapted to solve the UBLS problem. Their algorithm solves the capacitated version of the problem in time O(DQ), with 
                        
                           D
                           =
                           
                              
                                 ∑
                              
                              
                                 t
                              
                           
                           
                              
                                 d
                              
                              
                                 t
                              
                           
                        
                      the overall demand and Q the overall number of pieces required to represent the production cost functions. To apply the algorithm of Shaw and Wagelmans (1998) to the UBLS problem, we can consider a virtual capacity of D at each period. In a period t, we have as many affine pieces as the possible number of batches, that is O(D/min{B
                     
                        t
                     , D}). Denoting 
                        
                           
                              
                                 
                                    
                                       B
                                    
                                    
                                       ¯
                                    
                                 
                              
                              
                                 t
                              
                           
                           =
                           min
                           {
                           
                              
                                 B
                              
                              
                                 t
                              
                           
                           ,
                           D
                           }
                        
                     , the time complexity of the problem is then in 
                        
                           O
                           (
                           
                              
                                 ∑
                              
                              
                                 t
                              
                           
                           
                              
                                 D
                              
                              
                                 2
                              
                           
                           /
                           
                              
                                 
                                    
                                       B
                                    
                                    
                                       ¯
                                    
                                 
                              
                              
                                 t
                              
                           
                           )
                        
                     . Since we can restrict ourselves to the instances with only positive batch sizes (cf Remark 1), this complexity is included in O(TD
                     2).
                        Theorem 1
                        
                           Problem UBLS can be solved in pseudo-polynomial time 
                           
                              
                                 O
                                 (
                                 
                                    
                                       D
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       t
                                    
                                 
                                 
                                    
                                       1
                                    
                                    
                                       
                                          
                                             
                                                
                                                   B
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             t
                                          
                                       
                                    
                                 
                                 )
                              
                           
                           .
                        

Though such a pseudo-polynomial algorithm is of little practical use for large demands and small batch sizes, it is important in theory since it implies that the UBLS problem can not be NP-hard in the strong sense. As a consequence, the complexity results of the following sections establish the NP-hardness of UBLS in the ordinary sense.

In the following, we are interested in showing that the UBLS problem is computationaly difficult to solve even on very rectricted classes of instances. In particular, we often restrict to a stationary unit procurement cost p. It is well known that in this case we can assume without loss of generality that p
                     =0, as long as the final inventory level is null. Also, we often consider a null unit holding cost. Observe that, contrary to the case of unit procurement cost, an arbitrary stationary holding cost h can not be reduced to the case of a null holding cost. Quite inevitably the special case with p
                     =0 and h
                     =0 will be encountered in what follows. Observe that when p
                     =0 and h
                     =0, the costs incurred by a batch do not depend on the number of units in it. Hence we can make the following remark:
                        Remark 2
                        With no unit procurement cost nor holding cost (p
                           =
                           h
                           =0), it is dominant to produce only full batches.

One can legitimately wonder for the instances with a stationary unit procurement cost p and a null holding cost if we can both assume that p
                     =0 and restrict to full batch plannings. Obviously we have little chance to end with a null inventory. However, it is easy to see that the optimal planning obtained with no unit procurement cost can be transformed into an optimal planning for a stationary unit procurement cost p, simply by removing the last batch ordered so that the planning satisfies exactly the total demand.

Finally, we never consider in this article the case of a null fixed cost per batch (k
                     =0). Clearly if k
                     =0 we do not need to pay attention to the size of the batches. The UBLS problem is then a classical uncapacitated lot sizing problem, and can be solved in linear time, see Aggarwal and Park (1993), even if all the other cost parameters are time-dependent.

We consider a first restricted version of the UBLS: The only time-dependent parameters are the fixed cost per batch (k
                     
                        t
                     ) and the batch sizes (B
                     
                        t
                     ). The next theorem states that the problem UBLS is NP-hard when both fixed cost per batch and batch sizes are time-dependent, even with no setup cost, no unit procurement cost and no unit holding cost.
                        Theorem 2
                        NP-hardness of (−/k
                           
                              t
                           /−/−)


                        
                           Problem UBLS is NP-hard even with null setup costs and null unit procurement and holding costs.
                        

The reduction to our restricted UBLS problem from the Unbounded Knapsack Problem (UKP) is quite immediate. The UKP has been proven NP-complete by Lueker et al. (1975). Recall that an instance of the Unbounded Knapsack Problem is constituted of n objects, each object i being associated with a profit u
                           
                              i
                            and a weight w
                           
                              i
                           . Given a knapsack of size W and a value U, it is asked whether there exists an integer vector y
                           =(y
                           1, …, y
                           
                              n
                           ) satisfying 
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       w
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       y
                                    
                                    
                                       i
                                    
                                 
                                 ⩽
                                 W
                              
                            and 
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       u
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       y
                                    
                                    
                                       i
                                    
                                 
                                 ⩾
                                 U
                              
                           . Observe that contrary to the 0-1-Knapsack Problem, we can select multiple copies of each object in the solution. We transform an instance I of UKP into an instance f(I) of the UBLS problem as follows:
                              
                                 •
                                 We have T
                                    =
                                    n
                                    +1 periods. The only positive demand appears in the last period, with d
                                    
                                       T
                                    
                                    =
                                    U
                                 

The size of a batch in a period i
                                    ∈[1, n] is B
                                    
                                       i
                                    
                                    =
                                    u
                                    
                                       i
                                     and its fixed cost is k
                                    
                                       i
                                    
                                    =
                                    w
                                    
                                       i
                                    . The batch size in the last period is null.

Setup costs, unit procurement and holding costs are null.

It is asked if a solution of cost at most W exists.

It is dominant to produce only full batches, and thus a planning is entirely described by the number y
                           
                              i
                            of batches ordered in each period i. Clearly f(I) is positive if and only if there exists 
                              
                                 y
                                 ∈
                                 
                                    
                                       Z
                                    
                                    
                                       +
                                    
                                    
                                       n
                                    
                                 
                              
                            such that 
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       B
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       y
                                    
                                    
                                       i
                                    
                                 
                                 ⩾
                                 
                                    
                                       d
                                    
                                    
                                       T
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       k
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       y
                                    
                                    
                                       i
                                    
                                 
                                 ⩽
                                 W
                              
                           , that is, if and only if the instance I is positive.□


                     Theorem 2 still holds even for stationary demands, that is d
                     
                        t
                     
                     =
                     d for all periods. For this, one can modify the reduction of the proof, adding a first period 0 with fixed cost k
                     0
                     =
                     W
                     +1 and batch size B
                     0
                     =
                     nU. The demand to satisfy in each period is now equal to U. It is asked if a solution of cost at most 2W
                     +1 exists. Clearly, any feasible solution must order in period 0. Thus a solution of cost at most 2W
                     +1 orders exactly one (full) batch at the first period, leaving only the demand d
                     
                        T
                     
                     =
                     U to satisfy. Hence we are exactly in the situation of the reduction of Theorem 2, that is we are asked if we can satisfy the last demand d
                     
                        T
                      at cost at most W from the periods 1 to n. We assume in the rest of this paper that the fixed costs per batch are stationary.

We consider next the case of a time-dependent unit procurement cost p
                     
                        t
                     . We show that even if all other cost parameters are stationary, problem UBLS with time-dependent batch sizes is NP-hard:
                        Theorem 3
                        NP-hardness of (−/k/p
                           
                              t
                           /−)


                        
                           Problem UBLS is NP-hard even with stationary fixed costs per batch, no setup cost and no holding costs.
                        

The proof is very similar to the proof proposed by Florian and Klein (1971) for the capacitated lot-sizing problem (CLSP), except that the reduction is done from a restricted version of the Unbounded Knapsack Problem called Money Change Problem (MCP), see Böcker and Lipták (2007). In the Money Change Problem, we are given n
                           +1 integers a
                           1, …, a
                           
                              n
                            and A. It is asked whether there exists an integer vector 
                              
                                 y
                                 ∈
                                 
                                    
                                       Z
                                    
                                    
                                       +
                                    
                                    
                                       n
                                    
                                 
                              
                            such that 
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       a
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       y
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 A
                              
                           . That is, is it possible to constitute exactly the amount A of money by using coins of facial values a
                           1, …, a
                           
                              n
                           ? For a proof of the NP-completeness of MCP, the reader is referred to Lueker et al. (1975).

We transform an instance I of the Money Change Problem into an instance f(I) of UBLS problem as follows:
                              
                                 •
                                 We have T
                                    =
                                    n
                                    +1 periods. The only positive demand appears in the last period, with d
                                    
                                       T
                                    
                                    =
                                    A.

The size of a batch in a period i
                                    ∈[1, n] is B
                                    
                                       i
                                    
                                    =
                                    a
                                    
                                       i
                                     and its unit procurement cost is 
                                       
                                          
                                             
                                                p
                                             
                                             
                                                i
                                             
                                          
                                          =
                                          
                                             
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      i
                                                   
                                                
                                                -
                                                1
                                             
                                             
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                       
                                    . The batch size in the last period is null.

The fixed cost per batch equals 1 in each period.

Setup costs and holding costs are null in all periods.

It is asked if a solution of cost at most A exists.

As in Florian and Klein (1971), the keystone of the proof is to notice that for any period i
                           =1, …, n, the overall procurement cost q
                           
                              i
                           (x)=⌈ x/a
                           
                              i
                           ⌉+(a
                           
                              i
                           
                           −1)(x/a
                           
                              i
                           ) for an amount x satisfies q
                           
                              i
                           (x)⩾
                           x, and, q
                           
                              i
                           (x)=
                           x if and only if x is a multiple of a
                           
                              i
                           . That is, only full batch deliveries permit an average cost per product of 1. If the MCP instance I is positive, clearly ordering y
                           
                              i
                            full batches in each period i results in a feasible planning for the UBLS instance f(I), of cost exactly A. Conversely, if f(I) is positive, since the total demand to serve is of A units and the average procurement cost per product is at least 1, there must exist a feasible planning ordering exactly A units in total and using only full batches. The number y
                           
                              i
                            of batches ordered in each period is thus a valid vector for the instance I.□

We have the counterpart of Theorem 3 for time-dependent holding costs:
                        Theorem 4
                        NP-hardness of (−/k/−/h
                           
                              t
                           )


                        
                           Problem UBLS is NP-hard even with stationary fixed costs per batch, no setup costs and no unit procurement costs.
                        

We use the classical result, see Pochet and Wolsey (2006) or Wagelmans et al. (1992), that any instance of the lot-sizing problem can be transformed into an equivalent instance with no holding costs and modified unit procurement costs. For this, we redefine the unit procurement cost at period t as 
                              
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       t
                                    
                                 
                                 =
                                 
                                    
                                       p
                                    
                                    
                                       t
                                    
                                 
                                 +
                                 
                                    
                                       ∑
                                    
                                    
                                       u
                                       =
                                       t
                                    
                                    
                                       T
                                    
                                 
                                 
                                    
                                       h
                                    
                                    
                                       u
                                    
                                 
                              
                           .□

Once again Theorems 3 and 4 state very restrictive conditions under which the problem UBLS is NP-hard if the fixed cost per batch is stationary and unit (procurement or holding) costs are time-dependent. In the following we assume that both unit costs are stationary.

We consider here the setup costs (f
                     
                        t
                     ) as the only time-dependent cost parameters. In addition, we restrict ourselves to instances with no unit procurement cost (p
                     =0) and no unit holding cost (h
                     =0). This means that once the setup paid, any batch in any period has the same cost k. But of course the size of the batches may differ from one period to another. Obviously, it is dominant to produce only full batches. Although this problem seems simple, it happens to be NP-hard as stated in Section 6.1. In Section 6.2 we show that the problem is pseudopolynomially solvable and it becomes polynomially solvable in the case of divisible batch sizes (see Section 6.3).


                        
                           Theorem 5
                           NP-hardness of (f
                              
                                 t
                              /k/−/−)


                           
                              Problem UBLS is NP-hard even with stationary fixed cost per batch and null unit procurement and holding costs.
                           

We show that the 0-1-Knapsack Problem can be polynomially reduced to the problem UBLS. Recall that in the Knapsack Problem we are given n objects, with a profit u
                              
                                 i
                               and a weight w
                              
                                 i
                               for each object i, together with a knapsack size W and a utility value U. It is asked whether there exists a subset S of objects whose total weight does not exceed W and whose total profit is at least U. That is, if there exists a binary vector y
                              =(y
                              1, …, y
                              
                                 n
                              )∈{0, 1}
                                 n
                               satisfying 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          w
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          y
                                       
                                       
                                          i
                                       
                                    
                                    ⩽
                                    W
                                 
                               and 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          u
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          y
                                       
                                       
                                          i
                                       
                                    
                                    ⩾
                                    U
                                 
                              .


                              The transformation f. We transform an instance I of the Knapsack Problem into an instance f(I) of UBLS as follows: we have T
                              =2n
                              +1 periods. Each couple of consecutive periods (2i
                              −1, 2i) is related somehow to the object i. The same idea is used in Helmrich et al. (2011). We call the couple (2i
                              −1, 2i) of periods the pair i. The last period T is different and has a particular role. The idea of the reduction is to constrain f(I) to be positive if and only if there exists a planning which orders exactly one batch in each pair and no batch in period T. In each pair i, the choice between ordering in the even or in the odd period will correspond to the choice between selecting or not the object i in the instance I. We now define explicitly the instance f(I):
                                 
                                    •
                                    The demand in each period t is:
                                          
                                             
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      t
                                                   
                                                
                                                =
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  0
                                                               
                                                               
                                                                  if
                                                                  
                                                                  t
                                                                  
                                                                  is
                                                                  
                                                                  odd
                                                                  ,
                                                                  
                                                                  t
                                                                  <
                                                                  T
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     
                                                                        3
                                                                     
                                                                     
                                                                        t
                                                                        /
                                                                        2
                                                                     
                                                                  
                                                                  B
                                                               
                                                               
                                                                  if
                                                                  
                                                                  t
                                                                  
                                                                  is
                                                                  
                                                                  even
                                                                  ,
                                                                  
                                                                  t
                                                                  <
                                                                  T
                                                               
                                                            
                                                            
                                                               
                                                                  U
                                                               
                                                               
                                                                  if
                                                                  
                                                                  t
                                                                  =
                                                                  T
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       where 
                                          
                                             B
                                             =
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   u
                                                
                                                
                                                   i
                                                
                                             
                                          
                                        the total utility of the knapsack instance I.

The batch size in each period t is:
                                          
                                             
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      t
                                                   
                                                
                                                =
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        3
                                                                     
                                                                     
                                                                        (
                                                                        t
                                                                        +
                                                                        1
                                                                        )
                                                                        /
                                                                        2
                                                                     
                                                                  
                                                                  B
                                                               
                                                               
                                                                  if
                                                                  
                                                                  t
                                                                  
                                                                  is
                                                                  
                                                                  odd
                                                                  ,
                                                                  
                                                                  t
                                                                  <
                                                                  T
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     
                                                                        3
                                                                     
                                                                     
                                                                        t
                                                                        /
                                                                        2
                                                                     
                                                                  
                                                                  B
                                                                  +
                                                                  
                                                                     
                                                                        u
                                                                     
                                                                     
                                                                        t
                                                                        /
                                                                        2
                                                                     
                                                                  
                                                               
                                                               
                                                                  if
                                                                  
                                                                  t
                                                                  
                                                                  is
                                                                  
                                                                  even
                                                                  ,
                                                                  
                                                                  t
                                                                  <
                                                                  T
                                                               
                                                            
                                                            
                                                               
                                                                  U
                                                               
                                                               
                                                                  if
                                                                  
                                                                  t
                                                                  =
                                                                  T
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    

The setup cost in each period t is:
                                          
                                             
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      t
                                                   
                                                
                                                =
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  0
                                                               
                                                               
                                                                  if
                                                                  
                                                                  t
                                                                  
                                                                  is
                                                                  
                                                                  odd
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     
                                                                        w
                                                                     
                                                                     
                                                                        t
                                                                        /
                                                                        2
                                                                     
                                                                  
                                                               
                                                               
                                                                  if
                                                                  
                                                                  t
                                                                  
                                                                  is
                                                                  
                                                                  even
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    

For all periods the fixed cost per batch is k
                                       =
                                       W
                                       +1

It is asked if a solution of cost at most Z
                                       =
                                       nk
                                       +
                                       W exists.

The resulting instance f(I) looks as follows:
                                 
                                    
                                       
                                       
                                       
                                       
                                       
                                          
                                             
                                                t
                                             
                                             Demand
                                             Batch size
                                             Setup cost
                                          
                                       
                                       
                                          
                                             1
                                             0
                                             3B
                                             
                                             0
                                          
                                          
                                             2
                                             3B
                                             
                                             3B
                                                +
                                                u
                                                1
                                             
                                             
                                                w
                                                1
                                             
                                          
                                          
                                             3
                                             0
                                             9B
                                             
                                             0
                                          
                                          
                                             4
                                             9B
                                             
                                             9B
                                                +
                                                u
                                                2
                                             
                                             
                                                w
                                                2
                                             
                                          
                                          
                                             …
                                          
                                          
                                             2i
                                                −1
                                             0
                                             3
                                                   i
                                                
                                                B
                                             
                                             0
                                          
                                          
                                             2i
                                             
                                             3
                                                   i
                                                
                                                B
                                             
                                             3
                                                   i
                                                
                                                B
                                                +
                                                u
                                                
                                                   i
                                                
                                             
                                             
                                                w
                                                
                                                   i
                                                
                                             
                                          
                                          
                                             …
                                          
                                          
                                             2n
                                                −1
                                             0
                                             3
                                                   n
                                                
                                                B
                                             
                                             0
                                          
                                          
                                             2n
                                             
                                             3
                                                   n
                                                
                                                B
                                             
                                             3
                                                   n
                                                
                                                B
                                                +
                                                u
                                                
                                                   n
                                                
                                             
                                             
                                                w
                                                
                                                   n
                                                
                                             
                                          
                                          
                                             
                                                T
                                             
                                             
                                                U
                                             
                                             
                                                U
                                             
                                             0
                                          
                                       
                                    
                                 
                              
                           

This transformation f is polynomial. The number of periods in the instance f(I) is clearly polynomial in the size of instance x; the non-trivial point to check is that too large numbers do not appear in the transformation. The largest value 
                                 
                                    Max
                                    (
                                    f
                                    (
                                    I
                                    )
                                    )
                                 
                               appearing in the instance is either k
                              =
                              W
                              +1, or the demand d
                              2n
                              
                              =3
                                 n
                              
                              B. This value can clearly be encoded in space 
                                 
                                    O
                                    (
                                    n
                                    +
                                    log
                                    (
                                    Max
                                    (
                                    I
                                    )
                                    )
                                    )
                                 
                               and thus the size of f(I) is polynomially bounded by the size of I.


                              The transformation f is a reduction. To prove that f is a reduction, we introduce 2 particular types of plannings, namely the 1-plannings and the extended 1-plannings. We say that a planning is a 1-planning if it orders exactly one batch in each pair i, either at period 2i
                              −1 or at period 2i, and does not order at the last period. An extended 1-planning is simply a 1-planning plus eventually an additional batch ordered at the last period T. In the following, we establish that:
                                 
                                    
                                       a.
                                    
                                    There is a natural one-to-one mapping between subsets of objects of I and 1-plannings of f(I), such that, if a subset S of objects and a 1-planning π are in correspondence, we have the following relations between the feasibility of these solutions and their costs:
                                          
                                             (1)
                                             
                                                S
                                                
                                                has
                                                
                                                a
                                                
                                                utility
                                                ⩾
                                                U
                                                ⇔
                                                π
                                                
                                                satisfies
                                                
                                                all
                                                
                                                the
                                                
                                                demands
                                             
                                          
                                       
                                       
                                          
                                             (2)
                                             
                                                S
                                                
                                                has
                                                
                                                a
                                                
                                                weight
                                                ⩽
                                                W
                                                ⇔
                                                π
                                                
                                                has
                                                
                                                a
                                                
                                                cost
                                                
                                                ⩽
                                                Z
                                             
                                          
                                       
                                    

Extended 1-plannings are dominant for the instance f(I).

Based on these 2 results, the proof that f is a reduction is quite straightforward. Assume that I is a positive instance. It implies that there exists a subset S of utility at least U and of weight at most W. Due to Equivalences (1) and (2), its associated 1-planning π is feasible and costs at most Z, showing that f(I) is a positive instance.

Conversely, assume that f(I) is a positive instance: There exists a feasible planning π of cost at most Z. Due to the dominance of extended 1-plannings, we can choose π to be an extended 1-planning. Now observe that an extended 1-planning ordering at the last period costs at least (n
                              +1)k
                              >
                              Z. It follows that an extended 1-planning of cost at most Z is in fact a 1-planning. Since π is a feasible 1-planning of cost at most Z, Equivalences (1) and (2) imply that its associated subset S of objects has a weight at most W and a utility at least U, showing that I is a positive instance.

The remaining of the proof of Theorem 5 is thus devoted to prove (a) and (b): the correspondence between subsets S and 1-plannings, and the dominance of extended 1-plannings.


                              Correspondence with 1-plannings. Recall that a 1-planning is a planning ordering exactly one batch in each pair i, either at period 2i
                              −1 or at period 2i, and ordering no batch at the last period. We exhibit now a natural one-to-one correspondence between 1-plannings for f(I) and subset S of objects for I:
                                 
                                    •
                                    To any 1-planning π, we associate the subset S
                                       
                                          π
                                        defined as the objects i such that π orders a batch in the even period of the pair i. That is S
                                       
                                          π
                                       
                                       ={i∣π ordersinperiod 2i}

To any subset S, we associate the planning π
                                       
                                          S
                                        where for each pair i, a batch is ordered in the even period (2i) if the object i belongs to S, and in the odd period (2i
                                       −1) if i
                                       ∉
                                       S and i
                                       <
                                       T. By construction, exactly one batch is produced in any couple (2i
                                       −1, 2i) of periods, and thus π
                                       
                                          S
                                        is a 1-planning.

These transformations clearly define a mapping between subsets of objects and 1-plannings. That is, for any subset S and 1-planning π, we have π
                              =
                              π
                              
                                 S
                               if and only if S
                              =
                              S
                              
                                 π
                              . Consider a subset S and a planning π in correspondence (that is π
                              =
                              π
                              
                                 S
                               and S
                              =
                              S
                              
                                 π
                              ). We want to establish Equivalences (1) and (2) between S and π.

To prove the first equivalence, observe that any 1-planning satisfies all the demands, except possibly in the last period. Thus, the planning π is feasible if and only if the last demand can be satisfied, which is equivalent to have a stock level s
                              2n
                               at the end of period 2n that covers d
                              
                                 T
                              
                              =
                              U. By definition s
                              2n
                               is equal to the total capacity of the batches produced minus the total demand on [1, 2n], that is:
                                 
                                    
                                       
                                          
                                             s
                                          
                                          
                                             2
                                             n
                                          
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         i
                                                         ∈
                                                         S
                                                      
                                                   
                                                
                                                (
                                                
                                                   
                                                      3
                                                   
                                                   
                                                      i
                                                   
                                                
                                                B
                                                +
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      i
                                                   
                                                
                                                )
                                                +
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         i
                                                         ∉
                                                         S
                                                         ,
                                                         i
                                                         ⩽
                                                         n
                                                      
                                                   
                                                
                                                
                                                   
                                                      3
                                                   
                                                   
                                                      i
                                                   
                                                
                                                B
                                             
                                          
                                       
                                       -
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                =
                                                1
                                             
                                             
                                                2
                                                n
                                             
                                          
                                       
                                       
                                          
                                             d
                                          
                                          
                                             i
                                          
                                       
                                       =
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                ∈
                                                S
                                             
                                          
                                       
                                       
                                          
                                             u
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                              Hence π satisfies all the demands if and only if 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          ∈
                                          S
                                       
                                    
                                    
                                       
                                          u
                                       
                                       
                                          i
                                       
                                    
                                    ⩾
                                    U
                                 
                              . To prove the second equivalence, we simply write that the cost of the planning π
                              
                                 S
                               is equal to:
                                 
                                    
                                       z
                                       (
                                       
                                          
                                             π
                                          
                                          
                                             S
                                          
                                       
                                       )
                                       =
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                ∉
                                                S
                                                ,
                                                i
                                                ⩽
                                                n
                                             
                                          
                                       
                                       k
                                       +
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                ∈
                                                S
                                             
                                          
                                       
                                       (
                                       
                                          
                                             w
                                          
                                          
                                             i
                                          
                                       
                                       +
                                       k
                                       )
                                       =
                                       nk
                                       +
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                ∈
                                                S
                                             
                                          
                                       
                                       
                                          
                                             w
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                              Hence π is of cost at most Z
                              =
                              nk
                              +
                              W if and only if 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          ∈
                                          S
                                       
                                    
                                    
                                       
                                          w
                                       
                                       
                                          i
                                       
                                    
                                    ⩽
                                    W
                                 
                              , which establishes Equivalence (2).


                              Dominance of extended 1-plannings. Recall that an extended 1-planning is a 1-planning plus eventually an additional batch ordered at the last period T. We establish here that these plannings are dominant for the instance f(I). Notice that any extended 1-planning ordering at the last period is feasible. To prove the dominance of extended 1-plannings, consider an optimal planning π
                              ∗. Let us denote by 
                                 
                                    
                                       
                                          a
                                       
                                       
                                          i
                                       
                                       
                                          ∗
                                       
                                    
                                 
                               the number of batches ordered in the pair i, i
                              =1, …, n, with 
                                 
                                    
                                       
                                          a
                                       
                                       
                                          n
                                          +
                                          1
                                       
                                       
                                          ∗
                                       
                                    
                                 
                               being by extension the number of batches ordered in the last period. For the sake of contradiction assume that no optimal planning is an extended 1-planning. Since backlogging is not allowed, any policy does not need to order more than U units, the demand of the last period, at the last period. The size of a batch in the last period being precisely U, an optimal planning clearly orders at most one batch in period T, that is, 
                                 
                                    
                                       
                                          a
                                       
                                       
                                          n
                                          +
                                          1
                                       
                                       
                                          ∗
                                       
                                    
                                    ⩽
                                    1
                                 
                              . It implies that for some indices i
                              ⩽
                              n, we have 
                                 
                                    
                                       
                                          a
                                       
                                       
                                          i
                                       
                                       
                                          ∗
                                       
                                    
                                    
                                    ≠
                                    
                                    1
                                 
                              , otherwise by definition π
                              ∗ would be an extended 1-planning. Let m be the first index such that 
                                 
                                    
                                       
                                          a
                                       
                                       
                                          m
                                       
                                       
                                          ∗
                                       
                                    
                                    
                                    ≠
                                    
                                    1
                                 
                              . Among all the optimal plannings, we assume that we have chosen π
                              ∗ such that the index m is maximal. We distinguish 3 cases according to the number of batches ordered in the pair m:
                                 
                                    1.
                                    
                                       
                                          
                                             
                                                
                                                   a
                                                
                                                
                                                   m
                                                
                                                
                                                   ∗
                                                
                                             
                                             =
                                             0
                                          
                                       . By construction exactly one batch is ordered in the pairs 1 to m
                                       −1. It is easy to see that the stock level at the beginning of the period (2m
                                       −1) is at most u
                                       1
                                       +⋯+
                                       u
                                       
                                          m−1
                                       <
                                       B. As a consequence, the demand of the period 2m can not be satisfied, which contradicts that π
                                       ∗ is a feasible solution.


                                       
                                          
                                             
                                                
                                                   a
                                                
                                                
                                                   m
                                                
                                                
                                                   ∗
                                                
                                             
                                             ⩾
                                             3
                                          
                                       . Consider the planning π identical to π
                                       ∗ except that 2 batches are suppressed in the pair m and replaced by one additional batch ordered in period (2m
                                       +1), that is in the odd period of the pair m
                                       +1 (or the last period T if m
                                       =
                                       n). We claim that π is feasible: Since at least one batch is still ordered in m, the demands of periods 1, …, m can clearly be satisfied. For the following periods, the two batches suppressed in the pair m represent at most 2(3
                                          m
                                       
                                       B
                                       +
                                       u
                                       
                                          m
                                       ) units, which is less than the additional batch of size 3
                                          m+1
                                       B added in period 2m
                                       +1 if m
                                       <
                                       n. In case where m is the last pair, the batch added in period T is only of size U, but this is clearly sufficient to serve the demand d
                                       
                                          T
                                       . If we compute the cost of this feasible planning, noticing that the setup is null in period (2m
                                       +1), we obtain that z(π)⩽
                                       z(π
                                       ∗)−
                                       k, which contradicts that π
                                       ∗ is optimal.


                                       
                                          
                                             
                                                
                                                   a
                                                
                                                
                                                   m
                                                
                                                
                                                   ∗
                                                
                                             
                                             =
                                             2
                                          
                                       . Consider the planning π identical to π
                                       ∗ except that 1 batch is suppressed in the pair m and replaced by one additional batch ordered in period (2m
                                       +1). As in the previous case the planning π is feasible, and costs at most the cost of π
                                       ∗ since we have a null setup cost in period (2m
                                       +1). It follows that π is also optimal, and orders exactly one batch in periods 1 to m included. This contradicts our choice of π
                                       ∗ such that its index m is maximal.

In any case we obtain a contradiction. It results that extended 1-plannings are dominant for the instance f(I).□

We show in this section that the problem UBLS with a stationary fixed cost per batch k and no unit procurement nor holding cost ((f
                        
                           t
                        /k/−/−), see Theorem 5) can be solved in pseudo-polynomial time more efficiently than with the general dynamic algorithm of Section 3. However, the main purpose of this section is to exhibit some simple dominance properties which will be useful to derive polynomial time algorithms for special cases, namely the divisible batch sizes case and the stationary setup cost case.

We restrict our attention to policies ordering only full batches, see Remark 2. Without loss of generality we can also assume that there is no null batch size due to Remark 1. Notice that if the setup costs are stationary, we can also consider without loss of generality that the batch sizes are increasing over the periods, that is u
                        <
                        v
                        ⇒
                        B
                        
                           u
                        
                        <
                        B
                        
                           v
                        . Indeed if B
                        
                           u
                         happens to be greater than B
                        
                           v
                        , there exists an optimal solution that does not order in period v. Thus, again we can discard the period v and shift its demand to the previous period. The next proposition states that it is still true for time-dependent setup costs, in the sense that it is dominant for the batch sizes of the ordering periods of a policy to be increasing. In addition, it is also dominant that the stock level at the beginning of an ordering period be lower than the batch size of the preceding ordering period.
                           Property 1
                           
                              For problem UBLS (f
                              
                                 t
                              
                              /k/−/−), there exists an optimal policy such that, for any two consecutive ordering periods u and v, with u
                              <
                              v, the inequalities s
                              
                                 v−1
                              
                              <
                              B
                              
                                 u
                              
                              <
                              B
                              
                                 v
                               
                              hold.
                           

The proof is immediate by an interchange argument. Consider any optimal policy π and let u and v be two consecutive ordering periods. Let m
                              
                                 t
                               be the number of batches ordered in period t by π. Consider first that B
                              
                                 u
                              
                              ⩾
                              B
                              
                                 v
                              . We can modify π by ordering (m
                              
                                 u
                              
                              +
                              m
                              
                                 v
                              ) batches in period u and nothing in period v. The resulting planning is clearly still feasible and optimal. Repeating this transformation we obtain an optimal policy where the batch sizes of the ordering periods are increasing. Now consider that in this optimal policy we have s
                              
                                 v−1
                              ⩾
                              B
                              
                                 u
                              . Write s
                              
                                 v−1 as a B
                              
                                 u
                              
                              +
                              b with b
                              <
                              B
                              
                                 u
                              . We can again modify the policy by canceling a batches in period u and ordering a additional batches in period v. Since the batch sizes are increasing, the resulting policy is still feasible and also optimal. Repeating this transformation leads to an optimal planning verifying the inequalities of Property 1.□


                        Property 1 implies that it is dominant to order at a period the minimum number of batches needed to satisfy the demands till the next ordering period. More precisely consider an optimal policy π, and u and v two consecutive ordering periods. We denote by D
                        
                           u, v−1
                        ≡
                        d
                        
                           u
                        
                        +⋯+
                        d
                        
                           v−1 the sum of the demands between the period u and the period v, v excluded. We introduce b
                        
                           uv
                         as the rest in the Euclidean division of this demand by the batch size B
                        
                           u
                        , that is:
                           
                              (3)
                              
                                 
                                    
                                       b
                                    
                                    
                                       uv
                                    
                                 
                                 =
                                 
                                    
                                       D
                                    
                                    
                                       u
                                       ,
                                       v
                                       -
                                       1
                                    
                                 
                                 mod
                                 
                                    
                                       B
                                    
                                    
                                       u
                                    
                                 
                              
                           
                        
                     

Let s
                        
                           u−1 be the stock level at the beginning of period u. Since it is dominant to have a stock level at the beginning of period v lower than B
                        
                           u
                        , it results that it is dominant to order in period u a number of batches equal to ⌈ (D
                        
                           u, v−1
                        −
                        s
                        
                           u−1)/B
                        
                           u
                        ⌉. Moreover, Property 1 also implies that s
                        
                           u−1
                        <
                        B
                        
                           u
                        . It results that the number m
                        
                           uv
                         ordered in a dominant planning, depending on the stock level s at the beginning of period u, is equal to:
                           
                              (4)
                              
                                 
                                    
                                       m
                                    
                                    
                                       uv
                                    
                                 
                                 (
                                 s
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ⌊
                                                   
                                                      
                                                         D
                                                      
                                                      
                                                         u
                                                         ,
                                                         v
                                                         -
                                                         1
                                                      
                                                   
                                                   /
                                                   
                                                      
                                                         B
                                                      
                                                      
                                                         u
                                                      
                                                   
                                                   ⌋
                                                   +
                                                   1
                                                
                                                
                                                   if
                                                   
                                                   s
                                                   <
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         uv
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   ⌊
                                                   
                                                      
                                                         D
                                                      
                                                      
                                                         u
                                                         ,
                                                         v
                                                         -
                                                         1
                                                      
                                                   
                                                   /
                                                   
                                                      
                                                         B
                                                      
                                                      
                                                         u
                                                      
                                                   
                                                   ⌋
                                                
                                                
                                                   if
                                                   
                                                   s
                                                   ⩾
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         uv
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

We simply use the notation m
                        
                           uv
                         in the following if the stock level s
                        
                           u−1 is clear from the context. Notice that m
                        
                           uv
                         corresponds to the minimal number of full batches needed to satisfy the demands till the beginning of period v. In a dominant planning we also have a simple relation between the entering stock level of two consecutive ordering periods u and v. Indeed using the fact that s
                        
                           v−1
                        ∈{0, 1, …, B
                        
                           u
                        
                        −1} due to Property 1, we can write modulo B
                        
                           u
                         the flow conservation equation s
                        
                           v−1
                        =
                        s
                        
                           u−1
                        +
                        m
                        
                           uv
                        
                        B
                        
                           u
                        
                        −
                        D
                        
                           u, v−1 to obtain:
                           
                              (5)
                              
                                 
                                    
                                       s
                                    
                                    
                                       v
                                       -
                                       1
                                    
                                 
                                 =
                                 (
                                 
                                    
                                       s
                                    
                                    
                                       u
                                       -
                                       1
                                    
                                 
                                 -
                                 
                                    
                                       b
                                    
                                    
                                       uv
                                    
                                 
                                 )
                                 mod
                                 
                                 
                                    
                                       B
                                    
                                    
                                       u
                                    
                                 
                              
                           
                        For short we denote by σ
                        
                           uv
                         the function that associates to a value s the quantity 
                           
                              
                                 
                                    σ
                                 
                                 
                                    uv
                                 
                              
                              (
                              s
                              )
                              =
                              (
                              s
                              -
                              
                                 
                                    b
                                 
                                 
                                    uv
                                 
                              
                              )
                              mod
                              
                                 
                                    B
                                 
                                 
                                    u
                                 
                              
                           
                        . A representation of σ
                        
                           uv
                         is given in Fig. 3
                        . Notice that this function in not monotone with s.

We summarize our results and notations in Property 2 below, which is a corollary of Property 1:
                           Property 2
                           
                              For problem UBLS (f
                              
                                 t
                              
                              /k/−/−), there exists an optimal policy such that the number m
                              
                                 t
                               
                              of batches ordered at period t and the stock level s
                              
                                 t
                               
                              at the end of period t verify, for any two consecutive ordering periods u and v:
                              
                                 
                                    
                                       
                                          
                                             s
                                          
                                          
                                             v
                                             -
                                             1
                                          
                                       
                                       =
                                       
                                          
                                             σ
                                          
                                          
                                             uv
                                          
                                       
                                       (
                                       
                                          
                                             s
                                          
                                          
                                             u
                                             -
                                             1
                                          
                                       
                                       )
                                       
                                       and
                                       
                                       
                                          
                                             m
                                          
                                          
                                             u
                                          
                                       
                                       =
                                       
                                          
                                             m
                                          
                                          
                                             uv
                                          
                                       
                                       (
                                       
                                          
                                             s
                                          
                                          
                                             u
                                             -
                                             1
                                          
                                       
                                       )
                                    
                                 
                              
                           


                        Property 2 means that, given a set of ordering periods, an optimal policy orders each time the minimal number of (full) batches to avoid a backlog. It also implies that if one can guess the ordering periods of an optimal policy, the quantities to order can be determined in linear time. Based on these dominance properties, it is easy to derive a dynamic programming algorithm. Let OPT(u, s) be the minimal cost to satisfy all the demands over [u, T] given an entering stock level of s at period u, and assuming that u is an ordering period. By convention we set OPT(T
                        +1, s)=0 for any stock level s. From what precedes, we have:
                           
                              (6)
                              
                                 OPT
                                 (
                                 u
                                 ,
                                 s
                                 )
                                 =
                                 
                                    
                                       f
                                    
                                    
                                       u
                                    
                                 
                                 +
                                 
                                    
                                       
                                          min
                                       
                                       
                                          v
                                          >
                                          u
                                       
                                    
                                 
                                 {
                                 
                                    
                                       m
                                    
                                    
                                       uv
                                    
                                 
                                 (
                                 s
                                 )
                                 k
                                 +
                                 OPT
                                 (
                                 v
                                 ,
                                 
                                    
                                       σ
                                    
                                    
                                       uv
                                    
                                 
                                 (
                                 s
                                 )
                                 )
                                 }
                              
                           
                        The optimal cost is given by min
                           u
                        {OPT(u,0) ∣ d
                        1
                        +⋯+
                        d
                        
                           u−1
                        =0}. We now analyze the time complexity of this dynamic programming approach. Consider a period u and a stock level s. Observe that all the D
                        
                           uv
                         values for u
                        ⩽
                        v
                        ⩽
                        T can be computed in linear time by accumulation, and thus all the quantities m
                        
                           uv
                        (s) and b
                        
                           uv
                         can also be determined in time O(T). It results from Eq. (6) that each value OPT(u, s) can be determined in time O(T), that is each state can be evaluated in linear time. Due to Property 1, it is sufficient for each period u to consider the values of s in the set {0, …, B
                        
                           u
                        
                        −1}. Thus the number of states in the formulation is equal to 
                           
                              
                                 
                                    ∑
                                 
                                 
                                    t
                                 
                              
                              
                                 
                                    B
                                 
                                 
                                    t
                                 
                              
                           
                        . We have the following result:
                           Theorem 6
                           
                              Problem UBLS (f
                              
                                 t
                              
                              /k/−/−) with stationary fixed cost per batch and null unit procurement and holding costs can be solved in pseudo-polynomial time 
                              
                                 
                                    O
                                    (
                                    T
                                    
                                       
                                          ∑
                                       
                                       
                                          t
                                       
                                    
                                    
                                       
                                          B
                                       
                                       
                                          t
                                       
                                    
                                    )
                                 
                              
                              .
                           

Hence if the largest batch size B
                        max appearing in the instance is reasonably small, we have an efficient algorithm running in time O(T
                        2
                        B
                        max). We show in the next section how this pseudo-polynomial time algorithm can be transformed into a polynomial one in the case of divisible batch sizes.

We consider in this section the special case of divisible batch sizes: For any periods u and v, either B
                        
                           u
                        ∣B
                        
                           v
                         or B
                        
                           v
                        ∣B
                        
                           u
                         holds. To derive a polynomial time algorithm from the dynamic programming of the previous section, the basic idea is to reduce the number of states to consider in the recursive Eq. (6). That is, we want to show that among the B
                        
                           u
                         possible stock levels at the beginning of a period u, only a small subset (of cardinality polynomially bounded in T) is of interest for the optimal policy. Observe that Eq. (4) implies that, to decide how many batches to order in a period u, given that v is the next ordering period, we do not need to know the precise value of the stock level s
                        
                           u−1 but only if s
                        
                           u−1 is lower than b
                        
                           uv
                         or not. Going along this line, for a given period u, consider all the different values b
                        
                           uv
                         for v
                        >
                        u. These values partition the set [0, B
                        
                           u
                        
                        −1] into at most T intervals. More precisely, assuming that the b
                        
                           uv
                        ’s take l distinct positive values, let 
                           
                              0
                              <
                              
                                 
                                    α
                                 
                                 
                                    1
                                 
                                 
                                    u
                                 
                              
                              <
                              ⋯
                              <
                              
                                 
                                    α
                                 
                                 
                                    l
                                 
                                 
                                    u
                                 
                              
                              <
                              
                                 
                                    B
                                 
                                 
                                    u
                                 
                              
                           
                         be these values indexed in increasing order. For convenience we introduce 
                           
                              
                                 
                                    α
                                 
                                 
                                    0
                                 
                                 
                                    u
                                 
                              
                              =
                              0
                           
                         and 
                           
                              
                                 
                                    α
                                 
                                 
                                    l
                                    +
                                    1
                                 
                                 
                                    u
                                 
                              
                              =
                              
                                 
                                    B
                                 
                                 
                                    u
                                 
                              
                           
                        . We call for short the interval 
                           
                              
                                 
                                    
                                       
                                          
                                             α
                                          
                                          
                                             i
                                          
                                          
                                             u
                                          
                                       
                                       ,
                                       
                                          
                                             α
                                          
                                          
                                             i
                                             +
                                             1
                                          
                                          
                                             u
                                          
                                       
                                    
                                 
                              
                           
                         the ith α
                        
                           u
                        -interval.

Notice that Eq. (4) implies that the number of batches ordered in a dominant planning is the same for any stock level of a given α
                        
                           u
                        -interval. Indeed, the number m
                        
                           uv
                         of batches only depends on the relative position of s
                        
                           u−1 and b
                        
                           uv
                        . If s
                        
                           u−1 belongs to the interval 
                           
                              
                                 
                                    
                                       
                                          
                                             α
                                          
                                          
                                             i
                                          
                                          
                                             u
                                          
                                       
                                       ,
                                       
                                          
                                             α
                                          
                                          
                                             i
                                             +
                                             1
                                          
                                          
                                             u
                                          
                                       
                                    
                                 
                              
                           
                        , clearly we have the equivalence s
                        
                           u−1
                        ⩾
                        b
                        
                           uv
                         if and only if 
                           
                              
                                 
                                    α
                                 
                                 
                                    i
                                 
                                 
                                    u
                                 
                              
                              ⩾
                              
                                 
                                    b
                                 
                                 
                                    uv
                                 
                              
                           
                        . Since all the stock levels in an α
                        
                           u
                        -interval lead to the same optimal ordering decision, we can represent the B
                        
                           u
                         states (u, s) of the dynamic programming in a compact way, namely {(u, 0), (u, 1), …, (u, l
                        +1)}, where the new state (u, i) means that the entering stock level at period u belongs to the ith α
                        
                           u
                        -interval. This compact description reduces the number of states from 
                           
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    B
                                 
                                 
                                    i
                                 
                              
                           
                         to at most T
                        2.

The matter is that in general we can not deduce from the fact that 
                           
                              
                                 
                                    s
                                 
                                 
                                    u
                                    -
                                    1
                                 
                              
                              ∈
                              
                                 
                                    
                                       
                                          
                                             α
                                          
                                          
                                             i
                                          
                                          
                                             u
                                          
                                       
                                       ,
                                       
                                          
                                             α
                                          
                                          
                                             i
                                             +
                                             1
                                          
                                          
                                             u
                                          
                                       
                                    
                                 
                              
                           
                         in which interval 
                           
                              
                                 
                                    
                                       
                                          
                                             α
                                          
                                          
                                             j
                                          
                                          
                                             v
                                          
                                       
                                       ,
                                       
                                          
                                             α
                                          
                                          
                                             j
                                             +
                                             1
                                          
                                          
                                             v
                                          
                                       
                                    
                                 
                              
                           
                         the next entering stock level s
                        
                           v−1
                        =
                        σ
                        
                           uv
                        (s
                        
                           u−1) belongs. In fact, the next entering stock level s
                        
                           v−1 does depend on the current stock level s
                        
                           u−1 and not only on its α
                        
                           u
                        -interval. That is, contrary to the number of batches to order, depending on the actual value of s
                        
                           u−1 inside its α
                        
                           u
                        -interval, the resulting stock level σ
                        
                           uv
                        (s
                        
                           u−1) may belong to different α
                        
                           v
                        -intervals. To illustrate this fact, consider the case where s
                        
                           u−1
                        ⩾
                        b
                        
                           uv
                        . The entering stock level at period v is σ
                        
                           uv
                        (s
                        
                           u−1)=
                        s
                        
                           u−1
                        −
                        b
                        
                           uv
                        . It results that for a given period w
                        >
                        v, we have σ
                        
                           uv
                        (s
                        
                           u−1)⩾
                        b
                        
                           vw
                         if and only if s
                        
                           uv
                        
                        ⩾
                        b
                        
                           uv
                        
                        +
                        b
                        
                           vw
                        . Though this latter condition is simple, in general the quantity b
                        
                           uv
                        
                        +
                        b
                        
                           vw
                         does not correspond to any of the values 
                           
                              
                                 
                                    α
                                 
                                 
                                    i
                                 
                                 
                                    v
                                 
                              
                           
                        , and thus we have no clue to determine the position of σ
                        
                           uv
                        (s
                        
                           u−1) relatively to the 
                           
                              
                                 
                                    α
                                 
                                 
                                    i
                                 
                                 
                                    v
                                 
                              
                           
                        ’s. The rest of this section is devoted to show that in the case of divisible batch sizes, all the entering stock levels s
                        
                           u−1 in the same α
                        
                           u
                        -interval lead to stock levels s
                        
                           v−1 all in the same α
                        
                           v
                        -interval (see Fig. 4
                         and Property 3 below), and that the index of this interval can be computed quite efficiently (see the end of this section). Observe that to determine in which α
                        
                           v
                        -interval belongs s
                        
                           v−1, it is by definition sufficient to be able to decide for any period w
                        >
                        v if s
                        
                           v−1
                        ⩾
                        b
                        
                           vw
                        . This is precisely the purpose of Property 3:
                           Property 3
                           
                              If the batch sizes are divisible, for any periods u
                              <
                              v
                              <
                              w, we have in a dominant planning:
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             For any stock level s
                                                ⩾
                                                b
                                                
                                                   uv
                                                , σ
                                                
                                                   uv
                                                (s)⩾
                                                b
                                                
                                                   vw
                                                 if and only if
                                          
                                       
                                       
                                          
                                             
                                             (s
                                                ⩾
                                                b
                                                
                                                   uw
                                                ) and (b
                                                
                                                   uv
                                                
                                                +
                                                b
                                                
                                                   vw
                                                
                                                <
                                                B
                                                
                                                   u
                                                )
                                          
                                          
                                             For any stock level s
                                                <
                                                b
                                                
                                                   uv
                                                , σ
                                                
                                                   uv
                                                (s)⩾
                                                b
                                                
                                                   vw
                                                 if and only if
                                          
                                          
                                             
                                             (s
                                                ⩾
                                                b
                                                
                                                   uw
                                                ) and (b
                                                
                                                   uv
                                                
                                                +
                                                b
                                                
                                                   vw
                                                
                                                <2B
                                                
                                                   u
                                                ) or (b
                                                
                                                   uv
                                                
                                                +
                                                b
                                                
                                                   vw
                                                
                                                <
                                                B
                                                
                                                   u
                                                )
                                          
                                       
                                    
                                 
                              
                           

We first establish that for any periods u
                              <
                              v
                              <
                              w, we have:
                                 
                                    (7)
                                    
                                       
                                          
                                             B
                                          
                                          
                                             u
                                          
                                       
                                       |
                                       
                                          
                                             B
                                          
                                          
                                             v
                                          
                                       
                                       ⇒
                                       (
                                       
                                          
                                             b
                                          
                                          
                                             uv
                                          
                                       
                                       +
                                       
                                          
                                             b
                                          
                                          
                                             vw
                                          
                                       
                                       )
                                       mod
                                       
                                          
                                             B
                                          
                                          
                                             u
                                          
                                       
                                       =
                                       
                                          
                                             b
                                          
                                          
                                             uw
                                          
                                       
                                    
                                 
                              Assume that B
                              
                                 u
                              ∣B
                              
                                 v
                              . We use the definition of the b
                              
                                 vw
                               given by Eq. (3) to write that 
                                 
                                    
                                       
                                          b
                                       
                                       
                                          vw
                                       
                                    
                                    mod
                                    
                                       
                                          B
                                       
                                       
                                          u
                                       
                                    
                                    =
                                    (
                                    
                                       
                                          D
                                       
                                       
                                          v
                                          ,
                                          w
                                          -
                                          1
                                       
                                    
                                    mod
                                    
                                       
                                          B
                                       
                                       
                                          v
                                       
                                    
                                    )
                                    mod
                                    
                                       
                                          B
                                       
                                       
                                          u
                                       
                                    
                                    =
                                    
                                       
                                          D
                                       
                                       
                                          v
                                          ,
                                          w
                                          -
                                          1
                                       
                                    
                                    mod
                                    
                                       
                                          B
                                       
                                       
                                          u
                                       
                                    
                                 
                              . Notice that b
                              
                                 vw
                               is the rest in the Euclidean division by B
                              
                                 v
                              , and not B
                              
                                 u
                              , and thus the divisibility of B
                              
                                 v
                               by B
                              
                                 u
                               is required for the previous equation. Now writing also the definition of b
                              
                                 uv
                               we get: 
                                 
                                    (
                                    
                                       
                                          b
                                       
                                       
                                          uv
                                       
                                    
                                    +
                                    
                                       
                                          b
                                       
                                       
                                          vw
                                       
                                    
                                    )
                                    mod
                                    
                                       
                                          B
                                       
                                       
                                          u
                                       
                                    
                                    =
                                    (
                                    
                                       
                                          D
                                       
                                       
                                          u
                                          ,
                                          v
                                          -
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          D
                                       
                                       
                                          v
                                          ,
                                          w
                                          -
                                          1
                                       
                                    
                                    )
                                    mod
                                    
                                       
                                          B
                                       
                                       
                                          u
                                       
                                    
                                    =
                                    
                                       
                                          D
                                       
                                       
                                          u
                                          ,
                                          w
                                          -
                                          1
                                       
                                    
                                    mod
                                    
                                       
                                          B
                                       
                                       
                                          u
                                       
                                    
                                 
                              , which is equal by definition to b
                              
                                 uw
                              .

Based on this result, we now prove Property 3. Observe that, due to Property 1, the fact that u and v are two consecutive ordering periods implies that B
                              
                                 u
                              
                              <
                              B
                              
                                 v
                              , and thus we necessarily have B
                              
                                 u
                              ∣B
                              
                                 v
                               when considering a divisible batch size instance.

First, assume that s
                              ⩾
                              b
                              
                                 uv
                              , and thus σ
                              
                                 uv
                              (s)=
                              s
                              −
                              b
                              
                                 uv
                              , see Eq. (5). We have σ
                              
                                 uv
                              (s)⩾
                              b
                              
                                 vw
                               if and only if:
                                 
                                    
                                       
                                          
                                             
                                             
                                                
                                                   s
                                                   ⩾
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         uv
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         vw
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ⇔
                                                   
                                                
                                             
                                             
                                                
                                                   (
                                                   s
                                                   ⩾
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         uv
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         vw
                                                      
                                                   
                                                   
                                                   and
                                                   
                                                   
                                                      
                                                         B
                                                      
                                                      
                                                         u
                                                      
                                                   
                                                   >
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         uv
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         vw
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                          
                                             
                                             
                                                
                                                   or
                                                   
                                                   (
                                                   s
                                                   ⩾
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         uv
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         vw
                                                      
                                                   
                                                   
                                                   and
                                                   
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         uv
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         vw
                                                      
                                                   
                                                   ⩾
                                                   
                                                      
                                                         B
                                                      
                                                      
                                                         u
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ⇔
                                                   
                                                
                                             
                                             
                                                
                                                   (
                                                   s
                                                   ⩾
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         uv
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         vw
                                                      
                                                   
                                                   
                                                   and
                                                   
                                                   
                                                      
                                                         B
                                                      
                                                      
                                                         u
                                                      
                                                   
                                                   >
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         uv
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         vw
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ⇔
                                                   
                                                
                                             
                                             
                                                
                                                   s
                                                   ⩾
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         uw
                                                      
                                                   
                                                   
                                                   and
                                                   
                                                   
                                                      
                                                         B
                                                      
                                                      
                                                         u
                                                      
                                                   
                                                   >
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         uv
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         vw
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              The equivalence between the first and the second lines is simply due to the tautology (b
                              
                                 uv
                              
                              +
                              b
                              
                                 vw
                              
                              <
                              B
                              
                                 u
                              ) or (b
                              
                                 uv
                              
                              +
                              b
                              
                                 vw
                              
                              ⩾
                              B
                              
                                 u
                              ). The equivalence between the second and the third lines comes from the fact that s
                              <
                              B
                              
                                 u
                               in a dominant policy due to Property 1, which implies that the second clause is always false. Finally, the equivalence between the last two lines is due to Eq. (7), since B
                              
                                 u
                              
                              >
                              b
                              
                                 uv
                              
                              +
                              b
                              
                                 vw
                               is equivalent to 
                                 
                                    
                                       
                                          b
                                       
                                       
                                          uv
                                       
                                    
                                    +
                                    
                                       
                                          b
                                       
                                       
                                          vw
                                       
                                    
                                    =
                                    (
                                    
                                       
                                          b
                                       
                                       
                                          uv
                                       
                                    
                                    +
                                    
                                       
                                          b
                                       
                                       
                                          vw
                                       
                                    
                                    )
                                    mod
                                    
                                       
                                          B
                                       
                                       
                                          u
                                       
                                    
                                 
                               for integers.

Second, consider that s
                              <
                              b
                              
                                 uv
                              , and thus σ
                              
                                 uv
                              (s)=
                              s
                              −
                              b
                              
                                 uv
                              
                              +
                              B
                              
                                 u
                              . In a similar way we have σ
                              
                                 uv
                              (s)⩾
                              b
                              
                                 vw
                               if and only if:
                                 
                                    
                                       
                                          
                                             
                                             
                                                
                                                   s
                                                   +
                                                   
                                                      
                                                         B
                                                      
                                                      
                                                         u
                                                      
                                                   
                                                   ⩾
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         uv
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         vw
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ⇔
                                                   
                                                
                                             
                                             
                                                
                                                   (
                                                   s
                                                   +
                                                   
                                                      
                                                         B
                                                      
                                                      
                                                         u
                                                      
                                                   
                                                   ⩾
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         uv
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         vw
                                                      
                                                   
                                                   
                                                   and
                                                   
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         uv
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         vw
                                                      
                                                   
                                                   <
                                                   
                                                      
                                                         B
                                                      
                                                      
                                                         u
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                          
                                             
                                             
                                                
                                                   or
                                                   
                                                   (
                                                   s
                                                   +
                                                   
                                                      
                                                         B
                                                      
                                                      
                                                         u
                                                      
                                                   
                                                   ⩾
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         uv
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         vw
                                                      
                                                   
                                                   
                                                   and
                                                   
                                                   
                                                      
                                                         B
                                                      
                                                      
                                                         u
                                                      
                                                   
                                                   ⩽
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         uv
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         vw
                                                      
                                                   
                                                   <
                                                   2
                                                   
                                                      
                                                         B
                                                      
                                                      
                                                         u
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                          
                                             
                                             
                                                
                                                   or
                                                   
                                                   (
                                                   s
                                                   +
                                                   
                                                      
                                                         B
                                                      
                                                      
                                                         u
                                                      
                                                   
                                                   ⩾
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         uv
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         vw
                                                      
                                                   
                                                   
                                                   and
                                                   
                                                   2
                                                   
                                                      
                                                         B
                                                      
                                                      
                                                         u
                                                      
                                                   
                                                   ⩽
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         uv
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         vw
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ⇔
                                                   
                                                
                                             
                                             
                                                
                                                   (
                                                   s
                                                   +
                                                   
                                                      
                                                         B
                                                      
                                                      
                                                         u
                                                      
                                                   
                                                   ⩾
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         uv
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         vw
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                          
                                             
                                             
                                                
                                                   or
                                                   
                                                   (
                                                   s
                                                   +
                                                   
                                                      
                                                         B
                                                      
                                                      
                                                         u
                                                      
                                                   
                                                   ⩾
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         uv
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         vw
                                                      
                                                   
                                                   
                                                   and
                                                   
                                                   
                                                      
                                                         B
                                                      
                                                      
                                                         u
                                                      
                                                   
                                                   ⩽
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         uv
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         vw
                                                      
                                                   
                                                   <
                                                   2
                                                   
                                                      
                                                         B
                                                      
                                                      
                                                         u
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ⇔
                                                   
                                                
                                             
                                             
                                                
                                                   (
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         uv
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         vw
                                                      
                                                   
                                                   ⩽
                                                   
                                                      
                                                         B
                                                      
                                                      
                                                         u
                                                      
                                                   
                                                   )
                                                   
                                                   or
                                                   
                                                   (
                                                   s
                                                   ⩾
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         uw
                                                      
                                                   
                                                   
                                                   and
                                                   
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         uv
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         vw
                                                      
                                                   
                                                   <
                                                   2
                                                   
                                                      
                                                         B
                                                      
                                                      
                                                         u
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                              The first equivalence simply uses the fact that the quantity (b
                              
                                 uv
                              
                              +
                              b
                              
                                 vw
                              ) is either smaller than B
                              
                                 u
                              , or is in the interval [B
                              
                                 u
                              , 2B
                              
                                 u
                              ), or is greater than 2B
                              
                                 u
                              . The second equivalence comes from the fact that s
                              <
                              B
                              
                                 u
                               due to Property 1, which implies that the third clause of the second line is always false. Again, Eq. (7) allows to write the last equivalence, since B
                              
                                 u
                              
                              ⩽
                              b
                              
                                 uv
                              
                              +
                              b
                              
                                 vw
                              
                              <2B
                              
                                 u
                              ⇔b
                              
                                 uv
                              
                              +
                              b
                              
                                 vw
                              
                              =
                              b
                              
                                 uw
                              
                              +
                              B
                              
                                 u
                              .□


                        Property 3 implies that for any stock level s
                        
                           u−1 in the ith α
                        
                           u
                        -interval, the resulting stock level σ
                        
                           uv
                        (s
                        
                           u−1) is in the same jth α
                        
                           v
                        -interval, for some index j. We now turn our attention to the computation of this index. To simplify the forthcoming expressions, instead of representing the interval 
                           
                              
                                 
                                    
                                       
                                          
                                             α
                                          
                                          
                                             i
                                          
                                          
                                             u
                                          
                                       
                                       ,
                                       
                                          
                                             α
                                          
                                          
                                             i
                                             +
                                             1
                                          
                                          
                                             u
                                          
                                       
                                    
                                 
                              
                           
                         by its index i, we choose to give a period 
                           
                              
                                 
                                    v
                                 
                                 
                                    ¯
                                 
                              
                           
                         such that 
                           
                              
                                 
                                    b
                                 
                                 
                                    u
                                    
                                       
                                          v
                                       
                                       
                                          ¯
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    α
                                 
                                 
                                    i
                                 
                                 
                                    u
                                 
                              
                           
                        . By convention, if 
                           
                              
                                 
                                    α
                                 
                                 
                                    i
                                 
                                 
                                    u
                                 
                              
                              =
                              0
                           
                        , we set 
                           
                              
                                 
                                    v
                                 
                                 
                                    ¯
                                 
                              
                              =
                              0
                           
                         and b
                        
                           u0
                        =0. Clearly, for any period v
                        >
                        u, if we know that 
                           
                              
                                 
                                    v
                                 
                                 
                                    ¯
                                 
                              
                              =
                              arg
                              
                                 
                                    max
                                 
                                 
                                    t
                                 
                              
                              {
                              
                                 
                                    b
                                 
                                 
                                    ut
                                 
                              
                              |
                              
                                 
                                    b
                                 
                                 
                                    ut
                                 
                              
                              ⩽
                              s
                              }
                           
                        , with the convention that arg max∅=0, then we have s
                        ⩾
                        b
                        
                           uv
                         if and only if 
                           
                              
                                 
                                    b
                                 
                                 
                                    uv
                                 
                              
                              ⩽
                              
                                 
                                    b
                                 
                                 
                                    u
                                    
                                       
                                          v
                                       
                                       
                                          ¯
                                       
                                    
                                 
                              
                           
                        . Now let 
                           
                              
                                 
                                    w
                                 
                                 
                                    ¯
                                 
                              
                           
                         be a period such that 
                           
                              
                                 
                                    b
                                 
                                 
                                    v
                                    
                                       
                                          w
                                       
                                       
                                          ¯
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    α
                                 
                                 
                                    j
                                 
                                 
                                    v
                                 
                              
                           
                        . Property 3 allows us to determine 
                           
                              
                                 
                                    w
                                 
                                 
                                    ¯
                                 
                              
                           
                         from 
                           
                              
                                 
                                    v
                                 
                                 
                                    ¯
                                 
                              
                           
                         as follows:

If 
                           
                              
                                 
                                    b
                                 
                                 
                                    uv
                                 
                              
                              ⩽
                              
                                 
                                    b
                                 
                                 
                                    u
                                    
                                       
                                          v
                                       
                                       
                                          ¯
                                       
                                    
                                 
                              
                           
                         then
                           
                              
                                 
                                    
                                       w
                                    
                                    
                                       ¯
                                    
                                 
                                 =
                                 arg
                                 
                                    
                                       
                                          max
                                       
                                       
                                          w
                                       
                                    
                                 
                                 {
                                 
                                    
                                       b
                                    
                                    
                                       vw
                                    
                                 
                                 |
                                 
                                    
                                       b
                                    
                                    
                                       uw
                                    
                                 
                                 ⩽
                                 
                                    
                                       b
                                    
                                    
                                       u
                                       
                                          
                                             v
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                 
                                 
                                 and
                                 
                                 
                                    
                                       b
                                    
                                    
                                       vw
                                    
                                 
                                 <
                                 
                                    
                                       B
                                    
                                    
                                       u
                                    
                                 
                                 -
                                 
                                    
                                       b
                                    
                                    
                                       uv
                                    
                                 
                                 }
                              
                           
                        Similarly, if 
                           
                              
                                 
                                    b
                                 
                                 
                                    uv
                                 
                              
                              <
                              
                                 
                                    b
                                 
                                 
                                    u
                                    
                                       
                                          v
                                       
                                       
                                          ¯
                                       
                                    
                                 
                              
                           
                        , then
                           
                              
                                 
                                    
                                       w
                                    
                                    
                                       ¯
                                    
                                 
                                 =
                                 arg
                                 
                                    
                                       
                                          max
                                       
                                       
                                          w
                                       
                                    
                                 
                                 {
                                 
                                    
                                       b
                                    
                                    
                                       vw
                                    
                                 
                                 |
                                 (
                                 
                                    
                                       b
                                    
                                    
                                       uw
                                    
                                 
                                 ⩽
                                 
                                    
                                       b
                                    
                                    
                                       u
                                       
                                          
                                             v
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                 
                                 )
                                 
                                 and
                                 
                                 (
                                 
                                    
                                       b
                                    
                                    
                                       vw
                                    
                                 
                                 <
                                 2
                                 
                                    
                                       B
                                    
                                    
                                       u
                                    
                                 
                                 -
                                 
                                    
                                       b
                                    
                                    
                                       uv
                                    
                                 
                                 )
                                 
                                 or
                                 
                                 (
                                 
                                    
                                       b
                                    
                                    
                                       vw
                                    
                                 
                                 <
                                 
                                    
                                       B
                                    
                                    
                                       u
                                    
                                 
                                 -
                                 
                                    
                                       b
                                    
                                    
                                       uv
                                    
                                 
                                 )
                                 }
                              
                           
                        
                     

Notice that if we pre-compute all the values b
                        
                           uv
                        ’s for any couple of periods and sort them for each period u, then determining 
                           
                              
                                 
                                    w
                                 
                                 
                                    ¯
                                 
                              
                           
                         for a given 
                           
                              
                                 
                                    v
                                 
                                 
                                    ¯
                                 
                              
                           
                         using the preceding expressions can be done in time O(logT) by dichotomic search. We are now ready to give the description of the dynamic programming algorithm.

Let us denote 
                           
                              O
                              
                                 
                                    pt
                                 
                                 
                                    ¯
                                 
                              
                              (
                              u
                              ,
                              
                                 
                                    v
                                 
                                 
                                    ¯
                                 
                              
                              )
                           
                         the minimal cost to satisfy all the demands over the periods [u, T], assuming that u is an ordering period, and given any entering stock level s such that 
                           
                              
                                 
                                    b
                                 
                                 
                                    u
                                    
                                       
                                          v
                                       
                                       
                                          ¯
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    max
                                 
                                 
                                    v
                                 
                              
                              {
                              
                                 
                                    b
                                 
                                 
                                    uv
                                 
                              
                              |
                              
                                 
                                    b
                                 
                                 
                                    uv
                                 
                              
                              ⩽
                              s
                              }
                           
                        . We can write the sub-optimality principle as:
                           
                              
                                 O
                                 
                                    
                                       pt
                                    
                                    
                                       ¯
                                    
                                 
                                 (
                                 u
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       ¯
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       f
                                    
                                    
                                       u
                                    
                                 
                                 +
                                 
                                    
                                       
                                          min
                                       
                                       
                                          v
                                          >
                                          u
                                       
                                    
                                 
                                 {
                                 ⌈
                                 (
                                 
                                    
                                       D
                                    
                                    
                                       u
                                       ,
                                       v
                                       -
                                       1
                                    
                                 
                                 -
                                 
                                    
                                       b
                                    
                                    
                                       u
                                       
                                          
                                             v
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                 
                                 )
                                 /
                                 
                                    
                                       B
                                    
                                    
                                       u
                                    
                                 
                                 ⌉
                                 k
                                 +
                                 O
                                 
                                    
                                       pt
                                    
                                    
                                       ¯
                                    
                                 
                                 (
                                 v
                                 ,
                                 
                                    
                                       w
                                    
                                    
                                       ¯
                                    
                                 
                                 )
                                 }
                              
                           
                        In this dynamic programming, we have O(T
                        2) states to consider. For each state 
                           
                              (
                              u
                              ,
                              
                                 
                                    v
                                 
                                 
                                    ¯
                                 
                              
                              )
                           
                        , the computation of 
                           
                              O
                              
                                 
                                    pt
                                 
                                 
                                    ¯
                                 
                              
                              (
                              u
                              ,
                              
                                 
                                    v
                                 
                                 
                                    ¯
                                 
                              
                              )
                           
                         can be done in time O(T logT) by inspection on the different periods v
                        >
                        u, each period v requiring the determination of 
                           
                              
                                 
                                    w
                                 
                                 
                                    ¯
                                 
                              
                           
                        . Since the precomputing and sorting of the b
                        
                           uv
                        ’s is negligible compared to the time complexity of computing 
                           
                              O
                              
                                 
                                    pt
                                 
                                 
                                    ¯
                                 
                              
                              (
                              u
                              ,
                              
                                 
                                    v
                                 
                                 
                                    ¯
                                 
                              
                              )
                           
                         for all the states, we obtain the following result:
                           Theorem 7
                           
                              Problem UBLS (f
                              
                                 t
                              
                              /k/−/−) with stationary fixed cost per batch and null unit procurement and holding costs can be solved in time 
                              
                                 
                                    O
                                 
                              
                              (T
                              
                                 3
                               
                              logT) if the batch sizes are divisible.
                           

We finally consider the case where only the batch sizes are time-dependent, all the cost parameters (f, k, p and h) being stationary. In addition we restrict our attention to a null unit holding cost, that is h
                     =0. For short we note this problem as (f/k/−/−). Notice that even with no holding cost, this problem becomes NP-hard as soon as one cost parameter is time-dependent. Without loss of generality we can assume that the batch sizes are increasing with respect to the periods, see Section 6.2. In the following Section 7.1, we derive a polynomial time algorithm in O(T
                     3) time complexity using the property that the cost of a policy belongs to a restricted set of possible values. In Section 7.2 a linear time algorithm is derived for the case with no setup cost (−/k/−/−).

The basic idea to derive a polynomial time algorithm is to observe that the cost of a policy belongs to a restricted set of possible values. Indeed, a policy making α setups and ordering β batches over the time horizon incurs a cost of αf
                        +
                        βk, whenever it does actually order. Thus we propose a dynamic programming approach where the states are based upon the cost paid by a policy.

To introduce this approach, consider the set Π(u, α, β) of feasible plannings incurring exactly α setups and ordering exactly β batches on the time interval [1, …, u
                        −1], and such that u is an ordering period. Recall that OPT(u, s), introduced in Section 6.2, denotes the minimal cost of a policy to satisfy the remaining demands on time interval [u, T] given an entering stock level of s at period u. The optimal cost over the whole horizon for a policy of Π(u, α, β) assuming an entering stock level of s at period u is clearly equal to αf
                        +
                        βk
                        +OPT(u, s). Now observe that OPT(u, s) is a non-increasing function of the stock level s. This is due to the fact that a feasible policy for a stock level s is also feasible for any stock level s′>
                        s. Thus the minimal cost z
                        ∗(u, α, β) of a planning belonging to Π(u, α, β) is realized by the policy maximizing the stock level s
                        
                           u−1. Let us define 
                           
                              
                                 
                                    s
                                 
                                 
                                    ¯
                                 
                              
                              (
                              u
                              ,
                              α
                              ,
                              β
                              )
                           
                         as the maximal stock level at the beginning of the period u over all plannings in Π(u, α, β). By convention we set 
                           
                              
                                 
                                    s
                                 
                                 
                                    ¯
                                 
                              
                              =
                              -
                              ∞
                           
                         if Π(u, α, β) is empty, that is no feasible planning can make only α setups and orders only β batches over [1, …, u
                        −1]. From what precedes we have
                           
                              
                                 
                                    
                                       z
                                    
                                    
                                       ∗
                                    
                                 
                                 (
                                 u
                                 ,
                                 α
                                 ,
                                 β
                                 )
                                 =
                                 α
                                 f
                                 +
                                 β
                                 k
                                 +
                                 OPT
                                 (
                                 u
                                 ,
                                 
                                    
                                       s
                                    
                                    
                                       ¯
                                    
                                 
                                 (
                                 u
                                 ,
                                 α
                                 ,
                                 β
                                 )
                                 )
                              
                           
                        And obviously
                           
                              (8)
                              
                                 OPT
                                 =
                                 
                                    
                                       
                                          min
                                       
                                       
                                          α
                                          ,
                                          β
                                       
                                    
                                 
                                 {
                                 α
                                 f
                                 +
                                 β
                                 k
                                 |
                                 
                                    
                                       s
                                    
                                    
                                       ¯
                                    
                                 
                                 (
                                 T
                                 +
                                 1
                                 ,
                                 α
                                 ,
                                 β
                                 )
                                 ⩾
                                 0
                                 }
                              
                           
                        Hence our goal is to compute dynamically the maximum stock level 
                           
                              
                                 
                                    s
                                 
                                 
                                    ¯
                                 
                              
                              (
                              u
                              ,
                              α
                              ,
                              β
                              )
                           
                         of a feasible policy. Due to Property 2, we can restrict to policies whose evolution of the stock levels obeys σ, that is s
                        
                           v−1
                        =
                        σ
                        
                           uv
                        (s
                        
                           u−1) for any two successive ordering periods u and v. But it turns out that the computation of 
                           
                              
                                 
                                    s
                                 
                                 
                                    ¯
                                 
                              
                              (
                              u
                              ,
                              α
                              ,
                              β
                              )
                           
                         is quite intricate, for s
                        ↦
                        σ
                        
                           uv
                        (s) is not an increasing function, see Fig. 3. In particular the entering stock level s at u maximizing the stock level σ
                        
                           uv
                        (s) at period v may be different from 
                           
                              
                                 
                                    s
                                 
                                 
                                    ¯
                                 
                              
                              (
                              u
                              ,
                              α
                              ,
                              β
                              )
                           
                        : for instance if 
                           
                              
                                 
                                    s
                                 
                                 
                                    ¯
                                 
                              
                              (
                              u
                              ,
                              α
                              ,
                              β
                              )
                           
                         equals b
                        
                           uv
                        , the resulting entering stock level σ
                        
                           uv
                        (b
                        
                           uv
                        ) is null while any stock level s
                        <
                        b
                        
                           uv
                         leads to a positive entering stock at period v.

However, we are not interested in computing 
                           
                              
                                 
                                    s
                                 
                                 
                                    ¯
                                 
                              
                              (
                              u
                              ,
                              α
                              ,
                              β
                              )
                           
                         for any values of α and β, but ideally only for the ones corresponding to an optimal planning. For this reason, we restrict our attention to a class of dominant policies, that we call the 
                           β
                        
                        -policies. The following of this section is devoted to define these policies, to prove their dominance, and to show that they can be efficiently computed.

For a given period u and a given number of setups α, we say that a number of batches β is minimal if Π(u, α, β
                        −1) is empty and Π(u, α, β) contains at least one feasible planning. That is, there exists no feasible planning with α ordering periods and ordering strictly less than β batches over the time interval [1, …, u
                        −1]. We denote by 
                           β
                        (u, α) this minimal value. We have by definition:
                           
                              
                                 
                                    
                                       β
                                    
                                    
                                       ̲
                                    
                                 
                                 (
                                 u
                                 ,
                                 α
                                 )
                                 =
                                 
                                    min
                                 
                                 {
                                 β
                                 |
                                 
                                    
                                       s
                                    
                                    
                                       ¯
                                    
                                 
                                 (
                                 u
                                 ,
                                 α
                                 ,
                                 β
                                 )
                                 ⩾
                                 0
                                 }
                              
                           
                        By convention we set 
                           β
                        (u, α)=+∞ if there does not exist a feasible policy making only α setups over [1, u
                        −1]. Eq. (8) immediately implies that OPT=min
                           α
                        {αf
                        +
                        
                           β
                        (T
                        +1, α)k}. Thus we can switch attention to computing dynamically the 
                           β
                        ’s values instead of the 
                           
                              
                                 
                                    s
                                 
                                 
                                    ¯
                                 
                              
                           
                        ’s values. To derive a recursive expression of 
                           β
                        , we consider the class of the 
                           β
                        -policies, using a minimal (overall) number of batches and having a maximal entering stock level at each period it orders:
                           Definition 1
                           A policy π of Π(u, α, β) is 
                                 β
                               at period u if the number β
                              
                                 u
                               of batches incurred by π on [1, …, u
                              −1] is minimal with respect to its number α of setups, and its entering stock level s
                              
                                 u−1 is maximal with respect to α and β:
                                 
                                    
                                       β
                                       =
                                       
                                          
                                             β
                                          
                                          
                                             ̲
                                          
                                       
                                       (
                                       u
                                       ,
                                       α
                                       )
                                       
                                       and
                                       
                                       
                                          
                                             s
                                          
                                          
                                             u
                                             -
                                             1
                                          
                                       
                                       =
                                       
                                          
                                             s
                                          
                                          
                                             ¯
                                          
                                       
                                       (
                                       u
                                       ,
                                       α
                                       ,
                                       β
                                       )
                                    
                                 
                              We say that π is a 
                                 β
                              -policy if π is 
                                 β
                               at each of its ordering period.

Observe that for any period u and any number of setups α, if there exists a feasible policy incurring α setups over [1, u
                        −1], then, by definition of 
                           β
                        (u, α), there exists a feasible policy that is 
                           β
                         at period u. On the contrary, the existence of 
                           β
                        -policies is not immediate: as previously claimed, there does not necessarily exist a planning maximizing the entering stock level of each of its ordering periods. Property 4 proves that 
                           β
                        -policies do exist and are dominant.
                           Property 4
                           
                              
                                 β
                              
                              -policies are dominant
                           

For short we denote by 
                                 Π
                              (u, α) the subset of policies π of Π(u, α, β) which are 
                                 β
                               at period u. By definition, it implies that β
                              =
                              
                                 β
                              (u, α) and that the entering stock level at u is 
                                 
                                    
                                       
                                          s
                                       
                                       
                                          ¯
                                       
                                    
                                    (
                                    u
                                    ,
                                    α
                                    ,
                                    β
                                    )
                                 
                              . We will establish that any policy that is 
                                 β
                               at a period v is also 
                                 β
                               at its preceding ordering period u. By a direct induction, such a policy is thus 
                                 β
                               at each of its ordering periods up to v. Property 4 follows, since for some value of α
                              ∗, set 
                                 Π
                              (T
                              +1, α) contains only optimal policies. Thus any policy of 
                                 Π
                              (T
                              +1, α
                              ∗) is both an optimal policy and a 
                                 β
                              -policy over the whole horizon.

Consider a period v and a number of setups α
                              >0 such that 
                                 Π
                              (v, α) is not empty. Let π be a policy of 
                                 Π
                              (v, α), that is a 
                                 β
                               at a period v. For any period t, we denote by α
                              
                                 t
                               and β
                              
                                 t
                               the number of setups and the number of batches, respectively, incurred by π on the time horizon [1, …, t
                              −1], and by s
                              
                                 t
                               the stock level at the end of period t. By definition of 
                                 Π
                              (v, α) we have β
                              
                                 v
                              
                              =
                              
                                 β
                              (v, α) and 
                                 
                                    
                                       
                                          s
                                       
                                       
                                          v
                                          -
                                          1
                                       
                                    
                                    =
                                    
                                       
                                          s
                                       
                                       
                                          ¯
                                       
                                    
                                    (
                                    v
                                    ,
                                    α
                                    ,
                                    
                                       
                                          β
                                       
                                       
                                          v
                                       
                                    
                                    )
                                 
                              .

Let u be the preceding ordering period. Recall that we want to prove that π is also 
                                 β
                               at period u. First, observe that the policy π obeys the relations of Property 2 between periods u and v. More precisely let m be the number of batches ordered by π at period u. Readily, for π to be feasible and to be minimal in the number of batches used over the time interval [1, …, v
                              −1], we should have m
                              =
                              m
                              
                                 uv
                              (s
                              
                                 u−1). That is, the policy should order the minimum possible number of batches at period u to satisfy the demand till period v. As a consequence, the entering stock level s
                              
                                 v−1 at period v is lower than B
                              
                                 u
                              . Also, for s
                              
                                 v−1 to be maximal with respect to α
                              
                                 v
                               and β
                              
                                 v
                              , the entering stock level s
                              
                                 u−1 at u should be less than B
                              
                                 u
                              : Otherwise the same interchange procedure as in Property 1 would increase by at least one unit s
                              
                                 v−1. It results that the stock levels verify the relation s
                              
                                 v−1
                              =
                              σ
                              
                                 uv
                              (s
                              
                                 u−1).

To prove that π is 
                                 β
                               at period u, we compare it with another policy π′, constructed as follows.

Clearly the policy π incurs exactly α
                              
                                 u
                              
                              =
                              α
                              −1 setups on the time horizon [1, u
                              −1]. In particular the set 
                                 Π
                              (u, α
                              
                                 u
                              ) is not empty, and we can choose a policy 
                                 π
                              
                              ∈
                              
                                 Π
                              (u, α
                              
                                 u
                              ), which is by definition 
                                 β
                               at period u. So, we are in the situation where we have:
                                 
                                    •
                                    a policy (
                                          π
                                       ) which is 
                                          β
                                        at period u; more precisely 
                                          π
                                       
                                       ∈
                                       
                                          Π
                                       (u, α
                                       −1)

a policy (π) which is 
                                          β
                                        at period v; more precisely π
                                       ∈
                                       
                                          Π
                                       (v, α)

Using intuitive notations, we denote in the following with a′ all the quantities relative to the policy π′. The policy π′ simply follows the policy 
                                 π
                               till period u. At period u, π′ orders 
                                 
                                    
                                       
                                          m
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    
                                       
                                          m
                                       
                                       
                                          uv
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   s
                                                
                                                
                                                   u
                                                   -
                                                   1
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                       
                                    
                                    =
                                    ⌈
                                    
                                       
                                          
                                             
                                                
                                                   D
                                                
                                                
                                                   u
                                                   ,
                                                   v
                                                   -
                                                   1
                                                
                                             
                                             -
                                             
                                                
                                                   s
                                                
                                                
                                                   u
                                                   -
                                                   1
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                       
                                    
                                    /
                                    
                                       
                                          B
                                       
                                       
                                          u
                                       
                                    
                                    ⌉
                                 
                               batches, according to its entering stock level 
                                 
                                    
                                       
                                          s
                                       
                                       
                                          u
                                          -
                                          1
                                       
                                       
                                          ′
                                       
                                    
                                 
                              , that is the minimal number of batches m
                              
                                 uv
                               to satisfy the demands till period v. Notice that our choice of 
                                 π
                               implies that 
                                 
                                    
                                       
                                          s
                                       
                                       
                                          u
                                          -
                                          1
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    
                                       
                                          s
                                       
                                       
                                          ¯
                                       
                                    
                                    (
                                    u
                                    ,
                                    
                                       
                                          α
                                       
                                       
                                          u
                                       
                                    
                                    ,
                                    
                                       
                                          β
                                       
                                       
                                          u
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                 
                              , which is maximal with respect to α
                              
                                 u
                               and 
                                 
                                    
                                       
                                          β
                                       
                                       
                                          u
                                       
                                       
                                          ′
                                       
                                    
                                 
                              . Finally on the time interval [v, T
                              +1], the policy π′ follows an optimal policy. By construction, the stock level 
                                 
                                    
                                       
                                          s
                                       
                                       
                                          v
                                          -
                                          1
                                       
                                       
                                          ′
                                       
                                    
                                 
                               at period v can not be negative, since we have chosen m′ such that 
                                 
                                    
                                       
                                          s
                                       
                                       
                                          v
                                          -
                                          1
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    
                                       
                                          σ
                                       
                                       
                                          uv
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   s
                                                
                                                
                                                   u
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                       
                                    
                                 
                              . It follows that π′ is feasible, and belongs to the set 
                                 
                                    Π
                                    
                                       
                                          
                                             v
                                             ,
                                             α
                                             ,
                                             
                                                
                                                   β
                                                
                                                
                                                   v
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                       
                                    
                                 
                              .

By construction, the policy π′ is 
                                 β
                               at period u. Since both policies incur the same number of setups over [1, …, u
                              −1], to prove that the policy π is also 
                                 β
                               period u, it is sufficient to show that 
                                 
                                    
                                       
                                          β
                                       
                                       
                                          u
                                       
                                    
                                    =
                                    
                                       
                                          β
                                       
                                       
                                          u
                                       
                                       
                                          ′
                                       
                                    
                                 
                               and 
                                 
                                    
                                       
                                          s
                                       
                                       
                                          u
                                          -
                                          1
                                       
                                    
                                    =
                                    
                                       
                                          s
                                       
                                       
                                          u
                                          -
                                          1
                                       
                                       
                                          ′
                                       
                                    
                                 
                              . Recall that m and m′ are the number of batches ordered at period u by the policies π and π′, respectively. With our notations we thus have β
                              
                                 v
                              
                              =
                              β
                              
                                 u
                              
                              +
                              m and 
                                 
                                    
                                       
                                          β
                                       
                                       
                                          v
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    
                                       
                                          β
                                       
                                       
                                          u
                                       
                                       
                                          ′
                                       
                                    
                                    +
                                    
                                       
                                          m
                                       
                                       
                                          ′
                                       
                                    
                                 
                              . Also observe that we have 
                                 
                                    
                                       
                                          α
                                       
                                       
                                          u
                                       
                                    
                                    =
                                    
                                       
                                          α
                                       
                                       
                                          u
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    α
                                    -
                                    1
                                 
                               and 
                                 
                                    
                                       
                                          α
                                       
                                       
                                          v
                                       
                                    
                                    =
                                    
                                       
                                          α
                                       
                                       
                                          v
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    α
                                 
                               by construction. Hence using the fact that the policy π′ is 
                                 β
                               at period u, we obtain 
                                 
                                    
                                       
                                          β
                                       
                                       
                                          u
                                       
                                       
                                          ′
                                       
                                    
                                    ⩽
                                    
                                       
                                          β
                                       
                                       
                                          u
                                       
                                    
                                 
                              . In the same way, since the policy π is 
                                 β
                               at period v, we have 
                                 
                                    
                                       
                                          β
                                       
                                       
                                          v
                                       
                                    
                                    ⩽
                                    
                                       
                                          β
                                       
                                       
                                          v
                                       
                                       
                                          ′
                                       
                                    
                                 
                              . We thus have:
                                 
                                    (9)
                                    
                                       
                                          
                                             β
                                          
                                          
                                             u
                                          
                                          
                                             ′
                                          
                                       
                                       ⩽
                                       
                                          
                                             β
                                          
                                          
                                             u
                                          
                                       
                                       
                                       and
                                       
                                       
                                          
                                             β
                                          
                                          
                                             u
                                          
                                       
                                       +
                                       m
                                       ⩽
                                       
                                          
                                             β
                                          
                                          
                                             u
                                          
                                          
                                             ′
                                          
                                       
                                       +
                                       
                                          
                                             m
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                              Observe that Eq. (9) implies in particular that m
                              ⩽
                              m′, that is at period u the policy π′ orders at least the same number of batches as π. We first establish that 
                                 
                                    
                                       
                                          β
                                       
                                       
                                          u
                                       
                                    
                                    =
                                    
                                       
                                          β
                                       
                                       
                                          u
                                       
                                       
                                          ′
                                       
                                    
                                 
                              .

For the sake of contradiction, assume that 
                                 
                                    
                                       
                                          β
                                       
                                       
                                          u
                                       
                                    
                                    
                                    ≠
                                    
                                    
                                       
                                          β
                                       
                                       
                                          u
                                       
                                       
                                          ′
                                       
                                    
                                 
                              . Due to Eq. (9) we thus have 
                                 
                                    
                                       
                                          β
                                       
                                       
                                          u
                                       
                                       
                                          ′
                                       
                                    
                                    <
                                    
                                       
                                          β
                                       
                                       
                                          u
                                       
                                    
                                 
                              , which implies that m
                              <
                              m′. Observe that m′ is the minimum number of batches to order to satisfy the demands till period v with an entering stock level 
                                 
                                    
                                       
                                          s
                                       
                                       
                                          u
                                          -
                                          1
                                       
                                       
                                          ′
                                       
                                    
                                 
                               at period u. Thus, necessarily we have 
                                 
                                    
                                       
                                          s
                                       
                                       
                                          u
                                          -
                                          1
                                       
                                    
                                    >
                                    
                                       
                                          s
                                       
                                       
                                          u
                                          -
                                          1
                                       
                                       
                                          ′
                                       
                                    
                                 
                              . We are in the situation where the policy π has ordered more batches on the time interval [1, …, u
                              −1] than the policy π′, thus ending with a larger inventory at period u, which enables it in its turn to order less batches to cover the demands till period v. We now show that it would contradict the fact that π is 
                                 β
                               at period v. Recall that the number m of batches ordered by π at period u is also minimal with respect to its entering stock s
                              
                                 u−1, that is m
                              =
                              m
                              
                                 uv
                              (s
                              
                                 u−1). Now, since
                                 
                                    (10)
                                    
                                       
                                          
                                             m
                                          
                                          
                                             uv
                                          
                                       
                                       (
                                       s
                                       )
                                       =
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ⌊
                                                         
                                                            
                                                               D
                                                            
                                                            
                                                               u
                                                               ,
                                                               v
                                                               -
                                                               1
                                                            
                                                         
                                                         /
                                                         
                                                            
                                                               B
                                                            
                                                            
                                                               u
                                                            
                                                         
                                                         ⌋
                                                         +
                                                         1
                                                      
                                                      
                                                         if
                                                         
                                                         s
                                                         <
                                                         
                                                            
                                                               b
                                                            
                                                            
                                                               uv
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         ⌊
                                                         
                                                            
                                                               D
                                                            
                                                            
                                                               u
                                                               ,
                                                               v
                                                               -
                                                               1
                                                            
                                                         
                                                         /
                                                         
                                                            
                                                               B
                                                            
                                                            
                                                               u
                                                            
                                                         
                                                         ⌋
                                                      
                                                      
                                                         if
                                                         
                                                         s
                                                         ⩾
                                                         
                                                            
                                                               b
                                                            
                                                            
                                                               uv
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              it is clear that the minimal number of batches m
                              
                                 uv
                               to order differs by at most one unit depending on the current inventory level. Thus we necessarily have m′=
                              m
                              +1, which implies, again according to Eq. (9), that 
                                 
                                    
                                       
                                          β
                                       
                                       
                                          v
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    
                                       
                                          β
                                       
                                       
                                          v
                                       
                                    
                                 
                              . Turning our attention to the stock levels, we have by construction 
                                 
                                    
                                       
                                          s
                                       
                                       
                                          v
                                          -
                                          1
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    
                                       
                                          s
                                       
                                       
                                          u
                                          -
                                          1
                                       
                                       
                                          ′
                                       
                                    
                                    +
                                    (
                                    m
                                    +
                                    1
                                    )
                                    
                                       
                                          B
                                       
                                       
                                          u
                                       
                                    
                                    -
                                    
                                       
                                          D
                                       
                                       
                                          u
                                          ,
                                          v
                                          -
                                          1
                                       
                                    
                                    ⩾
                                    
                                       
                                          B
                                       
                                       
                                          u
                                       
                                    
                                    +
                                    
                                       
                                          mB
                                       
                                       
                                          u
                                       
                                    
                                    -
                                    
                                       
                                          D
                                       
                                       
                                          u
                                          ,
                                          v
                                          -
                                          1
                                       
                                    
                                 
                              . Similarly s
                              
                                 v−1
                              =
                              s
                              
                                 u−1
                              +
                              mB
                              
                                 u
                              
                              −
                              D
                              
                                 u, v−1. As already noticed, we can assume that s
                              
                                 u
                              
                              <
                              B
                              
                                 u
                              , which implies that s′
                                 v−1
                              >
                              s
                              
                                 v−1. As a conclusion, both policies π and π′ belongs to the set Π(v, α
                              
                                 v
                              , β
                              
                                 v
                              ), but the policy π′ has a larger entering stock level at period v. This contradicts the fact that π is 
                                 β
                               at period v.

As a consequence, we necessarily have 
                                 
                                    
                                       
                                          β
                                       
                                       
                                          u
                                       
                                    
                                    =
                                    
                                       
                                          β
                                       
                                       
                                          u
                                       
                                       
                                          ′
                                       
                                    
                                 
                              . To be able to conclude that π is also 
                                 β
                               at period u, we need to establish now that 
                                 
                                    
                                       
                                          s
                                       
                                       
                                          u
                                          -
                                          1
                                       
                                    
                                    =
                                    
                                       
                                          s
                                       
                                       
                                          u
                                          -
                                          1
                                       
                                       
                                          ′
                                       
                                    
                                 
                              . Since π′ is 
                                 β
                               at period u, its entering stock level 
                                 
                                    
                                       
                                          s
                                       
                                       
                                          u
                                          -
                                          1
                                       
                                       
                                          ′
                                       
                                    
                                 
                               is the largest possible among all policies of 
                                 
                                    Π
                                    (
                                    u
                                    ,
                                    
                                       
                                          α
                                       
                                       
                                          u
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    
                                       
                                          β
                                       
                                       
                                          u
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                 
                              . It implies that 
                                 
                                    
                                       
                                          s
                                       
                                       
                                          u
                                          -
                                          1
                                       
                                    
                                    ⩽
                                    
                                       
                                          s
                                       
                                       
                                          u
                                          -
                                          1
                                       
                                       
                                          ′
                                       
                                    
                                 
                              . For the sake of contradiction, assume that 
                                 
                                    
                                       
                                          s
                                       
                                       
                                          u
                                          -
                                          1
                                       
                                    
                                    <
                                    
                                       
                                          s
                                       
                                       
                                          u
                                          -
                                          1
                                       
                                       
                                          ′
                                       
                                    
                                 
                              . We show that, again, it would contradict the fact that π is 
                                 β
                               at period v. Observe that the policy π′ orders at period u the minimal number of batches, with respect to its stock level, to satisfy the demands till the beginning of period v. Hence for the policy π to be feasible starting from a lower inventory level than π′, certainly it has to order at least m′ batches at period u. Together with Eq. (9), we can conclude that m′=
                              m (both policies order the same number of batches at period u) and by consequence that 
                                 
                                    
                                       
                                          β
                                       
                                       
                                          v
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    
                                       
                                          β
                                       
                                       
                                          v
                                       
                                    
                                 
                              . In addition, the fact that 
                                 
                                    
                                       
                                          s
                                       
                                       
                                          u
                                          -
                                          1
                                       
                                    
                                    <
                                    
                                       
                                          s
                                       
                                       
                                          u
                                          -
                                          1
                                       
                                       
                                          ′
                                       
                                    
                                 
                               and that both policies order the same amount mB
                              
                                 u
                               of units at period u obviously implies that 
                                 
                                    
                                       
                                          s
                                       
                                       
                                          v
                                          -
                                          1
                                       
                                    
                                    <
                                    
                                       
                                          s
                                       
                                       
                                          v
                                          -
                                          1
                                       
                                       
                                          ′
                                       
                                    
                                 
                              . We arrive at the same situation that both policies π and π′ belong to the set Π(v, α
                              
                                 v
                              , β
                              
                                 v
                              ), but the policy π′ has a larger entering stock level at period v. This contradicts the fact that π is 
                                 β
                               at period v.

As a consequence we have 
                                 
                                    
                                       
                                          β
                                       
                                       
                                          u
                                       
                                    
                                    =
                                    
                                       
                                          β
                                       
                                       
                                          u
                                       
                                       
                                          ′
                                       
                                    
                                    ≡
                                    
                                       
                                          β
                                       
                                       
                                          ̲
                                       
                                    
                                    (
                                    u
                                    ,
                                    α
                                    -
                                    1
                                    )
                                 
                               and 
                                 
                                    
                                       
                                          s
                                       
                                       
                                          u
                                          -
                                          1
                                       
                                    
                                    =
                                    
                                       
                                          s
                                       
                                       
                                          u
                                          -
                                          1
                                       
                                       
                                          ′
                                       
                                    
                                    ≡
                                    
                                       
                                          s
                                       
                                       
                                          ¯
                                       
                                    
                                    
                                       
                                          
                                             u
                                             ,
                                             α
                                             -
                                             1
                                             ,
                                             
                                                
                                                   β
                                                
                                                
                                                   u
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                       
                                    
                                 
                              . It implies that the policy π is 
                                 β
                               at period u, which concludes the proof.□


                        Property 4 allows us to compute dynamically the different values 
                           β
                        (u, α), using the fact that there exists a policy in 
                           Π
                        (u, α) using a minimal number of batches at each of its ordering period. In addition, the proof of Property 4 also shows that Property 2 is also dominant for 
                           β
                         policies. The definition of 
                           β
                         still requires to compute the maximum stock level 
                           
                              
                                 
                                    s
                                 
                                 
                                    ¯
                                 
                              
                              (
                              u
                              ,
                              α
                              ,
                              β
                              )
                           
                        , but we can restrict ourselves to the following function 
                           
                              
                                 
                                    s
                                 
                                 
                                    ˆ
                                 
                              
                              (
                              u
                              ,
                              α
                              ,
                              β
                              )
                           
                         defined by:
                           
                              
                                 
                                    
                                       s
                                    
                                    
                                       ˆ
                                    
                                 
                                 (
                                 u
                                 ,
                                 α
                                 ,
                                 β
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                   (
                                                   u
                                                   ,
                                                   α
                                                   ,
                                                   β
                                                   )
                                                
                                                
                                                   if
                                                   
                                                   β
                                                   =
                                                   
                                                      
                                                         β
                                                      
                                                      
                                                         ̲
                                                      
                                                   
                                                   (
                                                   u
                                                   ,
                                                   α
                                                   )
                                                
                                             
                                             
                                                
                                                   -
                                                   ∞
                                                
                                                
                                                   otherwise
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        The values 
                           β
                         and 
                           
                              
                                 
                                    s
                                 
                                 
                                    ˆ
                                 
                              
                           
                         can be jointly computed dynamically as follows: For any period v and any value α
                        ⩾1:
                           
                              
                                 
                                    
                                       β
                                    
                                    
                                       ̲
                                    
                                 
                                 (
                                 v
                                 ,
                                 α
                                 )
                                 =
                                 
                                    
                                       
                                          min
                                       
                                       
                                          u
                                          <
                                          v
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         β
                                                      
                                                      
                                                         ̲
                                                      
                                                   
                                                   (
                                                   u
                                                   ,
                                                   α
                                                   -
                                                   1
                                                   )
                                                   +
                                                   ⌊
                                                   
                                                      
                                                         D
                                                      
                                                      
                                                         u
                                                         ,
                                                         v
                                                         -
                                                         1
                                                      
                                                   
                                                   /
                                                   
                                                      
                                                         B
                                                      
                                                      
                                                         u
                                                      
                                                   
                                                   ⌋
                                                
                                             
                                             
                                                
                                                   
                                                   if
                                                   
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                   (
                                                   u
                                                   ,
                                                   α
                                                   -
                                                   1
                                                   ,
                                                   β
                                                   -
                                                   ⌊
                                                   
                                                      
                                                         D
                                                      
                                                      
                                                         u
                                                         ,
                                                         v
                                                         -
                                                         1
                                                      
                                                   
                                                   /
                                                   
                                                      
                                                         B
                                                      
                                                      
                                                         u
                                                      
                                                   
                                                   ⌋
                                                   )
                                                   ⩾
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         uv
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         β
                                                      
                                                      
                                                         ̲
                                                      
                                                   
                                                   (
                                                   u
                                                   ,
                                                   α
                                                   -
                                                   1
                                                   )
                                                   +
                                                   ⌈
                                                   
                                                      
                                                         D
                                                      
                                                      
                                                         u
                                                         ,
                                                         v
                                                         -
                                                         1
                                                      
                                                   
                                                   /
                                                   
                                                      
                                                         B
                                                      
                                                      
                                                         u
                                                      
                                                   
                                                   ⌉
                                                
                                             
                                             
                                                
                                                   
                                                   if
                                                   
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                   (
                                                   u
                                                   ,
                                                   α
                                                   -
                                                   1
                                                   ,
                                                   β
                                                   -
                                                   ⌈
                                                   
                                                      
                                                         D
                                                      
                                                      
                                                         u
                                                         ,
                                                         v
                                                         -
                                                         1
                                                      
                                                   
                                                   /
                                                   
                                                      
                                                         B
                                                      
                                                      
                                                         u
                                                      
                                                   
                                                   ⌉
                                                   )
                                                   <
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         uv
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        and for β
                        =
                        
                           β
                        (v, α)⩾1, we have:
                           
                              
                                 
                                    
                                       s
                                    
                                    
                                       ˆ
                                    
                                 
                                 (
                                 v
                                 ,
                                 α
                                 ,
                                 β
                                 )
                                 =
                                 
                                    
                                       
                                          max
                                       
                                       
                                          u
                                          <
                                          v
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                   (
                                                   u
                                                   ,
                                                   α
                                                   -
                                                   1
                                                   ,
                                                   β
                                                   -
                                                   ⌊
                                                   
                                                      
                                                         D
                                                      
                                                      
                                                         u
                                                         ,
                                                         v
                                                         -
                                                         1
                                                      
                                                   
                                                   /
                                                   
                                                      
                                                         B
                                                      
                                                      
                                                         u
                                                      
                                                   
                                                   ⌋
                                                   )
                                                   -
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         uv
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                   (
                                                   u
                                                   ,
                                                   α
                                                   -
                                                   1
                                                   ,
                                                   β
                                                   -
                                                   ⌈
                                                   
                                                      
                                                         D
                                                      
                                                      
                                                         u
                                                         ,
                                                         v
                                                         -
                                                         1
                                                      
                                                   
                                                   /
                                                   
                                                      
                                                         B
                                                      
                                                      
                                                         u
                                                      
                                                   
                                                   ⌉
                                                   )
                                                   -
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         uv
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         B
                                                      
                                                      
                                                         u
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        and 
                           
                              
                                 
                                    s
                                 
                                 
                                    ˆ
                                 
                              
                              (
                              v
                              ,
                              α
                              ,
                              β
                              )
                              =
                              -
                              ∞
                           
                         for β
                        ≠
                        
                           β
                        (v, α).

For α
                        =0, the basis of the recursion is given for any period u by:
                           
                              
                                 
                                    
                                       β
                                    
                                    
                                       ̲
                                    
                                 
                                 (
                                 u
                                 ,
                                 0
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   0
                                                
                                                
                                                   if
                                                   
                                                   
                                                      
                                                         D
                                                      
                                                      
                                                         1
                                                         ,
                                                         u
                                                         -
                                                         1
                                                      
                                                   
                                                   =
                                                   0
                                                
                                             
                                             
                                                
                                                   +
                                                   ∞
                                                
                                                
                                                   otherwise
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              
                                 and
                                 
                                 
                                    
                                       s
                                    
                                    
                                       ˆ
                                    
                                 
                                 (
                                 u
                                 ,
                                 0
                                 ,
                                 β
                                 )
                                 =
                                 -
                                 
                                    
                                       β
                                    
                                    
                                       ̲
                                    
                                 
                                 (
                                 u
                                 ,
                                 0
                                 )
                              
                           
                        These expressions simply correspond to the behavior of a dominant policy as defined by Property 2. We obtain the following theorem:
                           Theorem 8
                           Polynomiality of (f/k/−/−)


                           
                              Problem UBLS with stationary setup cost, stationary fixed cost per batch and null unit procurement and holding costs can be solved in time complexity O(T
                              
                                 3
                              
                              ).
                           

The dynamic computation of the 
                                 β
                               values requires to evaluate O(T
                              2) states. The value of each 
                                 β
                              (v, α) can be determined in time O(T) if all quantities b
                              
                                 uv
                               are precomputed (this requires only O(T
                              2) operations). For the stock levels 
                                 
                                    
                                       
                                          s
                                       
                                       
                                          ˆ
                                       
                                    
                                    (
                                    v
                                    ,
                                    α
                                    ,
                                    β
                                    )
                                 
                              , we have O(T
                              3) states to explore. However for a given pair (v, α), only the computation for the case β
                              =
                              
                                 β
                              (v, α) requires O(T) operations. For all other values of β, the computation of 
                                 
                                    
                                       
                                          s
                                       
                                       
                                          ˆ
                                       
                                    
                                    (
                                    v
                                    ,
                                    α
                                    ,
                                    β
                                    )
                                 
                               requires only O(1) operations. The determination of the optimal value OPT is then performed in time O(T). The overall time complexity is hence in O(T
                              3).□

In the restricted case with no setup cost, (−/k/−/−), the problem can be solved very efficiently in O(T) by a simple greedy algorithm. First observe that the cheapest way to satisfy a demand is to order in a previous period with the largest possible batch size. Thus an optimal planning orders the first (non null) demand, say d
                        
                           t
                        , in the period u
                        ⩽
                        t with the largest batch capacity. The number of full batches to order to satisfy the demand d
                        
                           t
                         is 
                           
                              ⌈
                              
                                 
                                    
                                       
                                          d
                                       
                                       
                                          t
                                       
                                    
                                 
                                 
                                    
                                       
                                          B
                                       
                                       
                                          u
                                       
                                    
                                 
                              
                              ⌉
                           
                        . The algorithm then sequentially scans through the periods till the demand of a period t′ can not be entirely satisfied by the quantity ordered at u. The algorithm again should order in the period before t′ with the largest batch size, that is u′=arg max{B
                        
                           i
                        ∣1⩽
                        i
                        ⩽
                        t′}, to serve this remaining demand in t′. We repeat these steps until the end of the horizon is reached. A straightforward implementation requires O(T
                        2) steps, since at each period we may have to search for the largest batch size. However we can use the fact that for any periods t
                        <
                        t′ we have max{B
                        
                           i
                        ∣1 ⩽
                        i
                        ⩽
                        t′}=max{max{B
                        
                           i
                        ∣1⩽
                        i
                        ⩽
                        t}, max{B
                        
                           i
                        ∣t
                        +1⩽
                        i
                        ⩽
                        t′}} to find for each period t the largest batch size period u
                        ⩽
                        t in constant time. Thus the overall complexity of the algorithm is linear.

In this paper we have studied the complexity of the UBLS problem with time-dependent batch sizes, according to the behavior of the cost parameters. To the best of our knowledge no anterior complexity study has been published on the time-varying batch size cases. We have proven that UBLS is NP-hard as soon as one of the cost parameters is allowed to be time-dependent. On the contrary, when all cost parameters are stationary (but assuming no holding cost), we have established that UBLS with time-dependent batch sizes can be solved in time O(T
                     3). Another non trivial polynomial case corresponds to UBLS with the cost structure (f
                     
                        t
                     /k/−/−) and divisible batch sizes, for which an O(T
                     3
                     log(T)) algorithm is proposed.

There are two remaining open cases to be explored for the UBLS problem with time-dependent batch sizes, namely (f/k/−/h) and (−/k/−/h). They correspond to the cases of stationary cost parameters but non null holding cost. Indeed, if a stationary procurement cost is equivalent to a null procurement cost, this is not the case for the holding cost. While these problems are NP-hard for time-dependent holding cost and polynomial for a null holding cost, their complexity status is open for a stationary holding cost.

Another open question is the approximability of the UBLS problem. Since the UBLS problem is NP-hard in the ordinary sense, one may hope that it belongs to fully polynomial time approximation scheme. It would be of interest to answer, positively or negatively, to the existence of a fully approximation scheme for this problem.

The polynomial time algorithms proposed in this paper are based on a dynamic programming approach. In the literature, polyhedral approaches have also been investigated for the CLSP with batch delivery. Akbalik and Pochet (2009) propose new classes of valid inequalities for the CLSP with the cost structure (f
                     
                        t
                     /k
                     
                        t
                     /p
                     
                        t
                     /h
                     
                        t
                     ), a stationary production capacity and a stationary batch size. Pochet and Wolsey (1993) gives a linear formulation with 
                        
                           O
                           (
                           
                              
                                 T
                              
                              
                                 3
                              
                           
                           )
                        
                      variables and constraints for the UBLS problem with the cost structure (−/k
                     
                        t
                     /p
                     
                        t
                     /h
                     
                        t
                     ). The reader can find a detailed description of the polyhedral approach for various extensions of the lot sizing problem in Pochet and Wolsey (2006). One perspective is to look for interesting valid inequalities for the UBLS problem with a general cost structure (f
                     
                        t
                     /k
                     
                        t
                     /p
                     
                        t
                     /h
                     
                        t
                     ), which is proven in our paper to be NP-hard. For the different polynomial cases, finding a compact linear formulation would also be of great interest.

@&#ACKNOWLEDGMENTS@&#

We are grateful to the anonymous referees for their very careful reading and suggestions which helped to improve the presentation of this paper.

@&#REFERENCES@&#

