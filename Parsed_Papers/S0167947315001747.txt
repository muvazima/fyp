@&#MAIN-TITLE@&#New upper bounds for tight and fast approximation of Fisher’s exact test in dependency rule mining

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A family of new tight upper bounds to approximate Fisher’s 
                                 p
                               is introduced.


                        
                        
                           
                           The new approximations suit for data mining purposes, because they are much faster to evaluate than the exact 
                                 p
                              -value.


                        
                        
                           
                           Theoretical analysis and empirical evaluation show that the new approximations are very accurate for all practical purposes.


                        
                        
                           
                           The approximations are not sensitive to the data size, distribution or small expected counts.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Fisher’s exact test




                     




                        p




                     -value

Hypergeometric distribution

Upper bound

Approximation

Dependency rule

Data mining

@&#ABSTRACT@&#


               
               
                  In the dependency rule mining, the goal is to discover the most significant statistical dependencies among all possible collapsed 
                        2
                        ×
                        2
                      contingency tables. Fisher’s exact test is a robust method to estimate the significance and it enables efficient pruning of the search space. The problem is that evaluating the required 
                        p
                     -value can be very laborious and the worst case time complexity is 
                        O
                        
                           (
                           n
                           )
                        
                     , where 
                        n
                      is the data size. The traditional solution is to approximate the significance with the 
                        
                           
                              χ
                           
                           
                              2
                           
                        
                     -measure, which can be estimated in a constant time. However, the 
                        
                           
                              χ
                           
                           
                              2
                           
                        
                     -measure can produce unreliable results (discover spurious dependencies but miss the most significant dependencies). Furthermore, it does not support efficient pruning of the search space. As a solution, a family of tight upper bounds for Fisher’s 
                        p
                      is introduced. The new upper bounds are fast to calculate and approximate Fisher’s 
                        p
                     -value accurately. In addition, the new approximations are not sensitive to the data size, distribution, or smallest expected counts like the 
                        
                           
                              χ
                           
                           
                              2
                           
                        
                     -based approximation. In practice, the execution time depends on the desired accuracy level. According to experimental evaluation, the simplest upper bounds are already sufficiently accurate for dependency rule mining purposes and they can be estimated in 0.004–0.1% of the time needed for exact calculation. For other purposes (testing very weak dependencies), one may need more accurate approximations, but even they can be calculated in less than 1% of the exact calculation time.
               
            

@&#INTRODUCTION@&#


                     Dependency rules are simple data mining patterns which can be used for a thorough analysis of statistical dependencies in categorical data sets. A dependency rule 
                        X
                        →
                        A
                      expresses a positive dependency between a set of attributes, 
                        X
                     , and a single binary attribute, 
                        A
                     . It can be read as “If factors 
                        X
                      occur, then 
                        A
                      is more likely to occur than otherwise”. Similarly, a negative dependency between 
                        X
                      and 
                        A
                      can be expressed by rule 
                        X
                        →
                        ¬
                        A
                     . In the dependency rule mining, the goal is to search for the best or all sufficiently good dependency rules with the selected goodness measure. Because the patterns are very simple, the search can be done quite efficiently, and dependency rule algorithms can handle even millions of rows of data containing thousands or tens of thousands binary attributes without any suboptimal heuristics (see e.g. Hämäläinen, 2012).

A classical application of dependency rules (and related association rules (Agrawal et al., 1993) which, however, do not necessarily express statistical dependencies) is market basket analysis, which aims to find dependencies describing shopping habits. A rule may reveal, for example, that if a market basket contains coffee and cream, then it is also more likely to contain sugar than other baskets. This kind of information has several applications in marketing, from optimal product arrangements to individual recommendations in web-stores. Medical science is another application field which contains huge binary or easily binarized data sets. In this context, dependency rules can be used to analyze which gene alleles, habits, environmental and phenotypic factors predispose or prevent diseases. This is an important application for dependency rule mining, because disease mechanisms are often very complex, involving dozens of factors. An extra difficulty is that statistical dependence (as well as statistical significance) is not a monotonic property. This means that rule 
                        A
                        ,
                        B
                        →
                        C
                      can express a strong and highly significant dependency, even if 
                        A
                      and 
                        C
                      as well as 
                        B
                      and 
                        C
                      were statistically independent. Therefore, it is not possible to find the most important dependencies without efficient search algorithms. 
                        Example 1
                        Let us consider a medical database which contains information on patients, their diseases (Alzheimer disease, stroke, heart attack, and coronary heart disease (CAD)), medical measurements (blood pressure and HDL and LDL cholesterol), and occurrence of certain gene alleles (ABCA1-R219K, ACE-D, ApoE-e2, -e3 and -e4). Here are some examples of discovered dependency rules: 
                              
                                 
                                    
                                    
                                    
                                       
                                          ApoE-e4 
                                                →
                                              high LDL
                                          ABCA1-R219K, 
                                                age
                                                <
                                                57
                                                →
                                                high HDL
                                             
                                          
                                       
                                       
                                          ACE-D, male 
                                                →
                                              hypertension
                                          ACE-D, age 
                                                ≥
                                              62, no diabetes 
                                                →
                                              heart attack
                                       
                                       
                                          ApoE-e4, ACE-D, smoking 
                                                →
                                              CAD
                                          hypertension 
                                                →
                                              stroke
                                       
                                       
                                          ApoE-e4 
                                                →
                                              stroke
                                          ApoE-e3, male, exercise 
                                                →
                                              low LDL
                                       
                                       
                                          ACE-D, 
                                                age
                                                <
                                                62
                                             , overweight 
                                                →
                                              CAD
                                          ABCA1-R219K 
                                                →
                                              stroke
                                       
                                       
                                          ACE-D, 
                                                age
                                                <
                                                62
                                                →
                                              CAD
                                          ApoE-e4, modest smoking 
                                                →
                                              no Alzheimer
                                       
                                       
                                          ApoeE-e4 
                                                →
                                              Alzheimer
                                          ABCA1-R219K, female 
                                                →
                                              Alzheimer
                                       
                                       
                                          Apo-e3, ACE-DD 
                                                →
                                              stroke
                                          ACE-D, 
                                                age
                                                ≥
                                                62
                                                →
                                                heart attack
                                             
                                          
                                       
                                       
                                          ApoE-e2 
                                                →
                                              low LDL
                                          ApoE-e2, male, exercise 
                                                →
                                              low LDL
                                       
                                    
                                 
                              
                           
                        

Here, simple rules tend to be frequent but weaker, while more specific rules are rarer but stronger. For example, carriers of the ApoE-e2 allele tend to have low LDL cholesterol, in general, but the dependence is not strong. However, if the carrier belongs to some special group, like exercising men, the dependence is much stronger. These rules also demonstrate the non-monotonic nature of statistical dependence. For example, allele ABCA1-R219K has no effect on Alzheimer disease, when considered alone, but among women, it surprisingly increases the risk. Similarly, ApoE-e4 is a risk factor for Alzheimer disease, but with modest smoking, it seems to protect from the same disease.

The applications of dependency rules are not restricted to categorical (easily binarized) data, although numerical variables require some kind of discretization. This can still be beneficial as a preliminary data analysis, because dependency rules can reveal even complex dependency structures without any assumptions on their form. This information on dependencies is anyway needed before one can select suitable methods for a more detailed analysis.

The main dilemma in dependency rule analysis (like most data mining) is how to perform the search efficiently without trading off quality of results. As one can expect, the problem is computationally very demanding, because the number of possible patterns is exponential, 
                        O
                        
                           (
                           k
                           
                              
                                 2
                              
                              
                                 k
                              
                           
                           )
                        
                     , where 
                        k
                      is the number of binary attributes. Even a simpler problem, searching for the optimal classification rules (dependency rules with a fixed consequence attribute) is known to be NP-hard with common statistical measures like the 
                        
                           
                              χ
                           
                           
                              2
                           
                        
                     -measure (Morishita and Sese, 2000), and no polynomial time solutions are known. The search algorithms try to prune the search space as much as possible without explicit testing, but still it is necessary to test millions of potentially promising patterns. For this reason, all algorithm steps and implementation details have to be polished to as fast as possible.

Concerning quality, the main concern is that the discovered patterns should be genuine dependencies which are likely to hold also in future data. In practice, this means statistical significance testing—the algorithm should find those dependencies which are least likely to have occurred by chance. In dependency rule mining and related pattern discovery, the most commonly used statistical significance measure is the 
                        
                           
                              χ
                           
                           
                              2
                           
                        
                     -measure (Morishita and Sese, 2000; Nijssen et al., 2009; Hämäläinen, 2011), but also other measures like Pearson’s correlation coefficient (Antonie and Zaïane, 2004), 
                        z
                     -score (Hämäläinen, 2010), mutual information (practically, log likelihood ratio) (Nijssen et al., 2009), and odds ratio (Li et al., 2013) have been used. Fisher’s exact test–which is the focus of this paper–has been used only rarely. In Kingfisher (Hämäläinen, 2012), Fisher’s 
                        p
                     -value, 
                        
                           
                              p
                           
                           
                              F
                           
                        
                     , is the main search measure. In MagnumOpus (Webb and Zhang, 2005), the rules are searched for with other measures, but Fisher’s exact test is used to test the improvement of a rule against its simplifications. In addition, there is a new graph mining algorithm (Sugiyama et al., 2015) which uses 
                        
                           
                              p
                           
                           
                              F
                           
                        
                      to evaluate dependencies between subgraphs and class values. It seems that the interest in Fisher’s exact test is rising, especially among bioinformaticians, but efficient tools are still lacking.

Asymptotic measures have been preferred in data mining, because they are fast to evaluate and therefore suitable to exhaustive search. It has been implicitly assumed that since the data sets are large, asymptotic measures can be safely used. However, the most significant (non-trivial) dependency rules may be relatively infrequent and the corresponding distributions too skewed to meet the requirements of asymptotic tests. Especially, the popular 
                        
                           
                              χ
                           
                           
                              2
                           
                        
                     -measure can produce very unreliable results, where the discovered dependency rules do not hold in future data. This was shown in extensive cross-validation studies, where the accuracy of the best rules discovered by the 
                        
                           
                              χ
                           
                           
                              2
                           
                        
                     -measure and Fisher’s exact test (
                        
                           
                              p
                           
                           
                              F
                           
                        
                     ) were compared (Hämäläinen, 2012). In these experiments, the 
                        
                           
                              χ
                           
                           
                              2
                           
                        
                     -measure often selected rules which expressed much weaker dependence or even independence in the test set, while the rules found by 
                        
                           
                              p
                           
                           
                              F
                           
                        
                      held always well in test sets. This was not surprising, because Fisher’s exact test is known for its robustness (Lydersen et al., 2009). A more surprising result was the inefficiency of the search with the 
                        
                           
                              χ
                           
                           
                              2
                           
                        
                     -measure, due to its weaker pruning ability. Thus, 
                        
                           
                              p
                           
                           
                              F
                           
                        
                      turned out to be a superior search measure in terms of both accuracy and efficiency of pruning.

The only problem with Fisher’s exact test is that it is computationally laborious. The 
                        
                           
                              p
                           
                           
                              F
                           
                        
                     -value is the sum of the probabilities of the observed and all more extreme contingency tables. In the worst case, the sum may contain 
                        
                           
                              n
                           
                           
                              4
                           
                        
                      terms, which means that the worst case time complexity is 
                        O
                        
                           (
                           n
                           )
                        
                     , where 
                        n
                      is the data size. For example, if 
                        X
                      and 
                        A
                      have frequencies 
                        
                           fr
                        
                        
                           (
                           X
                           )
                        
                        =
                        
                           fr
                        
                        
                           (
                           A
                           )
                        
                        =
                        500
                        
                        000
                      and the frequency of combination 
                        X
                        A
                      is 
                        
                           fr
                        
                        
                           (
                           X
                           A
                           )
                        
                        =
                        300
                        
                        001
                     , then one should evaluate 200 000 terms. In addition, each term involves binomial factors, but they can be evaluated in a constant time, if all factorials have been tabulated.

In this paper, we introduce a family of tight approximations for the exact 
                        
                           
                              p
                           
                           
                              F
                           
                        
                     -value, which can still be calculated in a constant time. The approximations are actually upper bounds for 
                        
                           
                              p
                           
                           
                              F
                           
                        
                     , but when the dependency is sufficiently strong, they give tight approximations to the exact values. In practice, they give identical results with the exact 
                        
                           
                              p
                           
                           
                              F
                           
                        
                     -values, when used for rule ranking.

The main idea of the new approximations is to calculate only the first terms from 
                        
                           
                              p
                           
                           
                              F
                           
                        
                      exactly and estimate an upper bound for the remaining terms. The simplest upper bound evaluates only the first term exactly. It is also intuitively appealing as a goodness measure, because it is reminiscent to the existing dependency measures like the odds ratio. When the dependencies are sufficiently strong (a typical data mining application), the results are also highly accurate. However, if the data set contains only weak and relatively insignificant dependencies, the simplest upper bound may produce too inaccurate results. In this case, one can use tighter upper bounds, which can be adjusted arbitrarily accurate. Nevertheless, there is always a trade-off between speed and accuracy. The more accurate 
                        p
                     -values are wanted, the more terms have to be calculated exactly. Fortunately, the largest terms of 
                        
                           
                              p
                           
                           
                              F
                           
                        
                      are always the first ones, and in practice it is sufficient to calculate only a small number (say, 10) of them exactly.

As far as we know, there does not exist any other computationally fast but accurate approximations to 
                        
                           
                              p
                           
                           
                              F
                           
                        
                     . The likely reason is that statisticians have totally different speed requirements than data miners. If a measure is evaluated just a couple of times, then a second or two is not too long. However, if one has to evaluate the measure a million times, then a millisecond is already too much. In addition, the users of data mining software have got used to short executions times and are reluctant to change into slower but more accurate methods.

The related research has mostly concentrated on developing efficient network algorithms for Fisher’s exact test in the 
                        2
                        ×
                        c
                      (Mehta and Patel, 1980; Requena and Ciudad, 2006) and 
                        r
                        ×
                        c
                      (Mehta and Patel, 1983) cases. However, these algorithms do not offer any solution to the summation problem. There is also an interesting method (Wu, 1993) for improving the accuracy of calculation, by simplifying the binomial coefficients, but it is computationally far too demanding for data mining applications. In practice, the old technique of tabulating factorials (Verbeek and Kroonenberg, 1985) is still the fastest technique to evaluate 
                        
                           
                              p
                           
                           
                              F
                           
                        
                     .

The rest of the paper is organized as follows. In Section  2, the basic concepts and notations are defined. In Section  3, we introduce the new upper bounds and give theoretical error bounds for the resulting approximations. In Section  4, we evaluate the accuracy and computational efficiency of the new upper bounds experimentally. The final conclusions are drawn in Section  5.

Dependency rules are data mining patterns which describe statistical dependencies between sets of attribute–value combinations in data. Given the set of all binary attributes in data, 
                        R
                     , a dependency rule can be expressed as 
                        X
                        =
                        
                           x
                        
                        →
                        A
                        =
                        v
                     , where 
                        X
                        ⊆
                        R
                      is a set of attributes, 
                        A
                        ∈
                        R
                        ∖
                        X
                      is a single attribute, 
                        v
                        ∈
                        
                           {
                           0
                           ,
                           1
                           }
                        
                      is a single truth value, and 
                        X
                        =
                        
                           x
                        
                      is a short-hand notation for the truth value assignment of 
                        X
                     ’s attributes. So, in terms of propositional logic, the rule antecedent (condition part) is a conjunction of atomic propositions and their negations (
                        
                           
                              A
                           
                           
                              i
                           
                        
                     s and 
                        ¬
                        
                           
                              A
                           
                           
                              i
                           
                        
                     s, 
                        
                           
                              A
                           
                           
                              i
                           
                        
                        ∈
                        X
                     ) and the consequence is a single atomic proposition or its negation. In addition, it is required that a genuine dependency rule expresses statistical dependence between the antecedent and the consequence. Conventionally, the rule is represented in the form which shows positive dependence between the condition and the consequence. So, rule 
                        X
                        =
                        
                           x
                        
                        →
                        A
                        =
                        v
                      tells that there is a positive dependency between events 
                        X
                        =
                        
                           x
                        
                      and 
                        A
                        =
                        v
                     , i.e., 
                        P
                        
                           (
                           X
                           =
                           
                              x
                           
                           ,
                           A
                           =
                           v
                           )
                        
                        >
                        P
                        
                           (
                           X
                           =
                           
                              x
                           
                           )
                        
                        P
                        
                           (
                           A
                           =
                           v
                           )
                        
                     , where 
                        P
                      denotes relative frequency (data-based estimate for the real probability).

For clarity, we will assume here a simpler form of rules, where all attributes 
                        
                           
                              A
                           
                           
                              i
                           
                        
                        ∈
                        X
                      are true-valued and the condition can be represented by listing the attributes 
                        
                           (
                           
                              
                                 A
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 A
                              
                              
                                 m
                              
                           
                           )
                        
                     , where 
                        m
                        =
                        
                           |
                           X
                           |
                        
                      is the number of attributes in set 
                        X
                      (i.e., 
                        
                           |
                           ⋅
                           |
                        
                      denotes the cardinality of a set). In addition, we assume (without loss of generality) that the consequence is also true-valued, i.e., 
                        A
                        =
                        1
                     , which can be represented by mere 
                        A
                     . All results can be easily generalized to 
                        A
                        =
                        0
                      by changing 
                        A
                        =
                        1
                      and 
                        A
                        =
                        0
                     . Moreover, we will use a shorthand notation 
                        ¬
                        A
                      for 
                        A
                        =
                        0
                      and 
                        ¬
                        X
                      for the negation of 
                        
                           (
                           
                              
                                 A
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 A
                              
                              
                                 m
                              
                           
                           )
                        
                     , which is 
                        ¬
                        
                           
                              A
                           
                           
                              1
                           
                        
                        ∨
                        ⋯
                        ∨
                        ¬
                        
                           
                              A
                           
                           
                              m
                           
                        
                     .

Each dependency rule 
                        X
                        →
                        A
                      corresponds to a contingency table (Table 1
                     ). This contingency table can be considered as a collapsed version from an 
                        m
                        ×
                        2
                      table, 
                        m
                        =
                        
                           |
                           X
                           |
                        
                     , listing all possible attribute–value combinations 
                        X
                        =
                        
                           x
                        
                     . Now the task of dependency rule mining is the same as searching for the best collapsed contingency tables defined by the set of all attributes in data, 
                        R
                     . Because any attribute set 
                        Y
                        ∈
                        P
                        
                           (
                           R
                           )
                        
                     , 
                        
                           |
                           X
                           |
                        
                        ≥
                        2
                     , can form a dependency rule and any attribute 
                        
                           
                              A
                           
                           
                              i
                           
                        
                        ∈
                        Y
                      can be a consequence, the number of all possible collapsed contingency tables is 
                        
                           
                              ∑
                           
                           
                              i
                              =
                              2
                           
                           
                              k
                           
                        
                        
                           (
                           
                              
                                 k
                              
                              
                                 i
                              
                           
                           )
                        
                        i
                        =
                        k
                        
                           (
                           
                              
                                 2
                              
                              
                                 k
                                 −
                                 1
                              
                           
                           −
                           1
                           )
                        
                     , where 
                        k
                        =
                        
                           |
                           R
                           |
                        
                     .

Let us now use notations 
                        
                           fr
                        
                      for absolute frequency, 
                        P
                      for relative frequency (“probability”), and 
                        n
                      for data size, such that 
                        P
                        
                           (
                           X
                           )
                        
                        =
                        
                           
                              
                                 fr
                              
                              
                                 (
                                 X
                                 )
                              
                           
                           
                              n
                           
                        
                     . The simplest measures for the strength of a statistical dependency rule 
                        X
                        →
                        A
                      are leverage
                     
                        
                           
                              δ
                              
                                 (
                                 X
                                 ,
                                 A
                                 )
                              
                              =
                              P
                              
                                 (
                                 X
                                 A
                                 )
                              
                              −
                              P
                              
                                 (
                                 X
                                 )
                              
                              P
                              
                                 (
                                 A
                                 )
                              
                              ,
                           
                        
                      which measures the absolute deviation from the expected frequency, if 
                        X
                      and 
                        A
                      were actually independent, and lift
                     
                        
                           
                              γ
                              
                                 (
                                 X
                                 ,
                                 A
                                 )
                              
                              =
                              
                                 
                                    P
                                    
                                       (
                                       X
                                       A
                                       )
                                    
                                 
                                 
                                    P
                                    
                                       (
                                       X
                                       )
                                    
                                    P
                                    
                                       (
                                       A
                                       )
                                    
                                 
                              
                              ,
                           
                        
                      which measures the relative deviation from the expected frequency. We note that leverage measures dependency between binary variables 
                     
                        X
                      and 
                        A
                      and has the same absolute value, 
                        
                           |
                           δ
                           
                              (
                              X
                              ,
                              A
                              )
                           
                           |
                        
                     , for all attribute–value combinations 
                        X
                        A
                        ,
                        X
                        ¬
                        A
                        ,
                        ¬
                        X
                        A
                      and 
                        ¬
                        X
                        ¬
                        A
                     . In the case of positive dependency, 
                        δ
                        
                           (
                           X
                           ,
                           A
                           )
                        
                        =
                        δ
                        
                           (
                           ¬
                           X
                           ,
                           ¬
                           A
                           )
                        
                        >
                        0
                      and 
                        δ
                        
                           (
                           X
                           ,
                           ¬
                           A
                           )
                        
                        =
                        δ
                        
                           (
                           ¬
                           X
                           ,
                           A
                           )
                        
                        <
                        0
                     . On the other hand, lift measures dependency between the given attribute values, 
                        X
                        =
                        1
                      and 
                        A
                        =
                        1
                     . Therefore, the lift values 
                        γ
                        
                           (
                           X
                           ,
                           A
                           )
                        
                     , 
                        γ
                        
                           (
                           X
                           ,
                           ¬
                           A
                           )
                        
                        ,
                        γ
                        
                           (
                           ¬
                           X
                           ,
                           A
                           )
                        
                      and 
                        γ
                        
                           (
                           ¬
                           X
                           ,
                           ¬
                           A
                           )
                        
                      are generally unequal, unless all of them are 1 (perfect independence). In the following sections, we will use both leverage and lift frequently in upper bounds and proofs, because they enable intuitive, simple expressions. For example, the 
                        
                           
                              χ
                           
                           
                              2
                           
                        
                     -measure can be expressed as 
                        
                           
                              
                                 
                                    χ
                                 
                                 
                                    2
                                 
                              
                              
                                 (
                                 X
                                 ,
                                 A
                                 )
                              
                              =
                              
                                 
                                    n
                                    δ
                                    
                                       
                                          
                                             (
                                             X
                                             ,
                                             A
                                             )
                                          
                                       
                                       
                                          2
                                       
                                    
                                 
                                 
                                    P
                                    
                                       (
                                       X
                                       )
                                    
                                    P
                                    
                                       (
                                       ¬
                                       X
                                       )
                                    
                                    P
                                    
                                       (
                                       A
                                       )
                                    
                                    P
                                    
                                       (
                                       ¬
                                       A
                                       )
                                    
                                 
                              
                              =
                              n
                              
                                 (
                                 γ
                                 
                                    (
                                    X
                                    ,
                                    A
                                    )
                                 
                                 −
                                 1
                                 )
                              
                              
                                 (
                                 γ
                                 
                                    (
                                    ¬
                                    X
                                    ¬
                                    A
                                    )
                                 
                                 −
                                 1
                                 )
                              
                              .
                           
                        
                     
                  

The 
                        
                           
                              χ
                           
                           
                              2
                           
                        
                     -measure can be used as such as a goodness measure for rule discovery, but one can also determine the corresponding 
                        p
                     -value from the 
                        
                           
                              χ
                           
                           
                              2
                           
                        
                     -distribution with one degree of freedom.

In Fisher’s exact test, the 
                        p
                     -value is estimated directly from a hypergeometric distribution with fixed margins 
                        
                           fr
                        
                        
                           (
                           X
                           )
                        
                        ,
                        
                           fr
                        
                        
                           (
                           ¬
                           X
                           )
                        
                        ,
                        
                        
                           fr
                        
                        
                           (
                           A
                           )
                        
                     , and 
                        
                           fr
                        
                        
                           (
                           ¬
                           A
                           )
                        
                     . In this model, the probability of the observed or a stronger dependency, if 
                        X
                      and 
                        A
                      were actually independent, is defined by equation 
                        
                           
                              
                                 
                                    p
                                 
                                 
                                    F
                                 
                              
                              
                                 (
                                 X
                                 →
                                 A
                                 )
                              
                              =
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    =
                                    0
                                 
                                 
                                    J
                                 
                              
                              
                                 
                                    
                                       (
                                       
                                          
                                             
                                                fr
                                             
                                             
                                                (
                                                X
                                                )
                                             
                                          
                                          
                                             
                                                fr
                                             
                                             
                                                (
                                                X
                                                A
                                                )
                                             
                                             +
                                             i
                                          
                                       
                                       )
                                    
                                    
                                    
                                       (
                                       
                                          
                                             
                                                fr
                                             
                                             
                                                (
                                                ¬
                                                X
                                                )
                                             
                                          
                                          
                                             
                                                fr
                                             
                                             
                                                (
                                                ¬
                                                X
                                                ¬
                                                A
                                                )
                                             
                                             +
                                             i
                                          
                                       
                                       )
                                    
                                 
                                 
                                    
                                       (
                                       
                                          
                                             n
                                          
                                          
                                             
                                                fr
                                             
                                             
                                                (
                                                A
                                                )
                                             
                                          
                                       
                                       )
                                    
                                 
                              
                              ,
                           
                        
                      where 
                        J
                        =
                        min
                        
                           {
                           
                              fr
                           
                           
                              (
                              X
                              ¬
                              A
                              )
                           
                           ,
                           
                              fr
                           
                           
                              (
                              ¬
                              X
                              A
                              )
                           
                           }
                        
                     . This 
                        J
                     , the number of terms (in addition to 
                        
                           
                              p
                           
                           
                              0
                           
                        
                     , the probability of the observed contingency table) is computationally the main problem of 
                        
                           
                              p
                           
                           
                              F
                           
                        
                     . In the worst case, when 
                        P
                        
                           (
                           X
                           )
                        
                        =
                        P
                        
                           (
                           A
                           )
                        
                        =
                        0.5
                      and 
                        P
                        
                           (
                           X
                           A
                           )
                        
                      is near its expected value, 0.25, the number of terms is 
                        
                           
                              n
                           
                           
                              4
                           
                        
                     . This means that the computational complexity of estimating the sum is 
                        O
                        
                           (
                           n
                           )
                        
                     , while the asymptotic measures can be estimated in constant time 
                        O
                        
                           (
                           1
                           )
                        
                     . In practice, the computational burden depends on the data. If the data contains many strong dependencies, the algorithm does not have to estimate weak dependencies which usually involve most terms. Similarly, if the data is sparse (all 
                        P
                        
                           (
                           
                              
                                 A
                              
                              
                                 i
                              
                           
                           )
                        
                     s small), the number of terms is also restricted. However, the algorithm should be able to handle also dense data and sets which contain only weak dependencies.

Before we present solutions to these problems, we should make two important notes on 
                        p
                     -values. First, we recall that 
                        
                           
                              p
                           
                           
                              F
                           
                        
                      and other 
                        p
                     -values are used here only as goodness measures, for ranking patterns. We do not have any good solution how to interpret the extremely small 
                        p
                     -values (like 
                        p
                        =
                        1
                        
                           
                              0
                           
                           
                              −
                              2000
                           
                        
                     ) or when a discovery could be considered “significant”, when millions or billions of patterns are tested either implicitly or explicitly. Second, we note that the hypergeometric model with fixed margins is not the only possible model for estimating the significance of dependency rules. However, the exact tests for unconditional models are computationally even more demanding than Fisher’s exact test. In addition, it is known that Fisher’s exact test approximates the alternative unconditional tests pretty well, when the data is not too small (at least 
                        n
                        =
                        100
                     ) (Andrés et al., 2004).

In this section, we will first introduce two simple upper bounds and analyze their error bounds. After that we generalize the idea and introduce a family of adjustable upper bounds.

The following theorem gives two simple upper bounds which can be used to approximate Fisher’s 
                           
                              
                                 p
                              
                              
                                 F
                              
                           
                         with just one term. The first upper bound is more accurate, but it contains an exponent, which makes it more difficult to evaluate. The latter upper bound is always easy to evaluate and also intuitively appealing. 
                           Theorem 1
                           
                              Let us notate 
                              
                                 
                                    
                                       p
                                    
                                    
                                       F
                                    
                                 
                                 =
                                 
                                    
                                       p
                                    
                                    
                                       0
                                    
                                 
                                 +
                                 
                                    
                                       p
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 ⋯
                                 +
                                 
                                    
                                       p
                                    
                                    
                                       J
                                    
                                 
                               
                              and 
                              
                                 
                                    
                                       q
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             i
                                          
                                       
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             i
                                             −
                                             1
                                          
                                       
                                    
                                 
                                 ,
                                 
                                 i
                                 ≥
                                 1
                              
                              . For a positive dependency rule 
                              
                                 X
                                 →
                                 A
                               
                              with lift 
                              
                                 γ
                                 
                                    (
                                    X
                                    ,
                                    A
                                    )
                                 
                               
                              holds
                              
                                 
                                    
                                       (1)
                                       
                                          
                                             
                                                p
                                             
                                             
                                                F
                                             
                                          
                                          ≤
                                          
                                             
                                                p
                                             
                                             
                                                0
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   1
                                                   −
                                                   
                                                      
                                                         q
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         J
                                                         +
                                                         1
                                                      
                                                   
                                                
                                                
                                                   1
                                                   −
                                                   
                                                      
                                                         q
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                             )
                                          
                                       
                                    
                                    
                                       (2)
                                       
                                          ≤
                                          
                                             
                                                p
                                             
                                             
                                                0
                                             
                                          
                                          
                                             (
                                             1
                                             +
                                             
                                                
                                                   1
                                                   −
                                                   P
                                                   
                                                      (
                                                      A
                                                      )
                                                   
                                                   γ
                                                   
                                                      (
                                                      X
                                                      ,
                                                      A
                                                      )
                                                   
                                                   −
                                                   P
                                                   
                                                      (
                                                      X
                                                      )
                                                   
                                                   γ
                                                   
                                                      (
                                                      X
                                                      ,
                                                      A
                                                      )
                                                   
                                                   +
                                                   P
                                                   
                                                      (
                                                      X
                                                      )
                                                   
                                                   P
                                                   
                                                      (
                                                      A
                                                      )
                                                   
                                                   γ
                                                   
                                                      
                                                         
                                                            (
                                                            X
                                                            ,
                                                            A
                                                            )
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                                
                                                   γ
                                                   
                                                      (
                                                      X
                                                      ,
                                                      A
                                                      )
                                                   
                                                   −
                                                   1
                                                
                                             
                                             )
                                          
                                          .
                                       
                                    
                                 
                              
                           


                        
                           Proof
                           Each term 
                                 
                                    
                                       p
                                    
                                    
                                       i
                                    
                                 
                                 
                                 
                                    (
                                    i
                                    =
                                    0
                                    ,
                                    …
                                    ,
                                    J
                                    )
                                 
                               from 
                                 
                                    
                                       p
                                    
                                    
                                       F
                                    
                                 
                               can be expressed as 
                                 
                                    
                                       p
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       p
                                    
                                    
                                       a
                                       b
                                       s
                                    
                                 
                                 
                                    
                                       t
                                    
                                    
                                       i
                                    
                                 
                              , where 
                                 
                                    
                                       t
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          
                                             fr
                                          
                                          
                                             (
                                             X
                                             )
                                          
                                       
                                       
                                          
                                             fr
                                          
                                          
                                             (
                                             X
                                             A
                                             )
                                          
                                          +
                                          i
                                       
                                    
                                    )
                                 
                                 
                                    (
                                    
                                       
                                          
                                             fr
                                          
                                          
                                             (
                                             ¬
                                             X
                                             )
                                          
                                       
                                       
                                          
                                             fr
                                          
                                          
                                             (
                                             ¬
                                             X
                                             ¬
                                             A
                                             )
                                          
                                          +
                                          i
                                       
                                    
                                    )
                                 
                               and 
                                 
                                    
                                       p
                                    
                                    
                                       a
                                       b
                                       s
                                    
                                 
                                 =
                                 
                                    
                                       
                                          fr
                                       
                                       
                                          (
                                          A
                                          )
                                       
                                       !
                                       
                                          fr
                                       
                                       
                                          (
                                          ¬
                                          A
                                          )
                                       
                                       !
                                    
                                    
                                       n
                                       !
                                    
                                 
                               is constant. Therefore, it is enough to show the result for 
                                 
                                    
                                       p
                                    
                                    
                                       X
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             F
                                          
                                       
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             a
                                             b
                                             s
                                          
                                       
                                    
                                 
                              :


                              
                                 
                                    
                                       p
                                    
                                    
                                       X
                                    
                                 
                                 =
                                 
                                    
                                       t
                                    
                                    
                                       0
                                    
                                 
                                 +
                                 
                                    
                                       t
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 ⋯
                                 +
                                 
                                    
                                       t
                                    
                                    
                                       J
                                    
                                 
                                 =
                                 
                                    
                                       t
                                    
                                    
                                       0
                                    
                                 
                                 +
                                 
                                    
                                       q
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       t
                                    
                                    
                                       0
                                    
                                 
                                 +
                                 
                                    
                                       q
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       q
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       t
                                    
                                    
                                       0
                                    
                                 
                                 +
                                 ⋯
                                 +
                                 
                                    
                                       q
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       q
                                    
                                    
                                       2
                                    
                                 
                                 ⋯
                                 
                                    
                                       q
                                    
                                    
                                       J
                                    
                                 
                                 
                                    
                                       t
                                    
                                    
                                       0
                                    
                                 
                              , where 
                                 
                                    
                                       
                                          
                                             q
                                          
                                          
                                             i
                                          
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   t
                                                
                                                
                                                   i
                                                
                                             
                                          
                                          
                                             
                                                
                                                   t
                                                
                                                
                                                   i
                                                   −
                                                   1
                                                
                                             
                                          
                                       
                                       =
                                       
                                          
                                             
                                                (
                                                
                                                   fr
                                                
                                                
                                                   (
                                                   X
                                                   A
                                                   )
                                                
                                                +
                                                i
                                                −
                                                1
                                                )
                                             
                                             !
                                             
                                                (
                                                m
                                                
                                                   (
                                                   ¬
                                                   X
                                                   ¬
                                                   A
                                                   )
                                                
                                                +
                                                i
                                                −
                                                1
                                                )
                                             
                                             !
                                             
                                                (
                                                m
                                                
                                                   (
                                                   X
                                                   ¬
                                                   A
                                                   )
                                                
                                                −
                                                i
                                                +
                                                1
                                                )
                                             
                                             !
                                             
                                                (
                                                
                                                   fr
                                                
                                                
                                                   (
                                                   ¬
                                                   X
                                                   A
                                                   )
                                                
                                                −
                                                i
                                                +
                                                1
                                                )
                                             
                                             !
                                          
                                          
                                             
                                                (
                                                
                                                   fr
                                                
                                                
                                                   (
                                                   X
                                                   A
                                                   )
                                                
                                                +
                                                i
                                                )
                                             
                                             !
                                             
                                                (
                                                m
                                                
                                                   (
                                                   ¬
                                                   X
                                                   ¬
                                                   A
                                                   )
                                                
                                                +
                                                i
                                                )
                                             
                                             !
                                             
                                                (
                                                m
                                                
                                                   (
                                                   X
                                                   ¬
                                                   A
                                                   )
                                                
                                                −
                                                i
                                                )
                                             
                                             !
                                             
                                                (
                                                
                                                   fr
                                                
                                                
                                                   (
                                                   ¬
                                                   X
                                                   A
                                                   )
                                                
                                                −
                                                i
                                                )
                                             
                                             !
                                          
                                       
                                       =
                                       
                                          
                                             
                                                (
                                                m
                                                
                                                   (
                                                   X
                                                   ¬
                                                   A
                                                   )
                                                
                                                −
                                                i
                                                +
                                                1
                                                )
                                             
                                             
                                                (
                                                
                                                   fr
                                                
                                                
                                                   (
                                                   ¬
                                                   X
                                                   A
                                                   )
                                                
                                                −
                                                i
                                                +
                                                1
                                                )
                                             
                                          
                                          
                                             
                                                (
                                                
                                                   fr
                                                
                                                
                                                   (
                                                   X
                                                   A
                                                   )
                                                
                                                +
                                                i
                                                )
                                             
                                             
                                                (
                                                m
                                                
                                                   (
                                                   ¬
                                                   X
                                                   ¬
                                                   A
                                                   )
                                                
                                                +
                                                i
                                                )
                                             
                                          
                                       
                                       .
                                    
                                 
                              
                           

It is easy to see that 
                                 
                                    
                                       q
                                    
                                    
                                       i
                                    
                                 
                               is decreasing by 
                                 i
                               (its numerator decreases and denominator increases) and, therefore, the largest value of 
                                 
                                    
                                       q
                                    
                                    
                                       i
                                    
                                 
                                 
                                 
                                    (
                                    i
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    J
                                    )
                                 
                               is 
                                 
                                    
                                       q
                                    
                                    
                                       1
                                    
                                 
                              . Because we have a positive dependency, 
                                 
                                    
                                       q
                                    
                                    
                                       i
                                    
                                 
                                 <
                                 1
                              . This is easy to verify by using equality 
                                 P
                                 
                                    (
                                    X
                                    A
                                    )
                                 
                                 P
                                 
                                    (
                                    ¬
                                    X
                                    ¬
                                    A
                                    )
                                 
                                 −
                                 P
                                 
                                    (
                                    X
                                    ¬
                                    A
                                    )
                                 
                                 P
                                 
                                    (
                                    ¬
                                    X
                                    A
                                    )
                                 
                                 =
                                 δ
                                 
                                    (
                                    X
                                    ,
                                    A
                                    )
                                 
                              . Now 
                                 
                                    
                                       
                                          
                                             q
                                          
                                          
                                             1
                                          
                                       
                                       =
                                       
                                          
                                             
                                                fr
                                             
                                             
                                                (
                                                X
                                                ¬
                                                A
                                                )
                                             
                                             
                                                fr
                                             
                                             
                                                (
                                                ¬
                                                X
                                                A
                                                )
                                             
                                          
                                          
                                             
                                                (
                                                
                                                   fr
                                                
                                                
                                                   (
                                                   X
                                                   A
                                                   )
                                                
                                                +
                                                1
                                                )
                                             
                                             
                                                (
                                                
                                                   fr
                                                
                                                
                                                   (
                                                   ¬
                                                   X
                                                   ¬
                                                   A
                                                   )
                                                
                                                +
                                                1
                                                )
                                             
                                          
                                       
                                       <
                                       
                                          
                                             
                                                fr
                                             
                                             
                                                (
                                                X
                                                ¬
                                                A
                                                )
                                             
                                             
                                                fr
                                             
                                             
                                                (
                                                ¬
                                                X
                                                A
                                                )
                                             
                                          
                                          
                                             
                                                fr
                                             
                                             
                                                (
                                                X
                                                A
                                                )
                                             
                                             
                                                fr
                                             
                                             
                                                (
                                                ¬
                                                X
                                                ¬
                                                A
                                                )
                                             
                                          
                                       
                                       =
                                       
                                          
                                             
                                                fr
                                             
                                             
                                                (
                                                X
                                                A
                                                )
                                             
                                             
                                                fr
                                             
                                             
                                                (
                                                ¬
                                                X
                                                ¬
                                                A
                                                )
                                             
                                             −
                                             
                                                
                                                   n
                                                
                                                
                                                   2
                                                
                                             
                                             δ
                                             
                                                (
                                                X
                                                ,
                                                A
                                                )
                                             
                                          
                                          
                                             
                                                fr
                                             
                                             
                                                (
                                                X
                                                A
                                                )
                                             
                                             
                                                fr
                                             
                                             
                                                (
                                                ¬
                                                X
                                                ¬
                                                A
                                                )
                                             
                                          
                                       
                                       ,
                                    
                                 
                               which is 
                                 <
                                 1
                              , when 
                                 δ
                                 
                                    (
                                    X
                                    ,
                                    A
                                    )
                                 
                                 >
                                 0
                               (positive dependency). We get an upper bound 
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             X
                                          
                                       
                                       =
                                       
                                          
                                             t
                                          
                                          
                                             0
                                          
                                       
                                       +
                                       
                                          
                                             q
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             t
                                          
                                          
                                             0
                                          
                                       
                                       +
                                       
                                          
                                             q
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             q
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             t
                                          
                                          
                                             0
                                          
                                       
                                       +
                                       ⋯
                                       +
                                       
                                          
                                             q
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             q
                                          
                                          
                                             2
                                          
                                       
                                       ⋯
                                       
                                          
                                             q
                                          
                                          
                                             J
                                          
                                       
                                       
                                          
                                             t
                                          
                                          
                                             0
                                          
                                       
                                       ≤
                                       
                                          
                                             t
                                          
                                          
                                             0
                                          
                                       
                                       
                                          (
                                          1
                                          +
                                          
                                             
                                                q
                                             
                                             
                                                1
                                             
                                          
                                          +
                                          
                                             
                                                q
                                             
                                             
                                                1
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                q
                                             
                                             
                                                1
                                             
                                             
                                                3
                                             
                                          
                                          +
                                          ⋯
                                          +
                                          
                                             
                                                q
                                             
                                             
                                                1
                                             
                                             
                                                J
                                             
                                          
                                          )
                                       
                                       .
                                    
                                 
                              
                           

Because 
                                 
                                    
                                       q
                                    
                                    
                                       1
                                    
                                 
                                 <
                                 1
                              , the upper bound is a converging geometric series. Its sum is 
                                 
                                    
                                       t
                                    
                                    
                                       0
                                    
                                 
                                 
                                    
                                       1
                                       −
                                       
                                          
                                             q
                                          
                                          
                                             1
                                          
                                          
                                             J
                                             +
                                             1
                                          
                                       
                                    
                                    
                                       1
                                       −
                                       
                                          
                                             q
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                              , which is the first upper bound. On the other hand, 
                                 
                                    
                                       t
                                    
                                    
                                       0
                                    
                                 
                                 
                                    
                                       1
                                       −
                                       
                                          
                                             q
                                          
                                          
                                             1
                                          
                                          
                                             J
                                             +
                                             1
                                          
                                       
                                    
                                    
                                       1
                                       −
                                       
                                          
                                             q
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 ≤
                                 
                                    
                                       
                                          
                                             t
                                          
                                          
                                             0
                                          
                                       
                                    
                                    
                                       1
                                       −
                                       
                                          
                                             q
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       t
                                    
                                    
                                       0
                                    
                                 
                                 
                                    (
                                    1
                                    +
                                    
                                       
                                          
                                             
                                                q
                                             
                                             
                                                1
                                             
                                          
                                       
                                       
                                          1
                                          −
                                          
                                             
                                                q
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                    )
                                 
                              . Let us insert 
                                 
                                    
                                       q
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       
                                          fr
                                       
                                       
                                          (
                                          X
                                          ¬
                                          A
                                          )
                                       
                                       
                                          fr
                                       
                                       
                                          (
                                          ¬
                                          X
                                          A
                                          )
                                       
                                    
                                    
                                       
                                          (
                                          
                                             fr
                                          
                                          
                                             (
                                             X
                                             A
                                             )
                                          
                                          +
                                          1
                                          )
                                       
                                       
                                          (
                                          
                                             fr
                                          
                                          
                                             (
                                             ¬
                                             X
                                             ¬
                                             A
                                             )
                                          
                                          +
                                          1
                                          )
                                       
                                    
                                 
                               and express the frequencies using lift 
                                 γ
                                 
                                    (
                                    X
                                    ,
                                    A
                                    )
                                 
                              . For simplicity, we use notations 
                                 γ
                                 =
                                 γ
                                 
                                    (
                                    X
                                    ,
                                    A
                                    )
                                 
                              , 
                                 x
                                 =
                                 P
                                 
                                    (
                                    X
                                    )
                                 
                               and 
                                 a
                                 =
                                 P
                                 
                                    (
                                    A
                                    )
                                 
                              . Now 
                                 
                                    fr
                                 
                                 
                                    (
                                    X
                                    A
                                    )
                                 
                                 =
                                 n
                                 x
                                 a
                                 γ
                                 ,
                                 
                                    fr
                                 
                                 
                                    (
                                    X
                                    ¬
                                    A
                                    )
                                 
                                 =
                                 n
                                 x
                                 −
                                 n
                                 x
                                 a
                                 γ
                                 ,
                                 
                                    fr
                                 
                                 
                                    (
                                    ¬
                                    X
                                    A
                                    )
                                 
                                 =
                                 n
                                 a
                                 −
                                 n
                                 x
                                 a
                                 γ
                               and 
                                 
                                    fr
                                 
                                 
                                    (
                                    ¬
                                    X
                                    ¬
                                    A
                                    )
                                 
                                 =
                                 n
                                 
                                    (
                                    1
                                    −
                                    x
                                    −
                                    a
                                    +
                                    x
                                    a
                                    γ
                                    )
                                 
                              . We get 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   q
                                                
                                                
                                                   1
                                                
                                             
                                          
                                          
                                             1
                                             −
                                             
                                                
                                                   q
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       =
                                       
                                          
                                             
                                                fr
                                             
                                             
                                                (
                                                X
                                                ¬
                                                A
                                                )
                                             
                                             
                                                fr
                                             
                                             
                                                (
                                                ¬
                                                X
                                                A
                                                )
                                             
                                          
                                          
                                             
                                                (
                                                
                                                   fr
                                                
                                                
                                                   (
                                                   X
                                                   A
                                                   )
                                                
                                                +
                                                1
                                                )
                                             
                                             
                                                (
                                                m
                                                
                                                   (
                                                   ¬
                                                   X
                                                   ¬
                                                   A
                                                   )
                                                
                                                +
                                                1
                                                )
                                             
                                             −
                                             
                                                fr
                                             
                                             
                                                (
                                                X
                                                ¬
                                                A
                                                )
                                             
                                             
                                                fr
                                             
                                             
                                                (
                                                ¬
                                                X
                                                A
                                                )
                                             
                                          
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   n
                                                
                                                
                                                   2
                                                
                                             
                                             x
                                             a
                                             −
                                             
                                                
                                                   n
                                                
                                                
                                                   2
                                                
                                             
                                             x
                                             
                                                
                                                   a
                                                
                                                
                                                   2
                                                
                                             
                                             γ
                                             −
                                             
                                                
                                                   n
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   x
                                                
                                                
                                                   2
                                                
                                             
                                             a
                                             γ
                                             +
                                             
                                                
                                                   n
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   x
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   a
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   γ
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             
                                                
                                                   n
                                                
                                                
                                                   2
                                                
                                             
                                             x
                                             a
                                             γ
                                             +
                                             2
                                             n
                                             x
                                             a
                                             γ
                                             +
                                             n
                                             −
                                             n
                                             x
                                             −
                                             n
                                             a
                                             +
                                             1
                                             −
                                             
                                                
                                                   n
                                                
                                                
                                                   2
                                                
                                             
                                             x
                                             a
                                          
                                       
                                       =
                                       
                                          
                                             n
                                             x
                                             a
                                             −
                                             n
                                             x
                                             
                                                
                                                   a
                                                
                                                
                                                   2
                                                
                                             
                                             γ
                                             −
                                             n
                                             
                                                
                                                   x
                                                
                                                
                                                   2
                                                
                                             
                                             a
                                             γ
                                             +
                                             n
                                             
                                                
                                                   x
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   a
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   γ
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             n
                                             x
                                             a
                                             γ
                                             +
                                             2
                                             x
                                             a
                                             γ
                                             +
                                             1
                                             −
                                             x
                                             −
                                             a
                                             +
                                             1
                                             /
                                             n
                                             −
                                             n
                                             x
                                             a
                                          
                                       
                                       .
                                    
                                 
                              
                           

The denominator is 
                                 >
                                 n
                                 x
                                 a
                                 γ
                                 −
                                 n
                                 x
                                 a
                              , because 
                                 2
                                 x
                                 a
                                 γ
                                 +
                                 1
                                 −
                                 x
                                 −
                                 a
                                 +
                                 1
                                 /
                                 n
                                 =
                                 P
                                 
                                    (
                                    X
                                    A
                                    )
                                 
                                 +
                                 P
                                 
                                    (
                                    ¬
                                    X
                                    ¬
                                    A
                                    )
                                 
                                 +
                                 1
                                 /
                                 n
                                 >
                                 0
                              . Therefore 
                                 
                                    
                                       
                                          
                                             q
                                          
                                          
                                             1
                                          
                                       
                                    
                                    
                                       1
                                       −
                                       
                                          
                                             q
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 ≤
                                 
                                    
                                       n
                                       x
                                       a
                                       
                                          (
                                          1
                                          −
                                          a
                                          γ
                                          −
                                          x
                                          γ
                                          +
                                          x
                                          a
                                          
                                             
                                                γ
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                    
                                    
                                       n
                                       x
                                       a
                                       
                                          (
                                          γ
                                          −
                                          1
                                          )
                                       
                                    
                                 
                                 =
                                 
                                    
                                       1
                                       −
                                       a
                                       γ
                                       −
                                       x
                                       γ
                                       +
                                       x
                                       a
                                       
                                          
                                             γ
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       γ
                                       −
                                       1
                                    
                                 
                              , where the first equality holds only if 
                                 
                                    
                                       q
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 0
                               (i.e., 
                                 P
                                 
                                    (
                                    X
                                    A
                                    )
                                 
                                 =
                                 P
                                 
                                    (
                                    X
                                    )
                                 
                               or 
                                 P
                                 
                                    (
                                    X
                                    A
                                    )
                                 
                                 =
                                 P
                                 
                                    (
                                    A
                                    )
                                 
                              ). Now we have proved 
                                 
                                    
                                       t
                                    
                                    
                                       0
                                    
                                 
                                 
                                    
                                       1
                                       −
                                       
                                          
                                             q
                                          
                                          
                                             1
                                          
                                          
                                             J
                                             +
                                             1
                                          
                                       
                                    
                                    
                                       1
                                       −
                                       
                                          
                                             q
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 ≤
                                 
                                    
                                       t
                                    
                                    
                                       0
                                    
                                 
                                 
                                    (
                                    1
                                    +
                                    
                                       
                                          1
                                          −
                                          a
                                          γ
                                          −
                                          x
                                          γ
                                          +
                                          x
                                          a
                                          
                                             
                                                γ
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          γ
                                          −
                                          1
                                       
                                    
                                    )
                                 
                              , which gives the second upper bound.□

In the following, we will denote the tighter upper bound (which uses the sum of a geometric series) by 
                           
                              ub1
                           
                         and the looser (simpler) upper bound by 
                           
                              ub2
                           
                        . In 
                           
                              ub1
                           
                        , the first two terms of 
                           
                              
                                 p
                              
                              
                                 F
                              
                           
                         are exact and the rest are approximated, while in 
                           
                              ub2
                           
                        , the first term is exact and the rest are approximated. (Note that the sum of a geometric series produces another exact term, 
                           
                              
                                 p
                              
                              
                                 1
                              
                           
                        , in addition to 
                           
                              
                                 p
                              
                              
                                 0
                              
                           
                        .)

We note that 
                           
                              ub2
                           
                         can be expressed equivalently as 
                           
                              ub2
                           
                           =
                           
                              
                                 p
                              
                              
                                 0
                              
                           
                           
                              (
                              
                                 
                                    P
                                    
                                       (
                                       X
                                       A
                                       )
                                    
                                    P
                                    
                                       (
                                       ¬
                                       X
                                       ¬
                                       A
                                       )
                                    
                                 
                                 
                                    δ
                                    
                                       (
                                       X
                                       ,
                                       A
                                       )
                                    
                                 
                              
                              )
                           
                           =
                           
                              
                                 p
                              
                              
                                 0
                              
                           
                           
                              (
                              1
                              +
                              
                                 
                                    P
                                    
                                       (
                                       X
                                       ¬
                                       A
                                       )
                                    
                                    P
                                    
                                       (
                                       ¬
                                       X
                                       A
                                       )
                                    
                                 
                                 
                                    δ
                                    
                                       (
                                       X
                                       ,
                                       A
                                       )
                                    
                                 
                              
                              )
                           
                        , where 
                           δ
                           
                              (
                              X
                              ,
                              A
                              )
                           
                         is the leverage. This is expression is closely related to the odds ratio, 
                           
                              
                                 
                                    odds
                                 
                                 
                                    (
                                    X
                                    ,
                                    A
                                    )
                                 
                                 =
                                 
                                    
                                       P
                                       
                                          (
                                          X
                                          A
                                          )
                                       
                                       P
                                       
                                          (
                                          ¬
                                          X
                                          ¬
                                          A
                                          )
                                       
                                    
                                    
                                       P
                                       
                                          (
                                          X
                                          ¬
                                          A
                                          )
                                       
                                       P
                                       
                                          (
                                          ¬
                                          X
                                          A
                                          )
                                       
                                    
                                 
                                 =
                                 1
                                 +
                                 
                                    
                                       δ
                                       
                                          (
                                          X
                                          ,
                                          A
                                          )
                                       
                                    
                                    
                                       P
                                       
                                          (
                                          X
                                          ¬
                                          A
                                          )
                                       
                                       P
                                       
                                          (
                                          ¬
                                          X
                                          A
                                          )
                                       
                                    
                                 
                                 ,
                              
                           
                         which is often used to measure the strength of a dependency. When we substitute the odds ratio into 
                           
                              ub2
                           
                        , we get an intuitively appealing expression 
                           
                              (3)
                              
                                 
                                    ub2
                                 
                                 =
                                 
                                    
                                       
                                          odds
                                       
                                       
                                          (
                                          X
                                          ,
                                          A
                                          )
                                       
                                       
                                          
                                             p
                                          
                                          
                                             0
                                          
                                       
                                    
                                    
                                       
                                          odds
                                       
                                       
                                          (
                                          X
                                          ,
                                          A
                                          )
                                       
                                       −
                                       1
                                    
                                 
                                 .
                              
                           
                         The odds ratio is not defined, when either 
                           P
                           
                              (
                              X
                              ¬
                              A
                              )
                           
                           =
                           0
                         or 
                           P
                           
                              (
                              ¬
                              X
                              A
                              )
                           
                           =
                           0
                        , but then the cumulative sum contains just one term, 
                           
                              
                                 p
                              
                              
                                 0
                              
                           
                        , and there is no need for upper bounds.

Eq. (3) reveals clearly that the upper bound decreases, when the dependency becomes stronger (odds ratio increases). The following theoretical analysis and empirical results show that in the same time the accuracy of both upper bounds also increases.

In practice, both 
                           
                              ub1
                           
                         and 
                           
                              ub2
                           
                         give tight approximations to Fisher’s 
                           
                              
                                 p
                              
                              
                                 F
                              
                           
                        , when the dependency is sufficiently strong. The error is difficult to bind tightly, but here we present loose upper bounds which already guarantee sufficient accuracy in dependency rule mining.

The following theorem gives a loose upper bound for the absolute error of 
                           
                              ub1
                           
                         for any positive dependency, irrespective of its strength: 
                           Theorem 2
                           
                              When 
                              
                                 
                                    
                                       p
                                    
                                    
                                       F
                                    
                                 
                               
                              of a positive dependency is approximated by 
                              
                                 
                                    ub1
                                 
                              
                              , the absolute error is bounded by
                              
                                 
                                    
                                       
                                          err
                                       
                                       =
                                       
                                          ub1
                                       
                                       −
                                       
                                          
                                             p
                                          
                                          
                                             F
                                          
                                       
                                       <
                                       
                                          
                                             p
                                          
                                          
                                             0
                                          
                                       
                                       
                                          (
                                          
                                             
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                             
                                                1
                                                −
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                          )
                                       
                                       .
                                    
                                 
                              
                           


                        
                           Proof
                           Upper bound 
                                 
                                    ub1
                                 
                               can cause error only, if 
                                 J
                                 >
                                 1
                              . If 
                                 J
                                 =
                                 0
                                 ,
                                 
                                 
                                    ub1
                                 
                                 =
                                 
                                    
                                       p
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 
                                    
                                       p
                                    
                                    
                                       F
                                    
                                 
                               and if 
                                 J
                                 =
                                 1
                              , 
                                 
                                    ub1
                                 
                                 =
                                 
                                    
                                       p
                                    
                                    
                                       0
                                    
                                 
                                 
                                    (
                                    
                                       
                                          1
                                          −
                                          
                                             
                                                q
                                             
                                             
                                                1
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          1
                                          −
                                          
                                             
                                                q
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       p
                                    
                                    
                                       0
                                    
                                 
                                 
                                    (
                                    1
                                    +
                                    
                                       
                                          q
                                       
                                       
                                          1
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       p
                                    
                                    
                                       0
                                    
                                 
                                 +
                                 
                                    
                                       p
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       p
                                    
                                    
                                       F
                                    
                                 
                              . When 
                                 J
                                 >
                                 1
                              , the absolute error is 
                                 
                                    err
                                 
                                 =
                                 
                                    ub1
                                 
                                 −
                                 
                                    
                                       p
                                    
                                    
                                       F
                                    
                                 
                                 =
                                 
                                    
                                       p
                                    
                                    
                                       0
                                    
                                 
                                 
                                    (
                                    1
                                    +
                                    
                                       
                                          q
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    ⋯
                                    +
                                    
                                       
                                          q
                                       
                                       
                                          1
                                       
                                       
                                          J
                                       
                                    
                                    −
                                    1
                                    −
                                    
                                       
                                          q
                                       
                                       
                                          1
                                       
                                    
                                    −
                                    
                                       
                                          q
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          q
                                       
                                       
                                          2
                                       
                                    
                                    −
                                    ⋯
                                    −
                                    
                                       
                                          q
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          q
                                       
                                       
                                          2
                                       
                                    
                                    ⋯
                                    
                                       
                                          q
                                       
                                       
                                          J
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       p
                                    
                                    
                                       0
                                    
                                 
                                 
                                    (
                                    
                                       
                                          q
                                       
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          q
                                       
                                       
                                          1
                                       
                                       
                                          3
                                       
                                    
                                    +
                                    ⋯
                                    
                                       
                                          q
                                       
                                       
                                          1
                                       
                                       
                                          J
                                       
                                    
                                    −
                                    
                                       
                                          q
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          q
                                       
                                       
                                          2
                                       
                                    
                                    −
                                    ⋯
                                    −
                                    
                                       
                                          q
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          q
                                       
                                       
                                          2
                                       
                                    
                                    ⋯
                                    
                                       
                                          q
                                       
                                       
                                          J
                                       
                                    
                                    )
                                 
                              . It has an upper bound 
                                 
                                    err
                                 
                                 <
                                 
                                    
                                       p
                                    
                                    
                                       0
                                    
                                 
                                 
                                    
                                       q
                                    
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 
                                    (
                                    1
                                    +
                                    
                                       
                                          q
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    ⋯
                                    +
                                    
                                       
                                          q
                                       
                                       
                                          1
                                       
                                       
                                          J
                                          −
                                          2
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       p
                                    
                                    
                                       0
                                    
                                 
                                 
                                    
                                       q
                                    
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 
                                    (
                                    
                                       
                                          1
                                          −
                                          
                                             
                                                q
                                             
                                             
                                                1
                                             
                                             
                                                J
                                                −
                                                1
                                             
                                          
                                       
                                       
                                          1
                                          −
                                          
                                             
                                                q
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                    )
                                 
                                 <
                                 
                                    
                                       p
                                    
                                    
                                       0
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             
                                                q
                                             
                                             
                                                1
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          1
                                          −
                                          
                                             
                                                q
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                    )
                                 
                              .□

This leads to the following corollary, which gives good guarantees for the safe use of 
                           
                              ub1
                           
                        : 
                           Corollary 1
                           
                              If 
                              
                                 γ
                                 
                                    (
                                    X
                                    ,
                                    A
                                    )
                                 
                                 ≥
                                 
                                    
                                       1
                                       +
                                       
                                          
                                             5
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                                 ≈
                                 1.62
                               
                              (the golden ratio), then 
                              
                                 
                                    err
                                 
                                 =
                                 
                                    ub1
                                 
                                 −
                                 
                                    
                                       p
                                    
                                    
                                       F
                                    
                                 
                                 <
                                 
                                    
                                       p
                                    
                                    
                                       0
                                    
                                 
                              
                              .
                           


                        
                           Proof
                           In the proof, we use a shorthand notation 
                                 γ
                                 =
                                 γ
                                 
                                    (
                                    X
                                    ,
                                    A
                                    )
                                 
                              . According to Theorem 2, 
                                 
                                    err
                                 
                                 <
                                 
                                    
                                       p
                                    
                                    
                                       0
                                    
                                 
                              , if 
                                 
                                    
                                       q
                                    
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 ≤
                                 1
                                 −
                                 
                                    
                                       q
                                    
                                    
                                       1
                                    
                                 
                              . This is true, when 
                                 
                                    
                                       q
                                    
                                    
                                       1
                                    
                                 
                                 ≤
                                 
                                    
                                       
                                          
                                             5
                                          
                                       
                                       −
                                       1
                                    
                                    
                                       2
                                    
                                 
                              . On the other hand, 
                                 
                                    
                                       q
                                    
                                    
                                       1
                                    
                                 
                                 <
                                 
                                    
                                       1
                                    
                                    
                                       γ
                                    
                                 
                              , when 
                                 γ
                                 >
                                 1
                               (see Lemma 1 in the Appendix). Therefore, a sufficient condition for 
                                 
                                    
                                       q
                                    
                                    
                                       1
                                    
                                 
                                 ≤
                                 
                                    
                                       
                                          
                                             5
                                          
                                       
                                       −
                                       1
                                    
                                    
                                       2
                                    
                                 
                               is that 
                                 
                                    
                                       1
                                    
                                    
                                       γ
                                    
                                 
                                 ≤
                                 
                                    
                                       
                                          
                                             5
                                          
                                       
                                       −
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 ⇔
                                 γ
                                 ≥
                                 
                                    
                                       2
                                    
                                    
                                       
                                          
                                             5
                                          
                                       
                                       −
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             5
                                          
                                       
                                       +
                                       1
                                    
                                    
                                       2
                                    
                                 
                              .□

Interestingly, an identical result holds for the odds ratio, assuming that it has been defined: 
                           Corollary 2
                           
                              If 
                              
                                 P
                                 
                                    (
                                    X
                                    ¬
                                    A
                                    )
                                 
                                 >
                                 0
                                 ,
                                 
                                 P
                                 
                                    (
                                    ¬
                                    X
                                    A
                                    )
                                 
                                 >
                                 0
                               
                              and 
                              
                                 
                                    odds
                                 
                                 
                                    (
                                    X
                                    ,
                                    A
                                    )
                                 
                                 ≥
                                 
                                    
                                       1
                                       +
                                       
                                          
                                             5
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                                 ≈
                                 1.62
                               
                              (the golden ratio), then 
                              
                                 
                                    err
                                 
                                 =
                                 
                                    ub1
                                 
                                 −
                                 
                                    
                                       p
                                    
                                    
                                       F
                                    
                                 
                                 <
                                 
                                    
                                       p
                                    
                                    
                                       0
                                    
                                 
                              
                              .
                           


                        
                           Proof
                           The proof is similar to the previous one, except now we have 
                                 
                                    odds
                                 
                                 
                                    (
                                    X
                                    ,
                                    A
                                    )
                                 
                               instead of 
                                 γ
                                 
                                    (
                                    X
                                    ,
                                    A
                                    )
                                 
                              . Therefore, it suffices to show that 
                                 
                                    
                                       q
                                    
                                    
                                       1
                                    
                                 
                                 <
                                 
                                    
                                       1
                                    
                                    
                                       
                                          odds
                                       
                                       
                                          (
                                          X
                                          ,
                                          A
                                          )
                                       
                                    
                                 
                              , when 
                                 P
                                 
                                    (
                                    X
                                    ¬
                                    A
                                    )
                                 
                                 >
                                 0
                               and 
                                 P
                                 
                                    (
                                    ¬
                                    X
                                    A
                                    )
                                 
                                 >
                                 0
                               (i.e., 
                                 
                                    odds
                                 
                                 
                                    (
                                    X
                                    ,
                                    A
                                    )
                                 
                               has been defined). This is easy, because 
                                 
                                    
                                       q
                                    
                                    
                                       1
                                    
                                 
                                 <
                                 
                                    
                                       P
                                       
                                          (
                                          X
                                          ¬
                                          A
                                          )
                                       
                                       P
                                       
                                          (
                                          ¬
                                          X
                                          A
                                          )
                                       
                                    
                                    
                                       P
                                       
                                          (
                                          X
                                          A
                                          )
                                       
                                       P
                                       
                                          (
                                          ¬
                                          X
                                          ¬
                                          A
                                          )
                                       
                                    
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       
                                          odds
                                       
                                       
                                          (
                                          X
                                          ,
                                          A
                                          )
                                       
                                    
                                 
                              .□

Because the odds ratio is always larger than the lift (see Lemma 2 in the Appendix), we can conclude that the requirement for the lift in Corollary 1 is exaggerated. In fact, by substituting 
                           γ
                           
                              (
                              X
                              ,
                              A
                              )
                           
                           =
                           
                              
                                 P
                                 
                                    (
                                    X
                                    ¬
                                    A
                                    )
                                 
                                 P
                                 
                                    (
                                    ¬
                                    X
                                    A
                                    )
                                 
                              
                              
                                 P
                                 
                                    (
                                    X
                                    )
                                 
                                 P
                                 
                                    (
                                    A
                                    )
                                 
                                 P
                                 
                                    (
                                    ¬
                                    X
                                    ¬
                                    A
                                    )
                                 
                              
                           
                           
                              odds
                           
                           
                              (
                              X
                              ,
                              A
                              )
                           
                         into Corollary 2, we see that for 
                           
                              err
                           
                           <
                           
                              
                                 p
                              
                              
                                 0
                              
                           
                        , it would suffice that 
                           γ
                           
                              (
                              X
                              ,
                              A
                              )
                           
                           ≥
                           
                              
                                 P
                                 
                                    (
                                    X
                                    ¬
                                    A
                                    )
                                 
                                 P
                                 
                                    (
                                    ¬
                                    X
                                    A
                                    )
                                 
                              
                              
                                 P
                                 
                                    (
                                    X
                                    )
                                 
                                 P
                                 
                                    (
                                    A
                                    )
                                 
                                 P
                                 
                                    (
                                    ¬
                                    X
                                    ¬
                                    A
                                    )
                                 
                              
                           
                           
                              
                                 
                                    (
                                    1
                                    +
                                    
                                       
                                          5
                                       
                                    
                                    )
                                 
                              
                              
                                 2
                              
                           
                        , assuming that the odds ratio has been defined.

The simpler upper bound, 
                           
                              ub2
                           
                        , can cause a somewhat larger error than 
                           
                              ub1
                           
                        , but it is even harder to analyze. However, we note that 
                           
                              ub2
                           
                           =
                           
                              
                                 p
                              
                              
                                 F
                              
                           
                         only, when 
                           J
                           =
                           0
                        . When 
                           J
                           =
                           1
                        , there is already some error, but in practice the difference is marginal. The following theorem gives guarantees for the accuracy of 
                           
                              ub2
                           
                        , when 
                           γ
                           ≥
                           2
                        . 
                           Theorem 3
                           
                              When 
                              
                                 
                                    
                                       p
                                    
                                    
                                       F
                                    
                                 
                               
                              of a positive dependency is approximated with 
                              
                                 
                                    ub2
                                 
                               
                              and 
                              
                                 γ
                                 
                                    (
                                    X
                                    ,
                                    A
                                    )
                                 
                                 ≥
                                 2
                              
                              , the absolute error is bounded by 
                              
                                 
                                    err
                                 
                                 =
                                 
                                    ub2
                                 
                                 −
                                 
                                    
                                       p
                                    
                                    
                                       F
                                    
                                 
                                 <
                                 
                                    
                                       p
                                    
                                    
                                       0
                                    
                                 
                              
                              .
                           


                        
                           Proof
                           We use the same shorthand notations as before: 
                                 x
                                 =
                                 P
                                 
                                    (
                                    X
                                    )
                                 
                              , 
                                 a
                                 =
                                 P
                                 
                                    (
                                    A
                                    )
                                 
                                 ,
                                 
                                 γ
                                 =
                                 γ
                                 
                                    (
                                    X
                                    ,
                                    A
                                    )
                                 
                              . The error is 
                                 
                                    err
                                 
                                 =
                                 
                                    ub2
                                 
                                 −
                                 
                                    
                                       p
                                    
                                    
                                       F
                                    
                                 
                                 =
                                 
                                    ub2
                                 
                                 −
                                 
                                    ub1
                                 
                                 +
                                 
                                    ub1
                                 
                                 −
                                 
                                    
                                       p
                                    
                                    
                                       F
                                    
                                 
                              , where 
                                 
                                    ub1
                                 
                                 −
                                 
                                    
                                       p
                                    
                                    
                                       F
                                    
                                 
                                 <
                                 
                                    
                                       p
                                    
                                    
                                       0
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             
                                                q
                                             
                                             
                                                1
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          1
                                          −
                                          
                                             
                                                q
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                    )
                                 
                               by Theorem 2. When 
                                 γ
                                 ≥
                                 2
                              , 
                                 
                                    ub2
                                 
                               (being a decreasing function of 
                                 γ
                              ) is bounded by 
                                 
                                    ub2
                                 
                                 =
                                 
                                    
                                       p
                                    
                                    
                                       0
                                    
                                 
                                 
                                    (
                                    
                                       
                                          γ
                                          
                                             (
                                             1
                                             −
                                             a
                                             −
                                             x
                                             +
                                             x
                                             a
                                             γ
                                             )
                                          
                                       
                                       
                                          γ
                                          −
                                          1
                                       
                                    
                                    )
                                 
                                 ≤
                                 
                                    
                                       p
                                    
                                    
                                       0
                                    
                                 
                                 2
                                 
                                    (
                                    1
                                    −
                                    a
                                    −
                                    x
                                    +
                                    2
                                    x
                                    a
                                    )
                                 
                              . Therefore, the error is bounded by 
                                 
                                    
                                       e
                                       r
                                       r
                                       <
                                       
                                          
                                             p
                                          
                                          
                                             0
                                          
                                       
                                       
                                          (
                                          2
                                          
                                             (
                                             1
                                             −
                                             a
                                             −
                                             x
                                             +
                                             2
                                             x
                                             a
                                             )
                                          
                                          −
                                          
                                             
                                                1
                                                −
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      J
                                                      +
                                                      1
                                                   
                                                
                                             
                                             
                                                1
                                                −
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                             
                                                1
                                                −
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                          )
                                       
                                       =
                                       
                                          
                                             p
                                          
                                          
                                             0
                                          
                                       
                                       
                                          (
                                          2
                                          −
                                          2
                                          a
                                          −
                                          2
                                          x
                                          +
                                          4
                                          x
                                          a
                                          −
                                          
                                             
                                                
                                                   (
                                                   1
                                                   −
                                                   
                                                      
                                                         q
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         q
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         J
                                                         +
                                                         1
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                
                                                   (
                                                   1
                                                   −
                                                   
                                                      
                                                         q
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                          )
                                       
                                       =
                                       
                                          
                                             p
                                          
                                          
                                             0
                                          
                                       
                                       
                                          (
                                          
                                             
                                                2
                                                
                                                   (
                                                   1
                                                   −
                                                   
                                                      
                                                         q
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   )
                                                
                                                −
                                                2
                                                a
                                                
                                                   (
                                                   1
                                                   −
                                                   
                                                      
                                                         q
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   )
                                                
                                                −
                                                2
                                                x
                                                
                                                   (
                                                   1
                                                   −
                                                   
                                                      
                                                         q
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   )
                                                
                                                +
                                                4
                                                x
                                                a
                                                
                                                   (
                                                   1
                                                   −
                                                   
                                                      
                                                         q
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   )
                                                
                                                −
                                                1
                                                +
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      2
                                                   
                                                
                                                +
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      J
                                                      +
                                                      1
                                                   
                                                
                                             
                                             
                                                1
                                                −
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                          )
                                       
                                       =
                                       
                                          
                                             p
                                          
                                          
                                             0
                                          
                                       
                                       
                                          (
                                          
                                             
                                                1
                                                −
                                                2
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      1
                                                   
                                                
                                                +
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      2
                                                   
                                                
                                                +
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      J
                                                      +
                                                      1
                                                   
                                                
                                                −
                                                2
                                                a
                                                
                                                   (
                                                   1
                                                   −
                                                   
                                                      
                                                         q
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   )
                                                
                                                −
                                                2
                                                x
                                                
                                                   (
                                                   1
                                                   −
                                                   
                                                      
                                                         q
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   )
                                                
                                                +
                                                4
                                                x
                                                a
                                                
                                                   (
                                                   1
                                                   −
                                                   
                                                      
                                                         q
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                1
                                                −
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                          )
                                       
                                       .
                                    
                                 
                              
                           

When 
                                 γ
                                 ≥
                                 2
                                 ,
                                 
                                 
                                    
                                       q
                                    
                                    
                                       1
                                    
                                 
                                 ≤
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                              , and thus 
                                 1
                                 −
                                 2
                                 
                                    
                                       q
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       q
                                    
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       q
                                    
                                    
                                       1
                                    
                                    
                                       J
                                       +
                                       1
                                    
                                 
                                 =
                                 1
                                 −
                                 
                                    
                                       q
                                    
                                    
                                       1
                                    
                                 
                                 
                                    (
                                    2
                                    −
                                    
                                       
                                          q
                                       
                                       
                                          1
                                       
                                    
                                    −
                                    
                                       
                                          q
                                       
                                       
                                          1
                                       
                                       
                                          J
                                       
                                    
                                    )
                                 
                                 <
                                 1
                                 −
                                 
                                    
                                       q
                                    
                                    
                                       1
                                    
                                 
                                 
                                    (
                                    2
                                    −
                                    
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    −
                                    
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                                 =
                                 1
                                 −
                                 
                                    
                                       q
                                    
                                    
                                       1
                                    
                                 
                              . Therefore, 
                                 
                                    err
                                 
                                 <
                                 
                                    
                                       p
                                    
                                    
                                       0
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             (
                                             1
                                             −
                                             
                                                
                                                   q
                                                
                                                
                                                   1
                                                
                                             
                                             )
                                          
                                          
                                             (
                                             1
                                             −
                                             2
                                             a
                                             −
                                             2
                                             x
                                             +
                                             4
                                             x
                                             a
                                             )
                                          
                                       
                                       
                                          1
                                          −
                                          
                                             
                                                q
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       p
                                    
                                    
                                       0
                                    
                                 
                                 
                                    (
                                    1
                                    −
                                    2
                                    a
                                    −
                                    2
                                    x
                                    +
                                    4
                                    x
                                    a
                                    )
                                 
                              . The latter factor is always 
                                 ≤
                                 1
                              , because 
                                 2
                                 a
                                 +
                                 2
                                 x
                                 −
                                 4
                                 x
                                 a
                                 =
                                 2
                                 a
                                 
                                    (
                                    1
                                    −
                                    x
                                    )
                                 
                                 +
                                 2
                                 x
                                 
                                    (
                                    1
                                    −
                                    a
                                    )
                                 
                                 ≥
                                 0
                              . Therefore 
                                 
                                    err
                                 
                                 ≤
                                 
                                    
                                       p
                                    
                                    
                                       0
                                    
                                 
                              .□

The previous results (Corollary 1 and Theorem 3) show that even for relatively weak dependencies, the absolute error of both 
                           
                              ub1
                           
                         and 
                           
                              ub2
                           
                         is less than 
                           
                              
                                 p
                              
                              
                                 0
                              
                           
                        . This also means that the approximated 
                           
                              
                                 p
                              
                              
                                 F
                              
                           
                         is at most twice the real 
                           
                              
                                 p
                              
                              
                                 F
                              
                           
                        , because 
                           u
                           b
                           <
                           
                              
                                 p
                              
                              
                                 F
                              
                           
                           +
                           
                              
                                 p
                              
                              
                                 0
                              
                           
                           ≤
                           2
                           
                              
                                 p
                              
                              
                                 F
                              
                           
                        . A 200% upper bound for the relative error may sound large, in comparison to the traditional significance levels like 
                           α
                           =
                           0.05
                         or 
                           α
                           =
                           0.01
                        . However, when 
                           
                              
                                 p
                              
                              
                                 F
                              
                           
                         is used as a goodness measure in data mining (like dependency rule analysis), the values are of a totally different magnitude. For example, when the 100 best dependency rules were searched from seven classical benchmark data sets in Hämäläinen (2012), the largest 
                           ln
                           
                              (
                              
                                 
                                    p
                                 
                                 
                                    F
                                 
                              
                              )
                           
                         value varied from −350 to −73000 depending on the data set. These values correspond to 
                           
                              
                                 p
                              
                              
                                 F
                              
                           
                           =
                           1
                           
                              
                                 0
                              
                              
                                 −
                                 152
                              
                           
                           …
                           1
                           
                              
                                 0
                              
                              
                                 −
                                 31703
                              
                           
                        .

Our experimental results support the theoretical analysis, according to which both upper bounds, 
                           
                              ub1
                           
                         and 
                           
                              ub2
                           
                        , give tight approximations to Fisher’s 
                           
                              
                                 p
                              
                              
                                 F
                              
                           
                        , when the dependency is sufficiently strong. However, if the dependency is weak, we may need a more accurate approximation. A simple solution is to use exact values of the 
                           m
                         first (largest) terms 
                           
                              
                                 p
                              
                              
                                 0
                              
                           
                           +
                           
                              
                                 p
                              
                              
                                 1
                              
                           
                           +
                           ⋯
                           
                              
                                 p
                              
                              
                                 m
                                 −
                                 1
                              
                           
                         and estimate an upper bound only for the smallest terms 
                           
                              
                                 p
                              
                              
                                 m
                              
                           
                           +
                           ⋯
                           
                              
                                 p
                              
                              
                                 J
                              
                           
                         using the sum of a geometric series. (Note that, once again, the sum of the geometric series produces one more exact term, 
                           
                              
                                 p
                              
                              
                                 m
                              
                           
                        , so that we end up with 
                           m
                           +
                           1
                         exact terms.) The resulting approximation and the corresponding error bound are given in the following theorem. We omit the proofs, because they are essentially identical with the previous proofs for Theorems 1 and 2. 
                           Theorem 4
                           
                              For a positive dependency rule 
                              
                                 X
                                 →
                                 A
                               
                              holds
                              
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             F
                                          
                                       
                                       ≤
                                       
                                          
                                             p
                                          
                                          
                                             0
                                          
                                       
                                       +
                                       ⋯
                                       
                                          
                                             p
                                          
                                          
                                             m
                                             −
                                             1
                                          
                                       
                                       +
                                       
                                          
                                             p
                                          
                                          
                                             m
                                          
                                       
                                       
                                          (
                                          
                                             
                                                1
                                                −
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      m
                                                      +
                                                      1
                                                   
                                                   
                                                      J
                                                      −
                                                      m
                                                      +
                                                      1
                                                   
                                                
                                             
                                             
                                                1
                                                −
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      m
                                                      +
                                                      1
                                                   
                                                
                                             
                                          
                                          )
                                       
                                       ,
                                    
                                 
                              
                              where
                              
                                 
                                    
                                       
                                          
                                             q
                                          
                                          
                                             m
                                             +
                                             1
                                          
                                       
                                       =
                                       
                                          
                                             
                                                (
                                                
                                                   fr
                                                
                                                
                                                   (
                                                   X
                                                   ¬
                                                   A
                                                   )
                                                
                                                −
                                                m
                                                )
                                             
                                             
                                                (
                                                
                                                   fr
                                                
                                                
                                                   (
                                                   ¬
                                                   X
                                                   A
                                                   )
                                                
                                                −
                                                m
                                                )
                                             
                                          
                                          
                                             
                                                (
                                                
                                                   fr
                                                
                                                
                                                   (
                                                   X
                                                   A
                                                   )
                                                
                                                +
                                                m
                                                +
                                                1
                                                )
                                             
                                             
                                                (
                                                
                                                   fr
                                                
                                                
                                                   (
                                                   ¬
                                                   X
                                                   ¬
                                                   A
                                                   )
                                                
                                                +
                                                m
                                                +
                                                1
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                              and 
                              
                                 m
                                 +
                                 1
                                 ≤
                                 J
                              
                              . The absolute error of the approximation is
                              
                                 
                                    
                                       
                                          err
                                       
                                       <
                                       
                                          
                                             p
                                          
                                          
                                             l
                                          
                                       
                                       
                                          (
                                          
                                             
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      m
                                                      +
                                                      1
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                             
                                                1
                                                −
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      m
                                                      +
                                                      1
                                                   
                                                
                                             
                                          
                                          )
                                       
                                       .
                                    
                                 
                              
                           

The tail probability, 
                           
                              
                                 p
                              
                              
                                 m
                              
                           
                           +
                           ⋯
                           
                              
                                 p
                              
                              
                                 J
                              
                           
                        , is the same as the 
                           
                              
                                 p
                              
                              
                                 F
                              
                           
                        -value of a hypothetical rule 
                           Y
                           →
                           A
                        , which has 
                           
                              fr
                           
                           
                              (
                              Y
                              )
                           
                           =
                           
                              fr
                           
                           
                              (
                              X
                              )
                           
                         and 
                           
                              fr
                           
                           
                              (
                              Y
                              A
                              )
                           
                           =
                           
                              fr
                           
                           
                              (
                              X
                              A
                              )
                           
                           +
                           m
                        . If we use the lift of this hypothetical rule, we can give another upper bound analogous to 
                           
                              ub2
                           
                        : 
                           Corollary 3
                           
                              For a positive dependency rule 
                              
                                 X
                                 →
                                 A
                               
                              holds
                              
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             F
                                          
                                       
                                       ≤
                                       
                                          
                                             p
                                          
                                          
                                             0
                                          
                                       
                                       +
                                       ⋯
                                       
                                          
                                             p
                                          
                                          
                                             m
                                             −
                                             1
                                          
                                       
                                       +
                                       
                                          
                                             p
                                          
                                          
                                             m
                                          
                                       
                                       
                                          (
                                          1
                                          +
                                          
                                             
                                                1
                                                −
                                                P
                                                
                                                   (
                                                   A
                                                   )
                                                
                                                g
                                                
                                                   (
                                                   X
                                                   ,
                                                   A
                                                   ,
                                                   m
                                                   )
                                                
                                                −
                                                P
                                                
                                                   (
                                                   X
                                                   )
                                                
                                                g
                                                
                                                   (
                                                   X
                                                   ,
                                                   A
                                                   ,
                                                   m
                                                   )
                                                
                                                +
                                                P
                                                
                                                   (
                                                   X
                                                   )
                                                
                                                P
                                                
                                                   (
                                                   A
                                                   )
                                                
                                                g
                                                
                                                   
                                                      
                                                         (
                                                         X
                                                         ,
                                                         A
                                                         ,
                                                         m
                                                         )
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                             
                                                g
                                                
                                                   (
                                                   X
                                                   ,
                                                   A
                                                   ,
                                                   m
                                                   )
                                                
                                                −
                                                1
                                             
                                          
                                          )
                                       
                                       ,
                                    
                                 
                              
                              where
                              
                                 
                                    
                                       g
                                       
                                          (
                                          X
                                          ,
                                          A
                                          ,
                                          m
                                          )
                                       
                                       =
                                       
                                          
                                             n
                                             
                                                (
                                                
                                                   fr
                                                
                                                
                                                   (
                                                   X
                                                   ,
                                                   A
                                                   )
                                                
                                                +
                                                m
                                                )
                                             
                                          
                                          
                                             
                                                fr
                                             
                                             
                                                (
                                                X
                                                )
                                             
                                             
                                                fr
                                             
                                             
                                                (
                                                A
                                                )
                                             
                                          
                                       
                                       =
                                       γ
                                       
                                          (
                                          X
                                          ,
                                          A
                                          )
                                       
                                       +
                                       
                                          
                                             n
                                             m
                                          
                                          
                                             
                                                fr
                                             
                                             
                                                (
                                                X
                                                )
                                             
                                             
                                                fr
                                             
                                             
                                                (
                                                A
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                              and 
                              
                                 m
                                 ≤
                                 J
                                 −
                                 1
                              
                              . This 
                              
                                 g
                                 
                                    (
                                    X
                                    ,
                                    A
                                    ,
                                    m
                                    )
                                 
                               
                              is the lift of hypothetical (not necessarily existent) rule 
                              
                                 Y
                                 →
                                 A
                               
                              which has 
                              
                                 
                                    fr
                                 
                                 
                                    (
                                    Y
                                    )
                                 
                                 =
                                 
                                    fr
                                 
                                 
                                    (
                                    X
                                    )
                                 
                               
                              and 
                              
                                 
                                    fr
                                 
                                 
                                    (
                                    Y
                                    A
                                    )
                                 
                                 =
                                 
                                    fr
                                 
                                 
                                    (
                                    X
                                    A
                                    )
                                 
                                 +
                                 m
                              
                              .
                           

These kinds of generic upper bounds can be adjusted to as accurate as one wishes, but in the same time the computational cost increases. However, in practice, 10 or 15 terms from hundreds or thousands of terms give already very tight approximations even for weak dependencies.

The goal of the experimental evaluation was to evaluate both the accuracy and computational efficiency of the new upper bounds. For this purpose, several experiments were done simulating the requirements of typical pattern mining algorithms. In addition, we evaluated the performance of mining dependency rules from real world data sets using the simplest upper bound, 
                        
                           ub2
                        
                     , instead of exact 
                        
                           
                              p
                           
                           
                              F
                           
                        
                     .

All experiments were run on 2.7 GHz Intel i7-2620M processor having 8 GB RAM and using Linux operating system (Kubuntu 11.10, kernel 3.0). The source code for the C-language implementations of all evaluated functions is available on http://www.cs.uef.fi/~whamalai/fishersourcecode.html.

In the accuracy comparison, we compared the exact 
                           
                              
                                 p
                              
                              
                                 F
                              
                           
                        -value to four upper bounds, 
                           
                              ub1
                           
                        , 
                           
                              ub2
                           
                        , 
                           
                              ub3
                           
                        , 
                           
                              ub4
                           
                        , and the 
                           
                              
                                 χ
                              
                              
                                 2
                              
                           
                        -based approximation, 
                           
                              
                                 p
                              
                              
                                 
                                    
                                       χ
                                    
                                    
                                       2
                                    
                                 
                              
                           
                        . Upper bounds 
                           
                              ub1
                           
                         and 
                           
                              ub3
                           
                         were based on the sum of a geometric series and 
                           
                              ub2
                           
                         and 
                           
                              ub4
                           
                         were their simpler counterparts. Upper bounds 
                           
                              ub1
                           
                         and 
                           
                              ub2
                           
                         contained one exact term (as defined in Theorem 1) and 
                           
                              ub3
                           
                         and 
                           
                              ub4
                           
                         10 exact terms (as defined in Theorem 4 and Corollary 3). The 
                           
                              
                                 χ
                              
                              
                                 2
                              
                           
                        -based approximation was determined by equation 
                           
                              
                                 p
                              
                              
                                 
                                    
                                       χ
                                    
                                    
                                       2
                                    
                                 
                              
                           
                           =
                           
                              
                                 
                                    erfc
                                 
                                 
                                    (
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      χ
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   (
                                                   X
                                                   ,
                                                   A
                                                   )
                                                
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    )
                                 
                              
                              
                                 2
                              
                           
                        , where 
                           
                              erfc
                           
                           =
                           1
                           −
                           e
                           r
                           f
                           
                              (
                              x
                              )
                           
                         is the complementary error function. This is half of the tail probability (the cumulative distribution function of the 
                           
                              
                                 χ
                              
                              
                                 2
                              
                           
                        -distribution with 1 d.f. is simply 
                           
                              erf
                           
                           
                              (
                              
                                 
                                    
                                       
                                          x
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              )
                           
                        ). Because the 
                           
                              
                                 χ
                              
                              
                                 2
                              
                           
                        -test is non-directional, the tail probability estimates 
                           P
                           
                              (
                              δ
                              ≤
                              −
                              δ
                              
                                 (
                                 X
                                 ,
                                 A
                                 )
                              
                              ∨
                              δ
                              ≥
                              δ
                              
                                 (
                                 X
                                 ,
                                 A
                                 )
                              
                              )
                           
                        , i.e. the probability of observing a positive or a negative dependency whose squared leverage is at least 
                           δ
                           
                              
                                 
                                    (
                                    X
                                    ,
                                    A
                                    )
                                 
                              
                              
                                 2
                              
                           
                        , if 
                           X
                         and 
                           A
                         were actually independent. Since we wanted to approximate 
                           P
                           
                              (
                              δ
                              ≥
                              δ
                              
                                 (
                                 X
                                 ,
                                 A
                                 )
                              
                              )
                           
                        , we used the common convention and halved the probability. This is fully correct, if either 
                           P
                           
                              (
                              X
                              )
                           
                         or 
                           P
                           
                              (
                              A
                              )
                           
                         is 0.5 (and thus 
                           P
                           
                              (
                              δ
                              ≤
                              −
                              δ
                              
                                 (
                                 X
                                 ,
                                 A
                                 )
                              
                              )
                           
                           =
                           P
                           
                              (
                              δ
                              ≥
                              δ
                              
                                 (
                                 X
                                 ,
                                 A
                                 )
                              
                              )
                           
                        ), but otherwise it causes some error.

The comparisons were done for both balanced and unbalanced data distributions and for different data sizes. In the balanced case, we used 
                           P
                           
                              (
                              X
                              )
                           
                           =
                           P
                           
                              (
                              A
                              )
                           
                           =
                           0.5
                         and in the unbalanced case 
                           P
                           
                              (
                              X
                              )
                           
                           =
                           0.25
                         and 
                           P
                           
                              (
                              A
                              )
                           
                           =
                           0.20
                        . The data sizes were 
                           n
                           =
                           100
                           ,
                           n
                           =
                           1000
                           ,
                           n
                           =
                           10
                           
                           000
                         and 
                           n
                           =
                           100
                           
                           000
                        . In practice, approximations are not needed with small data sizes (
                           n
                           =
                           100
                         and 
                           n
                           =
                           1000
                        ), but these cases were included to show the behavior of new upper bounds with small 
                           n
                        . For the same reason, we tested also very weak dependencies (nearly independence), which are not be tested in practice.


                        Fig. 1
                         shows the behavior of 
                           
                              
                                 p
                              
                              
                                 F
                              
                           
                        , four upper bounds and the 
                           
                              
                                 χ
                              
                              
                                 2
                              
                           
                        -based approximation as a function of 
                           
                              fr
                           
                           
                              (
                              X
                              A
                              )
                           
                        , when 
                           n
                           =
                           100
                        . Graphs for larger 
                           n
                         are not shown, because then all measures have too wide range to be pictured. However, the behavior is similar: for weak dependencies, the 
                           
                              
                                 p
                              
                              
                                 F
                              
                           
                        -value is relatively large and the errors of 
                           
                              ub1
                           
                        , 
                           
                              ub2
                           
                         and 
                           
                              
                                 p
                              
                              
                                 
                                    
                                       χ
                                    
                                    
                                       2
                                    
                                 
                              
                           
                         are also largest. The more accurate upper bounds, 
                           
                              ub3
                           
                         and 
                           
                              ub4
                           
                        , coincide nicely with the exact 
                           
                              
                                 p
                              
                              
                                 F
                              
                           
                        . When the dependency becomes stronger, the measure values drop very fast and errors diminish.

Absolute errors of 
                           
                              ub1
                           
                           ,
                           …
                           ,
                           
                              ub4
                           
                         and 
                           
                              
                                 p
                              
                              
                                 
                                    
                                       χ
                                    
                                    
                                       2
                                    
                                 
                              
                           
                         are given in Table 2
                         (for 
                           n
                           =
                           100
                         and 
                           n
                           =
                           1000
                        ) and Table 3
                         (for 
                           n
                           =
                           10
                           
                           000
                         and 
                           n
                           =
                           100
                           
                           000
                        ) for selected 
                           
                              fr
                           
                           
                              (
                              X
                              A
                              )
                           
                         values. The corresponding leverage and lift values are also given to characterize the strength of the dependency. The weakest dependencies have leverage 
                           δ
                           =
                           0.01
                         and strongest 
                           δ
                           =
                           0.20
                         (balanced distribution, where 
                           δ
                           ≤
                           0.25
                        ) or 
                           δ
                           =
                           0.13
                         (unbalanced distribution, where 
                           δ
                           ≤
                           0.15
                        ). The corresponding lift values vary from 1.04 to 1.80 (balanced distribution, where 
                           γ
                           ≤
                           2.00
                        ) and from 1.20 to 3.60 (unbalanced distribution, where 
                           γ
                           ≤
                           4.00
                        ), respectively. In addition, the tables give exact 
                           
                              
                                 p
                              
                              
                                 F
                              
                           
                        -values as a reference.

All measures were calculated with a 
                           C
                        -program using type long double for all numeric representations. With the gcc compiler, this corresponds to the 80-bit precision. Still, this precision was not sufficient to determine the exact 
                           
                              
                                 p
                              
                              
                                 F
                              
                           
                         or any of its approximations for the strongest dependencies with 
                           n
                           =
                           100
                           
                           000
                         (an underflow occurred and the values were rounded to zero). Calculating logarithms instead of probabilities would prevent underflows, but there is no 
                           C
                         library function for 
                           
                              log
                           
                           
                              (
                              
                                 erfc
                              
                              )
                           
                        .

The results were very good. For all practically occurring cases, i.e., 
                           n
                           ≥
                           10
                           
                           000
                         (or at least 
                           n
                           ≥
                           1000
                        ) and 
                           δ
                           ≥
                           0.05
                        , even the weakest upper bound, 
                           
                              ub2
                           
                        , gave accurate results. For 
                           δ
                           =
                           0.05
                        , the relative error of 
                           
                              ub2
                           
                         was always less than 1%, and decreased when the dependency became stronger. Here, we noticed an interesting regularity: the relative error decreased approximately to 
                           
                              
                                 1
                              
                              
                                 10
                              
                           
                         when 
                           n
                         became 10-fold. For 
                           δ
                           =
                           0.05
                        , the relative errors were 0.7% (
                           n
                           =
                           1000
                        ), 0.07% (
                           n
                           =
                           10
                           
                           000
                        ) and 0.007% (
                           n
                           =
                           100
                           
                           000
                        ) for the balanced distribution and 0.13% (
                           n
                           =
                           1000
                        ), 0.014% (
                           n
                           =
                           10
                           
                           000
                        ) and 0.0014% (
                           n
                           =
                           100
                           
                           000
                        ) for the unbalanced distribution. Upper bound 
                           
                              ub1
                           
                         performed always better than 
                           
                              ub2
                           
                        , but the difference was surprisingly small, especially for stronger dependencies. Upper bounds 
                           
                              ub3
                           
                         and 
                           
                              ub4
                           
                         were clearly superior and gave excellent approximations even for small 
                           n
                         and the weakest dependencies. This is a noteworthy result, because both upper bounds estimated only 10 terms exactly from over 10000 terms in the case of 
                           n
                           =
                           100
                           
                           000
                        .

The 
                           
                              
                                 χ
                              
                              
                                 2
                              
                           
                        -based approximation 
                           
                              
                                 p
                              
                              
                                 
                                    
                                       χ
                                    
                                    
                                       2
                                    
                                 
                              
                           
                         could compete with the simplest upper bounds, 
                           
                              ub1
                           
                         and 
                           
                              ub2
                           
                        , only for the weakest dependencies (
                           δ
                           =
                           0.01
                        ). With these, the absolute errors were of the same magnitude for 
                           n
                           =
                           100
                        , 
                           n
                           =
                           1000
                         and 
                           n
                           =
                           10
                           
                           000
                        . With 
                           n
                           =
                           100
                         and the balanced distribution, 
                           
                              
                                 p
                              
                              
                                 
                                    
                                       χ
                                    
                                    
                                       2
                                    
                                 
                              
                           
                         was even more accurate than 
                           
                              ub2
                           
                        . However, this performance has little practical meaning, because one would hardly test so weak dependencies. In all other cases (stronger dependencies and even the weakest dependencies for 
                           n
                           =
                           100
                           
                           000
                        ), even the simplest upper bounds clearly outperformed 
                           
                              
                                 p
                              
                              
                                 
                                    
                                       χ
                                    
                                    
                                       2
                                    
                                 
                              
                           
                        .

The inaccuracy of the 
                           
                              
                                 p
                              
                              
                                 
                                    
                                       χ
                                    
                                    
                                       2
                                    
                                 
                              
                           
                        -values was rather surprising. It has been traditionally assumed that the 
                           
                              
                                 χ
                              
                              
                                 2
                              
                           
                        -approximation works well, when the data distribution is balanced, 
                           n
                         is large, and all expected cell counts are sufficiently large (at least 5, according to a classical rule of thumb) (Agresti, 1992). In our experiments, the balanced distribution produced slightly better approximations than the unbalanced one, in comparison to 
                           
                              ub1
                           
                        , but only for weaker dependencies. For stronger dependencies, all 
                           
                              
                                 p
                              
                              
                                 
                                    
                                       χ
                                    
                                    
                                       2
                                    
                                 
                              
                           
                        -values were inaccurate. For the balanced distribution, the 
                           p
                        -value was seriously overestimated and for the unbalanced distribution, seriously underestimated (near zero, resulting an error of size 
                           
                              
                                 p
                              
                              
                                 F
                              
                           
                        ). Small expected cell counts occurred only in one case (the unbalanced distribution with 
                           n
                           =
                           100
                        ), but even there, the smallest expected cell count was 5. Increasing 
                           n
                         did not improve, but, rather, detracted the accuracy.

Cumulating rounding errors could not explain so large discrepancy (orders of magnitude) between 
                           
                              
                                 p
                              
                              
                                 
                                    
                                       χ
                                    
                                    
                                       2
                                    
                                 
                              
                           
                         and 
                           
                              
                                 p
                              
                              
                                 F
                              
                           
                        . However, we checked the correctness of programs carefully and compared the results to other tools. When 
                           n
                           =
                           100
                        , all 
                           
                              
                                 p
                              
                              
                                 
                                    
                                       χ
                                    
                                    
                                       2
                                    
                                 
                              
                           
                        -values could be verified using an online 
                           
                              
                                 χ
                              
                              
                                 2
                              
                           
                        -calculator (Online probability distributions, 2014) and for 
                           n
                           =
                           1000
                        , a similar validation could be done using an on-line erfc-calculator (erfc, 2014). (A similar comparison had been done for 
                           
                              
                                 p
                              
                              
                                 F
                              
                           
                        -values earlier, when the Kingfisher program (Hämäläinen, 2012) was developed.) For larger 
                           n
                         we did not find any correctly working alternative calculator with a sufficient precision. However, since the inaccurate 
                           
                              
                                 p
                              
                              
                                 
                                    
                                       χ
                                    
                                    
                                       2
                                    
                                 
                              
                           
                        -values were correct for 
                           n
                           =
                           100
                         and 
                           n
                           =
                           1000
                        , it is unlikely that the inaccuracies in Table 3 could result from computation errors.

After all these considerations, we can only conclude that the 
                           
                              
                                 χ
                              
                              
                                 2
                              
                           
                        -based approximation to Fisher’ exact test is even more unreliable than previously thought. This is in line with earlier observations made with small data sets, for both 2×2 and general 
                           r
                           ×
                           c
                         tables (Verbeek and Kroonenberg, 1985; Mehta and Patel, 1980, 1983).

In the speed comparison, we compared the execution times for calculating either the exact 
                           
                              
                                 p
                              
                              
                                 F
                              
                           
                        , its upper bound with 1 exact term (
                           
                              ub1
                           
                         and 
                           
                              ub2
                           
                        ), 10 exact terms (
                           
                              ub3
                           
                         and 
                           
                              ub4
                           
                        ) or 100 exact terms (
                           
                              ub5
                           
                         and 
                           
                              ub6
                           
                        ). Upper bounds 
                           
                              ub1
                           
                        , 
                           
                              ub3
                           
                         and 
                           
                              ub5
                           
                         were based on the sum of a geometric series and 
                           
                              ub2
                           
                        , 
                           
                              ub4
                           
                         and 
                           
                              ub6
                           
                         were their simplified versions.

For parameter values, we used 
                           n
                           =
                           100
                           
                           000
                        , 
                           
                              fr
                           
                           
                              (
                              X
                              )
                           
                           =
                           50
                           
                           000
                         and 
                           
                              fr
                           
                           
                              (
                              A
                              )
                           
                           =
                           50
                           
                           000
                        . The 
                           
                              fr
                           
                           
                              (
                              X
                              A
                              )
                           
                         value varied with 
                           J
                           =
                           
                              fr
                           
                           
                              (
                              X
                              )
                           
                           −
                           
                              fr
                           
                           
                              (
                              X
                              A
                              )
                           
                        , when 
                           J
                         went from 1000 to 25000 (and 
                           
                              fr
                           
                           
                              (
                              X
                              A
                              )
                           
                         from 26000 to 50000). We recall that 
                           J
                         is the number of terms in 
                           
                              
                                 p
                              
                              
                                 F
                              
                           
                         which, together with 
                           
                              
                                 p
                              
                              
                                 0
                              
                           
                        , determines the computational cost. We tried also other parameter values, smaller and larger 
                           n
                        , balanced and unbalanced distributions, but these had quite small effect on the execution time of upper bounds or 
                           
                              
                                 p
                              
                              
                                 0
                              
                           
                        . Only upper bounds 
                           
                              ub1
                           
                           ,
                           
                              ub3
                           
                         and 
                           
                              ub5
                           
                         (which use the sum of a geometric series) were somewhat sensitive to 
                           n
                         (faster with smaller 
                           n
                        ). Increasing 
                           n
                         to 10-fold increased the execution of 100000 
                           
                              ub1
                           
                         (
                           
                              ub3
                           
                           ,
                           
                              ub5
                           
                        ) commands by about 10 ms. When computing the exact 
                           
                              
                                 p
                              
                              
                                 F
                              
                           
                        , 
                           J
                         is the most important factor, and 
                           n
                         has only an indirect effect, by allowing larger 
                           J
                        .

For a better precision, the execution times were measured per 100000 repeated calculations of 
                           
                              
                                 p
                              
                              
                                 F
                              
                           
                         or its upper bounds. In addition, the test program itself was repeated three times and the results were averaged. It is quite common that the processor times can vary 5%–10% between consecutive executions.

For all compared measures, we estimated only the sum 
                           Q
                           =
                           1
                           +
                           
                              
                                 q
                              
                              
                                 1
                              
                           
                           +
                           
                              
                                 q
                              
                              
                                 1
                              
                           
                           
                              
                                 q
                              
                              
                                 2
                              
                           
                           +
                           ⋯
                           +
                           
                              
                                 q
                              
                              
                                 1
                              
                           
                           
                              
                                 q
                              
                              
                                 2
                              
                           
                           ⋯
                           
                              
                                 q
                              
                              
                                 J
                              
                           
                        , where 
                           
                              
                                 p
                              
                              
                                 F
                              
                           
                           =
                           
                              
                                 p
                              
                              
                                 0
                              
                           
                           Q
                         (for notations, see the proof of Theorem 1). The reason is that all upper bounds assume that 
                           
                              
                                 p
                              
                              
                                 0
                              
                           
                         is given (as it is in typical mining algorithms). On the other hand, the most effective way to calculate the exact 
                           
                              
                                 p
                              
                              
                                 F
                              
                           
                         is to calculate the heavy binomial coefficients just once (for 
                           
                              
                                 p
                              
                              
                                 0
                              
                           
                        ) and then calculate the 
                           Q
                        -sum recursively. This approach has also other benefits. It allows the use of logarithms instead of 
                           p
                        -values which tend to underflow or factorials and binomial coefficients which tend to overflow. In addition, the logarithms of factorials can be tabulated, which allows fast evaluation of binomial coefficients. The 
                           Q
                        -sum itself does not underflow or overflow, if the calculation is done recursively. These are all well-known tricks which have been used also in the previous algorithms (Verbeek and Kroonenberg, 1985).

The results of the speed comparison are shown in Fig. 2
                        . The execution time for the exact 
                           Q
                        -sum grows linearly as a function of 
                           J
                        , from 0.74 to 19.15 s. All upper bounds took only a constant time: 
                           
                              ub1
                           
                         18 ms, 
                           
                              ub2
                           
                         0.8 ms, 
                           
                              ub3
                           
                         26 ms, 
                           
                              ub4
                           
                         7.5 ms, 
                           
                              ub5
                           
                         94 ms and 
                           
                              ub6
                           
                         76 ms. This means that even the most accurate upper bound, 
                           
                              ub5
                           
                         (using 100 exact terms, which is more than sufficient for any practical purposes), saved 87%–99.5% of the execution time, in comparison to the exact calculation. The fastest and least accurate upper bound, 
                           
                              ub2
                           
                        , took only 0.00004–0.001 of the exact calculation time and the 10-term approximation 
                           
                              ub4
                           
                         (which is practically as accurate as 
                           
                              ub3
                           
                        ) took 0.04%–1.0% of the exact calculation time. These are remarkable savings and certainly needed in exhaustive data mining algorithms, where the number of terms may be even larger (often 
                           n
                         is millions) and the estimation of 
                           
                              
                                 p
                              
                              
                                 F
                              
                           
                         has to be done millions of times.

In these experiments, the objective was to test how the new approximations affect the accuracy and speed when dependency rules are mined from real world data.

The experiments were done using the Kingfisher program (Hämäläinen, 2012) which searches for the best, non-redundant dependency rules with the selected goodness measure. The requirement of non-redundancy means that rule 
                           X
                           →
                           A
                           =
                           v
                         can be selected only if it is better than all more general rules, 
                           Y
                           →
                           A
                           =
                           v
                        , 
                           Y
                           ⊊
                           X
                        , with the selected goodness measure. In practice, this means preference for simpler and stronger (more significant) rules. The default goodness measures is the exact 
                           
                              
                                 p
                              
                              
                                 F
                              
                           
                         (or 
                           ln
                           
                              (
                              
                                 
                                    p
                                 
                                 
                                    F
                                 
                              
                              )
                           
                        , to avoid underflow) which has been implemented using tabulated factorials (i.e., the current state-of-the-art technique). In addition, we implemented the simplest (and least accurate) of the new approximations, 
                           
                              ub2
                           
                           
                           
                              (
                              ln
                              
                                 (
                                 
                                    ub2
                                 
                                 )
                              
                              )
                           
                        , as an alternative search measure.

The data sets are described in Table 4
                        . Heart contains features extracted from cardiac computer tomography (SPECT) images; Mushroom contains descriptions of hypothetical samples corresponding to 23 species of gilled mushrooms; Plants lists all plant species and genera from the USDA plants database and the states of USA and Canada where they occur; and Pumsb contains census data for population and housing from USA. Binarized versions (in the transactional form) are available either in the UCI Machine Learning Repository (UCI Machine Learning Repository, 2013) (Heart and Plants) or the FIMI repository (FIMI, 2010) (Mushroom and Pumsb).

From each data set, we searched for the 100 and 1000 best rules with both exact 
                           
                              
                                 p
                              
                              
                                 F
                              
                           
                         and 
                           
                              ub2
                           
                        . The accuracy of 
                           
                              ub2
                           
                         with respect to the exact 
                           
                              
                                 p
                              
                              
                                 F
                              
                           
                         was evaluated by comparing the discovered rules and their measure values with the given precision (Kingfisher uses float type for storing measure values and prints four significant figures for 
                           ln
                           
                              (
                              p
                              )
                           
                         and 
                           ln
                           
                              (
                              
                                 ub2
                              
                              )
                           
                        ). The speedup by 
                           
                              ub2
                           
                         was more difficult to evaluate, because the total execution time depends on many factors. Therefore, we analyzed the distribution of execution times among program functions using the GNU profiler (gprof) program (Gnu, 2009).

The results of the accuracy evaluation are given in Table 5
                        . In three from four data sets, 
                           
                              ub2
                           
                         produced identical results with 
                           
                              
                                 p
                              
                              
                                 F
                              
                           
                        . Only with the Heart data set, the approximation produced somewhat different results, although the same rules were discovered. When only the 100 best rules were searched for, the rule order was correct, but six rules had a slightly different measure value. However, the inaccuracy was very small, and only the least significant digits differed by one. This is probably due to truncation instead of rounding the measure values in the printing phase. When the 1000 best rules were searched for, the number of such inaccurate measure values was 220. In addition, two rules with equal measure values occurred in a different order in the two result sets.

The results of the speed comparison are given in Table 6
                        . When only the 100 best rules were mined, there were no big differences in the total execution times between the exact and approximated measures. The differences became more apparent with the 1000 best rules. In Plants, the speedup by 
                           
                              ub2
                           
                         was 12 s and in Pumsb, nearly two minutes. The analysis of the distribution of the execution times with the GNU profiler program revealed more dramatic results. Calculation of the exact 
                           
                              
                                 p
                              
                              
                                 F
                              
                           
                         value could take nearly 40% of the execution time and sometimes it was the heaviest subprocess instead of popcount (a routine for efficient frequency counting). The time consumption was smallest with the smallest data set (Heart) and when only the best 100 rules were searched for. This is quite natural because the number of evaluated terms is smallest, when the data set is smallest or the dependencies are strongest (ideally, just one term). With 
                           
                              ub2
                           
                        , the time consumption was always substantially smaller. The savings were 3.8–13.4 percentage points with the search of 100 rules and 4.8–33.0 percentage points with 1000 rules. Sometimes, the measure evaluation with 
                           
                              ub2
                           
                         took so little time that it was rounded to zero (Mushroom, 100).

Overall, the results were very good, especially concerning the accuracy of the new approximation. However, the results should be interpreted cautiously, because Kingfisher searches for only the best, non-redundant rules. Therefore, it has a strong preference for strong rules, even during the search (areas of the search space containing too weak or insignificant rules are pruned out). This means that the evaluated 
                           
                              
                                 p
                              
                              
                                 F
                              
                           
                         values tend to contain only a small number of terms. Consequently, the approximation produces accurate results but the time saving is only modest. It is possible that the situation is different in a general enumeration task, where all sufficiently significant dependency rules are listed. This means a substantially larger number of measure evaluations, also on weaker dependencies with a large number of terms in 
                           
                              
                                 p
                              
                              
                                 F
                              
                           
                        . It is likely that the time savings are much more substantial but in the same time the approximated values are less accurate. As a solution, one should consider using the other introduced upper bounds or select a suitable accuracy level on-line.

@&#CONCLUSIONS@&#

We have introduced a family of upper bounds, which can be used to estimate the 
                        
                           
                              p
                           
                           
                              F
                           
                        
                     -value of Fisher’s exact test fast but accurately. Unlike the 
                        
                           
                              χ
                           
                           
                              2
                           
                        
                     -based approximation, these upper bounds are not sensitive to the data size, distribution, or small expected counts.

All new approximations can be evaluated in a constant time (asymptotic complexity 
                        O
                        
                           (
                           1
                           )
                        
                     ), while the exact calculation of 
                        
                           
                              p
                           
                           
                              F
                           
                        
                      depends on the data size (complexity 
                        O
                        
                           (
                           n
                           )
                        
                     ). In practice, the execution time of the new approximations depends on the desired accuracy level. According to our experimental evaluation, even the simplest upper bound is sufficiently accurate for dependency rule mining purposes and it can be estimated in 0.004%–0.1% of the time needed for exact calculation. For other purposes (testing very weak dependencies), one may need more accurate approximations, which evaluate more terms from 
                        
                           
                              p
                           
                           
                              F
                           
                        
                      exactly. According to our experiments, 10 exact terms produced already highly accurate estimates (more than sufficient for any purposes), but still the computation time was always less than 1% of the exact calculation time. These are remarkable savings in data mining, where millions of patterns can be tested.

The applications of the new approximations are not restricted to dependency rule mining, but there are other mining tasks where fast evaluation of Fisher’s exact test is crucial. For example, in bioinformatics, the interesting patterns are often graph-formed and the search space is even larger than in rule mining. This means an urgent need for fast measure evaluation. In the same time there is a growing interest in the exact tests, because the biological verification of patterns is expensive and should be used only for reliable discoveries. Fisher’s exact test is also used to test the significance of improvement in a more complex pattern against its simplifications. In the set-formed dependency patterns, the number of such tests can be quite prohibitive for exact calculation of 
                        p
                     -values.

So far, we have concerned only the traditional Fisher’s exact test (2×2 case), but it is possible that the new upper bounds (or their generalizations) can be applied in the calculation of the general Fisher’s exact test (
                        r
                        ×
                        c
                      case), as well. In addition, the new upper bounds, especially their simpler versions, as well as the derived error bounds, can be useful in theoretical proofs.

@&#ACKNOWLEDGMENTS@&#

This research was partially supported by the Academy of Finland, grant 258589. A part of the work was done when the author worked in the University of Eastern Finland.


                     
                        Lemma 1
                        
                           If 
                           
                              X
                            
                           and 
                           
                              A
                            
                           are positively dependent, then 
                           
                              
                                 
                                    q
                                 
                                 
                                    1
                                 
                              
                              <
                              
                                 
                                    1
                                 
                                 
                                    γ
                                    
                                       (
                                       X
                                       ,
                                       A
                                       )
                                    
                                 
                              
                           
                           .
                        


                     
                        Proof
                        We use the same shorthand notations as before: 
                              x
                              =
                              P
                              
                                 (
                                 X
                                 )
                              
                           , 
                              a
                              =
                              P
                              
                                 (
                                 A
                                 )
                              
                           , 
                              γ
                              =
                              γ
                              
                                 (
                                 X
                                 ,
                                 A
                                 )
                              
                           , 
                              δ
                              =
                              δ
                              
                                 (
                                 X
                                 ,
                                 A
                                 )
                              
                           . We show that 
                              
                                 
                                    q
                                 
                                 
                                    1
                                 
                              
                              <
                              
                                 
                                    γ
                                    P
                                    
                                       (
                                       ¬
                                       X
                                       ¬
                                       A
                                       )
                                    
                                    −
                                    γ
                                    +
                                    1
                                 
                                 
                                    γ
                                    P
                                    
                                       (
                                       ¬
                                       X
                                       ¬
                                       A
                                       )
                                    
                                 
                              
                              <
                              
                                 
                                    1
                                 
                                 
                                    γ
                                 
                              
                            and, therefore, 
                              
                                 
                                    q
                                 
                                 
                                    1
                                 
                              
                              <
                              
                                 
                                    1
                                 
                                 
                                    γ
                                 
                              
                           . The first inequality holds because 
                              
                                 
                                    
                                       
                                          q
                                       
                                       
                                          1
                                       
                                    
                                    =
                                    
                                       
                                          
                                             fr
                                          
                                          
                                             (
                                             X
                                             ¬
                                             A
                                             )
                                          
                                          
                                             fr
                                          
                                          
                                             (
                                             ¬
                                             X
                                             A
                                             )
                                          
                                       
                                       
                                          
                                             (
                                             
                                                fr
                                             
                                             
                                                (
                                                X
                                                A
                                                )
                                             
                                             +
                                             1
                                             )
                                          
                                          
                                             (
                                             
                                                fr
                                             
                                             
                                                (
                                                ¬
                                                X
                                                ¬
                                                A
                                                )
                                             
                                             +
                                             1
                                             )
                                          
                                       
                                    
                                    <
                                    
                                       
                                          P
                                          
                                             (
                                             X
                                             ¬
                                             A
                                             )
                                          
                                          P
                                          
                                             (
                                             ¬
                                             X
                                             A
                                             )
                                          
                                       
                                       
                                          P
                                          
                                             (
                                             X
                                             A
                                             )
                                          
                                          P
                                          
                                             (
                                             ¬
                                             X
                                             ¬
                                             A
                                             )
                                          
                                       
                                    
                                    =
                                    
                                       
                                          P
                                          
                                             (
                                             X
                                             A
                                             )
                                          
                                          P
                                          
                                             (
                                             ¬
                                             X
                                             ¬
                                             A
                                             )
                                          
                                          −
                                          δ
                                       
                                       
                                          P
                                          
                                             (
                                             X
                                             A
                                             )
                                          
                                          P
                                          
                                             (
                                             ¬
                                             X
                                             ¬
                                             A
                                             )
                                          
                                       
                                    
                                    =
                                    
                                       
                                          P
                                          
                                             (
                                             X
                                             A
                                             )
                                          
                                          P
                                          
                                             (
                                             ¬
                                             X
                                             ¬
                                             A
                                             )
                                          
                                          +
                                          x
                                          a
                                          −
                                          γ
                                          x
                                          a
                                       
                                       
                                          P
                                          
                                             (
                                             X
                                             A
                                             )
                                          
                                          P
                                          
                                             (
                                             ¬
                                             X
                                             ¬
                                             A
                                             )
                                          
                                       
                                    
                                    =
                                    
                                       
                                          γ
                                          x
                                          a
                                          P
                                          
                                             (
                                             ¬
                                             X
                                             ¬
                                             A
                                             )
                                          
                                          +
                                          x
                                          a
                                          −
                                          γ
                                          x
                                          a
                                       
                                       
                                          γ
                                          x
                                          a
                                          P
                                          
                                             (
                                             ¬
                                             X
                                             ¬
                                             A
                                             )
                                          
                                       
                                    
                                    =
                                    
                                       
                                          γ
                                          P
                                          
                                             (
                                             ¬
                                             X
                                             ¬
                                             A
                                             )
                                          
                                          +
                                          1
                                          −
                                          γ
                                       
                                       
                                          γ
                                          P
                                          
                                             (
                                             ¬
                                             X
                                             ¬
                                             A
                                             )
                                          
                                       
                                    
                                    .
                                 
                              
                            The second inequality holds because 
                              
                                 
                                    γ
                                    P
                                    
                                       (
                                       ¬
                                       X
                                       ¬
                                       A
                                       )
                                    
                                    +
                                    1
                                    −
                                    γ
                                 
                                 
                                    γ
                                    P
                                    
                                       (
                                       ¬
                                       X
                                       ¬
                                       A
                                       )
                                    
                                 
                              
                              <
                              
                                 
                                    1
                                 
                                 
                                    γ
                                 
                              
                              ⇔
                              1
                              −
                              
                                 
                                    γ
                                    −
                                    1
                                 
                                 
                                    γ
                                    P
                                    
                                       (
                                       ¬
                                       X
                                       ¬
                                       A
                                       )
                                    
                                 
                              
                              <
                              
                                 
                                    1
                                 
                                 
                                    γ
                                 
                              
                              ⇔
                              1
                              −
                              
                                 
                                    1
                                 
                                 
                                    γ
                                 
                              
                              <
                              
                                 
                                    γ
                                    −
                                    1
                                 
                                 
                                    γ
                                    P
                                    
                                       (
                                       ¬
                                       X
                                       ¬
                                       A
                                       )
                                    
                                 
                              
                              ⇔
                           
                           
                              
                                 
                                    γ
                                    −
                                    1
                                 
                                 
                                    γ
                                 
                              
                              <
                              
                                 
                                    γ
                                    −
                                    1
                                 
                                 
                                    γ
                                    P
                                    
                                       (
                                       ¬
                                       X
                                       ¬
                                       A
                                       )
                                    
                                 
                              
                           , which is always true (
                              P
                              
                                 (
                                 ¬
                                 X
                                 ¬
                                 A
                                 )
                              
                              ≤
                              1
                           ).□


                     
                        Lemma 2
                        
                           When 
                           
                              P
                              
                                 (
                                 X
                                 ¬
                                 A
                                 )
                              
                              >
                              0
                              ,
                              
                              P
                              
                                 (
                                 ¬
                                 X
                                 A
                                 )
                              
                              >
                              0
                           
                           , and 
                           
                              δ
                              
                                 (
                                 X
                                 ,
                                 A
                                 )
                              
                              >
                              0
                            
                           (positive dependency), then 
                           
                              
                                 odds
                              
                              
                                 (
                                 X
                                 ,
                                 A
                                 )
                              
                              >
                              γ
                              
                                 (
                                 X
                                 ,
                                 A
                                 )
                              
                           
                           .
                        


                     
                        Proof
                        We use the same shorthand notations as before: 
                              x
                              =
                              P
                              
                                 (
                                 X
                                 )
                              
                           , 
                              a
                              =
                              P
                              
                                 (
                                 A
                                 )
                              
                              ,
                              
                              δ
                              =
                              δ
                              
                                 (
                                 X
                                 ,
                                 A
                                 )
                              
                           . 
                              
                                 
                                    
                                       
                                          odds
                                       
                                       
                                          (
                                          X
                                          ,
                                          A
                                          )
                                       
                                       =
                                       
                                          
                                             P
                                             
                                                (
                                                X
                                                A
                                                )
                                             
                                             P
                                             
                                                (
                                                ¬
                                                X
                                                ¬
                                                A
                                                )
                                             
                                          
                                          
                                             P
                                             
                                                (
                                                X
                                                ¬
                                                A
                                                )
                                             
                                             P
                                             
                                                (
                                                ¬
                                                X
                                                A
                                                )
                                             
                                          
                                       
                                       >
                                       
                                          
                                             P
                                             
                                                (
                                                X
                                                A
                                                )
                                             
                                          
                                          
                                             x
                                             a
                                          
                                       
                                       =
                                       γ
                                       
                                          (
                                          X
                                          ,
                                          A
                                          )
                                       
                                       ⇔
                                    
                                 
                                 
                                    
                                       x
                                       a
                                       P
                                       
                                          (
                                          ¬
                                          X
                                          ¬
                                          A
                                          )
                                       
                                       >
                                       P
                                       
                                          (
                                          X
                                          ¬
                                          A
                                          )
                                       
                                       P
                                       
                                          (
                                          ¬
                                          X
                                          A
                                          )
                                       
                                       ⇔
                                    
                                 
                                 
                                    
                                       x
                                       a
                                       
                                          [
                                          
                                             (
                                             1
                                             −
                                             x
                                             )
                                          
                                          
                                             (
                                             1
                                             −
                                             a
                                             )
                                          
                                          +
                                          δ
                                          ]
                                       
                                       >
                                       
                                          [
                                          x
                                          
                                             (
                                             1
                                             −
                                             a
                                             )
                                          
                                          −
                                          δ
                                          ]
                                       
                                       
                                          [
                                          
                                             (
                                             1
                                             −
                                             x
                                             )
                                          
                                          a
                                          −
                                          δ
                                          ]
                                       
                                       ⇔
                                    
                                 
                                 
                                    
                                       x
                                       a
                                       
                                          (
                                          1
                                          −
                                          x
                                          )
                                       
                                       
                                          (
                                          1
                                          −
                                          a
                                          )
                                       
                                       +
                                       δ
                                       x
                                       a
                                       >
                                       x
                                       
                                          (
                                          1
                                          −
                                          a
                                          )
                                       
                                       
                                          (
                                          1
                                          −
                                          x
                                          )
                                       
                                       a
                                       −
                                       δ
                                       a
                                       +
                                       δ
                                       x
                                       a
                                       −
                                       δ
                                       x
                                       +
                                       δ
                                       x
                                       a
                                       +
                                       
                                          
                                             δ
                                          
                                          
                                             2
                                          
                                       
                                       ⇔
                                    
                                 
                                 
                                    
                                       0
                                       >
                                       −
                                       δ
                                       a
                                       −
                                       δ
                                       x
                                       +
                                       δ
                                       x
                                       a
                                       +
                                       
                                          
                                             δ
                                          
                                          
                                             2
                                          
                                       
                                       ⇔
                                    
                                 
                                 
                                    
                                       0
                                       >
                                       δ
                                       
                                          (
                                          −
                                          a
                                          −
                                          x
                                          +
                                          x
                                          a
                                          +
                                          δ
                                          )
                                       
                                       =
                                       δ
                                       
                                          (
                                          −
                                          a
                                          −
                                          x
                                          +
                                          P
                                          
                                             (
                                             X
                                             A
                                             )
                                          
                                          )
                                       
                                       .
                                    
                                 
                              
                           
                        

This is always true, because 
                              δ
                              >
                              0
                            (positive dependency) and 
                              −
                              a
                              −
                              x
                              +
                              P
                              
                                 (
                                 X
                                 A
                                 )
                              
                              <
                              0
                              
                              
                                 (
                                 P
                                 
                                    (
                                    X
                                    A
                                    )
                                 
                                 ≤
                                 min
                                 
                                    {
                                    x
                                    ,
                                    a
                                    }
                                 
                                 )
                              
                           .□

@&#REFERENCES@&#

