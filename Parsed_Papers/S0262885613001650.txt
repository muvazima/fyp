@&#MAIN-TITLE@&#Modeling and correction of multipath interference in time of flight cameras

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Multipath Interference (MpI) is a non-systematic error in Time of Flight (ToF) imaging.


                        
                        
                           
                           MpI causes severe distortions in ToF measurements.


                        
                        
                           
                           We propose a ray tracing model that renders realistic ToF images, including MpI.


                        
                        
                           
                           We use nonlinear optimization to find the scene that best renders the input image.


                        
                        
                           
                           We present results with real and synthetic datasets. Error is reduced in all cases.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Time of Flight (ToF)

Multipath Interference (MpI)

Iterative method

@&#ABSTRACT@&#


               Graphical abstract
               
                  
                     
                        
                           
                        
                     
                  
               
            

@&#INTRODUCTION@&#

A Time of Flight (ToF) camera is a sensor that gives, for every pixel, the distance between the camera and the scene in a particular direction. As a result, the camera produces a range image (i.e. 2.5D image) of the scene. To get distances, ToF cameras measure the time-of-flight of a light signal that impacts the scene and returns back to the sensor. In practice, ToF cameras use modulated infrared light sources, measuring time-of-flights with signal phase shifts (see [1]).

Currently, ToF cameras represent one of the leading technologies in range imaging. Commercial ToF cameras have reduced their cost while showing improvements in terms of frame rate, size or accuracy. These improved features make ToF cameras a suitable solution in many applications [2,3] and also a promising candidate for small and portable applications, such as mobile phones or medical endoscopes (see [4,5]). Compared to multiple camera systems, which need complex processing, ToF technology gives fast and reliable 3D information at the hardware level.

However, the main drawback of ToF technology is still the reduced signal to noise ratio it shows in practice. We can distinguish between systematic and non-systematic error sources in ToF technology. Systematic errors have been discussed widely in the literature and most of them can be calibrated (see [6] for a comprehensive survey). Most commercial cameras include hardware compensation for systematic errors. Contrary, non-systematic error sources cannot be calibrated and they depend on the scene. We highlight in this paper the effect of Multipath Interference (MpI) [7]. Due to multiple reflections of the light, a mixture of incoherent light signals arrives at each pixel from different paths apart from the direct path. This effect causes significant distortions in the estimation of depth, especially in the vicinity of corners and convex areas of the scene.

In the literature there are several studies which show the impact of MpI in scenes registered by ToF cameras. In [7] they show how MpI severely distorts corner-like scenes. In [8] they measure the impact of MpI when building maps using mobile robots equipped with ToF cameras.

Several works in the literature propose hardware modifications in the ToF cameras to remove multipath distortion. Falie and Buzuloiu [9,10] propose a method based on infrared structured light. Dorrington et al. [11] propose a method to correct multipath interference using light with two different wavelengths. These works are not able to completely remove MpI and they require hardware modifications in the camera, which are not available in commercial sensors.

Fuchs [12] proposes a method to automatically correct MpI from the camera measurements that does not require hardware modifications. The author proposes a model that predicts the multipath distortion given the information captured by a ToF camera (i.e. signal amplitude and depth for each pixel). The main assumption of Fuchs [12] is that, despite the fact that measurements are contaminated with MpI, the signal distortion can be accurately predicted from them. The main drawback of Fuch's work is precisely the model used to predict MpI. It is not demonstrated under which circumstances the predicted MpI is accurate. In fact, we show in this paper that Fuch's method fails in general scenes when the surfaces have different albedos. In addition Fuch's work requires the adjustment of scene-dependent parameters which is a serious limitation in practice. There are no hints about how to set these parameters and which is their influence in the solution.

This paper proposes a method that removes multipath distortion from the measurements of a ToF camera without any prior knowledge about the scene. We also do not require hardware modifications in the camera. Our method optimizes a cost function whose global minimum represents the correction needed to obtain the real depth of each pixel, free from multipath distortion. We use a radiometric generative model based on certain properties about the radiometry of the camera and the scene. Unlike the proposal of Fuchs [12], our method is accurate given that the required conditions about the scene are approximately met. The results show that our approach is very accurate, even in complex scenes.

The paper is divided in the following sections: Section 2 details the radiometric model used to predict ToF measurements of a known scene. The iterative correction algorithm is presented in Section 3. In Section 4, we show the results for both synthetically generated and real scenes.

Scalar real values are represented in lowercase letters (e.g. a) and complex values, used to define phasors, are denoted by uppercase letters (e.g. S). Bold typography indicates vectors and matrices, using lowercase letters for vectors (e.g. 
                        p) and uppercase letters for matrices (e.g. 
                        A). The vector norm ∥
                        x
                        ∥=(∑
                           i
                        
                        x
                        
                           i
                        
                        2)1/2 is the Euclidean norm. Calligraphic fonts are reserved to define sets or regions:
                           
                              
                                 
                                    R
                                    
                                       p
                                       δ
                                    
                                    =
                                    
                                       
                                          q
                                          
                                          s
                                          .
                                          t
                                          .
                                          
                                          
                                             
                                                p
                                                −
                                                q
                                             
                                          
                                          <
                                          δ
                                       
                                    
                                    .
                                 
                              
                           
                        
                     

We use the Λ modifier in signals, scalar amplitudes or vectors, to represent real measurements that may contain noise and distortions (e.g. Ŝ is the measured magnitude of S). In the same way, predicted magnitudes using generative models are represented by the superscript *. Thus, the term Ŝ
                        ⁎ would refer to the prediction of the magnitude Ŝ.

In this section we present a generative model capable of rendering realistic ToF measurements, including multipath interference. We use general properties of light and surfaces to render realistic images as if they were captured in a ToF camera. The radiometric model developed in this section takes the scene geometry as an input (depth and point normals) and gives the depth map and the intensity image measured in a ToF camera as an output. In Section 3 we use this generative model to find the scene depth map without multipath distortion. We use a fitting algorithm that obtains the scene depth so that the generative model renders a depth image that is as close as possible to the one measured in the ToF camera. The generative model presented in this section is thus the core of our correction algorithm.

The way light propagates, reflects in the scene, and is then captured back in the camera is a very complex phenomenon. It requires details about how surfaces and camera optics reflect and scatter light. In practice, such information is never available. This paper proposes a radiometric model based on the following general assumptions (see [13] for more details):
                        
                           •
                           All the surfaces in the scene are perfect Lambertian reflectors.

A single isotropic infrared light source illuminates the scene. This light source is located at the projection center of the camera. We consider that the distance between the light source and any of the pixels is negligible.

Camera response is linear and narrow band at the infrared wavelength of the light is emitted.

Camera optics corresponds to an ideal pin-hole lens model. Each pixel captures infrared light along a unique line of sight that passes through the optical center.

Despite these assumptions are approximations; they have been extensively used in other areas of computer vision, such as color research [14] or Shape-from-Shading methods [15]. With Lambertian surfaces we avoid the need to know the Bidirectional Reflectance Distribution Functions (BRDFs) of each surface. Unlike the Lambertian model, real BRDFs are difficult to model and require calibration of the surface response under different light conditions and orientations. The assumptions about the camera response and optics are also usual in computer vision [16] and photogrammetry [17]. If properly calibrated, including radial and tangential distortion, a ToF camera fits the pin-hole model with high accuracy. In addition, considering the light source as an isotropic light source at exactly the center of the camera is a common approximation that gives accurate results [12].

To illustrate the radiometric model, Fig. 1
                      shows a scene with two 3-dimensional points p
                     
                        i
                      and p
                     
                        j
                     . These points belong to surfaces with local orientations defined by normal vectors n
                     
                        i
                      and n
                     
                        j
                      and infinitesimal areas dAi
                      and dAj
                     . A ToF camera consisting of two pixels, with indexes i and j, captures the scene. Pixels i and j capture the light reflected from points p
                     
                        i
                      and p
                     
                        j
                      respectively.

The ToF camera emits modulated infrared light and then computes the phase shift between the signal emitted (e.g. signal emitted in the direction of pixel i) and the reflected signal in the scene (e.g. signal received from p
                     
                        i
                     ). We can write the information taken at pixel i using a complex number (i.e. phasorial signal):
                        
                           (1)
                           
                              
                                 
                                    
                                       
                                          S
                                          ^
                                       
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       
                                          a
                                          ^
                                       
                                       i
                                    
                                 
                                 
                                    e
                                    
                                       jΔφ
                                       
                                          
                                             2
                                             ∥
                                             
                                                
                                                   
                                                      p
                                                      ^
                                                   
                                                   i
                                                
                                             
                                             ∥
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        
                     where âi
                      is the signal amplitude and 
                        
                           Δφ
                           
                              
                                 2
                                 ∥
                                 
                                    
                                       
                                          p
                                          ^
                                       
                                       i
                                    
                                 
                                 ∥
                              
                           
                        
                      is the signal phase shift. This phase shift is a linear function of the distance between 
                        
                           
                              
                                 p
                                 ^
                              
                              i
                           
                        
                      and the sensor. In real scenarios, multipath of light distorts phase and amplitude measurements and hence 
                        
                           ∥
                           
                              
                                 
                                    p
                                    ^
                                 
                                 i
                              
                           
                           ∥
                           ≠
                           ∥
                           
                              p
                              i
                           
                           ∥
                        
                     . The time varying cosine representation of phasor (1) is:
                        
                           (2)
                           
                              
                                 
                                    
                                       
                                          s
                                          ^
                                       
                                       i
                                    
                                 
                                 
                                    t
                                 
                                 =
                                 
                                    
                                       
                                          a
                                          ^
                                       
                                       i
                                    
                                 
                                 cos
                                 
                                    
                                       wt
                                       +
                                       Δφ
                                       
                                          
                                             2
                                             ∥
                                             
                                                
                                                   
                                                      p
                                                      ^
                                                   
                                                   i
                                                
                                             
                                             ∥
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        
                     where w is the modulation frequency used for the infrared source.

To model the multipath effect, we decompose the signal Ŝi
                      into the direct path signal (Si
                     ) and the signal due to multipath (Sij
                     ), which in Fig. 1 comes only from point p
                     
                        j
                     .
                        
                           (3)
                           
                              
                                 
                                    
                                       
                                          S
                                          ^
                                       
                                       i
                                    
                                 
                                 =
                                 
                                    S
                                    i
                                 
                                 +
                                 
                                    S
                                    ij
                                 
                                 .
                              
                           
                        
                     
                  

In this model the light travels only once from point p
                     
                        j
                      to p
                     
                        i
                     . In general we can model a higher order of light bounces between the two points. However, that would clearly increase the complexity of the model. We study in Section 4 the impact in the results of considering only the first bounce of the light.

The two components of Ŝi
                      are detailed below:
                        
                           •
                           Direct path term (Si
                              ):

The direct path term of the signal decomposes into the following multiplicative complex factors:
                        
                           (4)
                           
                              
                                 
                                    S
                                    i
                                 
                                 =
                                 
                                    S
                                    0
                                 
                                 
                                 
                                    G
                                    
                                       0
                                       →
                                       i
                                    
                                 
                                 
                                 
                                    G
                                    
                                       i
                                       →
                                       0
                                    
                                 
                                 .
                              
                           
                        
                     
                  

The term S
                     0
                     =
                     aout
                      denotes the light emitted by each pixel. At emission, light is coherent in phase and thus aout
                     
                     ∈ℝ.

The complex number G
                     0→
                        i
                     
                     
                        1
                     
                     
                        1
                        Notation: sub-index x
                           →
                           y means light traveling from x to y, where x (same for y) means point px
                           . p
                           0 is the camera center of projection.
                      models the amplitude decrease and phase shift suffered by the light when traveling from the sensor and impacting with point p
                     
                        i
                     :
                        
                           (5)
                           
                              
                                 
                                    G
                                    
                                       0
                                       →
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ρ
                                          i
                                       
                                       d
                                       
                                          A
                                          i
                                       
                                       cos
                                       
                                          
                                             α
                                             i
                                          
                                       
                                    
                                    
                                       ∥
                                       
                                          p
                                          i
                                       
                                       
                                          ∥
                                          2
                                       
                                    
                                 
                                 
                                    e
                                    
                                       jΔφ
                                       
                                          
                                             ∥
                                             
                                                p
                                                i
                                             
                                             ∥
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                     
                  

Point p
                     
                        i
                      is embedded in a surface with differential area dAi
                      and orientation αi
                      relative to the light source. The term cos(αi
                     ) accounts for the foreshortening effect between the patch and the light source. The albedo factor ρi
                      gives an idea of the amount of energy absorbed by the surface. In fact, the product (S
                     0 
                     G
                     0→
                        i
                     ) can be seen as a new point light source placed at p
                     
                        i
                     .

The term G
                     
                        i
                        →0 models the gain and phase shift when the light at p
                     
                        i
                      comes back to the camera sensor and it is registered on pixel i:
                        
                           (6)
                           
                              
                                 
                                    G
                                    
                                       i
                                       →
                                       0
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ρ
                                          0
                                       
                                       d
                                       
                                          A
                                          0
                                       
                                       cos
                                       
                                          
                                             α
                                             0
                                          
                                       
                                    
                                    
                                       ∥
                                       
                                          p
                                          i
                                       
                                       
                                          ∥
                                          2
                                       
                                    
                                 
                                 
                                    e
                                    
                                       jΔφ
                                       
                                          
                                             ∥
                                             
                                                p
                                                i
                                             
                                             ∥
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        
                     where ρ
                     0
                     dA
                     0 cos(α
                     0) is the linear response of the camera. We assume that α
                     0
                     =0 and dA
                     0 are replaced by pixel area. Jointly with ρ
                     0 they are considered unknown camera gain factors.
                        
                           •
                           Multipath term (Sij
                              ):

The energy that hits point p
                     
                        j
                     , apart from being irradiated towards pixel j (direct path Sj
                      in pixel j), also impacts on pixel i (traveling a distance d
                     
                        ij
                     
                     =∥ p
                     
                        i
                     
                     −
                     p
                     
                        j
                      ∥ and being added to the light that reaches pixel i).

The multipath signal is factorized into the following terms:
                        
                           (7)
                           
                              
                                 
                                    S
                                    ij
                                 
                                 =
                                 
                                    S
                                    0
                                 
                                 
                                 
                                    G
                                    
                                       0
                                       →
                                       j
                                    
                                 
                                 
                                 
                                    G
                                    
                                       j
                                       →
                                       i
                                    
                                 
                                 
                                 
                                    G
                                    
                                       i
                                       →
                                       0
                                    
                                 
                              
                           
                        
                     where G
                     
                        j
                        →
                        i
                      is the amplitude decrease and phase shift of the light suffers when traveling from p
                     
                        j
                      to point p
                     
                        i
                     :
                        
                           (8)
                           
                              
                                 
                                    G
                                    
                                       j
                                       →
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ρ
                                          i
                                       
                                       d
                                       
                                          A
                                          i
                                       
                                       cos
                                       
                                          
                                             α
                                             ij
                                          
                                       
                                    
                                    
                                       d
                                       ij
                                       2
                                    
                                 
                                 
                                    e
                                    
                                       jΔφ
                                       
                                          
                                             d
                                             ij
                                          
                                       
                                    
                                 
                              
                           
                        
                     and αij
                      is the angle between the surface at p
                     
                        i
                      and the vector p
                     
                        i
                     
                     −
                     p
                     
                        j
                     .

The term Ŝi
                      (measured signal in pixel i) can be rewritten using Eqs. (4) and (7):
                        
                           (9)
                           
                              
                                 
                                    
                                       
                                          S
                                          ^
                                       
                                       i
                                    
                                 
                                 =
                                 
                                    S
                                    i
                                 
                                 +
                                 
                                    S
                                    ij
                                 
                                 =
                                 
                                    S
                                    0
                                 
                                 
                                 
                                    
                                       
                                          G
                                          
                                             0
                                             →
                                             i
                                          
                                       
                                       +
                                       
                                          G
                                          
                                             0
                                             →
                                             j
                                          
                                       
                                       
                                       
                                          G
                                          
                                             j
                                             →
                                             i
                                          
                                       
                                    
                                 
                                 
                                    G
                                    
                                       i
                                       →
                                       0
                                    
                                 
                              
                           
                        
                     where the terms S
                     0 and G
                     
                        i
                        →0 are common to both the direct path term and the multipath term.

In a real scenario, the light reflects from a dense amount of points and arrives at point p
                     
                        i
                     . The equations must be integrated over all the geometry of the scene, removing surface differentials. We assume that the scene is piecewise planar between the points measured by the camera pixels. As a consequence, the scene geometry is approximated with planar surface patches. These planar patches are assumed to be small enough to substitute surface differentials for small areas.

The signal received at pixel i can be expressed as:
                        
                           (10)
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                S
                                                ^
                                             
                                             i
                                          
                                       
                                       =
                                       
                                          S
                                          i
                                       
                                       +
                                       
                                          
                                             ∑
                                             
                                                
                                                   p
                                                   j
                                                
                                                ∈
                                                R
                                                
                                                   
                                                      p
                                                      i
                                                   
                                                
                                             
                                          
                                          
                                       
                                       
                                       
                                          S
                                          ij
                                       
                                    
                                 
                                 
                                    
                                       
                                       =
                                       
                                          S
                                          0
                                       
                                       
                                       
                                          
                                             
                                                G
                                                
                                                   0
                                                   →
                                                   i
                                                
                                             
                                             +
                                             
                                                
                                                   ∑
                                                   
                                                      
                                                         p
                                                         j
                                                      
                                                      ∈
                                                      R
                                                      
                                                         
                                                            p
                                                            i
                                                         
                                                      
                                                      )
                                                   
                                                
                                                
                                             
                                             
                                             
                                                G
                                                
                                                   0
                                                   →
                                                   j
                                                
                                             
                                             
                                             
                                                G
                                                
                                                   j
                                                   →
                                                   i
                                                
                                             
                                          
                                       
                                       
                                          G
                                          
                                             i
                                             →
                                             0
                                          
                                       
                                    
                                 
                              
                           
                        
                     where we define 
                        R
                     (p
                     
                        i
                     ) as the set of point (patches) that are reflecting the light towards point p
                     
                        i
                     . This set can be found using surface orientations. A surface patch at point p
                     
                        j
                      with normal vector n
                     
                        j
                      and n
                     
                        i
                     
                     ⊤
                     
                        i
                     
                     n
                     
                        j
                     
                     <0 does not reflect light towards point p
                     
                        i
                     , so it must not be included in 
                        R
                     (p
                     
                        i
                     ).

In this section we propose a method that takes a single ToF image (amplitude and depth maps) and gives as a result the depth of the scene without multipath distortion. Scene geometry is not known “a priori”. Our method can be applied to any scene where the radiometric model of Section 2 is capable of rendering accurate ToF measurements. Section 4 shows that this model can be applied even to scenes containing non-Lambertian objects and high differences in albedos.

The correction algorithm can be summarized as follows: If the true depth values for each pixel are found, then the generative model presented in Section 2 is able to reproduce camera measurements. Following this idea we propose an optimization method that finds the scene depth (free from MpI) that makes the generative model render the closest ToF depth map to camera measurements.


                     Fig. 2
                      graphically shows the signals involved during our correction algorithm. We display a corner-like scene (blue curve) seen by a ToF camera. We denote as Sx
                      the phasor corresponding to the direct path of pixel x. The phase of Sx
                      gives the sought-after true depth of pixel x. Sx
                      is not directly visible from the camera measurements due to noise and multipath. We denote as Ŝx
                      (red curve) the measurements obtained in the camera for pixel x. From Ŝx
                      we can obtain a distorted depth for pixel x, as it is clearly seen in the roundish shape of the red curve. We propose a generative model that predicts ToF measurements 
                        
                           
                              
                                 S
                                 ^
                              
                              x
                              ∗
                           
                        
                      (orange curve) given an estimation of the direct path depths S
                     
                        x
                     
                     ∗ (green curve). The correction algorithm iteratively finds the values of S
                     
                        x
                     
                     ∗ so that 
                        
                           
                              
                                 S
                                 ^
                              
                              x
                              ∗
                           
                        
                      is as close as possible to the measurements 
                        
                           
                              
                                 S
                                 ^
                              
                              x
                           
                        
                      in terms of phase (we show arrows between both signals). If the model is accurate enough, we expect the phase of S
                     
                        x
                     
                     ∗ being also as close as possible to that of Sx
                     , thus obtaining a good estimation of the depth values without MpI.

We describe the 3D point p
                        
                           i
                        , measured at pixel i using a scalar depth correction λi
                        :
                           
                              (11)
                              
                                 
                                    
                                       p
                                       i
                                    
                                    =
                                    
                                       
                                          
                                             p
                                             ^
                                          
                                          i
                                       
                                    
                                    
                                       
                                          1
                                          −
                                          
                                             λ
                                             i
                                          
                                       
                                    
                                    ,
                                 
                              
                           
                        where 
                           
                              
                                 
                                    p
                                    ^
                                 
                                 i
                              
                           
                         is the noisy measurement of p
                        
                           i
                         and λi
                         is the correction in depth along the line of sight of pixel i.

We first present the proposed model using the simplified two point scenario shown in Fig. 1. Let 
                           
                              
                                 
                                    
                                       S
                                       ^
                                    
                                    i
                                    ∗
                                 
                              
                              
                                 
                                    λ
                                    i
                                 
                                 
                                    λ
                                    j
                                 
                              
                           
                         defined as the signal in pixel i in function of depth corrections λi
                         and λj
                         for points p
                        
                           i
                         and p
                        
                           j
                         respectively:
                           
                              (12)
                              
                                 
                                    
                                       
                                          
                                             S
                                             ^
                                          
                                          i
                                          ∗
                                       
                                    
                                    
                                       
                                          λ
                                          i
                                       
                                       
                                          λ
                                          j
                                       
                                    
                                    =
                                    
                                       S
                                       i
                                       ∗
                                    
                                    
                                       
                                          λ
                                          i
                                       
                                    
                                    +
                                    
                                       S
                                       ij
                                       ∗
                                    
                                    
                                       
                                          λ
                                          i
                                       
                                       
                                          λ
                                          j
                                       
                                    
                                    ,
                                 
                              
                           
                        where
                           
                              (13)
                              
                                 
                                    
                                       
                                          
                                          
                                             S
                                             i
                                             ∗
                                          
                                          
                                             
                                                λ
                                                i
                                             
                                          
                                          =
                                          
                                             S
                                             0
                                          
                                          
                                          
                                             G
                                             
                                                0
                                                →
                                                i
                                             
                                             ∗
                                          
                                          
                                          
                                             G
                                             
                                                i
                                                →
                                                0
                                             
                                             ∗
                                          
                                       
                                    
                                    
                                       
                                          
                                             S
                                             ij
                                             ∗
                                          
                                          
                                             
                                                λ
                                                i
                                             
                                             
                                                λ
                                                j
                                             
                                          
                                          =
                                          
                                             S
                                             0
                                          
                                          
                                          
                                             G
                                             
                                                0
                                                →
                                                j
                                             
                                             ∗
                                          
                                          
                                          
                                             G
                                             
                                                j
                                                →
                                                i
                                             
                                             ∗
                                          
                                          
                                          
                                             G
                                             
                                                i
                                                →
                                                0
                                             
                                             ∗
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        
                     

Following Eqs. (5), (6), and (8), the gain terms can be expressed as:
                           
                              (14)
                              
                                 
                                    
                                       G
                                       
                                          0
                                          →
                                          i
                                       
                                       ∗
                                    
                                    =
                                    
                                       
                                          
                                             ρ
                                             i
                                             ∗
                                          
                                          d
                                          
                                             A
                                             i
                                             ∗
                                          
                                          cos
                                          
                                             
                                                α
                                                i
                                                ∗
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         p
                                                         ^
                                                      
                                                      i
                                                   
                                                
                                             
                                             2
                                          
                                          
                                             
                                                
                                                   1
                                                   −
                                                   
                                                      λ
                                                      i
                                                   
                                                
                                             
                                             2
                                          
                                       
                                    
                                    
                                       e
                                       
                                          jΔφ
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            p
                                                            ^
                                                         
                                                         i
                                                      
                                                   
                                                   
                                                      
                                                         1
                                                         −
                                                         
                                                            λ
                                                            i
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (15)
                              
                                 
                                    
                                       G
                                       
                                          i
                                          →
                                          0
                                       
                                       ∗
                                    
                                    =
                                    
                                       
                                          
                                             ρ
                                             0
                                          
                                          d
                                          
                                             A
                                             0
                                          
                                          cos
                                          
                                             
                                                α
                                                0
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         p
                                                         ^
                                                      
                                                      i
                                                   
                                                
                                             
                                             2
                                          
                                          
                                             
                                                
                                                   1
                                                   −
                                                   
                                                      λ
                                                      i
                                                   
                                                
                                             
                                             2
                                          
                                       
                                    
                                    
                                       e
                                       
                                          jΔφ
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            p
                                                            ^
                                                         
                                                         i
                                                      
                                                   
                                                   
                                                      
                                                         1
                                                         −
                                                         
                                                            λ
                                                            i
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        and
                           
                              (16)
                              
                                 
                                    
                                       G
                                       
                                          j
                                          →
                                          i
                                       
                                       ∗
                                    
                                    =
                                    
                                       
                                          
                                             ρ
                                             i
                                             ∗
                                          
                                          d
                                          
                                             A
                                             i
                                             ∗
                                          
                                          cos
                                          
                                             
                                                α
                                                ij
                                                ∗
                                             
                                          
                                       
                                       
                                          
                                             
                                                d
                                                ij
                                                ∗
                                             
                                          
                                          2
                                       
                                    
                                    
                                       e
                                       
                                          jΔφ
                                          
                                             
                                                d
                                                ij
                                                ∗
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 d
                                 ij
                                 ∗
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             p
                                             ^
                                          
                                          i
                                       
                                    
                                    
                                       
                                          1
                                          −
                                          
                                             λ
                                             i
                                          
                                       
                                    
                                    −
                                    
                                       
                                          
                                             p
                                             ^
                                          
                                          j
                                       
                                    
                                    
                                       
                                          1
                                          −
                                          
                                             λ
                                             j
                                          
                                       
                                    
                                 
                              
                           
                        .

In this two-point example, given λi
                         and λj
                        , the proposed model predicts the signals measured in the camera considering a scene with geometry given by 
                           
                              
                                 
                                    
                                       p
                                       ^
                                    
                                    i
                                 
                              
                              ⋅
                              
                                 
                                    1
                                    −
                                    
                                       λ
                                       i
                                    
                                 
                              
                           
                         and 
                           
                              
                                 
                                    
                                       p
                                       ^
                                    
                                    j
                                 
                              
                              ⋅
                              
                                 
                                    1
                                    −
                                    
                                       λ
                                       j
                                    
                                 
                              
                           
                        . There are some parameters that must be known to evaluate functions 
                           
                              
                                 
                                    S
                                    ^
                                 
                                 i
                                 ∗
                              
                           
                        :
                           
                              •
                              Surface albedo factors ρ
                                 
                                    i
                                 
                                 ∗, included in factors G
                                 
                                    i
                                    →
                                    j
                                 
                                 ∗. These parameters are scene-dependent. Their estimation is explained below.

Camera response and gain, included in terms G
                                 
                                    i
                                    →0
                                 ∗. In general, unless the camera response is calibrated using light and surface patterns, those parameters are unknown. As it is explained later, the way the generative model is matched to the measurements makes unnecessary to obtain these parameters.

Including surface albedos ρi
                            in the model is mandatory as surfaces involved in a real scene have very different albedos (e.g. black and white colors in a checkerboard). In most cases, albedo determination from images is a difficult task in computer vision, especially with uncontrolled light scenarios (e.g. see [18,19]).

In this case we propose a method to approximate the scene albedos using ToF measurements and taking into account the radiometric model detailed in Section 2. Let ρi
                            be the albedo factor for the surface detected at pixel i. This factor can be expressed as the product between a reflectivity term ρ
                           
                              i
                           
                           
                              rel
                            and a global scale factor ψ:
                              
                                 (17)
                                 
                                    
                                       
                                          ρ
                                          i
                                       
                                       =
                                       ψ
                                       ⋅
                                       
                                          ρ
                                          i
                                          rel
                                       
                                       ,
                                       ∀
                                       i
                                       .
                                    
                                 
                              
                           
                        

Depth and normals of each pixel are used to decouple foreshortening and amplitude fall-off to obtain a value of ρ
                              
                                 i
                              
                              
                                 rel
                               in terms of the amplitude detected at pixel i, namely 
                                 
                                    
                                       
                                          a
                                          ^
                                       
                                       i
                                    
                                 
                              :
                                 
                                    (18)
                                    
                                       
                                          
                                             ρ
                                             i
                                             rel
                                          
                                          =
                                          
                                             
                                                
                                                   a
                                                   ^
                                                
                                                i
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            p
                                                            ^
                                                         
                                                         i
                                                      
                                                   
                                                
                                                4
                                             
                                             
                                                d
                                                
                                                   A
                                                   i
                                                
                                                cos
                                                
                                                   
                                                      α
                                                      i
                                                   
                                                
                                                
                                                   k
                                                   n
                                                
                                             
                                          
                                       
                                    
                                 
                              where ρ
                              
                                 i
                              
                              
                                 rel
                               is indeed the amplitude of the signal arriving at pixel i in a common plane parallel to the camera sensor (we use the plane in the coordinate origin). The scalar kn
                               is chosen so that ρ
                              
                                 i
                              
                              
                                 rel
                              
                              ≤1.

The global scale factor depends on the camera and light source used. ψ is a camera-dependent parameter and it can be calibrated. In Section 4 we describe a calibration algorithm.

Finally, we show in Section 4 that despite the fact that albedos are computed using noisy image amplitudes 
                                 
                                    
                                       
                                          a
                                          ^
                                       
                                       i
                                    
                                 
                              , they are fair enough to get accurate depth corrections.

In this section we present an optimization approach that fits the generative method to ToF measurements, obtaining as a consequence the scene without MpI.

In Fig. 3
                            we show a flowchart that explains the fitting algorithm; note that we refer to the involved signals using the same color assignment as used in Fig. 2. The inputs are depth and amplitude measurements taken from a single frame capture in the sensor (green box in the diagram). We call “Solution(k)” in the diagram to the estimation of the depths without MpI at iteration k of the algorithm. At k
                           =0, sensor measurements are used as initialization. Given “Solution(k)”, we simulate the depths with MpI. This is called “Solution(k)+MpI” in the diagram. We use the radiometric model explained before to simulate MpI, using amplitude measurements to estimate albedos. The iterations stop when the differences in depth between the measurements and “Solution(k)+MpI” are below some predefined threshold γ. After the method stops, “Solution(k)” contains the depths for each pixel without multipath errors.

To have guarantees of convergence we implement diagram 3 using a cost function that is optimized with iterative methods. The cost function involves the depth correction of all pixels in the image:
                              
                                 (19)
                                 
                                    
                                       Λ
                                       =
                                       
                                          
                                             λ
                                             1
                                          
                                          …
                                          
                                             λ
                                             N
                                          
                                       
                                       ,
                                    
                                 
                              
                           grouped in the column vector Λ for an image with N pixels. We propose the following sum of squares cost function:
                              
                                 (20)
                                 
                                    
                                       
                                          
                                             min
                                             ︸
                                          
                                          
                                             Λ
                                          
                                       
                                       
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   N
                                                
                                                
                                             
                                             
                                             
                                                
                                                   
                                                      
                                                         f
                                                         i
                                                      
                                                      
                                                         Λ
                                                      
                                                   
                                                
                                                2
                                             
                                          
                                       
                                    
                                 
                              
                           where:
                              
                                 (21)
                                 
                                    
                                       
                                          
                                             
                                                f
                                                i
                                             
                                             
                                                Λ
                                             
                                             =
                                             ϕ
                                             
                                                
                                                   
                                                      
                                                         S
                                                         ^
                                                      
                                                      i
                                                   
                                                
                                             
                                             −
                                             ϕ
                                             
                                                
                                                   
                                                      
                                                         
                                                            S
                                                            ^
                                                         
                                                         i
                                                         ∗
                                                      
                                                   
                                                   
                                                      Λ
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                             =
                                             ϕ
                                             
                                                
                                                   
                                                      
                                                         S
                                                         ^
                                                      
                                                      i
                                                   
                                                
                                             
                                             −
                                             ϕ
                                             
                                                
                                                   
                                                      S
                                                      i
                                                      ∗
                                                   
                                                   
                                                      
                                                         λ
                                                         i
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         ∑
                                                         
                                                            j
                                                            ∈
                                                            
                                                               R
                                                               i
                                                            
                                                         
                                                      
                                                      
                                                   
                                                   
                                                   
                                                      S
                                                      ij
                                                      ∗
                                                   
                                                   
                                                      
                                                         λ
                                                         i
                                                      
                                                      
                                                         λ
                                                         j
                                                      
                                                   
                                                
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           and ϕ(S) is the phase of the phasor S.

As is displayed in Fig. 4
                            the optimization approach is forcing every two phasors Ŝi
                            and 
                              
                                 
                                    
                                       S
                                       ^
                                    
                                    i
                                    ∗
                                 
                              
                            to be as parallel as possible.

The cost function (20) is non-linear and non-convex in terms of the unknown vector Λ. In this paper a numerical optimization algorithm is used to reach a local minimum of the cost. In particular the Levenberg–Marquardt algorithm is proposed, using as initialization Λ
                           =0.

Although the global minimum of the cost is not ensured, in Section 4 we show with experiments that the ToF measurements give a good initialization so that only a few iterations are needed to reach the sought-after local minimum.

@&#RESULTS@&#

@&#IMPLEMENTATION DETAILS@&#

In this section we give practical hints and methods to calibrate ψ from checkerboard patterns and the algorithm we propose to compute surface normals and areas.

The value of ψ depends on camera parameters (e.g. exposition time or camera response), and the light intensity. The global scale factor ψ does not depend on the scene under consideration. It is thus a parameter that we can calibrate independently in a calibration process that we describe with the following steps:
                              
                                 1.
                                 We use calibration patterns to obtain a set of 3D points from which we know the ground truth and the multipath distortion at every point. We use two planes with a chessboard texture where we know distances dij
                                     between corner points (see Fig. 5
                                    ). These planes must show multipath effect so that the model can predict ψ. The best way is to create a corner with the two planes.

Let 
                                       
                                          
                                             
                                                p
                                                ^
                                             
                                             i
                                          
                                       
                                     be the measurements of the 3D coordinates of the 3D point corresponding to pixel i and 
                                       
                                          
                                             p
                                             i
                                          
                                          =
                                          
                                             
                                                
                                                   p
                                                   ^
                                                
                                                i
                                             
                                          
                                          
                                             
                                                1
                                                −
                                                
                                                   λ
                                                   i
                                                
                                             
                                          
                                       
                                     the correction of that point. Using the fact that we know distances in the pattern we can write:
                                       
                                          (22)
                                          
                                             
                                                
                                                   d
                                                   ij
                                                
                                                =
                                                
                                                   
                                                      
                                                         
                                                            
                                                               p
                                                               ^
                                                            
                                                            i
                                                         
                                                      
                                                      
                                                         
                                                            1
                                                            −
                                                            
                                                               λ
                                                               i
                                                            
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            
                                                               p
                                                               ^
                                                            
                                                            j
                                                         
                                                      
                                                      
                                                         
                                                            1
                                                            −
                                                            
                                                               λ
                                                               j
                                                            
                                                         
                                                      
                                                   
                                                
                                                .
                                             
                                          
                                       
                                    
                                 

We force every pair of points i and j detected from the patterns to meet condition (22). We use the following cost function:
                                       
                                          (23)
                                          
                                             
                                                
                                                   
                                                      min
                                                      ︸
                                                   
                                                   Λ
                                                
                                                
                                                   
                                                      
                                                         
                                                            ∑
                                                            
                                                               i
                                                               =
                                                               1
                                                            
                                                            M
                                                         
                                                         
                                                      
                                                      
                                                      
                                                         
                                                            ∑
                                                            
                                                               
                                                                  
                                                                     j
                                                                     =
                                                                     1
                                                                     ,
                                                                  
                                                               
                                                               
                                                                  
                                                                     j
                                                                     ≠
                                                                     i
                                                                  
                                                               
                                                            
                                                            M
                                                         
                                                         
                                                      
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     d
                                                                     ij
                                                                     2
                                                                  
                                                                  −
                                                                  ∥
                                                                  
                                                                     
                                                                        
                                                                           p
                                                                           ^
                                                                        
                                                                        i
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        1
                                                                        −
                                                                        
                                                                           λ
                                                                           i
                                                                        
                                                                     
                                                                  
                                                                  −
                                                                  
                                                                     
                                                                        
                                                                           p
                                                                           ^
                                                                        
                                                                        j
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        1
                                                                        −
                                                                        
                                                                           λ
                                                                           j
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     ∥
                                                                     2
                                                                  
                                                               
                                                            
                                                            2
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    where the vector
                                       
                                          
                                             
                                                Λ
                                                =
                                                
                                                   
                                                      
                                                         
                                                            λ
                                                            i
                                                         
                                                      
                                                      
                                                         M
                                                         ×
                                                         1
                                                      
                                                   
                                                
                                                ,
                                                
                                                ∀
                                                i
                                                ∈
                                                
                                                   1
                                                   …
                                                   M
                                                
                                             
                                          
                                       
                                    corresponds to the depth corrections for the M detected points in the planes. The minimum of Eq. (23) with respect to Λ is obtained easily with non linear refinement algorithm such as Levenberg–Marquardt. We assume that Λ=0 at the first iteration.

Knowing λi
                                     and ρ
                                    
                                       i
                                    
                                    
                                       rel
                                    , ∀
                                    i
                                    ∈[1,…,M] values, the global scale factor Ψ can be obtained by minimizing the following cost function in terms of Ψ as the only unknown in the optimization process:
                                       
                                          (24)
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               min
                                                               ︸
                                                            
                                                            ψ
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     ∑
                                                                     
                                                                        i
                                                                        =
                                                                        1
                                                                     
                                                                     N
                                                                  
                                                                  
                                                               
                                                               
                                                               
                                                                  
                                                                     
                                                                        c
                                                                        
                                                                           f
                                                                           i
                                                                        
                                                                     
                                                                  
                                                                  2
                                                                  2
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         /
                                                      
                                                      
                                                         c
                                                         
                                                            f
                                                            i
                                                         
                                                         =
                                                         Δφ
                                                         
                                                            
                                                               
                                                                  
                                                                     S
                                                                     ^
                                                                  
                                                                  i
                                                               
                                                            
                                                         
                                                         −
                                                         Δφ
                                                         
                                                            
                                                               
                                                                  
                                                                     S
                                                                     ^
                                                                  
                                                                  i
                                                                  ∗
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                .
                                             
                                          
                                       
                                    
                                 

We use also non-linear refinement to obtain the value of Ψ. We use Ψ
                                    =1 as initial value.

As commented in Section 2, each point of the scene integrates a small area that substitutes the differential area terms included in the cost function. We employ as mask the 8 nearest neighbors around the point of interest in the image to get an estimation of the area. If the point is near a discontinuity we remove the neighbors at a distance greater than a predefined threshold (e.g. we use a distance threshold of 80mm in all experiments). Finally, the area of a point in the scene corresponds to a quarter of the area covered by all 3D triangles formed by the point and its neighbors (see Fig. 6
                           ).

We need surface normals for the radiometric equations. We compute normals from the sampled depths using the method proposed in [20], which is based on fitting planes around each point, using neighbor pixels. The number of neighbors depends on the distance to the point of interest. In other words, the plane is fitted with points covering approximately the same area regardless of the resolution of the device; e.g., we fix a distance threshold between the neighbors and the point of interest of 80mm. In Fig. 7
                            we show the normals obtained for two real examples of corner-like scenes.


                           Table 1
                            shows the results for two different synthetically generated scenes based on the radiometric model described in Section 2. Simulations were performed for ToF images with low resolutions (e.g. 20×20 pixels).

In order to measure the amount of correction performed by our method we compare, for each pixel, the 3D positions of the ground-truth points against the corresponding estimations obtained from: i) ToF measurements (Ŝi
                           ) without MpI correction. ii) Predicted value of the direct path term (S
                           
                              i
                           
                           ∗) after the optimization algorithm reach a minimum.

The first two columns of Table 1 show the influence of additive noise in depth measurements, while the last two columns show the influence of the global scale factor Ψ used for the albedos. In both cases we show two kinds of plots. In the first row we plot a view of the depth measurements, ground-truth and the proposed correction in the X–Z plane; in the second row we show the corresponding rms error in function of the two parameters under study.

There are two main aspects to highlight. First, the stability of the correction with respect to the noise introduced in the depth signal, which remains close to the value of the noise added and greatly corrects the MpI. Second, it must be noted that the performance of the proposal is also highly independent of the reflectivity coefficient range (up to 30% of increment in global energy absorption) introduced in the MpI generation model.

Theoretically, multipath interference arises from multiple reflections in the scene of 
                              O
                           -th order, e.g. see the example in Fig. 8
                            for 
                              O
                           
                           =2. Our first bounce assumption (
                              O
                           
                           =1) is based on the signal decrease due to the foreshortening phenomena and the quadratic inverse dependency to the distance as seen in Eq. (5). In this section, we validate our first bounce approach in synthetically generated scenarios by introducing the second bounce term in the generative model that simulates multipath interference (see Eq. (25)).
                              
                                 (25)
                                 
                                    
                                       
                                          
                                             
                                             
                                                
                                                   
                                                      S
                                                      ^
                                                   
                                                   i
                                                   
                                                      ∗
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             =
                                             
                                                S
                                                i
                                                ∗
                                             
                                             +
                                             
                                                
                                                   ∑
                                                   
                                                      j
                                                      ∈
                                                      ℛ
                                                      
                                                         
                                                            p
                                                            i
                                                         
                                                      
                                                   
                                                
                                                
                                             
                                             
                                             
                                                
                                                   
                                                      S
                                                      ij
                                                      ∗
                                                   
                                                   +
                                                   
                                                      
                                                         ∑
                                                         
                                                            k
                                                            ∈
                                                            ℛ
                                                            
                                                               
                                                                  p
                                                                  j
                                                               
                                                            
                                                         
                                                      
                                                      
                                                   
                                                   
                                                   
                                                      S
                                                      ikj
                                                      ∗
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                S
                                                ijk
                                                ∗
                                             
                                             
                                                
                                                   λ
                                                   i
                                                
                                                
                                                   λ
                                                   j
                                                
                                                
                                                   λ
                                                   k
                                                
                                             
                                             =
                                             
                                                S
                                                0
                                             
                                             
                                             
                                                G
                                                
                                                   0
                                                   →
                                                   j
                                                
                                                ∗
                                             
                                             
                                             
                                                G
                                                
                                                   j
                                                   →
                                                   k
                                                
                                                ∗
                                             
                                             
                                             
                                                G
                                                
                                                   k
                                                   →
                                                   i
                                                
                                                ∗
                                             
                                             
                                             
                                                G
                                                
                                                   i
                                                   →
                                                   0
                                                
                                                ∗
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        

In the same way as in the previous section, we present in Table 2
                            the influence of additive noise and the calibrated constant ψ in the proposed correction. The results show that adding the second bounce term doesn't incorporate significant error in the algorithm and the correction maintains similar levels if we compare with first bounce model. Given that results, we can theoretically validate our generative model.

In the first row of Table 3
                            we show the behavior of the proposal for a commercial PMDCamCube ToF camera (for more information visit [21]) of 200×20 pixel resolution. The scene consists of a homogeneous color corner where we can easily appreciate the multipath effect.

The second row of Table 3 shows similar results using the MESA-Imaging ToF camera (for more information visit [22]) of 176×144 pixel resolution. We employ a 1:2 re-sampling ratio in the following experiments, so a small error may be introduced due to normal vector computation. Normal vectors have been computed with a 5-neighborhood kernel and a distance threshold of 500mm. In this case, the scene consists of a corner with a chessboard pattern.

In Table 3 we can see that the amount of multipath present in the scene taken by the MESA-Imaging device is significantly smaller than the one seen in the PMDCamCube experiment. This is due to the fact that the checkerboard does not reflect as much light as the uniform surface reflector.

In both scenes of Table 3 we compare our approach with the method proposed in [12]. As it is clear in Table 3, our proposal is able to correct MpI accurately, clearly surpassing the method proposed in [12]. In the second row of Table 3 it can be observed that Fuch's method is not able to correct the scene, due to albedo differences of the checkerboard.

In Tables 4 and 5
                           
                            we show the reconstructed scenes after applying the proposed method using a commercial time of flight camera (see [22]). In the first column we show the point clouds of the measured (in red) and the corrected scene (in green). On these scenes our baseline is obtained using a range laser sensor, with distance accuracy of ±10mm, attached to a servo motor. With this device we can reconstruct the scene with minimal presence of multipath interference as each measurement of the laser is made independently. In columns 3 and 4 we show the initial error from the measurement and the remaining error after our correction, respectively. We represent the value of the error for each point with a different color following the color-map of the attached bar (values are given in mm). In the last column we show the error mean and the standard deviation for different values of the general scale factor ψ. Error mean is computed as the mean of the Euclidean distance between each measured point and its corresponding point from the baseline.

We can observe that in most cases the correction keeps stable after a value of ψ close to 1 or reduces their slope significantly. Calibrated values close to that constant provides good results (in our case ψ
                           =1.45 for experiments 1–13 and ψ
                           =1.12 for experiments 14–15). The outcomes are validated in different scenarios in various ranges up to the maximum range of the employed laser to elaborate the ground truth (4m). We provide values of the error mean, Tables 6 and 7
                           
                           , with two different sub-sampling ratios (sr
                           =4 and sr
                           =8, respectively). The similarity between both remaining errors demonstrate the viability of future efficient implementations that consider homogeneous patches of higher size to speed up the computation of multipath terms. This assumption could reduce the computation complexity of the algorithm and allow real time processing.

Finally, in Table 8
                            we validate our algorithm in a complex scene (lab room view). With this purpose, we have developed the correspondence between a high-resolution RGB camera and our ToF device so we can texturize the scene. In this experiment the ground-truth is not available. However, it can be observed in the second row of Table 8, by simple visual inspection of the texturized mesh, the way our proposal corrects the deformed geometry of the scene captured by the ToF camera.

In ToF cameras the error usually increases with depth (see [23,24] for a comprehensive survey of systematic errors in ToF cameras). In order to show if this error affects the proposed algorithm, in Table 9
                            we validate our proposal for the same scene placed at different distances to the camera. We show that correction error keeps stable in all the cases even if the initial error and the amount of multipath increase with the distance to the camera.

@&#CONCLUSION@&#

This paper presents a method to correct the distortion due to Multipath Interference (MpI) in ToF cameras. We propose a radiometric model able to synthetize ToF measurements, including the MpI phenomenon. Using the radiometric model, we propose a method to remove multipath distortion, recovering the original depth of the scene. The solution we propose is based on unconstrained nonlinear optimization. We obtain the scene depth from which the radiometric model renders the closest ToF depth map to the one actually measured by the camera. We show in the Results section that the method clearly corrects complex scenes captured with different ToF cameras. In all experiments we also show that our approach obtains better results when compared to the state of the art techniques.

At the moment, computational cost is high (taking several minutes for a small scene). However, we have several research lines opened that establish different methods to push the approach to future real time implementations.

@&#ACKNOWLEDGMENTS@&#

This work has been supported by the Spanish Ministry of Science and Innovation under project VISNU (ref. TIN2009-08984) and both the University of Alcala and Regional Government of Madrid under project FUVA (ref. CCG10-UAH/TIC-5988). We also thank Stefan Fuchs, from the German Aerospace Center, for his constructive feedback and helpful database.

@&#REFERENCES@&#

