@&#MAIN-TITLE@&#Isogeometric analysis on triangulations

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Isogeometric analysis on triangulation of a domain bounded by NURBS curves.


                        
                        
                           
                           Geometry and solution represented by bivariate splines in Bernstein–Bézier form.


                        
                        
                           
                           Approach to construct parametric domain and construct 
                                 
                                    
                                       C
                                    
                                    
                                       r
                                    
                                 
                              -smooth basis functions.


                        
                        
                           
                           Applicable to complex topologies and allow highly localized refinement.


                        
                        
                           
                           Isogeometric analysis of linear elasticity and advection–diffusion demonstrated.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Isogeometric analysis

Rational triangular Bézier

Bivariate splines

NURBS

Bernstein–Bézier form

@&#ABSTRACT@&#


               
               
                  We present a method for isogeometric analysis on the triangulation of a domain bounded by NURBS curves. In this method, both the geometry and the physical field are represented by bivariate splines in Bernstein–Bézier form over the triangulation. We describe a set of procedures to construct a parametric domain and its triangulation from a given physical domain, construct 
                        
                           
                              C
                           
                           
                              r
                           
                        
                     -smooth basis functions over the domain, and establish a rational Triangular Bézier Spline (rTBS) based geometric mapping that 
                        
                           
                              C
                           
                           
                              r
                           
                        
                     -smoothly maps the parametric domain to the physical domain and exactly recovers the NURBS boundaries at the domain boundary. As a result, this approach can achieve automated meshing of objects with complex topologies and allow highly localized refinement. Isogeometric analysis of problems from linear elasticity and advection–diffusion analysis is demonstrated.
               
            

@&#INTRODUCTION@&#

Isogeometric analysis is a technique of numerical analysis that uses basis functions commonly found in CAD geometries to represent both geometry and physical fields in the solution of problems governed by partial differential equations (PDE)  [1,2]. Non-uniform rational 
                        B
                     -splines (NURBS) are the de facto standard for geometric representation in CAD systems. The use of a NURBS-compatible basis in the solution of physical problems therefore leads to the elimination of geometric-approximation error in even the coarsest mesh. The increased continuity of the NURBS basis has led to significant numerical advantages over traditional Lagrange polynomials and other 
                        
                           
                              C
                           
                           
                              0
                           
                        
                      inter-element continuity based finite element analysis, e.g. improved convergence rate on a per degree-of-freedom (DOF) basis  [2]. However, NURBS-based isogeometric analysis also faces challenges. For example, it is challenging to automatically construct NURBS-based volumetric representation of a complex physical domain since CAD geometries only contain boundary representation of the domain; Further, the tensor-product structure of NURBS makes it harder to perform local mesh refinement as is commonly desired during analysis.

Recently, significant progress has been made in addressing these challenges. For example, the swept volume  [3], harmonic functions  [4], multi-block  [5], and Coons patch  [6] techniques have recently been developed to construct NURBS representations of volumetric domains. To extend NURBS representation to complex topologies while also allowing for adaptive refinement, 
                        T
                     -splines [7] have been used in isogeometric analysis  [8–10]. Methods for constructing 
                        T
                     -spline based parametrization of the domain are being developed  [11,12]. Among alternate isogeometric representation and analysis techniques under development, a technique based on subdivision solids has recently been proposed  [13]. Further, boundary-integral based isogeometric analysis techniques [14,15] seek to effectively bypass the need for volumetric parametrization.

We present an alternative approach to isogeometric analysis with the goal of achieving automatic discretization of the physical domain while eliminating geometric approximation error, allowing local refinement of the discretization and making it applicable to complex topologies. Our approach is based on triangulations of physical domains where both the geometry and physical field are represented by 
                        
                           
                              C
                           
                           
                              r
                           
                        
                     -continuous multivariate splines in their Bernstein–Bézier form. In this paper, we restrict our attention to two-dimensional problems and bivariate splines. In our method, we first construct a polygonal parametric domain 
                        
                           
                              Ω
                           
                           
                              ̂
                           
                        
                      that mimics the NURBS-bounded physical domain 
                        Ω
                     . We then obtain a triangulation 
                        T
                      of 
                        
                           
                              Ω
                           
                           
                              ̂
                           
                        
                     , on which a Bernstein–Bézier form of a 
                        
                           
                              C
                           
                           
                              r
                           
                        
                      bivariate spline basis is constructed. We use this basis to construct globally 
                        
                           
                              C
                           
                           
                              r
                           
                        
                     -smooth geometric mapping that maps the parametric domain 
                        
                           
                              Ω
                           
                           
                              ̂
                           
                        
                      to the physical domain 
                        Ω
                      with exact recovery of the NURBS boundary. When exceptional vertices/edges are allowed, this approach also ensures global bijectivity of the mapping. We demonstrate our analysis results for linear elasticity and advection–diffusion problems on problems which are characteristically non-trivial to mesh by other methods. Since robust technologies for automatic triangulation with local refinement are currently available, our approach is fully automated, is applicable to objects of complex topologies and allows for local refinement during in the course of analysis.

Our work differs from prior work on multivariate-spline based analysis  [16,17] in that we explicitly construct 
                        
                           
                              C
                           
                           
                              r
                           
                        
                     -smooth bases and use rational Triangular Bézier Splines (rTBS) to ensure the exact recovery of the NURBS boundary. Our work also differs from the recent developed non-uniform rational Powell–Sabin splines for isogeometric analysis  [18,19]. Our approach is more general since general 
                        
                           
                              C
                           
                           
                              r
                           
                        
                      spline spaces are considered. Further, we use Bézier ordinates and the corresponding basis functions to represent PDE solutions. Therefore, our Béizer ordinates based representation has direct geometric interpretation. In contrast, the approach [18,19] uses Powell–Sabin triangles and the corresponding normalized Powell–Sabin 
                        B
                     -splines to represent the solutions. However, Powell–Sabin triangles are not unique for a given triangulation although the normalized Powell–Sabin 
                        B
                     -splines have nice computational properties such as negativity. Further, our approach is applicable to macroelements or non-macroelements alike and the approach in  [18,19] is an macroelement based approach.


                     Fig. 1
                      gives a schematic overview of our proposed approach. A 
                        
                           
                              C
                           
                           
                              r
                           
                        
                      continuous basis 
                        
                           ψ
                        
                        
                           (
                           
                              ξ
                           
                           )
                        
                      is constructed over the parametric domain 
                        
                           
                              Ω
                           
                           
                              ̂
                           
                        
                     . The basis is used to construct an rTBS based geometric map 
                        
                           G
                        
                        
                           (
                           
                              ξ
                           
                           )
                        
                      so that it maps a point 
                        
                           ξ
                        
                        ∈
                        
                           
                              R
                           
                           
                              2
                           
                        
                      in parametric domain 
                        
                           
                              Ω
                           
                           
                              ̂
                           
                        
                      to a point 
                        
                           x
                        
                        ∈
                        
                           
                              R
                           
                           
                              2
                           
                        
                      in the physical domain 
                        Ω
                     . The same basis is also used to approximate physical field 
                        u
                        
                           (
                           
                              ξ
                           
                           )
                        
                     . Composing the inverse of geometric map and the field approximation, 
                        
                           u
                        
                        ∘
                        
                           
                              
                                 G
                              
                           
                           
                              −
                              1
                           
                        
                     , defines a field on the physical domain. Quadrature in analysis integration is performed via local barycentric coordinates on the parent triangle.

The remainder of this paper is organized as follows: Section  2 introduces necessary background concepts; Section  3 presents our discretization method—smooth rTBS-based discretization of the physical domain; Section  4 discusses the details of smooth rTBS-based isogeometric analysis; Section  5 contains our numerical results; In Section  6 we present our conclusions.

@&#BACKGROUND@&#

In this section we briefly introduce the Bézier curve, non-uniform rational 
                        B
                     -splines (NURBS) and triangular Béziers. We then discuss the splines over triangulations and the Clough–Tocher and Powell–Sabin splits. This introduction aims to make the paper self-contained and to clarify notation for subsequent sections. For further reading on Bézier curves, 
                        B
                     -splines, and Bézier triangles, see  [20], for splines on triangulations, see  [21], and for isogeometric analysis, see  [2].

CAD geometry is usually defined by a NURBS represented boundary. Each knot span of a NURBS curve corresponds to a Bézier curve. A Bézier curve is defined through Bernstein basis functions. A degree-
                           d
                         Bernstein polynomial is defined explicitly by 
                           
                              (1)
                              
                                 
                                    
                                       B
                                    
                                    
                                       i
                                       ,
                                       d
                                    
                                 
                                 
                                    (
                                    ξ
                                    )
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          d
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                                 
                                 
                                    
                                       ξ
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       
                                          (
                                          1
                                          −
                                          ξ
                                          )
                                       
                                    
                                    
                                       d
                                       −
                                       i
                                    
                                 
                                 ,
                                 
                                 ξ
                                 ∈
                                 
                                    [
                                    0
                                    ,
                                    1
                                    ]
                                 
                                 ,
                              
                           
                         where 
                           ξ
                         is the parameter. A degree-
                           d
                         Bézier curve is defined in terms of 
                           d
                           +
                           1
                         Bernstein basis functions and the corresponding control points 
                           
                              
                                 
                                    p
                                 
                              
                              
                                 i
                              
                           
                           =
                           
                              (
                              
                                 
                                    
                                       
                                          x
                                       
                                       
                                          1
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          x
                                       
                                       
                                          2
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              )
                           
                         as 
                           
                              (2)
                              
                                 
                                    c
                                 
                                 
                                    (
                                    ξ
                                    )
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       0
                                    
                                    
                                       d
                                    
                                 
                                 
                                    
                                       
                                          p
                                       
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       B
                                    
                                    
                                       i
                                       ,
                                       d
                                    
                                 
                                 
                                    (
                                    ξ
                                    )
                                 
                                 .
                              
                           
                        
                     

A NURBS curve of degree-
                           d
                         is defined as follows 
                           
                              (3)
                              
                                 
                                    c
                                 
                                 
                                    (
                                    ξ
                                    )
                                 
                                 =
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             =
                                             0
                                          
                                          
                                             n
                                          
                                       
                                       
                                          
                                             N
                                          
                                          
                                             i
                                             ,
                                             d
                                          
                                       
                                       
                                          (
                                          ξ
                                          )
                                       
                                       
                                          
                                             w
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             
                                                p
                                             
                                          
                                          
                                             i
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                             =
                                             0
                                          
                                          
                                             n
                                          
                                       
                                       
                                          
                                             N
                                          
                                          
                                             j
                                             ,
                                             d
                                          
                                       
                                       
                                          (
                                          ξ
                                          )
                                       
                                       
                                          
                                             w
                                          
                                          
                                             j
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                         where 
                           
                              {
                              
                                 
                                    
                                       p
                                    
                                 
                                 
                                    i
                                 
                              
                              }
                           
                           =
                           
                              (
                              
                                 
                                    x
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                              ,
                              
                                 
                                    x
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              )
                           
                         represents the coordinate positions of a set of 
                           i
                           =
                           0
                           ,
                           …
                           ,
                           n
                         control points, 
                           
                              {
                              
                                 
                                    w
                                 
                                 
                                    i
                                 
                              
                              }
                           
                         is the corresponding weight, and 
                           
                              {
                              
                                 
                                    N
                                 
                                 
                                    i
                                    ,
                                    d
                                 
                              
                              }
                           
                         is the degree-
                           d
                           B
                        -spline basis function, defined by a knot vector 
                           Ξ
                           =
                           
                              {
                              
                                 
                                    ξ
                                 
                                 
                                    0
                                 
                              
                              ,
                              
                                 
                                    ξ
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    ξ
                                 
                                 
                                    n
                                    +
                                    d
                                    +
                                    1
                                 
                              
                              }
                           
                        . Through repeated knot insertion, the Bézier representation for each knot span of a NURBS curve can be obtained.

Bézier triangles are based on bivariate Bernstein polynomials. Let a triangle 
                           τ
                         with vertices 
                           
                              
                                 
                                    v
                                 
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 
                                    v
                                 
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 
                                    v
                                 
                              
                              
                                 3
                              
                           
                           ∈
                           
                              
                                 R
                              
                              
                                 2
                              
                           
                         and the barycentric coordinate of a point 
                           
                              ξ
                           
                           ∈
                           
                              
                                 R
                              
                              
                                 2
                              
                           
                         with respect to the triangle be 
                           
                              {
                              
                                 
                                    γ
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    γ
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                                 
                                    γ
                                 
                                 
                                    3
                                 
                              
                              }
                           
                        . A degree-
                           d
                         bivariate Bernstein polynomial is defined as 
                           
                              (4)
                              
                                 
                                    
                                       B
                                    
                                    
                                       
                                          i
                                       
                                       ,
                                       d
                                    
                                 
                                 
                                    (
                                    
                                       ξ
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       d
                                       !
                                    
                                    
                                       i
                                       !
                                       j
                                       !
                                       k
                                       !
                                    
                                 
                                 
                                    
                                       γ
                                    
                                    
                                       1
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       γ
                                    
                                    
                                       2
                                    
                                    
                                       j
                                    
                                 
                                 
                                    
                                       γ
                                    
                                    
                                       3
                                    
                                    
                                       k
                                    
                                 
                                 ;
                                 
                                 
                                    |
                                    
                                       i
                                    
                                    |
                                 
                                 =
                                 d
                                 ,
                              
                           
                         where 
                           
                              i
                           
                         represents a triple index 
                           
                              (
                              i
                              ,
                              j
                              ,
                              k
                              )
                           
                        . A triangular Bézier patch is defined as 
                           
                              (5)
                              
                                 
                                    b
                                 
                                 
                                    (
                                    
                                       ξ
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       +
                                       j
                                       +
                                       k
                                       =
                                       d
                                    
                                 
                                 
                                    
                                       B
                                    
                                    
                                       
                                          i
                                       
                                       ,
                                       d
                                    
                                 
                                 
                                    (
                                    
                                       ξ
                                    
                                    )
                                 
                                 
                                    
                                       
                                          p
                                       
                                    
                                    
                                       
                                          i
                                       
                                    
                                 
                                 ,
                              
                           
                         with 
                           
                              
                                 
                                    p
                                 
                              
                              
                                 
                                    i
                                 
                              
                           
                         represents a triangular array of control points. A rational Bézier triangle can be defined as 
                           
                              (6)
                              
                                 
                                    b
                                 
                                 
                                    (
                                    
                                       ξ
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             
                                                |
                                                
                                                   i
                                                
                                                |
                                             
                                             =
                                             d
                                          
                                       
                                       
                                          
                                             w
                                          
                                          
                                             
                                                i
                                             
                                          
                                       
                                       
                                          
                                             
                                                p
                                             
                                          
                                          
                                             
                                                i
                                             
                                          
                                       
                                       
                                          
                                             B
                                          
                                          
                                             
                                                i
                                             
                                             ,
                                             d
                                          
                                       
                                       
                                          (
                                          
                                             ξ
                                          
                                          )
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             
                                                |
                                                
                                                   i
                                                
                                                |
                                             
                                             =
                                             d
                                          
                                       
                                       
                                          
                                             w
                                          
                                          
                                             
                                                i
                                             
                                          
                                       
                                       
                                          
                                             B
                                          
                                          
                                             
                                                i
                                             
                                             ,
                                             d
                                          
                                       
                                       
                                          (
                                          
                                             ξ
                                          
                                          )
                                       
                                    
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 w
                              
                              
                                 
                                    i
                                 
                              
                           
                         are the weights associated with the control points 
                           
                              
                                 
                                    p
                                 
                              
                              
                                 
                                    i
                                 
                              
                           
                        .

The bivariate Bernstein polynomials can be used to define a polynomial function 
                           f
                           
                              (
                              
                                 ξ
                              
                              )
                           
                         of degree-
                           d
                         over the triangle 
                           
                              {
                              
                                 
                                    
                                       v
                                    
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    
                                       v
                                    
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                                 
                                    
                                       v
                                    
                                 
                                 
                                    3
                                 
                              
                              }
                           
                         as: 
                           
                              (7)
                              
                                 f
                                 
                                    (
                                    
                                       ξ
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       +
                                       j
                                       +
                                       k
                                       =
                                       d
                                    
                                 
                                 
                                    
                                       b
                                    
                                    
                                       i
                                       j
                                       k
                                    
                                 
                                 
                                    
                                       B
                                    
                                    
                                       i
                                       j
                                       k
                                       ,
                                       d
                                    
                                 
                                 
                                    (
                                    
                                       γ
                                    
                                    )
                                 
                              
                           
                         where 
                           
                              
                                 b
                              
                              
                                 i
                                 j
                                 k
                              
                           
                         are Bézier ordinates of 
                           f
                           
                              (
                              
                                 ξ
                              
                              )
                           
                         and the points 
                           
                              (8)
                              
                                 
                                    
                                       
                                          q
                                       
                                    
                                    
                                       i
                                       j
                                       k
                                    
                                 
                                 =
                                 
                                    
                                       i
                                       
                                          
                                             
                                                v
                                             
                                          
                                          
                                             1
                                          
                                       
                                       +
                                       j
                                       
                                          
                                             
                                                v
                                             
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       k
                                       
                                          
                                             
                                                v
                                             
                                          
                                          
                                             3
                                          
                                       
                                    
                                    
                                       d
                                    
                                 
                              
                           
                         are domain points. The points 
                           
                              (
                              
                                 
                                    
                                       q
                                    
                                 
                                 
                                    i
                                    j
                                    k
                                 
                              
                              ,
                              
                                 
                                    b
                                 
                                 
                                    i
                                    j
                                    k
                                 
                              
                              )
                           
                         are control points of the Bernstein–Bézier form of the polynomial function 
                           f
                           
                              (
                              
                                 ξ
                              
                              )
                           
                        . By setting one barycentric coordinate to zero and varying the other two, 
                           
                              ξ
                           
                         intersects a triangular edge and the bivariate basis reduces to the Bernstein functions (1). The evaluation of a Bézier triangle can be done by the de Casteljau algorithm  [20]
                        
                           
                              (9)
                              
                                 
                                    
                                       b
                                    
                                    
                                       
                                          i
                                       
                                    
                                    
                                       r
                                    
                                 
                                 
                                    (
                                    
                                       ξ
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       γ
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       b
                                    
                                    
                                       
                                          i
                                       
                                       +
                                       
                                          e
                                       
                                       1
                                    
                                    
                                       r
                                       −
                                       1
                                    
                                 
                                 
                                    (
                                    
                                       ξ
                                    
                                    )
                                 
                                 +
                                 
                                    
                                       γ
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       b
                                    
                                    
                                       
                                          i
                                       
                                       +
                                       
                                          e
                                       
                                       2
                                    
                                    
                                       r
                                       −
                                       1
                                    
                                 
                                 
                                    (
                                    
                                       ξ
                                    
                                    )
                                 
                                 +
                                 
                                    
                                       γ
                                    
                                    
                                       3
                                    
                                 
                                 
                                    
                                       b
                                    
                                    
                                       
                                          i
                                       
                                       +
                                       
                                          e
                                       
                                       3
                                    
                                    
                                       r
                                       −
                                       1
                                    
                                 
                                 
                                    (
                                    
                                       ξ
                                    
                                    )
                                 
                                 ,
                              
                           
                         where 
                           r
                           =
                           1
                           ,
                           …
                           ,
                           d
                             and  
                           
                              |
                              
                                 i
                              
                              |
                           
                           =
                           d
                           −
                           r
                           ,
                           
                              
                                 
                                    e
                                 
                              
                              
                                 1
                              
                           
                           =
                           
                              (
                              1
                              ,
                              0
                              ,
                              0
                              )
                           
                           ,
                           
                              
                                 
                                    e
                                 
                              
                              
                                 2
                              
                           
                           =
                           
                              (
                              0
                              ,
                              1
                              ,
                              0
                              )
                           
                        , and 
                           
                              
                                 
                                    e
                                 
                              
                              
                                 3
                              
                           
                           =
                           
                              (
                              0
                              ,
                              0
                              ,
                              1
                              )
                           
                        .

Two polynomials 
                           f
                           
                              (
                              
                                 ξ
                              
                              )
                           
                         and 
                           
                              
                                 f
                              
                              
                                 ̃
                              
                           
                           
                              (
                              
                                 ξ
                              
                              )
                           
                         join 
                           r
                         times differentiable across the common edge of two triangles 
                           τ
                         and 
                           
                              
                                 τ
                              
                              
                                 ̃
                              
                           
                         if and only if the following is true  [21]
                        
                           
                              (10)
                              
                                 
                                    
                                       
                                          
                                             b
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       ρ
                                       ,
                                       j
                                       ,
                                       k
                                    
                                 
                                 −
                                 
                                    
                                       ∑
                                    
                                    
                                       μ
                                       +
                                       ν
                                       +
                                       κ
                                       =
                                       ρ
                                    
                                 
                                 
                                    
                                       ρ
                                       !
                                    
                                    
                                       μ
                                       !
                                       ν
                                       !
                                       κ
                                       !
                                    
                                 
                                 
                                    
                                       b
                                    
                                    
                                       μ
                                       ,
                                       j
                                       +
                                       ν
                                       ,
                                       k
                                       +
                                       κ
                                    
                                 
                                 
                                    
                                       γ
                                    
                                    
                                       1
                                    
                                    
                                       μ
                                    
                                 
                                 
                                    
                                       γ
                                    
                                    
                                       2
                                    
                                    
                                       ν
                                    
                                 
                                 
                                    
                                       γ
                                    
                                    
                                       3
                                    
                                    
                                       κ
                                    
                                 
                                 =
                                 0
                              
                           
                         for all 
                           ρ
                           ≤
                           r
                         and 
                           j
                           +
                           k
                           +
                           ρ
                           =
                           d
                        .


                        Fig. 2
                         gives an illustration of triangular Bézier patches and continuity constraints. Here the control points 
                           
                              
                                 
                                    p
                                 
                              
                              
                                 
                                    i
                                 
                              
                           
                           ∈
                           
                              
                                 R
                              
                              
                                 3
                              
                           
                        . Fig. 2(a) and (b) show two adjacent domain triangles where the two triangles share one edge 
                           
                              
                                 
                                    v
                                 
                              
                              
                                 1
                              
                           
                           
                              
                                 
                                    v
                                 
                              
                              
                                 2
                              
                           
                         and the corresponding surface patches. Fig. 2(c) and (d) show the 
                           
                              
                                 C
                              
                              
                                 1
                              
                           
                        -continuity constraints imposed on the Bézier ordinates and the resulting 
                           
                              
                                 C
                              
                              
                                 1
                              
                           
                         patches.

Consider a parametric domain 
                           
                              
                                 Ω
                              
                              
                                 ̂
                              
                           
                         and its triangulation 
                           T
                        , the spline space of piecewise polynomials of degree-
                           d
                         over 
                           T
                         is denoted as 
                           
                              
                                 S
                              
                              
                                 d
                              
                              
                                 r
                              
                           
                           
                              (
                              T
                              )
                           
                           =
                           
                              {
                              f
                              ∈
                              
                                 
                                    C
                                 
                                 
                                    r
                                 
                              
                              
                                 (
                                 
                                    
                                       Ω
                                    
                                    
                                       ̂
                                    
                                 
                                 )
                              
                              :
                              f
                              
                                 
                                    |
                                 
                                 
                                    τ
                                 
                              
                                is a polynomial of degree  
                              d
                              ,
                              ∀
                              τ
                              ∈
                              T
                              }
                           
                        , where 
                           τ
                         is an arbitrary triangle in 
                           T
                        .

To obtain 
                           
                              
                                 C
                              
                              
                                 r
                              
                           
                         smoothness for any spline, one may simply assert (10) repeatedly and solve the continuity constraints or through macroelement techniques with polynomials of degrees much higher than 
                           r
                         or lower degree polynomials based on a split scheme where each triangle in 
                           T
                         is split into several micro-triangles. The original triangle is then called a macro-triangle. Splines with higher-order polynomials over each triangle include 
                           d
                           ≥
                           4
                           r
                           +
                           1
                           [22] and 
                           d
                           ≥
                           3
                           r
                           +
                           2
                           [23] for general triangulation. However, due to their efficiency 
                           
                              
                                 C
                              
                              
                                 r
                              
                           
                        -smooth polynomials of lower degree over macro-triangulations are often preferred. These include the Clough–Tocher split  [24,25] where one triangle is subdivided into three micro-triangles with polynomials of degree 
                           d
                           =
                           3
                           r
                         for continuity 
                           r
                        -odd and 
                           d
                           =
                           3
                           r
                           +
                           1
                         for 
                           r
                        -even, the Powell–Sabin split  [26] with polynomials of degree 
                           d
                           =
                           
                              ⌊
                              
                                 
                                    9
                                    r
                                    +
                                    1
                                 
                                 
                                    4
                                 
                              
                           
                         for 
                           r
                        -odd, and of degree 
                           d
                           =
                           
                              ⌊
                              
                                 
                                    9
                                    r
                                    +
                                    4
                                 
                                 
                                    4
                                 
                              
                           
                         for 
                           r
                        -even, and numerous others  [21]. Convenient 
                           B
                        -spline-like bases for PS-6 split  [27], recently for PS-12 split  [28], normalized Clough–Tocher split  [29], Quintic PS-splines  [30], and a family of PS splines  [31] have been proposed.


                        Fig. 3
                         shows the Clough–Tocher (CT) and Powell–Sabin (PS) splits and corresponding 
                           
                              
                                 C
                              
                              
                                 1
                              
                           
                         cubic and quadratic free domain points respectively. 
                           
                              
                                 C
                              
                              
                                 r
                              
                           
                         spaces can be achieved on these splits at elevated degrees  [21]. In the Clough–Tocher split, it connects each vertex of a triangle with its incenter to form three micro-triangles. Each micro-triangle is represented by a cubic polynomial. In the Powell–Sabin split, each macro-triangle is split into six micro-triangles with incenter as the interior split point. Edges are then split by joining incenters of adjacent triangles. In practice and in our implementation, the centroid point, instead of the incenter, of each triangle is used in both CT and PS splits and boundary edges are bisected in the PS splits. Besides the CT and PS splits, we perform uniform 
                           h
                        -refinement by connecting edge midpoints to subdivide each triangle into four parts. Adaptive refinement is accomplished by the Rivara method  [32]. Each subdivision in the Rivara method is an element bisection across one of its edges.

This section details our method for discretizing a physical domain 
                        Ω
                      into a collection of rational Bézier triangles without any geometric-approximation error. Given an arbitrary 2D domain 
                        Ω
                      and its NURBS-represented boundary 
                        Γ
                        =
                        
                           
                              ∪
                           
                           
                              i
                           
                        
                        
                           
                              
                                 c
                              
                           
                           
                              i
                           
                        
                        
                           (
                           ξ
                           )
                        
                      of degree-
                        d
                     , we seek a geometric map 
                        
                           G
                        
                        
                           (
                           
                              ξ
                           
                           )
                        
                        ,
                        
                           ξ
                        
                        ∈
                        
                           
                              Ω
                           
                           
                              ̂
                           
                        
                      such that:
                        
                           –
                           the physical domain 
                                 Ω
                               is the image of the geometric map 
                                 
                                    G
                                 
                                 
                                    (
                                    
                                       ξ
                                    
                                    )
                                 
                               over a parametric domain 
                                 
                                    
                                       Ω
                                    
                                    
                                       ̂
                                    
                                 
                              , i.e.  
                                 Ω
                                 =
                                 
                                    {
                                    
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             x
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    ∈
                                    
                                       
                                          R
                                       
                                       
                                          2
                                       
                                    
                                    :
                                    
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             x
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       G
                                    
                                    
                                       (
                                       
                                          ξ
                                       
                                       )
                                    
                                    ,
                                    
                                       ξ
                                    
                                    ∈
                                    
                                       
                                          Ω
                                       
                                       
                                          ̂
                                       
                                    
                                    }
                                 
                              ,

the boundary of the domain 
                                 Γ
                               is exactly reproduced by the map 
                                 
                                    G
                                 
                                 
                                    (
                                    
                                       ξ
                                    
                                    )
                                 
                               at the boundary 
                                 
                                    
                                       Γ
                                    
                                    
                                       ̂
                                    
                                 
                               of the parametric domain 
                                 
                                    
                                       Ω
                                    
                                    
                                       ̂
                                    
                                 
                              , i.e.  
                                 Γ
                                 =
                                 
                                    {
                                    
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             x
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    ∈
                                    
                                       
                                          R
                                       
                                       
                                          2
                                       
                                    
                                    :
                                    
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             x
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       G
                                    
                                    
                                       (
                                       
                                          ξ
                                       
                                       )
                                    
                                    ,
                                    
                                       ξ
                                    
                                    ∈
                                    
                                       
                                          Γ
                                       
                                       
                                          ̂
                                       
                                    
                                    }
                                 
                              , and

the map is continuous and differentiable up to any desired degree of continuity 
                                 
                                    
                                       C
                                    
                                    
                                       r
                                    
                                 
                              .

Construct a geometric map 
                                 
                                    
                                       
                                          G
                                       
                                    
                                    
                                       0
                                    
                                 
                               based on 
                                 
                                    
                                       C
                                    
                                    
                                       0
                                    
                                 
                               Bézier triangles where the input NURBS boundary curves are exactly reproduced. As a by-product of this step, we obtain a polygonal approximation 
                                 
                                    
                                       Ω
                                    
                                    
                                       0
                                    
                                 
                               of the physical domain 
                                 Ω
                               that topologically has the same genus as the physical domain 
                                 Ω
                               and geometrically approximates the boundary of the domain 
                                 Γ
                              .

Form a polygonal parametric domain 
                                 
                                    
                                       Ω
                                    
                                    
                                       ̂
                                    
                                 
                               from 
                                 
                                    
                                       Ω
                                    
                                    
                                       0
                                    
                                 
                               and a triangulation 
                                 T
                               of 
                                 
                                    
                                       Ω
                                    
                                    
                                       ̂
                                    
                                 
                              .

Form a 
                                 
                                    
                                       C
                                    
                                    
                                       r
                                    
                                 
                               basis, 
                                 
                                    ψ
                                 
                                 
                                    (
                                    
                                       ξ
                                    
                                    )
                                 
                              , on 
                                 T
                               and obtain a globally 
                                 
                                    
                                       C
                                    
                                    
                                       r
                                    
                                 
                               geometric map 
                                 
                                    G
                                 
                               from the parametric domain 
                                 
                                    
                                       Ω
                                    
                                    
                                       ̂
                                    
                                 
                               onto the physical domain 
                                 Ω
                              , which exactly reproduces the domain boundary.

Our approach to construct an rTBS mesh with exact domain boundary is to approximate the curved domain 
                           Ω
                         by a polygon 
                           
                              
                                 Ω
                              
                              
                                 0
                              
                           
                        , triangulate 
                           
                              
                                 Ω
                              
                              
                                 0
                              
                           
                           →
                           T
                        , and then replace the boundary segments of 
                           T
                         by segments of the exact NURBS boundary. This process for obtaining a 
                           
                              
                                 C
                              
                              
                                 0
                              
                           
                         rTBS mapping 
                           
                              
                                 
                                    G
                                 
                              
                              
                                 0
                              
                           
                         is accomplished by the following sub-steps (see Fig. 4
                        ): 
                           
                              (a)
                              
                                 Boundary subdivision and Bézier extraction: Subdivide each NURBS curve 
                                    
                                       
                                          
                                             c
                                          
                                       
                                       
                                          i
                                       
                                    
                                    
                                       (
                                       ξ
                                       )
                                    
                                  of degree-
                                    d
                                  into a set of Bézier curves via knot insertions. The linear segments connecting the resulting Bézier end-points should form a good approximation of the NURBS boundary.


                                 Triangulation of the polygonal domain: The Bézier end-points from Step 1a are connected to form a polygonal domain 
                                    
                                       
                                          Ω
                                       
                                       
                                          0
                                       
                                    
                                 . The polygonal domain 
                                    
                                       
                                          Ω
                                       
                                       
                                          0
                                       
                                    
                                  is then triangulated to obtain 
                                    
                                       
                                          T
                                       
                                       
                                          0
                                       
                                    
                                 .


                                 Domain points: Domain points of degree-
                                    d
                                  (and coincident control points) for each triangle in 
                                    
                                       
                                          T
                                       
                                       
                                          0
                                       
                                    
                                  from Step 1b are created based on (8). In this sub-step, the weights of all Bézier control points are chosen to be unity.

Note that each degree-
                                    d
                                  Bézier curve segment in Step 1a corresponds to one boundary edge in 
                                    
                                       
                                          T
                                       
                                       
                                          0
                                       
                                    
                                 , which in turn has 
                                    d
                                    +
                                    1
                                  domain points after Step 1c. Thus, each Bézier control point for the domain boundary now corresponds to one domain point on the boundary edge of 
                                    
                                       
                                          T
                                       
                                       
                                          0
                                       
                                    
                                 .


                                 Boundary replacement: Replacing boundary control points of 
                                    
                                       
                                          T
                                       
                                       
                                          0
                                       
                                    
                                  with corresponding control points on the Bézier curves in Step 1a to obtain the triangular mesh 
                                    
                                       
                                          
                                             G
                                          
                                       
                                       
                                          0
                                       
                                    
                                 . In this sub-step, the weights of the boundary Bézier control points are replaced by the weights from the corresponding Bézier points in Step 1a.


                        Fig. 4 illustrates how a domain bounded by NURBS curves 
                           
                              
                                 
                                    c
                                 
                              
                              
                                 i
                              
                           
                           
                              (
                              ξ
                              )
                           
                         is decomposed into a collection of 
                           
                              
                                 C
                              
                              
                                 0
                              
                           
                         triangular Bézier patches with exact geometry as in 
                           
                              
                                 
                                    c
                                 
                              
                              
                                 i
                              
                           
                           
                              (
                              ξ
                              )
                           
                        . Fig. 4(a) shows a domain bounded by two sets of cubic, clamped NURBS curves, one an external contour and the other an internal contour. The circular points are control points. The end-points of each NURBS curve are shown in empty circles. Also shown are two sets of ticks that represent internal knots with 
                           
                              
                                 C
                              
                              
                                 2
                              
                           
                         and 
                           
                              
                                 C
                              
                              
                                 1
                              
                           
                         smoothness on the curves. The first sub-step shown in Fig. 4(b) is the subdivision of NURBS boundary curves via repeated knot insertions to obtain its Bézier representation. The inserted knots include all of the internal knots from the NURBS boundary as well as additional knots that are inserted so that the resulting polygons connecting the Bézier end points form a good approximation of the given domain 
                           Ω
                         bounded by the NURBS curves. Fig. 4(c) shows the resulting polygon 
                           
                              
                                 Ω
                              
                              
                                 0
                              
                           
                         and its triangulation 
                           
                              
                                 T
                              
                              
                                 0
                              
                           
                        . Fig. 4(d) shows the creation of domain/control points on 
                           
                              
                                 T
                              
                              
                                 0
                              
                           
                         so that each triangle becomes a degree-3 Bézier triangle. Fig. 4(e) highlights one triangle in 
                           
                              
                                 T
                              
                              
                                 0
                              
                           
                         in Fig. 4(d) with its boundary control points replaced by boundary Bézier control points from Fig. 4(b). 
                           Remark 1
                           Bézier triangles 
                                 
                                    
                                       
                                          G
                                       
                                    
                                    
                                       0
                                    
                                 
                               exactly reproduce the NURBS represented domain boundary 
                                 Γ
                              .

With the sub-steps outlined above, the boundary of the Bézier discretization 
                           
                              
                                 
                                    G
                                 
                              
                              
                                 0
                              
                           
                         of the domain 
                           Ω
                         retains all control points of the Bézier-subdivided NURBS boundary 
                           
                              
                                 
                                    c
                                 
                              
                              
                                 i
                              
                           
                           
                              (
                              ξ
                              )
                           
                        . That is, we have obtained a triangular discretization of the domain 
                           Ω
                         with no approximation error. The 
                           
                              
                                 C
                              
                              
                                 0
                              
                           
                         mesh 
                           
                              
                                 
                                    G
                                 
                              
                              
                                 0
                              
                           
                         of 
                           Ω
                         can thus be directly used for analysis where mesh refinement of each Bézier triangle can be conducted without introducing any discretization error from the original geometry. We note that 
                           
                              
                                 
                                    G
                                 
                              
                              
                                 0
                              
                           
                         alone is sufficient to perform isogeometric analysis with 
                           
                              
                                 C
                              
                              
                                 0
                              
                           
                         smoothness between elements. In such analysis, each Bézier patch can be mapped to a canonical triangular domain for integration with the corresponding basis function 
                           ϕ
                           
                              (
                              
                                 ξ
                              
                              )
                           
                         defined as the bivariate Bernstein polynomials (4).

A by-product of the above 
                           
                              
                                 C
                              
                              
                                 0
                              
                           
                         rTBS discretization of 
                           Ω
                         is its polygonal approximation 
                           
                              
                                 Ω
                              
                              
                                 0
                              
                           
                         and triangulation 
                           
                              
                                 T
                              
                              
                                 0
                              
                           
                        . In this second step, we present a procedure to form a suitable parametric domain 
                           
                              
                                 Ω
                              
                              
                                 ̂
                              
                           
                         and triangulation 
                           T
                         on which a globally-
                           
                              
                                 C
                              
                              
                                 r
                              
                           
                         polynomial basis can reproduce the exact NURBS boundary.

We obtain the parametric domain 
                           
                              
                                 Ω
                              
                              
                                 ̂
                              
                           
                         and its triangulation 
                           T
                         by adjusting those vertices in 
                           
                              
                                 T
                              
                              
                                 0
                              
                           
                         that correspond to knot-points of 
                           
                              
                                 C
                              
                              
                                 k
                              
                           
                           
                           
                              (
                              k
                              ≥
                              r
                              )
                           
                         smoothness in the boundary curves. We move each such boundary vertex to the line segment connecting the adjacent vertices of 
                           
                              
                                 C
                              
                              
                                 q
                              
                           
                           
                           
                              (
                              0
                              ≤
                              q
                              <
                              r
                              )
                           
                         smoothness. Fig. 5
                         illustrates this process starting from 
                           
                              
                                 T
                              
                              
                                 0
                              
                           
                         in Fig. 4. Smooth boundary vertices such as 
                           
                              
                                 
                                    v
                                 
                              
                              
                                 
                                    1
                                 
                              
                           
                           ,
                           
                              
                                 
                                    v
                                 
                              
                              
                                 
                                    3
                                 
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 
                                    v
                                 
                              
                              
                                 
                                    11
                                 
                              
                           
                         in Fig. 5(a) must be positioned so that a 
                           
                              
                                 C
                              
                              
                                 r
                              
                           
                         boundary trace can reproduce the original 
                           
                              
                                 C
                              
                              
                                 r
                              
                           
                         NURBS segment, as shown in Fig. 5(b). This implies that the adjusted vertices must be positioned so that the length-ratio of consecutive edges 
                           a
                           =
                           
                              |
                              
                                 
                                    
                                       v
                                    
                                 
                                 
                                    0
                                 
                              
                              
                                 
                                    
                                       v
                                    
                                 
                                 
                                    1
                                 
                              
                              |
                           
                         and 
                           b
                           =
                           
                              |
                              
                                 
                                    
                                       v
                                    
                                 
                                 
                                    1
                                 
                              
                              
                                 
                                    
                                       v
                                    
                                 
                                 
                                    2
                                 
                              
                              |
                           
                         is the same as the ratio of the corresponding knot intervals 
                           
                              |
                              
                                 
                                    t
                                 
                                 
                                    1
                                 
                              
                              −
                              
                                 
                                    t
                                 
                                 
                                    0
                                 
                              
                              |
                           
                           :
                           
                              |
                              
                                 
                                    t
                                 
                                 
                                    2
                                 
                              
                              −
                              
                                 
                                    t
                                 
                                 
                                    1
                                 
                              
                              |
                           
                         in the boundary NURBS curve.

If too few 
                           
                              
                                 C
                              
                              
                                 q
                              
                           
                           
                           
                              (
                              0
                              ≤
                              q
                              <
                              r
                              )
                           
                         knot points occur in the boundary to form a suitable domain 
                           
                              
                                 Ω
                              
                              
                                 ̂
                              
                           
                        , additional smooth knot points are used as corner vertices instead. Fig. 6 illustrates the formation of a suitable parametric domain from one NURBS curve. In this case, the smooth knot point 
                           
                              c
                           
                           
                              (
                              
                                 
                                    t
                                 
                                 
                                    k
                                 
                              
                              )
                           
                         is mapped from a corner vertex 
                           
                              
                                 
                                    v
                                 
                              
                              
                                 k
                              
                           
                        , and boundary vertices 
                           
                              
                                 
                                    v
                                 
                              
                              
                                 i
                              
                           
                         with corresponding knot values 
                           
                              
                                 t
                              
                              
                                 i
                              
                           
                         are arranged to satisfy (11). 
                           
                              (11)
                              
                                 
                                    |
                                    
                                       
                                          
                                             v
                                          
                                       
                                       
                                          0
                                       
                                    
                                    
                                       
                                          
                                             v
                                          
                                       
                                       
                                          1
                                       
                                    
                                    |
                                 
                                 :
                                 
                                    |
                                    
                                       
                                          
                                             v
                                          
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          
                                             v
                                          
                                       
                                       
                                          2
                                       
                                    
                                    |
                                 
                                 :
                                 ⋯
                                 :
                                 
                                    |
                                    
                                       
                                          
                                             v
                                          
                                       
                                       
                                          k
                                          −
                                          1
                                       
                                    
                                    
                                       
                                          
                                             v
                                          
                                       
                                       
                                          k
                                       
                                    
                                    |
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          1
                                       
                                    
                                    −
                                    
                                       
                                          t
                                       
                                       
                                          0
                                       
                                    
                                    )
                                 
                                 :
                                 
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          2
                                       
                                    
                                    −
                                    
                                       
                                          t
                                       
                                       
                                          1
                                       
                                    
                                    )
                                 
                                 :
                                 ⋯
                                 :
                                 
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          k
                                       
                                    
                                    −
                                    
                                       
                                          t
                                       
                                       
                                          k
                                          −
                                          1
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                         Note, if a degree-
                           d
                         NURBS curve has knots with multiplicity 
                           m
                         such that 
                           d
                           −
                           m
                           <
                           r
                        , i.e. the smoothness at the knots is lower than 
                           
                              
                                 C
                              
                              
                                 r
                              
                           
                        , the basis functions at the corresponding parametric locations thus cannot be 
                           
                              
                                 C
                              
                              
                                 r
                              
                           
                         smooth if exact recovery of NURBS boundary is to be enforced. Knots of lower-order continuity are therefore mapped from corner vertices with non-collinear adjacent boundary edges in the parametric domain.

We further assume that a stable local spline space  [21]
                        
                           
                              
                                 S
                              
                              
                                 d
                              
                              
                                 r
                              
                           
                           
                              (
                              T
                              )
                           
                         can be defined on 
                           T
                        . That is, apart from asserting 
                           
                              
                                 C
                              
                              
                                 0
                              
                           
                         continuity at parametric domain corners, we can assume that basis functions with support intersecting one edge of 
                           
                              
                                 Ω
                              
                              
                                 ̂
                              
                           
                         are independent of those intersecting another. The boundary of the triangulation now has the following property: 
                           Theorem 1
                           
                              For spline space 
                              
                                 
                                    
                                       S
                                    
                                    
                                       d
                                    
                                    
                                       r
                                    
                                 
                                 
                                    (
                                    T
                                    )
                                 
                              
                              , the space of boundary traces along the domain boundary 
                              
                                 
                                    
                                       Γ
                                    
                                    
                                       ̂
                                    
                                 
                               
                              is a set of closed univariate degree-
                              
                                 d
                              
                              
                                 B
                              
                              -splines with 
                              
                                 
                                    
                                       C
                                    
                                    
                                       r
                                    
                                 
                               
                              smoothness at each straight boundary vertex and 
                              
                                 
                                    
                                       C
                                    
                                    
                                       0
                                    
                                 
                               
                              for corner boundary vertices. Each knot span of the univariate 
                              
                                 B
                              
                              -splines has its length proportional to the length of corresponding linear segment in 
                              
                                 
                                    
                                       Γ
                                    
                                    
                                       ̂
                                    
                                 
                              
                              .
                           

Let 
                           
                              
                                 D
                              
                              
                                 d
                                 ,
                                 T
                              
                           
                         denote the set of domain points of degree-
                           d
                         for triangulation 
                           T
                           ,
                           
                              v
                           
                           ∈
                           
                              
                                 D
                              
                              
                                 
                                    d
                                 
                                 ,
                                 
                                    T
                                 
                              
                           
                         a domain point and 
                           
                              
                                 b
                              
                              
                                 
                                    v
                                 
                              
                           
                         its ordinate. The 
                           
                              
                                 C
                              
                              
                                 r
                              
                           
                         smoothness conditions (10) among Bézier ordinates imply the existence of a reduced set of domain points 
                           
                              
                                 M
                              
                              
                                 d
                                 ,
                                 T
                              
                           
                           ⊂
                           
                              
                                 D
                              
                              
                                 d
                                 ,
                                 T
                              
                           
                         whose Bézier ordinates, when freely specified, uniquely determine the remaining ordinates. This reduced set of free-nodes is called a Minimum Determining Set (MDS)  [21,33]. We define a basis 
                           
                              ψ
                           
                           
                              (
                              T
                              )
                           
                         for the spline space 
                           
                              
                                 S
                              
                              
                                 d
                              
                              
                                 r
                              
                           
                           
                              (
                              T
                              )
                           
                         in terms of these free-nodes as: 
                           
                              
                                 
                                    ψ
                                 
                                 
                                    (
                                    T
                                    )
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          ψ
                                       
                                       
                                          
                                             v
                                          
                                       
                                    
                                    ∈
                                    
                                       
                                          S
                                       
                                       
                                          d
                                       
                                       
                                          r
                                       
                                    
                                    
                                       (
                                       T
                                       )
                                    
                                    :
                                    
                                       v
                                    
                                    ∈
                                    
                                       
                                          M
                                       
                                       
                                          d
                                          ,
                                          T
                                       
                                    
                                    ,
                                    
                                       
                                          b
                                       
                                       
                                          
                                             v
                                          
                                       
                                    
                                    =
                                    1
                                    ,
                                    
                                       
                                          b
                                       
                                       
                                          
                                             u
                                          
                                       
                                    
                                    =
                                    0
                                    ,
                                    ∀
                                    
                                       u
                                    
                                    ≠
                                    
                                       v
                                    
                                    ∈
                                    
                                       
                                          M
                                       
                                       
                                          d
                                          ,
                                          T
                                       
                                    
                                    }
                                 
                                 .
                              
                           
                         We describe below how to construct 
                           
                              ψ
                           
                         from a given triangulation 
                           T
                         and how a free-node distribution can be chosen to allow us to directly specify a NURBS boundary.

To facilitate later discussion we extend the MDS concept from above to define the Boundary MDS 
                           
                              
                                 
                                    M
                                 
                                 
                                    d
                                    ,
                                    
                                       
                                          Γ
                                       
                                       
                                          ̂
                                       
                                    
                                 
                              
                            for the domain boundary 
                              
                                 
                                    Γ
                                 
                                 
                                    ̂
                                 
                              
                            as a minimum set of domain points along the boundary whose ordinates uniquely specify its trace.

Among the set of all the domain points 
                              
                                 
                                    D
                                 
                                 
                                    d
                                    ,
                                    Γ
                                 
                              
                            along the boundary of 
                              
                                 
                                    Γ
                                 
                                 
                                    ̂
                                 
                              
                            subject to the localization condition of Section  3.2, every 
                              
                                 
                                    C
                                 
                                 
                                    r
                                 
                              
                           -smooth vertex is subject to 
                              r
                            linear equations (10). Thus for every 
                              
                                 
                                    C
                                 
                                 
                                    r
                                 
                              
                           -smooth vertex, exactly 
                              r
                            Bézier ordinates must be determined from the other ordinates. Following the MDS concept in [21,33], we refer to these free ordinates as a minimal determining set for the domain boundary.

A Boundary MDS for the domain in Fig. 4 is indicated for the triangulation 
                              T
                            in Fig. 8(a).

The continuity constraints (10) essentially amount to a homogeneous linear system 
                              
                                 (12)
                                 
                                    
                                       A
                                    
                                    
                                       
                                          
                                             b
                                          
                                       
                                       
                                          D
                                       
                                    
                                    =
                                    0
                                 
                              
                            where 
                              
                                 A
                              
                            is a coefficient matrix depending on the geometry of the domain triangles and 
                              
                                 
                                    
                                       b
                                    
                                 
                                 
                                    D
                                 
                              
                            are 
                              n
                            Bézier ordinates for the corresponding domain points 
                              
                                 
                                    D
                                 
                                 
                                    d
                                    ,
                                    T
                                 
                              
                           . The 
                              i
                           -th row of 
                              
                                 A
                              
                            corresponds to the coefficients in the Bézier ordinates of the 
                              i
                           -th constraint and the 
                              j
                           -th column in 
                              
                                 A
                              
                            corresponds to the Bézier ordinate 
                              
                                 
                                    b
                                 
                                 
                                    j
                                 
                              
                           . The dimension of the space 
                              
                                 
                                    S
                                 
                                 
                                    d
                                 
                                 
                                    r
                                 
                              
                              
                                 (
                                 T
                                 )
                              
                            is 
                              dim
                              
                                 
                                    S
                                 
                                 
                                    d
                                 
                                 
                                    r
                                 
                              
                              
                                 (
                                 T
                                 )
                              
                              =
                              dim
                              
                                 
                                    S
                                 
                                 
                                    d
                                 
                                 
                                    0
                                 
                              
                              
                                 (
                                 T
                                 )
                              
                              −
                              
                                 rank
                              
                              
                                 (
                                 A
                                 )
                              
                           .

With the linear continuity constraints among the Bézier ordinates, only a subset of these ordinates can be free while the others are determined. For the given linear system 
                              
                                 A
                              
                              
                                 
                                    
                                       b
                                    
                                 
                                 
                                    D
                                 
                              
                              =
                              0
                           , through Gauss–Jordan elimination with pivoting (eg: row-wise partial pivoting) to match ordinates with their governing constraints, where both items below and above diagonal terms are zeroed, we obtain the following equation 
                              
                                 (13)
                                 
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         I
                                                      
                                                   
                                                   
                                                      
                                                         (
                                                         n
                                                         −
                                                         m
                                                         )
                                                      
                                                      ×
                                                      
                                                         (
                                                         n
                                                         −
                                                         m
                                                         )
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         R
                                                      
                                                   
                                                   
                                                      
                                                         (
                                                         n
                                                         −
                                                         m
                                                         )
                                                      
                                                      ×
                                                      m
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         0
                                                      
                                                   
                                                   
                                                      m
                                                      ×
                                                      
                                                         (
                                                         n
                                                         −
                                                         m
                                                         )
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         0
                                                      
                                                   
                                                   
                                                      m
                                                      ×
                                                      m
                                                   
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         b
                                                      
                                                   
                                                   
                                                      
                                                         (
                                                         n
                                                         −
                                                         m
                                                         )
                                                      
                                                      ×
                                                      1
                                                   
                                                   
                                                      d
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         b
                                                      
                                                   
                                                   
                                                      m
                                                      ×
                                                      1
                                                   
                                                   
                                                      f
                                                   
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    =
                                    
                                       A
                                    
                                    
                                       
                                          
                                             b
                                          
                                       
                                       
                                          
                                             
                                                D
                                             
                                             
                                                d
                                                ,
                                                T
                                             
                                          
                                       
                                    
                                    =
                                    0
                                    .
                                 
                              
                            In the above equation, we obtain 
                              n
                              −
                              m
                            Bézier ordinates 
                              
                                 
                                    
                                       b
                                    
                                 
                                 
                                    d
                                 
                              
                            that can be expressed as functions of 
                              m
                            free ordinates 
                              
                                 
                                    
                                       b
                                    
                                 
                                 
                                    f
                                 
                              
                           : 
                              
                                 (14)
                                 
                                    
                                       
                                          
                                             b
                                          
                                       
                                       
                                          
                                             (
                                             n
                                             −
                                             m
                                             )
                                          
                                          ×
                                          1
                                       
                                       
                                          d
                                       
                                    
                                    =
                                    −
                                    
                                       
                                          
                                             R
                                          
                                       
                                       
                                          
                                             (
                                             n
                                             −
                                             m
                                             )
                                          
                                          ×
                                          m
                                       
                                    
                                    
                                       
                                          
                                             b
                                          
                                       
                                       
                                          m
                                          ×
                                          1
                                       
                                       
                                          f
                                       
                                    
                                    .
                                 
                              
                            The 
                              m
                            free Bézier ordinates 
                              
                                 
                                    
                                       b
                                    
                                 
                                 
                                    f
                                 
                              
                            correspond to the domain points in 
                              
                                 
                                    M
                                 
                                 
                                    d
                                    ,
                                    T
                                 
                              
                           . We denote these ordinates as 
                              
                                 
                                    
                                       b
                                    
                                 
                                 
                                    
                                       
                                          M
                                       
                                       
                                          d
                                          ,
                                          T
                                       
                                    
                                 
                              
                           . Defining the augmented matrix 
                              
                                 C
                              
                              =
                              
                                 [
                                 
                                    
                                       
                                          −
                                          
                                             
                                                
                                                   R
                                                
                                             
                                             
                                                
                                                   (
                                                   n
                                                   −
                                                   m
                                                   )
                                                
                                                ×
                                                m
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   I
                                                
                                             
                                             
                                                n
                                                −
                                                m
                                                ×
                                                n
                                                −
                                                m
                                             
                                          
                                       
                                    
                                 
                                 ]
                              
                           , we have 
                              
                                 (15)
                                 
                                    
                                       
                                          
                                             b
                                          
                                       
                                       
                                          
                                             
                                                D
                                             
                                             
                                                d
                                                ,
                                                T
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             C
                                          
                                       
                                       
                                          T
                                       
                                    
                                    
                                       
                                          
                                             b
                                          
                                       
                                       
                                          
                                             
                                                M
                                             
                                             
                                                d
                                                ,
                                                T
                                             
                                          
                                       
                                    
                                    ,
                                 
                              
                            where the 
                              
                                 C
                              
                            matrix transforms the Bézier ordinates in 
                              
                                 
                                    M
                                 
                                 
                                    d
                                    ,
                                    T
                                 
                              
                            to ordinates in 
                              
                                 
                                    D
                                 
                                 
                                    d
                                    ,
                                    T
                                 
                              
                           .

In order to apply Dirichlet conditions and to specify a NURBS boundary, we could use a set of Lagrange multipliers as used in [16,17] to enforce boundary conditions. However, by requiring our MDS to contain a valid Boundary MDS (16) we are able to explicitly impose these conditions. 
                              
                                 (16)
                                 
                                    
                                       
                                          M
                                       
                                       
                                          d
                                          ,
                                          
                                             
                                                Γ
                                             
                                             
                                                ̂
                                             
                                          
                                       
                                    
                                    ⊂
                                    
                                       
                                          M
                                       
                                       
                                          d
                                          ,
                                          T
                                       
                                    
                                    .
                                 
                              
                            A Boundary MDS can be enforced by shifting columns 
                              
                                 
                                    M
                                 
                                 
                                    d
                                    ,
                                    T
                                 
                              
                            of 
                              
                                 A
                              
                            to the end during initial pivoting, or after Gauss–Jordan elimination, by exchanging any free-node with influence on the boundary with a constrained boundary node. A free-node appears in 
                              
                                 C
                              
                            as a column with a single 1 that is otherwise all zeros. If a constrained boundary node is dependent on a free internal node, then by scaling this free basis row, and adding multiples of it to zero the boundary node’s column, we replace the internal free-node by one on the boundary (Fig. 7
                           ). If all such cases are adjusted, then the complete boundary will be uniquely determined by its boundary free-nodes so giving us a boundary MDS.

An arbitrary piecewise polynomial function 
                              f
                              
                                 (
                                 
                                    ξ
                                 
                                 )
                              
                              :
                              
                                 ξ
                              
                              ∈
                              T
                            can be expressed in terms of the 
                              
                                 
                                    C
                                 
                                 
                                    0
                                 
                              
                            Bernstein Basis 
                              
                                 
                                    ϕ
                                 
                                 
                                    i
                                 
                              
                            and corresponding nodal ordinates 
                              
                                 
                                    b
                                 
                                 
                                    D
                                 
                              
                            as: 
                              
                                 (17)
                                 
                                    f
                                    
                                       (
                                       
                                          ξ
                                       
                                       )
                                    
                                    =
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          b
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          ϕ
                                       
                                       
                                          i
                                       
                                    
                                    
                                       (
                                       
                                          ξ
                                       
                                       )
                                    
                                    =
                                    
                                       
                                          
                                             b
                                          
                                       
                                       
                                          D
                                       
                                       
                                          T
                                       
                                    
                                    
                                       ϕ
                                    
                                    
                                       (
                                       
                                          ξ
                                       
                                       )
                                    
                                    .
                                 
                              
                            If 
                              f
                            is further 
                              
                                 
                                    C
                                 
                                 
                                    r
                                 
                              
                           -continuous, by (15), it can be expressed equivalently in terms of its free nodal ordinates 
                              
                                 
                                    b
                                 
                                 
                                    M
                                 
                              
                            as:
                              
                                 (18)
                                 
                                    f
                                    
                                       (
                                       
                                          ξ
                                       
                                       )
                                    
                                    =
                                    
                                       
                                          
                                             b
                                          
                                       
                                       
                                          D
                                       
                                       
                                          T
                                       
                                    
                                    
                                       ϕ
                                    
                                    
                                       (
                                       
                                          ξ
                                       
                                       )
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   b
                                                
                                             
                                             
                                                M
                                             
                                          
                                       
                                       
                                          T
                                       
                                    
                                    
                                       C
                                    
                                    
                                       ϕ
                                    
                                    
                                       (
                                       
                                          ξ
                                       
                                       )
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   b
                                                
                                             
                                             
                                                M
                                             
                                          
                                       
                                       
                                          T
                                       
                                    
                                    
                                       ψ
                                    
                                    
                                       (
                                       
                                          ξ
                                       
                                       )
                                    
                                    .
                                 
                              
                            That is, we have constructed the globally 
                              
                                 
                                    C
                                 
                                 
                                    r
                                 
                              
                            basis functions 
                              
                                 ψ
                              
                              
                                 (
                                 
                                    ξ
                                 
                                 )
                              
                              =
                              
                                 C
                              
                              
                                 ϕ
                              
                              
                                 (
                                 
                                    ξ
                                 
                                 )
                              
                            as a linear combination of the 
                              
                                 
                                    C
                                 
                                 
                                    0
                                 
                              
                            Bernstein basis 
                              
                                 ϕ
                              
                              
                                 (
                                 
                                    ξ
                                 
                                 )
                              
                           .

It may occur that a NURBS knot-point on the domain boundary is no more than 
                              
                                 
                                    C
                                 
                                 
                                    k
                                 
                              
                            smooth for some 
                              k
                              <
                              r
                           . In this case, by the method of Section  3.2 a corner of the parametric domain must be aligned with the knot point to ensure exact boundary representation. However, if the point is at least 
                              
                                 
                                    G
                                 
                                 
                                    1
                                 
                              
                            smooth this results in a loss of bijectivity at that point.

When global bijectivity is desired we amend our method as follows: In Section  3.2 we align corners of our polygon only with 
                              
                                 
                                    C
                                 
                                 
                                    0
                                 
                              
                            knot-points and any others needed to form a suitable polygonal domain. Around each of these latter vertices and those aligned with 
                              
                                 
                                    C
                                 
                                 
                                    k
                                 
                              
                            knot-points for 
                              k
                              <
                              r
                            we further select an internal macroelement edge across which to reduce continuity. We do this by removing constraints from 
                              
                                 A
                              
                            that bridge the edge, involve the vertex node, and are required to assure 
                              
                                 
                                    C
                                 
                                 
                                    k
                                    +
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    C
                                 
                                 
                                    r
                                 
                              
                            continuity. We call these exceptional vertices and exceptional edges. An example is shown in Figs. 16(c) and 18 where four exceptional vertices and respectively four exceptional edges are used to reduce continuity around the vertices/edges to avoid singularity in geometric mapping. As the model is refined, the exceptional edges become shorter. Such trading the local reduction of continuity for improvement of mesh quality can be especially beneficial in analysis, as demonstrated in Fig. 18.
                              Proposition 1
                              
                                 A globally bijective map 
                                 
                                    
                                       G
                                    
                                  
                                 can be obtained for any domain 
                                 
                                    Ω
                                  
                                 after exceptional vertex insertion and uniform refinement.
                              

We now have a coarse boundary-conformal Bézier mesh 
                           
                              
                                 
                                    G
                                 
                              
                              
                                 0
                              
                           
                         and parametric triangulation 
                           T
                         of the corresponding domain 
                           
                              
                                 Ω
                              
                              
                                 ̂
                              
                           
                        . While mesh refinements may be performed by inserting knot-points into the boundary before Step 1, or after Step 1, they can be performed as late as after generating 
                           T
                        . Whatever optional mesh refinements take place, in order to form a 
                           
                              
                                 C
                              
                              
                                 r
                              
                           
                         spline basis on our mesh (in particular the Clough–Tocher or Powell–Sabin splines), the final stage of refinement after forming 
                           T
                         must be its corresponding split. The subdivision of rTBS elements are topologically similar to the split as performed in the barycentric domain of each element  [34] (see Fig. 12). On the boundary, parametric equivalence between the rTBS subdivision and domain subdivision are strictly maintained. The interior control points for rTBS elements are overridden by a subset of free control points under 
                           
                              
                                 C
                              
                              
                                 r
                              
                           
                         constraints, and they provide a reference for 
                           
                              
                                 C
                              
                              
                                 r
                              
                           
                         mesh quality (see Section  5.1.1). Any refinements after forming 
                           T
                         must be applied in parallel to 
                           
                              G
                           
                         and 
                           T
                         to maintain index correspondence between domain points in 
                           T
                         and control points for 
                           
                              
                                 
                                    G
                                 
                              
                              
                                 0
                              
                           
                        .

With the 
                           
                              
                                 C
                              
                              
                                 r
                              
                           
                         basis 
                           
                              ψ
                           
                           
                              (
                              
                                 ξ
                              
                              )
                           
                         and domain points in the MDS 
                           
                              
                                 M
                              
                              
                                 d
                                 ,
                                 T
                              
                           
                        , we can now obtain the geometric map 
                           
                              G
                           
                           
                              (
                              
                                 ξ
                              
                              )
                           
                         in terms of the constructed 
                           
                              
                                 C
                              
                              
                                 r
                              
                           
                         basis functions 
                           
                              
                                 ψ
                              
                              
                                 j
                              
                           
                           :
                           
                              
                                 Ω
                              
                              
                                 ̂
                              
                           
                           →
                           R
                        , or equivalently, the 
                           
                              
                                 C
                              
                              
                                 0
                              
                           
                         Bernstein basis functions 
                           
                              
                                 ϕ
                              
                              
                                 i
                              
                           
                           :
                           
                              
                                 Ω
                              
                              
                                 ̂
                              
                           
                           →
                           R
                        , in the form 
                           
                              (19)
                              
                                 
                                    G
                                 
                                 
                                    (
                                    
                                       ξ
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                          
                                          
                                             m
                                          
                                       
                                       
                                          
                                             w
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             
                                                p
                                             
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             ψ
                                          
                                          
                                             i
                                          
                                       
                                       
                                          (
                                          
                                             ξ
                                          
                                          )
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                          
                                          
                                             m
                                          
                                       
                                       
                                          
                                             w
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             ψ
                                          
                                          
                                             i
                                          
                                       
                                       
                                          (
                                          
                                             ξ
                                          
                                          )
                                       
                                    
                                 
                              
                           
                         where 
                           
                              
                                 
                                    p
                                 
                              
                              
                                 i
                              
                           
                           =
                           
                              
                                 
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          x
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                              
                              
                                 i
                              
                           
                         are control points corresponding to domain points 
                           
                              
                                 
                                    q
                                 
                              
                              
                                 i
                              
                           
                         in 
                           
                              
                                 M
                              
                              
                                 d
                                 ,
                                 T
                              
                           
                        , and 
                           
                              
                                 w
                              
                              
                                 i
                              
                           
                         are the weights for the corresponding control points. Combining 
                           
                              
                                 
                                    p
                                 
                              
                              
                                 i
                              
                           
                         and 
                           
                              
                                 w
                              
                              
                                 i
                              
                           
                         in the homogeneous form as 
                           
                              (
                              
                                 
                                    w
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    
                                       
                                          x
                                       
                                       
                                          1
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    w
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    
                                       
                                          x
                                       
                                       
                                          2
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    w
                                 
                                 
                                    i
                                 
                              
                              )
                           
                        , we can obtain the map in homogeneous coordinates as 
                           
                              (20)
                              
                                 
                                    
                                       
                                          G
                                       
                                    
                                    
                                       
                                          (
                                          W
                                          )
                                       
                                    
                                 
                                 
                                    (
                                    
                                       ξ
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       
                                          P
                                       
                                    
                                    
                                       M
                                    
                                    
                                       
                                          
                                             
                                                (
                                                W
                                                )
                                             
                                          
                                          
                                             T
                                          
                                       
                                    
                                 
                                 
                                    ψ
                                 
                                 
                                    (
                                    
                                       ξ
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       
                                          P
                                       
                                    
                                    
                                       M
                                    
                                    
                                       
                                          
                                             
                                                (
                                                W
                                                )
                                             
                                          
                                          
                                             T
                                          
                                       
                                    
                                 
                                 
                                    C
                                 
                                 
                                    ϕ
                                 
                                 
                                    (
                                    
                                       ξ
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       
                                          P
                                       
                                    
                                    
                                       D
                                    
                                    
                                       
                                          
                                             
                                                (
                                                W
                                                )
                                             
                                          
                                          
                                             T
                                          
                                       
                                    
                                 
                                 
                                    ϕ
                                 
                                 
                                    (
                                    
                                       ξ
                                    
                                    )
                                 
                                 .
                              
                           
                         Then, 
                           
                              (21)
                              
                                 
                                    
                                       
                                          C
                                       
                                    
                                    
                                       T
                                    
                                 
                                 
                                    
                                       
                                          P
                                       
                                    
                                    
                                       M
                                    
                                    
                                       
                                          (
                                          W
                                          )
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          P
                                       
                                    
                                    
                                       D
                                    
                                    
                                       
                                          (
                                          W
                                          )
                                       
                                    
                                 
                                 .
                              
                           
                         That is, we can obtain control points of all the domain points 
                           
                              
                                 
                                    P
                                 
                              
                              
                                 D
                              
                              
                                 
                                    (
                                    W
                                    )
                                 
                              
                           
                         from those (
                           
                              
                                 
                                    P
                                 
                              
                              
                                 M
                              
                              
                                 
                                    (
                                    W
                                    )
                                 
                              
                           
                        ) of MDS.

The control points corresponding to boundary MDS 
                           
                              
                                 M
                              
                              
                                 d
                                 ,
                                 Γ
                              
                           
                         in the geometric map 
                           
                              G
                           
                           
                              (
                              
                                 ξ
                              
                              )
                           
                         are a subset of Bézier control points of the input NURBS curves. These control points can then be used to explicitly determine the boundary ordinates of 
                           
                              
                                 
                                    P
                                 
                              
                              
                                 M
                              
                              
                                 
                                    (
                                    W
                                    )
                                 
                              
                           
                         and so 
                           
                              
                                 P
                              
                              
                                 M
                              
                           
                        . Subject to the conditions of Theorem 1 we thus have the following proposition: 
                           Proposition 2
                           
                              The NURBS curves 
                              
                                 
                                    
                                       
                                          c
                                       
                                    
                                    
                                       i
                                    
                                 
                                 
                                    (
                                    ξ
                                    )
                                 
                               
                              in the boundary 
                              
                                 Γ
                               
                              can be exactly reproduced by the geometric map 
                              
                                 
                                    G
                                 
                                 
                                    (
                                    
                                       ξ
                                    
                                    )
                                 
                               
                              with the smooth basis 
                              
                                 
                                    ψ
                                 
                                 
                                    (
                                    
                                       ξ
                                    
                                    )
                                 
                               
                              in 
                              
                                 
                                    
                                       S
                                    
                                    
                                       d
                                    
                                    
                                       r
                                    
                                 
                                 
                                    (
                                    T
                                    )
                                 
                              
                              .
                           


                        Fig. 8
                         shows an rTBS discretization of the domain from Fig. 4 with Clough–Tocher split and one composed 
                           
                              
                                 C
                              
                              
                                 1
                              
                           
                         basis function 
                           ψ
                           
                              (
                              
                                 x
                              
                              )
                           
                           =
                           ψ
                           
                              (
                              
                                 ξ
                              
                              )
                           
                           ∘
                           
                              
                                 
                                    G
                                 
                              
                              
                                 −
                                 1
                              
                           
                           
                              (
                              
                                 x
                              
                              )
                           
                        .

In this section, we describe the basic procedure for isogeometric analysis with 
                        
                           
                              C
                           
                           
                              0
                           
                        
                      and 
                        
                           
                              C
                           
                           
                              r
                           
                        
                      triangular Bézier elements. Our approach is based on the Bézier mesh 
                        
                           
                              
                                 G
                              
                           
                           
                              0
                           
                        
                      for 
                        
                           
                              C
                           
                           
                              0
                           
                        
                      elements and 
                        
                           G
                        
                      and 
                        T
                      triangulation for 
                        
                           
                              C
                           
                           
                              r
                           
                        
                      analysis. The 
                        
                           
                              C
                           
                           
                              r
                           
                        
                      basis functions 
                        ψ
                        
                           (
                           
                              ξ
                           
                           )
                        
                      and 
                        
                           
                              C
                           
                           
                              0
                           
                        
                      basis functions 
                        ϕ
                        
                           (
                           
                              ξ
                           
                           )
                        
                      are respectively used for 
                        
                           
                              C
                           
                           
                              r
                           
                        
                      and 
                        
                           
                              C
                           
                           
                              0
                           
                        
                      elements. However, using the linear relationship 
                        
                           ψ
                        
                        
                           (
                           
                              ξ
                           
                           )
                        
                        =
                        
                           
                              
                                 C
                              
                           
                           
                              T
                           
                        
                        
                           ϕ
                        
                        
                           (
                           
                              ξ
                           
                           )
                        
                      and (9), integration can be done over the finest level of triangles 
                        τ
                        ∈
                        T
                     .

In this paper, we solve several linear partial differential equations including linear elasticity and advection–diffusion analysis. For linear elasticity, the strong form is 
                        
                           (22)
                           
                              
                                 
                                    
                                       ∇
                                    
                                 
                                 
                                    s
                                 
                                 
                                    T
                                 
                              
                              
                                 σ
                              
                              +
                              
                                 b
                              
                              =
                              0
                              ,
                           
                        
                      with displacement boundary condition 
                        
                           u
                        
                        =
                        
                           
                              g
                           
                           
                              D
                           
                        
                      on 
                        
                           
                              Γ
                           
                           
                              D
                           
                        
                      and traction 
                        
                           τ
                        
                        
                           n
                        
                        =
                        
                           
                              g
                           
                           
                              N
                           
                        
                      on 
                        
                           
                              Γ
                           
                           
                              N
                           
                        
                     . In advection–diffusion analysis, the following boundary-value problem is solved to determine the steady-state distribution of a substance propagated by a moving fluid 
                        
                           (23)
                           
                              −
                              ∇
                              κ
                              ∇
                              u
                              +
                              
                                 a
                              
                              ⋅
                              ∇
                              u
                              =
                              0
                              
                              in  
                              Ω
                           
                        
                      with Dirichlet conditions on 
                        
                           
                              Γ
                           
                           
                              D
                           
                        
                      and Neumann conditions on 
                        
                           
                              Γ
                           
                           
                              N
                           
                        
                     . Here, 
                        κ
                      is the diffusion coefficient of the substance and 
                        
                           a
                        
                      is the local fluid velocity.

Converting the above strong forms of PDEs into their weak forms, and discretizing these weak forms lead to a set of linear algebraic equations. For more details on such finite element methods, we refer the reader to any introductory textbook on finite element methods  [35,36]. In this paper, we apply the Galerkin formulation where test functions and the approximate solution are built from the basis constructed in the previous section. That is, we approximate the solution in the parametric domain as 
                        
                           (24)
                           
                              
                                 
                                    u
                                 
                                 
                                    ˆ
                                 
                              
                              
                                 (
                                 
                                    ξ
                                 
                                 )
                              
                              ≈
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    u
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    ψ
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 
                                    ξ
                                 
                                 )
                              
                              =
                              
                                 
                                    
                                       u
                                    
                                 
                                 
                                    T
                                 
                              
                              
                                 ψ
                              
                           
                        
                      where 
                        
                           
                              u
                           
                           
                              i
                           
                        
                      corresponds to the approximate solution’s Bézier ordinate at the domain point 
                        i
                      in parametric domain 
                        
                           
                              Ω
                           
                           
                              ̂
                           
                        
                     ’s triangulation 
                        T
                     . We can obtain the solution 
                        u
                        
                           (
                           
                              x
                           
                           )
                        
                      in the physical space by composing its representation 
                        
                           
                              u
                           
                           
                              ˆ
                           
                        
                        
                           (
                           
                              ξ
                           
                           )
                        
                      in the parametric domain with the inverse of the geometrical mapping 
                        
                           
                              G
                           
                           
                              −
                              1
                           
                        
                      so that 
                        u
                        :
                        Ω
                        →
                        R
                      is obtained by 
                        
                           
                              u
                              
                                 (
                                 
                                    x
                                 
                                 )
                              
                              =
                              
                                 
                                    u
                                 
                                 
                                    ˆ
                                 
                              
                              ∘
                              
                                 
                                    
                                       G
                                    
                                 
                                 
                                    −
                                    1
                                 
                              
                              
                                 (
                                 
                                    x
                                 
                                 )
                              
                           
                        
                      where 
                        
                           G
                        
                      can be 
                        
                           
                              
                                 G
                              
                           
                           
                              0
                           
                        
                      or 
                        
                           
                              
                                 G
                              
                           
                           
                              1
                           
                        
                      for 
                        
                           
                              C
                           
                           
                              0
                           
                        
                      and 
                        
                           
                              C
                           
                           
                              r
                           
                        
                      elements respectively. Fig. 9
                      illustrates the distribution of free-nodes governing a shaded 
                        
                           
                              C
                           
                           
                              0
                           
                        
                        ,
                        
                           
                              C
                           
                           
                              1
                           
                        
                      Powell–Sabin and 
                        
                           
                              C
                           
                           
                              1
                           
                        
                      Clough–Tocher element. Fig. 9(a) highlights the domain points with non-vanishing basis functions over the shaded 
                        
                           
                              C
                           
                           
                              0
                           
                        
                      triangular element. Fig. 9(b) and (c) respectively highlight free-nodes with non-vanishing basis functions over a Powell–Sabin and Clough–Tocher micro-element. Notably, the same local basis governs all micro-elements of one stable macroelement.

Inserting the basis functions 
                        
                           ϕ
                        
                      and the approximate solution (24) into the weak forms and assembling the linear system leads to the following integrals, respectively for stiffness, mass, and advection matrices 
                        
                           (25)
                           
                              
                                 
                                    
                                       (
                                       ∇
                                       
                                          
                                             ϕ
                                          
                                          
                                             j
                                          
                                       
                                       ,
                                       ∇
                                       
                                          
                                             ϕ
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                 
                                 
                                    Ω
                                 
                              
                              ,
                              
                              
                                 
                                    
                                       (
                                       
                                          
                                             ϕ
                                          
                                          
                                             j
                                          
                                       
                                       ,
                                       
                                          
                                             ϕ
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                 
                                 
                                    Ω
                                 
                              
                              ,
                              
                              
                                 
                                    
                                       (
                                       
                                          a
                                       
                                       ⋅
                                       ∇
                                       
                                          
                                             ϕ
                                          
                                          
                                             j
                                          
                                       
                                       ,
                                       
                                          
                                             ϕ
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                 
                                 
                                    Ω
                                 
                              
                           
                        
                      for 
                        
                           
                              C
                           
                           
                              0
                           
                        
                      elements where 
                        j
                      and 
                        i
                      correspond to domain control points in 
                        
                           
                              C
                           
                           
                              0
                           
                        
                      Bézier elements as shown in Fig. 9(a). Note 
                        
                           
                              
                                 (
                                 a
                                 ,
                                 b
                                 )
                              
                           
                           
                              Ω
                           
                        
                        =
                        
                           
                              ∫
                           
                           
                              Ω
                           
                        
                        a
                        b
                        
                           d
                        
                        Ω
                     . For 
                        
                           
                              C
                           
                           
                              r
                           
                        
                      elements, we have 
                        
                           (26)
                           
                              
                                 
                                    
                                       (
                                       ∇
                                       
                                          
                                             ψ
                                          
                                          
                                             j
                                          
                                       
                                       ,
                                       ∇
                                       
                                          
                                             ψ
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                 
                                 
                                    Ω
                                 
                              
                              ,
                              
                              
                                 
                                    
                                       (
                                       
                                          
                                             ψ
                                          
                                          
                                             j
                                          
                                       
                                       ,
                                       
                                          
                                             ψ
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                 
                                 
                                    Ω
                                 
                              
                              ,
                              
                              
                                 
                                    
                                       (
                                       
                                          a
                                       
                                       ⋅
                                       ∇
                                       
                                          
                                             ψ
                                          
                                          
                                             j
                                          
                                       
                                       ,
                                       
                                          
                                             ψ
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                 
                                 
                                    Ω
                                 
                              
                           
                        
                      where 
                        j
                      and 
                        i
                      correspond to free domain points in 
                        
                           
                              C
                           
                           
                              r
                           
                        
                      elements as shown in Fig. 9(b) and (c).

The numerical integrations of (25) and (26) are performed via quadrature over each domain triangle or boundary edge. For example, element 
                        
                           (
                           j
                           ,
                           i
                           )
                        
                      of the stiffness matrix is obtained as 
                        
                           (27)
                           
                              
                                 
                                    
                                       (
                                       ∇
                                       
                                          
                                             ψ
                                          
                                          
                                             j
                                          
                                       
                                       ,
                                       ∇
                                       
                                          
                                             ψ
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                 
                                 
                                    Ω
                                 
                              
                              ≈
                              
                                 
                                    ∑
                                 
                                 
                                    τ
                                    ∈
                                    T
                                 
                              
                              
                                 
                                    ∑
                                 
                                 
                                    k
                                 
                              
                              
                                 
                                    w
                                 
                                 
                                    k
                                 
                              
                              
                                 |
                                 
                                    
                                       J
                                    
                                    
                                       G
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             ξ
                                          
                                       
                                       
                                          k
                                       
                                    
                                    )
                                 
                                 |
                              
                              
                                 (
                                 ∇
                                 
                                    
                                       ψ
                                    
                                    
                                       i
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             ξ
                                          
                                       
                                       
                                          k
                                       
                                    
                                    )
                                 
                                 ⋅
                                 ∇
                                 
                                    
                                       ψ
                                    
                                    
                                       j
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             ξ
                                          
                                       
                                       
                                          k
                                       
                                    
                                    )
                                 
                                 )
                              
                           
                        
                      where 
                        τ
                      is a micro-triangle within a macro-triangle in 
                        T
                        ,
                        
                           
                              w
                           
                           
                              k
                           
                        
                      is the quadrature weight, and 
                        
                           
                              J
                           
                           
                              G
                           
                        
                      is the Jacobian of the geometric mapping. Due to the local support of our spline basis, this stiffness matrix is sparse. For example, with 
                        O
                        
                           (
                           
                              
                                 10
                              
                              
                                 3
                              
                           
                           )
                        
                      dof the quadratic and cubic basis functions of Example 1 showed on average 10 and 16 interactions respectively in the 
                        
                           
                              C
                           
                           
                              0
                           
                        
                      case and 18 and 23 interactions in the 
                        
                           
                              C
                           
                           
                              1
                           
                        
                      case. Note, however, that these results will vary depending on the specific triangulation and method of pivoting and basis used in Section  3.3.2. Basis functions with support at a given node 
                        ν
                      can be identified as rows 
                        μ
                      of the continuity matrix 
                        
                           C
                        
                      with non-zero entries in column 
                        ν
                     .

The Dirichlet boundary conditions can be imposed in a similar way as in NURBS-based isogeometric analysis  [2] since the trace of the parametric domain 
                        
                           
                              Ω
                           
                           
                              ̂
                           
                        
                      is a just a degree-
                        d
                        B
                     -spline curve with 
                        
                           
                              C
                           
                           
                              0
                           
                        
                      smoothness at corner vertices and 
                        
                           
                              C
                           
                           
                              r
                           
                        
                      at smooth vertices. That is, one simply projects the Dirichlet conditions into the degree-
                        d
                        B
                     -spline space with knots as per on Theorem 1, and then extracts the Bézier ordinates corresponding to the free-nodes in the Boundary MDS 
                        
                           
                              M
                           
                           
                              d
                              ,
                              Γ
                           
                        
                     .

In this section, we demonstrate rTBS-based isogeometric analysis of linear elasticity and advection–diffusion problems. We demonstrate the effect of incorporating both 
                        
                           
                              C
                           
                           
                              r
                           
                        
                      continuity and adaptive refinement in the analysis of the well-known linear elastic plate-hole problem and the advection–diffusion problem of complex topologies.

We apply our approach to a well-known linear elasticity problem: an infinite plate with a hole of radius 1 is subject to constant in-plane tension at infinity  [2]. The problem definition is in Fig. 10
                        . The exact solution for this problem is known from  [37] and is used to quantify our analysis error. For an error measure we use the 
                           
                              
                                 L
                              
                              
                                 2
                              
                           
                         measure of strain energy error, 
                           Δ
                           
                              (
                              
                                 σ
                              
                              ⋅
                              
                                 ϵ
                              
                              )
                           
                           
                              (
                              
                                 x
                              
                              )
                           
                        . We also use this measure on an element-wise basis to guide adaptive refinement by the Rivara method  [32].

For a given element type, the analysis accuracy and convergence rate depend on element quality. In this paper, thus far, we have focused on presenting a set of steps for establishing an rTBS-based geometric map 
                              
                                 G
                              
                              
                                 (
                                 
                                    ξ
                                 
                                 )
                              
                            that can exactly recover the given NURBS boundary. However, the interior of the geometric map that directly affects the rTBS element quality has not been explicitly addressed. We here briefly describe how we use smoothing to improve the mesh quality. A formal study of mesh quality and convergence rate is outside of the scope of this paper.

The factors that can be adjusted to affect mesh quality include the internal control points of 
                              
                                 
                                    
                                       G
                                    
                                 
                                 
                                    0
                                 
                              
                            in Step 1, the free internal control points for 
                              
                                 G
                              
                           , and the internal and corner boundary vertex positions of 
                              T
                            in Step 2. For the internal control points 
                              
                                 
                                    
                                       P
                                    
                                 
                                 
                                    
                                       
                                          0
                                       
                                       
                                          I
                                       
                                    
                                 
                              
                            of 
                              
                                 
                                    
                                       G
                                    
                                 
                                 
                                    0
                                 
                              
                            we apply Laplacian smoothing on the Bézier control net of 
                              
                                 
                                    
                                       G
                                    
                                 
                                 
                                    0
                                 
                              
                           . The free internal control points 
                              
                                 
                                    
                                       P
                                    
                                 
                                 
                                    I
                                 
                              
                            corresponding to internal domain points in the MDS 
                              
                                 
                                    M
                                 
                                 
                                    d
                                    ,
                                    T
                                 
                              
                            can be freely chosen to improve the mapping quality. Note 
                              
                                 
                                    
                                       P
                                    
                                 
                                 
                                    M
                                 
                              
                              =
                              
                                 
                                    
                                       P
                                    
                                 
                                 
                                    B
                                 
                              
                              ∪
                              
                                 
                                    
                                       P
                                    
                                 
                                 
                                    I
                                 
                              
                           . Here we simply choose these free internal control points 
                              
                                 
                                    
                                       P
                                    
                                 
                                 
                                    I
                                 
                              
                            so that the Bézier control points 
                              
                                 
                                    
                                       C
                                    
                                 
                                 
                                    T
                                 
                              
                              
                                 
                                    
                                       P
                                    
                                 
                                 
                                    M
                                 
                                 
                                    W
                                 
                              
                            for 
                              
                                 G
                              
                              
                                 (
                                 
                                    ξ
                                 
                                 )
                              
                            are as close as possible to the control points 
                              
                                 
                                    
                                       P
                                    
                                 
                                 
                                    0
                                 
                                 
                                    W
                                 
                              
                            for 
                              
                                 
                                    
                                       G
                                    
                                 
                                 
                                    0
                                 
                              
                            in the least-squares sense, i.e.  
                              
                                 (28)
                                 
                                    
                                       
                                          min
                                       
                                       
                                          
                                             
                                                
                                                   P
                                                
                                             
                                             
                                                I
                                             
                                          
                                       
                                    
                                    
                                       |
                                       
                                          
                                             
                                                P
                                             
                                          
                                          
                                             0
                                          
                                          
                                             W
                                          
                                       
                                       −
                                       
                                          
                                             
                                                C
                                             
                                          
                                          
                                             T
                                          
                                       
                                       
                                          
                                             
                                                P
                                             
                                          
                                          
                                             M
                                          
                                          
                                             W
                                          
                                       
                                       |
                                    
                                    .
                                 
                              
                            As for internal and corner boundary vertices, we have observed that the smoothness of the geometric map 
                              
                                 G
                              
                            is improved if the internal corner angles 
                              
                                 
                                    θ
                                 
                                 
                                    i
                                 
                                 
                                    
                                       (
                                       T
                                       )
                                    
                                 
                              
                            of 
                              T
                            (see Fig. 11
                           (b) and (d)) approximate the corresponding boundary angles 
                              
                                 
                                    θ
                                 
                                 
                                    i
                                 
                                 
                                    
                                       (
                                       G
                                       )
                                    
                                 
                              
                            of 
                              
                                 G
                              
                            (see Fig. 11(a)). This is achieved by freely varying the corner vertex positions 
                              
                                 
                                    
                                       v
                                    
                                 
                                 
                                    i
                                 
                              
                            of 
                              T
                            (shown in Fig. 11(b) and (d)) to minimize the angle difference. 
                              
                                 (29)
                                 
                                    
                                       
                                          min
                                       
                                       
                                          
                                             
                                                
                                                   v
                                                
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    f
                                    
                                       (
                                       
                                          
                                             Ω
                                          
                                          
                                             ˆ
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                       
                                    
                                    
                                       |
                                       
                                          
                                             θ
                                          
                                          
                                             i
                                          
                                          
                                             
                                                (
                                                T
                                                )
                                             
                                          
                                       
                                       −
                                       
                                          
                                             θ
                                          
                                          
                                             i
                                          
                                          
                                             
                                                (
                                                
                                                   G
                                                
                                                )
                                             
                                          
                                       
                                       |
                                    
                                    .
                                 
                              
                            Remaining boundary vertices in 
                              T
                            are then determined based on (11), and internal vertices in 
                              T
                            are determined by Laplacian smoothing. This process is performed immediately after Step 2 but before mesh refinement. The result is illustrated in Fig. 11(e). Fig. 12
                            shows the entire process of obtaining rTBS discretization of the plate-hole domain with Powell–Sabin split and one 
                              
                                 
                                    C
                                 
                                 
                                    1
                                 
                              
                            basis 
                              ψ
                              
                                 (
                                 
                                    x
                                 
                                 )
                              
                           .

In our convergence study, we use the parametric domain 
                              T
                            shown in Fig. 11(c) as produced by our mesh smoothing algorithm. Since this domain has five corners, a NURBS parametrization of this domain either requires the domain to be split by a 
                              
                                 
                                    C
                                 
                                 
                                    0
                                 
                              
                            knot curve, or requires two control points to lie atop each other, resulting in a singularity in the mapping. In contrast, by using an rTBS mesh with a polygonal parametric domain, we can form a globally 
                              
                                 
                                    C
                                 
                                 
                                    1
                                 
                              
                           -smooth basis on this domain.

By performing uniform or adaptive 
                              h
                           -refinement and 
                              p
                           -refinement, we can increase the number of degrees of freedom (DOF) used for analysis. Fig. 13
                            shows the 
                              
                                 
                                    C
                                 
                                 
                                    0
                                 
                              
                            rTBS elements in spline space 
                              
                                 
                                    S
                                 
                                 
                                    2
                                 
                                 
                                    0
                                 
                              
                              
                                 (
                                 T
                                 )
                              
                            and 
                              
                                 
                                    C
                                 
                                 
                                    1
                                 
                              
                            rTBS elements via Powell–Sabin splits in 
                              
                                 
                                    S
                                 
                                 
                                    2
                                 
                                 
                                    1
                                 
                              
                              
                                 (
                                 
                                    
                                       T
                                    
                                    
                                       P
                                       S
                                    
                                 
                                 )
                              
                            under uniform and adaptive 
                              h
                           -refinement. The corresponding convergence data for uniform and adaptive refinement are shown in Fig. 15(a). The convergence rate of the 
                              L
                              2
                            norm of the energy error over the DOF is shown in the legend of each curve.

After degree-elevating 
                              
                                 
                                    
                                       G
                                    
                                 
                                 
                                    0
                                 
                              
                            to a cubic mesh, we can form a 
                              
                                 
                                    C
                                 
                                 
                                    1
                                 
                              
                            basis using either the Clough–Tocher or the Powell–Sabin splits. Free-node distributions for these meshes as compared with the simple 
                              
                                 
                                    C
                                 
                                 
                                    0
                                 
                              
                            rTBS case are shown in Fig. 14
                           (a) through (c), and convergence data are shown in 15(b). By degree-elevating 
                              
                                 
                                    
                                       G
                                    
                                 
                                 
                                    0
                                 
                              
                            to a quintic mesh (Fig. 14(d)) we can achieve a stable 
                              
                                 
                                    C
                                 
                                 
                                    1
                                 
                              
                            basis without performing any further macroelement splits (Fig. 14(e)). Alternatively, by using a Powell–Sabin split we can achieve a 
                              
                                 
                                    C
                                 
                                 
                                    2
                                 
                              
                            rTBS basis for our domain. Convergence data comparing quintic 
                              
                                 
                                    C
                                 
                                 
                                    0
                                 
                              
                              ,
                              
                                 
                                    C
                                 
                                 
                                    1
                                 
                              
                            and 
                              
                                 
                                    C
                                 
                                 
                                    2
                                 
                              
                            bases are shown in Fig. 15(c). The condition numbers for the stiffness matrix for splines in Fig. 13(b) and (c) and in Fig. 14 are respectively 5.12e3, 1.91e4, 5.42e3,1.37e4, 7.06e3, 5.66e3, 1.25e4 and 2.76e4.

These convergence results demonstrate that first, when 
                              
                                 
                                    C
                                 
                                 
                                    0
                                 
                              
                            continuity is used, our method of automatic and adaptive 
                              
                                 
                                    C
                                 
                                 
                                    0
                                 
                              
                            rTBS meshing leads to nice convergence behaviors. Second, when 
                              
                                 
                                    C
                                 
                                 
                                    1
                                 
                              
                            continuity is required, we have shown that the quadratic Powell–Sabin, cubic Clough–Tocher, and quintic unstructured splines all converge nicely. Third, although preliminary results show that 
                              
                                 
                                    C
                                 
                                 
                                    2
                                 
                              
                            rTBS-based analysis does not perform as well compared with 
                              
                                 
                                    C
                                 
                                 
                                    0
                                 
                              
                            and 
                              
                                 
                                    C
                                 
                                 
                                    1
                                 
                              
                            rTBS-based IgA by our method, we have shown that 
                              
                                 
                                    C
                                 
                                 
                                    2
                                 
                              
                            rTBS-based analysis is viable. Future work will investigate the optimal convergence rate of high-order continuous rTBS-based analysis.

In this example (see Figs. 16 and 19) we demonstrate the automatic 
                           
                              
                                 C
                              
                              
                                 1
                              
                           
                         meshing and analysis of a genus-1 and a genus-4 domain by applying the stabilized Streamline Upwind Petrov–Galerkin (SUPG) method to solve advection–diffusion problems. The inner boundary is held at 
                           u
                           =
                           1
                         and the outer boundary at 
                           u
                           =
                           0
                        . The domain is then subject to a constant flow 
                           
                              a
                           
                         to the right, and a low diffusion coefficient 
                           κ
                        . The anticipated shear boundary layers are shown as red-dashed lines in this figure.


                        Fig. 16 details the process of obtaining 
                           
                              
                                 C
                              
                              
                                 0
                              
                           
                         and 
                           
                              
                                 C
                              
                              
                                 1
                              
                           
                         rTBS discretization of the genus 1 domain. The inner circle is mapped to a quadrilateral corresponding to four rational Bézier curves in Fig. 16(c). Fig. 16(d) and (e) highlight the local refinement along the flow boundaries. The Powell–Sabin split is used to obtain a quadratic 
                           
                              
                                 C
                              
                              
                                 1
                              
                           
                         basis, and to avoid singularity in the 
                           
                              
                                 C
                              
                              
                                 1
                              
                           
                         mapping 
                           
                              G
                           
                        , four exceptional edges are introduced (shown as red in Fig. 16(e)) in the resulting triangulation 
                           T
                        . Fig. 17
                         shows the solution at cross-sections (
                           x
                           =
                           2
                        ) from equivalent 
                           
                              
                                 C
                              
                              
                                 0
                              
                           
                         and 
                           
                              
                                 C
                              
                              
                                 1
                              
                           
                         macroelement meshes. It can be seen that 
                           
                              
                                 C
                              
                              
                                 0
                              
                           
                         solution has sharp features while 
                           
                              
                                 C
                              
                              
                                 1
                              
                           
                         solution is smooth and is free from high frequency noise. Fig. 18
                         compares the analysis result from globally 
                           
                              
                                 C
                              
                              
                                 1
                              
                           
                         mesh without (Fig. 18(a)) and with exceptional edges (Fig. 18(b)). As shown in the inset in Fig. 18(a), without exceptional edges there is singularity in the geometric mapping and more visible oscillation in the solution. The analysis mesh is obtained from uniform refinement as shown in Fig. 18(c)–(e). It can be seen that exceptional edges are receding and becoming shorter during the refinement.

The isogeometric meshing and analysis of the genus-4 domain are shown in Fig. 19
                        . After local refinement of 
                           
                              
                                 
                                    G
                                 
                              
                              
                                 0
                              
                           
                         to resolve shear boundary layers (Fig. 19(b)), uniform refinement by the Powell–Sabin split, and performing the projections of Step 3, then the rTBS mesh (shown in Fig. 19(c)) is constructed. In Fig. 19(c), 16 exceptional vertices with 4 for each circle are introduced. The resulting analysis field is again globally bijective and 
                           
                              
                                 C
                              
                              
                                 1
                              
                           
                         smooth except in the immediate vicinity of each exceptional vertex.

@&#CONCLUSIONS@&#

We have presented a new isogeometric analysis approach based on rational Triangular Bézier Splines (rTBS). The rTBS parametrization of a NURBS-bounded domain can be fully automated. This approach is applicable to complex topologies. Various local refinement schemes can be readily implemented. We have presented a set of procedures for constructing a globally 
                        
                           
                              C
                           
                           
                              r
                           
                        
                     -continuous basis for representing both physical field and the domain geometry with exact recovery of its NURBS boundary. We have also introduced the concept of exceptional vertices/edges where a reduced set of continuity constraints is imposed at boundary vertices. The reduced continuity at exceptional vertices and edges leads to global bijectivity and improved mesh quality and analysis results. Unlike tensor-product NURBS, such reduced continuity becomes highly localized with mesh refinement. This rTBS-based isogeometric analysis has been shown to be convergent with mesh refinement on linear elasticity and advection–diffusion problems.

Future work will focus on improving rTBS element quality to achieve optimal convergence rate, studying the nestedness of spline space, and extending this approach to three-dimensional problems.

@&#REFERENCES@&#

