@&#MAIN-TITLE@&#Geometry-based vs. intensity-based medical image registration: A comparative study on 3D CT data

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A review study comparing conventional intensity-based and geometry-based registration methodologies.


                        
                        
                           
                           Three major registration frameworks were examined: (a) intensity-based, exhaustive registration framework using three distinct cost functions (b) geometry-based registration framework, featuring three geometrical descriptors (c) the original implementation of the Iterative Closest Point algorithm.


                        
                        
                           
                           Use of geometrical feature descriptors for aligning 3D medical data.


                        
                        
                           
                           All compared techniques were applied to CT data pairs with known and unknown initial spatial differences.


                        
                        
                           
                           Geometry-based and intensity-based techniques perform similarly, as far as accuracy is concerned, but geometry-based methods significantly reduce processing time.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Image registration

Geometry-based registration

Geometrical descriptors

Computed Tomography

@&#ABSTRACT@&#


               
               
                  Spatial alignment of Computed Tomography (CT) data sets is often required in numerous medical applications and it is usually achieved by applying conventional exhaustive registration techniques, which are mainly based on the intensity of the subject data sets. Those techniques consider the full range of data points composing the data, thus negatively affecting the required processing time. Alternatively, alignment can be performed using the correspondence of extracted data points from both sets. Moreover, various geometrical characteristics of those data points can be used, instead of their chromatic properties, for uniquely characterizing each point, by forming a specific geometrical descriptor. This paper presents a comparative study reviewing variations of geometry-based, descriptor-oriented registration techniques, as well as conventional, exhaustive, intensity-based methods for aligning three-dimensional (3D) CT data pairs. In this context, three general image registration frameworks were examined: a geometry-based methodology featuring three distinct geometrical descriptors, an intensity-based methodology using three different similarity metrics, as well as the commonly used Iterative Closest Point algorithm. All techniques were applied on a total of thirty 3D CT data pairs with both known and unknown initial spatial differences. After an extensive qualitative and quantitative assessment, it was concluded that the proposed geometry-based registration framework performed similarly to the examined exhaustive registration techniques. In addition, geometry-based methods dramatically improved processing time over conventional exhaustive registration.
               
            

@&#INTRODUCTION@&#

The accurate and efficient alignment of imaging data is often required in a wide variety of applications, such as computer vision, pattern recognition, robotics, motion tracking and medicine [1–6]. Especially medical imaging data, acquired from the same patient over different time intervals or from various patients (atlases), can be compared for assessing the regression or progression of certain diseases or pathomorphic conditions, or even the effectiveness of particular pharmaceutical therapies or surgical procedures [7–9]. In order to ease the assessment process, or even partially automate it, the compared imaging data need to be spatially aligned.

The alignment process is usually described as image registration. Most conventional registration algorithms comprise of an iterative trial-and-error procedure, in an attempt to optimize a given transformation function after a finite number of trials [10]. The transformation function describes the geometrical model that needs to be applied to a data set or image (floating), in order to spatially align it with respect to a reference data set or image. Various transformation models can be used for registering imaging data, ranging from simple translations to more complex rigid transforms, such as affine, similitude and projective, or even non-rigid, elastic models, such as Thin Plate Splines [8–13]. The selection of the transformation model mainly depends on the physiology of the processed data and the requirements of the application. During each step of the iterative process, new parameters are produced for the selected transformation model, according to a preferred optimization algorithm. Usually, the optimization technique estimates parameters for the transformation model, based on a preferred similarity metric [14]. Most optimization methods are based on well-established mathematical models, such as the Downhill Simplex (Nelder-Mead) model and Powell’s approach [15]. More advanced optimization techniques, however, may be based on genetic algorithms and neural networks [16–17]. During each iteration of the optimization algorithm, its performance is assessed through a measure of match or error function, which quantizes the similarity or differences between the reference and the transformed floating data sets [14]. Some of the most commonly employed measures of match include the Correlation Coefficient, the Mutual Information, the Mean Squared Error, the Gradient Difference and various distance-based techniques or statistical measurements [18–21].

In most cases, the aforementioned repetitive process is performed over the entire information range of the subject data sets. This enhances the accuracy of the underlying registration algorithms, but also introduces a high level of redundancy, since areas of the data with low information content are also considered [10]. When processing two-dimensional (2D) medical images, the added redundancy does not greatly affect the efficiency of the algorithm, as the limited size of the data guarantees reasonable processing times. However, when considering multi-dimensional data sets, such as three-dimensional (3D) Computed Tomography (CT) or Magnetic Resonance Imaging (MRI) volumes, registration by conventional means may negatively impact on the efficiency of the alignment scheme [16]. 3D volumes usually consist of several 2D digital images, hence dramatically increasing the required processing time.

Instead of considering the entire information range of the processed data, the registration algorithm may only work with a very limited set of data points [22,23]. The particular data points may either be selected randomly, by equally distributed sub-sampling of the original data, or by selecting a set of distinct points (key-points) [24]. The latter case theoretically maximizes the efficiency of the registration scheme, as the points with maximum information content are only considered. The end result of the above process, whichever the preferred technique, should be a set of points for each data set (reference and floating). These point sets are usually called point clouds and are essentially a uniform or non-uniform sample of the original data points [25]. In order to align the two produced point clouds, the correspondences between them need to be accurately estimated. As with conventional exhaustive registration techniques, correspondences can be estimated through a repetitive trial-and-error procedure [22,26]. Again, correspondences are formed, based on specific similarity metrics. Those metrics may be based on the luminosity level of the examined data points or on specific geometrical features [27]. The latter can be especially advantageous when processing medical data from different modalities (CT-MRI, CT-PET, etc.) or data acquired using varying acquisition protocols, as they alleviate any possible chromatic incompatibility that may negatively impact on the registration process [27].

Several feature descriptors have been proposed, which completely discard the luminosity information of the modeled data points, for several computer vision applications, such as pattern recognition and registration [25,26]. Some of the most commonly employed descriptors include the Point Feature Histogram (PFH) and its fast derivative (FPFH), the Signatures of Histograms of OrienTations (SHOT) and Surface Normals (SN) [28–31]. Most of those descriptors have been used in the past for aligning 3D object models, but to our knowledge they were never applied on medical data. All of the above descriptors produce a unique histogram or signature for each data point in the reference and floating point clouds. By directly comparing those unique identifiers, it is possible to determine the best point matches between the two point clouds, usually by minimizing a distance function, thus forming the desired point correspondences [32]. In turn, the obtained corresponding points can be used for estimating a global transformation function, by extrapolating the mathematical relationships between the corresponding points, over the entire set of correspondences [33]. Finally, the estimated global transformation may be applied to all points of the floating data set in order to align it with respect to the reference set. Since point-based registration techniques only use a small fraction of the processed data points, they are usually much faster than conventional exhaustive registration methods, albeit less accurate, due to the limitation of the available information range [10].

Considering all of the above, the purpose of the presented study is twofold: Firstly, a registration framework is proposed for aligning CT data, based only on the geometrical characteristics of individual data points as extracted from both data sets. This allows the registration of the medical data without using their chromatic properties; thus, dramatically reducing the required processing time, without negatively affecting the quality of the registration in terms of accuracy. Secondly, a comprehensive comparison is performed, considering conventional, exhaustive registration methodologies based on the intensity of the examined data, as well as geometry-based methods which only consider the geometrical properties of a limited set of individual points.

Specifically, three conventional, exhaustive, intensity-based registration techniques have been considered, based on the Correlation Coefficient (CC) [18], Mattes Mutual Information (MMI) [34] and the Mean Squared Error (MSE) metrics [35]. In contrast, three feature descriptors were employed in the proposed geometry-based registration scheme, namely, the Fast Point Feature Histogram (FPFH) [28], the Signatures of Histograms of OrienTations (SHOT) [29] and Surface Normals (SN) [31]. In addition, the widely used Iterative Closest Point (ICP) algorithm was also considered as a point-based registration approach [22]. All of the above methods were applied on the same data sets of 3D CT image volumes, specifically, ten volume pairs with known initial spatial differences and 20 more pairs with unknown initial deviations.

The rest of the paper is organized as follows: In Section 2 a brief presentation of the acquired data is performed, along with a detailed description of the featured registration techniques. Both qualitative and quantitative results are illustrated in Section 3. In Section 4 the key aspects of the examined techniques are discussed, as well as future directions for a generalized application of the geometry-based registration techniques.

@&#METHODOLOGY@&#

The proposed study focuses on the spatial alignment of Computed Tomography (CT) medical data volumes, using both conventional, exhaustive, intensity-based registration methods, as well as purely geometry-based registration schemes. Exhaustive registration usually provides superior alignment accuracy, at the cost of increased processing time, especially for large data sets. On the other hand, geometry-based registration techniques operate on a small subset of the overall data information and extrapolate the resulting alignment model globally to the entire image support of the processed data sets. Methods from both of the above digital image registration categories are considered in this study and are applied to several 3D CT data volumes.

The proposed comparative study was performed using 20 3D CT data sets, acquired from a study examining a novel periodontal bone augmentation surgical procedure [36]. Twenty patients were treated in a two stage approach. At stage one, the augmentation procedure was carried out using a newly developed partial thickness flap. If possible, implants were simultaneously placed. The edentulous ridge was augmented vertically and horizontally with non-resorbable bovine mineral and locally retrieved autogenous bone chips. After grafting, a non-resorbable titanium membrane or a resorbable membrane was trimmed and adapted over the grafted area. The membrane was fixed by titanium pins. After 9–12 months postoperatively, reentry was performed. Clinically, the vertically and horizontally enlarged alveolar ridge displayed similar clinical appearance to the neighboring bone. Implant surfaces were covered by newly formed hard tissue. Fixation and cover screws were removed to allow access for abutment connection. Healing abutments were then inserted. For each examined patient, a preoperative CT was acquired before the application of the above medical protocol and a subsequent post-operative acquisition was performed after the 9–12 months surgical reentry in order to assess the effectiveness of the augmentation technique. In any case, the preoperative CT corresponds to the reference data set of the registration procedure, while the postoperative acquisition is considered as the floating data set.

Through the above procedure, 20 CT pairs where formed (one for each examined patient) with unknown initial spatial differences. Those data pairs were supplemented with an additional ten data pairs with predefined spatial deviations, according to the following protocol: Ten reference preoperative data sets were selected from the above clinical study. Then, each of those data sets were manually modified by applying various affine geometrical transformations, with translations along the x-, y- and z-axis, ranging from 0 to 15 pixels and rotations, ranging from 0 to 10 degrees. The transformed volumes were considered as the floating data sets of the newly formed data pairs. Thus, a total of 30 CT volume pairs (20 with unknown and 10 with known initial spatial differences) were available for the purposes of this study. All data sets consisted of 325 slices each of which had a size of 400×400 pixels. In all cases the resolution (voxel size) was 0.4×0.4×0.4mm3.

The primary objective of this study is to apply purely geometry-based registration techniques on CT data. In this context, a complete methodology is proposed for aligning 3D point clouds originating from CT volumes. The proposed methodology consists of several distinct procedures which are carried out sequentially. An overview of the methodology can be seen in 
                        Fig. 1. Initially, the processed data sets are modeled as point clouds, based on the bone structures depicted in the CT images. In our case, the resulting point clouds did not contain any chromatic information of the modeled points, as registration is purely based on their geometric characteristics. Hence, two 3D point clouds are considered, the reference and floating point clouds, which are down-sampled for reducing complexity. Those clouds can be described using, several geometrical point descriptors. In this study, three such descriptors were considered: Surface Normals (SN), Fast Point Feature Histograms (FPFH) and Signatures of Histograms of Orientations (SHOT) [28–31]. By utilizing both point clouds and their respective feature descriptors, a set of correspondences is calculated through an iterative error minimization process, based on k-dimensional trees [37]. This set of correspondences may contain outliers, which need to be excluded through a suitable outlier rejection procedure, in order to improve the overall accuracy of the proposed methodology. In our case, the RANdom SAmple Consensus (RANSAC) algorithm was preferred [38]. The remaining correspondences are used to estimate the final global affine transformation, through Singular Value Decomposition (SVD) [39]. The resulting transformation is finally applied to the floating data set in order to spatially align it with respect to the reference data set.

Apart from the descriptor-based registration scheme, a classic implementation of the Iterative Closest Point (ICP) algorithm was also included in the comparative study [22].

Due to the fact that the acquired datasets consist of several millions of points, it is critical to reduce their size in order to reduce processing time [40]. For this purpose, the 3D Harris operator was employed, for extracting a limited number of key points from the processed data sets [41]. The particular approach was preferred due to the fact that it ensures that the detected points of interest have low probability of appearing in other locations in the same dataset [41,42].

The Harris operator locates the most distinct points of the entire dataset according to the Local Autocorrelation of the examined points. Local Autocorrelation considers the spatial derivatives of the function 
                              
                                 f
                                 (
                                 x
                                 ,
                                 y
                                 ,
                                 z
                                 )
                              
                            which represents the initial data, as can be seen in the following equation [41]:
                              
                                 (1)
                                 
                                    
                                       
                                          R
                                       
                                       
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                ,
                                             
                                             
                                                y
                                             
                                             
                                                ,
                                             
                                             
                                                z
                                             
                                          
                                          )
                                       
                                       
                                          =
                                       
                                       
                                          
                                             ∑
                                          
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   
                                                      
                                                         z
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   {
                                                
                                                
                                                   G
                                                
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      
                                                         ,
                                                      
                                                      
                                                         
                                                            y
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      
                                                         ,
                                                      
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                   )
                                                
                                                
                                                   
                                                      [
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            (
                                                            
                                                               
                                                                  
                                                                     x
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                               
                                                                  +
                                                               
                                                               
                                                                  Δ
                                                               
                                                               
                                                                  x
                                                               
                                                               
                                                                  ,
                                                               
                                                               
                                                                  
                                                                     y
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                               
                                                                  +
                                                               
                                                               
                                                                  
                                                                     Δ
                                                                  
                                                                  y
                                                               
                                                               
                                                                  ,
                                                               
                                                               
                                                                  
                                                                     z
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                               
                                                                  +
                                                               
                                                               
                                                                  
                                                                     Δ
                                                                  
                                                                  z
                                                               
                                                            
                                                            )
                                                         
                                                         
                                                            −
                                                         
                                                         
                                                            f
                                                         
                                                         
                                                            (
                                                            
                                                               
                                                                  
                                                                     x
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                               
                                                                  ,
                                                               
                                                               
                                                                  
                                                                     y
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                               
                                                                  ,
                                                               
                                                               
                                                                  
                                                                     z
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                      ]
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   }
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

In this case, 
                              
                                 G
                                 (
                              
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                              
                                 ,
                              
                              
                                 
                                    y
                                 
                                 
                                    i
                                 
                              
                              
                                 ,
                              
                              
                                 
                                    z
                                 
                                 
                                    i
                                 
                              
                              
                                 )
                              
                            is a Gaussian function which defines the size of the neighborhood around each examined point. The neighborhood was fixed to 0.64mm for obtaining the optimal number of distinct points, in terms of registration accuracy. By expanding Eq. (1) using Taylor series and discarding terms higher than two, a more compact form can be derived as follows:
                              
                                 (2)
                                 
                                    
                                       
                                          R
                                       
                                       
                                          =
                                       
                                       
                                          (
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            Δ
                                                         
                                                         x
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            Δ
                                                         
                                                         y
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            Δ
                                                         
                                                         z
                                                      
                                                   
                                                
                                             
                                          
                                          )
                                       
                                       
                                          [
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   
                                                      ,
                                                   
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   
                                                      ,
                                                   
                                                   
                                                      
                                                         z
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   G
                                                
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      
                                                         ,
                                                      
                                                      
                                                         
                                                            y
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      
                                                         ,
                                                      
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                   )
                                                
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     f
                                                                  
                                                                  
                                                                     x
                                                                  
                                                                  
                                                                     2
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     f
                                                                  
                                                                  
                                                                     x
                                                                  
                                                               
                                                               
                                                                  
                                                                     f
                                                                  
                                                                  
                                                                     y
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     f
                                                                  
                                                                  
                                                                     x
                                                                  
                                                               
                                                               
                                                                  
                                                                     f
                                                                  
                                                                  
                                                                     z
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     f
                                                                  
                                                                  
                                                                     x
                                                                  
                                                               
                                                               
                                                                  
                                                                     f
                                                                  
                                                                  
                                                                     y
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     f
                                                                  
                                                                  
                                                                     y
                                                                  
                                                                  
                                                                     2
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     f
                                                                  
                                                                  
                                                                     y
                                                                  
                                                               
                                                               
                                                                  
                                                                     f
                                                                  
                                                                  
                                                                     z
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     f
                                                                  
                                                                  
                                                                     x
                                                                  
                                                               
                                                               
                                                                  
                                                                     f
                                                                  
                                                                  
                                                                     z
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     f
                                                                  
                                                                  
                                                                     y
                                                                  
                                                               
                                                               
                                                                  
                                                                     f
                                                                  
                                                                  
                                                                     z
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     f
                                                                  
                                                                  
                                                                     z
                                                                  
                                                                  
                                                                     2
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                          ]
                                       
                                       
                                          (
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            Δ
                                                         
                                                         x
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            Δ
                                                         
                                                         y
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            Δ
                                                         
                                                         z
                                                      
                                                   
                                                
                                             
                                          
                                          )
                                       
                                       
                                          =
                                       
                                       
                                          SH
                                       
                                       
                                          
                                             S
                                          
                                          
                                             T
                                          
                                       
                                    
                                 
                              
                           where 
                              
                                 
                                    S
                                    =
                                 
                                 
                                    (
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      Δ
                                                   
                                                   x
                                                
                                             
                                             
                                                
                                                   
                                                      Δ
                                                   
                                                   y
                                                
                                             
                                             
                                                
                                                   
                                                      Δ
                                                   
                                                   z
                                                
                                             
                                          
                                       
                                    
                                    )
                                 
                              
                            expresses the shifting performed in each direction and 
                              
                                 
                                    
                                       f
                                    
                                    
                                       x
                                    
                                 
                                 
                                    ,
                                 
                                 
                                    
                                       f
                                    
                                    
                                       y
                                    
                                 
                                 
                                    ,
                                 
                                 
                                    
                                       f
                                    
                                    
                                       z
                                    
                                 
                              
                            denote the partial derivatives along 
                              
                                 x
                                 −
                                 ,
                                 y
                                 −
                              
                            and 
                              
                                 z
                                 −
                              
                            axis, respectively [41]. The final step of the procedure is to calculate the values of the 3D Harris operator using the following equation:
                              
                                 (3)
                                 
                                    
                                       
                                          h
                                       
                                       
                                          (
                                          
                                             x
                                          
                                          
                                             ,
                                          
                                          
                                             y
                                          
                                          
                                             ,
                                          
                                          
                                             z
                                          
                                          )
                                       
                                       
                                          =
                                       
                                       
                                          det
                                       
                                       
                                       
                                          (
                                          H
                                          )
                                       
                                       
                                          −
                                       
                                       
                                          k
                                       
                                       
                                          
                                             [
                                             
                                                
                                                   tr
                                                
                                                
                                                   (
                                                
                                                
                                                   H
                                                
                                                
                                                   )
                                                
                                             
                                             ]
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                              
                           where 
                              
                                 det
                                 (
                                 H
                                 )
                              
                            and 
                              
                                 tr
                                 (
                                 H
                                 )
                              
                            are the determinant and the trace of matrix 
                              
                                 H
                              
                           , respectively, while 
                              
                                 k
                              
                            is a constant determined empirically in the range [0.04 0.1] [41].

After calculating Harris׳ operator values for all points, a selection is made in order to end up with a smaller set of points. Each point of the initial data set is characterized as distinct if its Harris value exceeds a predefined threshold 
                              
                                 δ
                              
                           . In the current study, the Harris operator was implemented using the Point Cloud Library (PCL) and the default values for constants 
                              
                                 k
                              
                            and 
                              
                                 δ
                              
                            were used (
                              
                                 k
                                 =
                                 0.04
                                 ,
                              
                              
                                 δ
                              
                              
                                 =
                                 0
                              
                           ), according to [43]. In the implementation used in this study, key-points are extracted solely based on their geometrical properties, without considering their intensity.

Three geometrical descriptors were examined in this study for registering the featured 3D CT volumes: the Fast Point Feature Histogram (FPFH) [28], the Signature of Histogram of OrienTations (SHOT) [29] and the Surface Normals (SN) [31]. In addition, the well-known Iterative Closest Point algorithm (ICP) was employed [22]. All of the above techniques are analyzed in the following sections.

The FPFH descriptor is a simplified version of the Point Feature Histogram (PFH) descriptor. The PFH descriptor encodes the geometrical properties of a neighborhood by generalizing the concepts of mean curvature and normal vectors [29]. This is achieved by considering specific angles and distances between the point of interest and each other point which belongs to a finite-sized neighborhood around it. In the implementation used in this study, the particular neighborhood was modeled as a sphere with radius 75.2mm (see Section 4 for details). By defining 
                                 
                                    
                                       p
                                    
                                    
                                       i
                                    
                                 
                              to be the point of interest and 
                                 
                                    
                                       p
                                    
                                    
                                       j
                                    
                                 
                               to be all the points that belong to the neighborhood of 
                                 
                                    
                                       p
                                    
                                    
                                       i
                                    
                                 
                              , we can then consider three unit vectors 
                                 
                                    
                                       
                                          
                                             v
                                          
                                          →
                                       
                                    
                                    
                                       1
                                    
                                 
                              , 
                                 
                                    
                                       
                                          
                                             v
                                          
                                          →
                                       
                                    
                                    
                                       2
                                    
                                 
                               and 
                                 
                                    
                                       
                                          
                                             v
                                          
                                          →
                                       
                                    
                                    
                                       3
                                    
                                 
                              . These unit vectors can be calculated as follows:
                                 
                                    (4)
                                    
                                       
                                          
                                             
                                                
                                                   v
                                                   →
                                                
                                             
                                             
                                                1
                                             
                                          
                                          =
                                          
                                             
                                                
                                                   n
                                                   →
                                                
                                             
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   v
                                                   →
                                                
                                             
                                             
                                                2
                                             
                                          
                                          =
                                          
                                             
                                                
                                                   v
                                                   →
                                                
                                             
                                             
                                                1
                                             
                                          
                                          ×
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      j
                                                   
                                                
                                                −
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                             
                                                |
                                                |
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      j
                                                   
                                                
                                                −
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      i
                                                   
                                                
                                                |
                                                
                                                   
                                                      |
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   v
                                                   →
                                                
                                             
                                             
                                                3
                                             
                                          
                                          =
                                          
                                             
                                                
                                                   v
                                                   →
                                                
                                             
                                             
                                                1
                                             
                                          
                                          ×
                                          
                                             
                                                
                                                   v
                                                   →
                                                
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                              where 
                                 
                                    
                                       
                                          
                                             n
                                          
                                          →
                                       
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                               is the surface normal vector at point 
                                 
                                    
                                       p
                                    
                                    
                                       i
                                    
                                 
                              . Having defined the unit vectors 
                                 
                                    
                                       
                                          v
                                          →
                                       
                                    
                                    
                                       1
                                    
                                 
                              , 
                                 
                                    
                                       
                                          v
                                          →
                                       
                                    
                                    
                                       2
                                    
                                 
                               and 
                                 
                                    
                                       
                                          v
                                          →
                                       
                                    
                                    
                                       3
                                    
                                 
                              , we can express the difference between the normal vectors 
                                 
                                    
                                       
                                          n
                                          →
                                       
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                               and 
                                 
                                    
                                       
                                          n
                                          →
                                       
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             j
                                          
                                       
                                    
                                 
                               through three angular measurements and the Euclidean distance between the two points, as can be seen below [25]:
                                 
                                    (5)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      1
                                                   
                                                
                                                =
                                                arccos
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            
                                                               v
                                                               →
                                                            
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      ⋅
                                                      
                                                         
                                                            
                                                               n
                                                               →
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  p
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      2
                                                   
                                                
                                                =
                                                arccos
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            
                                                               v
                                                               →
                                                            
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      ⋅
                                                      
                                                         
                                                            
                                                               
                                                                  p
                                                               
                                                               
                                                                  j
                                                               
                                                            
                                                            −
                                                            
                                                               
                                                                  p
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                         
                                                         
                                                            |
                                                            |
                                                            
                                                               
                                                                  p
                                                               
                                                               
                                                                  j
                                                               
                                                            
                                                            −
                                                            
                                                               
                                                                  p
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            |
                                                            
                                                               
                                                                  |
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      3
                                                   
                                                
                                                =
                                                arctan
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            
                                                               v
                                                               →
                                                            
                                                         
                                                         
                                                            3
                                                         
                                                      
                                                      ⋅
                                                      
                                                         
                                                            
                                                               n
                                                               →
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  p
                                                               
                                                               
                                                                  j
                                                               
                                                            
                                                         
                                                      
                                                      ,
                                                      
                                                      
                                                         
                                                            
                                                               v
                                                               →
                                                            
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      ⋅
                                                      
                                                         
                                                            
                                                               n
                                                               →
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  p
                                                               
                                                               
                                                                  j
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                d
                                                =
                                                |
                                                |
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      j
                                                   
                                                
                                                −
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      i
                                                   
                                                
                                                |
                                                
                                                   
                                                      |
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

These four values are calculated for all pairs 
                                 
                                    (
                                 
                                 
                                    
                                       p
                                    
                                    
                                       i
                                    
                                 
                                 
                                    ,
                                 
                                 
                                    
                                       p
                                    
                                    
                                       j
                                    
                                 
                                 
                                    )
                                 
                               in the neighborhood of 
                                 
                                    
                                       p
                                    
                                    
                                       i
                                    
                                 
                              . The next step of the processing procedure consists of binning the aforementioned values into a 125-bin histogram. Through this procedure, a unique histogram is associated with each point in the reference and floating point clouds.

Due to the high computational complexity of the PFH technique, which is 
                                 
                                    O
                                    (
                                 
                                 
                                    
                                       k
                                    
                                    
                                       2
                                    
                                 
                                 
                                    )
                                 
                              , where 
                                 
                                    k
                                 
                               is the number of the neighboring points, a simplified version was proposed [28]. The Fast Point Feature Histogram (FPFH) variant uses 33-bin histograms thus reducing computational complexity to 
                                 
                                    O
                                    (
                                    k
                                    )
                                 
                              . This is achieved by comparing the point 
                                 
                                    
                                       p
                                    
                                    
                                       i
                                    
                                 
                               with only its 
                                 
                                    k
                                 
                              -nearest neighbors, instead of all the points in its entire neighborhood.

Instead of working with histograms, unique signatures could be calculated for each cloud point 
                                 
                                    p
                                 
                              . A typical example in this case is the SHOT descriptor. The SHOT calculation procedure begins by defining a spherical area of a predefined radius around point 
                                 
                                    p
                                 
                              . The optimal radius of this spherical area was calculated after a series of trials (see Section 4). Then, this sphere is divided into partitions which are essential for the calculation of normal orientations. Each point 
                                 
                                    
                                       p
                                    
                                    
                                       j
                                    
                                 
                              , which belongs to the partition of point 
                                 
                                    p
                                 
                              
                              , is assigned a histogram index according to Eq. (6), where 
                                 
                                    RA
                                 
                               is the reference axis and 
                                 
                                    bins
                                 
                               is the number of bins in the histogram [30,43].
                                 
                                    (6)
                                    
                                       
                                          
                                             hist
                                          
                                          
                                             =
                                          
                                          
                                             
                                                bins
                                             
                                             
                                                2
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   RA
                                                
                                                ⋅
                                                
                                                   
                                                      
                                                         
                                                            n
                                                         
                                                         
                                                            →
                                                         
                                                      
                                                   
                                                   
                                                      j
                                                   
                                                
                                                
                                                   +
                                                   1
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           

In this study, the default values of the Point Cloud Library (PCL) implementation of the SHOT descriptor were used. Therefore, each sphere was divided into 32 partitions and the histograms consisted of 11 bins, resulting in signatures of 352 values.

A Surface Normal (SN), is a vector perpendicular to the tangent plane at a point 
                                 
                                    p
                                 
                               of a given surface. There are many different approaches in order to estimate the SN at each point of a surface [44]. However, the most common method for SN estimation is based on a first order 3D plane fitting [40]. According to this approach, the problem of defining the SN of a point is approximated by the problem of estimating the normal of a plane tangent to the surface at that point. This becomes, in turn, a least-square plane fitting problem [40]. For a given radius r and a point 
                                 
                                    
                                       p
                                    
                                    
                                       i
                                    
                                 
                               with coordinates 
                                 
                                    (
                                 
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 
                                    ,
                                 
                                 
                                    
                                       y
                                    
                                    
                                       i
                                    
                                 
                                 
                                    ,
                                 
                                 
                                    
                                       z
                                    
                                    
                                       i
                                    
                                 
                                 
                                    )
                                 
                              , all of its neighboring points are considered in order to construct a local scatter matrix. In particular the scatter matrix is defined for each point 
                                 
                                    
                                       p
                                    
                                    
                                       i
                                    
                                 
                              , extending in a neighborhood 
                                 
                                    
                                       N
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                               as follows:
                                 
                                    (7)
                                    
                                       
                                          M
                                       
                                       
                                          =
                                       
                                       
                                          ∑
                                          
                                             
                                                
                                                   p
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                ∈
                                             
                                             
                                                
                                                   N
                                                
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      
                                                         −
                                                      
                                                      
                                                         μ
                                                      
                                                   
                                                   )
                                                
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      
                                                         −
                                                      
                                                      
                                                         μ
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                T
                                             
                                          
                                       
                                    
                                 
                              where:
                                 
                                    
                                       
                                          
                                             
                                                
                                                   p
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                =
                                             
                                             
                                                
                                                   
                                                      [
                                                   
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   
                                                      ,
                                                   
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   
                                                      ,
                                                   
                                                   
                                                      
                                                         z
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   
                                                      ]
                                                   
                                                
                                                
                                                   T
                                                
                                             
                                          
                                       
                                    


                                       
                                          
                                             μ
                                          
                                          
                                             =
                                          
                                          
                                             
                                                1
                                             
                                             
                                                
                                                   |
                                                   
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            
                                                               
                                                                  p
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   |
                                                
                                             
                                          
                                          
                                             ∑
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      i
                                                   
                                                
                                                
                                                   ∈
                                                
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   p
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                    


                                       
                                          
                                             
                                                
                                                   N
                                                
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                             
                                             
                                                =
                                             
                                             
                                                {
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   
                                                      ∈
                                                   
                                                   
                                                      
                                                         R
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                   
                                                      :
                                                   
                                                   
                                                      |
                                                      
                                                         
                                                            
                                                               p
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         
                                                            −
                                                         
                                                         
                                                            
                                                               p
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                      
                                                      |
                                                   
                                                   
                                                      ≤
                                                   
                                                   
                                                      r
                                                   
                                                
                                                }
                                             
                                             
                                                ,
                                             
                                             
                                                i
                                             
                                             
                                                ≠
                                             
                                             
                                                j
                                             
                                          
                                       
                                    

The parameter 
                                 
                                    r
                                 
                               is the radius of a sphere which defines the size of the neighborhood around point 
                                 
                                    
                                       p
                                    
                                    
                                       i
                                    
                                 
                              . The optimal radius of the neighborhood was determined through several tests (see Section 4). The next step of the processing consists of calculating the eigenvalues 
                                 
                                    
                                       
                                          λ
                                       
                                       
                                          1
                                       
                                    
                                    
                                       ,
                                    
                                    
                                       
                                          λ
                                       
                                       
                                          2
                                       
                                    
                                    
                                       ,
                                    
                                    
                                       
                                          λ
                                       
                                       
                                          3
                                       
                                    
                                 
                               and eigenvectors 
                                 
                                    
                                       
                                          
                                             
                                                e
                                             
                                             
                                                1
                                             
                                          
                                       
                                       ^
                                    
                                    
                                       ,
                                    
                                    
                                       
                                          
                                             
                                                e
                                             
                                             
                                                2
                                             
                                          
                                       
                                       ^
                                    
                                    
                                       ,
                                    
                                    
                                       
                                          
                                             
                                                e
                                             
                                             
                                                3
                                             
                                          
                                       
                                       ^
                                    
                                 
                              , of the scatter matrix 
                                 M
                              . Finally, the eigenvector corresponding to the minimum eigenvalue is considered as an approximation of the SN [40].

The proposed geometry-based methods were also compared against the well-established ICP algorithm. The ICP algorithm is widely used in numerous point-based registration schemes, in a variety of image processing applications [22].

The particular method is guaranteed to converge to an optimal set of correspondences between the reference and floating point cloud, through an iterative least-squares approach. Initially, the algorithm finds the spatially nearest point in the floating point cloud for each point in the reference point cloud. Then, the parameters of an affine transformation are calculated for each point pair. The transformation tries to best match the allocated corresponding points, using the mean squared error cost function. By using those local transformation parameters, the points from the floating point cloud are transformed accordingly and the process is repeated by estimating a new set of correspondences. The ICP algorithm terminates when certain criteria are satisfied.

In our study, the ICP algorithm was applied using a maximum number of iterations of 2000 and a minimum difference of the measure of match between two successive iterations of 
                                 
                                    1
                                    ×
                                 
                                 
                                    
                                       10
                                    
                                    
                                       −
                                       5
                                    
                                 
                              . The particular values were selected empirically, after a number of tests, as it was found that no more than 2000 iterations were required in any of the examined cases for converging to an optimal solution.

All geometrical feature descriptors presented above, can be used to directly compare data points from the reference and floating point clouds. Therefore, once the features of each cloud point are defined, corresponding points can be allocated, based on the similarity of the specified features. In this study, the proposed correspondence estimation scheme employs a k-nearest neighbor algorithm through a k-dimensional tree structure, in order to find the corresponding points between the reference and floating data sets [37].

When estimating corresponding points, it is possible that some correspondences are spurious or lack accuracy. Therefore, before estimating the global transformation, any false correspondences need to be eliminated, as they will negatively affect the accuracy of the calculated transformation. In this study, the RANSAC algorithm was used in order to reject the aforementioned correspondences [38]. The RANSAC algorithm produces an estimation of a set of parameters which describe a mathematical model, based on a set of data. This set may contain outliers, i.e. data that do not fit that model. The goal is achieved through a random initialization (using the same seed in the random generator function) and a subsequent iterative procedure which is described below [38]. The initialization step consists of a random selection of a subset of the initial set of correspondences, which are considered to be the inliers. Then, the algorithm iterates through steps 1–3 as follows:


                           Step 1
                           :Use the instantiated model in order to determine which of the remaining correspondences lie within some acceptable error bounds. If a correspondence does not negatively affect the model (error function is within a specified threshold) then it is included as an inlier. This threshold is called the Rejection Epsilon.


                           Step 2
                           :If the subset contains a sufficient number of points, it is used in order to calculate a new model.


                           Step 3
                           :If the subset contains too few points, then a new subset is randomly selected and the algorithm returns to Step 1.

The above process is repeated for a predefined number of iterations. In each iteration, a model is produced, which is then either rejected due to containing too few points, or is kept in order to be compared to the previously considered models [38]. The comparison takes into account the corresponding error measurements and the model with the lowest error is the final model selected by the algorithm. This procedure results in a set of correspondences between the reference and floating data sets, where any false correspondences are rejected. The parameters of the RANSAC algorithm, namely the Rejection Epsilon and the number of iterations, were set to 0.01 and 10,000 respectively, for all test data, after several trials.

The set of inlier correspondences produced by the RANSAC algorithm, are used in order to calculate a global affine transformation, using the Singular Value Decomposition (SVD) technique, which can solve the linear equations describing the local transformation of each examined point, thus estimating a global transformation [33].

An affine transformation is able to transform points in the three-dimensional space in a rigid manner. A typical 3D affine transformation is defined by a total of twelve parameters [14]: three for rotation, three for scaling, three for shearing and three for translation along the x-, y- and z-axis. The affine transformation model may be expressed using matrix arithmetic, as shown below:
                              
                                 (8)
                                 
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    
                                       =
                                    
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   
                                                      x
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      y
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      z
                                                   
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    
                                       +
                                    
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         d
                                                      
                                                      
                                                         x
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         d
                                                      
                                                      
                                                         y
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         d
                                                      
                                                      
                                                         z
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       ]
                                    
                                 
                              
                           
                        

In this case, the 12 independent parameters of the affine model are 
                              
                                 (
                              
                              
                                 
                                    a
                                 
                                 
                                    i
                                 
                              
                              
                                 ,
                              
                              
                                 
                                    b
                                 
                                 
                                    i
                                 
                              
                              
                                 ,
                              
                              
                                 
                                    c
                                 
                                 
                                    i
                                 
                              
                              
                                 )
                              
                            for 
                              
                                 i
                                 =
                                 1,2,3
                              
                            and 
                              
                                 
                                    d
                                 
                                 
                                    x
                                 
                              
                           , 
                              
                                 
                                    d
                                 
                                 
                                    y
                                 
                              
                            and 
                              
                                 
                                    d
                                 
                                 
                                    z
                                 
                              
                           . By applying the transformation function described in Eq. (8) in every point of the floating point cloud, the entire point cloud can be spatially transformed according to the rotation, scaling, shearing and translation defined by the 12 parameters of the transformation model. The particular transformation model was preferred over more complex non-rigid models, as no elastic deformations were present in the CT data sets featured in this study, and hence any spatial deviations between the compared data can be readily expressed through a rigid transformation.

In general, conventional exhaustive registration methods employ an iterative optimization technique for generating transformation parameters, which are applied to a floating data set, in order to spatially align it with respect to a reference data set. In every iteration of the optimization algorithm, the accuracy of the alignment is assessed by using a suitable cost function or “measure of match”, which compares the intensity values of the assessed pixels [1]. In exhaustive methods, the measure of match is calculated over all corresponding points (pixels) of the reference and floating data sets. As a result, at the end of each iteration, the coordinates of all points of the floating data are transformed to a new position, which should be spatially closer to that of their corresponding point from the reference data set. By convention, according to the preferred coordinate system, coordinates should be expressed as integer numbers. However, the outcomes of the transformation model may well be real numbers, which need to be suitably converted in order to maximize accuracy. This task is handled by employing an interpolation technique [14].

In this study, a widely used exhaustive registration scheme was employed, featuring the Downhill Simplex optimization method, the Affine transformation model and a variety of measures of match, including Correlation Coefficient (CC), Mattes Mutual Information (MMI) and the Mean Square Error (MSE) [18,20,21,34]. The overall scheme was enhanced by applying a simple linear interpolation technique on the produced coordinates of the transformed floating data points. A graphical summary of the employed exhaustive registration methodology is shown in 
                        Fig. 2.

The featured exhaustive 3D registration methodology utilizes the Downhill Simplex (Nelder-Mead) method for optimizing the parameters of the transformation model [45]. In this study, the Downhill Simplex optimizer provided by the Insight Segmentation and Registration Toolkit (ITK) was employed, with its default parameters [46]. The particular optimization model was employed as it is by far the most widely used optimizer for rigid-body registration.

An affine transformation model was preferred in all 3D registration schemes featured in this study. In case of the exhaustive, intensity-based registration techniques, the transformation model shown in Eq. (8) is applied to every pixel of the floating CT volume, during each iteration of the optimization procedure, as well as for obtaining the finally aligned volume.

Three distinct objective functions were used in this study, hence providing three alternative implementations of the exhaustive registration methodology. The first variation incorporates the widely used Correlation Coefficient [18]. The particular metric is a statistical measurement that quantizes the similarity between two samples. In our case, the samples are individual pixel intensities of the reference and the transformed floating data sets. The Correlation Coefficient (CC) between the reference data set 
                              
                                 
                                    I
                                 
                                 
                                    R
                                 
                              
                            and the transformed floating data set 
                              
                                 
                                    I
                                 
                                 
                                    F
                                 
                              
                            over all N pixels 
                              
                                 
                                    
                                       r
                                    
                                    →
                                 
                                 
                                    =
                                    (
                                    x
                                    ,
                                    y
                                    ,
                                    z
                                    )
                                 
                              
                            can be calculated using the following equation:
                              
                                 (9)
                                 
                                    
                                       CC
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             N
                                          
                                          
                                             ∑
                                             
                                                
                                                   
                                                      r
                                                   
                                                   ⃗
                                                
                                             
                                          
                                          
                                             
                                                
                                                   I
                                                
                                                
                                                   R
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      ⃗
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   I
                                                
                                                
                                                   F
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      ⃗
                                                   
                                                
                                                )
                                             
                                             
                                                −
                                             
                                             
                                                ∑
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      ⃗
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      I
                                                   
                                                   
                                                      R
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            r
                                                         
                                                         ⃗
                                                      
                                                   
                                                   )
                                                
                                                
                                                   ∑
                                                   
                                                      
                                                         
                                                            r
                                                         
                                                         ⃗
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         F
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            
                                                               r
                                                            
                                                            ⃗
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   N
                                                
                                                
                                                   ∑
                                                   
                                                      
                                                         
                                                            r
                                                         
                                                         ⃗
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         R
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            
                                                               r
                                                            
                                                            ⃗
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      −
                                                   
                                                   
                                                      
                                                         (
                                                         
                                                            
                                                               ∑
                                                               
                                                                  
                                                                     
                                                                        r
                                                                     
                                                                     ⃗
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     I
                                                                  
                                                                  
                                                                     R
                                                                  
                                                               
                                                               
                                                                  (
                                                                  
                                                                     
                                                                        
                                                                           r
                                                                        
                                                                        ⃗
                                                                     
                                                                  
                                                                  )
                                                               
                                                            
                                                         
                                                         )
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   N
                                                
                                                
                                                   ∑
                                                   
                                                      
                                                         
                                                            r
                                                         
                                                         ⃗
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         F
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            
                                                               r
                                                            
                                                            ⃗
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      −
                                                   
                                                   
                                                      
                                                         (
                                                         
                                                            
                                                               ∑
                                                               
                                                                  
                                                                     
                                                                        r
                                                                     
                                                                     ⃗
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     I
                                                                  
                                                                  
                                                                     F
                                                                  
                                                               
                                                               
                                                                  (
                                                                  
                                                                     
                                                                        
                                                                           r
                                                                        
                                                                        ⃗
                                                                     
                                                                  
                                                                  )
                                                               
                                                            
                                                         
                                                         )
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

The Correlation Coefficient is usually normalized in the range 
                              
                                 [
                                 
                                    0,1
                                 
                                 ]
                              
                           , with 
                              
                                 CC
                                 =
                                 1
                              
                            corresponding to a perfect match between the reference and floating data sets.

Another variation of the proposed exhaustive 3D registration scheme was implemented using the Mattes Mutual Information (MMI) metric as a measure of match. In general, metrics based on the quantification of mutual information, measure the combined entropy between the compared data sets [34]. Therefore, Mutual Information considers the entropies of the reference 
                              
                                 E
                              
                              
                                 (
                                 
                                    
                                       
                                          I
                                       
                                       
                                          R
                                       
                                    
                                 
                                 )
                              
                            and the transformed floating 
                              
                                 E
                              
                              
                                 (
                                 
                                    
                                       
                                          I
                                       
                                       
                                          F
                                       
                                    
                                 
                                 )
                              
                            data sets, as well as their joint entropy 
                              
                                 E
                              
                              
                                 (
                                 
                                    
                                       
                                          
                                             
                                                I
                                             
                                             
                                                R
                                             
                                          
                                          
                                             ,
                                             I
                                          
                                       
                                       
                                          F
                                       
                                    
                                 
                                 )
                              
                           , as can be seen in Eq. (10). Consequently, the compared data sets best match if their Mutual Information is maximized.
                              
                                 (10)
                                 
                                    
                                       MI
                                    
                                    
                                       (
                                       
                                          
                                             
                                                I
                                             
                                             
                                                R
                                             
                                          
                                       
                                       
                                          
                                             
                                                I
                                             
                                             
                                                F
                                             
                                          
                                       
                                       )
                                    
                                    
                                       =
                                    
                                    
                                       E
                                    
                                    
                                       (
                                       
                                          
                                             
                                                I
                                             
                                             
                                                R
                                             
                                          
                                       
                                       )
                                    
                                    
                                       +
                                    
                                    
                                       E
                                    
                                    
                                       (
                                       
                                          
                                             
                                                I
                                             
                                             
                                                F
                                             
                                          
                                       
                                       )
                                    
                                    
                                       −
                                    
                                    
                                       E
                                    
                                    
                                       (
                                       
                                          
                                             
                                                
                                                   
                                                      I
                                                   
                                                   
                                                      R
                                                   
                                                
                                                
                                                   ,
                                                
                                                
                                                   I
                                                
                                             
                                             
                                                F
                                             
                                          
                                       
                                       )
                                    
                                 
                              
                           
                        

On the other hand, Mattes’ approach considers the negative mutual information between the reference and the transformed floating data, as a function of the transform parameters t 
                           [47]. Therefore, the particular metric can be calculated using Eq. (11), where 
                              
                                 p
                              
                           , 
                              
                                 
                                    p
                                 
                                 
                                    R
                                 
                              
                            and 
                              
                                 
                                    p
                                 
                                 
                                    T
                                 
                              
                            are the joint, marginal reference and marginal floating probability distributions respectively, which are calculated using Parzen histograms, over all 
                              
                                 r
                              
                            and 
                              
                                 f
                              
                            histogram bins of the reference and floating data sets, respectively. Due to the inverted sign used for calculating Mattes Mutual Information (MMI) as shown in Eq. (11), the particular metric needs to be minimized for best matching the compared data sets.
                              
                                 (11)
                                 
                                    
                                       
                                          MMI
                                       
                                       
                                          (
                                          
                                             t
                                          
                                          )
                                       
                                       
                                          =
                                          −
                                       
                                       
                                          
                                             ∑
                                          
                                          
                                             f
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                r
                                             
                                          
                                          
                                             
                                                p
                                             
                                             
                                                (
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      ,
                                                   
                                                   
                                                      r
                                                   
                                                
                                                
                                                   t
                                                
                                                )
                                             
                                             
                                                log
                                             
                                             
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         (
                                                      
                                                      
                                                         f
                                                      
                                                      
                                                         ,
                                                      
                                                      
                                                         r
                                                      
                                                      
                                                         |
                                                      
                                                      
                                                         t
                                                      
                                                      
                                                         )
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            T
                                                         
                                                      
                                                      
                                                         (
                                                         
                                                            
                                                               f
                                                            
                                                            
                                                               |
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                         )
                                                      
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            R
                                                         
                                                      
                                                      
                                                         (
                                                         
                                                            r
                                                         
                                                         )
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

A more simplistic approach for assessing the difference between two distributions is the Mean Squared Error (MSE). This statistical measurement is often used for assessing a set of predictions against their true value (ground truth) [35]. The particular metric was also incorporated into the proposed exhaustive registration methodology, providing an additional variation. In case of digital imaging data, the Mean Squared Error simply quantifies the average squared difference between the intensities 
                              
                                 
                                    
                                       I
                                    
                                    
                                       R
                                    
                                 
                                 
                                    (
                                    i
                                    )
                                 
                              
                            and 
                              
                                 
                                    
                                       I
                                    
                                    
                                       F
                                    
                                 
                                 
                                    (
                                    i
                                    )
                                 
                              
                            of the homologous points 
                              
                                 i
                              
                            of the reference and the transformed floating data set, respectively. From a statistics point of view, 
                              
                                 
                                    
                                       I
                                    
                                    
                                       F
                                    
                                 
                                 
                                    (
                                    i
                                    )
                                 
                              
                            is treated as the prediction sample, while 
                              
                                 
                                    
                                       I
                                    
                                    
                                       R
                                    
                                 
                                 
                                    (
                                    i
                                    )
                                 
                              
                            is considered to be the ground truth. Therefore, assuming that the compared data sets have the same number of points, the MSE can be calculated over all of their N points, according to the following equation:
                              
                                 (12)
                                 
                                    
                                       
                                          MSE
                                       
                                       
                                          =
                                       
                                       
                                          
                                             1
                                          
                                          
                                             N
                                          
                                       
                                       
                                          
                                             ∑
                                          
                                          
                                             
                                                i
                                             
                                             
                                                =
                                                0
                                             
                                          
                                          
                                             
                                                N
                                             
                                             
                                                −
                                                1
                                             
                                          
                                       
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         R
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         i
                                                      
                                                      )
                                                   
                                                   
                                                      −
                                                   
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         F
                                                      
                                                   
                                                   
                                                      (
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      )
                                                   
                                                
                                                )
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

A linear interpolation technique was employed in order to estimate the intensities of points with real coordinates, as these were calculated from the affine transformation model. In effect, the selected interpolation method linearly interpolates image intensity at non-integer pixel positions of the transformed floating data sets. Assuming that we need to interpolate the intensity of a point located at a distance 
                              
                                 a
                              
                            from point 
                              
                                 n
                              
                           , a weighted approximation can be obtained as follows [14]:
                              
                                 (13)
                                 
                                    
                                       I
                                    
                                    
                                       (
                                       
                                          
                                             n
                                          
                                          
                                             +
                                          
                                          
                                             a
                                          
                                       
                                       )
                                    
                                    
                                       =
                                    
                                    
                                       (
                                       
                                          
                                             1
                                             −
                                          
                                          
                                             a
                                          
                                       
                                       )
                                    
                                    
                                       I
                                    
                                    
                                       (
                                       
                                          n
                                       
                                       )
                                    
                                    
                                       +
                                    
                                    
                                       aI
                                    
                                    
                                       (
                                    
                                    
                                       n
                                    
                                    
                                       +
                                    
                                    
                                       1
                                       )
                                    
                                 
                              
                           where a is normalized in the range 
                              
                                 [
                                 
                                    0,1
                                 
                                 ]
                              
                           . Therefore, the weighted intensities 
                              
                                 I
                              
                            of the neighboring points 
                              
                                 n
                              
                            and 
                              
                                 n
                                 +
                                 1
                              
                            were only considered.

This study is concerned with the comparison of a variety of registration techniques which are either based on geometrical feature descriptors or pixel intensity. Hence, a measurable quantity is required for objectively assessing the results produced by all of the presented methodologies. Ideally, the particular quantity should not be biased towards any of the compared methods. To that end, none of the measures of match described in Section 2.3.3 are suitable, since all of those metrics are components of the compared registration techniques. As a result, an independent quantitative criterion is proposed for assessing the differences between the reference and the aligned floating data sets. In particular, the mean distance of their contours was used throughout this study, as this metric is neither directly related to the intensity nor to the feature descriptors of the subject images. The Mean Contour Distance (MCD) can be calculated as follows:
                           
                              (14)
                              
                                 
                                    
                                       MCD
                                    
                                    
                                       (
                                       
                                          
                                             
                                                C
                                             
                                             
                                                R
                                             
                                          
                                          
                                             ,
                                          
                                          
                                             
                                                C
                                             
                                             
                                                A
                                             
                                          
                                       
                                       )
                                    
                                    
                                       =
                                       max
                                       
                                          
                                       
                                    
                                    
                                       (
                                       
                                          
                                             D
                                          
                                          
                                             (
                                             
                                                
                                                   
                                                      C
                                                   
                                                   
                                                      R
                                                   
                                                
                                                
                                                   ,
                                                
                                                
                                                   
                                                      C
                                                   
                                                   
                                                      A
                                                   
                                                
                                             
                                             )
                                          
                                          
                                             ,
                                          
                                          
                                             D
                                          
                                          
                                             (
                                             
                                                
                                                   
                                                      C
                                                   
                                                   
                                                      A
                                                   
                                                
                                                
                                                   ,
                                                
                                                
                                                   
                                                      C
                                                   
                                                   
                                                      R
                                                   
                                                
                                             
                                             )
                                          
                                       
                                       )
                                    
                                 
                              
                           
                        where 
                           
                              
                                 C
                              
                              
                                 R
                              
                           
                         and 
                           
                              
                                 C
                              
                              
                                 A
                              
                           
                         are binary images corresponding to the contours of the reference and the aligned floating data, respectively [14]. The binary images were obtained by using a simple 3×3×3 isotropic Sobel filter [14]. The directed mean distance 
                           
                              D
                           
                         can be calculated using the following equation:
                           
                              (15)
                              
                                 
                                    D
                                    
                                       (
                                       
                                          
                                             C
                                          
                                          
                                             R
                                          
                                       
                                       ,
                                       
                                          
                                             C
                                          
                                          
                                             A
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       
                                          min
                                          
                                          
                                             (
                                             
                                                ‖
                                                i
                                                −
                                                j
                                                ‖
                                             
                                             )
                                          
                                       
                                       
                                          ¯
                                       
                                    
                                 
                              
                           
                        where 
                           
                              i
                           
                           
                              ∈
                           
                           
                              
                                 C
                              
                              
                                 R
                              
                           
                         and 
                           
                              j
                           
                           
                              ∈
                           
                           
                              
                                 C
                              
                              
                                 A
                              
                           
                        .

In this study, MCD is measured in millimeters (mm). As MCD can be considered as an error metric, low values correspond to minimum contour distance between the aligned data volumes and hence to high alignment accuracy.

@&#RESULTS@&#

All registration methodologies presented in this study were assessed both qualitatively and quantitatively, in terms of their accuracy, using the contour-based metric presented in Section 2.4. In addition, their processing time was assessed. All featured techniques were applied to two groups of data sets: 3D CT volume pairs with unknown initial geometrical differences (20 pairs) and 3D CT volume pairs with known spatial deviations (10 pairs), as described in Section 2.1.

Qualitative evaluation was performed by means of visual assessment. In order to visually assess the compared registration techniques, a visualization software component was developed for reconstructing, fusing and displaying the reference and floating data before and after registration. Some typical examples of the visual inspection of the methodologies examined in this study, are illustrated in 
                        Fig. 3, using a pair of data sets with unknown geometrical differences. For the particular data set, the accuracy of the SHOT descriptor (Fig. 3(e)) is very close to that of intensity-based techniques (Fig. 3(b)–(d)), while the FPFH (Fig. 3(f)) and SN (Fig. 3(g)) descriptors perform slightly worse. In the particular case, ICP trails, as the fused image shows noticeable misalignment (Fig. 3(h)).

As it is evident from Fig. 3, using only a qualitative criterion for the evaluation of the examined methodologies, cannot lead to solid conclusions about the superiority of one particular registration technique over another, as far as accuracy is concerned. Therefore, for a better evaluation the MCD quantitative metric in Eq. (14) was also employed.

The obtained MCD values for all test data pairs used in this study are presented in 
                        
                        Tables 1 and 2. In particular, in Table 1 the MCD values are presented for the data pairs with known initial spatial differences, while Table 2 illustrates the respective results for the pairs with unknown spatial deviations. In each column the achieved accuracy of each registration methodology is presented in terms of the recorded MCD values between the reference and the aligned data sets in each case. In the last row, the MCD value for each technique is summarized through its mean value and standard deviation.

As can be seen in Table 1, the intensity-based registration technique using the CC metric seems to outperform all other methodologies, as it achieves lower average MCD measurements (
                           
                              0.898
                              
                                 
                                 
                                    m
                                 
                                 
                                    m
                                 
                              
                           
                        ). Moreover, the geometry-based registration scheme featuring the FPFH, SN and SHOT descriptors achieves mean MCD values of 
                           
                              0.968
                              
                                 
                                 
                                    mm
                                 
                              
                              ,
                              1.019
                              
                                 
                                 
                                    mm
                                 
                              
                           
                         and 
                           
                              1.036
                              
                                 
                                 
                                    mm
                                 
                              
                           
                        , respectively, which are superior to the ones obtained through the intensity-based scheme using the MMI 
                           
                              (
                              1.054
                              
                              
                                 mm
                              
                              )
                           
                         and MSE 
                           
                              (
                              1.489
                              
                                 
                                 
                                    mm
                                 
                              
                              )
                           
                         metrics. Finally, the ICP algorithm is the worst performing technique for the particular data sets, as it achieves an average MCD measurement of 
                           
                              1.625
                              
                                 mm
                              
                           
                        . In addition, the obtained standard deviation measurements indicate that geometry-based techniques (SHOT, FPFH and SN) closely match or even surpass the robustness of the intensity-based methodologies.

In addition, for the known transformations the root mean square error (RMSE) was also calculated between the actual and the estimated transformation parameters. In particular, two different calculations were performed: one for the rotation parameters and an additional one for the translation parameters. The respective results are illustrated in Table 2. In particular, the third and fourth column present the mean value and standard deviation of the RMSE values, respectively. As can be seen in Table 2, for the rotation parameters, geometry-based methods performed similarly to the intensity-based techniques. However, no statistical significance was recorded in the vast majority of cases, based on several paired t-tests, for both rotation and translation parameters. As a result there is no significant difference in the performance of the compared techniques, based on the evaluation of the resulting transformation matrices.

The performance of the examined methodologies, using CT pairs with unknown initial geometrical differences, is presented in 
                        Table 3. As can be seen in Table 3, the SHOT descriptor achieves the second best accuracy with an average MCD value of 
                           
                              2.597
                              
                              
                                 mm
                              
                           
                         and the smallest standard deviation 
                           
                              (
                              0.784
                              
                                 mm
                              
                              )
                           
                        . The best mean accuracy is achieved by the intensity-based methodology using the MMI metric 
                           
                              (
                              2.553
                              
                                 
                                 
                                    mm
                                 
                              
                              )
                           
                        . Furthermore, the SN descriptor also achieves an average accuracy 
                           
                              (
                              
                                 2.709
                                 
                                 
                                    mm
                                 
                              
                              )
                           
                         which is better than the rest of the exhaustive registration techniques, based on the CC 
                           
                              (
                              2.849
                              
                              
                                 mm
                              
                              )
                           
                         and MSE 
                           
                              (
                              2.742
                              
                                 
                                 
                                    mm
                                 
                              
                              )
                           
                         metrics. Again, ICP seems to perform inferior to all other methods, but achieves more consistent performance compared to any intensity-based variation examined in this study, owed to the low recorded standard deviation measurement.

Another aspect concerning the efficiency of the methodologies examined in this study is the time required in order to spatially align each 3D CT volume pair. More specifically, in 
                        
                        Tables 4 and 5 the overall processing time (in seconds) is illustrated, for the data sets with known and unknown initial spatial variations. Each column reports the total processing time of each data pair, using the registration technique variants featured in this study. Moreover, in the last row, results are summarized by presenting the mean processing time in each case. As can be seen in Table 4, geometry-based techniques using the SHOT, FPFH and SN descriptors require significantly less processing time 
                           
                              (
                              69.20
                              ,
                              54.90
                           
                         and 
                           
                              45.80
                           
                        
                        s, respectively) compared to any intensity-based method. This does not come at a cost to the accuracy of the registration, as descriptor based registration methods achieve similar or better performance compared to intensity-based techniques (see Tables 1–3).

In Table 5, processing times are presented for CT pairs with unknown initial geometrical differences. Again the geometry-based registration variants are much faster than any intensity-based method featured in this study. As can be seen in Table 5, the geometry-based scheme employing the SN descriptor is on average the fastest, compared to the other techniques (
                           
                              48.95
                           
                         s). Moreover, the FPFH descriptor is the second fastest method as it requires 
                           
                              57.45
                           
                        
                        s in order to align the data pairs with unknown initial spatial differences. The other two geometry-based techniques examined in this study, namely SHOT and ICP, require more processing time, as the SHOT descriptor requires an increased number of complex calculations, while ICP needs to perform a significant number of iterations for converging to an acceptable solution. Finally, intensity-based methods require a significantly increased amount of processing time in order to perform the alignment with a result which is comparable to the descriptor-based methodologies. According to the obtained measurements, all geometry-based techniques perform similarly compared to the intensity-based methodologies. All timing results were obtained on the same reference computer system (see Section 4).

This was proven by the conduction of several paired t-tests between the measurements obtained by all geometry-based methods, against each intensity-based alternative technique. In all cases, the null hypothesis was that the performance of the compared geometry-based and intensity-based approaches did not deviate significantly, in terms of registration accuracy, based on the MCD metric. The particular null hypothesis could not be rejected with a confidence level of 95% in any case. Therefore, it is safe to assume that the proposed geometry-based registration framework achieves comparable accuracy to the exhaustive, intensity-based registration scheme, but at a significantly reduced time.

@&#DISCUSSION@&#

In this study, several variations of a geometry-based and an exhaustive, intensity-based registration methodology are compared both qualitatively and quantitatively. Geometry-based techniques utilized: the FPFH, SHOT and SN descriptors. On the other hand, the featured intensity-based registration methodology used three different metrics: Correlation Coefficient, Mattes Mutual Information and the Mean Square Error. All of the above techniques, together with ICP, were applied to ten pairs of 3D CT volumes with known initial geometrical variations and twenty more pairs with unknown spatial differences. As mentioned those data sets included several hundred images each, thus the selection of key points in the geometry-based methods had to be fully automated as it would be impractical to manually define points of interest, due to the size of the data. Moreover, the proposed automated approach eliminates any subjectivity involved in the manual point selection process.

An important parameter that may affect the efficiency of all geometry-based variant methods is the size of the neighborhood used to calculate the feature descriptors (FPFH, SHOT and SN). As described in Section 2.2.2, all descriptors define the neighborhood of each point as a sphere centered on the examined point. All points that lie inside this sphere are considered in the calculation of the respective descriptor. Therefore, this particular radius is a key parameter for the performance of the examined geometry-based techniques. In order to quantify the effect of varying the radius 
                        
                           r
                        
                      in the obtained measurements of the Mean Contour Distance between the reference and the aligned data sets, ten pairs with known initial spatial deviations were used. For these particular pairs, each descriptor was used to align the data volumes, by varying the radius 
                        
                           r
                        
                      from 
                        
                           32
                           
                              
                              
                                 mm
                              
                           
                        
                      to 96mm with an incremental step of 
                        
                           1.6
                           
                           
                              mm
                           
                        
                     . The particular search interval was determined after a series of initial trials with an extended search interval. The goal was to determine the radius value for which each descriptor achieves optimal registration accuracy, in terms the MCD metric. The results of the conducted radius tests are illustrated in 
                     Fig. 4, in terms of the recorded average MCD values. In particular, Fig. 4(a)–(c) shows the behavior of the SHOT, SN and FPFH descriptors, respectively, for different values of the radius. In each plot, the optimal radius is annotated as well as the minimum average MCD value achieved for all ten CT data pairs with known geometrical differences. As can be seen in Fig. (4), each descriptor performs optimally at a different radius, as their algorithmic design differs.

All of the registration techniques featured in this study were implemented by developing a custom C++ application. The implementations were based on the Point Cloud Library (PCL) and the Insight Segmentation and Registration Toolkit (ITK) [43,44,46,48]. All implementations featured full multi-threading support thus utilizing all available CPU cores. The developed custom application includes tools for the quantitative and qualitative evaluation of all compared techniques. All tests were performed on a common reference system (Intel i7 processor at 2.8GHz, 8 GB of RAM, running on a 64-bit Linux operating system).

One of the most important aspects of this study is the significant improvement in terms of processing time when aligning 3D CT medical data. This improvement was achieved by only considering a selected number of data points, based on their geometrical properties. Through the results presented in Section 3, it is evident that the reduced processing time does not negatively impact on the registration accuracy. Therefore, the proposed geometry-based scheme could potentially replace conventional intensity-based registration methods in time critical applications, after suitable clinical evaluation.

The geometry-based methodology as well as the exhaustive, intensity-based methodology, as presented in Figs. 1 and 2, were applied to cranial CT volume pairs. Both methodologies can be considered as general, and they can be applied to unimodal data from different anatomical regions as well as data acquired from different modalities. Nevertheless, some of the processes in each methodology may require to be refined. Specifically, when CT data from abdomen or thorax need to be registered, the elastic nature of depicted organs included in the data or to the deformations caused by respiration during data acquisition should be considered. In such cases, the affine transform should be replaced by a more suitable elastic transformation model.

Moreover, with minor modifications, the presented methodologies could be applied to data acquired from different modalities. Such modifications may include a revision of the key point selection phase and the refinement of the parameter selection process (e.g. neighborhood size), in order to adjust the proposed geometry-based descriptors to the geometrical properties of the new data sets (e.g. MRI). In addition, applying the geometry-based registration methodology could be advantageous for aligning data sets with different chromatic properties (CT-MRI), since it does not depend on the pixel intensity of the data to be registered. Finally, this study could be extended in the near future for considering either unimodal data from different anatomical areas or data from different modalities.

@&#CONCLUSIONS@&#

In this study, an extensive comparison was performed including several geometry-based and exhaustive, intensity-based registration techniques. More specifically, three distinct metrics were examined as part of a conventional intensity-based registration methodology: Correlation Coefficient, Mattes Mutual Information, and Mean Square Error. In addition a geometry-based registration scheme was considered, based on three geometrical feature descriptors (Fast Point Feature Histograms, Signatures of Histograms of Orientation, and Surface Normals). All of the above registration techniques, along with the well-established Iterative Closest algorithm, were applied to a total of 30 3D CT volume pairs with known and unknown initial spatial differences. Qualitative and quantitative evaluation of the aligned data showed that the proposed geometry-based registration framework, using any of the featured descriptors, achieved similar accuracy to the examined exhaustive, intensity-based registration variants, by significantly reducing the required processing time, on the examined cranial CT data.

The authors of the manuscript titled: “Geometry-Based Versus Intensity-Based Alignment: a Comparative Study on 3D CT Data” declared that there is no any financial or any personal relationships with other people or organizations that could inappropriately influence (bias) their work.

@&#ACKNOWLEDGMENTS@&#

We would like to thank Dr. Peter Windisch and his team at Department of Periodontology, Semmelweis University, Budapest, Hungary, for providing us with the necessary data sets for conducting this study. The data sets featured in this study were acquired under an approval granted by the Semmelweis University Regional and Institutional Committee of Science and Research Ethics (reference number: 77/2011)

@&#REFERENCES@&#

