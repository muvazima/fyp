@&#MAIN-TITLE@&#Design of a heart rate controller for treadmill exercise using a recurrent fuzzy neural network

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           The manuscript presents RFNNHRC replacing the PI.


                        
                        
                           
                           RFNN achieves minimal HR deviation & resulted in smaller fluctuation than PI


                        
                        
                           
                           RFNN performs smoother in treadmill speed and incline control by our test.


                        
                        
                           
                           RFNN controls HR with adjusting parameter and online learning algorithm.


                        
                        
                           
                           Experiments in the manuscript proves more stable HRC by RFNN against PI.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Computer controlled treadmill

Recurrent fuzzy neural network

Heart rate controller

Treadmill speed and incline

Adjustable parameters

On-line learning algorithm

@&#ABSTRACT@&#


               
               
                  Background and objective
                  In this study, we developed a computer controlled treadmill system using a recurrent fuzzy neural network heart rate controller (RFNNHRC). Treadmill speeds and inclines were controlled by corresponding control servo motors. The RFNNHRC was used to generate the control signals to automatically control treadmill speed and incline to minimize the user heart rate deviations from a preset profile.
               
               
                  Methods
                  The RFNNHRC combines a fuzzy reasoning capability to accommodate uncertain information and an artificial recurrent neural network learning process that corrects for treadmill system nonlinearities and uncertainties. Treadmill speeds and inclines are controlled by the RFNNHRC to achieve minimal heart rate deviation from a pre-set profile using adjustable parameters and an on-line learning algorithm that provides robust performance against parameter variations. The on-line learning algorithm of RFNNHRC was developed and implemented using a dsPIC 30F4011 DSP.
               
               
                  Results
                  Application of the proposed control scheme to heart rate responses of runners resulted in smaller fluctuations than those produced by using proportional integra control, and treadmill speeds and inclines were smoother. The present experiments demonstrate improved heart rate tracking performance with the proposed control scheme.
               
               
                  Conclusions
                  The RFNNHRC scheme with adjustable parameters and an on-line learning algorithm was applied to a computer controlled treadmill system with heart rate control during treadmill exercise. Novel RFNNHRC structure and controller stability analyses were introduced. The RFNNHRC were tuned using a Lyapunov function to ensure system stability. The superior heart rate control with the proposed RFNNHRC scheme was demonstrated with various pre-set heart rates.
               
            

@&#INTRODUCTION@&#

Automated exercise testing systems are increasingly important during exercise training, rehabilitation, and cardio respiratory analyses. However, currently available treadmills that offer heart rate control have poor performance and lack mechanisms for setting desired heart rate profiles. Among heart rate systems for treadmills, proportional–integral (PI) controllers operate on simple algorithms that produce high-stability margins and high reliability when properly designed [1,2]. However, these properties of PI controllers remain subject to nonlinear speed characteristics of treadmill systems and vary with drive operating conditions, or are too complex to control using traditional strategies [3–10]. Cardiac diseases have a challenging problems with enormous economic impact worldwide [11–13]. A cyber-physical systems approach to pacemaker was designed that exploits the fractal properties of heart rate activity. In order to achieve adaptive tracking performance, an adaptive neural network control scheme is presented to adjust controller parameters based on its on-line learning ability [14].

Recent studies report fuzzy logic controls, adaptive controls, and neural network applications that accommodate control system nonlinearities and uncertainties [15–19]. Although fuzzy logic controls can be manipulated to compensate for system nonlinearities, successful applications are dependent on the experience of the designer. Moreover, fuzzy control rules, rule numbers, and parameter values of membership functions are difficult to select, and parameter values of the membership function cannot be adjusted on-line to provide robust performance against treadmill system nonlinearities and uncertainties. In contrast, adaptive controls automatically adjust system responses in accordance with parameter variations, but generally require reference system models that are impractical for treadmill exercise systems.

Neural networks are classified as feed-forward or recurrent according to structure [20], and it is well known that feed-forward neural networks can closely approximate any continuous function. However, feed-forward neural networks employ static mapping without the aid of delays, and fail to represent dynamic mapping. Although many previously reported feed-forward neural networks have been used to address delays and dynamic problems, these require large numbers of neurons to express dynamic responses [21]. Furthermore, weight calculations do not update quickly and function approximations are dependent on training data.

To overcome these difficulties, we propose the use of a recurrent fuzzy neural network heart rate controller with adjustable parameters and on-line learning algorithms that have potential for wide application in unknown, nonlinear or uncertain dynamic systems such as the fractal characteristics of the heart rate. Recurrent neural networks are dynamic mapping environments that display good control performance in the presence of unknown, nonlinear, uncertain and time-varying model dynamics [22,23]. Moreover, recurrent neurons have internal feedback loops and can capture dynamic system responses without requiring delayed external feedback. Hence, recurrent neural networks are better suited for dynamic systems than feed-forward neural networks [24].

When hidden neurons are too numerous, computation loads can overwhelm systems, which then become unsuitable for practical on-line applications. However, too few chosen hidden neurons lead to insufficient learning performance to achieve adequate control. To overcome this problem, we developed a novel recurrent fuzzy neural network heart rate controller (RFNNHRC) that maintains high accuracy under both of these conditions. In addition, this RFNNHRC employs local modeling and fuzzy input space partition, dynamic fuzzy rule linguistic descriptions, proper learning based structure for training examples, and parsimonious models with reduced parametric complexity [25]. This novel combination of fuzzy reasoning capabilities and artificial recurrent neural network learning processes may accommodate information uncertainties and compensate for treadmill system nonlinearities and uncertainties. The present scheme for heart rate control was designed to control heart rate according to a pre-set heart rate profile during treadmill exercise using adjustable parameters and an on-line learning algorithm that overcomes problems of nonlinearity. Moreover, updating of connections weights in the RFNNHRC allows effective computation of variable treadmill characteristics and provides robust performance against parameter variations.

To characterize and validate the present innovation, the proposed RFNNHRC was compared with a conventional PI controller and its utility and validity were verified experimentally. The present analyses demonstrate stable performance of the present RFNNHRC under various exercise conditions.


                     Fig. 1
                      shows the RFNNHRC treadmill control scheme. Treadmill speeds and inclines were controlled by corresponding control servo motors, and the RFNNHRC was used to generate the control signals u
                     
                        S
                      and u
                     
                        θ
                     , and to automatically control treadmill speed and incline so that the difference between the users heart rate h and the preset heart rate command h* was minimized.

As shown in Fig. 2
                         the RFNNHRC comprises an input layer, a membership layer, a rule layer, and an output layer.

The RFNNHRC mathematical model is summarized as follows:

RFNNHRC inputs follow the error e
                           =
                           h*−
                           h and error change 
                              
                                 e
                                 ˙
                              
                           , and the outputs 
                              
                                 
                                    x
                                    
                                       e
                                       ,
                                       i
                                    
                                    1
                                 
                              
                            and 
                              
                                 
                                    x
                                    
                                       
                                          e
                                          ˙
                                       
                                       ,
                                       i
                                    
                                    1
                                 
                              
                            can be expressed as:
                              
                                 (1)
                                 
                                    
                                       
                                          x
                                          
                                             e
                                             ,
                                             i
                                          
                                          1
                                       
                                       =
                                       e
                                       ,
                                        
                                       i
                                       =
                                       1
                                       ,
                                       …
                                       ,
                                       9
                                    
                                 
                              
                           
                           
                              
                                 (2)
                                 
                                    
                                       
                                          x
                                          
                                             
                                                e
                                                ˙
                                             
                                             ,
                                             i
                                          
                                          1
                                       
                                       =
                                       
                                          e
                                          ˙
                                       
                                       ,
                                        
                                       i
                                       =
                                       1
                                       ,
                                       …
                                       ,
                                       9
                                    
                                 
                              
                           
                        

Define the fuzzy sets PE, ZE and NE on error e, fuzzy sets PD, ZD and ND on error change 
                              
                                 e
                                 ˙
                              
                           , fuzzy sets PU, MU, ZU, SU and NU on control force u, while the responding Gaussian membership functions are shown in Fig. 3(a)–(c), respectively. As a result, 9 fuzzy rules are constructed which are shown as follows, while 9 hidden nodes on Membership layer and Rule layer are chosen.
                              
                                 Rule 1: If e is PE and 
                                       
                                          e
                                          ˙
                                       
                                     is PD, then u is PU.

Rule 2: If e is PE and 
                                       
                                          e
                                          ˙
                                       
                                     is ZD, then u is PU.

Rule 3: If e is PE and 
                                       
                                          e
                                          ˙
                                       
                                     is ND, then u is MU.

Rule 4: If e is ZE and 
                                       
                                          e
                                          ˙
                                       
                                     is PD, then u is MU.

Rule 5: If e is ZE and 
                                       
                                          e
                                          ˙
                                       
                                     is ZD, then u is ZU.

Rule 6: If e is ZE and 
                                       
                                          e
                                          ˙
                                       
                                     is ND, then u is SU.

Rule 7: If e is NE and 
                                       
                                          e
                                          ˙
                                       
                                     is PD, then u is SU.

Rule 8: If e is NE and 
                                       
                                          e
                                          ˙
                                       
                                     is ZD, then u is NU.

Rule 9: If e is NE and 
                                       
                                          e
                                          ˙
                                       
                                     is ND, then u is NU.

The Membership layer outputs 
                              
                                 
                                    y
                                    
                                       e
                                       ,
                                       i
                                    
                                    2
                                 
                              
                            and 
                              
                                 
                                    y
                                    
                                       
                                          e
                                          ˙
                                       
                                       ,
                                       i
                                    
                                    2
                                 
                              
                            can be expressed as a Gaussian function:
                              
                                 (3)
                                 
                                    
                                       
                                          x
                                          
                                             e
                                             ,
                                             i
                                          
                                          2
                                       
                                       =
                                       exp
                                       
                                          
                                             −
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  x
                                                                  
                                                                     e
                                                                     ,
                                                                     i
                                                                  
                                                                  1
                                                               
                                                               −
                                                               
                                                                  s
                                                                  
                                                                     e
                                                                     ,
                                                                     i
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  z
                                                                  
                                                                     e
                                                                     ,
                                                                     i
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                2
                                             
                                          
                                       
                                       ,
                                        
                                       i
                                       =
                                       1
                                       ,
                                       …
                                       ,
                                       9
                                    
                                 
                              
                           
                           
                              
                                 (4)
                                 
                                    
                                       
                                          x
                                          
                                             
                                                e
                                                ˙
                                             
                                             ,
                                             i
                                          
                                          2
                                       
                                       =
                                       exp
                                       
                                          
                                             −
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  x
                                                                  
                                                                     
                                                                        e
                                                                        ˙
                                                                     
                                                                     ,
                                                                     i
                                                                  
                                                                  1
                                                               
                                                               −
                                                               
                                                                  s
                                                                  
                                                                     
                                                                        e
                                                                        ˙
                                                                     
                                                                     ,
                                                                     i
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  z
                                                                  
                                                                     
                                                                        e
                                                                        ˙
                                                                     
                                                                     ,
                                                                     i
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                2
                                             
                                          
                                       
                                       ,
                                        
                                       i
                                       =
                                       1
                                       ,
                                       …
                                       ,
                                       9
                                    
                                 
                              
                           where 
                              
                                 
                                    S
                                 
                                 =
                                 
                                    
                                       [
                                       
                                          s
                                          
                                             e
                                             ,
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          s
                                          
                                             e
                                             ,
                                             9
                                          
                                       
                                       ,
                                       
                                          s
                                          
                                             
                                                e
                                                ˙
                                             
                                             ,
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          s
                                          
                                             
                                                e
                                                ˙
                                             
                                             ,
                                             9
                                          
                                       
                                       ]
                                    
                                    T
                                 
                              
                            is the mean Gaussian function vector and 
                              
                                 
                                    Z
                                 
                                 =
                                 
                                    
                                       [
                                       
                                          z
                                          
                                             e
                                             ,
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          z
                                          
                                             e
                                             ,
                                             9
                                          
                                       
                                       ,
                                       
                                          z
                                          
                                             
                                                e
                                                ˙
                                             
                                             ,
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          z
                                          
                                             
                                                e
                                                ˙
                                             
                                             ,
                                             9
                                          
                                       
                                       ]
                                    
                                    T
                                 
                              
                            is the standard deviation Gaussian function vector.

Rule layer outputs are expressed as:
                              
                                 (5)
                                 
                                    
                                       
                                          x
                                          i
                                          3
                                       
                                       (
                                       t
                                       )
                                       =
                                       
                                          
                                             1
                                             +
                                             
                                                1
                                                
                                                   1
                                                   +
                                                   
                                                      
                                                         exp
                                                      
                                                      
                                                         −
                                                         
                                                            r
                                                            i
                                                         
                                                         
                                                            x
                                                            i
                                                            3
                                                         
                                                         (
                                                         t
                                                         −
                                                         1
                                                         )
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          x
                                          
                                             e
                                             ,
                                             i
                                          
                                          2
                                       
                                       (
                                       t
                                       )
                                       
                                          x
                                          
                                             
                                                e
                                                ˙
                                             
                                             ,
                                             i
                                          
                                          2
                                       
                                       (
                                       t
                                       )
                                       ,
                                        
                                       i
                                       =
                                       1
                                       ,
                                       …
                                       ,
                                       9
                                    
                                 
                              
                           where R
                           =[r
                           1, …, r
                           9] is the recurrent weight vector. The recurrent neurons have internal feedback loops and can capture dynamic system responses without requiring delayed external feedback.

The output layer outputs u
                           
                              S
                            and u
                           
                              θ
                            can be expressed as follows:
                              
                                 (6)
                                 
                                    
                                       
                                          u
                                          S
                                       
                                       =
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          9
                                       
                                       
                                          
                                             w
                                             
                                                1
                                                i
                                             
                                          
                                          
                                             x
                                             i
                                             3
                                          
                                       
                                       +
                                       
                                          u
                                          
                                             C
                                             1
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (7)
                                 
                                    
                                       
                                          u
                                          θ
                                       
                                       =
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          9
                                       
                                       
                                          
                                             w
                                             
                                                2
                                                i
                                             
                                          
                                          
                                             x
                                             i
                                             3
                                          
                                       
                                       +
                                       
                                          u
                                          
                                             C
                                             2
                                          
                                       
                                    
                                 
                              
                           
                        

Eqs. (6) and (7) can be rewritten in matrix form as:
                              
                                 (8)
                                 
                                    
                                       
                                          u
                                       
                                       =
                                       
                                          
                                             W
                                          
                                          T
                                       
                                       
                                          T
                                       
                                       (
                                       x
                                       ,
                                       s
                                       ,
                                       z
                                       ,
                                       r
                                       )
                                       +
                                       
                                          
                                             u
                                          
                                          
                                             C
                                          
                                       
                                    
                                 
                              
                           where 
                              
                                 
                                    T
                                 
                                 (
                                 x
                                 ,
                                 s
                                 ,
                                 z
                                 ,
                                 r
                                 )
                                 =
                                 
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   
                                                      x
                                                      1
                                                      3
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      x
                                                      2
                                                      3
                                                   
                                                
                                             
                                             
                                                …
                                             
                                             
                                                
                                                   
                                                      x
                                                      9
                                                      3
                                                   
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    T
                                 
                              
                            is the fuzzy rule function vector, 
                              
                                 
                                    W
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            w
                                                            
                                                               11
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            w
                                                            
                                                               11
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      …
                                                   
                                                   
                                                      
                                                         
                                                            w
                                                            
                                                               19
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            w
                                                            
                                                               21
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            w
                                                            
                                                               22
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      …
                                                   
                                                   
                                                      
                                                         
                                                            w
                                                            
                                                               29
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    T
                                 
                              
                            is the adjustable output weight vector, and 
                              
                                 
                                    u
                                 
                                 (
                                 t
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            u
                                                            S
                                                         
                                                         (
                                                         t
                                                         )
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            u
                                                            θ
                                                         
                                                         (
                                                         t
                                                         )
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    T
                                 
                              
                            and 
                              
                                 
                                    
                                       u
                                    
                                    
                                       C
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            u
                                                            
                                                               C
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            u
                                                            
                                                               C
                                                               2
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    T
                                 
                              
                            comprise the compensated force.

The treadmill nonlinear dynamic system can be expressed as follows:
                           
                              (9)
                              
                                 
                                    
                                       y
                                       ¨
                                    
                                    =
                                    f
                                    (
                                    y
                                    )
                                    +
                                    
                                       g
                                    
                                    (
                                    y
                                    )
                                    
                                       u
                                    
                                    (
                                    t
                                    )
                                    +
                                    d
                                    (
                                    t
                                    )
                                 
                              
                           
                        where f(y) and 
                           
                              
                                 g
                              
                              (
                              y
                              )
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   g
                                                   1
                                                
                                                (
                                                t
                                                )
                                             
                                          
                                          
                                             
                                                
                                                   g
                                                   2
                                                
                                                (
                                                t
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                         are unknown treadmill functions and are assumed to be bound, 
                           
                              
                                 u
                              
                              (
                              t
                              )
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         u
                                                         S
                                                      
                                                      (
                                                      t
                                                      )
                                                   
                                                
                                                
                                                   
                                                      
                                                         u
                                                         θ
                                                      
                                                      (
                                                      t
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 T
                              
                           
                         is the control input, and d(t) is the external disturbance.

The present RFNNHRC was designed so that the treadmill rotor angle tracks the reference model output angle using the following tracking error vector:
                           
                              (10)
                              
                                 
                                    
                                       E
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         e
                                                      
                                                      
                                                         
                                                            e
                                                            ˙
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       T
                                    
                                 
                              
                           
                        
                     

From (9) and (10), an ideal controller can be chosen as
                           
                              (11)
                              
                                 
                                    
                                       
                                          y
                                          ¨
                                       
                                       n
                                    
                                    =
                                    
                                       f
                                       n
                                    
                                    (
                                    y
                                    )
                                    +
                                    
                                       
                                          g
                                       
                                       n
                                    
                                    (
                                    y
                                    )
                                    
                                       
                                          u
                                       
                                       
                                          *
                                       
                                    
                                    (
                                    t
                                    )
                                    +
                                    
                                       d
                                       n
                                    
                                    (
                                    t
                                    )
                                    −
                                    
                                       
                                          K
                                       
                                       T
                                    
                                    
                                       E
                                    
                                 
                              
                           
                        where 
                           
                              
                                 K
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         k
                                                         2
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         k
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 T
                              
                           
                        , and k
                        1 and k
                        2 are positive constants. Upon application of (11) to (9), the error dynamics can be expressed as
                           
                              (12)
                              
                                 
                                    
                                       e
                                       ¨
                                    
                                    +
                                    
                                       k
                                       1
                                    
                                    
                                       e
                                       ˙
                                    
                                    +
                                    
                                       k
                                       2
                                    
                                    e
                                    =
                                    0
                                 
                              
                           
                        
                     

If K corresponds with Hurwitz polynomial coefficients, or polynomials with roots lying strictly in the open left half of the complex plane, lim
                           t→∞
                        e(t)=0 for all initial conditions. Nevertheless, the functions f(y) and g(y) are not accurately known and the external load disturbances are perturbed. Thus, the ideal controller u
                        
                           *
                        (t) cannot be practically implemented. Nonetheless, the present RFNNHRC was designed to approximate this ideal controller, and the proposed control scheme for the treadmill with RFNNHRC and compensated controllers is shown in Fig. 1.

From Eqs. (9), (10), and (11), the error equation can be rewritten as follows:
                           
                              (13)
                              
                                 
                                    
                                       
                                          E
                                       
                                       ˙
                                    
                                    =
                                    
                                       AE
                                    
                                    +
                                    
                                       B
                                    
                                    (
                                    
                                       
                                          u
                                       
                                       *
                                    
                                    −
                                    
                                       u
                                    
                                    )
                                 
                              
                           
                        where 
                           
                              
                                 A
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             0
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             
                                                −
                                                
                                                   k
                                                   2
                                                
                                             
                                          
                                          
                                             
                                                −
                                                
                                                   k
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                         and 
                           
                              
                                 B
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             0
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             
                                                
                                                   g
                                                   1
                                                
                                                (
                                                y
                                                )
                                             
                                          
                                          
                                             
                                                
                                                   g
                                                   2
                                                
                                                (
                                                y
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                        .

Pending on the assumption that a RFNNHRC can be developed to approximate the ideal control force, the following equation is true:
                           
                              (14)
                              
                                 
                                    
                                       
                                          u
                                       
                                       *
                                    
                                    (
                                    e
                                    ,
                                    
                                       
                                          W
                                       
                                       *
                                    
                                    ,
                                    
                                       
                                          S
                                       
                                       *
                                    
                                    ,
                                    
                                       
                                          Z
                                       
                                       *
                                    
                                    ,
                                    
                                       
                                          R
                                       
                                       *
                                    
                                    )
                                    =
                                    
                                       
                                          W
                                       
                                       
                                          
                                             *
                                             T
                                          
                                       
                                    
                                    
                                       
                                          T
                                       
                                       *
                                    
                                    +
                                    ε
                                 
                              
                           
                        where ɛ is a minimum reconstructed error, and W*, S*, Z*, R* and T* are optimal parameters of W, S, Z, R and T, respectively. Thus, the control force is assumed to take the following form:
                           
                              (15)
                              
                                 
                                    
                                       u
                                    
                                    (
                                    e
                                    ,
                                    
                                       
                                          W
                                       
                                       ⌢
                                    
                                    ,
                                    
                                       
                                          S
                                       
                                       ⌢
                                    
                                    ,
                                    
                                       
                                          Z
                                       
                                       ⌢
                                    
                                    ,
                                    
                                       
                                          R
                                       
                                       ⌢
                                    
                                    )
                                    =
                                    
                                       
                                          
                                             W
                                          
                                          ⌢
                                       
                                       T
                                    
                                    
                                       
                                          T
                                       
                                       ⌢
                                    
                                    +
                                    
                                       
                                          u
                                       
                                       
                                          C
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    W
                                 
                                 ⌢
                              
                              ,
                              
                                 
                                    S
                                 
                                 ⌢
                              
                              ,
                              
                                 
                                    Z
                                 
                                 ⌢
                              
                              ,
                              
                                 
                                    R
                                 
                                 ⌢
                              
                           
                         and 
                           
                              
                                 T
                              
                              ⌢
                           
                         are the optimal parameter estimations provided by tuning the subsequent algorithms 
                           
                              
                                 u
                              
                              (
                              t
                              )
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         u
                                                         S
                                                      
                                                      (
                                                      t
                                                      )
                                                   
                                                
                                                
                                                   
                                                      
                                                         u
                                                         θ
                                                      
                                                      (
                                                      t
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 T
                              
                           
                         and 
                           
                              
                                 
                                    u
                                 
                                 
                                    C
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         u
                                                         
                                                            C
                                                            1
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         u
                                                         
                                                            C
                                                            2
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 T
                              
                           
                        . Subtracting (15) from (14), an approximation error 
                           
                              u
                              ˜
                           
                         is obtained as
                           
                              (16)
                              
                                 
                                    
                                       
                                          u
                                       
                                       ˜
                                    
                                    =
                                    
                                       
                                          u
                                       
                                       *
                                    
                                    −
                                    
                                       u
                                    
                                    =
                                    
                                       
                                          W
                                       
                                       
                                          
                                             *
                                             T
                                          
                                       
                                    
                                    
                                       
                                          T
                                       
                                       *
                                    
                                    +
                                    ε
                                    −
                                    
                                       
                                          
                                             W
                                          
                                          ⌢
                                       
                                       T
                                    
                                    
                                       
                                          T
                                       
                                       ⌢
                                    
                                    −
                                    
                                       
                                          u
                                       
                                       
                                          C
                                       
                                    
                                    =
                                    
                                       
                                          
                                             W
                                          
                                          ˜
                                       
                                       T
                                    
                                    
                                       
                                          T
                                       
                                       *
                                    
                                    +
                                    
                                       
                                          
                                             W
                                          
                                          ⌢
                                       
                                       T
                                    
                                    
                                       
                                          T
                                       
                                       ˜
                                    
                                    +
                                    ε
                                    −
                                    
                                       
                                          u
                                       
                                       
                                          C
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    W
                                 
                                 ˜
                              
                              =
                              
                                 
                                    W
                                 
                                 *
                              
                              −
                              
                                 
                                    W
                                 
                                 ⌢
                              
                           
                         and 
                           
                              
                                 
                                    T
                                 
                                 ˜
                              
                              =
                              
                                 
                                    T
                                 
                                 *
                              
                              −
                              
                                 
                                    T
                                 
                                 ⌢
                              
                           
                        . The linearization technique transforms the multidimensional receptive-field basis functions into a partially linear form such that the expansion of 
                           
                              
                                 T
                              
                              ˜
                           
                         in a Taylor series can be written as follows:
                           
                              (17)
                              
                                 
                                    
                                       
                                          T
                                       
                                       ˜
                                    
                                    =
                                    
                                       
                                          [
                                          
                                             
                                                x
                                                ˜
                                             
                                             1
                                             3
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                x
                                                ˜
                                             
                                             9
                                             3
                                          
                                          ]
                                       
                                       T
                                    
                                    =
                                    
                                       
                                          T
                                       
                                       s
                                    
                                    
                                       
                                          S
                                       
                                       ˜
                                    
                                    +
                                    
                                       
                                          T
                                       
                                       z
                                    
                                    
                                       
                                          Z
                                       
                                       ˜
                                    
                                    +
                                    
                                       
                                          T
                                       
                                       r
                                    
                                    
                                       
                                          R
                                       
                                       ˜
                                    
                                    +
                                    
                                       
                                          O
                                       
                                       v
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    x
                                    ˜
                                 
                                 i
                                 3
                              
                              =
                              
                                 x
                                 i
                                 
                                    3
                                    *
                                 
                              
                              −
                              
                                 
                                    x
                                    ⌢
                                 
                                 i
                                 3
                              
                           
                        , 
                           
                              
                                 x
                                 i
                                 
                                    
                                       3
                                       *
                                    
                                 
                              
                           
                         is the optimal parameter, 
                           
                              
                                 
                                    x
                                    ⌢
                                 
                                 i
                                 3
                              
                           
                         is the estimated parameter of 
                           
                              
                                 x
                                 i
                                 
                                    
                                       3
                                       *
                                    
                                 
                              
                           
                        , 
                           
                              
                                 
                                    S
                                 
                                 ˜
                              
                              =
                              
                                 
                                    S
                                 
                                 *
                              
                              −
                              
                                 
                                    S
                                 
                                 ⌢
                              
                           
                        , 
                           
                              
                                 
                                    Z
                                 
                                 ˜
                              
                              =
                              
                                 
                                    Z
                                 
                                 *
                              
                              −
                              
                                 
                                    Z
                                 
                                 ⌢
                              
                           
                        , 
                           
                              
                                 
                                    R
                                 
                                 ˜
                              
                              =
                              
                                 
                                    R
                                 
                                 *
                              
                              −
                              
                                 
                                    R
                                 
                                 ⌢
                              
                           
                        , and 
                           
                              
                                 
                                    O
                                 
                                 v
                              
                           
                         are higher-order terms, and 
                           
                              
                                 
                                    T
                                 
                                 s
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∂
                                                            
                                                               x
                                                               1
                                                               3
                                                            
                                                         
                                                         
                                                            ∂
                                                            s
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            ∂
                                                            
                                                               x
                                                               2
                                                               3
                                                            
                                                         
                                                         
                                                            ∂
                                                            s
                                                         
                                                      
                                                   
                                                
                                                
                                                   …
                                                
                                                
                                                   
                                                      
                                                         
                                                            ∂
                                                            
                                                               x
                                                               9
                                                               3
                                                            
                                                         
                                                         
                                                            ∂
                                                            s
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    s
                                    =
                                    
                                       s
                                       ⌢
                                    
                                 
                                 T
                              
                           
                        , 
                           
                              
                                 
                                    T
                                 
                                 z
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∂
                                                            
                                                               x
                                                               1
                                                               3
                                                            
                                                         
                                                         
                                                            ∂
                                                            z
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            ∂
                                                            
                                                               x
                                                               2
                                                               3
                                                            
                                                         
                                                         
                                                            ∂
                                                            z
                                                         
                                                      
                                                   
                                                
                                                
                                                   …
                                                
                                                
                                                   
                                                      
                                                         
                                                            ∂
                                                            
                                                               x
                                                               9
                                                               3
                                                            
                                                         
                                                         
                                                            ∂
                                                            z
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    z
                                    =
                                    
                                       z
                                       ⌢
                                    
                                 
                                 T
                              
                           
                        , and 
                           
                              
                                 
                                    T
                                 
                                 r
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∂
                                                            
                                                               x
                                                               1
                                                               3
                                                            
                                                         
                                                         
                                                            ∂
                                                            r
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            ∂
                                                            
                                                               x
                                                               2
                                                               3
                                                            
                                                         
                                                         
                                                            ∂
                                                            r
                                                         
                                                      
                                                   
                                                
                                                
                                                   …
                                                
                                                
                                                   
                                                      
                                                         
                                                            ∂
                                                            
                                                               x
                                                               9
                                                               3
                                                            
                                                         
                                                         
                                                            ∂
                                                            r
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    r
                                    =
                                    
                                       r
                                       ˆ
                                    
                                 
                                 T
                              
                           
                        .

Accordingly, Eq. (17) can be rewritten as
                           
                              (18)
                              
                                 
                                    
                                       
                                          T
                                       
                                       *
                                    
                                    =
                                    
                                       
                                          T
                                       
                                       ⌢
                                    
                                    +
                                    
                                       
                                          T
                                       
                                       s
                                    
                                    
                                       
                                          S
                                       
                                       ˜
                                    
                                    +
                                    
                                       
                                          T
                                       
                                       z
                                    
                                    
                                       
                                          Z
                                       
                                       ˜
                                    
                                    +
                                    
                                       
                                          T
                                       
                                       r
                                    
                                    
                                       
                                          R
                                       
                                       ˜
                                    
                                    +
                                    
                                       
                                          O
                                       
                                       v
                                    
                                 
                              
                           
                        
                     

Substitution of (18) into (16) leads to the following equation:
                           
                              (19)
                              
                                 
                                    
                                       
                                          u
                                       
                                       ˜
                                    
                                    =
                                    
                                       
                                          
                                             W
                                          
                                          ˜
                                       
                                       T
                                    
                                    
                                       
                                          T
                                       
                                       ⌢
                                    
                                    +
                                    
                                       
                                          
                                             W
                                          
                                          ⌢
                                       
                                       T
                                    
                                    (
                                    
                                       
                                          T
                                       
                                       s
                                    
                                    
                                       
                                          S
                                       
                                       ˜
                                    
                                    +
                                    
                                       
                                          T
                                       
                                       z
                                    
                                    
                                       
                                          Z
                                       
                                       ˜
                                    
                                    +
                                    
                                       
                                          T
                                       
                                       r
                                    
                                    
                                       
                                          R
                                       
                                       ˜
                                    
                                    )
                                    −
                                    
                                       
                                          u
                                       
                                       
                                          C
                                       
                                    
                                    +
                                    
                                       D
                                    
                                 
                              
                           
                        where 
                           
                              
                                 D
                              
                              =
                              
                                 
                                    
                                       W
                                    
                                    ˜
                                 
                                 T
                              
                              (
                              
                                 
                                    T
                                 
                                 s
                              
                              
                                 
                                    S
                                 
                                 ˜
                              
                              +
                              
                                 
                                    T
                                 
                                 z
                              
                              
                                 
                                    Z
                                 
                                 ˜
                              
                              +
                              
                                 
                                    T
                                 
                                 r
                              
                              
                                 
                                    R
                                 
                                 ˜
                              
                              )
                              +
                              
                                 
                                    W
                                 
                                 
                                    
                                       *
                                       T
                                    
                                 
                              
                              
                                 
                                    O
                                 
                                 v
                              
                              +
                              ε
                           
                         is the uncertainty term and is assumed to be bound with a small positive constant vector 
                           
                              
                                 β
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         β
                                                         1
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         β
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 T
                              
                           
                         (let 
                           
                              
                                 
                                    D
                                 
                              
                              ≤
                              
                                 
                                    β
                                 
                              
                           
                        ).
                           Theorem
                           
                              Considering that the treadmill dynamic system is represented by 
                              (9), the RFNNHRC control law is designed as in 
                              (15), with adaptive laws for network parameters as described in 
                              (20)–(23). The compensated controller control law is designed as in 
                              (24) 
                              with the estimation law given in 
                              (25). The stability of the proposed control scheme can then be guaranteed, and η
                              1, η
                              2, η
                              3, η
                              4, and η
                              5 
                              are strictly positive constants:
                                 
                                    (20)
                                    
                                       
                                          
                                             
                                                
                                                   W
                                                
                                                ⌢
                                             
                                             ˙
                                          
                                          =
                                          
                                             η
                                             1
                                          
                                          
                                             
                                                T
                                             
                                             ⌢
                                          
                                          
                                             
                                                E
                                             
                                             T
                                          
                                          
                                             PB
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (21)
                                    
                                       
                                          
                                             
                                                
                                                   S
                                                
                                                ⌢
                                             
                                             ˙
                                          
                                          =
                                          
                                             η
                                             2
                                          
                                          
                                             
                                                T
                                             
                                             s
                                             T
                                          
                                          
                                             
                                                W
                                             
                                             ⌢
                                          
                                          
                                             
                                                E
                                             
                                             T
                                          
                                          
                                             PB
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (22)
                                    
                                       
                                          
                                             
                                                
                                                   Z
                                                
                                                ⌢
                                             
                                             ˙
                                          
                                          =
                                          
                                             η
                                             3
                                          
                                          
                                             
                                                T
                                             
                                             z
                                             T
                                          
                                          
                                             
                                                W
                                             
                                             ⌢
                                          
                                          
                                             
                                                E
                                             
                                             T
                                          
                                          
                                             PB
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (23)
                                    
                                       
                                          
                                             
                                                
                                                   R
                                                
                                                ⌢
                                             
                                             ˙
                                          
                                          =
                                          
                                             η
                                             4
                                          
                                          
                                             
                                                T
                                             
                                             r
                                             T
                                          
                                          
                                             
                                                W
                                             
                                             ⌢
                                          
                                          
                                             
                                                E
                                             
                                             T
                                          
                                          
                                             PB
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (24)
                                    
                                       
                                          
                                             
                                                u
                                             
                                             
                                                C
                                             
                                          
                                          =
                                          
                                             
                                                β
                                             
                                             ⌢
                                          
                                          sgn
                                          (
                                          
                                             
                                                E
                                             
                                             T
                                          
                                          
                                             PB
                                          
                                          )
                                       
                                    
                                 
                              
                              
                                 
                                    (25)
                                    
                                       
                                          
                                             
                                                
                                                   β
                                                
                                                ⌢
                                             
                                             ˙
                                          
                                          =
                                          
                                             η
                                             5
                                          
                                          
                                             
                                                
                                                   
                                                      E
                                                   
                                                   T
                                                
                                                
                                                   PB
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

The following proof can be defined as a Lyapunov function candidate:
                                 
                                    (26)
                                    
                                       
                                          V
                                          (
                                          t
                                          )
                                          =
                                          
                                             1
                                             2
                                          
                                          
                                             
                                                E
                                             
                                             T
                                          
                                          
                                             PE
                                          
                                          +
                                          
                                             1
                                             
                                                2
                                                
                                                   η
                                                   1
                                                
                                             
                                          
                                          tr
                                          (
                                          
                                             
                                                
                                                   W
                                                
                                                ˜
                                             
                                             T
                                          
                                          
                                             
                                                W
                                             
                                             ˜
                                          
                                          )
                                          +
                                          
                                             1
                                             
                                                2
                                                
                                                   η
                                                   2
                                                
                                             
                                          
                                          
                                             
                                                
                                                   S
                                                
                                                ˜
                                             
                                             T
                                          
                                          
                                             
                                                S
                                             
                                             ˜
                                          
                                          +
                                          
                                             1
                                             
                                                2
                                                
                                                   η
                                                   3
                                                
                                             
                                          
                                          
                                             
                                                
                                                   Z
                                                
                                                ˜
                                             
                                             T
                                          
                                          
                                             
                                                Z
                                             
                                             ˜
                                          
                                          +
                                          
                                             1
                                             
                                                2
                                                
                                                   η
                                                   4
                                                
                                             
                                          
                                          
                                             
                                                
                                                   R
                                                
                                                ˜
                                             
                                             T
                                          
                                          
                                             
                                                R
                                             
                                             ˜
                                          
                                          +
                                          
                                             1
                                             
                                                2
                                                
                                                   η
                                                   5
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      β
                                                   
                                                
                                                ˜
                                             
                                             T
                                          
                                          
                                             
                                                
                                                   β
                                                
                                             
                                             ˜
                                          
                                       
                                    
                                 
                              where P is a symmetric positive definite matrix that satisfies the following Lyapunov equation:
                                 
                                    (27)
                                    
                                       
                                          
                                             
                                                A
                                             
                                             T
                                          
                                          
                                             P
                                          
                                          +
                                          
                                             PA
                                          
                                          =
                                          −
                                          
                                             Q
                                          
                                       
                                    
                                 
                              in which Q is a positive definite matrix. Here, the uncertainty boundary estimation error is defined as 
                                 
                                    
                                       
                                          β
                                       
                                       ˜
                                    
                                    =
                                    
                                       β
                                    
                                    −
                                    
                                       
                                          β
                                       
                                       ⌢
                                    
                                 
                              . Taking the Lyapunov function (26) differential and applying Eqs. (19) and (27), it is concluded that
                                 
                                    (28)
                                    
                                       
                                          
                                             V
                                             ˙
                                          
                                          (
                                          t
                                          )
                                          =
                                          −
                                          
                                             1
                                             2
                                          
                                          
                                             
                                                E
                                             
                                             T
                                          
                                          
                                             QE
                                          
                                          +
                                          
                                             1
                                             2
                                          
                                          (
                                          
                                             
                                                E
                                             
                                             T
                                          
                                          
                                             PB
                                          
                                          +
                                          
                                             
                                                B
                                             
                                             T
                                          
                                          
                                             PE
                                          
                                          )
                                          
                                             
                                                u
                                             
                                             ˜
                                          
                                          −
                                          
                                             1
                                             
                                                
                                                   η
                                                   1
                                                
                                             
                                          
                                          
                                             
                                                
                                                   W
                                                
                                                ˜
                                             
                                             T
                                          
                                          
                                             
                                                
                                                   W
                                                
                                                ⌢
                                             
                                             ˙
                                          
                                          −
                                          
                                             1
                                             
                                                
                                                   η
                                                   2
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      S
                                                   
                                                   ⌢
                                                
                                                ˙
                                             
                                             T
                                          
                                          
                                             
                                                S
                                             
                                             ˜
                                          
                                          −
                                          
                                             1
                                             
                                                
                                                   η
                                                   3
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      Z
                                                   
                                                   ⌢
                                                
                                                ˙
                                             
                                             T
                                          
                                          
                                             
                                                Z
                                             
                                             ˜
                                          
                                          −
                                          
                                             1
                                             
                                                
                                                   η
                                                   4
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      R
                                                   
                                                   ⌢
                                                
                                                ˙
                                             
                                             T
                                          
                                          
                                             
                                                R
                                             
                                             ˜
                                          
                                          −
                                          
                                             1
                                             
                                                
                                                   η
                                                   5
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      β
                                                   
                                                
                                                ˜
                                             
                                             T
                                          
                                          
                                             
                                                
                                                   
                                                      β
                                                   
                                                
                                                ⌢
                                             
                                             ˙
                                          
                                          =
                                          −
                                          
                                             1
                                             2
                                          
                                          
                                             
                                                E
                                             
                                             T
                                          
                                          
                                             QE
                                          
                                          +
                                          
                                             
                                                E
                                             
                                             T
                                          
                                          
                                             PB
                                          
                                          [
                                          
                                             
                                                
                                                   W
                                                
                                                ˜
                                             
                                             T
                                          
                                          
                                             
                                                T
                                             
                                             ⌢
                                          
                                          +
                                          
                                             
                                                
                                                   W
                                                
                                                ⌢
                                             
                                             T
                                          
                                          (
                                          
                                             
                                                T
                                             
                                             s
                                          
                                          
                                             
                                                S
                                             
                                             ˜
                                          
                                          +
                                          
                                             
                                                T
                                             
                                             s
                                          
                                          
                                             
                                                Z
                                             
                                             ˜
                                          
                                          +
                                          
                                             
                                                T
                                             
                                             r
                                          
                                          
                                             
                                                R
                                             
                                             ˜
                                          
                                          )
                                          
                                             
                                                u
                                             
                                             
                                                C
                                             
                                          
                                          +
                                          
                                             D
                                          
                                          ]
                                          −
                                          
                                             1
                                             
                                                
                                                   η
                                                   1
                                                
                                             
                                          
                                          
                                             
                                                
                                                   W
                                                
                                                ˜
                                             
                                             T
                                          
                                          
                                             
                                                
                                                   W
                                                
                                                ⌢
                                             
                                             ˙
                                          
                                          −
                                          
                                             1
                                             
                                                
                                                   η
                                                   2
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      S
                                                   
                                                   ⌢
                                                
                                                ˙
                                             
                                             T
                                          
                                          
                                             
                                                S
                                             
                                             ˜
                                          
                                          −
                                          
                                             1
                                             
                                                
                                                   η
                                                   3
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      Z
                                                   
                                                   ⌢
                                                
                                                ˙
                                             
                                             T
                                          
                                          
                                             
                                                Z
                                             
                                             ˜
                                          
                                          −
                                          
                                             1
                                             
                                                
                                                   η
                                                   4
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      R
                                                   
                                                   ⌢
                                                
                                                ˙
                                             
                                             T
                                          
                                          
                                             
                                                R
                                             
                                             ˜
                                          
                                          −
                                          
                                             1
                                             
                                                
                                                   η
                                                   5
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      β
                                                   
                                                
                                                ˜
                                             
                                             T
                                          
                                          
                                             
                                                
                                                   
                                                      β
                                                   
                                                
                                                ⌢
                                             
                                             ˙
                                          
                                          =
                                          −
                                          
                                             1
                                             2
                                          
                                          
                                             
                                                E
                                             
                                             T
                                          
                                          
                                             QE
                                          
                                          +
                                          
                                             
                                                
                                                   W
                                                
                                                ˜
                                             
                                             T
                                          
                                          
                                             
                                                
                                                   
                                                      E
                                                   
                                                   T
                                                
                                                
                                                   PB
                                                
                                                
                                                   
                                                      T
                                                   
                                                   ⌢
                                                
                                                −
                                                
                                                   1
                                                   
                                                      
                                                         η
                                                         1
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         W
                                                      
                                                      ⌢
                                                   
                                                   ˙
                                                
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   
                                                      E
                                                   
                                                   T
                                                
                                                
                                                   PB
                                                
                                                
                                                   
                                                      
                                                         W
                                                      
                                                      ⌢
                                                   
                                                   T
                                                
                                                
                                                   
                                                      T
                                                   
                                                   s
                                                
                                                −
                                                
                                                   1
                                                   
                                                      
                                                         η
                                                         2
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            S
                                                         
                                                         ⌢
                                                      
                                                      ˙
                                                   
                                                   T
                                                
                                             
                                          
                                          
                                             
                                                S
                                             
                                             ˜
                                          
                                          +
                                          
                                             
                                                
                                                   
                                                      E
                                                   
                                                   T
                                                
                                                
                                                   PB
                                                
                                                
                                                   
                                                      
                                                         W
                                                      
                                                      ⌢
                                                   
                                                   T
                                                
                                                
                                                   
                                                      T
                                                   
                                                   z
                                                
                                                −
                                                
                                                   1
                                                   
                                                      
                                                         η
                                                         3
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            Z
                                                         
                                                         ⌢
                                                      
                                                      ˙
                                                   
                                                   T
                                                
                                             
                                          
                                          
                                             
                                                Z
                                             
                                             ˜
                                          
                                          +
                                          
                                             
                                                
                                                   
                                                      E
                                                   
                                                   T
                                                
                                                
                                                   PB
                                                
                                                
                                                   
                                                      
                                                         W
                                                      
                                                      ⌢
                                                   
                                                   T
                                                
                                                
                                                   
                                                      T
                                                   
                                                   r
                                                
                                                −
                                                
                                                   1
                                                   
                                                      
                                                         η
                                                         4
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            R
                                                         
                                                         ⌢
                                                      
                                                      ˙
                                                   
                                                   T
                                                
                                             
                                          
                                          
                                             
                                                R
                                             
                                             ˜
                                          
                                          −
                                          
                                             
                                                E
                                             
                                             T
                                          
                                          
                                             PB
                                          
                                          
                                             
                                                u
                                             
                                             
                                                C
                                             
                                          
                                          +
                                          
                                             
                                                E
                                             
                                             T
                                          
                                          
                                             PBD
                                          
                                          −
                                          
                                             1
                                             
                                                
                                                   η
                                                   5
                                                
                                             
                                          
                                          
                                             
                                                
                                                   β
                                                
                                                ˜
                                             
                                             T
                                          
                                          
                                             
                                                
                                                   β
                                                
                                                ⌢
                                             
                                             ˙
                                          
                                       
                                    
                                 
                              Similarly, after incorporation of Eqs. (20)–(25) into (28), the derivative of V(t) can be rewritten as
                                 
                                    (29)
                                    
                                       
                                          
                                             V
                                             ˙
                                          
                                          (
                                          t
                                          )
                                          =
                                          −
                                          
                                             1
                                             2
                                          
                                          
                                             
                                                E
                                             
                                             T
                                          
                                          
                                             QE
                                          
                                          −
                                          
                                             
                                                E
                                             
                                             T
                                          
                                          
                                             PB
                                          
                                          
                                             
                                                u
                                             
                                             
                                                C
                                             
                                          
                                          +
                                          
                                             
                                                E
                                             
                                             T
                                          
                                          
                                             PBD
                                          
                                          −
                                          
                                             1
                                             
                                                
                                                   η
                                                   5
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      β
                                                   
                                                
                                                ˜
                                             
                                             T
                                          
                                          
                                             
                                                
                                                   
                                                      β
                                                   
                                                
                                                ⌢
                                             
                                             ˙
                                          
                                          ≤
                                          −
                                          
                                             1
                                             2
                                          
                                          
                                             
                                                E
                                             
                                             T
                                          
                                          
                                             QE
                                          
                                          −
                                          
                                             
                                                
                                                   β
                                                
                                                ⌢
                                             
                                             T
                                          
                                          |
                                          
                                             
                                                E
                                             
                                             T
                                          
                                          
                                             PB
                                          
                                          |
                                          +
                                          |
                                          
                                             
                                                E
                                             
                                             T
                                          
                                          
                                             PB
                                          
                                          |
                                          |
                                          
                                             D
                                          
                                          |
                                          −
                                          
                                             
                                                (
                                                
                                                   
                                                      
                                                         β
                                                      
                                                   
                                                   T
                                                
                                                
                                                   
                                                      
                                                         β
                                                      
                                                   
                                                   ⌢
                                                
                                                )
                                             
                                             T
                                          
                                          |
                                          
                                             
                                                E
                                             
                                             T
                                          
                                          
                                             PB
                                          
                                          |
                                          ≤
                                          −
                                          
                                             1
                                             2
                                          
                                          
                                             
                                                E
                                             
                                             T
                                          
                                          
                                             QE
                                          
                                          −
                                          |
                                          
                                             
                                                E
                                             
                                             T
                                          
                                          
                                             PB
                                          
                                          |
                                          (
                                          |
                                          
                                             
                                                β
                                             
                                          
                                          |
                                          −
                                          |
                                          
                                             D
                                          
                                          |
                                          ≤
                                          0
                                       
                                    
                                 
                              In this case, 
                                 
                                    
                                       V
                                       ˙
                                    
                                    (
                                    t
                                    )
                                 
                               is smaller than zero, which implies that E(t) will converge to zero as t→∞. As a result, the stability of the proposed control system can be guaranteed.

According to the above derivative, the on-line learning algorithm of RFNNHRC is summarized as follows:

Step 1: Initialize the parameters of 
                                    
                                       
                                          
                                             W
                                          
                                          ⌢
                                       
                                       ,
                                       
                                          
                                             S
                                          
                                          ⌢
                                       
                                       ,
                                       
                                          
                                             Z
                                          
                                          ⌢
                                       
                                       ,
                                       
                                          
                                             R
                                          
                                          ⌢
                                       
                                    
                                  and 
                                    
                                       
                                          β
                                       
                                       ⌢
                                    
                                 .

Step 2: Measure heart rate h, then calculate e
                                 =
                                 h*−
                                 h and 
                                    
                                       e
                                       ˙
                                    
                                 .

Step 3: Calculate RFNNHRC inputs 
                                    
                                       
                                          x
                                          
                                             e
                                             ,
                                             i
                                          
                                          1
                                       
                                          
                                       (
                                       i
                                       =
                                       1
                                       ,
                                       …
                                       ,
                                       9
                                       )
                                    
                                  and 
                                    
                                       
                                          x
                                          
                                             
                                                e
                                                ˙
                                             
                                             ,
                                             i
                                          
                                          1
                                       
                                          
                                       (
                                       i
                                       =
                                       1
                                       ,
                                       …
                                       ,
                                       9
                                       )
                                    
                                  using Eqs. (1) and (2).

Step 4: Calculate 
                                    
                                       
                                          x
                                          
                                             e
                                             ,
                                             i
                                          
                                          2
                                       
                                          
                                       (
                                       i
                                       =
                                       1
                                       ,
                                       …
                                       ,
                                       9
                                       )
                                    
                                  and 
                                    
                                       
                                          x
                                          
                                             
                                                e
                                                ˙
                                             
                                             ,
                                             i
                                          
                                          2
                                       
                                          
                                       (
                                       i
                                       =
                                       1
                                       ,
                                       …
                                       ,
                                       9
                                       )
                                    
                                  using Eqs. (3) and (4).

Step 5: Calculate 
                                    
                                       
                                          x
                                          i
                                          3
                                       
                                          
                                       (
                                       i
                                       =
                                       1
                                       ,
                                       …
                                       ,
                                       9
                                       )
                                    
                                  using Eq. (5).

Step 6: Calculate 
                                    
                                       
                                          
                                             u
                                          
                                          C
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  u
                                                                  
                                                                     C
                                                                     1
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  u
                                                                  
                                                                     C
                                                                     2
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          T
                                       
                                    
                                  using Eq. (24).

Step 7: Calculate RFNNHRC outputs u
                                 
                                    S
                                  and u
                                 
                                    θ
                                  using Eqs. (6) and (7).

Step 8: Update 
                                    
                                       
                                          
                                             W
                                          
                                          ⌢
                                       
                                       ,
                                       
                                          
                                             S
                                          
                                          ⌢
                                       
                                       ,
                                       
                                          
                                             Z
                                          
                                          ⌢
                                       
                                       ,
                                       
                                          
                                             R
                                          
                                          ⌢
                                       
                                    
                                  and 
                                    
                                       
                                          β
                                       
                                       ⌢
                                    
                                  using Eqs. (20)–(23) and (25), then go to step 2.

A heart rate sensor is initially placed on the runners chest (Fig. 4
                        ).

The heart rate sensor monitors the runner's heart rate in real time, and delivers data to the heart rate receiver on the treadmill via blue tooth. Subsequently, heart rate data is sent to the digital signal processor (DSP) and then to the computer through an RS 232 data interface, and is analyzed using Matlab Software (Fig. 5
                        ), which generates results from experimental curves as shown in Figs. 10–18. For the slow-changing heart rate response, the proposed controller has been designed to achieve the desired performance such as rise time smaller than 360s, settling time smaller than 420s and overshoot smaller than 10%.

The DSP is the control center of the treadmill, and executes all functions from the treadmill. Specifically, the DSP controls the treadmill speed and incline motor driver and the console control, and activates the RFNNHRC using heart rate receiver data via Bluetooth connections. The RS232 Port and computer were connected and experimental curve diagrams were generated. Generally, microprocessors have insufficient capacity for the present application, thus a DSP with high-speed processing capabilities was used to implement the recurrent fuzzy neural network heart rate controller (Fig. 6
                        ).

@&#EXPERIMENTAL RESULTS@&#

The experimental setup for the proposed RFNNHRC for treadmill control is shown in Fig. 7
                     , and the RFNNHRC treadmill control scheme is shown in Fig. 1, which includes the RFNNHRC structure shown in Fig. 2. The proposed heart rate controller was designed using a dsPIC 30F4011 DSP board (Fig. 8
                     ). The schematic of the DSP board is shown in Fig. 9
                     . Input capture is used to input user heart rate h. The GPIO is used to output the treadmill speed control signal u
                     
                        S
                      and incline control signal u
                     
                        θ
                     . Person Computer Matlab Software is used to generate results from experimental curves. For dsPIC 30F4011 DSP real-time implementation, the sampling time is 1ms. In order to prevent hazardous events, a safe key was designed to turn off the speed-controlled servo motor to stop the treadmill. When runner heart rate cannot track pre-set heart rate command over 20% within 3min, the RFNNHRC quantify the level of exhaustion and automatically decrease heart rate command.

The original treadmill system comprised a running belt and several connection rods and servo motors that controlled treadmill speeds and inclines. After addition of the RFNNHRC and assignment of the above control algorithm to the original treadmill system, improved heart rate control was achieved. Specifically, when the plant input potential was sent to the plant through the driving circuit, the servo motors were activated and rotated the running belt, and the plant output controlled the running belt speed of the treadmill. Accordingly, the plant can be modeled with rotation and straight-line motions using basic physical rules. Hence, complicated plants can be simplified into a straight-line motion model with m as the equivalent mass, b as the damping friction, k as the spring constant, and c as Coulomb's friction for the system. Due to the presence of screws and multiple connection rods in the mechanism, friction (including damping and Coulomb's friction) plays a decisive role in system modeling, and leads to nonlinearity. The runners have different weights which yield different uncertainties. Hence, the plant acted as a nonlinear dynamic treadmill system as described in Eq. (9). The RFNNHRC control law 
                        
                           
                              u
                           
                           (
                           t
                           )
                           =
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      u
                                                      S
                                                   
                                                   (
                                                   t
                                                   )
                                                
                                             
                                             
                                                
                                                   
                                                      u
                                                      θ
                                                   
                                                   (
                                                   t
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              T
                           
                        
                      was designed as in Eq. (15) with the adaptive laws for network parameters described by Eqs. (20)–(23), and the compensated controller control law 
                        
                           
                              
                                 u
                              
                              
                                 C
                              
                           
                           =
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      u
                                                      
                                                         C
                                                         1
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      u
                                                      
                                                         C
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              T
                           
                        
                      was designed as in Eq. (24) with the estimation law given in (25). The parameters η
                     1, η
                     2, η
                     3, η
                     4, η
                     5 were set at the same positive constant of 0.5, and initial values of the fuzzy rule function vector 
                        
                           
                              W
                           
                           =
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      w
                                                      
                                                         11
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      w
                                                      
                                                         11
                                                      
                                                   
                                                
                                             
                                             
                                                …
                                             
                                             
                                                
                                                   
                                                      w
                                                      
                                                         19
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      w
                                                      
                                                         21
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      w
                                                      
                                                         22
                                                      
                                                   
                                                
                                             
                                             
                                                …
                                             
                                             
                                                
                                                   
                                                      w
                                                      
                                                         29
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              T
                           
                        
                      were set to 0.75 by trial and error. In Eq. (11), K is set as 
                        
                           
                              K
                           
                           =
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      k
                                                      2
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      k
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              T
                           
                           =
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                6
                                             
                                             
                                                
                                                   10
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              T
                           
                        
                      to achieve stable and quick response, that is 
                        
                           
                              A
                           
                           =
                           
                              
                                 
                                    
                                       
                                          0
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          
                                             −
                                             6
                                          
                                       
                                       
                                          
                                             −
                                             10
                                          
                                       
                                    
                                 
                              
                           
                        
                      in Eq. (13). In Eq. (27), the positive definite matrix Q is set as 
                        
                           
                              
                                 
                                    
                                       
                                          6
                                       
                                       
                                          0
                                       
                                    
                                    
                                       
                                          0
                                       
                                       
                                          
                                             10
                                          
                                       
                                    
                                 
                              
                           
                        
                      that parameters are the same as k
                     1 and k
                     2, which results 
                        
                           
                              P
                           
                           =
                           
                              
                                 
                                    
                                       
                                          
                                             8.3
                                          
                                       
                                       
                                          
                                             0.5
                                          
                                       
                                    
                                    
                                       
                                          
                                             0.5
                                          
                                       
                                       
                                          
                                             0.55
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     . The unknown treadmill functions 
                        
                           
                              g
                           
                           (
                           y
                           )
                           =
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                g
                                                1
                                             
                                             (
                                             y
                                             )
                                          
                                       
                                       
                                          
                                             
                                                g
                                                2
                                             
                                             (
                                             y
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                      were bounded by a value of 120. The nominal matrix B is 
                        
                           
                              B
                           
                           =
                           
                              
                                 
                                    
                                       
                                          0
                                       
                                       
                                          0
                                       
                                    
                                    
                                       
                                          
                                             60
                                          
                                       
                                       
                                          
                                             60
                                          
                                       
                                    
                                 
                              
                           
                        
                     .

The conventional PI controller shown in Fig. 10
                      was compared with the proposed RFNNHRC. In experiments 1–5, the proportional gain and integral gain of the PI controller for treadmill speed control are the same, K
                     
                        p1
                     =0.82 and K
                     
                        i1
                     =1.36. The proportional gain and integral gain of the PI controller for treadmill incline control in experiments 1–5 are the same, K
                     
                        p2
                     =0.76 and K
                     
                        i2
                     =1.25. The SW
                     1 and SW
                     2 are used to turn on or off the treadmill speed control and treadmill incline control, respectively. The selection of PI parameters was made based on approximately a hundred times of heart rate control experiments to decide the best parameter value via the genetic algorithm.

Treadmill speed was used alone as a control input for a pre-set heart rate command of 140 beats per minute (bpm). In this experiment, runners 1 and 2 exercised on the treadmill system using the proposed control scheme or a PI control system. The runner 1 is a man, 19 years old, 64kg weight, and 170cm tall. The runner 2 is a man, 31 years old, 70kg weight, and 176cm tall. Initial heart rate responses of runners 1 and 2 and corresponding treadmill speeds are shown in Figs. 11 and 12
                        
                        , respectively. These experiments demonstrate smaller heart rate fluctuations of runners when using the present control scheme than when using the PI control system. Moreover, treadmill speeds were smoother with the proposed control scheme than with the PI control system.

In comparison with the proposed control scheme, the PI system produced delayed initial increases in the heart rate of runner 2 and then exceeded (155bpm) the pre-set heart rate of 140bpm after 450s, and only achieved the pre-set heart rate when after 600s (Fig. 12). Smoother initial fluctuations of heart rate, and smaller deviations from the pre-set heart rate were recorded using the proposed control scheme, with 137bpm at 450s and 143bpm at 600s (Fig. 12). The heart rate response can achieve the desired performance using the proposed controller.

Treadmill speeds and inclines were used as control inputs for a pre-set heart rate command of 140bpm. The runner 3 is a man, 18 years old, 65kg weight, and 176cm tall. The runner 4 is a man, 25 years old, 70kg weight, and 174cm tall. The runner 5 is a man, 30 years old, 78kg weight, and 182cm tall. The runner 6 is a man, 33 years old, 68kg weight, and 176cm tall. Runners 3, 4, 5, and 6 exercised on the treadmill system using the proposed scheme or the PI control system, and heart rate responses and corresponding treadmill speeds and inclines were recorded (Figs. 13–16
                        
                        
                        
                        , respectively). In these experiments, heart rate responses of runners 3–6 had smaller fluctuations, and treadmill speeds and inclines were smoother with the proposed system than with the PI control system. When runners exercised on the treadmill system with smaller heart rate fluctuations, and smoother treadmill speeds and inclines, one can achieve larger oxygen consumption, better and safe exercise effect.

According to experiment 2, initial heart rates varied between runners, although controlling inputs of speed and incline varied simultaneously, and the proposed system led to smaller deviations of heart rate from the pre-set value. Specifically, although runner 3 (Fig. 13) had an initial heart rate of 120bpm, the pre-set heart rate was achieved after 700s with the proposed control scheme. Moreover, under the same conditions (Fig. 14) the pre-set heart rate was achieved after 600s by runner 4 with the proposed control scheme, whereas the PI system failed to achieve sustained deviations of less than 5bpm in either runners 3 or 4 (Figs. 13 and 14). Furthermore, heart rates of runners 5 and 6 reached 140bpm after 520s and 450s, respectively with the proposed control scheme, with smoother initial heart rate increases than with the PI system, and without variations in platform inclines (Figs. 15 and 16). The heart rate response can achieve the desired performance using the proposed controller. These data suggest that, compared with the PI system, the proposed scheme produces greater accuracy and heart rate stability.

Speeds and inclines of the treadmill were used as control inputs for a pre-set heart rate command of 150bpm. The runner 7 is a man, 30 years old, 73kg weight, and 177cm tall. Runner 7 exercised on the treadmill system using the proposed control scheme or the PI control system, and heart rate, treadmill speed, and treadmill incline responses were recorded (Fig. 17
                        ). In these experiments, heart rate responses exhibited smaller fluctuations with the proposed control scheme than with the PI control system. Moreover, treadmill speeds and treadmill inclines were adjusted more smoothly by the proposed control system than by the PI control system.

In further experiments, speed and incline inputs were pre-set in addition to pre-set heart commands, which were set in 10bpm increments. As shown in Fig. 17, the heart rate of runner 7 reached 150bpm with proposed control scheme after only 370s, and fluctuations of speed were controlled with more rapid correspondence to heart rates than with the PI system. Moreover, no adjustments of inclination were required by the proposed control scheme, which achieved steady control of heart rates with only adjustments of speed. The heart rate response can achieve the desired performance using the proposed controller.

Speeds and inclines of the treadmill were used as control inputs for a pre-set heart rate command of 160bpm. The runner 8 is a man, 24 years old, 69kg weight, and 176cm tall. Runner 8 exercised on the treadmill system using the proposed control scheme and the PI control system, and heart rate responses and treadmill speeds were monitored at a constant treadmill incline of 6° (Fig. 18
                        ). In this experiment the pre-set heart rate of 160bpm was achieved after 300s with the proposed scheme, and a constant speed was maintained from 400s. The heart rate response can achieve the desired performance using the proposed controller. Although the pre-set heart rate was also reached at 300s with the PI system, controlled speeds of the treadmill fluctuated continuously. These experiments showed that fluctuations in heart rate responses were smaller and treadmill speeds and inclines were smoother with the proposed scheme than with the PI control system.

Speeds and inclines of the treadmill were used as control inputs for a pre-set heart rate command of 170bpm. The runner 9 is a man, 19 years old, 72kg weight, and 180cm tall. Runner 9 exercised on the treadmill system using the proposed control scheme or the PI system, and heart rate responses, treadmill speeds, and treadmill inclines were recorded (Fig. 19
                        ). In this experiment, satisfactory heart rate control was achieved by both the proposed scheme and the PI control system, although smoothness of treadmill speeds and inclines was superior with the proposed control scheme than with the PI control system. The heart rate response can achieve the desired performance using the proposed controller.

Under the conditions of this experiment, the runner's heart rate was approximately stabilized at 170bpm after 720s without inclination, and speed fluctuations were notably more fluent with the proposed control system than with the PI control system.

@&#CONCLUSIONS@&#

Neural networks have superior capabilities compared with feed-forward neural networks, with rapid dynamic responses and information-storing capabilities [26–28]. The present novel RFNNHRC scheme was combined with adjustable parameters and an on-line learning algorithm, and was applied to a computer controlled treadmill system with heart rate control during treadmill exercise. Novel RFNNHRC structure and controller stability analyses were introduced, and treadmill speeds and inclines were controlled to minimize heart rate deviations from a preset profile. Moreover, related membership functions and weight variables were updated using adaptive algorithms, and all parameters for the proposed RFNNHRC were tuned using a Lyapunov function to ensure system stability. Subsequent experimental comparisons with a commercially available PI heart rate control system indicated superior heart rate control and smoothness of treadmill speed and incline changes. Finally, superior stability and reliability of heart rate control with the proposed RFNNHRC scheme was demonstrated with various pre-set heart rates, speeds, and inclines.

@&#REFERENCES@&#

